{"version":3,"file":"dhtmlxgantt.js","sources":["../sources/core/relations/links_common.js","../sources/utils/helpers.js","../sources/core/relations/graph_helper.js","../sources/core/relations/links_builder.js","../sources/ext/auto_scheduling/constraint_types.ts","../sources/core/ui/utils/dom_helpers.js","../sources/ext/auto_scheduling/task_plan.ts","../sources/ext/auto_scheduling/constraints.ts","../sources/ext/auto_scheduling/date_comparator.ts","../sources/ext/auto_scheduling/alap_strategy.ts","../sources/ext/auto_scheduling/asap_strategy.ts","../sources/ext/auto_scheduling/planner.ts","../sources/ext/auto_scheduling/connected_groups.ts","../sources/ext/auto_scheduling/loops_finder.ts","../sources/core/plugins/auto_scheduling_config.js","../sources/ext/auto_scheduling/ui_handlers.ts","../sources/utils/global.js","../sources/ext/click_drag/eventsManager.ts","../sources/utils/eventable.js","../sources/ext/click_drag/selectedRegion.ts","../sources/ext/drag_timeline/eventsManager.ts","../sources/utils/utils.js","../sources/core/ui/timeline/scales.js","../sources/core/ui/timeline/scales_ignore.js","../sources/ext/keyboard_navigation/modals.js","../sources/ext/quick_info/quickInfo.ts","../sources/core/ui/utils/dom_event_scope.js","../sources/ext/tooltip/tooltip.ts","../sources/ext/tooltip/tooltipManager.ts","../sources/ext/undo/monitor.ts","../sources/ext/undo/undo.ts","../sources/ext/extensions_all.ts","../sources/ext/auto_scheduling.js","../sources/ext/click_drag/index.ts","../sources/ext/critical_path.js","../sources/ext/critical_path/slack.js","../sources/ext/critical_path/critical_path.js","../sources/ext/drag_timeline/index.ts","../sources/ext/fullscreen/index.ts","../sources/ext/keyboard_navigation.js","../sources/ext/keyboard_navigation/common/keyboard_shortcuts.js","../sources/ext/keyboard_navigation/common/eventhandler.js","../sources/ext/keyboard_navigation/common/trap_modal_focus.js","../sources/ext/keyboard_navigation/elements/gantt_node.js","../sources/ext/keyboard_navigation/elements/nav_node.js","../sources/ext/keyboard_navigation/elements/header_cell.js","../sources/ext/keyboard_navigation/elements/task_row.js","../sources/ext/keyboard_navigation/elements/task_cell.js","../sources/ext/keyboard_navigation/core.js","../sources/ext/quick_info/index.ts","../sources/ext/tooltip/index.ts","../sources/ext/undo/index.ts","../sources/ext/grouping.js","../sources/ext/marker.js","../sources/ext/multiselect.js","../sources/ext/overlay.js","../sources/ext/export_api/index.ts","../sources/ext/extension_manager.ts","../sources/constants/index.js","../sources/utils/env.js","../sources/core/common/serialize.ts","../sources/core/common/ajax.js","../sources/core/common/date_parsers/fast_version.ts","../sources/core/common/date_parsers/csp_compliant_version.ts","../sources/core/common/date.js","../node_modules/remote-client/dist/remote.es6.js","../sources/core/remote/remote_events.js","../sources/utils/timeout.js","../sources/core/common/state.js","../sources/utils/promise.js","../sources/core/facades/datastore_tasks.js","../sources/core/datastore/power_array.js","../sources/utils/placeholder_task.js","../sources/core/datastore/datastore.js","../sources/core/common/split_task_helpers.ts","../sources/core/datastore/treedatastore.js","../sources/utils/is_headless.js","../sources/core/datastore/datastore_render.js","../sources/core/facades/datastore.js","../sources/core/datastore/select.js","../sources/core/facades/datastore_links.js","../sources/core/gantt_data_range.js","../sources/utils/task_tree_helpers.js","../sources/core/dataprocessor/data_processor_events.ts","../sources/core/dataprocessor/simple_storage.ts","../sources/core/dataprocessor/data_processor.ts","../sources/core/dataprocessor/extend_gantt.ts","../sources/core/dataprocessor/index.js","../sources/core/plugins/batch_update.js","../sources/core/plugins/wbs.js","../sources/core/plugins/resources.js","../sources/core/plugins/resource_assignments.js","../sources/core/plugins/new_task_placeholder.js","../sources/core/plugins/auto_task_types.js","../sources/core/common/duration_formatter.ts","../sources/core/common/link_formatter_simple.ts","../sources/core/common/link_formatter.ts","../sources/core/plugins/formatters.js","../sources/core/plugins/empty_state_screen.ts","../sources/core/ui/render/baseline_helper.js","../sources/core/plugins/baselines.js","../sources/core/plugins/remote_events/remote_events.ts","../sources/core/plugins/remote_events/handlers.js","../sources/core/plugins/remote_events/index.js","../sources/core/ui/row_position_mixin.js","../sources/core/ui/row_position_fixed_height.js","../sources/core/ui/plugins/column_grid_dnd/scrollable_grid.ts","../sources/core/ui/plugins/column_grid_dnd/column_grid_dnd.ts","../sources/core/ui/mouse_event_container.js","../sources/core/ui/grid/grid.js","../sources/core/loading/parsing.js","../sources/core/worktime/calendar_arguments_helper.js","../sources/core/ui/grid/grid_resize.js","../sources/core/ui/grid/task_grid_row_resize.js","../sources/core/worktime/strategy/work_calendar_merger.js","../sources/core/worktime/strategy/work_unit_cache/workunit_map_cache.ts","../sources/core/worktime/strategy/work_unit_cache/workunit_object_cache.ts","../sources/core/worktime/strategy/work_unit_cache/larger_units_helper.ts","../sources/core/worktime/strategy/work_unit_cache/date_duration_cache.ts","../sources/core/worktime/strategy/calendar_strategy.js","../sources/core/worktime/strategy/work_unit_cache/index.ts","../sources/core/worktime/legacy_resource_config.js","../sources/core/worktime/calendar_manager.js","../sources/core/worktime/dynamic_resource_calendars.js","../sources/core/worktime/strategy/no_work_time.js","../sources/core/worktime/time_calculator.js","../sources/core/facades/worktime_calendars.js","../sources/core/data.js","../sources/core/ui/resize_listener.js","../sources/core/gantt_core.js","../sources/core/common/assert.js","../sources/locale/locale_ar.ts","../sources/locale/locale_be.ts","../sources/locale/locale_ca.ts","../sources/locale/locale_cn.ts","../sources/locale/locale_cs.ts","../sources/locale/locale_da.ts","../sources/locale/locale_de.ts","../sources/locale/locale_el.ts","../sources/locale/locale_en.ts","../sources/locale/locale_es.ts","../sources/locale/locale_fa.ts","../sources/locale/locale_fi.ts","../sources/locale/locale_fr.ts","../sources/locale/locale_he.ts","../sources/locale/locale_hr.ts","../sources/locale/locale_hu.ts","../sources/locale/locale_id.ts","../sources/locale/locale_it.ts","../sources/locale/locale_jp.ts","../sources/locale/locale_kr.ts","../sources/locale/locale_manager.ts","../sources/locale/locale_nb.ts","../sources/locale/locale_nl.ts","../sources/locale/locale_no.ts","../sources/locale/locale_pl.ts","../sources/locale/locale_pt.ts","../sources/locale/locale_ro.ts","../sources/locale/locale_ru.ts","../sources/locale/locale_si.ts","../sources/locale/locale_sk.ts","../sources/locale/locale_sv.ts","../sources/locale/locale_tr.ts","../sources/locale/locale_ua.ts","../sources/factory/make_instance_common.js","../sources/core/common/services.js","../sources/core/common/config.ts","../sources/core/common/dnd.js","../sources/core/common/templates.js","../sources/core/datastore/datastore_hooks.js","../sources/core/plugins/index.js","../sources/core/grid_column_api.js","../sources/core/grid_column_api.gpl.js","../sources/core/tasks.js","../sources/core/worktime/work_time.js","../sources/core/data_task_types.js","../sources/core/cached_functions.js","../sources/core/destructor.js","../sources/locale/index.ts","../sources/core/ui/message.js","../sources/core/ui/configurable.js","../sources/core/ui/ui_factory.js","../sources/core/ui/mouse.js","../sources/core/ui/render/viewport/is_in_viewport.js","../sources/core/ui/render/is_legacy_smart_render.js","../sources/core/ui/render/viewport/get_grid_row_rectangle.js","../sources/core/ui/render/viewport/get_visible_bars_range.js","../sources/core/ui/render/render_factory.js","../sources/core/ui/render/layer_engine.js","../sources/core/ui/render/viewport/get_bar_rectangle.js","../sources/core/ui/render/viewport/factory/get_visible_link_range.js","../sources/core/ui/render/viewport/get_link_rectangle.js","../sources/core/ui/render/viewport/is_link_in_viewport.js","../sources/core/ui/gantt_layers.js","../sources/core/ui/layout/cell.js","../sources/utils/extends.js","../sources/core/ui/layout/layout.js","../sources/core/ui/layout/view_layout.js","../sources/core/ui/layout/view_cell.js","../sources/core/ui/layout/resizer_cell.js","../sources/core/ui/layout/scrollbar_cell.js","../sources/core/ui/timeline/tasks_canvas_render.js","../sources/core/ui/timeline/timeline.js","../sources/core/ui/resource_store_mixin.js","../sources/core/ui/timeline/timeline_layers.js","../sources/core/ui/grid/resource_grid.js","../sources/core/ui/grid/resource_grid_lightbox.js","../sources/core/ui/timeline/resource_timeline.js","../sources/core/ui/timeline/resource_histogram.js","../sources/core/ui/grid/editors/keyboard_mappings/default.js","../sources/core/ui/grid/editors/keyboard_mappings/keyboard_navigation.js","../sources/core/ui/grid/editors/editors/base.js","../sources/core/ui/grid/editors/editors/text.js","../sources/core/ui/grid/editors/editors/number.js","../sources/core/ui/grid/editors/editors/select.js","../sources/core/ui/grid/editors/editors/date.js","../sources/core/ui/grid/editors/editors/predecessor.js","../sources/core/ui/grid/editors/editors/duration.js","../sources/core/ui/grid/editors/linked_properties.js","../sources/core/ui/grid/editors/controller.js","../sources/core/ui/grid/editors/keyboard_mappings.js","../sources/core/ui/render/viewport/is_bar_in_viewport.js","../sources/core/ui/render/task_bar_render.js","../sources/core/ui/render/viewport/is_project_bar_in_viewport.js","../sources/core/ui/render/task_project_render.js","../sources/core/ui/render/viewport/is_split_task_in_viewport.js","../sources/core/ui/render/viewport/get_bg_row_rectangle.js","../sources/core/ui/render/viewport/get_visible_cells_range.js","../sources/core/ui/render/viewport/is_column_visible.js","../sources/core/ui/render/prerender/task_bg_placeholder.js","../sources/core/ui/render/link_render.js","../sources/core/ui/render/viewport/is_grid_row_in_viewport.js","../sources/core/resource_timetable_builder.js","../sources/core/ui/render/resource_histogram_render.js","../sources/core/ui/render/viewport/are_dates_in_viewport.js","../sources/core/ui/render/task_constraints_render.js","../sources/core/ui/render/task_deadline_render.js","../sources/core/ui/render/task_baselines_render.js","../sources/core/ui/grid/tasks_grid_dnd.js","../sources/core/ui/grid/tasks_grid_dnd_marker_helpers/drop_target.js","../sources/core/ui/grid/tasks_grid_dnd_marker_helpers/locked_level.js","../sources/core/ui/grid/tasks_grid_dnd_marker_helpers/highlight.js","../sources/core/ui/grid/tasks_grid_dnd_marker.js","../sources/core/ui/grid/tasks_grid_dnd_marker_helpers/multi_level.js","../sources/core/ui/grid/main_grid_initializer.js","../sources/core/ui/timeline/tasks_dnd.js","../sources/core/ui/timeline/links_dnd.js","../sources/core/ui/timeline/main_timeline_initializer.js","../sources/core/ui/main_layout_initializer.js","../sources/core/ui/index.js","../sources/core/ui/render/task_grid_line_render.js","../sources/core/ui/render/task_bg_render.js","../sources/core/ui/render/task_bar_smart_render.js","../sources/core/ui/render/task_project_smart_render.js","../sources/core/ui/render/task_rollup_render.js","../sources/core/ui/render/task_split_render.js","../sources/core/ui/render/resource_matrix_render.js","../sources/core/ui/render/task_grid_row_resize_render.js","../sources/core/ui/skin.js","../sources/core/ui/plugins/autoscroll.js","../sources/core/ui/plugins/jquery_hooks.js","../sources/core/ui/plugins/dhtmlx_hooks.js","../sources/core/ui/plugins/timeline_zoom.ts","../sources/core/ui/touch.js","../sources/core/ui/lightbox/controls/base_control.js","../sources/core/ui/utils/html_helpers.js","../sources/core/ui/lightbox/controls/select_control.js","../sources/core/common/duration_formatter_numeric.ts","../sources/core/ui/lightbox/controls/parent_control.js","../sources/core/ui/lightbox/controls/resources_control.js","../sources/core/ui/lightbox/controls/resource_selector_control.js","../sources/core/ui/lightbox/index.js","../sources/core/ui/lightbox/controls/template_control.js","../sources/core/ui/lightbox/controls/textarea_control.js","../sources/core/ui/lightbox/controls/time_control.js","../sources/core/ui/lightbox/controls/checkbox_control.js","../sources/core/ui/lightbox/controls/radio_control.js","../sources/core/ui/lightbox/controls/duration_control.js","../sources/core/ui/lightbox/controls/constraint_control.js","../sources/core/ui/lightbox/controls/typeselect_control.js","../sources/core/ui/lightbox/controls/baseline_control.js","../sources/core/ui_core.js","../sources/core/facades/layout.js","../sources/css/skins/skyblue.js","../sources/css/skins/dark.js","../sources/css/skins/meadow.js","../sources/css/skins/terrace.js","../sources/css/skins/broadway.js","../sources/css/skins/material.js","../sources/css/skins/contrast_black.js","../sources/css/skins/contrast_white.js","../sources/core/ui/plugins/index.js","../sources/core/ui/lightbox/lightbox_optional_time.js","../sources/core/ui/wai_aria.js","../sources/core/loading/dynamic_loading.js","../sources/dhtmlxgantt.web.ts","../sources/factory/gantt_factory.ts","../sources/factory/make_instance_web.js","../sources/core/loading/ajax_loading.js","../sources/dhtmlxgantt.enterprise.ts"],"sourcesContent":["export default function (gantt) {\n\t// helpers for building chain of dependencies, used for critical path calculation and for auto scheduling\n\n\tgantt._get_linked_task = function (link, getTarget) {\n\t\tvar task = null;\n\t\tvar taskId = getTarget ? link.target : link.source;\n\n\t\tif (gantt.isTaskExists(taskId)) {\n\t\t\ttask = gantt.getTask(taskId);\n\t\t}\n\n\t\treturn task;\n\t};\n\tgantt._get_link_target = function (link) {\n\t\treturn gantt._get_linked_task(link, true);\n\t};\n\n\tgantt._get_link_source = function (link) {\n\t\treturn gantt._get_linked_task(link, false);\n\t};\n\n\tvar caching = false;\n\tvar formattedLinksStash = {};\n\tvar inheritedSuccessorsStash = {};\n\tvar inheritedPredecessorsStash = {};\n\tvar getPredecessorsCache = {};\n\n\n\tgantt._isLinksCacheEnabled = function () {\n\t\treturn caching;\n\t};\n\tgantt._startLinksCache = function () {\n\t\tformattedLinksStash = {};\n\t\tinheritedSuccessorsStash = {};\n\t\tinheritedPredecessorsStash = {};\n\t\tgetPredecessorsCache = {};\n\t\tcaching = true;\n\t};\n\tgantt._endLinksCache = function () {\n\t\tformattedLinksStash = {};\n\t\tinheritedSuccessorsStash = {};\n\t\tinheritedPredecessorsStash = {};\n\t\tgetPredecessorsCache = {};\n\t\tcaching = false;\n\t};\n\n\tfunction isManuallyScheduledSummary(task){\n\t\treturn gantt.isSummaryTask(task) && task.auto_scheduling === false;\n\t}\n\n\tgantt._formatLink = function (link, sourceDates, targetDates) {\n\n\n\t\tif (caching && formattedLinksStash[link.id]) {\n\t\t\treturn formattedLinksStash[link.id];\n\t\t}\n\n\t\tvar relations = [];\n\t\tvar target = this._get_link_target(link);\n\t\tvar source = this._get_link_source(link);\n\n\t\tif (!(source && target)) {\n\t\t\treturn relations;\n\t\t}\n\n\t\tif ((gantt.isSummaryTask(target) && gantt.isChildOf(source.id, target.id)) || (gantt.isSummaryTask(source) && gantt.isChildOf(target.id, source.id))) {\n\t\t\treturn relations;\n\t\t}\n\n\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\n\t\tvar backwardsScheduling = autoSchedulingConfig.schedule_from_end && gantt.config.project_end;\n\t\tvar respectTargetOffset = autoSchedulingConfig.move_projects;\n\t\tif(autoSchedulingConfig.apply_constraints && autoSchedulingConfig.gap_behavior === \"compress\"){\n\t\t\trespectTargetOffset = false;\n\t\t}\n\n\n\n\t\t// there are three kinds of connections at this point\n\t\t// task -> task - regular link\n\t\t// task -> project - transform it into set of regular links (task -> [each subtask]), use offset beetween subtask and project dates as lag, in order not to change mutual positions of subtasks inside a project\n\t\t// project -> task - transform it into ([each subtask] -> task) links\n\t\t// project -> project - transform it into ([each subtask of p1] -> [each subtask of p2]) links\n\t\tsourceDates = sourceDates || (this.isSummaryTask(source) && !isManuallyScheduledSummary(source)) ? this.getSubtaskDates(source.id) : {\n\t\t\tstart_date: source.start_date,\n\t\t\tend_date: source.end_date\n\t\t};\n\n\t\tvar from = this._getImplicitLinks(link, source, function (c) {\n\t\t\tif(!respectTargetOffset || !backwardsScheduling){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\tif (!c.$source.length && !(gantt.getState(\"tasksDnd\").drag_id == c.id)) {\n\t\t\t\t\t// drag_id - virtual lag shouldn't restrict task that is being moved inside project\n\t\t\t\t\treturn gantt.calculateDuration({\n\t\t\t\t\t\tstart_date: c.end_date,\n\t\t\t\t\t\tend_date: sourceDates.end_date,\n\t\t\t\t\t\ttask: source\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}, true);\n\n\t\tif (!targetDates){\n\t\t\ttargetDates = {\n\t\t\t\tstart_date: target.start_date,\n\t\t\t\tend_date: target.end_date\n\t\t\t};\n\t\t\tif (this.isSummaryTask(target) && !isManuallyScheduledSummary(target)){\n\t\t\t\ttargetDates = this.getSubtaskDates(target.id);\n\t\t\t\ttargetDates.start_date = targetDates.end_date;\n\t\t\t\t// GS-2427. When a successor starts earlier its predecessor, we should\n\t\t\t\t// obtain the dates of the predecessor\n\t\t\t\tthis.eachTask(function(child){\n\t\t\t\t\t// exclude projects as their dates are unreliable until the scheduling is done\n\t\t\t\t\tif (child.type === this.config.types.project){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (!child.$target.length && child.start_date < targetDates.start_date){\n\t\t\t\t\t\ttargetDates.start_date = child.start_date;\n\t\t\t\t\t}\n\t\t\t\t},target.id);\n\t\t\t}\n\t\t}\n\n\t\tvar to = this._getImplicitLinks(link, target, function (actualTarget) {\n\t\t\tif (!respectTargetOffset || backwardsScheduling) {\n\t\t\t\treturn 0;\n\t\t\t} else {\n\t\t\t\tif (!actualTarget.$target.length && !(gantt.getState(\"tasksDnd\").drag_id == actualTarget.id)) {// drag_id - virtual lag shouldn't restrict task that is being moved inside project\n\t\t\t\t\treturn gantt.calculateDuration({\n\t\t\t\t\t\tstart_date: targetDates.start_date,\n\t\t\t\t\t\tend_date: actualTarget.start_date,\n\t\t\t\t\t\ttask: target\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tfor (var i = 0, fromLength = from.length; i < fromLength; i++) {\n\t\t\tvar fromTask = from[i];\n\t\t\tfor (var j = 0, toLength = to.length; j < toLength; j++) {\n\t\t\t\tvar toTask = to[j];\n\n\t\t\t\tvar lag = fromTask.lag * 1 + toTask.lag * 1;\n\n\t\t\t\tvar subtaskLink = {\n\t\t\t\t\tid: link.id,\n\t\t\t\t\ttype: link.type,\n\t\t\t\t\tsource: fromTask.task,\n\t\t\t\t\ttarget: toTask.task,\n\t\t\t\t\tsubtaskLink: fromTask.subtaskLink,\n\t\t\t\t\tlag: (link.lag * 1 || 0) + lag\n\t\t\t\t};\n\n\t\t\t\tgantt._linkedTasks[subtaskLink.target] = gantt._linkedTasks[subtaskLink.target] || {};\n\t\t\t\tgantt._linkedTasks[subtaskLink.target][subtaskLink.source] = true;\n\n\t\t\t\trelations.push(gantt._convertToFinishToStartLink(toTask.task, subtaskLink, source, target, fromTask.taskParent, toTask.taskParent));\n\t\t\t}\n\t\t}\n\n\t\tif (caching)\n\t\t\tformattedLinksStash[link.id] = relations;\n\n\t\treturn relations;\n\t};\n\n\tgantt._isAutoSchedulable = function (task) {\n\t\tconst scheduleTask = task.auto_scheduling !== false && task.unscheduled !== true;\n\t\tif (!scheduleTask){\n\t\t\treturn false;\n\t\t}\n\t\t// GS-2420. Don't auto-schedule project when it has only unscheduled children\n\t\tif (this.isSummaryTask(task)){\n\t\t\tlet unscheduledChildren = true;\n\t\t\tthis.eachTask(function(child){\n\t\t\t\tif (unscheduledChildren){\n\t\t\t\t\tconst scheduleChild = gantt._isAutoSchedulable(child);\n\t\t\t\t\tif (scheduleChild){\n\t\t\t\t\t\tunscheduledChildren = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, task.id);\n\t\t\tif (unscheduledChildren){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t};\n\n\tgantt._getImplicitLinks = function (link, parent, selectOffset, selectSourceLinks) {\n\t\tvar relations = [];\n\n\t\tif (this.isSummaryTask(parent) && !isManuallyScheduledSummary(parent)) {\n\n\t\t\t// if the summary task contains multiple chains of linked tasks - no need to consider every task of the chain,\n\t\t\t// it will be enough to check the first/last tasks of the chain\n\t\t\t// special conditions if there are unscheduled tasks in the chain, or negative lag values that put the end date of the successor task prior to its predecessors' date\n\t\t\tvar children = {};\n\t\t\tthis.eachTask(function (c) {\n\t\t\t\tif (!this.isSummaryTask(c) || isManuallyScheduledSummary(c)) {\n\t\t\t\t\tchildren[c.id] = c;\n\t\t\t\t}\n\t\t\t}, parent.id);\n\n\t\t\tvar skipChild;\n\n\t\t\tfor (var c in children) {\n\t\t\t\tvar task = children[c];\n\t\t\t\t// don't create subtask links with unscheduled tasks\n\t\t\t\tif (!gantt._isAutoSchedulable(task)){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tvar linksCollection = selectSourceLinks ? task.$source : task.$target;\n\n\t\t\t\tskipChild = false;\n\n\t\t\t\tfor (var l = 0; l < linksCollection.length; l++) {\n\t\t\t\t\t// GS-2014 and GS-2588. If the link type is SS or SF, we shouldn't change the skipChild variable\n\t\t\t\t\t// because the target task should be moved to an earlier date\n\t\t\t\t\tif (link.type == gantt.config.links.start_to_start || link.type == gantt.config.links.start_to_finish){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tvar siblingLink = gantt.getLink(linksCollection[l]);\n\t\t\t\t\tvar siblingId = selectSourceLinks ? siblingLink.target : siblingLink.source;\n\t\t\t\t\tvar siblingTask = children[siblingId];\n\t\t\t\t\tif (siblingTask && gantt._isAutoSchedulable(task) && gantt._isAutoSchedulable(siblingTask)) {\n\t\t\t\t\t\tlet linkLag = 0;\n\t\t\t\t\t\tif (siblingLink.lag){\n\t\t\t\t\t\t\tlinkLag = Math.abs(siblingLink.lag);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// GS-2014 and GS-2588. If the link type is not FS, the actual lag will be different\n\t\t\t\t\t\tif (siblingLink.type != gantt.config.links.finish_to_start){\n\t\t\t\t\t\t\tlinkLag += gantt._convertToFinishToStartLink(null, {}, task, siblingTask).additionalLag;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst sameTarget = siblingLink.target == siblingTask.id;\n\t\t\t\t\t\tconst insignificantTargetLag = sameTarget && linkLag && linkLag <= siblingTask.duration;\n\n\t\t\t\t\t\tconst sameSource = siblingLink.target == task.id;\n\t\t\t\t\t\tconst insignificantSourceLag = sameSource && linkLag && linkLag <= task.duration;\n\n\t\t\t\t\t\tif (insignificantTargetLag || insignificantSourceLag) {\n\t\t\t\t\t\t\tskipChild = true;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!skipChild) {\n\t\t\t\t\t// GS-1689. If a task has links between other tasks within the project,\n\t\t\t\t\t// Gantt shouldn't try to keep the position within the project\n\t\t\t\t\tlet calculateLag = true;\n\t\t\t\t\tfor (const predecessorId in gantt._linkedTasks[task.id]){\n\t\t\t\t\t\tif (gantt.isChildOf(predecessorId, link.target)){\n\t\t\t\t\t\t\tcalculateLag = false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tlet offsetLag = 0;\n\t\t\t\t\tif (calculateLag) {\n\t\t\t\t\t\toffsetLag = selectOffset(task);\n\t\t\t\t\t}\n\t\t\t\t\trelations.push({ task: task.id, taskParent: task.parent, lag: offsetLag, subtaskLink: true });\n\t\t\t\t}\n\t\t\t}\n\n\t\t} else {\n\t\t\trelations.push({ task: parent.id, taskParent: parent.parent, lag: 0 });\n\t\t}\n\n\t\treturn relations;\n\t};\n\n\tgantt._getDirectDependencies = function (task, selectSuccessors) {\n\t\tgantt._linkedTasks = gantt._linkedTasks || {};\n\n\t\tvar links = [],\n\t\t\tsuccessors = [];\n\n\t\tvar linksIds = selectSuccessors ? task.$source : task.$target;\n\n\t\tfor (var i = 0; i < linksIds.length; i++) {\n\t\t\tvar link = this.getLink(linksIds[i]);\n\t\t\tif (this.isTaskExists(link.source) && this.isTaskExists(link.target)) {\n\t\t\t\tvar target = this.getTask(link.target);\n\t\t\t\tif (!this._isAutoSchedulable(target) || !this._isAutoSchedulable(task)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t} else if(gantt._getAutoSchedulingConfig().use_progress) {\n\t\t\t\t\tif(target.progress == 1){\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tlinks.push(link);\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tlinks.push(link);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (var i = 0; i < links.length; i++) {\n\t\t\tsuccessors = successors.concat(this._formatLink(links[i]));\n\t\t}\n\n\t\treturn successors;\n\t};\n\n\tgantt._getInheritedDependencies = function (task, selectSuccessors) {\n\n\t\t//var successors = [];\n\t\tvar stop = false;\n\t\tvar inheritedRelations = [];\n\t\tvar cacheCollection;\n\t\tif (this.isTaskExists(task.id)) {\n\t\t\tthis.eachParent(function (parent) {\n\t\t\t\tif (stop)\n\t\t\t\t\treturn;\n\n\t\t\t\tif (caching) {\n\t\t\t\t\tcacheCollection = selectSuccessors ? inheritedSuccessorsStash : inheritedPredecessorsStash;\n\t\t\t\t\tif (cacheCollection[parent.id]) {\n\t\t\t\t\t\tinheritedRelations = inheritedRelations.concat(cacheCollection[parent.id]);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar parentDependencies;\n\t\t\t\tif (this.isSummaryTask(parent)) {\n\t\t\t\t\tif (!this._isAutoSchedulable(parent)) {\n\t\t\t\t\t\tstop = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tparentDependencies = this._getDirectDependencies(parent, selectSuccessors);\n\t\t\t\t\t\tif (caching) {\n\t\t\t\t\t\t\tcacheCollection[parent.id] = parentDependencies;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tinheritedRelations = inheritedRelations.concat(parentDependencies);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}, task.id, this);\n\t\t}\n\n\t\treturn inheritedRelations;\n\t};\n\n\n\tgantt._getDirectSuccessors = function (task) {\n\t\treturn this._getDirectDependencies(task, true);\n\t};\n\n\tgantt._getInheritedSuccessors = function (task) {\n\t\treturn this._getInheritedDependencies(task, true);\n\t};\n\n\tgantt._getDirectPredecessors = function (task) {\n\t\treturn this._getDirectDependencies(task, false);\n\t};\n\n\tgantt._getInheritedPredecessors = function (task) {\n\t\treturn this._getInheritedDependencies(task, false);\n\t};\n\n\tgantt._getSuccessors = function (task, skipInherited) {\n\t\tvar successors = this._getDirectSuccessors(task);\n\t\tif (skipInherited) {\n\t\t\treturn successors;\n\t\t} else {\n\t\t\treturn successors.concat(this._getInheritedSuccessors(task));\n\t\t}\n\t};\n\n\tgantt._getPredecessors = function (task, skipInherited) {\n\t\tvar key = String(task.id) + \"-\" + String(skipInherited);\n\t\tvar result;\n\n\t\tif (caching && getPredecessorsCache[key]) {\n\t\t\treturn getPredecessorsCache[key];\n\t\t}\n\n\t\tvar predecessors = this._getDirectPredecessors(task);\n\t\tif (skipInherited) {\n\t\t\tresult = predecessors;\n\t\t} else {\n\t\t\tresult = predecessors.concat(this._getInheritedPredecessors(task));\n\t\t}\n\t\tif (caching) {\n\t\t\tgetPredecessorsCache[key] = result;\n\t\t}\n\t\treturn result;\n\t};\n\n\n\tgantt._convertToFinishToStartLink = function (id, link, sourceTask, targetTask, sourceParent, targetParent) {\n\t\t// convert finish-to-finish, start-to-finish and start-to-start to finish-to-start link and provide some additional properties\n\t\tvar res = {\n\t\t\ttarget: id,\n\t\t\tlink: gantt.config.links.finish_to_start,\n\t\t\tid: link.id,\n\t\t\tlag: link.lag || 0,\n\t\t\tsourceLag: 0,\n\t\t\ttargetLag: 0,\n\t\t\ttrueLag: link.lag || 0,\n\t\t\tsource: link.source,\n\t\t\tpreferredStart: null,\n\t\t\tsourceParent: sourceParent,\n\t\t\ttargetParent: targetParent,\n\t\t\thashSum: null,\n\t\t\tsubtaskLink: link.subtaskLink\n\t\t};\n\t\t// GS-148: switch uses strict comparison, so we need to convert the values to the same type\n\t\tvar additionalLag = 0;\n\t\tswitch (String(link.type)) {\n\t\t\tcase String(gantt.config.links.start_to_start):\n\t\t\t\tadditionalLag = -sourceTask.duration;\n\t\t\t\tres.sourceLag = additionalLag;\n\t\t\t\tbreak;\n\t\t\tcase String(gantt.config.links.finish_to_finish):\n\t\t\t\tadditionalLag = -targetTask.duration;\n\t\t\t\tres.targetLag = additionalLag;\n\t\t\t\tbreak;\n\t\t\tcase String(gantt.config.links.start_to_finish):\n\t\t\t\tadditionalLag = -sourceTask.duration - targetTask.duration;\n\t\t\t\tres.sourceLag = -sourceTask.duration;\n\t\t\t\tres.targetLag = -targetTask.duration;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tadditionalLag = 0;\n\t\t}\n\n\t\tres.lag += additionalLag;\n\t\tres.hashSum = res.lag + \"_\" + res.link + \"_\" + res.source + \"_\" + res.target;\n\t\treturn res;\n\t};\n};","var units = {\n\t\"second\": 1,\n\t\"minute\": 60,\n\t\"hour\": 60 * 60,\n\t\"day\": 60 * 60 * 24,\n\t\"week\": 60 * 60 * 24 * 7,\n\t\"month\": 60 * 60 * 24 * 30,\n\t\"quarter\": 60 * 60 * 24 * 30 * 3,\n\t\"year\": 60 * 60 * 24 * 365\n};\nfunction getSecondsInUnit(unit){\n\treturn units[unit] || units.hour;\n}\n\nfunction forEach(arr, callback) {\n\tif (arr.forEach) {\n\t\tarr.forEach(callback);\n\t} else {\n\t\tvar workArray = arr.slice();\n\t\tfor (var i = 0; i < workArray.length; i++) {\n\t\t\tcallback(workArray[i], i);\n\t\t}\n\t}\n}\n\nfunction arrayMap(arr, callback) {\n\tif (arr.map) {\n\t\treturn arr.map(callback);\n\t} else {\n\t\tvar workArray = arr.slice();\n\t\tvar resArray = [];\n\n\t\tfor (var i = 0; i < workArray.length; i++) {\n\t\t\tresArray.push(callback(workArray[i], i));\n\t\t}\n\t\treturn resArray;\n\t}\n}\n\n\nfunction arrayFind(arr, callback) {\n\tif (arr.find) {\n\t\treturn arr.find(callback);\n\t} else {\n\t\tfor (var i = 0; i < arr.length; i++) {\n\t\t\tif (callback(arr[i], i)) {\n\t\t\t\treturn arr[i];\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction arrayIncludes(arr, item) {\n\tif(arr.includes){\n\t\treturn arr.includes(item);\n\t}else{\n\t\tfor (var i = 0; i < arr.length; i++) {\n\t\t\tif (arr[i] === item) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n\n// iframe-safe array type check instead of using instanceof\nfunction isArray(obj){\n\tif(Array.isArray){\n\t\treturn Array.isArray(obj);\n\t}else{\n\t\t// close enough\n\t\treturn (obj && obj.length !== undefined && obj.pop && obj.push);\n\t}\n}\n\n// non-primitive string object, e.g. new String(\"abc\")\nfunction isStringObject(obj){\n\treturn obj && typeof obj === \"object\"\n\t\t&& Function.prototype.toString.call(obj.constructor) === \"function String() { [native code] }\";\n}\n\n// non-primitive number object, e.g. new Number(5)\nfunction isNumberObject(obj){\n\treturn obj && typeof obj === \"object\"\n\t\t&& Function.prototype.toString.call(obj.constructor) === \"function Number() { [native code] }\";\n}\n\n// non-primitive number object, e.g. new Boolean(true)\nfunction isBooleanObject(obj){\n\treturn obj && typeof obj === \"object\"\n\t\t&& Function.prototype.toString.call(obj.constructor) === \"function Boolean() { [native code] }\";\n}\n\nfunction isDate(obj) {\n\tif (obj && typeof obj === \"object\") {\n\t\treturn !!(obj.getFullYear && obj.getMonth && obj.getDate);\n\t} else {\n\t\treturn false;\n\t}\n}\n\nfunction isValidDate(obj){\n\treturn isDate(obj) && !isNaN(obj.getTime());\n}\n\nfunction arrayFilter(arr, callback) {\n\tvar result = [];\n\n\tif (arr.filter) {\n\t\treturn arr.filter(callback);\n\t} else {\n\t\tfor (var i = 0; i < arr.length; i++) {\n\t\t\tif (callback(arr[i], i)) {\n\t\t\t\tresult[result.length] = arr[i];\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n}\n\nfunction hashToArray(hash) {\n\tvar result = [];\n\n\tfor (var key in hash) {\n\t\tif (hash.hasOwnProperty(key)) {\n\t\t\tresult.push(hash[key]);\n\t\t}\n\t}\n\n\treturn result;\n}\n\nfunction arraySome(arr, callback) {\n\tif (arr.length === 0) return false;\n\n\tfor (var i = 0; i < arr.length; i++) {\n\t\tif (callback(arr[i], i, arr)) {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nfunction arrayDifference(arr, callback) {\n\treturn arrayFilter(arr, function(item, i) {\n\t\treturn !callback(item, i);\n\t});\n}\n\nfunction throttle (callback, timeout) {\n\tvar wait = false;\n\n\treturn function () {\n\t\tif (!wait) {\n\t\t\tcallback.apply(null, arguments);\n\t\t\twait = true;\n\t\t\tsetTimeout(function () {\n\t\t\t\twait = false;\n\t\t\t}, timeout);\n\t\t}\n\t};\n}\n\nfunction delay (callback, timeout){\n\tvar timer;\n\n\tvar result = function() {\n\t\tresult.$cancelTimeout();\n\t\tresult.$pending = true;\n\t\tvar args = Array.prototype.slice.call(arguments);\n\t\ttimer = setTimeout(function(){\n\t\t\tcallback.apply(this, args);\n\t\t\tresult.$pending = false;\n\t\t}, timeout);\n\t};\n\n\tresult.$pending = false;\n\tresult.$cancelTimeout = function(){\n\t\tclearTimeout(timer);\n\t\tresult.$pending = false;\n\t};\n\tresult.$execute = function(){\n\t\tvar args = Array.prototype.slice.call(arguments);\n\t\tcallback.apply(this, args);\n\t\tresult.$cancelTimeout();\n\t};\n\n\treturn result;\n}\n\nfunction sortArrayOfHash(arr, field, desc) {\n\tvar compare = function(a, b) {\n\t\treturn a < b;\n\t};\n\n\tarr.sort(function(a, b) {\n\t\tif (a[field] === b[field]) return 0;\n\n\t\treturn desc ? compare(a[field], b[field]) : compare(b[field], a[field]);\n\t});\n}\n\nfunction objectKeys(obj) {\n\tif (Object.keys) {\n\t\treturn Object.keys(obj);\n\t}\n\tvar result = [];\n\tvar key;\n\tfor (key in obj) {\n\t\tif (Object.prototype.hasOwnProperty.call(obj, key)) {\n\t\t\tresult.push(key);\n\t\t}\n\t}\n\treturn result;\n}\n\nfunction isEventable(obj) {\n\treturn obj.attachEvent && obj.detachEvent;\n}\n\n//GS-1090: A task should be able to have the id = 0\nfunction replaceValidZeroId(id, rootId) {\n\tif (checkZeroId(id) && !checkZeroId(rootId)){\n\t\tid = \"0\";\n\t}\n\treturn id;\n}\n\nfunction checkZeroId(id) {\n\tif (id === 0){\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nfunction findBinary(array, target) {\n\t// modified binary search, target value not exactly match array elements, looking for closest one\n\n\tvar low = 0, high = array.length - 1, i, item, prev;\n\twhile (low <= high) {\n\n\t\ti = Math.floor((low + high) / 2);\n\t\titem = +array[i];\n\t\tprev = +array[i - 1];\n\t\tif (item < target) {\n\t\t\tlow = i + 1;\n\t\t\tcontinue;\n\t\t}\n\t\tif (item > target) {\n\t\t\tif (!(!isNaN(prev) && prev < target)) {\n\t\t\t\thigh = i - 1;\n\t\t\t\tcontinue;\n\t\t\t} else {\n\t\t\t\t// if target is between 'i' and 'i-1' return 'i - 1'\n\t\t\t\treturn i - 1;\n\t\t\t}\n\n\t\t}\n\t\twhile (+array[i] == +array[i + 1]) i++;\n\n\t\treturn i;\n\t}\n\treturn array.length - 1;\n}\n\nexport {\n\tgetSecondsInUnit,\n\tforEach,\n\tarrayMap,\n\tarrayIncludes,\n\tarrayFind,\n\tarrayFilter,\n\tarrayDifference,\n\tarraySome,\n\thashToArray,\n\tsortArrayOfHash,\n\tthrottle,\n\tisArray,\n\tisDate,\n\tisValidDate,\n\tisStringObject,\n\tisNumberObject,\n\tisBooleanObject,\n\tdelay,\n\tobjectKeys,\n\tisEventable,\n\treplaceValidZeroId,\n\tcheckZeroId,\n\tfindBinary\n};","import * as helpers from \"../../utils/helpers\";\n\nexport default function(){\n\treturn {\n\t\tgetVertices: function(relations){\n\t\t\tvar ids = {};\n\t\t\tvar rel;\n\t\t\tfor(var i = 0, len = relations.length; i < len; i++){\n\t\t\t\trel = relations[i];\n\t\t\t\tids[rel.target] = rel.target;\n\t\t\t\tids[rel.source] = rel.source;\n\t\t\t}\n\n\t\t\tvar vertices = [];\n\t\t\tvar id;\n\t\t\tfor(var i in ids){\n\t\t\t\tid = ids[i];\n\t\t\t\tvertices.push(id);\n\t\t\t}\n\n\t\t\treturn vertices;\n\t\t},\n\t\ttopologicalSort: function(edges){\n\t\t\tvar vertices = this.getVertices(edges);\n\t\t\tvar hash = {};\n\n\t\t\tfor(var i = 0, len = vertices.length; i < len; i ++){\n\t\t\t\thash[vertices[i]] = {id: vertices[i], $source:[], $target:[], $incoming: 0};\n\t\t\t}\n\n\t\t\tfor(var i = 0, len = edges.length; i < len; i++){\n\t\t\t\tvar successor = hash[edges[i].target];\n\t\t\t\tsuccessor.$target.push(i);\n\t\t\t\tsuccessor.$incoming = successor.$target.length;\n\t\t\t\thash[edges[i].source].$source.push(i);\n\n\t\t\t}\n\n\t\t\t// topological sort, Kahn's algorithm\n\t\t\tvar S = vertices.filter(function(v){ return !hash[v].$incoming; });\n\n\t\t\tvar L = [];\n\n\t\t\twhile(S.length){\n\t\t\t\tvar n = S.pop();\n\n\t\t\t\tL.push(n);\n\n\t\t\t\tvar node = hash[n];\n\n\t\t\t\tfor(var i = 0; i < node.$source.length; i++){\n\t\t\t\t\tvar m = hash[edges[node.$source[i]].target];\n\t\t\t\t\tm.$incoming--;\n\t\t\t\t\tif(!m.$incoming){\n\t\t\t\t\t\tS.push(m.id);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn L;\n\n\t\t},\n\t\tgroupAdjacentEdges: function(edges){\n\t\t\tvar res = {};\n\t\t\tvar edge;\n\t\t\tfor(var i = 0, len = edges.length; i < len; i++){\n\t\t\t\tedge = edges[i];\n\t\t\t\tif(!res[edge.source]){\n\t\t\t\t\tres[edge.source] = [];\n\t\t\t\t}\n\t\t\t\tres[edge.source].push(edge);\n\t\t\t}\n\t\t\treturn res;\n\t\t},\n\t\ttarjanStronglyConnectedComponents: function(vertices, edges){\n\t\t\t//https://en.wikipedia.org/wiki/Tarjan%27s_strongly_connected_components_algorithm\n\t\t\t// iterative implementation\n\t\t\tvar verticesHash = {};\n\t\t\tvar stack = [];\n\t\t\tvar edgesFromTasks = this.groupAdjacentEdges(edges);\n\t\t\tvar recurse = false;\n\t\t\tvar connectedComponents = [];\n\n\t\t\tfor(var i = 0; i < vertices.length; i++){\n\t\t\t\tvar root = getVertex(vertices[i]);\n\t\t\t\tif(root.visited) continue;\n\t\t\t\tvar workStack = [root];\n\t\t\t\tvar index = 0;\n\t\t\t\twhile(workStack.length){\n\t\t\t\t\tvar v = workStack.pop();\n\n\t\t\t\t\tif(!v.visited){\n\t\t\t\t\t\tv.index = index;\n\t\t\t\t\t\tv.lowLink = index;\n\t\t\t\t\t\tindex++;\n\t\t\t\t\t\tstack.push(v);\n\t\t\t\t\t\tv.onStack = true;\n\t\t\t\t\t\tv.visited = true;\n\t\t\t\t\t}\n\t\t\t\t\trecurse = false;\n\t\t\t\t\tvar edges = edgesFromTasks[v.id] || [];\n\t\t\t\t\tfor(var e = 0; e < edges.length; e++){\n\t\t\t\t\t\tvar w = getVertex(edges[e].target);\n\t\t\t\t\t\tw.edge = edges[e];\n\t\t\t\t\t\tif(w.index === undefined){\n\t\t\t\t\t\t\tworkStack.push(v);\n\t\t\t\t\t\t\tworkStack.push(w);\n\t\t\t\t\t\t\trecurse = true;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}else if(w.onStack){\n\t\t\t\t\t\t\tv.lowLink = Math.min(v.lowLink, w.index);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(recurse)\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tif (v.index == v.lowLink){\n\t\t\t\t\t\tvar com = {tasks:[], links:[], linkKeys:[]};\n\t\t\t\t\t\twhile(true){\n\t\t\t\t\t\t\tw = stack.pop();\n\t\t\t\t\t\t\tw.onStack = false;\n\t\t\t\t\t\t\tcom.tasks.push(w.id);\n\t\t\t\t\t\t\tif(w.edge){\n\t\t\t\t\t\t\t\tcom.links.push(w.edge.id);\n\t\t\t\t\t\t\t\tcom.linkKeys.push(w.edge.hashSum);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(w == v){\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconnectedComponents.push(com);\n\t\t\t\t\t}\n\t\t\t\t\tif(workStack.length){\n\t\t\t\t\t\tw = v;\n\t\t\t\t\t\tv = workStack[workStack.length - 1];\n\t\t\t\t\t\tv.lowLink = Math.min(v.lowLink, w.lowLink);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn connectedComponents;\n\n\t\t\tfunction getVertex(id){\n\t\t\t\tif(!verticesHash[id]){\n\t\t\t\t\tverticesHash[id] = {id: id, onStack:false, index: undefined, lowLink: undefined, edge: undefined};\n\t\t\t\t}\n\n\t\t\t\treturn verticesHash[id];\n\t\t\t}\n\t\t},\n\n\t\tfindLoops: function(relations){\n\t\t\tvar cycles = [];\n\n\t\t\thelpers.forEach(relations, function(rel){\n\t\t\t\tif(rel.target == rel.source)\n\t\t\t\t\tcycles.push({ tasks: [rel.source], links: [rel.id]});\n\t\t\t});\n\n\t\t\tvar vertices = this.getVertices(relations);\n\n\t\t\tvar connectedComponents = this.tarjanStronglyConnectedComponents(vertices, relations);\n\t\t\thelpers.forEach(connectedComponents, function(component){\n\t\t\t\tif(component.tasks.length > 1){\n\t\t\t\t\tcycles.push(component);//{ tasks: [task ids], links: [links ids]}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn cycles;\n\t\t\t//{task:id, link:link.type, lag: link.lag || 0, source: link.source}\n\t\t}\n\t};\n};","export default function(gantt) {\n\treturn {\n\t\tgetVirtualRoot: function(){\n\t\t\treturn gantt.mixin(\n\t\t\t\tgantt.getSubtaskDates(),\n\t\t\t\t{\n\t\t\t\t\tid: gantt.config.root_id,\n\t\t\t\t\ttype: gantt.config.types.project,\n\t\t\t\t\t$source: [],\n\t\t\t\t\t$target: [],\n\t\t\t\t\t$virtual: true\n\t\t\t\t}\n\t\t\t);\n\t\t},\n\t\n\t\tgetLinkedTasks: function(id, includePredecessors){\n\t\t\tvar startIds = [id];\n\t\n\t\t\t//TODO: format links cache\n\t\t\tvar clearCache = false;\n\t\t\tif(!gantt._isLinksCacheEnabled()) {\n\t\t\t\tgantt._startLinksCache();\n\t\t\t\tclearCache = true;\n\t\t\t}\n\t\t\tvar relations = [];\n\t\t\tvar visited = {};\n\t\t\tvar result = {};\n\t\t\tfor(var i = 0; i < startIds.length; i++){\n\t\t\t\tthis._getLinkedTasks(startIds[i], visited, includePredecessors, result);\n\t\t\t}\n\t\n\t\t\tfor(var i in result){\n\t\t\t\trelations.push(result[i]);\n\t\t\t}\n\t\n\t\t\t//TODO: remove redundant edges before continue https://en.wikipedia.org/wiki/Transitive_reduction\n\t\t\tif(clearCache)\n\t\t\t\tgantt._endLinksCache();\n\t\t\treturn relations;\n\t\t},\n\t\n\t\t_collectRelations: function(rootObj, isChild, includePredecessors, visitedLinks){\n\t\t\tvar successors = gantt._getSuccessors(rootObj, isChild);\n\t\n\t\t\tvar predecessors = [];\n\t\t\tif (includePredecessors) {\n\t\t\t\tpredecessors = gantt._getPredecessors(rootObj, isChild);\n\t\t\t}\n\t\t\t\n\t\t\tvar linkKey;\n\t\t\tvar relations = [];\n\t\t\tfor(var i = 0; i < successors.length; i++){\n\t\t\t\tlinkKey = successors[i].hashSum;\n\t\t\t\tif(visitedLinks[linkKey]) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}else{\n\t\t\t\t\tvisitedLinks[linkKey] = true;\n\t\t\t\t\trelations.push(successors[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(var i = 0; i < predecessors.length; i++){\n\t\t\t\tlinkKey = predecessors[i].hashSum;\n\t\t\t\tif(visitedLinks[linkKey]) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}else{\n\t\t\t\t\tvisitedLinks[linkKey] = true;\n\t\t\t\t\trelations.push(predecessors[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn relations;\n\t\t},\n\t\t_getLinkedTasks: function(rootTask, visitedTasks, includePredecessors, output) {\n\t\t\tvar from = rootTask === undefined ? gantt.config.root_id : rootTask;\n\t\t\tvar visitedTasks = {};\n\t\t\tvar visitedLinks = {};\n\t\t\tvar rootObj;\n\t\n\t\t\tvar tasksStack = [{from: from, includePredecessors: includePredecessors, isChild:false}];\n\t\n\t\t\twhile(tasksStack.length){\n\t\t\t\tvar current = tasksStack.pop();\n\t\t\t\tvar isChild = current.isChild;\n\t\n\t\t\t\tfrom = current.from;\n\t\t\t\tif(visitedTasks[from]){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\trootObj = gantt.isTaskExists(from) ? gantt.getTask(from) : this.getVirtualRoot();\n\t\t\t\tvisitedTasks[from] = true;\n\t\t\t\t\n\t\t\t\tvar relations = this._collectRelations(rootObj, isChild, includePredecessors, visitedLinks);\n\t\n\t\t\t\tfor(var i=0; i < relations.length; i++){\n\t\t\t\t\tvar rel = relations[i];\n\n\t\t\t\t\tlet includeRelation = true;\n\t\t\t\t\tif(gantt._getAutoSchedulingConfig().use_progress){\n\t\t\t\t\t\tconst target = gantt.getTask(rel.target);\n\t\t\t\t\t\tif(target.progress == 1){\n\t\t\t\t\t\t\tincludeRelation = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// don't process links for unscheduled tasks\n\t\t\t\t\tconst target = gantt.getTask(rel.target);\n\t\t\t\t\tconst source = gantt.getTask(rel.source);\n\t\t\t\t\tif (target.unscheduled || source.unscheduled){\n\t\t\t\t\t\tincludeRelation = false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(includeRelation){\n\t\t\t\t\t\toutput[rel.hashSum] = rel;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar isSameParent = rel.sourceParent == rel.targetParent;\n\t\t\t\t\tvar targetTask = rel.target;\n\t\t\t\t\tif(!visitedTasks[targetTask])\n\t\t\t\t\t\ttasksStack.push({from: rel.target, includePredecessors: true, isChild: isSameParent});\n\t\t\t\t}\n\t\n\t\t\t\tif(gantt.hasChild(rootObj.id)){\n\t\t\t\t\tvar children = gantt.getChildren(rootObj.id);\n\t\t\t\t\tfor(var i=0; i < children.length; i++){\n\t\t\t\t\t\tif(!visitedTasks[children[i]])\n\t\t\t\t\t\t\ttasksStack.push({from: children[i], includePredecessors: true, isChild: true});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\treturn output;\n\t\t}\n\t};\n};","export enum ConstraintTypes {\n\t// As Soon As Possible (ASAP)\n\tASAP = \"asap\",\n\t// As Late As Possible (ALAP)\n\tALAP = \"alap\",\n\t// Start No Earlier Than (SNET)\n\tSNET = \"snet\",\n\t// Start No Later Than (SNLT)\n\tSNLT = \"snlt\",\n\t// Finish No Earlier Than (FNET)\n\tFNET = \"fnet\",\n\t// Finish No Later Than (FNLT)\n\tFNLT = \"fnlt\",\n\t// Must Start On (MSO)\n\tMSO = \"mso\",\n\t// Must Finish On (MFO)\n\tMFO = \"mfo\"\n}","//returns position of html element on the page\nfunction getNodePosition(elem) {\n\tvar top=0, left=0, right=0, bottom=0;\n\tif (elem.getBoundingClientRect) { //HTML5 method\n\t\tvar box = elem.getBoundingClientRect();\n\t\tvar body = document.body;\n\t\tvar docElem = (document.documentElement ||\n\t\t\tdocument.body.parentNode ||\n\t\t\tdocument.body);\n\n\t\tvar scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop;\n\t\tvar scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft;\n\t\tvar clientTop = docElem.clientTop || body.clientTop || 0;\n\t\tvar clientLeft = docElem.clientLeft || body.clientLeft || 0;\n\t\ttop  = box.top +  scrollTop - clientTop;\n\t\tleft = box.left + scrollLeft - clientLeft;\n\n\t\tright = document.body.offsetWidth - box.right;\n\t\tbottom = document.body.offsetHeight - box.bottom;\n\t} else { //fallback to naive approach\n\t\twhile(elem) {\n\t\t\ttop = top + parseInt(elem.offsetTop,10);\n\t\t\tleft = left + parseInt(elem.offsetLeft,10);\n\t\t\telem = elem.offsetParent;\n\t\t}\n\n\t\tright = document.body.offsetWidth - elem.offsetWidth - left;\n\t\tbottom = document.body.offsetHeight - elem.offsetHeight - top;\n\t}\n\treturn { y: Math.round(top), x: Math.round(left), width:elem.offsetWidth, height:elem.offsetHeight, right: Math.round(right), bottom: Math.round(bottom) };\n}\n\nfunction isVisible(node){\n\tvar display = false,\n\t\tvisibility = false;\n\tif(window.getComputedStyle){\n\t\tvar style = window.getComputedStyle(node, null);\n\t\tdisplay = style[\"display\"];\n\t\tvisibility = style[\"visibility\"];\n\t}else if(node.currentStyle){\n\t\tdisplay = node.currentStyle[\"display\"];\n\t\tvisibility = node.currentStyle[\"visibility\"];\n\t}\n\treturn (display != \"none\" && visibility != \"hidden\");\n}\n\nfunction hasNonNegativeTabIndex(node){\n\treturn !isNaN(node.getAttribute(\"tabindex\")) && (node.getAttribute(\"tabindex\")*1 >= 0);\n}\n\nfunction hasHref(node){\n\tvar canHaveHref = {\"a\": true, \"area\": true};\n\tif(canHaveHref[node.nodeName.loLowerCase()]){\n\t\treturn !!node.getAttribute(\"href\");\n\t}\n\treturn true;\n}\n\nfunction isEnabled(node){\n\tvar canDisable = {\"input\":true, \"select\":true, \"textarea\":true, \"button\":true, \"object\":true};\n\tif(canDisable[node.nodeName.toLowerCase()]){\n\t\treturn !node.hasAttribute(\"disabled\");\n\t}\n\n\treturn true;\n}\n\nfunction getFocusableNodes(root){\n\tvar nodes = root.querySelectorAll([\n\t\t\"a[href]\",\n\t\t\"area[href]\",\n\t\t\"input\",\n\t\t\"select\",\n\t\t\"textarea\",\n\t\t\"button\",\n\t\t\"iframe\",\n\t\t\"object\",\n\t\t\"embed\",\n\t\t\"[tabindex]\",\n\t\t\"[contenteditable]\"\n\t].join(\", \"));\n\n\tvar nodesArray = Array.prototype.slice.call(nodes, 0);\n\t\n\tfor(var i = 0; i < nodesArray.length; i++){\n\t\tnodesArray[i].$position = i;\n\t\t// we remember original nodes order, \n\t\t// so when we sort them by tabindex we ensure order of nodes with same tabindex is preserved, \n\t\t// since some browsers do unstable sort\n\t}\n\t\n\t// use tabindex to sort focusable nodes\n\tnodesArray.sort(function(a, b) {\n\t\tif(a.tabIndex === 0 && b.tabIndex !== 0){\n\t\t\treturn 1;\n\t\t}\n\t\tif(a.tabIndex !== 0 && b.tabIndex === 0){\n\t\t\treturn -1;\n\t\t}\n\t\t\n\t\tif (a.tabIndex === b.tabIndex){\n\t\t\t// ensure we do stable sort\n\t\t\treturn a.$position - b.$position;\n\t\t}\n\t\tif (a.tabIndex < b.tabIndex) {\n\t\t\treturn -1;\n\t\t}\n\t\treturn 1;\n\t});\n\t\n\tfor(var i = 0; i < nodesArray.length; i++){\n\t\tvar node = nodesArray[i];\n\t\tvar isValid = (hasNonNegativeTabIndex(node)  || isEnabled(node) || hasHref(node)) && isVisible(node);\n\t\tif(!isValid){\n\t\t\tnodesArray.splice(i, 1);\n\t\t\ti--;\n\t\t}\n\t}\n\treturn nodesArray;\n}\n\nfunction getScrollSize(){\n\tvar div = document.createElement(\"div\");\n\tdiv.style.cssText=\"visibility:hidden;position:absolute;left:-1000px;width:100px;padding:0px;margin:0px;height:110px;min-height:100px;overflow-y:scroll;\";\n\n\tdocument.body.appendChild(div);\n\tvar width = div.offsetWidth-div.clientWidth;\n\tdocument.body.removeChild(div);\n\n\treturn Math.max(width, 15);\n}\n\nfunction getClassName(node){\n\tif(!node) return \"\";\n\n\tvar className = node.className || \"\";\n\tif(className.baseVal)//'className' exist but not a string - IE svg element in DOM\n\t\tclassName = className.baseVal;\n\n\tif(!className.indexOf)\n\t\tclassName = \"\";\n\n\treturn _trimString(className);\n}\n\nfunction addClassName(node, className){\n\tif (className && node.className.indexOf(className) === -1) {\n\t\tnode.className += \" \" + className;\n\t}\n}\n\nfunction removeClassName(node, name) {\n\tname = name.split(\" \");\n\tfor (var i = 0; i < name.length; i++) {\n\t\tvar regEx = new RegExp(\"\\\\s?\\\\b\" + name[i] + \"\\\\b(?![-_.])\", \"\");\n\t\tnode.className = node.className.replace(regEx, \"\");\n\t}\n}\n\nfunction hasClass(element, className){\n\tif ('classList' in element) {\n\t\treturn element.classList.contains(className);\n\t} else { \n\t\treturn new RegExp(\"\\\\b\" + className + \"\\\\b\").test(element.className);\n\t}\n}\n\nfunction toNode(node) {\n\tif (typeof node === \"string\") {\n\t\treturn (document.getElementById(node) || document.querySelector(node) || document.body);\n\t}\n\treturn node || document.body;\n}\n\nvar _slave;\nfunction insertNode(node, newone) {\n\tif(!_slave){\n\t\t_slave = document.createElement(\"div\");\n\t}\n\t_slave.innerHTML = newone;\n\tvar child = _slave.firstChild;\n\tnode.appendChild(child);\n\treturn child;\n}\n\nfunction removeNode(node) {\n\tif (node && node.parentNode) {\n\t\tnode.parentNode.removeChild(node);\n\t}\n}\n\nfunction getChildNodes(node, css) {\n\tvar ch = node.childNodes;\n\tvar len = ch.length;\n\tvar out = [];\n\tfor (var i = 0; i < len; i++) {\n\t\tvar obj = ch[i];\n\t\tif (obj.className && obj.className.indexOf(css) !== -1) {\n\t\t\tout.push(obj);\n\t\t}\n\t}\n\treturn out;\n}\n\nfunction getTargetNode(e) {\n\tvar trg;\n\tif (e.tagName)\n\t\ttrg = e;\n\telse {\n\t\te = e || window.event;\n\t\ttrg = e.target || e.srcElement;\n\t\tif (trg.shadowRoot && e.composedPath) {\n\t\t\ttrg = e.composedPath()[0];\n\t\t}\n\t}\n\treturn trg;\n}\n\nfunction locateAttribute(e, attribute) {\n\tif(!attribute) return;\n\n\tvar trg = getTargetNode(e);\n\n\twhile (trg){\n\t\tif (trg.getAttribute){\t//text nodes has not getAttribute\n\t\t\tvar test = trg.getAttribute(attribute);\n\t\t\tif (test) return trg;\n\t\t}\n\t\t// GS-2941. With the `host`, Gantt will continue iteration outside the ShadowDOM\n\t\ttrg = trg.parentNode || trg.host;\n\t}\n\treturn null;\n}\n\nfunction _trimString(str){\n\tvar func = String.prototype.trim || function(){ return this.replace(/^\\s+|\\s+$/g, \"\"); };\n\treturn func.apply(str);\n}\n\nfunction locateClassName(e, classname, strict){\n\tvar trg = getTargetNode(e);\n\tvar css = \"\";\n\n\tif(strict === undefined)\n\t\tstrict = true;\n\n\twhile (trg){\n\t\tcss = getClassName(trg);\n\t\tif(css){\n\t\t\tvar ind = css.indexOf(classname);\n\t\t\tif (ind >= 0){\n\t\t\t\tif (!strict)\n\t\t\t\t\treturn trg;\n\n\t\t\t\t//check that we have exact match\n\t\t\t\tvar left = (ind === 0) || (!_trimString(css.charAt(ind - 1)));\n\t\t\t\tvar right = ((ind + classname.length >= css.length)) || (!_trimString(css.charAt(ind + classname.length)));\n\n\t\t\t\tif (left && right)\n\t\t\t\t\treturn trg;\n\t\t\t}\n\t\t}\n\t\ttrg=trg.parentNode;\n\t}\n\treturn null;\n}\n\n/*\nevent position relatively to DOM element\n */\nfunction getRelativeEventPosition(ev, node){\n\tconst d = document.documentElement;\n\tconst box = getNodePosition(node);\n\t//GS-2809: condition to check event(mouse or touch)\n\tconst { clientX, clientY } = ev.touches?.[0] ?? ev;\n\treturn {\n\t\tx: clientX + d.scrollLeft - d.clientLeft - box.x + node.scrollLeft,\n\t\ty: clientY + d.scrollTop - d.clientTop - box.y + node.scrollTop\n\t};\n}\n\nfunction getRelativeNodePosition(child, parent){\n\tconst childPos = getNodePosition(child);\n\tconst parentPos = getNodePosition(parent);\n\treturn {\n\t\tx: childPos.x - parentPos.x,\n\t\ty: childPos.y - parentPos.y\n\t};\n}\n\nfunction isChildOf(child, parent){\n\tif(!child || !parent){\n\t\treturn false;\n\t}\n\n\twhile(child && child != parent) {\n\t\tchild = child.parentNode;\n\t}\n\n\treturn child === parent;\n}\n\nfunction closest(element, selector){\n\tif(element.closest){\n\t\treturn element.closest(selector);\n\t}else if(element.matches || element.msMatchesSelector || element.webkitMatchesSelector){\n\t\tvar el = element;\n\t\tif (!document.documentElement.contains(el)) return null;\n\t\tdo {\n\t\t\tvar method = el.matches || el.msMatchesSelector || el.webkitMatchesSelector;\n\n\t\t\tif (method.call(el, selector)) return el;\n\t\t\tel = el.parentElement || el.parentNode;\n\t\t} while (el !== null && el.nodeType === 1); \n\t\treturn null;\n\t}else{\n\t\t// eslint-disable-next-line no-console\n\t\tconsole.error(\"Your browser is not supported\");\n\t\treturn null;\n\t}\n}\n\nfunction getClosestSizedElement(element) {\n\twhile (element) {\n\t\tif (element.offsetWidth > 0 && element.offsetHeight > 0) {\n\t\t\treturn element;\n\t\t}\n\t\telement = element.parentElement;\n\t}\n\treturn null;\n}\n\nfunction isShadowDomSupported() {\n\treturn document.head.createShadowRoot || document.head.attachShadow;\n}\n\n/**\n * Returns element that has the browser focus, or null if no element has focus.\n * Works with shadow DOM, so it's prefereed to use this function instead of document.activeElement directly.\n * @returns HTMLElement\n */\nfunction getActiveElement(){\n\tvar activeElement = document.activeElement;\n\tif (activeElement.shadowRoot) {\n\t\tactiveElement = activeElement.shadowRoot.activeElement;\n\t}\n\tif (activeElement === document.body && document.getSelection) {\n\t\tactiveElement = document.getSelection().focusNode || document.body;\n\t}\n\n\treturn activeElement;\n}\n\n/**\n * Returns document.body or the host node of the ShadowRoot, if the element is attached to ShadowDom\n * @param {HTMLElement} element \n * @returns HTMLElement\n */\nfunction getRootNode(element) {\n\tif (!element) {\n\t\treturn document.body;\n\t}\n\tif (!isShadowDomSupported()) {\n\t\treturn document.body;\n\t}\n\twhile (element.parentNode && (element = element.parentNode)) {\n\t\tif (element instanceof ShadowRoot) {\n\t\t\treturn element.host;\n\t\t}\n\t}\n\treturn document.body;\n}\n\nfunction hasShadowParent(element) {\n\treturn !!getRootNode(element);\n}\n\nexport {\n\tgetNodePosition,\n\tgetFocusableNodes,\n\tgetScrollSize,\n\tgetClassName,\n\taddClassName,\n\tremoveClassName,\n\tinsertNode,\n\tremoveNode,\n\tgetChildNodes,\n\ttoNode,\n\tlocateClassName,\n\tlocateAttribute,\n\tgetTargetNode,\n\tgetRelativeEventPosition,\n\tisChildOf,\n\thasClass,\n\tclosest,\n\tgetRootNode,\n\thasShadowParent,\n\tisShadowDomSupported,\n\tgetActiveElement,\n\tgetRelativeNodePosition,\n\tgetClosestSizedElement\n};","export class TaskPlan implements ITaskPlan {\n\tstatic Create(parent?: TaskPlan): TaskPlan {\n\t\tconst plan = new TaskPlan();\n\t\tif (parent) {\n\t\t\tfor (const i in plan) {\n\t\t\t\tif (parent[i] !== undefined) {\n\t\t\t\t\tplan[i] = parent[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn plan;\n\t}\n\n\tpublic link: string | number;\n\tpublic task: string | number;\n\t// tslint:disable-next-line variable-name\n\tpublic start_date: Date | null;\n\t// tslint:disable-next-line variable-name\n\tpublic end_date: Date | null;\n\n\tpublic latestStart: Date;\n\tpublic earliestStart: Date;\n\tpublic earliestEnd: Date;\n\tpublic latestEnd: Date;\n\n\tpublic latestSchedulingStart: Date;\n\tpublic earliestSchedulingStart: Date;\n\tpublic latestSchedulingEnd: Date;\n\tpublic earliestSchedulingEnd: Date;\n\n\tpublic kind: string;\n\tpublic conflict: boolean;\n\n\tconstructor() {\n\t\tthis.link = null;\n\t\tthis.task = null;\n\t\tthis.start_date = null;\n\t\tthis.end_date = null;\n\t\tthis.latestStart = null;\n\t\tthis.earliestStart = null;\n\t\tthis.earliestEnd = null;\n\t\tthis.latestEnd = null;\n\t\tthis.latestSchedulingStart = null;\n\t\tthis.earliestSchedulingStart = null;\n\t\tthis.latestSchedulingEnd = null;\n\t\tthis.earliestSchedulingEnd = null;\n\t\tthis.kind = \"asap\";\n\t\tthis.conflict = false;\n\t}\n}","import * as helpers from \"../../utils/helpers\";\nimport { ConstraintTypes } from \"./constraint_types\";\nimport { TaskPlan } from \"./task_plan\";\n\nexport class ConstraintsHelper {\n\tstatic Create(gantt: any): ConstraintsHelper {\n\t\treturn new ConstraintsHelper(gantt);\n\t}\n\n\tprivate _gantt: any;\n\tprivate constructor(gantt: any) {\n\t\tthis._gantt = gantt;\n\t}\n\n\tisAsapTask = (task: ITask): boolean => {\n\t\tconst constraintType = this.getConstraintType(task);\n\t\tconst autoSchedulingConfig = this._gantt._getAutoSchedulingConfig();\n\t\tif (autoSchedulingConfig.schedule_from_end) {\n\t\t\tif (constraintType === ConstraintTypes.ASAP) {\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t} else {\n\t\t\tif (constraintType === ConstraintTypes.ALAP) {\n\t\t\t\treturn false;\n\t\t\t} else {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t};\n\n\tisAlapTask = (task: ITask): boolean => {\n\t\treturn !this.isAsapTask(task);\n\t};\n\n\tgetConstraintType = (task: ITask): ConstraintTypes => {\n\t\t// GS-1487. Don't add a constraint if auto-scheduling is cancelled\n\t\tif (!this._gantt._isAutoSchedulable(task)){\n\t\t\treturn;\n\t\t}\n\n\t\tconst constraint = this._getTaskConstraint(task);\n\t\tconst autoSchedulingConfig = this._gantt._getAutoSchedulingConfig();\n\n\t\t// in case of backward scheduling, tasks without explicit constraints are considered ALAP tasks\n\t\tif (constraint.constraint_type) {\n\t\t\treturn constraint.constraint_type;\n\t\t} else if (autoSchedulingConfig.schedule_from_end) {\n\t\t\treturn ConstraintTypes.ALAP;\n\t\t} else {\n\t\t\treturn ConstraintTypes.ASAP;\n\t\t}\n\t};\n\n\t_getTaskConstraint = (task: ITask) => {\n\n\t\tlet constraint = this._getOwnConstraint(task);\n\t\tconst autoSchedulingConfig = this._gantt._getAutoSchedulingConfig();\n\n\t\t// GS-2231. Child task shouldn't inherit constraints in the group mode\n\t\tif(autoSchedulingConfig.project_constraint && !this._gantt.getState().group_mode){\n\n\t\t\tlet defaultConstraintType = ConstraintTypes.ASAP;\n\t\t\tif(autoSchedulingConfig.schedule_from_end){\n\t\t\t\tdefaultConstraintType = ConstraintTypes.ALAP;\n\t\t\t}\n\n\t\t\tif((constraint && constraint.constraint_type) === defaultConstraintType || !constraint){\n\t\t\t\tconstraint = this._getParentConstraint(task);\n\t\t\t}\n\t\t}\n\n\t\treturn constraint;\n\t};\n\n\t_getOwnConstraint = (task: ITask) => {\n\t\treturn {\n\t\t\tconstraint_type: task.constraint_type,\n\t\t\tconstraint_date: task.constraint_date\n\t\t};\n\t};\n\n\t_getParentConstraint = (task: ITask) => {\n\t\tconst autoSchedulingConfig = this._gantt._getAutoSchedulingConfig();\n\t\tlet defaultConstraintType = ConstraintTypes.ASAP;\n\t\tif(autoSchedulingConfig.schedule_from_end){\n\t\t\tdefaultConstraintType = ConstraintTypes.ALAP;\n\t\t}\n\n\t\tlet constraint = {\n\t\t\tconstraint_type: defaultConstraintType,\n\t\t\tconstraint_date: null\n\t\t};\n\n\t\tthis._gantt.eachParent((parent) => {\n\t\t\tif(constraint.constraint_type !== defaultConstraintType){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(parent.constraint_type && parent.constraint_type !== defaultConstraintType){\n\t\t\t\tconstraint = {\n\t\t\t\t\tconstraint_type: parent.constraint_type,\n\t\t\t\t\tconstraint_date: parent.constraint_date\n\t\t\t\t};\n\t\t\t}\n\t\t}, task.id);\n\t\treturn constraint;\n\t};\n\n\thasConstraint = (task: ITask): boolean => {\n\t\treturn !!this.getConstraintType(task);\n\t};\n\n\tprocessConstraint = (task: ITask, plan: TaskPlan): TaskPlan => {\n\t\tconst constraint = this._getTaskConstraint(task);\n\n\t\tif (constraint) {\n\t\t\tif (\n\t\t\t\tconstraint.constraint_type === ConstraintTypes.ALAP ||\n\t\t\t\tconstraint.constraint_type === ConstraintTypes.ASAP\n\t\t\t) {\n\t\t\t\t// this kind of constraint is calculated after main scheduling\n\t\t\t} else if(helpers.isValidDate(constraint.constraint_date)) {\n\t\t\t\tconst constraintDate = constraint.constraint_date;\n\n\t\t\t\tconst newPlan = TaskPlan.Create(plan);\n\t\t\t\tnewPlan.task = task.id;\n\n\t\t\t\tswitch (constraint.constraint_type) {\n\t\t\t\t\tcase ConstraintTypes.SNET:\n\t\t\t\t\t\tnewPlan.earliestStart = new Date(constraintDate);\n\t\t\t\t\t\tnewPlan.earliestEnd = this._gantt.calculateEndDate({\n\t\t\t\t\t\t\tstart_date: newPlan.earliestStart,\n\t\t\t\t\t\t\tduration: task.duration,\n\t\t\t\t\t\t\ttask\n\t\t\t\t\t\t});\n\t\t\t\t\t\tnewPlan.link = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ConstraintTypes.SNLT:\n\t\t\t\t\t\tnewPlan.latestStart = new Date(constraintDate);\n\t\t\t\t\t\tnewPlan.latestEnd = this._gantt.calculateEndDate({\n\t\t\t\t\t\t\tstart_date: newPlan.latestStart,\n\t\t\t\t\t\t\tduration: task.duration,\n\t\t\t\t\t\t\ttask\n\t\t\t\t\t\t});\n\t\t\t\t\t\tnewPlan.link = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ConstraintTypes.FNET:\n\t\t\t\t\t\tnewPlan.earliestStart = this._gantt.calculateEndDate({\n\t\t\t\t\t\t\tstart_date: constraintDate,\n\t\t\t\t\t\t\tduration: -task.duration,\n\t\t\t\t\t\t\ttask\n\t\t\t\t\t\t});\n\t\t\t\t\t\tnewPlan.earliestEnd = new Date(constraintDate);\n\t\t\t\t\t\tnewPlan.link = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ConstraintTypes.FNLT:\n\t\t\t\t\t\tnewPlan.latestStart = this._gantt.calculateEndDate({\n\t\t\t\t\t\t\tstart_date: constraintDate,\n\t\t\t\t\t\t\tduration: -task.duration,\n\t\t\t\t\t\t\ttask\n\t\t\t\t\t\t});\n\t\t\t\t\t\tnewPlan.latestEnd = new Date(constraintDate);\n\t\t\t\t\t\tnewPlan.link = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ConstraintTypes.MSO:\n\t\t\t\t\t\tnewPlan.earliestStart = new Date(constraintDate);\n\t\t\t\t\t\tnewPlan.earliestEnd = this._gantt.calculateEndDate({\n\t\t\t\t\t\t\tstart_date: newPlan.earliestStart,\n\t\t\t\t\t\t\tduration: task.duration,\n\t\t\t\t\t\t\ttask\n\t\t\t\t\t\t});\n\t\t\t\t\t\tnewPlan.latestStart = newPlan.earliestStart;\n\t\t\t\t\t\tnewPlan.latestEnd = newPlan.earliestEnd;\n\t\t\t\t\t\tnewPlan.link = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ConstraintTypes.MFO:\n\t\t\t\t\t\tnewPlan.earliestStart = this._gantt.calculateEndDate({\n\t\t\t\t\t\t\tstart_date: constraintDate,\n\t\t\t\t\t\t\tduration: -task.duration,\n\t\t\t\t\t\t\ttask\n\t\t\t\t\t\t});\n\t\t\t\t\t\tnewPlan.earliestEnd = this._gantt.calculateEndDate({\n\t\t\t\t\t\t\tstart_date: newPlan.earliestStart,\n\t\t\t\t\t\t\tduration: task.duration,\n\t\t\t\t\t\t\ttask\n\t\t\t\t\t\t});\n\t\t\t\t\t\tnewPlan.latestStart = newPlan.earliestStart;\n\t\t\t\t\t\tnewPlan.latestEnd = newPlan.earliestEnd;\n\t\t\t\t\t\tnewPlan.link = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\treturn newPlan;\n\t\t\t}\n\t\t}\n\n\t\treturn plan;\n\t};\n\n\tgetConstraints = (id: TaskID, relations: IInternalLink[]): ITask[] => {\n\t\tconst result = [];\n\t\tconst tasks = {};\n\n\t\tconst store = (task: any) => {\n\t\t\tif (tasks[task.id]) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.hasConstraint(task) && !this._gantt.isSummaryTask(task)) {\n\t\t\t\ttasks[task.id] = task;\n\t\t\t}\n\t\t};\n\n\t\tif (this._gantt.isTaskExists(id)) {\n\t\t\tconst task = this._gantt.getTask(id);\n\t\t\tstore(task);\n\t\t}\n\n\t\tthis._gantt.eachTask(task => store(task), id);\n\n\t\tlet current;\n\t\tif (relations) {\n\t\t\tfor (let i = 0; i < relations.length; i++) {\n\t\t\t\tconst rel = relations[i];\n\t\t\t\tif (!tasks[rel.target]) {\n\t\t\t\t\tcurrent = this._gantt.getTask(rel.target);\n\t\t\t\t\tstore(current);\n\t\t\t\t}\n\t\t\t\tif (!tasks[rel.source]) {\n\t\t\t\t\tcurrent = this._gantt.getTask(rel.source);\n\t\t\t\t\tstore(current);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (const taskId in tasks) {\n\t\t\t// GS-745 do not auto-schedule placeholders\n\t\t\tif (tasks[taskId].type !== this._gantt.config.types.placeholder) {\n\t\t\t\tresult.push(tasks[taskId]);\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t};\n}\n","export default class DateComparator  {\n\tprotected _gantt: any;\n\n\tconstructor(gantt) {\n\t\tthis._gantt = gantt;\n\t}\n\n\tpublic isEqual(dateA: Date, dateB: Date, task: ITask): boolean {\n\t\treturn !this._gantt._hasDuration(dateA, dateB, task);\n\t}\n\n\tpublic isFirstSmaller(small: Date, big: Date, task: ITask): boolean {\n\t\tif (small.valueOf() < big.valueOf() && !this.isEqual(small, big, task)) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic isSmallerOrDefault(smallDate: Date, bigDate: Date, task: ITask): boolean {\n\t\treturn !!(!smallDate || this.isFirstSmaller(smallDate, bigDate, task));\n\t}\n\n\tpublic isGreaterOrDefault(smallDate: Date, bigDate: Date, task: ITask): boolean {\n\t\treturn !!(!smallDate || this.isFirstSmaller(bigDate, smallDate, task));\n\t}\n}","import DateComparator from \"./date_comparator\";\nimport { TaskPlan } from \"./task_plan\";\n\nexport class AlapStrategy implements ISchedulingStrategy {\n\tstatic Create(gantt: any): AlapStrategy {\n\t\tconst instance = new AlapStrategy();\n\t\tinstance._gantt = gantt;\n\t\tinstance._comparator = new DateComparator(gantt);\n\t\treturn instance;\n\t}\n\n\tprotected _gantt: any;\n\tprotected _comparator: DateComparator;\n\n\tresolveRelationDate(taskId: TaskID, adjacentLinks: ITaskRelations, plansHash: IPlansHash): TaskPlan {\n\t\tlet maxEnd = null;\n\t\tlet linkId = null;\n\t\tlet maxStart = null;\n\t\tlet defaultStart = null;\n\t\tconst task = this._gantt.getTask(taskId);\n\t\tconst relations = adjacentLinks.successors;\n\t\tlet maxRelationDate = null;\n\t\tconst masterPlan = plansHash[taskId];\n\t\tfor (let i = 0; i < relations.length; i++) {\n\t\t\tconst relation = relations[i];\n\n\t\t\t// .preferredStart still exists only to emulate pre 6.1 auto scheduling behavior\n\t\t\t// will be removed in future versions\n\t\t\t// TODO: remove .preferredStart in v7.0\n\t\t\tdefaultStart = relation.preferredStart;\n\t\t\tconst constraintDate = this.getLatestEndDate(relation, plansHash, task);\n\t\t\tconst constraintStartDate = this._gantt.calculateEndDate({ start_date: constraintDate, duration: - task.duration, task });\n\n\t\t\tif (this._comparator.isGreaterOrDefault(maxRelationDate, constraintDate, task)) {\n\t\t\t\tmaxRelationDate = constraintDate;\n\t\t\t}\n\t\t\tif (this._comparator.isGreaterOrDefault(defaultStart, constraintStartDate, task) && this._comparator.isGreaterOrDefault(maxEnd, constraintDate, task)) {\n\t\t\t\tmaxEnd = constraintDate;\n\t\t\t\tmaxStart = constraintStartDate;\n\t\t\t\tlinkId = relation.id;\n\t\t\t}\n\t\t}\n\n\t\tif (!relations.length && this._gantt.config.project_end) {\n\t\t\tif (this._comparator.isGreaterOrDefault(this._gantt.config.project_end, task.end_date, task)) {\n\t\t\t\tmaxEnd = this._gantt.config.project_end;\n\t\t\t}\n\t\t\t// GS-1152. don't process tasks with cancelled auto-scheduling\n\t\t\tif (this._gantt.callEvent(\"onBeforeTaskAutoSchedule\", [task, task.end_date]) === false) {\n\t\t\t\tmaxEnd = task.end_date;\n\t\t\t}\n\t\t}\n\n\t\tif (maxEnd) {\n\t\t\t// GS-1556. Tasks with zero duration shouldn't violate the project_end date\n\t\t\tif (task.duration){\n\t\t\t\tmaxEnd = this._gantt.getClosestWorkTime({ date: maxEnd, dir: \"future\", task });\n\t\t\t\tmaxStart = this._gantt.calculateEndDate({ start_date: maxEnd, duration: - task.duration, task });\n\t\t\t} else {\n\t\t\t\tmaxStart = maxEnd = this._gantt.getClosestWorkTime({ date: maxEnd, dir: \"past\", task });\n\t\t\t}\n\t\t}\n\n\t\tconst currentPlan = TaskPlan.Create(masterPlan);\n\n\t\tcurrentPlan.link = linkId;\n\t\tcurrentPlan.task = taskId;\n\t\tcurrentPlan.end_date = maxEnd;\n\t\tcurrentPlan.start_date = maxStart;\n\t\tcurrentPlan.kind = \"alap\";\n\n\t\tif (maxRelationDate) {\n\t\t\tcurrentPlan.latestSchedulingStart = this._gantt.calculateEndDate({ start_date: maxRelationDate, duration: - task.duration, task });\n\t\t\tcurrentPlan.latestSchedulingEnd = maxRelationDate;\n\t\t}\n\n\t\treturn currentPlan;\n\n\t}\n\n\tprotected getSuccessorStartDate(id: TaskID, plansHash: IPlansHash): Date {\n\t\tconst plan = plansHash[id];\n\t\tconst task = this._gantt.getTask(id);\n\t\tlet res;\n\n\t\tif (!(plan && (plan.start_date || plan.end_date))) {\n\t\t\tres = task.start_date;\n\t\t} else if (plan.start_date) {\n\t\t\tres = plan.start_date;\n\t\t} else {\n\t\t\tres = this._gantt.calculateEndDate({ start_date: plan.end_date, duration: - task.duration, task });\n\t\t}\n\n\t\treturn res;\n\t}\n\n\tprotected getLatestEndDate(relation: IInternalLink, plansHash: IPlansHash, task: ITask) {\n\t\tconst successorStart = this.getSuccessorStartDate(relation.target, plansHash);\n\t\tconst predecessor = task;\n\n\t\tlet predecessorEnd = this._gantt.getClosestWorkTime({ date: successorStart, dir: \"past\", task: predecessor });\n\n\t\tif (predecessorEnd && relation.lag && relation.lag * 1 === relation.lag * 1) {\n\t\t\tpredecessorEnd = this._gantt.calculateEndDate({ start_date: predecessorEnd, duration: -relation.lag * 1, task: predecessor });\n\t\t}\n\n\t\treturn predecessorEnd;\n\t}\n}","import DateComparator from \"./date_comparator\";\nimport { TaskPlan } from \"./task_plan\";\n\nexport class AsapStrategy implements ISchedulingStrategy {\n\tstatic Create(gantt: any): AsapStrategy {\n\t\tconst instance = new AsapStrategy();\n\t\tinstance._gantt = gantt;\n\t\tinstance._comparator = new DateComparator(gantt);\n\t\treturn instance;\n\t}\n\n\tprotected _gantt: any;\n\tprotected _comparator: DateComparator;\n\n\tresolveRelationDate(\n\t\ttaskId: TaskID,\n\t\tadjacentLinks: ITaskRelations,\n\t\tplansHash: IPlansHash\n\t): TaskPlan {\n\t\tlet minStart = null;\n\t\tlet linkId = null;\n\n\t\tlet defaultStart = null;\n\t\tconst task = this._gantt.getTask(taskId);\n\t\tconst relations = adjacentLinks.predecessors;\n\n\t\tconst autoSchedulingConfig = this._gantt._getAutoSchedulingConfig();\n\n\t\tconst autoScheduledDates = {};\n\t\tlet minRelationDate = null;\n\t\tfor (let i = 0; i < relations.length; i++) {\n\t\t\tconst relation = relations[i];\n\n\t\t\t// .preferredStart still exists only to emulate pre 6.1 auto scheduling behavior\n\t\t\t// will be removed in future versions\n\t\t\t// TODO: remove .preferredStart in v7.0\n\t\t\tdefaultStart = relation.preferredStart;\n\n\t\t\tconst constraintDate = this.getEarliestStartDate(\n\t\t\t\trelation,\n\t\t\t\tplansHash,\n\t\t\t\ttask\n\t\t\t);\n\n\t\t\tif (this._comparator.isSmallerOrDefault(minRelationDate, constraintDate, task)) {\n\t\t\t\tminRelationDate = constraintDate;\n\t\t\t}\n\t\t\tif (\n\t\t\t\tthis._comparator.isSmallerOrDefault(defaultStart, constraintDate, task) &&\n\t\t\t\tthis._comparator.isSmallerOrDefault(minStart, constraintDate, task)\n\t\t\t) {\n\t\t\t\tminStart = constraintDate;\n\t\t\t\tlinkId = relation.id;\n\t\t\t}\n\t\t\tif (!task.duration){\n\t\t\t\tconst link = this._gantt.getLink(relation.id);\n\t\t\t\tif (autoScheduledDates[link.type] === undefined){\n\t\t\t\t\tautoScheduledDates[link.type] = +constraintDate;\n\t\t\t\t}\n\t\t\t\telse if (autoScheduledDates[link.type] < +constraintDate){\n\t\t\t\t\tautoScheduledDates[link.type] = +constraintDate;\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tif (!relations.length && this._gantt.config.project_start) {\n\t\t\tif (this._comparator.isSmallerOrDefault(task.start_date, this._gantt.config.project_start, task) ||\n\t\t\t// GS-403 - auto_scheduling_strict = true to schedule independent asap tasks to the earliest date, auto_scheduling_strict=false to keep the old behavior\n\t\t\t(autoSchedulingConfig.gap_behavior === \"compress\" && this._comparator.isGreaterOrDefault(task.start_date, this._gantt.config.project_start, task)\n\t\t\t)\n\t\t\t) {\n\t\t\t\tminStart = this._gantt.config.project_start;\n\t\t\t}\n\t\t\t// GS-1152. don't process tasks with cancelled auto-scheduling\n\t\t\tif (this._gantt.callEvent(\"onBeforeTaskAutoSchedule\", [task, task.start_date]) === false) {\n\t\t\t\tminStart = task.start_date;\n\t\t\t}\n\t\t}\n\n\t\tlet maxEnd = null;\n\t\tif (minStart) {\n\t\t\tif (task.duration) {\n\t\t\t\tminStart = this._gantt.getClosestWorkTime({\n\t\t\t\t\tdate: minStart,\n\t\t\t\t\tdir: \"future\",\n\t\t\t\t\ttask\n\t\t\t\t});\n\t\t\t\tmaxEnd = this._gantt.calculateEndDate({\n\t\t\t\t\tstart_date: minStart,\n\t\t\t\t\tduration: task.duration,\n\t\t\t\t\ttask\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t// GS-1340 and GS-2508. For FF links, the milestones should start before the weekends\n\t\t\t\t// When there are multiple links, other types have a higher priority over FF links\n\t\t\t\tlet milestoneWorktimeDirection = \"future\";\n\t\t\t\tconst linkProps = this._gantt.config.links;\n\t\t\t\tif (autoScheduledDates[linkProps.finish_to_finish] !== undefined){\n\t\t\t\t\tconst onlyFFLink = relations.length === 1;\n\t\t\t\t\tlet noRelevantLinks = true;\n\t\t\t\t\tfor (const linkType in autoScheduledDates){\n\t\t\t\t\t\tif (linkType != linkProps.finish_to_finish &&\n\t\t\t\t\t\t\tautoScheduledDates[linkProps.finish_to_finish] < autoScheduledDates[linkType]){\n\t\t\t\t\t\t\t\tnoRelevantLinks = false;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (onlyFFLink || noRelevantLinks){\n\t\t\t\t\t\tmilestoneWorktimeDirection = \"past\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tminStart = maxEnd = this._gantt.getClosestWorkTime({ date: minStart, dir: milestoneWorktimeDirection, task });\n\t\t\t}\n\n\t\t}\n\n\t\tconst masterPlan = plansHash[taskId];\n\t\tconst currentPlan = TaskPlan.Create(masterPlan);\n\n\t\tcurrentPlan.link = linkId;\n\t\tcurrentPlan.task = taskId;\n\t\tcurrentPlan.start_date = minStart;\n\t\tcurrentPlan.end_date = maxEnd;\n\t\tcurrentPlan.kind = \"asap\";\n\n\t\tif (minRelationDate) {\n\t\t\tcurrentPlan.earliestSchedulingStart = minRelationDate;\n\t\t\tcurrentPlan.earliestSchedulingEnd = this._gantt.calculateEndDate({\n\t\t\t\tstart_date: minRelationDate,\n\t\t\t\tduration: task.duration,\n\t\t\t\ttask\n\t\t\t});\n\t\t}\n\n\t\treturn currentPlan;\n\t}\n\n\tprotected getPredecessorEndDate(id: TaskID, plansHash: IPlansHash): Date {\n\t\tconst plan = plansHash[id];\n\t\tconst task = this._gantt.getTask(id);\n\t\tlet res;\n\n\t\tif (!(plan && (plan.start_date || plan.end_date))) {\n\t\t\tres = task.end_date;\n\t\t} else if (plan.end_date) {\n\t\t\tres = plan.end_date;\n\t\t} else {\n\t\t\tres = this._gantt.calculateEndDate({\n\t\t\t\tstart_date: plan.start_date,\n\t\t\t\tduration: task.duration,\n\t\t\t\ttask\n\t\t\t});\n\t\t}\n\n\t\treturn res;\n\t}\n\n\tprotected getEarliestStartDate(relation: IInternalLink, plansHash: IPlansHash, task: ITask): Date {\n\t\tconst predecessorEnd = this.getPredecessorEndDate(\n\t\t\trelation.source,\n\t\t\tplansHash\n\t\t);\n\t\tconst successor = task;\n\t\tconst predecessor = this._gantt.getTask(relation.source);\n\t\tconst autoSchedulingConfig = this._gantt._getAutoSchedulingConfig();\n\t\tlet successorStart: Date;\n\n\t\tif (\n\t\t\t(predecessorEnd &&\n\t\t\trelation.lag &&\n\t\t\trelation.lag * 1 === relation.lag * 1)\n\t\t) {\n\t\t\t// GS-2330. If it is a subtask link and we move projects, we should use the project calendar\n\t\t\tlet taskCalendar = successor;\n\t\t\tif (autoSchedulingConfig.move_projects && relation.subtaskLink && this._gantt.isTaskExists(relation.targetParent)){\n\t\t\t\ttaskCalendar = this._gantt.getTask(relation.targetParent);\n\t\t\t}\n\n\t\t\tsuccessorStart = this._gantt.getClosestWorkTime({\n\t\t\t\tdate: predecessorEnd,\n\t\t\t\tdir: \"future\",\n\t\t\t\ttask: predecessor\n\t\t\t});\n\n\t\t\tif(relation.sourceLag){\n\t\t\t\tsuccessorStart = this._gantt.calculateEndDate({\n\t\t\t\t\tstart_date: successorStart,\n\t\t\t\t\tduration: relation.sourceLag * 1,\n\t\t\t\t\ttask: predecessor\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif(relation.targetLag){\n\t\t\t\tsuccessorStart = this._gantt.calculateEndDate({\n\t\t\t\t\tstart_date: successorStart,\n\t\t\t\t\tduration: relation.targetLag * 1,\n\t\t\t\t\ttask: taskCalendar\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tsuccessorStart = this._gantt.calculateEndDate({\n\t\t\t\tstart_date: successorStart,\n\t\t\t\tduration: relation.trueLag * 1,\n\t\t\t\ttask: taskCalendar\n\t\t\t});\n\n\t\t} else {\n\t\t\tconst ffLink = this._gantt.getLink(relation.id).type === this._gantt.config.links.finish_to_finish;\n\n\t\t\tif (!successor.duration && ffLink) {\n\t\t\t\tsuccessorStart = this._gantt.getClosestWorkTime({\n\t\t\t\t\tdate: predecessorEnd,\n\t\t\t\t\tdir: \"past\",\n\t\t\t\t\ttask: successor\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tsuccessorStart = this._gantt.getClosestWorkTime({\n\t\t\t\t\tdate: predecessorEnd,\n\t\t\t\t\tdir: \"future\",\n\t\t\t\t\ttask: successor\n\t\t\t\t});\n\t\t\t}\n\n\t\t}\n\n\t\treturn successorStart;\n\t}\n}\n","import { AlapStrategy } from \"./alap_strategy\";\nimport { AsapStrategy } from \"./asap_strategy\";\nimport { ConstraintTypes } from \"./constraint_types\";\nimport { ConstraintsHelper } from \"./constraints\";\nimport { TaskPlan } from \"./task_plan\";\n\nexport class AutoSchedulingPlanner {\n\tprivate _gantt: any;\n\tprivate _constraintsHelper: ConstraintsHelper;\n\tprivate _graphHelper: any;\n\tprivate _asapStrategy: AsapStrategy;\n\tprivate _alapStrategy: AlapStrategy;\n\tprivate _secondIterationRequired?: boolean;\n\tprivate _secondIteration: boolean = false;\n\n\tconstructor(\n\t\tgantt: any,\n\t\tgraphHelper: any,\n\t\tconstraintsHelper: ConstraintsHelper\n\t) {\n\t\tthis._gantt = gantt;\n\t\tthis._constraintsHelper = constraintsHelper;\n\t\tthis._graphHelper = graphHelper;\n\t\tthis._asapStrategy = AsapStrategy.Create(gantt);\n\t\tthis._alapStrategy = AlapStrategy.Create(gantt);\n\t\tthis._secondIterationRequired = false;\n\t}\n\n\tgeneratePlan(relations: IInternalLink[], constraints: ITask[]): TaskPlan[] {\n\t\tconst graphHelper = this._graphHelper;\n\t\tconst gantt = this._gantt;\n\t\tconst constraintsHelper = this._constraintsHelper;\n\t\tconst alapStrategy = this._alapStrategy;\n\t\tconst asapStrategy = this._asapStrategy;\n\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\n\t\tconst {\n\t\t\torderedIds,\n\t\t\treversedIds,\n\t\t\trelationsMap,\n\t\t\tplansHash } = this.buildWorkCollections(relations, constraints, graphHelper);\n\n\t\tlet result: TaskPlan[];\n\n\t\tthis.processConstraints(orderedIds, plansHash, gantt, constraintsHelper);\n\n\t\tif (autoSchedulingConfig.schedule_from_end) {\n\t\t\t// when scheduling from end - iterate tasks from end and schedule them as late as possible\n\t\t\t// after that - iterate tasks from start and schedule asap tasks\n\t\t\tresult = this.iterateTasks(reversedIds, orderedIds, constraintsHelper.isAlapTask, alapStrategy, asapStrategy, relationsMap, plansHash);\n\t\t} else {\n\t\t\t// when scheduling from end - iterate tasks from start and schedule them as soon as possible\n\t\t\t// after that - iterate tasks from end and schedule asap alap\n\t\t\tresult = this.iterateTasks(orderedIds, reversedIds, constraintsHelper.isAsapTask, asapStrategy, alapStrategy, relationsMap, plansHash);\n\t\t}\n\t\treturn result;\n\t}\n\n\tapplyProjectPlan(projectPlan: TaskPlan[]): ITask[] {\n\t\tconst gantt = this._gantt;\n\n\t\tlet plan: TaskPlan;\n\t\tlet task: ITask;\n\t\tlet link: ILink;\n\t\tlet reason: ITask;\n\n\t\tconst updateTasks = [];\n\t\tfor (let i = 0; i < projectPlan.length; i++) {\n\t\t\tlink = null;\n\t\t\treason = null;\n\t\t\tplan = projectPlan[i];\n\n\t\t\tif (!gantt.isTaskExists(plan.task)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\ttask = gantt.getTask(plan.task);\n\t\t\tif (plan.link) {\n\t\t\t\tlink = gantt.getLink(plan.link);\n\t\t\t\tif (plan.kind === \"asap\") {\n\t\t\t\t\treason = this._gantt.getTask(link.source);\n\t\t\t\t} else {\n\t\t\t\t\t// alap tasks are scheduled by their successors\n\t\t\t\t\treason = this._gantt.getTask(link.target);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet newDate = null;\n\t\t\tif (\n\t\t\t\tplan.start_date &&\n\t\t\t\ttask.start_date.valueOf() !== plan.start_date.valueOf()\n\t\t\t) {\n\t\t\t\tnewDate = plan.start_date;\n\t\t\t}\n\n\t\t\tif (!newDate) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\ttask.start_date = newDate;\n\t\t\ttask.end_date = gantt.calculateEndDate(task);\n\n\t\t\tupdateTasks.push(task.id);\n\t\t\tgantt.callEvent(\"onAfterTaskAutoSchedule\", [\n\t\t\t\ttask,\n\t\t\t\tnewDate,\n\t\t\t\tlink,\n\t\t\t\treason\n\t\t\t]);\n\t\t}\n\t\treturn updateTasks;\n\t}\n\n\tprotected iterateTasks(\n\t\tmainSequence: TaskID[],\n\t\tsecondarySequence: TaskID[],\n\t\tisMainSequence: (task: ITask) => boolean,\n\t\tmainSequenceStrategy: ISchedulingStrategy,\n\t\tsecondarySequenceStrategy: ISchedulingStrategy,\n\t\trelationsMap: ITaskLinksMap,\n\t\tplansHash: IPlansHash\n\n\t): TaskPlan[] {\n\t\tconst gantt = this._gantt;\n\t\tconst result: TaskPlan[] = [];\n\n\t\tfor (let i = 0; i < mainSequence.length; i++) {\n\t\t\tconst currentId = mainSequence[i];\n\t\t\tconst task = gantt.getTask(currentId);\n\t\t\tif (!gantt._isAutoSchedulable(task)){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst plan = mainSequenceStrategy.resolveRelationDate(\n\t\t\t\tcurrentId,\n\t\t\t\trelationsMap[currentId],\n\t\t\t\tplansHash\n\t\t\t);\n\t\t\tthis.limitPlanDates(task, plan);\n\t\t\tif (isMainSequence(task)) {\n\t\t\t\tthis.processResolvedDate(task, plan, result, plansHash);\n\t\t\t} else {\n\t\t\t\tplansHash[task.id] = plan;\n\t\t\t}\n\t\t}\n\n\t\tfor (let i = 0; i < secondarySequence.length; i++) {\n\t\t\tconst currentId = secondarySequence[i];\n\t\t\tconst task = gantt.getTask(currentId);\n\t\t\tif (!gantt._isAutoSchedulable(task)){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (!isMainSequence(task)) {\n\t\t\t\tconst plan = secondarySequenceStrategy.resolveRelationDate(\n\t\t\t\t\tcurrentId,\n\t\t\t\t\trelationsMap[currentId],\n\t\t\t\t\tplansHash\n\t\t\t\t);\n\t\t\t\tthis.limitPlanDates(task, plan);\n\t\t\t\tthis.processResolvedDate(task, plan, result, plansHash);\n\t\t\t}\n\t\t}\n\n\t\tif (this._secondIterationRequired){\n\t\t\tif (this._secondIteration){\n\t\t\t\tthis._secondIteration = false;\n\t\t\t} else {\n\t\t\t\tthis._secondIteration = true;\n\n\t\t\t\t// if the duration of the project tasks changed, the lag value is updated\n\t\t\t\t// so, we need to auto-schedule tasks again with the updated dates\n\t\t\t\tif (this.summaryLagChanged(gantt, relationsMap, plansHash)){\n\t\t\t\t\treturn this.iterateTasks(\n\t\t\t\t\t\tmainSequence,\n\t\t\t\t\t\tsecondarySequence,\n\t\t\t\t\t\tisMainSequence,\n\t\t\t\t\t\tmainSequenceStrategy,\n\t\t\t\t\t\tsecondarySequenceStrategy,\n\t\t\t\t\t\trelationsMap,\n\t\t\t\t\t\tplansHash\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected summaryLagChanged(gantt, relationsMap, plansHash){\n\t\t// update projects and relations from plans\n\t\tconst projectUpdates = {};\n\t\tconst linksToUpdate = {};\n\n\t\t// get minimal and maximal dates for target and source projects\n\t\tfor (const taskId in relationsMap){\n\t\t\trelationsMap[taskId].predecessors.forEach((relation)=>{\n\t\t\t\tif (relation.subtaskLink){\n\t\t\t\t\tconst link = gantt.getLink(relation.id);\n\t\t\t\t\tthis.getProjectUpdates(gantt, plansHash, relation, link, \"source\", projectUpdates, linksToUpdate);\n\t\t\t\t\tthis.getProjectUpdates(gantt, plansHash, relation, link, \"target\", projectUpdates, linksToUpdate);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// update project tasks\n\t\tlet shouldReschedule = false;\n\n\t\tfor (const projectId in projectUpdates){\n\t\t\tconst updatedProject = projectUpdates[projectId];\n\t\t\tif (!updatedProject.min || !updatedProject.max){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst task = gantt.getTask(projectId);\n\t\t\t// we cannot rely on the `duration` parameter as it can have a different value for project tasks\n\t\t\t// during the initial scheduling\n\t\t\tconst initialDuration = gantt.calculateDuration({start_date: task.start_date, end_date: task.end_date, task});\n\t\t\t// we need to modify the dates and duration of the project tasks as\n\t\t\t// the _formatLink and the functions that follow rely on these parameters\n\t\t\t// it shouldn't impact logic as project tasks ignore the date parameters\n\t\t\tconst newDuration = gantt.calculateDuration({start_date: updatedProject.min, end_date: updatedProject.max, task});\n\t\t\tif (newDuration === initialDuration){\n\t\t\t\t// no need to reschedule\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\ttask.start_date = updatedProject.min;\n\t\t\ttask.end_date = updatedProject.max;\n\t\t\ttask.duration = newDuration;\n\t\t}\n\t\t\n\t\tfor (const linkId in linksToUpdate){\n\t\t\tconst link = linksToUpdate[linkId];\n\t\t\tlet sourceDates, targetDates;\n\n\t\t\tconst updatedSource = projectUpdates[link.source];\n\t\t\tconst updatedTarget = projectUpdates[link.target];\n\t\t\tif (updatedSource){\n\t\t\t\tsourceDates = {\n\t\t\t\t\tstart_date: updatedSource.start_date,\n\t\t\t\t\tend_date: updatedSource.end_date\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (updatedTarget){\n\t\t\t\tsourceDates = {\n\t\t\t\t\tstart_date: updatedTarget.start_date,\n\t\t\t\t\tend_date: updatedTarget.end_date\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// get updated formatted link with updated dates\n\t\t\tconst updatedRelations = gantt._formatLink(link, sourceDates, targetDates);\n\t\t\t// update relationsMap\n\t\t\tupdatedRelations.forEach(function(updatedRelation){\n\t\t\tfor (const taskId in relationsMap){\n\t\t\t\trelationsMap[taskId].predecessors.forEach(function(relation){\n\t\t\t\t\t\tconst idMatch = relation.id === updatedRelation.id;\n\t\t\t\t\t\tconst targetMatch = relation.target === updatedRelation.target;\n\t\t\t\t\t\tconst sourceMatch = relation.source === updatedRelation.source;\n\t\t\t\t\t\tif (idMatch && targetMatch && sourceMatch){\n\t\t\t\t\t\t\trelation.lag = updatedRelation.lag;\n\t\t\t\t\t\t\trelation.sourceLag = updatedRelation.sourceLag;\n\t\t\t\t\t\t\trelation.targetLag = updatedRelation.targetLag;\n\t\t\t\t\t\t\trelation.hashSum = updatedRelation.hashSum;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\tshouldReschedule = true;\n\t\t}\n\t\treturn shouldReschedule;\n\t}\n\n\tprotected getProjectUpdates(gantt, plansHash, relation, link, relationProp, projectUpdates, linksToUpdate){\n\t\tconst task = gantt.getTask(link[relationProp]);\n\t\tif (task.type === gantt.config.types.project){\n\t\t\tprojectUpdates[link[relationProp]] = projectUpdates[link[relationProp]] || {id: link[relationProp], link};\n\t\t\tconst projectForUpdate = projectUpdates[link[relationProp]];\n\t\t\tlet childTask = plansHash[relation[relationProp]];\n\t\t\tif (childTask){\n\t\t\t\tif (relationProp == \"source\" && (!childTask.start_date || !childTask.end_date)){\n\t\t\t\t\tchildTask = gantt.getTask(childTask.task);\n\t\t\t\t}\n\n\t\t\t\tprojectForUpdate.min = projectForUpdate.min || childTask.start_date;\n\t\t\t\tif (projectForUpdate.min > childTask.start_date){\n\t\t\t\t\tprojectForUpdate.min = childTask.start_date;\n\t\t\t\t}\n\t\t\t\tprojectForUpdate.max = projectForUpdate.max || childTask.end_date;\n\t\t\t\tif (projectForUpdate.max < childTask.end_date){\n\t\t\t\t\tprojectForUpdate.max = childTask.end_date;\n\t\t\t\t}\n\t\t\t\tlinksToUpdate[link.id] = link;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected processResolvedDate(\n\t\ttask: ITask,\n\t\tplan: TaskPlan,\n\t\tresult: TaskPlan[],\n\t\tplansHash: any\n\t): void {\n\t\tif (plan.start_date && this._gantt.isLinkExists(plan.link)) {\n\t\t\tlet link = null;\n\t\t\tlet reason = null;\n\t\t\tif (plan.link) {\n\t\t\t\tlink = this._gantt.getLink(plan.link);\n\t\t\t\tif (plan.kind === \"asap\") {\n\t\t\t\t\treason = this._gantt.getTask(link.source);\n\t\t\t\t} else {\n\t\t\t\t\t// alap tasks are scheduled by their successors\n\t\t\t\t\treason = this._gantt.getTask(link.target);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\ttask.start_date.valueOf() !== plan.start_date.valueOf() &&\n\t\t\t\tthis._gantt.callEvent(\"onBeforeTaskAutoSchedule\", [\n\t\t\t\t\ttask,\n\t\t\t\t\tplan.start_date,\n\t\t\t\t\tlink,\n\t\t\t\t\treason\n\t\t\t\t]) === false\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tplansHash[task.id] = plan;\n\t\tif (plan.start_date) {\n\t\t\tresult.push(plan);\n\t\t}\n\t}\n\n\tprotected limitPlanDates(task: ITask, plan: TaskPlan): TaskPlan {\n\t\tconst effectiveStart = plan.start_date || task.start_date;\n\n\t\tif (plan.earliestStart) {\n\t\t\tif (effectiveStart < plan.earliestStart) {\n\t\t\t\tplan.start_date = plan.earliestStart;\n\t\t\t\tplan.end_date = plan.earliestEnd;\n\t\t\t}\n\t\t}\n\n\t\tif (plan.latestStart) {\n\t\t\tif (effectiveStart > plan.latestStart) {\n\t\t\t\tplan.start_date = plan.latestStart;\n\t\t\t\tplan.end_date = plan.latestEnd;\n\t\t\t}\n\t\t}\n\n\t\tif (plan.latestSchedulingStart && effectiveStart > plan.latestSchedulingStart) {\n\t\t\tplan.start_date = plan.latestSchedulingStart;\n\t\t\tplan.end_date = plan.latestSchedulingEnd;\n\t\t}\n\n\t\tif (plan.earliestSchedulingStart && effectiveStart < plan.earliestSchedulingStart) {\n\t\t\tplan.start_date = plan.earliestSchedulingStart;\n\t\t\tplan.end_date = plan.earliestSchedulingEnd;\n\t\t}\n\n\t\tif (plan.start_date) { // start/end dates are either both defined or both not\n\t\t\tif (plan.start_date > plan.latestSchedulingStart ||\n\t\t\t\tplan.start_date < plan.earliestSchedulingStart ||\n\t\t\t\tplan.start_date > plan.latestStart ||\n\t\t\t\tplan.start_date < plan.earliestStart ||\n\t\t\t\tplan.end_date > plan.latestSchedulingEnd ||\n\t\t\t\tplan.end_date < plan.earliestSchedulingEnd ||\n\t\t\t\tplan.end_date > plan.latestEnd ||\n\t\t\t\tplan.end_date < plan.earliestEnd) {\n\n\t\t\t\tplan.conflict = true;\n\t\t\t}\n\t\t}\n\t\treturn plan;\n\t}\n\n\tprotected buildWorkCollections(relations: IInternalLink[], constraints: ITask[], graphHelper: any) {\n\t\tconst gantt = this._gantt;\n\t\tconst orderedIds: TaskID[] = graphHelper.topologicalSort(relations);\n\t\tconst reversedIds: TaskID[] = orderedIds.slice().reverse();\n\t\tconst plansHash: IPlansHash = {};\n\n\t\tconst relationsMap: ITaskLinksMap = {};\n\t\tfor (let i = 0, len = orderedIds.length; i < len; i++) {\n\t\t\tconst id = orderedIds[i];\n\t\t\tconst task = gantt.getTask(id);\n\t\t\tif (!gantt._isAutoSchedulable(task)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\trelationsMap[id] = {\n\t\t\t\tsuccessors: [],\n\t\t\t\tpredecessors: []\n\t\t\t};\n\n\t\t\tplansHash[id] = null;\n\t\t}\n\n\t\tfor (let i = 0, len = constraints.length; i < len; i++) {\n\t\t\tconst task = constraints[i];\n\n\t\t\tif (plansHash[task.id] === undefined) {\n\t\t\t\treversedIds.unshift(task.id);\n\t\t\t\torderedIds.unshift(task.id);\n\t\t\t\tplansHash[task.id] = null;\n\t\t\t\trelationsMap[task.id] = {\n\t\t\t\t\tsuccessors: [],\n\t\t\t\t\tpredecessors: []\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tfor (let i = 0, len = relations.length; i < len; i++) {\n\t\t\tconst rel = relations[i];\n\t\t\tif (relationsMap[rel.source]) {\n\t\t\t\trelationsMap[rel.source].successors.push(rel);\n\t\t\t}\n\n\t\t\tif (relationsMap[rel.target]) {\n\t\t\t\trelationsMap[rel.target].predecessors.push(rel);\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\torderedIds,\n\t\t\treversedIds,\n\t\t\trelationsMap,\n\t\t\tplansHash\n\t\t};\n\t}\n\n\tprotected processConstraints(orderedIds: TaskID[], plansHash: IPlansHash, gantt: any, constraintsHelper: ConstraintsHelper) {\n\t\tfor (let i = 0; i < orderedIds.length; i++) {\n\t\t\tconst currentId = orderedIds[i];\n\t\t\tconst task = gantt.getTask(currentId);\n\n\t\t\tconst constraintType = constraintsHelper.getConstraintType(task);\n\t\t\tif (\n\t\t\t\tconstraintType &&\n\t\t\t\tconstraintType !== ConstraintTypes.ASAP &&\n\t\t\t\tconstraintType !== ConstraintTypes.ALAP\n\t\t\t) {\n\t\t\t\tconst plan = constraintsHelper.processConstraint(\n\t\t\t\t\ttask,\n\t\t\t\t\tTaskPlan.Create()\n\t\t\t\t);\n\t\t\t\tplansHash[task.id] = plan;\n\t\t\t}\n\t\t}\n\t}\n}\n","interface IFlagHash {\n\t[id: string]: boolean;\n}\n\nfunction findGroups(links: IInternalLink[]): IConnectedGroup[] {\n\tconst visited: IFlagHash = {};\n\tconst groups = [];\n\tlet source: TaskID;\n\tlet target: TaskID;\n\tlet root: TaskID;\n\t// main loop - find any unvisited vertex from the input array and\n\t// treat it as the source, then perform a breadth first search from\n\t// it. All vertices visited from this search belong to the same group\n\tfor (let i = 0; i < links.length; i++) {\n\t\tsource = links[i].source;\n\t\ttarget = links[i].target;\n\t\troot = null;\n\t\tif (!visited[source]) {\n\t\t\troot = source;\n\t\t} else if (!visited[target]) {\n\t\t\troot = target;\n\t\t}\n\t\tif (root) {\n\t\t\t// there is an unvisited vertex in this pair.\n\t\t\t// perform a breadth first search, and push the resulting\n\t\t\t// group onto the list of all groups\n\t\t\tconst length = links.length;\n\t\t\tgroups.push(breadthFirstSearch(root, links, visited));\n\t\t\tif (length !== links.length) {\n\t\t\t\ti = -1;\n\t\t\t}\n\t\t}\n\t}\n\treturn groups;\n}\n\n// Breadth First Search function\n// v is the source vertex\n// links is the input array, which contains all gantt relations\n// visited is a dictionary for keeping track of whether a node is visited\nfunction breadthFirstSearch(\n\tv: TaskID,\n\tlinks: IInternalLink[],\n\tvisited: IFlagHash\n): IConnectedGroupsDetailed {\n\tconst queue: TaskID[] = [v];\n\tconst groupTasks: TaskID[] = [];\n\tconst groupLinksInternal: { [hashSum: string]: IInternalLink } = {};\n\tconst groupLinksPublic: { [id: string]: boolean } = {};\n\n\tlet currentVertex: TaskID;\n\twhile (queue.length > 0) {\n\t\tcurrentVertex = queue.shift();\n\t\tif (!visited[currentVertex]) {\n\t\t\tvisited[currentVertex] = true;\n\t\t\tgroupTasks.push(currentVertex);\n\t\t\t// go through the input array to find vertices that are\n\t\t\t// directly adjacent to the current vertex, and put them\n\t\t\t// onto the queue\n\t\t\tfor (let i = 0; i < links.length; i++) {\n\t\t\t\tconst link = links[i];\n\t\t\t\t// tslint:disable-next-line triple-equals\n\t\t\t\tif ((link.source == currentVertex || link.sourceParent == currentVertex)) {\n\t\t\t\t\tif (!visited[link.target]) {\n\t\t\t\t\t\tqueue.push(link.target);\n\t\t\t\t\t\tgroupLinksPublic[link.id] = true;\n\t\t\t\t\t\tlinks.splice(i, 1);\n\t\t\t\t\t\ti--;\n\t\t\t\t\t}\n\t\t\t\t\tgroupLinksInternal[link.hashSum] = link;\n\n\t\t\t\t\t// tslint:disable-next-line triple-equals\n\t\t\t\t} else if ((link.target == currentVertex || link.targetParent == currentVertex)) {\n\t\t\t\t\tif (!visited[link.source]) {\n\t\t\t\t\t\tqueue.push(link.source);\n\t\t\t\t\t\tgroupLinksPublic[link.id] = true;\n\t\t\t\t\t\tlinks.splice(i, 1);\n\t\t\t\t\t\ti--;\n\t\t\t\t\t}\n\t\t\t\t\tgroupLinksInternal[link.hashSum] = link;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tconst linksArray: LinkID[] = [];\n\tlet linksObjects: IInternalLink[] = [];\n\tfor (const i in groupLinksPublic) {\n\t\tlinksArray.push(i);\n\t}\n\tfor (const i in groupLinksInternal) {\n\t\tlinksObjects.push(groupLinksInternal[i]);\n\t}\n\t// GS-1689. If we have several levels of projects, the code above might not add the links\n\t// so, we need to return the original `links` object\n\tif (!linksObjects.length){\n\t\tlinksObjects = links;\n\t}\n\t// return everything in the current \"group\"\n\treturn { tasks: groupTasks, links: linksArray, processedLinks: linksObjects };\n}\n\nexport class ConnectedGroupsHelper {\n\tprivate _linksBuilder: any;\n\tprivate _gantt: any;\n\tconstructor(gantt: any, linksBuilder: any) {\n\t\tthis._linksBuilder = linksBuilder;\n\t\tthis._gantt = gantt;\n\t}\n\n\tgetConnectedGroupRelations = (id: TaskID): IInternalLink[] => {\n\t\tconst links = this._linksBuilder.getLinkedTasks();\n\t\tconst group = breadthFirstSearch(id, links, {});\n\t\treturn group.processedLinks;\n\t};\n\n\tgetConnectedGroup = (id: TaskID): IConnectedGroup | IConnectedGroup[] => {\n\t\tconst links = this._linksBuilder.getLinkedTasks();\n\t\tif (id !== undefined) {\n\t\t\tif (this._gantt.getTask(id).type === this._gantt.config.types.project) {\n\t\t\t\treturn { tasks: [], links: [] };\n\t\t\t}\n\n\t\t\tconst group = breadthFirstSearch(id, links, {});\n\t\t\treturn {\n\t\t\t\ttasks: group.tasks,\n\t\t\t\tlinks: group.links\n\t\t\t};\n\t\t} else {\n\t\t\treturn findGroups(links).map(group => ({ tasks: group.tasks, links: group.links }));\n\t\t}\n\t};\n}\n","export class LoopsFinder {\n\tprivate _linksBuilder: any;\n\tprivate _graphHelper: any;\n\tprivate _gantt: any;\n\tconstructor(gantt: any, graphHelper: any, linksBuilder: any) {\n\t\tthis._linksBuilder = linksBuilder;\n\t\tthis._graphHelper = graphHelper;\n\t\tthis._gantt = gantt;\n\t}\n\tisCircularLink = (link: ILink): boolean => {\n\t\treturn !!this.getLoopContainingLink(link);\n\t};\n\n\tgetLoopContainingLink = (link: ILink): any => {\n\t\tconst graphHelper = this._graphHelper;\n\t\tconst linksBuilder = this._linksBuilder;\n\t\tconst gantt = this._gantt;\n\n\t\tlet allRelations = linksBuilder.getLinkedTasks();\n\t\tif (!gantt.isLinkExists(link.id)) {\n\t\t\tallRelations = allRelations.concat(gantt._formatLink(link));\n\t\t}\n\n\t\tconst cycles = graphHelper.findLoops(allRelations);\n\n\t\tconst found = false;\n\t\tfor (let i = 0; i < cycles.length && !found; i++) {\n\t\t\tconst links = cycles[i].links;\n\t\t\tfor (let j = 0; j < links.length; j++) {\n\t\t\t\t// tslint:disable-next-line triple-equals\n\t\t\t\tif (links[j] == link.id) {\n\t\t\t\t\treturn cycles[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t};\n\n\tfindCycles = () => {\n\t\tconst graphHelper = this._graphHelper;\n\t\tconst linksBuilder = this._linksBuilder;\n\n\t\tconst allRelations = linksBuilder.getLinkedTasks();\n\t\treturn graphHelper.findLoops(allRelations);\n\t};\n}\n","export default function(gantt){\n\tfunction getDefaultAutoSchedulingConfig(){\n\t\treturn {\n\t\t\tenabled: false,\n\t\t\tapply_constraints: false,\n\t\t\tgap_behavior: \"preserve\",\n\t\t\tdescendant_links: false,\n\t\t\tschedule_on_parse: true,\n\t\t\tmove_projects: true,\n\t\t\tuse_progress: false,\n\n\t\t\tschedule_from_end: false,\n\t\t\tproject_constraint: false,\n\t\t\tshow_constraints: false\n\t\t};\n\t}\n\n\tfunction getAutoSchedulingConfig() {\n\t\tconst config = gantt.config;\n\n\t\t// if already using new-style object  return as is\n\t\tif (typeof config.auto_scheduling === \"object\") {\n\n\t\t\tconst schedulingConfig = {...getDefaultAutoSchedulingConfig(), ...config.auto_scheduling};\n\n\t\t\t// backward compatibility for {mode, strict, move_asap_tasks} properties\n\t\t\tif(schedulingConfig.mode){\n\t\t\t\tschedulingConfig.apply_constraints = schedulingConfig.mode === \"constraints\";\n\t\t\t\tdelete schedulingConfig.mode;\n\t\t\t}\n\n\t\t\tif(schedulingConfig.strict !== undefined){\n\t\t\t\tschedulingConfig.gap_behavior = schedulingConfig.strict ? \"compress\" : \"preserve\";\n\t\t\t\tdelete schedulingConfig.strict;\n\t\t\t}\n\n\t\t\tif(schedulingConfig.move_asap_tasks !== undefined){\n\t\t\t\tschedulingConfig.gap_behavior = schedulingConfig.move_asap_tasks ? \"compress\" : \"preserve\";\n\t\t\t\tdelete schedulingConfig.move_asap_tasks;\n\t\t\t}\n\t\t\treturn schedulingConfig;\n\t\t}\n\n\t\t// backward compatibility: build config from old flags\n\t\tconst enabled = !!config.auto_scheduling;\n\n\t\treturn {\n\t\t\t...getDefaultAutoSchedulingConfig(),\n\t\t\t...{\n\t\t\t\tenabled,\n\t\t\t\tapply_constraints: config.auto_scheduling_compatibility ?? false,\n\t\t\t\tgap_behavior: config.auto_scheduling_strict !== true ? \"preserve\" : \"compress\",\n\t\t\t\tdescendant_links: config.auto_scheduling_descendant_links ?? false,\n\t\t\t\tschedule_on_parse: config.auto_scheduling_initial ?? true,\n\t\t\t\tmove_projects: config.auto_scheduling_move_projects ?? true,\n\t\t\t\tuse_progress: config.auto_scheduling_use_progress ?? false,\n\n\t\t\t\tschedule_from_end: config.schedule_from_end ?? false,\n\t\t\t\tproject_constraint: config.auto_scheduling_project_constraint ?? false,\n\t\t\t\tshow_constraints: false\n\t\t\t}\n\t\t};\n\t}\n\n\treturn {\n\t\tgetDefaultAutoSchedulingConfig,\n\t\tgetAutoSchedulingConfig\n\t};\n};","import { ConnectedGroupsHelper } from \"./connected_groups\";\n\nexport function attachUIHandlers(\n\tgantt: any,\n\tlinksBuilder: any,\n\tloopsFinder: any,\n\tconnectedGroupsHelper: ConnectedGroupsHelper\n) {\n\tconst _attachAutoSchedulingHandlers = function() {\n\t\tlet _scheduleAfterBatchUpdate = false;\n\t\tgantt.attachEvent(\"onAfterBatchUpdate\", function(){\n\n\t\t\tif(_scheduleAfterBatchUpdate){\n\t\t\t\tgantt.autoSchedule();\n\t\t\t}\n\t\t\t_scheduleAfterBatchUpdate = false;\n\t\t});\n\n\t\tfunction _autoScheduleAfterLinkChange(id: LinkID, link: ILink) {\n\t\t\tif (gantt._getAutoSchedulingConfig().enabled && !gantt._autoscheduling_in_progress) {\n\t\t\t\tif(gantt.getState().batch_update){\n\t\t\t\t\t_scheduleAfterBatchUpdate = true;\n\t\t\t\t}else{\n\t\t\t\t\tgantt.autoSchedule(link.source);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tgantt.attachEvent(\"onAfterLinkUpdate\", _autoScheduleAfterLinkChange);\n\t\tgantt.attachEvent(\"onAfterLinkAdd\", _autoScheduleAfterLinkChange);\n\n\t\tgantt.attachEvent(\"onAfterLinkDelete\", function(id: LinkID, link: ILink) {\n\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\t\t\tif (\n\t\t\t\tautoSchedulingConfig.enabled &&\n\t\t\t\t!gantt._autoscheduling_in_progress &&\n\t\t\t\tgantt.isTaskExists(link.target)\n\t\t\t) {\n\t\t\t\t// after link deleted - auto schedule target for other relations that may be left\n\t\t\t\tconst target = gantt.getTask(link.target);\n\t\t\t\tconst predecessors = gantt._getPredecessors(target);\n\t\t\t\tif (predecessors.length) {\n\t\t\t\t\tif(gantt.getState().batch_update){\n\t\t\t\t\t\t_scheduleAfterBatchUpdate = true;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tgantt.autoSchedule(predecessors[0].source, false);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tgantt.attachEvent(\"onParse\", function() {\n\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\t\t\tif (\n\t\t\t\tautoSchedulingConfig.enabled &&\n\t\t\t\tautoSchedulingConfig.schedule_on_parse\n\t\t\t) {\n\t\t\t\tgantt.autoSchedule();\n\t\t\t}\n\t\t});\n\n\t\tfunction _preventCircularLink(id: LinkID, link: ILink): boolean {\n\t\t\tconst slackConfigValue = gantt._getAutoSchedulingConfig().use_progress;\n\t\t\tconst deprecatedConfig = gantt.config.auto_scheduling_use_progress;\n\n\t\t\tif(deprecatedConfig) {\n\t\t\t\tgantt.config.auto_scheduling_use_progress = false;\n\t\t\t} else if (slackConfigValue){\n\t\t\t\tgantt.config.auto_scheduling.use_progress = false;\n\t\t\t}\n\n\t\t\tif (gantt.isCircularLink(link)) {\n\t\t\t\tgantt.callEvent(\"onCircularLinkError\", [\n\t\t\t\t\tlink,\n\t\t\t\t\tloopsFinder.getLoopContainingLink(link)\n\t\t\t\t]);\n\n\t\t\t\tif(deprecatedConfig) {\n\t\t\t\t\tgantt.config.auto_scheduling_use_progress = slackConfigValue;\n\t\t\t\t} else if (slackConfigValue){\n\t\t\t\t\tgantt.config.auto_scheduling.use_progress = slackConfigValue;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t} else {\n\t\t\t\tif(deprecatedConfig) {\n\t\t\t\t\tgantt.config.auto_scheduling_use_progress = slackConfigValue;\n\t\t\t\t} else if (slackConfigValue){\n\t\t\t\t\tgantt.config.auto_scheduling.use_progress = slackConfigValue;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\tfunction _preventDescendantLink(id: LinkID, link: ILink): boolean {\n\t\t\tconst source = gantt.getTask(link.source);\n\t\t\tconst target = gantt.getTask(link.target);\n\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\t\t\tif (!autoSchedulingConfig.descendant_links) {\n\t\t\t\tif (\n\t\t\t\t\t(gantt.isChildOf(source.id, target.id) &&\n\t\t\t\t\t\tgantt.isSummaryTask(target)) ||\n\t\t\t\t\t(gantt.isChildOf(target.id, source.id) && gantt.isSummaryTask(source))\n\t\t\t\t) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tgantt.attachEvent(\"onBeforeLinkAdd\", _preventCircularLink);\n\t\tgantt.attachEvent(\"onBeforeLinkAdd\", _preventDescendantLink);\n\t\tgantt.attachEvent(\"onBeforeLinkUpdate\", _preventCircularLink);\n\t\tgantt.attachEvent(\"onBeforeLinkUpdate\", _preventDescendantLink);\n\n\t\tfunction _datesNotEqual(\n\t\t\tdateA: Date,\n\t\t\tdateB: Date,\n\t\t\ttaskA: ITask,\n\t\t\ttaskB: ITask\n\t\t): boolean {\n\t\t\tif (!!dateA !== !!dateB) {\n\t\t\t\t// if one of dates is empty or null and the other is not\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (!dateA && !dateB) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (dateA.valueOf() > dateB.valueOf()) {\n\t\t\t\treturn gantt._hasDuration({\n\t\t\t\t\tstart_date: dateB,\n\t\t\t\t\tend_date: dateA,\n\t\t\t\t\ttask: taskB\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\treturn gantt._hasDuration({\n\t\t\t\t\tstart_date: dateA,\n\t\t\t\t\tend_date: dateB,\n\t\t\t\t\ttask: taskA\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tfunction _notEqualTaskDates(task1: ITask, task2: ITask): boolean {\n\t\t\tif (_datesNotEqual(task1.start_date, task2.start_date, task1, task2)) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (gantt.getConstraintType(task1) !== gantt.getConstraintType(task2)) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t_datesNotEqual(\n\t\t\t\t\ttask1.constraint_date,\n\t\t\t\t\ttask2.constraint_date,\n\t\t\t\t\ttask1,\n\t\t\t\t\ttask2\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t_datesNotEqual(task1.start_date, task2.start_date, task1, task2) ||\n\t\t\t\t((_datesNotEqual(task1.end_date, task2.end_date, task1, task2) ||\n\t\t\t\t\ttask1.duration !== task2.duration) &&\n\t\t\t\t\ttask1.type !== gantt.config.types.milestone)\n\t\t\t) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\tfunction getRelations(id: TaskID) {\n\t\t\t// collect relations before drag and drop  in order to have original positions of subtasks within project since they are used as lag when moving dependent project\n\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\t\t\tif (!autoSchedulingConfig.apply_constraints) {\n\t\t\t\t// collect only downstream dependencies since there is no backward or ALAP scheduling in pre 6.1 auto scheduling\n\t\t\t\treturn linksBuilder.getLinkedTasks(id, true);\n\t\t\t} else {\n\t\t\t\t// get all connected group (both upstream and downstream dependencies)\n\t\t\t\treturn connectedGroupsHelper.getConnectedGroupRelations(id);\n\t\t\t}\n\t\t}\n\n\t\tlet relations;\n\t\tlet movedTask;\n\t\tgantt.attachEvent(\"onBeforeTaskDrag\", function(\n\t\t\tid: TaskID,\n\t\t\tmode: string,\n\t\t\ttask: ITask\n\t\t) {\n\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\t\t\tif (\n\t\t\t\tautoSchedulingConfig.enabled\n\t\t\t\t// We need to get the movedTask so that we can use it later internally\n\t\t\t\t// && autoSchedulingConfig.move_projects\n\t\t\t) {\n\t\t\t\t// collect relations before drag and drop  in order to have original positions of subtasks within project since they are used as lag when moving dependent project\n\t\t\t\tif(gantt.getState().drag_mode !== \"progress\"){\n\t\t\t\t\trelations = getRelations(id);\n\t\t\t\t}\n\n\t\t\t\tmovedTask = id;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tfunction resetToStartLinksLags(taskId, relationsArray) {\n\t\t\t// task duration is used as lag when converting start_to_start and start_to_finish into finish_to_start links\n\t\t\t// recalculate these links if task duration has changed\n\n\t\t\tlet skipped = false;\n\t\t\tfor (let i = 0; i < relations.length; i++) {\n\t\t\t\tconst originalLink = gantt.getLink(relationsArray[i].id);\n\t\t\t\tif (\n\t\t\t\t\toriginalLink &&\n\t\t\t\t\t(originalLink.type === gantt.config.links.start_to_start ||\n\t\t\t\t\t\toriginalLink.type === gantt.config.links.start_to_finish)\n\t\t\t\t) {\n\t\t\t\t\trelationsArray.splice(i, 1);\n\t\t\t\t\ti--;\n\t\t\t\t\tskipped = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (skipped) {\n\t\t\t\tconst presentLinks = {};\n\t\t\t\tfor (let i = 0; i < relationsArray.length; i++) {\n\t\t\t\t\tpresentLinks[relationsArray[i].id] = true;\n\t\t\t\t}\n\n\t\t\t\tconst updatedLinks = getRelations(taskId);\n\n\t\t\t\tfor (let i = 0; i < updatedLinks.length; i++) {\n\t\t\t\t\tif (!presentLinks[updatedLinks[i].id]) {\n\t\t\t\t\t\trelationsArray.push(updatedLinks[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// GS-686. We shouldn't change the constraint after changing only the duration or end_date\n\t\tfunction shouldKeepConstraints(task, oldTask){\n\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\t\t\tif (autoSchedulingConfig.schedule_from_end) {\n\t\t\t\tif (oldTask.end_date && task.end_date && task.end_date.valueOf() === oldTask.end_date.valueOf()){\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (oldTask.start_date && task.start_date && task.start_date.valueOf() === oldTask.start_date.valueOf()){\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction updateTaskConstraints(task){\n\t\t\t// GS-1487. Don't add a constraint if auto-scheduling is cancelled\n\t\t\tif (task.auto_scheduling === false){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\n\t\t\t// GS-2452. We should keep the constraints type if it doesn't affect the task dates\n\t\t\tconst constraintTypes = gantt.config.constraint_types;\n\t\t\tconst backwardConstraints = [\n\t\t\t\tconstraintTypes.SNLT,\n\t\t\t\tconstraintTypes.FNLT,\n\t\t\t\tconstraintTypes.MSO,\n\t\t\t\tconstraintTypes.MFO\n\t\t\t];\n\t\t\tconst forwardConstraints = [\n\t\t\t\tconstraintTypes.SNET,\n\t\t\t\tconstraintTypes.FNET,\n\t\t\t\tconstraintTypes.MSO,\n\t\t\t\tconstraintTypes.MFO\n\t\t\t];\n\n\t\t\tif (autoSchedulingConfig.schedule_from_end) {\n\t\t\t\tif (backwardConstraints.indexOf(task.constraint_type) > -1) {\n\t\t\t\t\t// keep the constraint type\n\t\t\t\t\tif (task.constraint_type == constraintTypes.SNLT ||\n\t\t\t\t\t\ttask.constraint_type == constraintTypes.MSO) {\n\t\t\t\t\t\ttask.constraint_date = new Date(task.start_date);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttask.constraint_date = new Date(task.end_date);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// set the default constraint\n\t\t\t\t\ttask.constraint_type = constraintTypes.FNLT;\n\t\t\t\t\ttask.constraint_date = new Date(task.end_date);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (forwardConstraints.indexOf(task.constraint_type) > -1) {\n\t\t\t\t\t// keep the constraint type\n\t\t\t\t\tif (task.constraint_type == constraintTypes.SNET ||\n\t\t\t\t\t\ttask.constraint_type == constraintTypes.MSO) {\n\t\t\t\t\t\ttask.constraint_date = new Date(task.start_date);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttask.constraint_date = new Date(task.end_date);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// set the default constraint\n\t\t\t\t\ttask.constraint_type = constraintTypes.SNET;\n\t\t\t\t\ttask.constraint_date = new Date(task.start_date);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction finalizeTaskConstraints(task){\n\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\t\t\tif (!autoSchedulingConfig.apply_constraints) {\n\t\t\t\ttask.constraint_type = null;\n\t\t\t\ttask.constraint_date = null;\n\t\t\t}\n\t\t}\n\n\t\tconst _processConstraints = function(taskId, oldTask) {\n\t\t\tconst newTask = gantt.getTask(taskId);\n\t\t\tif (shouldKeepConstraints(newTask, oldTask)) {\n\t\t\t\t// don't change constraints\n\t\t\t} else {\n\t\t\t\tupdateTaskConstraints(newTask);\n\t\t\t}\n\t\t};\n\n\t\tconst _autoScheduleAfterDND = function(taskId, task) {\n\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\t\t\tif (autoSchedulingConfig.enabled && !gantt._autoscheduling_in_progress) {\n\t\t\t\tconst newTask = gantt.getTask(taskId);\n\n\t\t\t\tconst progressScheduling = (autoSchedulingConfig.use_progress && ((task.progress === 1) !== (newTask.progress === 1)));\n\n\t\t\t\tif (_notEqualTaskDates(task, newTask)) {\n\t\t\t\t\t_processConstraints(taskId, task);\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tautoSchedulingConfig.move_projects &&\n\t\t\t\t\t\t// tslint:disable-next-line triple-equals\n\t\t\t\t\t\tmovedTask == taskId\n\t\t\t\t\t) {\n\t\t\t\t\t\tlet shouldResetSSandSFLinkLags = true;\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tgantt.calculateDuration(task) !== gantt.calculateDuration(newTask)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t// task duration is used as lag when converting start_to_start and start_to_finish into finish to start links\n\t\t\t\t\t\t\t// recalculate these links if task duration has changed\n\t\t\t\t\t\t\tresetToStartLinksLags(taskId, relations);\n\t\t\t\t\t\t\t// to not call the function above twice\n\t\t\t\t\t\t\tshouldResetSSandSFLinkLags = false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif(progressScheduling){\n\t\t\t\t\t\t\tgantt.autoSchedule();\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t// GS-2588. The duration of the project tasks can be changed after the child drag,\n\t\t\t\t\t\t\t// so, we need to update that information for the SS and SF links\n\t\t\t\t\t\t\tif (shouldResetSSandSFLinkLags) {\n\t\t\t\t\t\t\t\tresetToStartLinksLags(taskId, relations);\n\t\t\t\t\t\t\t}\t\t\t\t\t\n\t\t\t\t\t\t\tgantt._autoSchedule(taskId, relations);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tgantt.autoSchedule(newTask.id);\n\t\t\t\t\t}\n\n\t\t\t\t\tfinalizeTaskConstraints(newTask);\n\t\t\t\t}\n\t\t\t}\n\t\t\trelations = null;\n\t\t\tmovedTask = null;\n\t\t\treturn true;\n\t\t};\n\n\n\n\n\t\tlet modifiedTaskId = null;\n\t\tif (gantt.ext && gantt.ext.inlineEditors) {\n\t\t\tconst inlineEditors = gantt.ext.inlineEditors;\n\t\t\tconst autoscheduleColumns = {\n\t\t\t\tstart_date: true,\n\t\t\t\tend_date: true,\n\t\t\t\tduration: true,\n\t\t\t\tconstraint_type: true,\n\t\t\t\tconstraint_date: true\n\t\t\t};\n\n\t\t\tinlineEditors.attachEvent(\"onBeforeSave\", function(state) {\n\t\t\t\tif (autoscheduleColumns[state.columnName]) {\n\t\t\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\t\t\t\t\tmodifiedTaskId = state.id;\n\t\t\t\t\t// GS-711. The constraint type set by the user should be saved\n\t\t\t\t\tif (state.columnName === \"constraint_type\"){\n\t\t\t\t\t\tchangedConstraint = true;\n\t\t\t\t\t}\n\t\t\t\t\t// GS-686. We shouldn't change the constraint after changing only the duration or end_date\n\t\t\t\t\tconst durationColumn = state.columnName === \"duration\";\n\t\t\t\t\tconst startDateColumn = autoSchedulingConfig.schedule_from_end && (state.columnName === \"start_date\");\n\t\t\t\t\tconst endDateColumn = !autoSchedulingConfig.schedule_from_end && (state.columnName === \"end_date\");\n\n\t\t\t\t\tconst linkedDateModification = gantt.config.inline_editors_date_processing !== \"keepDuration\";\n\t\t\t\t\tconst linkedColumnEdit = linkedDateModification && (startDateColumn || endDateColumn);\n\n\t\t\t\t\tconst constraintDateColumn = state.columnName === \"constraint_date\";\n\n\t\t\t\t\tconst keepConstraints = durationColumn || linkedColumnEdit || constraintDateColumn;\n\n\t\t\t\t\tif (keepConstraints) {\n\t\t\t\t\t\tconst task = gantt.getTask(state.id);\n\t\t\t\t\t\ttask.$keep_constraints = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t});\n\t\t}\n\n\t\tlet changedConstraint;\n\t\tfunction onBeforeLigthboxSaveHandler(taskId: TaskID, task: ITask): boolean {\n\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\t\t\tif (autoSchedulingConfig.enabled && !gantt._autoscheduling_in_progress) {\n\t\t\t\tchangedConstraint = false;\n\t\t\t\tconst oldTask = gantt.getTask(taskId);\n\t\t\t\tif (_notEqualTaskDates(task, oldTask)) {\n\t\t\t\t\tmodifiedTaskId = taskId;\n\t\t\t\t\tif (shouldKeepConstraints(task, oldTask)){\n\t\t\t\t\t\ttask.$keep_constraints = true;\n\t\t\t\t\t}\n\t\t\t\t\tif(gantt.getConstraintType(task) !== gantt.getConstraintType(oldTask) ||\n\t\t\t\t\t\t+task.constraint_date !== +oldTask.constraint_date\n\t\t\t\t\t){\n\t\t\t\t\t\tchangedConstraint = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\tfunction onAfterTaskUpdateHandler(taskId: TaskID, task: ITask): boolean {\n\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\t\t\tif (autoSchedulingConfig.enabled && !gantt._autoscheduling_in_progress) {\n\t\t\t\tif (\n\t\t\t\t\tmodifiedTaskId !== null &&\n\t\t\t\t\t// tslint:disable-next-line triple-equals\n\t\t\t\t\tmodifiedTaskId == taskId\n\t\t\t\t) {\n\t\t\t\t\tmodifiedTaskId = null;\n\t\t\t\t\tif (task.$keep_constraints){\n\t\t\t\t\t\tdelete task.$keep_constraints;\n\t\t\t\t\t} else if(!changedConstraint){\n\t\t\t\t\t\tupdateTaskConstraints(task);\n\t\t\t\t\t}\n\t\t\t\t\tgantt.autoSchedule(task.id);\n\n\t\t\t\t\tif(!changedConstraint){\n\t\t\t\t\t\tfinalizeTaskConstraints(task);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tconst draggedTask = {};\n\t\tlet timeout;\n\t\tgantt.attachEvent(\"onBeforeTaskChanged\", function(\n\t\t\tid: TaskID,\n\t\t\tmode: string,\n\t\t\ttask: ITask\n\t\t) {\n\t\t\t_processConstraints(id, task);\n\t\t\tdraggedTask[id] = task;\n\t\t\treturn true;\n\t\t});\n\n\t\t// GS-499, GS-264 and GS-836. Autoschedule only after finishing dragging the task\n\t\tgantt.attachEvent(\"onAfterTaskDrag\", function(id, mode, e) {\n\t\t\tif (id === movedTask) {\n\t\t\t\tclearTimeout(timeout);\n\t\t\t\ttimeout = setTimeout(function() {\n\t\t\t\t\t_autoScheduleAfterDND(id, draggedTask[id]);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tif(gantt.ext.inlineEditors){\n\t\t\tgantt.ext.inlineEditors.attachEvent(\"onBeforeSave\", function(state){\n\t\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\t\t\t\tif (autoSchedulingConfig.enabled && !gantt._autoscheduling_in_progress) {\n\t\t\t\t\tconst api = gantt.ext.inlineEditors;\n\t\t\t\t\tconst editorConfig = api.getEditorConfig(state.columnName);\n\t\t\t\t\tif(editorConfig && (editorConfig.map_to === \"start_date\" || editorConfig.map_to === \"end_date\" || editorConfig.map_to === \"duration\")){\n\t\t\t\t\t\tmodifiedTaskId = state.id;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t});\n\t\t}\n\n\t\tgantt.attachEvent(\"onLightboxSave\", onBeforeLigthboxSaveHandler);\n\t\tgantt.attachEvent(\"onAfterTaskUpdate\", onAfterTaskUpdateHandler);\n\t};\n\n\tgantt.attachEvent(\"onGanttReady\", function() {\n\t\t_attachAutoSchedulingHandlers();\n\t\t// attach handlers only when initialized for the first time\n\t}, {once: true});\n}\n","\n/* eslint-disable no-restricted-globals */\nvar globalScope;\nif(typeof window !== \"undefined\"){\n\tglobalScope = window;\n}else{\n\tglobalScope = global;\n}\n/* eslint-enable no-restricted-globals */\n\nexport default globalScope;","import * as domHelpers from \"../../core/ui/utils/dom_helpers\";\nimport global from \"../../utils/global\";\nimport { SelectedRegion } from \"./selectedRegion\";\n\nexport class EventsManager {\n\tprivate _mouseDown: boolean = false;\n\tprivate _touchStarts: boolean = false;\n\tprivate _touchActive: boolean = false;\n\tprivate _longTapTimer: any = false;\n\tprivate _domEvents: any;\n\tprivate _originPosition: string;\n\tprivate _gantt: any;\n\tprivate _restoreOriginPosition: () => void;\n\tconstructor(gantt: any) {\n\t\tthis._gantt = gantt;\n\t\tthis._domEvents = gantt._createDomEventScope();\n\t}\n\n\tattach(selectedRegion: SelectedRegion, useKey?: \"shiftKey\" | \"ctrlKey\" | \"altKey\", ignore?: any): void {\n\t\tconst gantt = this._gantt;\n\t\tconst _target = selectedRegion.getViewPort();\n\t\tthis._originPosition = global.getComputedStyle(_target).display;\n\t\tthis._restoreOriginPosition = () => {\n\t\t\t_target.style.position = this._originPosition;\n\t\t};\n\t\tif (this._originPosition === \"static\") {\n\t\t\t_target.style.position = \"relative\";\n\t\t}\n\t\tconst state = gantt.$services.getService(\"state\");\n\t\tstate.registerProvider(\"clickDrag\", () => {\n\t\t\tconst result = { autoscroll: false };\n\t\t\treturn result;\n\t\t});\n\n\n\t\tlet scheduledDndCoordinates:any = null;\n\t\tconst startDragAndDrop = () => {\n\t\t\tif (!scheduledDndCoordinates) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._mouseDown = true;\n\t\t\tselectedRegion.setStart(gantt.copy(scheduledDndCoordinates));\n\t\t\tselectedRegion.setPosition(gantt.copy(scheduledDndCoordinates));\n\t\t\tselectedRegion.setEnd(gantt.copy(scheduledDndCoordinates));\n\t\t\tscheduledDndCoordinates = null;\n\t\t};\n\n\t\t// mouse events\n\t\tthis._domEvents.attach(_target, \"mousedown\", (event) => {\n\t\t\tstartDrag(event);\n\t\t});\n\t\tconst eventElement = domHelpers.getRootNode(gantt.$root) || document.body;\n\t\tthis._domEvents.attach(eventElement, \"mouseup\", (event) => {\n\t\t\tstopDrag(event);\n\t\t});\n\t\tthis._domEvents.attach(_target, \"mousemove\", (event) => {\n\t\t\tdragMove(event);\n\t\t});\n\n\t\t// touch events\n\t\tthis._domEvents.attach(_target, \"touchstart\", (event) => {\n\t\t\tthis._touchStarts = true;\n\t\t\tthis._longTapTimer = setTimeout(()=> {\n\t\t\t\tif (this._touchStarts){\n\t\t\t\t\tstartDrag(getTouchEvent (event));\n\t\t\t\t\tthis._touchStarts = false;\n\t\t\t\t\tthis._touchActive = true;\n\t\t\t\t}\n\t\t\t}, this._gantt.config.touch_drag);\n\t\t});\n\n\t\tthis._domEvents.attach(eventElement, \"touchend\", (event) => {\n\t\t\tthis._touchStarts = false;\n\t\t\tthis._touchActive = false;\n\t\t\tclearTimeout(this._longTapTimer);\n\t\t\tstopDrag(getTouchEvent (event));\n\t\t});\n\t\tthis._domEvents.attach(_target, \"touchmove\", (event) => {\n\t\t\tif (this._touchActive){\n\t\t\t\tlet filterTargets = getFilterTargets();\n\t\t\t\tif (filterTargets && gantt.utils.dom.closest(event.target, filterTargets)){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tdragMove(getTouchEvent (event));\n\t\t\t\tevent.preventDefault();\n\t\t\t} else {\n\t\t\t\tthis._touchStarts = false;\n\t\t\t\tclearTimeout(this._longTapTimer);\t\n\t\t\t}\n\t\t});\n\n\t\tfunction getTouchEvent (event){\n\t\t\tconst touchEvent = event.changedTouches && event.changedTouches[0] || event;\n\t\t\treturn touchEvent;\n\t\t}\n\n\t\tconst getFilterTargets = () => {\n\t\t\tlet filterTargets = \".gantt_task_line, .gantt_task_link\";\n\t\t\tif (ignore !== undefined) {\n\t\t\t\tif (ignore instanceof Array) {\n\t\t\t\t\tfilterTargets = ignore.join(\", \");\n\t\t\t\t} else {\n\t\t\t\t\tfilterTargets = ignore;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn filterTargets;\n\t\t};\n\n\t\tconst startDrag: any = (event) => {\n\t\t\tscheduledDndCoordinates = null;\n\t\t\tlet filterTargets = getFilterTargets();\n\t\t\tif (filterTargets) {\n\t\t\t\tif (gantt.utils.dom.closest(event.target, filterTargets)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tstate.registerProvider(\"clickDrag\", () => {\n\t\t\t\tconst result = { autoscroll: this._mouseDown };\n\t\t\t\treturn result;\n\t\t\t});\n\n\t\t\tif (useKey && event[useKey] !== true) { return; }\n\t\t\tscheduledDndCoordinates = this._getCoordinates(event, selectedRegion);\n\t\t};\n\n\t\tconst stopDrag: any = (event) => {\n\t\t\tscheduledDndCoordinates = null;\n\t\t\tif (useKey && event[useKey] !== true) { return; }\n\t\t\tif (this._mouseDown === true) {\n\t\t\t\tthis._mouseDown = false;\n\t\t\t\tconst coordinates = this._getCoordinates(event, selectedRegion);\n\t\t\t\tselectedRegion.dragEnd(coordinates);\n\t\t\t}\n\t\t};\n\n\t\tconst dragMove: any = (event) => {\n\t\t\tif (useKey && event[useKey] !== true) { return; }\n\t\t\t// GS-854. If we don't have useKey for the click_drag extension,\n\t\t\t// check the drag_timeline to not simultaneously use both extensions\n\t\t\tconst dragTimeline = this._gantt.ext.clickDrag;\n\t\t\tconst dragTimelineUseKey = (this._gantt.config.drag_timeline || {}).useKey;\n\t\t\tif (dragTimeline && dragTimelineUseKey) {\n\t\t\t\tif (!useKey && event[dragTimelineUseKey]) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet coordinates:any = null;\n\t\t\tif(!this._mouseDown && scheduledDndCoordinates){\n\t\t\t\tcoordinates = this._getCoordinates(event, selectedRegion);\n\t\t\t\tif(Math.abs(scheduledDndCoordinates.relative.left - coordinates.relative.left) > 5){\n\t\t\t\t\t// add small threshold not to start dnd on simple click\n\t\t\t\t\tstartDragAndDrop();\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (this._mouseDown === true) {\n\t\t\t\tcoordinates = this._getCoordinates(event, selectedRegion);\n\t\t\t\tselectedRegion.setEnd(coordinates);\n\t\t\t\tselectedRegion.render();\n\t\t\t}\n\t\t};\n\t}\n\n\tdetach(): void {\n\t\tconst gantt = this._gantt;\n\t\tthis._domEvents.detachAll();\n\t\tif(this._restoreOriginPosition){\n\t\t\tthis._restoreOriginPosition();\n\t\t}\n\n\t\tconst state = gantt.$services.getService(\"state\");\n\t\tstate.unregisterProvider(\"clickDrag\");\n\t}\n\n\tdestructor(): void {\n\t\tthis.detach();\n\t}\n\n\tprivate _getCoordinates(event: MouseEvent, selectedRegion: SelectedRegion) {\n\t\tconst viewPort = selectedRegion.getViewPort();\n\t\tconst viewPortBounds = viewPort.getBoundingClientRect();\n\t\tconst { clientX, clientY } = event;\n\t\tconst result = {\n\t\t\tabsolute: {\n\t\t\t\tleft: clientX,\n\t\t\t\ttop: clientY\n\t\t\t},\n\t\t\trelative: {\n\t\t\t\tleft: clientX - viewPortBounds.left + viewPort.scrollLeft,\n\t\t\t\ttop: clientY - viewPortBounds.top + viewPort.scrollTop\n\t\t\t}\n\t\t};\n\t\treturn result;\n\t}\n}","var EventHost = function(){\n\tthis._silent_mode = false;\n\tthis.listeners = {};\n};\n\nEventHost.prototype = {\n\t_silentStart: function() {\n\t\tthis._silent_mode = true;\n\t},\n\t_silentEnd: function() {\n\t\tthis._silent_mode = false;\n\t}\n};\n\nvar\tcreateEventStorage = function(obj) {\n\tvar handlers = {};\n\tvar index = 0;\n\tvar eventStorage = function(){\n\t\tvar combinedResult = true;\n\t\tfor(var i in handlers){\n\t\t\tvar handlerResult = handlers[i].apply(obj, arguments);\n\t\t\tcombinedResult=combinedResult && handlerResult;\n\t\t}\n\t\treturn combinedResult;\n\t};\n\teventStorage.addEvent=function(handler, settings){\n\t\tif (typeof (handler) == \"function\"){\n\t\t\tvar handlerId;\n\t\t\tif(settings && settings.id){\n\t\t\t\thandlerId = settings.id;\n\t\t\t}else{\n\t\t\t\thandlerId = index;\n\t\t\t\tindex++;\n\t\t\t}\n\n\t\t\tif(settings && settings.once){\n\t\t\t\tvar originalHandler = handler;\n\t\t\t\thandler = function(){\n\t\t\t\t\toriginalHandler();\n\t\t\t\t\teventStorage.removeEvent(handlerId);\n\t\t\t\t};\n\t\t\t}\n\n\t\t\thandlers[handlerId] = handler;\n\t\t\treturn handlerId;\n\t\t}\n\t\treturn false;\n\t};\n\teventStorage.removeEvent=function(id){\n\t\tdelete handlers[id];\n\t};\n\n\teventStorage.clear = function(){\n\t\thandlers = {};\n\t};\n\n\treturn eventStorage;\n};\n\nfunction makeEventable(obj){\n\n\tvar eventHost = new EventHost();\n\tobj.attachEvent=function(eventName, handler, settings){\n\t\teventName = 'ev_'+eventName.toLowerCase();\n\t\tif (!eventHost.listeners[eventName]){\n\t\t\teventHost.listeners[eventName] = createEventStorage(this);\n\t\t}\n\n\t\tif(settings && settings.thisObject){\n\t\t\thandler = handler.bind(settings.thisObject);\n\t\t}\n\n\t\tvar innerId = eventHost.listeners[eventName].addEvent(handler, settings);\n\n\t\tvar handlerId = (eventName+':'+innerId); //return ID (ev_eventname:1)\n\t\tif(settings && settings.id){\n\t\t\thandlerId = settings.id;\n\t\t}\n\t\treturn handlerId;\n\t};\n\n\tobj.attachAll = function(callback){\n\t\tthis.attachEvent('listen_all', callback);\n\t};\n\n\tobj.callEvent=function(name, eventArguments){\n\t\tif (eventHost._silent_mode) return true;\n\n\t\tvar handlerName = 'ev_'+name.toLowerCase();\n\n\t\tvar listeners = eventHost.listeners;\n\t\tif (listeners['ev_listen_all']){\n\t\t\tlisteners['ev_listen_all'].apply(this, [name].concat(eventArguments));\n\t\t}\n\n\t\tif (listeners[handlerName])\n\t\t\treturn listeners[handlerName].apply(this, eventArguments);\n\t\treturn true;\n\t};\n\n\tobj.checkEvent=function(name){\n\t\tvar listeners = eventHost.listeners;\n\t\treturn (!!listeners['ev_'+name.toLowerCase()]);\n\t};\n\n\tobj.detachEvent=function(id){\n\t\tif (id){\n\t\t\tvar listeners = eventHost.listeners;\n\t\t\tfor(var i in listeners){\n\t\t\t\tlisteners[i].removeEvent(id); //remove event\n\t\t\t}\n\n\t\t\tvar list = id.split(':');//get EventName and ID\n\t\t\tvar listeners = eventHost.listeners;\n\t\t\tif(list.length === 2){\n\t\t\t\tvar eventName = list[0];\n\t\t\t\tvar eventId = list[1];\n\t\t\t\tif(listeners[eventName]){\n\t\t\t\t\tlisteners[eventName].removeEvent(eventId); //remove event\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\tobj.detachAllEvents = function(){\n\t\tfor (var name in eventHost.listeners) {\n\t\t\teventHost.listeners[name].clear();\n\t\t}\n\t};\n\n}\n\nexport default makeEventable;","import eventable from \"../../utils/eventable\";\nimport { isEventable } from \"../../utils/helpers\";\n\nexport interface ISelectedRegionConfig {\n\tclassName?: string;\n\trender?: (startPoint: IPoint, endPoint: IPoint) => HTMLElement;\n\tviewPort?: HTMLElement;\n\tuseRequestAnimationFrame: boolean;\n\tcallback?: (startPoint: IPoint, endPoint: IPoint, startDate: Date, endDate: Date, tasksByDate: any[], tasksByIndex: any[]) => void;\n\tsingleRow: boolean;\n}\n\ninterface ICoordinates {\n\tleft: number;\n\ttop: number;\n}\n\nexport interface IPoint {\n\tabsolute: ICoordinates;\n\trelative: ICoordinates;\n}\n\nexport class SelectedRegion {\n\trender: () => void;\n\tprivate _viewPort: HTMLElement & eventable;\n\tprivate _el: HTMLElement = document.createElement(\"div\");\n\tprivate _callback: (startPoint: IPoint, endPoint: IPoint, startDate: Date, endDate: Date, tasksByDate: any[], tasksByIndex: any[]) => void;\n\tprivate _startPoint: IPoint;\n\tprivate _endPoint: IPoint;\n\tprivate _positionPoint: IPoint;\n\tprivate _useRequestAnimationFrame: boolean;\n\tprivate _startDate: Date;\n\tprivate _endDate: Date;\n\tprivate _singleRow: boolean;\n\tprivate _gantt: any;\n\tprivate _view: any;\n\n\tconstructor(config: ISelectedRegionConfig, gantt: any, view: any) {\n\t\tthis._gantt = gantt;\n\t\tthis._view = view;\n\t\tthis._viewPort = config.viewPort;\n\t\tthis._el.classList.add(config.className);\n\t\tif (typeof config.callback === \"function\") {\n\t\t\tthis._callback = config.callback;\n\t\t}\n\n\t\tthis.render = () => {\n\t\t\tlet node;\n\t\t\tif(config.render){\n\t\t\t\tnode = config.render(this._startPoint, this._endPoint);\n\t\t\t}else{\n\t\t\t\tnode = this.defaultRender(this._startPoint, this._endPoint);\n\t\t\t}\n\n\t\t\tif(node !== this._el){\n\t\t\t\tif(this._el && this._el.parentNode){\n\t\t\t\t\tthis._el.parentNode.removeChild(this._el);\n\t\t\t\t}\n\t\t\t\tthis._el = node;\n\t\t\t}\n\n\t\t\tif (config.className !== \"\") {\n\t\t\t\tthis._el.classList.add(config.className);\n\t\t\t}\n\t\t\tthis.draw();\n\t\t};\n\n\t\tif (!isEventable(this._viewPort)) {\n\t\t\teventable(this._viewPort);\n\t\t}\n\t\tthis._singleRow = config.singleRow;\n\t\tthis._useRequestAnimationFrame = config.useRequestAnimationFrame;\n\t}\n\n\tdefaultRender = (start: IPoint, end: IPoint) => {\n\t\tif(!this._el){\n\t\t\tthis._el = document.createElement(\"div\");\n\t\t}\n\t\tconst node = this._el;\n\t\t// const gantt = this._gantt;\n\n\t\tconst top = Math.min(start.relative.top, end.relative.top);\n\t\tconst bottom = Math.max(start.relative.top, end.relative.top);\n\t\tconst left = Math.min(start.relative.left, end.relative.left);\n\t\tconst right = Math.max(start.relative.left, end.relative.left);\n\n\t\tif (this._singleRow) {\n\t\t\tconst pos = this._getTaskPositionByTop(this._startPoint.relative.top);\n\t\t\tnode.style.height = pos.height + \"px\";\n\t\t\tnode.style.top = pos.top + \"px\";\n\t\t} else {\n\t\t\tnode.style.height = Math.abs(bottom - top) + \"px\";\n\t\t\tnode.style.top = top + \"px\";\n\t\t}\n\t\tnode.style.width = Math.abs(right - left) + \"px\";\n\t\tnode.style.left = left + \"px\";\n\t\treturn node;\n\t};\n\n\tdraw() {\n\t\tif (this._useRequestAnimationFrame) {\n\t\t\treturn requestAnimationFrame(() => {\n\t\t\t\tthis._viewPort.appendChild(this.getElement());\n\t\t\t});\n\t\t} else {\n\t\t\tthis._viewPort.appendChild(this.getElement());\n\t\t}\n\t}\n\n\tclear() {\n\t\tif (this._useRequestAnimationFrame) {\n\t\t\treturn requestAnimationFrame(() => {\n\t\t\t\tif (!this._el.parentNode) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis._viewPort.removeChild(this._el);\n\t\t\t});\n\t\t} else {\n\t\t\tif (!this._el.parentNode) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._viewPort.removeChild(this._el);\n\t\t}\n\t}\n\n\tgetElement() {\n\t\treturn this._el;\n\t}\n\n\tgetViewPort() {\n\t\treturn this._viewPort;\n\t}\n\n\tsetStart(startPoint: IPoint) {\n\t\tconst gantt = this._gantt;\n\t\tthis._startPoint = startPoint;\n\t\tthis._startDate = gantt.dateFromPos(this._startPoint.relative.left);\n\t\tthis._viewPort.callEvent(\"onBeforeDrag\", [this._startPoint]);\n\t}\n\n\tsetEnd(endPoint: IPoint) {\n\t\tconst gantt = this._gantt;\n\t\tthis._endPoint = endPoint;\n\t\tif (this._singleRow) {\n\t\t\tconst pos = this._getTaskPositionByTop(this._startPoint.relative.top);\n\t\t\tthis._endPoint.relative.top = pos.top;\n\t\t}\n\t\tthis._endDate = gantt.dateFromPos(this._endPoint.relative.left);\n\t\tif (this._startPoint.relative.left > this._endPoint.relative.left) {\n\t\t\tthis._positionPoint = {\n\t\t\t\trelative: { left: this._endPoint.relative.left, top: this._positionPoint.relative.top },\n\t\t\t\tabsolute: { left: this._endPoint.absolute.left, top: this._positionPoint.absolute.top }\n\t\t\t};\n\t\t}\n\t\tif (this._startPoint.relative.top > this._endPoint.relative.top) {\n\t\t\tthis._positionPoint = {\n\t\t\t\trelative: { left: this._positionPoint.relative.left, top: this._endPoint.relative.top },\n\t\t\t\tabsolute: { left: this._positionPoint.absolute.left, top: this._endPoint.absolute.top }\n\t\t\t};\n\t\t}\n\n\n\t\tthis._viewPort.callEvent(\"onDrag\", [this._startPoint, this._endPoint]);\n\t}\n\n\tsetPosition(positionPoint: IPoint) {\n\t\tthis._positionPoint = positionPoint;\n\t}\n\n\tdragEnd(endPoint: IPoint) {\n\t\tconst gantt = this._gantt;\n\t\tif(endPoint.relative.left < 0){\n\t\t\tendPoint.relative.left = 0;\n\t\t}\n\t\tthis._viewPort.callEvent(\"onBeforeDragEnd\", [this._startPoint, endPoint]);\n\t\tthis.setEnd(endPoint);\n\t\t// GS-1422. The endDate can be null if we drag the mouse outside the Gantt container\n\t\tthis._endDate = this._endDate || gantt.getState().max_date;\n\n\t\tif (this._startDate.valueOf() > this._endDate.valueOf()) {\n\t\t\t[ this._startDate, this._endDate ] = [ this._endDate, this._startDate ];\n\t\t}\n\t\tthis.clear();\n\t\tconst tasksByTime = gantt.getTaskByTime(this._startDate, this._endDate);\n\t\tconst tasksByIndex = this._getTasksByTop(this._startPoint.relative.top, this._endPoint.relative.top);\n\n\t\tthis._viewPort.callEvent(\"onDragEnd\", [this._startPoint, this._endPoint]);\n\t\tif (this._callback) {\n\t\t\tthis._callback(this._startPoint, this._endPoint, this._startDate, this._endDate, tasksByTime, tasksByIndex);\n\t\t}\n\t}\n\n\tgetInBounds() {\n\t\treturn this._singleRow;\n\t}\n\n\tprivate _getTasksByTop(start: number, end:number) {\n\t\tconst gantt = this._gantt;\n\t\tlet startValue = start;\n\t\tlet endValue = end;\n\t\tif (start > end) {\n\t\t\tstartValue = end;\n\t\t\tendValue = start;\n\t\t}\n\t\tconst startIndex = this._getTaskPositionByTop(startValue).index;\n\t\tconst endIndex = this._getTaskPositionByTop(endValue).index;\n\t\tconst result = [];\n\t\tfor (let i = startIndex; i <= endIndex; i++) {\n\t\t\tconst task = gantt.getTaskByIndex(i);\n\t\t\tif (task) {\n\t\t\t\tresult.push(gantt.getTaskByIndex(i));\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate _getTaskPositionByTop(top: number){\n\t\tconst gantt = this._gantt;\n\t\tconst view = this._view;\n\t\tconst index = view.getItemIndexByTopPosition(top);\n\t\tconst task = gantt.getTaskByIndex(index);\n\t\tif(task){\n\t\t\tconst height = view.getItemHeight(task.id);\n\t\t\tconst itemTop = view.getItemTop(task.id);\n\t\t\treturn {\n\t\t\t\ttop: itemTop || 0,\n\t\t\t\theight: height || 0,\n\t\t\t\tindex\n\t\t\t};\n\t\t} else {\n\t\t\tconst dataHeight = view.getTotalHeight();\n\t\t\treturn {\n\t\t\t\ttop: top > dataHeight ? dataHeight : 0,\n\t\t\t\theight: gantt.config.row_height,\n\t\t\t\tindex: top > dataHeight ? gantt.getTaskCount() : 0\n\t\t\t};\n\t\t}\n\t}\n}","interface IPoint {\n\tx: number;\n\ty: number;\n}\n\nlet _dragInProgress: boolean = false;\n\nexport class EventsManager {\n\tstatic create(gantt: any) {\n\t\treturn new EventsManager(gantt);\n\t}\n\tstatic _isDragInProgress() {\n\t\treturn _dragInProgress;\n\t}\n\tprivate _mouseDown: boolean = false;\n\tprivate _startPoint: IPoint;\n\tprivate _scrollState: IPoint;\n\tprivate _originAutoscroll: boolean;\n\tprivate _domEvents: any;\n\tprivate _timeline: any;\n\tprivate _gantt: any;\n\tprivate _trace: IPoint[];\n\tprivate _originalReadonly: boolean;\n\n\tconstructor(gantt: any) {\n\t\tthis._gantt = gantt;\n\t\tthis._domEvents = gantt._createDomEventScope();\n\t\tthis._trace = [];\n\t}\n\n\tdestructor() {\n\t\tthis._domEvents.detachAll();\n\t}\n\n\tattach(timeline: any): void {\n\t\tthis._timeline = timeline;\n\t\tconst gantt = this._gantt;\n\t\tthis._domEvents.attach(timeline.$task, \"mousedown\", (event) => {\n\t\t\tif (!gantt.config.drag_timeline) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst { useKey,ignore, enabled } = gantt.config.drag_timeline;\n\t\t\tif(enabled === false) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet filterTargets = \".gantt_task_line, .gantt_task_link\";\n\t\t\tif(ignore !== undefined) {\n\t\t\t\tif(ignore instanceof Array){\n\t\t\t\t\tfilterTargets = ignore.join(\", \");\n\t\t\t\t} else {\n\t\t\t\t\tfilterTargets = ignore;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (filterTargets) {\n\t\t\t\tif (gantt.utils.dom.closest(event.target, filterTargets)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (useKey && event[useKey] !== true) { return; }\n\n\t\t\tthis._startDrag(event);\n\t\t});\n\n\t\tthis._domEvents.attach(document, \"keydown\", (event) => {\n\t\t\tif (!gantt.config.drag_timeline) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst { useKey } = gantt.config.drag_timeline;\n\t\t\tif (useKey && event[useKey] === true) {\n\t\t\t\tthis._applyDndReadyStyles();\n\t\t\t}\n\t\t});\n\t\tthis._domEvents.attach(document, \"keyup\", (event) => {\n\t\t\tif (!gantt.config.drag_timeline) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst { useKey } = gantt.config.drag_timeline;\n\t\t\tif (useKey && event[useKey] === false) {\n\t\t\t\tthis._clearDndReadyStyles();\n\t\t\t\tthis._stopDrag(event);\n\t\t\t}\n\t\t});\n\n\t\tthis._domEvents.attach(document, \"mouseup\", (event) => {\n\t\t\tthis._stopDrag(event);\n\t\t});\n\t\tthis._domEvents.attach(gantt.$root, \"mouseup\", (event) => {\n\t\t\tthis._stopDrag(event);\n\t\t});\n\t\tthis._domEvents.attach(document, \"mouseleave\", (event) => {\n\t\t\tthis._stopDrag(event);\n\t\t});\n\t\tthis._domEvents.attach(gantt.$root, \"mouseleave\", (event) => {\n\t\t\tthis._stopDrag(event);\n\t\t});\n\n\t\tthis._domEvents.attach(gantt.$root, \"mousemove\", (event) => {\n\t\t\tif (!gantt.config.drag_timeline) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst { useKey } = gantt.config.drag_timeline;\n\t\t\tif (useKey && event[useKey] !== true) { return; }\n\t\t\t// GS-854. If we don't have useKey for the drag_timeline extension,\n\t\t\t// check the click_drag to not simultaneously use both extensions\n\t\t\tconst clickDrag = this._gantt.ext.clickDrag;\n\t\t\tconst clickDragUseKey = (this._gantt.config.click_drag || {}).useKey;\n\t\t\tif (clickDrag && clickDragUseKey) {\n\t\t\t\tif (!useKey && event[clickDragUseKey]) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this._mouseDown === true) {\n\t\t\t\tthis._trace.push({ x: event.clientX, y: event.clientY });\n\t\t\t\tconst scrollPosition: IPoint = this._countNewScrollPosition({ x: event.clientX, y: event.clientY });\n\t\t\t\tthis._setScrollPosition(timeline, scrollPosition);\n\t\t\t\tthis._scrollState = scrollPosition;\n\t\t\t\tthis._startPoint = { x: event.clientX, y: event.clientY };\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate _calculateDirectionVector = () => {\n\t\tconst traceSteps = 10;\n\t\tif(this._trace.length >= traceSteps) {\n\t\t\tconst dots = this._trace.slice(this._trace.length - traceSteps);\n\n\t\t\tconst vectors = [];\n\t\t\tfor(let i = 1; i < dots.length; i++) {\n\t\t\t\tvectors.push({\n\t\t\t\t\tx: dots[i].x - dots[i - 1].x,\n\t\t\t\t\ty: dots[i].y - dots[i - 1].y\n\t\t\t\t});\n\t\t\t}\n\t\t\tconst resultVector = {x:0, y:0};\n\n\t\t\tvectors.forEach((vector) => {\n\t\t\t\tresultVector.x += vector.x;\n\t\t\t\tresultVector.y += vector.y;\n\t\t\t});\n\n\t\t\tconst magnitude = Math.sqrt(resultVector.x*resultVector.x + resultVector.y*resultVector.y);\n\t\t\tconst angleDegrees = Math.atan2(Math.abs(resultVector.y), Math.abs(resultVector.x)) * 180 / Math.PI;\n\n\t\t\treturn {\n\t\t\t\tmagnitude,\n\t\t\t\tangleDegrees\n\t\t\t};\n\n\t\t}\n\t\treturn null;\n\t};\n\n\tprivate _applyDndReadyStyles = (): void => {\n\t\tthis._timeline.$task.classList.add(\"gantt_timeline_move_available\");\n\t};\n\n\tprivate _clearDndReadyStyles = (): void => {\n\t\tthis._timeline.$task.classList.remove(\"gantt_timeline_move_available\");\n\t};\n\n\tprivate _getScrollPosition = (timeline: any): IPoint => {\n\t\tconst gantt = this._gantt;\n\t\treturn {\n\t\t\tx: gantt.$ui.getView(timeline.$config.scrollX).getScrollState().position,\n\t\t\ty: gantt.$ui.getView(timeline.$config.scrollY).getScrollState().position\n\t\t};\n\t};\n\tprivate _countNewScrollPosition = (coords: IPoint): IPoint => {\n\t\tconst vector = this._calculateDirectionVector();\n\t\tlet shiftX = this._startPoint.x - coords.x;\n\t\tlet shiftY = this._startPoint.y - coords.y;\n\t\tif(vector){\n\t\t\tif(vector.angleDegrees < 15){\n\t\t\t\tshiftY = 0;\n\t\t\t} else if(vector.angleDegrees > 75){\n\t\t\t\tshiftX = 0;\n\t\t\t}\n\t\t}\n\n\t\tconst result = {\n\t\t\tx: this._scrollState.x + shiftX,\n\t\t\ty: this._scrollState.y + shiftY\n\t\t};\n\t\treturn result;\n\t};\n\tprivate _setScrollPosition = (timeline: any, coords: IPoint): void => {\n\t\tconst gantt = this._gantt;\n\t\trequestAnimationFrame(() => {\n\t\t\tgantt.scrollLayoutCell(timeline.$id, coords.x, coords.y);\n\t\t});\n\t};\n\tprivate _stopDrag = (event: Event): void => {\n\t\tconst gantt = this._gantt;\n\t\tthis._trace = [];\n\t\tgantt.$root.classList.remove(\"gantt_noselect\");\n\n\t\t// We need to set the readonly mode because with the key modifiers, \n\t\t// users may expect to start dragging the timeline on the task and link coordinates\n\t\tif(this._originalReadonly !== undefined && this._mouseDown){\n\t\t\tgantt.config.readonly = this._originalReadonly;\n\t\t\tif(gantt.config.drag_timeline && gantt.config.drag_timeline.render){\n\t\t\t\tgantt.render();\n\t\t\t}\n\t\t}\n\n\t\tif(this._originAutoscroll !== undefined){\n\t\t\tgantt.config.autoscroll = this._originAutoscroll;\n\t\t}\n\n\t\tif(gantt.config.drag_timeline){\n\t\t\tconst { useKey } = gantt.config.drag_timeline;\n\t\t\tif (useKey && event[useKey] !== true) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis._mouseDown = false;\n\t\t_dragInProgress = false;\n\t};\n\n\tprivate _startDrag = (event: any) : void => {\n\t\tconst gantt = this._gantt;\n\t\tthis._originAutoscroll = gantt.config.autoscroll;\n\t\tgantt.config.autoscroll = false;\n\t\t_dragInProgress = true;\n\n\t\tgantt.$root.classList.add(\"gantt_noselect\");\n\t\tthis._originalReadonly = gantt.config.readonly;\n\t\tgantt.config.readonly = true;\n\n\t\tif(gantt.config.drag_timeline && gantt.config.drag_timeline.render){\n\t\t\tgantt.render();\n\t\t}\n\n\t\tthis._trace = [];\n\t\tthis._mouseDown = true;\n\t\tconst { x, y } = this._getScrollPosition(this._timeline);\n\t\tthis._scrollState = { x, y };\n\t\tthis._startPoint = { x: event.clientX, y: event.clientY };\n\t\tthis._trace.push(this._startPoint);\n\t};\n}","import * as helpers from \"./helpers\";\n\nvar plainObjectConstructor = ({}).constructor.toString();\nfunction isCustomType(object){\n\tvar constructorString = object.constructor.toString();\n\n\treturn constructorString !== plainObjectConstructor;\n}\n\nfunction isExternalType(object){\n\t// react elements are not plain objects, but they are not custom types either\n\t// can't deep copy them\n\treturn object.$$typeof && object.$$typeof.toString().includes(\"react.\");\n}\n\nfunction copy(object) {\n\tvar i, result; // iterator, types array, result\n\n\tif (object && typeof object == \"object\") {\n\n\t\tswitch (true){\n\t\t\tcase (helpers.isDate(object)):\n\t\t\t\tresult = new Date(object);\n\t\t\t\tbreak;\n\t\t\tcase (helpers.isArray(object)):\n\t\t\t\tresult = new Array(object.length);\n\t\t\t\tfor(i = 0; i < object.length; i++){\n\t\t\t\t\tresult[i] = copy(object[i]);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t/*\t\tcase (helpers.isStringObject(object)):\n\t\t\t\tresult = new String(object);\n\t\t\t\tbreak;\n\t\t\tcase (helpers.isNumberObject(object)):\n\t\t\t\tresult = new Number(object);\n\t\t\t\tbreak;\n\t\t\tcase (helpers.isBooleanObject(object)):\n\t\t\t\tresult = new Boolean(object);\n\t\t\t\tbreak;*/\n\t\t\tdefault:\n\t\t\t\tif(isCustomType(object)){\n\t\t\t\t\tresult = Object.create(object);\n\t\t\t\t}else if (isExternalType(object)){\n\t\t\t\t\tresult = object;\n\t\t\t\t\treturn result;\n\t\t\t\t} else {\n\t\t\t\t\tresult = {};\n\t\t\t\t}\n\n\t\t\t\tfor (i in object) {\n\t\t\t\t\tif (Object.prototype.hasOwnProperty.apply(object, [i]))\n\t\t\t\t\t\tresult[i] = copy(object[i]);\n\t\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn result || object;\n}\n\nfunction mixin (target, source, force){\n\tfor (var f in source)\n\t\tif (((target[f] === undefined) || force)) target[f]=source[f];\n\treturn target;\n}\n\nfunction defined(obj) {\n\treturn typeof(obj) != \"undefined\";\n}\n\nvar seed;\nfunction uid() {\n\tif (!seed)\n\t\tseed = (new Date()).valueOf();\n\n\tseed++;\n\treturn seed;\n}\n\n//creates function with specified \"this\" pointer\nfunction bind(functor, object){\n\tif(functor.bind)\n\t\treturn functor.bind(object);\n\telse\n\t\treturn function(){ return functor.apply(object,arguments); };\n}\n\nfunction event(el, event, handler, capture){\n\tif (el.addEventListener)\n\t\tel.addEventListener(event, handler, capture === undefined ? false : capture);\n\n\telse if (el.attachEvent)\n\t\tel.attachEvent(\"on\"+event, handler);\n}\n\nfunction eventRemove(el, event, handler, capture){\n\tif (el.removeEventListener)\n\t\tel.removeEventListener(event, handler, capture === undefined ? false : capture);\n\n\telse if (el.detachEvent)\n\t\tel.detachEvent(\"on\"+event, handler);\n}\n\nexport {\n\tcopy,\n\tdefined,\n\tmixin,\n\tuid,\n\tbind,\n\tevent,\n\teventRemove\n};","import * as utils from \"../../../utils/utils\";\n\nfunction ScaleHelper(gantt){\n\tvar dateHelper = gantt.date;\n\tvar services = gantt.$services;\n\n\treturn {\n\t\tgetSum: function (sizes, from, to) {\n\t\t\tif (to === undefined)\n\t\t\t\tto = sizes.length - 1;\n\t\t\tif (from === undefined)\n\t\t\t\tfrom = 0;\n\n\t\t\tvar summ = 0;\n\t\t\tfor (var i = from; i <= to; i++)\n\t\t\t\tsumm += sizes[i];\n\n\t\t\treturn summ;\n\t\t},\n\t\tsetSumWidth: function (sum_width, scale, from, to) {\n\t\t\tvar parts = scale.width;\n\n\t\t\tif (to === undefined)\n\t\t\t\tto = parts.length - 1;\n\t\t\tif (from === undefined)\n\t\t\t\tfrom = 0;\n\t\t\tvar length = to - from + 1;\n\n\t\t\tif (from > parts.length - 1 || length <= 0 || to > parts.length - 1)\n\t\t\t\treturn;\n\n\t\t\tvar oldWidth = this.getSum(parts, from, to);\n\n\t\t\tvar diff = sum_width - oldWidth;\n\n\t\t\tthis.adjustSize(diff, parts, from, to);\n\t\t\tthis.adjustSize(-diff, parts, to + 1);\n\n\t\t\tscale.full_width = this.getSum(parts);\n\t\t},\n\t\tsplitSize: function (width, count) {\n\t\t\tvar arr = [];\n\t\t\tfor (var i = 0; i < count; i++) arr[i] = 0;\n\n\t\t\tthis.adjustSize(width, arr);\n\t\t\treturn arr;\n\n\t\t},\n\t\tadjustSize: function (width, parts, from, to) {\n\t\t\tif (!from)\n\t\t\t\tfrom = 0;\n\t\t\tif (to === undefined)\n\t\t\t\tto = parts.length - 1;\n\n\t\t\tvar length = to - from + 1;\n\n\t\t\tvar full = this.getSum(parts, from, to);\n\n\t\t\tfor (var i = from; i <= to; i++) {\n\t\t\t\tvar share = Math.floor(width * (full ? (parts[i] / full) : (1 / length)));\n\n\t\t\t\tfull -= parts[i];\n\t\t\t\twidth -= share;\n\t\t\t\tlength--;\n\n\t\t\t\tparts[i] += share;\n\t\t\t}\n\t\t\tparts[parts.length - 1] += width;\n\t\t},\n\t\tsortScales: function (scales) {\n\t\t\tfunction cellSize(unit, step) {\n\t\t\t\tvar d = new Date(1970, 0, 1);\n\t\t\t\treturn dateHelper.add(d, step, unit) - d;\n\t\t\t}\n\n\t\t\tscales.sort(function (a, b) {\n\t\t\t\tif (cellSize(a.unit, a.step) < cellSize(b.unit, b.step)) {\n\t\t\t\t\treturn 1;\n\t\t\t\t} else if (cellSize(a.unit, a.step) > cellSize(b.unit, b.step)) {\n\t\t\t\t\treturn -1;\n\t\t\t\t} else {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tfor (var i = 0; i < scales.length; i++) {\n\t\t\t\tscales[i].index = i;\n\t\t\t}\n\t\t},\n\t\t_prepareScaleObject: function(scale){\n\t\t\tvar format = scale.format;\n\t\t\tif(!format){\n\t\t\t\tformat = scale.template || scale.date || \"%d %M\";\n\t\t\t}\n\n\t\t\tif(typeof format === \"string\"){\n\t\t\t\tformat = gantt.date.date_to_str(format);\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tunit: scale.unit || \"day\",\n\t\t\t\tstep: scale.step || 1,\n\t\t\t\tformat: format,\n\t\t\t\tcss: scale.css,\n\t\t\t\tprojection: scale.projection || null,\n\t\t\t\tcolumn_width: scale.column_width || null\n\t\t\t};\n\t\t},\n\t\tprimaryScale: function(config) {\n\t\t\tconst scaleConfig = config || gantt.config;\n\n\t\t\tconst primaryScale = scaleConfig.scales[0];\n\t\t\tconst result = {\n\t\t\t\tunit: primaryScale.unit,\n\t\t\t\tstep: primaryScale.step,\n\t\t\t\ttemplate: primaryScale.template,\n\t\t\t\tformat: primaryScale.format,\n\t\t\t\tdate: primaryScale.date,\n\t\t\t\tcss: primaryScale.css || gantt.templates.scale_cell_class,\n\t\t\t\tprojection: primaryScale.projection || null,\n\t\t\t\tcolumn_width: primaryScale.column_width || null\n\t\t\t};\n\n\t\t\treturn this._prepareScaleObject(result);\n\t\t},\n\t\tgetAdditionalScales: function(config) {\n\t\t\tconst scaleConfig = config || gantt.config;\n\t\t\tconst scales = scaleConfig.scales.slice(1);\n\n\t\t\treturn scales.map(function(scale){\n\t\t\t\treturn this._prepareScaleObject(scale);\n\t\t\t}.bind(this));\n\t\t},\n\t\tprepareConfigs: function (scales, min_coll_width, container_width, scale_height, minDate, maxDate, rtl) {\n\t\t\tvar heights = this.splitSize(scale_height, scales.length);\n\t\t\tvar full_width = container_width;\n\n\t\t\tvar configs = [];\n\t\t\tfor (var i = scales.length - 1; i >= 0; i--) {\n\t\t\t\tvar main_scale = (i == scales.length - 1);\n\t\t\t\tvar cfg = this.initScaleConfig(scales[i], minDate, maxDate);\n\t\t\t\tif (main_scale) {\n\t\t\t\t\tthis.processIgnores(cfg);\n\t\t\t\t}\n\n\t\t\t\tif(main_scale && cfg.column_width){\n\t\t\t\t\tfull_width = cfg.column_width * (cfg.display_count || cfg.count);\n\t\t\t\t}\n\n\t\t\t\tthis.initColSizes(cfg, min_coll_width, full_width, heights[i]);\n\t\t\t\tthis.limitVisibleRange(cfg);\n\n\t\t\t\tif (main_scale) {\n\t\t\t\t\tfull_width = cfg.full_width;\n\t\t\t\t}\n\n\t\t\t\tconfigs.unshift(cfg);\n\t\t\t}\n\n\n\t\t\tfor (var i = 0; i < configs.length - 1; i++) {\n\t\t\t\tthis.alineScaleColumns(configs[configs.length - 1], configs[i]);\n\t\t\t}\n\t\t\tfor (var i = 0; i < configs.length; i++) {\n\n\t\t\t\tif(rtl){\n\t\t\t\t\tthis.reverseScale(configs[i]);\n\t\t\t\t}\n\t\t\t\tthis.setPosSettings(configs[i]);\n\t\t\t}\n\t\t\treturn configs;\n\n\t\t},\n\n\t\treverseScale: function(scale){\n\t\t\tscale.width = scale.width.reverse();\n\t\t\tscale.trace_x = scale.trace_x.reverse();\n\n\t\t\tvar indexes = scale.trace_indexes;\n\t\t\tscale.trace_indexes = {};\n\t\t\tscale.trace_index_transition = {};\n\t\t\tscale.rtl = true;\n\t\t\tfor(var i = 0; i < scale.trace_x.length; i++){\n\t\t\t\tscale.trace_indexes[scale.trace_x[i].valueOf()] = i;\n\t\t\t\tscale.trace_index_transition[indexes[scale.trace_x[i].valueOf()]] = i;\n\t\t\t}\n\t\t\treturn scale;\n\t\t},\n\n\t\tsetPosSettings: function (config) {\n\t\t\tfor (var i = 0, len = config.trace_x.length; i < len; i++) {\n\t\t\t\tconfig.left.push((config.width[i - 1] || 0) + (config.left[i - 1] || 0));\n\t\t\t}\n\t\t},\n\n\t\t_ignore_time_config: function (date, scale) {\n\n\t\t\tif (gantt.config.skip_off_time) {\n\t\t\t\tvar skip = true;\n\t\t\t\tvar probe = date;\n\n\t\t\t\t// check dates in case custom scale unit, e.g. {unit: \"month\", step: 3}\n\t\t\t\tfor (var i = 0; i < scale.step; i++) {\n\t\t\t\t\tif (i) {\n\t\t\t\t\t\tprobe = dateHelper.add(date, i, scale.unit);\n\t\t\t\t\t}\n\n\t\t\t\t\tskip = skip && !this.isWorkTime(probe, scale.unit);\n\t\t\t\t}\n\n\t\t\t\treturn skip;\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\t\t//defined in an extension\n\t\tprocessIgnores: function (config) {\n\t\t\tconfig.ignore_x = {};\n\t\t\tconfig.display_count = config.count;\n\t\t},\n\t\tinitColSizes: function (config, min_col_width, full_width, line_height) {\n\t\t\tvar cont_width = full_width;\n\n\t\t\tconfig.height = line_height;\n\n\t\t\tvar column_count = config.display_count === undefined ? config.count : config.display_count;\n\n\t\t\tif (!column_count)\n\t\t\t\tcolumn_count = 1;\n\n\t\t\tconst fixedMode = !isNaN(config.column_width*1) && config.column_width*1 > 0;\n\t\t\tif (fixedMode) {\n\t\t\t\tconst baseCellWidth = config.column_width*1;\n\t\t\t\tconfig.col_width = baseCellWidth;\n\t\t\t\tcont_width = baseCellWidth * column_count;\n\t\t\t} else {\n\t\t\t\tconfig.col_width = Math.floor(cont_width / column_count);\n\t\t\t\tif (min_col_width) {\n\t\t\t\t\tif (config.col_width < min_col_width) {\n\t\t\t\t\t\tconfig.col_width = min_col_width;\n\t\t\t\t\t\tcont_width = config.col_width * column_count;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconfig.width = [];\n\t\t\tvar ignores = config.ignore_x || {};\n\t\t\tfor (var i = 0; i < config.trace_x.length; i++) {\n\t\t\t\tif (ignores[config.trace_x[i].valueOf()] || (config.display_count == config.count)) {\n\t\t\t\t\tif(fixedMode){\n\t\t\t\t\t\tconfig.width[i] = config.col_width;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconfig.width[i] = 0;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// width of month columns should be proportional month duration\n\t\t\t\t\tvar width = 1;\n\t\t\t\t\tif (config.unit == \"month\") {\n\t\t\t\t\t\tvar days = Math.round((dateHelper.add(config.trace_x[i], config.step, config.unit) - config.trace_x[i]) / (1000 * 60 * 60 * 24));\n\t\t\t\t\t\twidth = days;\n\t\t\t\t\t}\n\t\t\t\t\tconfig.width[i] = width;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(!fixedMode){\n\t\t\t\tthis.adjustSize(cont_width - this.getSum(config.width)/* 1 width per column from the code above */, config.width);\n\t\t\t}\n\n\t\t\tconfig.full_width = this.getSum(config.width);\n\t\t},\n\t\tinitScaleConfig: function (config, min_date, max_date) {\n\t\t\tvar cfg = utils.mixin({\n\t\t\t\tcount: 0,\n\t\t\t\tcol_width: 0,\n\t\t\t\tfull_width: 0,\n\t\t\t\theight: 0,\n\t\t\t\twidth: [],\n\t\t\t\tleft: [],\n\t\t\t\ttrace_x: [],\n\t\t\t\ttrace_indexes: {},\n\t\t\t\tmin_date: new Date(min_date),\n\t\t\t\tmax_date: new Date(max_date)\n\t\t\t}, config);\n\n\t\t\tthis.eachColumn(config.unit, config.step, min_date, max_date, function (date) {\n\t\t\t\tcfg.count++;\n\t\t\t\tcfg.trace_x.push(new Date(date));\n\t\t\t\tcfg.trace_indexes[date.valueOf()] = cfg.trace_x.length - 1;\n\t\t\t});\n\n\t\t\tcfg.trace_x_ascending = cfg.trace_x.slice();\n\t\t\treturn cfg;\n\t\t},\n\t\titerateScales: function (lower_scale, upper_scale, from, to, callback) {\n\t\t\tvar upper_dates = upper_scale.trace_x;\n\t\t\tvar lower_dates = lower_scale.trace_x;\n\n\t\t\tvar prev = from || 0;\n\t\t\tvar end = to || (lower_dates.length - 1);\n\t\t\tvar prevUpper = 0;\n\n\n\t\t\tfor (var up = 1; up < upper_dates.length; up++) {\n\t\t\t\tvar target_index = (lower_scale.trace_indexes[+upper_dates[up]]);\n\t\t\t\tif (target_index !== undefined && target_index <= end) {\n\t\t\t\t\tif (callback) {\n\t\t\t\t\t\tcallback.apply(this, [prevUpper, up, prev, target_index]);\n\t\t\t\t\t}\n\t\t\t\t\tprev = target_index;\n\t\t\t\t\tprevUpper = up;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\talineScaleColumns: function (lower_scale, upper_scale, from, to) {\n\t\t\tthis.iterateScales(lower_scale, upper_scale, from, to, function (upper_start, upper_end, lower_start, lower_end) {\n\t\t\t\tvar targetWidth = this.getSum(lower_scale.width, lower_start, lower_end - 1);\n\t\t\t\tvar actualWidth = this.getSum(upper_scale.width, upper_start, upper_end - 1);\n\t\t\t\tif (actualWidth != targetWidth) {\n\t\t\t\t\tthis.setSumWidth(targetWidth, upper_scale, upper_start, upper_end - 1);\n\t\t\t\t}\n\n\t\t\t});\n\t\t},\n\n\t\teachColumn: function (unit, step, min_date, max_date, callback) {\n\t\t\tvar start = new Date(min_date),\n\t\t\t\tend = new Date(max_date);\n\t\t\tif (dateHelper[unit + \"_start\"]) {\n\t\t\t\tstart = dateHelper[unit + \"_start\"](start);\n\t\t\t}\n\n\t\t\tvar curr = new Date(start);\n\t\t\tif (+curr >= +end) {\n\t\t\t\tend = dateHelper.add(curr, step, unit);\n\t\t\t}\n\t\t\twhile (+curr < +end) {\n\t\t\t\tcallback.call(this, new Date(curr));\n\t\t\t\tvar tzOffset = curr.getTimezoneOffset();\n\t\t\t\tcurr = dateHelper.add(curr, step, unit);\n\t\t\t\tcurr = gantt._correct_dst_change(curr, tzOffset, step, unit);\n\t\t\t\tif (dateHelper[unit + '_start'])\n\t\t\t\t\tcurr = dateHelper[unit + \"_start\"](curr);\n\t\t\t}\n\t\t},\n\t\tlimitVisibleRange: function (cfg) {\n\t\t\tvar dates = cfg.trace_x;\n\n\t\t\tvar left = 0, right = cfg.width.length - 1;\n\t\t\tvar diff = 0;\n\t\t\tif (+dates[0] < +cfg.min_date && left != right) {\n\t\t\t\tvar width = Math.floor(cfg.width[0] * ((dates[1] - cfg.min_date) / (dates[1] - dates[0])));\n\t\t\t\tdiff += cfg.width[0] - width;\n\t\t\t\tcfg.width[0] = width;\n\n\t\t\t\tdates[0] = new Date(cfg.min_date);\n\t\t\t}\n\n\t\t\tvar last = dates.length - 1;\n\t\t\tvar lastDate = dates[last];\n\t\t\tvar outDate = dateHelper.add(lastDate, cfg.step, cfg.unit);\n\t\t\tif (+outDate > +cfg.max_date && last > 0) {\n\t\t\t\tvar width = cfg.width[last] - Math.floor(cfg.width[last] * ((outDate - cfg.max_date) / (outDate - lastDate)));\n\t\t\t\tdiff += cfg.width[last] - width;\n\t\t\t\tcfg.width[last] = width;\n\t\t\t}\n\n\t\t\tif (diff) {\n\t\t\t\tvar full = this.getSum(cfg.width);\n\t\t\t\tvar shared = 0;\n\t\t\t\tfor (var i = 0; i < cfg.width.length; i++) {\n\t\t\t\t\tvar share = Math.floor(diff * (cfg.width[i] / full));\n\t\t\t\t\tcfg.width[i] += share;\n\t\t\t\t\tshared += share;\n\t\t\t\t}\n\t\t\t\tthis.adjustSize(diff - shared, cfg.width);\n\t\t\t}\n\n\t\t}\n\t};\n}\n\nexport default ScaleHelper;\n","\nimport ScaleHelper from \"./scales\";\n\nfunction ScaleIgnoreHelper(gantt){\n\tvar helper = new ScaleHelper(gantt);\n\n\thelper.processIgnores = function (config) {\n\t\tvar display_count = config.count;\n\t\tconfig.ignore_x = {};\n\t\tif (gantt.ignore_time || gantt.config.skip_off_time) {\n\t\t\tvar ignore = gantt.ignore_time || function () {\n\t\t\t\treturn false;\n\t\t\t};\n\t\t\tdisplay_count = 0;\n\n\t\t\tfor (var i = 0; i < config.trace_x.length; i++) {\n\n\t\t\t\tif (ignore.call(gantt, config.trace_x[i]) || this._ignore_time_config.call(gantt, config.trace_x[i], config)) {\n\t\t\t\t\tconfig.ignore_x[config.trace_x[i].valueOf()] = true;\n\t\t\t\t\tconfig.ignored_colls = true;\n\t\t\t\t} else {\n\t\t\t\t\tdisplay_count++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t\tconfig.display_count = display_count;\n\t};\n\n\treturn helper;\n}\n\nexport default ScaleIgnoreHelper;","export default function(gantt) {\n\n\t(function () {\n\t\tvar modalsStack = [];\n\n\t\tfunction isModal() {\n\t\t\treturn !!modalsStack.length;\n\t\t}\n\n\t\tfunction afterPopup(box) {\n\t\t\tsetTimeout(function () {\n\t\t\t\tif (!isModal()){\n\t\t\t\t\tif(!gantt.$destroyed){\n\t\t\t\t\t\tgantt.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, 1);\n\t\t}\n\n\t\tfunction startModal(box) {\n\t\t\tgantt.eventRemove(box, \"keydown\", trapFocus);\n\t\t\tgantt.event(box, \"keydown\", trapFocus);\n\t\t\tmodalsStack.push(box);\n\t\t\t//gantt.$keyboardNavigation.dispatcher.disable();\n\t\t}\n\n\t\tfunction endModal() {\n\t\t\tvar box = modalsStack.pop();\n\t\t\tif (box) {\n\t\t\t\tgantt.eventRemove(box, \"keydown\", trapFocus);\n\t\t\t}\n\t\t\tafterPopup(box);\n\n\t\t}\n\n\n\t\tfunction isTopModal(box) {\n\t\t\treturn box == modalsStack[modalsStack.length - 1];\n\t\t}\n\n\t\tfunction trapFocus(event) {\n\t\t\tvar target = event.currentTarget;\n\t\t\tif (!isTopModal(target)) return;\n\n\t\t\tgantt.$keyboardNavigation.trapFocus(target, event);\n\t\t}\n\n\t\tfunction traceLightbox() {\n\t\t\tstartModal(gantt.getLightbox());\n\t\t}\n\n\t\tgantt.attachEvent(\"onLightbox\", traceLightbox);\n\t\tgantt.attachEvent(\"onAfterLightbox\", endModal);\n\t\tgantt.attachEvent(\"onLightboxChange\", function () {\n\t\t\tendModal();\n\t\t\ttraceLightbox();\n\t\t});\n\n\n\t\tgantt.attachEvent(\"onAfterQuickInfo\", function () {\n\t\t\tafterPopup();\n\t\t});\n\n\t\tgantt.attachEvent(\"onMessagePopup\", function (box) {\n\t\t\tsaveFocus();\n\t\t\tstartModal(box);\n\t\t});\n\t\tgantt.attachEvent(\"onAfterMessagePopup\", function () {\n\t\t\tendModal();\n\t\t\trestoreFocus();\n\t\t});\n\n\t\tvar focusElement = null;\n\n\t\tfunction saveFocus() {\n\t\t\tfocusElement = gantt.utils.dom.getActiveElement();\n\t\t}\n\n\t\tfunction restoreFocus() {\n\t\t\tsetTimeout(function () {\n\t\t\t\tif (focusElement && focusElement.focus) {\n\t\t\t\t\tfocusElement.focus();\n\t\t\t\t\tfocusElement = null;\n\t\t\t\t}\n\t\t\t}, 1);\n\t\t}\n\n\t\tgantt.$keyboardNavigation.isModal = isModal;\n\n\n\t})();\n\n};","\ninterface IQuickInfoContainer{\n\tparent: HTMLElement;\n\txViewport: HTMLElement;\n\tyViewport: HTMLElement;\n}\n\nexport class QuickInfo {\n\tprivate _quickInfoTask: TaskID;\n\tprivate _quickInfoBoxId: number | string;\n\tprivate _quickInfoBox: HTMLElement;\n\tprivate _quickInfoReadonly: boolean | null;\n\tprivate _container: HTMLElement;\n\tprivate _gantt: any;\n\n\tconstructor(gantt: any) {\n\t\tthis._gantt = gantt;\n\t}\n\n\t// show at coordinates:\n\t// show(x: number, y: number)\n\t// show for a task:\n\t// show(id: TaskID)\n\tshow : {\n\t\t(x: number, y: number) : void;\n\t\t(id: TaskID) : void;\n\t} = (id: TaskID | number, y? : number) : void => {\n\t\tif (y === undefined) {\n\t\t\tthis._showForTask(id);\n\t\t} else {\n\t\t\tthis._showAtCoordinates(id as number, y);\n\t\t}\n\t};\n\n\thide = (forced?: boolean) : any => {\n\t\tconst gantt = this._gantt;\n\t\tconst qi = this._quickInfoBox;\n\t\tthis._quickInfoBoxId = 0;\n\t\tconst taskId = this._quickInfoTask;\n\t\tthis._quickInfoTask = null;\n\n\t\tif (qi && qi.parentNode){\n\n\t\t\tif (gantt.config.quick_info_detached) {\n\t\t\t\tgantt.callEvent(\"onAfterQuickInfo\", [taskId]);\n\t\t\t\treturn qi.parentNode.removeChild(qi);\n\t\t\t}\n\n\t\t\tqi.className += \" gantt_qi_hidden\";\n\t\t\tif (qi.style.right === \"auto\"){\n\t\t\t\tqi.style.left = \"-350px\";\n\t\t\t} else {\n\t\t\t\tqi.style.right = \"-350px\";\n\t\t\t}\n\n\t\t\tif (forced) {\n\t\t\t\tqi.style.left = qi.style.right = \"\";\n\t\t\t\tqi.parentNode.removeChild(qi);\n\t\t\t}\n\t\t\tgantt.callEvent(\"onAfterQuickInfo\", [taskId]);\n\t\t}\n\t};\n\n\tgetNode = (): HTMLElement => {\n\t\tif(this._quickInfoBox) {\n\t\t\treturn this._quickInfoBox;\n\t\t}\n\t\treturn null;\n\t};\n\n\tsetContainer = (container: string|HTMLElement): void => {\n\t\tif(container){\n\t\t\tthis._container = typeof container === \"string\" ? document.getElementById(container) : container;\n\t\t}\n\t};\n\n\tsetContent = (content?: IQuickInfoContent) => {\n\t\tconst gantt = this._gantt;\n\n\t\tconst defaultContent = {\n\t\t\ttaskId: null,\n\t\t\theader: {\n\t\t\t\ttitle: \"\",\n\t\t\t\tdate: \"\"\n\t\t\t},\n\t\t\tcontent: \"\",\n\t\t\tbuttons: gantt.config.quickinfo_buttons\n\t\t};\n\n\t\tif(!content){\n\t\t\tcontent = defaultContent;\n\t\t}\n\n\t\tif(!content.taskId){\n\t\t\tcontent.taskId = defaultContent.taskId;\n\t\t}\n\n\t\tif(!content.header){\n\t\t\tcontent.header = defaultContent.header;\n\t\t}\n\n\t\tif(!content.header.title){\n\t\t\tcontent.header.title = defaultContent.header.title;\n\t\t}\n\t\tif(!content.header.date){\n\t\t\tcontent.header.date = defaultContent.header.date;\n\t\t}\n\t\tif(!content.content){\n\t\t\tcontent.content = defaultContent.content;\n\t\t}\n\t\tif(!content.buttons){\n\t\t\tcontent.buttons = defaultContent.buttons;\n\t\t}\n\n\n\t\tlet qi = this.getNode();\n\t\tif(!qi){\n\t\t\tqi = this._createQuickInfoElement();\n\t\t}\n\n\t\tif(content.taskId){\n\t\t\tthis._quickInfoBoxId = content.taskId;\n\t\t}\n\n\t\tconst titleBox = qi.querySelector(\".gantt_cal_qi_title\") as HTMLElement;\n\t\tconst titleContent = titleBox.querySelector(\".gantt_cal_qi_tcontent\");\n\t\tconst titleDate = titleBox.querySelector(\".gantt_cal_qi_tdate\");\n\t\tconst main = qi.querySelector(\".gantt_cal_qi_content\");\n\t\tconst controls = qi.querySelector(\".gantt_cal_qi_controls\") as HTMLElement;\n\n\t\tgantt._waiAria.quickInfoHeader(qi, [content.header.title, content.header.date].join(\" \"));\n\n\t\ttitleContent.innerHTML = content.header.title;\n\t\ttitleDate.innerHTML = content.header.date;\n\n\t\tif(!content.header.title && !content.header.date){\n\t\t\ttitleBox.style.display = \"none\";\n\t\t}else{\n\t\t\ttitleBox.style.display = \"\";\n\t\t}\n\t\tmain.innerHTML = content.content;\n\n\t\tconst buttons = content.buttons;\n\t\tif(!buttons.length){\n\t\t\tcontrols.style.display = \"none\";\n\t\t}else{\n\t\t\tcontrols.style.display = \"\";\n\t\t}\n\t\tlet html = \"\";\n\t\tfor (let i = 0; i < buttons.length; i++){\n\n\t\t\tconst ariaAttr = gantt._waiAria.quickInfoButtonAttrString(gantt.locale.labels[buttons[i]]);\n\n\t\t\thtml += `<div class=\"gantt_qi_big_icon ${buttons[i]} dhx_gantt_${buttons[i]}\" title=\"${gantt.locale.labels[buttons[i]]}\" ${ariaAttr}>\n            <div class='dhx_menu_icon dhx_gantt_icon ${buttons[i]} gantt_menu_icon dhx_gantt_${buttons[i]}'></div>\n            <div>${gantt.locale.labels[buttons[i]]}</div>\n         </div>`;\n\t\t}\n\t\tcontrols.innerHTML = html;\n\n\t\tgantt.eventRemove(qi, \"click\", this._qiButtonClickHandler);\n\t\tgantt.eventRemove(qi, \"keypress\", this._qiKeyPressHandler);\n\n\t\tgantt.event(qi, \"click\", this._qiButtonClickHandler);\n\t\tgantt.event(qi, \"keypress\", this._qiKeyPressHandler);\n\t};\n\n\tprivate _qiButtonClickHandler = (ev) => {\n\t\tthis._qi_button_click(ev.target);\n\t};\n\n\tprivate _qiKeyPressHandler = (e) => {\n\n\t\tconst code = e.which;\n\t\tif (code === 13 || code === 32){\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis._qi_button_click(e.target);\n\t\t\t},1);\n\t\t}\n\t};\n\n\tprivate _showAtCoordinates(x: number, y: number) : void {\n\t\tthis.hide(true);\n\t\tthis._quickInfoBoxId = 0;\n\t\tthis._quickInfoTask = null;\n\t\tif(!this._quickInfoBox){\n\t\t\tthis._createQuickInfoElement();\n\t\t\tthis.setContent();\n\t\t}\n\n\t\tthis._appendAtCoordinates(x, y);\n\t\tthis._gantt.callEvent(\"onQuickInfo\", [null]);\n\t}\n\n\tprivate _showForTask(id: TaskID) : void {\n\t\tconst gantt = this._gantt;\n\t\tif ((\n\t\t\tid === this._quickInfoBoxId &&\n\t\t\tgantt.utils.dom.isChildOf(this._quickInfoBox, document.body)\n\t\t) || !gantt.config.show_quick_info) {\n\t\t\t// not show if the quick info is already displayed for this task, or if it shouldn't be displayed\n\t\t\treturn;\n\t\t}\n\t\tthis.hide(true);\n\t\tconst offset = 6; // offset TASK <> QI-BOX in 'px'\n\t\tconst container = this._getContainer();\n\t\tconst pos = this._get_event_counter_part(id, offset, container.xViewport, container.yViewport);\n\n\t\tif (pos){\n\t\t\tthis._quickInfoBox = this._init_quick_info(id);\n\t\t\tthis._quickInfoTask = id;\n\t\t\tthis._quickInfoBox.className = this._prepare_quick_info_classname(id);\n\n\t\t\tthis._fill_quick_data(id);\n\t\t\tthis._show_quick_info(pos, offset);\n\t\t\tgantt.callEvent(\"onQuickInfo\", [id]);\n\t\t}\n\t}\n\n\tprivate _get_event_counter_part(id: TaskID, offset: number, xViewport: HTMLElement, yViewport: HTMLElement) : any {\n\t\tconst gantt = this._gantt;\n\t\tlet domEv = gantt.getTaskNode(id);\n\t\tif (!domEv) {\n\t\t\tdomEv = gantt.getTaskRowNode(id);\n\t\t\tif (!domEv) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t\tlet left = 0;\n\t\tconst top = offset + domEv.offsetTop + domEv.offsetHeight;\n\n\t\tlet node = domEv;\n\n\t\tif (gantt.utils.dom.isChildOf(node, xViewport)) {\n\t\t\twhile (node && node !== xViewport){\n\t\t\t\tleft += node.offsetLeft;\n\t\t\t\tnode = node.offsetParent;\n\t\t\t}\n\t\t}\n\n\t\tconst scroll = gantt.getScrollState();\n\n\t\tif(node){\n\t\t\tconst dx = (left + domEv.offsetWidth/2) - scroll.x > (xViewport.offsetWidth/2) ? 1 : 0;\n\t\t\tconst dy = (top + domEv.offsetHeight/2) - scroll.y > (yViewport.offsetHeight/2) ? 1 : 0;\n\n\t\t\treturn { left, top, dx, dy, width:domEv.offsetWidth, height:domEv.offsetHeight };\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate _createQuickInfoElement() : HTMLElement {\n\t\tconst gantt = this._gantt;\n\t\tconst qi = document.createElement(\"div\");\n\t\tqi.className += \"gantt_cal_quick_info\";\n\t\tgantt._waiAria.quickInfoAttr(qi);\n\n\t\t// title\n\t\tconst ariaAttr = gantt._waiAria.quickInfoHeaderAttrString();\n\t\tvar html = `\n\t\t<div class=\"gantt_cal_qi_tcontrols\">\n\t\t\t<a class=\"gantt_cal_qi_close_btn dhx_gantt_icon dhx_gantt_icon_close\"></a>\n\t\t</div>\n\t\t<div class=\"gantt_cal_qi_title\" ${ariaAttr}>\n\t\t\t\t\n\t\t\t\t<div class=\"gantt_cal_qi_tcontent\"></div>\n\t\t\t\t<div class=\"gantt_cal_qi_tdate\"></div>\n\t\t\t</div>\n\t\t\t<div class=\"gantt_cal_qi_content\"></div>`;\n\n\t\t//buttons\n\t\thtml += \"<div class=\\\"gantt_cal_qi_controls\\\">\";\n\n\t\thtml += \"</div>\";\n\n\t\tqi.innerHTML = html;\n\n\n\t\tif (gantt.config.quick_info_detached) {\n\t\t\tconst container = this._getContainer();\n\t\t\tgantt.event(container.parent, \"scroll\", () => { this.hide(); });\n\t\t}\n\n\t\tthis._quickInfoBox = qi;\n\t\treturn qi;\n\t}\n\n\tprivate _init_quick_info(id: TaskID) : HTMLElement {\n\t\tconst gantt = this._gantt;\n\t\tconst task = gantt.getTask(id);\n\t\t\n\n\t\tif(typeof this._quickInfoReadonly === \"boolean\"){\n\t\t\tif(gantt.isReadonly(task) !== this._quickInfoReadonly){\n\t\t\t\tthis.hide(true);\n\t\t\t\tthis._quickInfoBox = null;\n\t\t\t}\n\t\t}\n\n\t\tthis._quickInfoReadonly = gantt.isReadonly(task);\n\n\t\tif (!this._quickInfoBox){\n\t\t\tthis._quickInfoBox = this._createQuickInfoElement();\n\t\t}\n\n\t\treturn this._quickInfoBox;\n\t}\n\n\tprivate _prepare_quick_info_classname(id: TaskID) : string {\n\t\tconst gantt = this._gantt;\n\t\tconst task = gantt.getTask(id);\n\t\tconst taskType = gantt.getTaskType(task);\n\n\t\tlet css = `gantt_cal_quick_info gantt_${taskType}`;\n\t\tconst template = gantt.templates.quick_info_class(task.start_date, task.end_date, task);\n\n\t\tif(template){\n\t\t\tcss += \" \" + template;\n\t\t}\n\t\treturn css;\n\t}\n\n\tprivate _fill_quick_data(id: TaskID) : void {\n\t\tconst gantt = this._gantt;\n\t\tconst ev = gantt.getTask(id);\n\n\t\tthis._quickInfoBoxId = id;\n\n\t\tlet allowedButtons = [];\n\t\tif (this._quickInfoReadonly){\n\t\t\tconst buttons = gantt.config.quickinfo_buttons;\n\t\t\tconst isEditor = {icon_delete: true, icon_edit: true};\n\t\t\tfor (let i = 0; i < buttons.length; i++){\n\t\t\t\tif(this._quickInfoReadonly && isEditor[buttons[i]]){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tallowedButtons.push(buttons[i]);\n\t\t\t}\n\t\t} else {\n\t\t\tallowedButtons = gantt.config.quickinfo_buttons;\n\t\t}\n\n\t\tthis.setContent({\n\t\t\theader: {\n\t\t\t\ttitle: gantt.templates.quick_info_title(ev.start_date, ev.end_date, ev),\n\t\t\t\tdate: gantt.templates.quick_info_date(ev.start_date, ev.end_date, ev)\n\t\t\t},\n\t\t\tcontent: gantt.templates.quick_info_content(ev.start_date, ev.end_date, ev),\n\t\t\tbuttons: allowedButtons\n\t\t});\n\t}\n\n\tprivate _appendAtCoordinates(x: number, y: number): void {\n\t\tconst qi = this._quickInfoBox;\n\t\tconst container = this._getContainer();\n\t\tif (!qi.parentNode ||\n\t\t\tqi.parentNode.nodeName.toLowerCase() === \"#document-fragment\"){ // IE8\n\t\t\tcontainer.parent.appendChild(qi);\n\t\t}\n\n\t\tqi.style.left = x + \"px\";\n\t\tqi.style.top = y + \"px\";\n\t}\n\n\tprivate _show_quick_info(pos: any, offset: number) : void {\n\t\tconst gantt = this._gantt;\n\t\tconst qi = this._quickInfoBox;\n\t\tif (gantt.config.quick_info_detached) {\n\t\t\tconst container = this._getContainer();\n\t\t\tif (!qi.parentNode ||\n\t\t\t\tqi.parentNode.nodeName.toLowerCase() === \"#document-fragment\"){ // IE8\n\t\t\t\tcontainer.parent.appendChild(qi);\n\t\t\t}\n\t\t\tconst width = qi.offsetWidth;\n\t\t\tconst popupHeight = qi.offsetHeight;\n\n\t\t\tconst scrolls = gantt.getScrollState();\n\t\t\tconst xViewport = container.xViewport;\n\t\t\tconst yViewport = container.yViewport;\n\t\t\tconst screenWidth = xViewport.offsetWidth + scrolls.x - width;\n\n\t\t\tconst relativePopupTop = pos.top - scrolls.y;\n\t\t\tconst relativePopupBottom = relativePopupTop + popupHeight;\n\n\t\t\tlet top = pos.top;\n\t\t\tif(relativePopupBottom > yViewport.offsetHeight / 2){\n\t\t\t\ttop = pos.top - (popupHeight + pos.height + 2*offset);\n\t\t\t\tif(top < scrolls.y && relativePopupBottom <= yViewport.offsetHeight){\n\t\t\t\t\ttop = pos.top;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (top < scrolls.y) {\n\t\t\t\ttop = scrolls.y;\n\t\t\t}\n\n\t\t\tconst x = Math.min(Math.max(scrolls.x, pos.left - pos.dx*(width - pos.width)), screenWidth);\n\t\t\tconst y = top;\n\n\t\t\tthis._appendAtCoordinates(x, y);\n\t\t} else {\n\t\t\tqi.style.top = 20 + \"px\";\n\t\t\tif (pos.dx === 1){\n\t\t\t\tqi.style.right = \"auto\";\n\t\t\t\tqi.style.left = \"-300px\";\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tqi.style.left = \"10px\";\n\t\t\t\t},1);\n\t\t\t} else {\n\t\t\t\tqi.style.left = \"auto\";\n\t\t\t\tqi.style.right = \"-300px\";\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tqi.style.right = \"10px\";\n\t\t\t\t},1);\n\t\t\t}\n\t\t\tqi.className += \" gantt_qi_\"+(pos.dx === 1 ? \"left\" : \"right\");\n\t\t\tgantt.$root.appendChild(qi);\n\t\t}\n\t}\n\n\tprivate _qi_button_click(node: any) : void {\n\t\tconst gantt = this._gantt;\n\t\tconst box = this._quickInfoBox;\n\t\tif (!node || node === box){\n\t\t\treturn;\n\t\t}\n\t\tif(node.closest(\".gantt_cal_qi_close_btn\")){\n\t\t\tthis.hide();\n\t\t\treturn;\n\t\t}\n\n\t\tconst mask = node.className;\n\t\tif (mask.indexOf(\"_icon\") !== -1){\n\t\t\tconst id = this._quickInfoBoxId;\n\t\t\tgantt.$click.buttons[mask.split(\" \")[1].replace(\"icon_\",\"\")](id);\n\t\t} else {\n\t\t\tthis._qi_button_click(node.parentNode);\n\t\t}\n\t}\n\n\tprivate _getContainer(): IQuickInfoContainer{\n\t\tconst gantt = this._gantt;\n\t\tlet container = this._container ? this._container : gantt.$task_data;\n\t\tif (container && container.offsetHeight && container.offsetWidth) {\n\t\t\treturn {\n\t\t\t\tparent: container,\n\t\t\t\txViewport: gantt.$task,\n\t\t\t\tyViewport: gantt.$task_data\n\t\t\t};\n\t\t}\n\t\tcontainer = this._container ? this._container : gantt.$grid_data;\n\t\tif (container && container.offsetHeight && container.offsetWidth) {\n\t\t\treturn {\n\t\t\t\tparent: container,\n\t\t\t\txViewport: gantt.$grid,\n\t\t\t\tyViewport: gantt.$grid_data\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\tparent: this._container ? this._container : gantt.$layout,\n\t\t\txViewport: gantt.$layout,\n\t\t\tyViewport: gantt.$layout\n\t\t};\n\t}\n}\n","import * as utils from \"../../../utils/utils\";\n\nfunction createScope(addEvent, removeEvent) {\n\taddEvent = addEvent || utils.event;\n\tremoveEvent = removeEvent || utils.eventRemove;\n\n\tvar handlers = [];\n\n\tvar eventScope = {\n\t\tattach: function(el, event, callback, capture){\n\t\t\thandlers.push({element: el, event:event, callback: callback, capture: capture});\n\t\t\taddEvent(el, event, callback, capture);\n\t\t},\n\t\tdetach: function(el, event, callback, capture){\n\t\t\tremoveEvent(el, event, callback, capture);\n\t\t\tfor(var i = 0; i < handlers.length; i++){\n\t\t\t\tvar handler = handlers[i];\n\t\t\t\tif (handler.element === el && handler.event === event && handler.callback === callback && handler.capture === capture) {\n\t\t\t\t\thandlers.splice(i, 1);\n\t\t\t\t\ti--;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tdetachAll: function () {\n\t\t\tvar staticArray = handlers.slice();\n\t\t\t// original handlers array can be spliced on every iteration\n\t\t\tfor (var i = 0; i < staticArray.length; i++){\n\t\t\t\tvar handler = staticArray[i];\n\t\t\t\teventScope.detach(handler.element, handler.event, handler.callback, handler.capture);\n\t\t\t\teventScope.detach(handler.element, handler.event, handler.callback, undefined);\n\t\t\t\teventScope.detach(handler.element, handler.event, handler.callback, false);\n\t\t\t\teventScope.detach(handler.element, handler.event, handler.callback, true);\n\t\t\t}\n\t\t\thandlers.splice(0, handlers.length);\n\t\t},\n\t\textend: function(){\n\t\t\treturn createScope(this.event, this.eventRemove);\n\t\t}\n\t};\n\n\treturn eventScope;\n}\n\nexport default createScope;","import * as domHelpers from \"../../core/ui/utils/dom_helpers\";\n\n/* eslint-disable no-restricted-globals */\n\ninterface IViewPosition{\n\ttop: number;\n\tleft: number;\n}\n\ninterface IViewBox extends IViewPosition{\n\twidth: number;\n\theight: number;\n\tbottom: number;\n\tright: number;\n}\n\nexport class Tooltip {\n\tprivate _root: HTMLElement;\n\tprivate _tooltipNode: HTMLElement;\n\tprivate _gantt: any;\n\n\tconstructor(gantt: any){\n\t\tthis._gantt = gantt;\n\t}\n\n\tgetNode() : HTMLElement {\n\t\tconst gantt = this._gantt;\n\t\tif (!this._tooltipNode){\n\t\t\tthis._tooltipNode = document.createElement(\"div\");\n\t\t\tthis._tooltipNode.className = \"gantt_tooltip\";\n\t\t\tgantt._waiAria.tooltipAttr(this._tooltipNode);\n\t\t}\n\t\treturn this._tooltipNode;\n\t}\n\n\tsetViewport(node: HTMLElement):Tooltip{\n\t\tthis._root = node;\n\t\treturn this;\n\t}\n\n\tshow(left: number, top: number): Tooltip;\n\tshow(event: MouseEvent): Tooltip;\n\tshow(left: number | MouseEvent, top?: number): Tooltip {\n\t\tconst gantt = this._gantt;\n\t\tconst container = document.body;\n\t\tconst node = this.getNode();\n\n\t\tif(!domHelpers.isChildOf(node, container)){\n\t\t\tthis.hide();\n\t\t\t// GS-2463. Don't put the node beyond the body coordinates\n\t\t\t// as it may trigger the resize event\n\t\t\tnode.style.top = node.style.top || \"0px\";\n\t\t\tnode.style.left = node.style.left || \"0px\";\n\t\t\tcontainer.appendChild(node);\n\t\t}\n\n\t\tif (this._isLikeMouseEvent(left)) {\n\t\t\tconst position = this._calculateTooltipPosition(left as MouseEvent);\n\t\t\ttop = position.top;\n\t\t\tleft = position.left;\n\t\t}\n\n\t\tnode.style.top = top + \"px\";\n\t\tnode.style.left = left + \"px\";\n\n\t\tgantt._waiAria.tooltipVisibleAttr(node);\n\t\treturn this;\n\t}\n\thide() : Tooltip{\n\t\tconst gantt = this._gantt;\n\t\tconst node = this.getNode();\n\t\tif(node && node.parentNode){\n\t\t\tnode.parentNode.removeChild(node);\n\t\t}\n\t\tgantt._waiAria.tooltipHiddenAttr(node);\n\t\treturn this;\n\t}\n\n\tsetContent(html: string) : Tooltip{\n\t\tconst node = this.getNode();\n\t\tnode.innerHTML = html;\n\t\treturn this;\n\t}\n\n\t// it is for salesforce, because it proxies event to it own events\n\tprivate _isLikeMouseEvent(event: any): boolean {\n\t\tif (!event || typeof event !== \"object\") {\n\t\t\treturn false;\n\t\t}\n\t\treturn \"clientX\" in event && \"clientY\" in event;\n\t}\n\n\tprivate _getViewPort() : HTMLElement {\n\t\treturn this._root || document.body;\n\t}\n\n\n\tprivate _calculateTooltipPosition(event: MouseEvent): IViewPosition{\n\t\tconst gantt = this._gantt;\n\t\t// top/left coordinates inside the viewport by mouse position\n\t\tconst viewport =  this._getViewPortSize();\n\t\tconst tooltipNode = this.getNode();\n\t\tconst tooltip: IViewBox = {\n\t\t\ttop:0,\n\t\t\tleft: 0,\n\t\t\twidth: tooltipNode.offsetWidth,\n\t\t\theight: tooltipNode.offsetHeight,\n\t\t\tbottom: 0,\n\t\t\tright: 0\n\t\t};\n\n\t\tconst offsetX = gantt.config.tooltip_offset_x;\n\t\tconst offsetY = gantt.config.tooltip_offset_y;\n\n\t\tconst container = document.body;\n\t\tconst mouse = domHelpers.getRelativeEventPosition(event, container);\n\t\tconst containerPos = domHelpers.getNodePosition(container);\n\t\tmouse.y += containerPos.y; // to fix margin collapsing\n\n\t\ttooltip.top = mouse.y;\n\t\ttooltip.left = mouse.x;\n\t\ttooltip.top += offsetY;\n\t\ttooltip.left += offsetX;\n\t\ttooltip.bottom = tooltip.top + tooltip.height;\n\t\ttooltip.right = tooltip.left + tooltip.width;\n\n\t\tconst scrollTop = window.scrollY + container.scrollTop; // to fix margin collapsing\n\t\t// edge cases when the tooltip element can be partially hidden by edges of the viewport\n\t\tif(tooltip.top < viewport.top - scrollTop){\n\t\t\ttooltip.top = viewport.top;\n\t\t\ttooltip.bottom = tooltip.top + tooltip.height;\n\t\t}else if(tooltip.bottom > viewport.bottom){\n\t\t\ttooltip.bottom = viewport.bottom;\n\t\t\ttooltip.top = tooltip.bottom - tooltip.height;\n\t\t}\n\n\t\tif(tooltip.left < viewport.left){\n\t\t\ttooltip.left = viewport.left;\n\t\t\ttooltip.right = viewport.left + tooltip.width;\n\t\t}else if(tooltip.right > viewport.right){\n\t\t\ttooltip.right = viewport.right;\n\t\t\ttooltip.left = tooltip.right - tooltip.width;\n\t\t}\n\n\t\tif(mouse.x >= tooltip.left && mouse.x <= tooltip.right) {\n\t\t\ttooltip.left = mouse.x - tooltip.width - offsetX;\n\t\t\ttooltip.right = tooltip.left + tooltip.width;\n\t\t}\n\n\t\tif(mouse.y >= tooltip.top && mouse.y <= tooltip.bottom) {\n\t\t\ttooltip.top = mouse.y - tooltip.height - offsetY;\n\t\t\ttooltip.bottom = tooltip.top + tooltip.height;\n\t\t}\n\n\t\t// GS-2827: when tooltip width too long\n\t\tif(tooltip.left < 0){\n\t\t\ttooltip.left = 0;\n\t\t}\n\t\tif(tooltip.right < 0){\n\t\t\ttooltip.right = 0;\n\t\t}\n\n\t\treturn tooltip;\n\t}\n\n\tprivate _getViewPortSize() : IViewBox {\n\t\tconst gantt = this._gantt;\n\t\tconst container = this._getViewPort();\n\t\tlet viewport = container;\n\t\tlet scrollTop = window.scrollY + document.body.scrollTop;\n\t\tlet scrollLeft = window.scrollX + document.body.scrollLeft;\n\t\tlet pos;\n\t\t// support for the initial tooltip mode where the tooltip element was attached to the data area of gantt\n\t\tif(container === gantt.$task_data){\n\t\t\tviewport = gantt.$task;\n\t\t\tscrollTop = 0;\n\t\t\tscrollLeft = 0;\n\t\t\tpos = domHelpers.getNodePosition(gantt.$task);\n\t\t}else{\n\t\t\tpos = domHelpers.getNodePosition(viewport);\n\t\t}\n\t\treturn {\n\t\t\tleft:pos.x + scrollLeft,\n\t\t\ttop: pos.y + scrollTop,\n\t\t\twidth: pos.width,\n\t\t\theight: pos.height,\n\t\t\tbottom: pos.y + pos.height + scrollTop,\n\t\t\tright: pos.x + pos.width + scrollLeft\n\t\t};\n\t}\n}\n","import domEventsScope from \"../../core/ui/utils/dom_event_scope\";\nimport * as domHelpers from \"../../core/ui/utils/dom_helpers\";\nimport * as helpers from \"../../utils/helpers\";\nimport { Tooltip } from \"./tooltip\";\n\ninterface ITrackerTarget {\n\tselector: string;\n\tonmouseenter: (event: MouseEvent, node: HTMLElement) => void;\n\tonmousemove: (event: MouseEvent, node: HTMLElement) => void;\n\tonmouseleave: (event: MouseEvent, node: HTMLElement) => void;\n\tglobal: boolean;\n}\n\ninterface ITooltipConfig {\n\tselector: string;\n\thtml: (event: MouseEvent, node: HTMLElement) => string;\n\tglobal: boolean;\n}\n\nexport class TooltipManager{\n\ttooltip: Tooltip;\n\tprotected _domEvents: any;\n\tprivate _listeners: object = {};\n\tprivate _gantt: any;\n\tprivate delayShow: any;\n\tprivate delayHide: any;\n\n\tconstructor(gantt: any) {\n\t\tthis.tooltip = new Tooltip(gantt);\n\t\tthis._gantt = gantt;\n\t\tthis._domEvents = domEventsScope();\n\t\tthis._initDelayedFunctions();\n\t}\n\n\tdestructor(): void{\n\t\tthis.tooltip.hide();\n\t\tthis._domEvents.detachAll();\n\t}\n\thideTooltip(): void{\n\t\tthis.delayHide();\n\t}\n\tattach(config: ITrackerTarget): void {\n\t\tlet root = document.body;\n\t\tconst gantt = this._gantt;\n\t\tif(!config.global){\n\t\t\troot = gantt.$root;\n\t\t}\n\n\t\tlet watchableTarget = null;\n\t\tconst handler = (event) => {\n\t\t\tconst eventTarget = domHelpers.getTargetNode(event);\n\t\t\tconst targetNode = domHelpers.closest(eventTarget, config.selector);\n\t\t\tif(domHelpers.isChildOf(eventTarget, this.tooltip.getNode())){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst doOnMouseEnter = () => {\n\t\t\t\twatchableTarget = targetNode;\n\t\t\t\tconfig.onmouseenter(event, targetNode);\n\t\t\t};\n\n\t\t\tif(watchableTarget){\n\t\t\t\tif(targetNode && targetNode === watchableTarget){\n\t\t\t\t\tconfig.onmousemove(event, targetNode);\n\t\t\t\t}else{\n\t\t\t\t\tconfig.onmouseleave(event, watchableTarget);\n\t\t\t\t\twatchableTarget = null;\n\n\t\t\t\t\tif(targetNode && targetNode !== watchableTarget){\n\t\t\t\t\t\tdoOnMouseEnter();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(targetNode){\n\t\t\t\t\tdoOnMouseEnter();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tthis.detach(config.selector);\n\t\tthis._domEvents.attach(root, \"mousemove\", handler);\n\t\tthis._listeners[config.selector] = {\n\t\t\tnode: root,\n\t\t\thandler\n\t\t};\n\t}\n\n\tdetach(selector: string): void {\n\t\tconst listener = this._listeners[selector];\n\t\tif(listener){\n\t\t\tthis._domEvents.detach(listener.node, \"mousemove\", listener.handler);\n\t\t}\n\t}\n\n\ttooltipFor(config: ITooltipConfig): void {\n\t\tconst cloneDomEvent = (event: MouseEvent) => {\n\t\t\tlet clone = event;\n\t\t\t// making events survive timeout in ie\n\t\t\t// tslint:disable-next-line no-string-literal\n\t\t\tif(document[\"createEventObject\"] && !document.createEvent){\n\t\t\t\t// tslint:disable-next-line no-string-literal\n\t\t\t\tclone = document[\"createEventObject\"](event);\n\t\t\t}\n\t\t\treturn clone;\n\t\t};\n\t\tthis._initDelayedFunctions();\n\t\tthis.attach({\n\t\t\tselector: config.selector,\n\t\t\tglobal: config.global,\n\t\t\tonmouseenter:(event: MouseEvent, node: HTMLElement) => {\n\t\t\t\tconst html = config.html(event, node);\n\t\t\t\tif(html){\n\t\t\t\t\tthis.delayShow(cloneDomEvent(event), html);\n\t\t\t\t}\n\t\t\t},\n\t\t\tonmousemove:(event: MouseEvent, node: HTMLElement) => {\n\t\t\t\tconst html = config.html(event, node);\n\t\t\t\tif(html){\n\t\t\t\t\tthis.delayShow(cloneDomEvent(event), html);\n\t\t\t\t}else{\n\t\t\t\t\tthis.delayShow.$cancelTimeout();\n\t\t\t\t\tthis.delayHide();\n\t\t\t\t}\n\t\t\t},\n\t\t\tonmouseleave:() => {\n\t\t\t\tthis.delayShow.$cancelTimeout();\n\t\t\t\tthis.delayHide();\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate _initDelayedFunctions(){\n\t\tconst gantt = this._gantt;\n\t\t// reset delayed functions in order to apply current values of tooltip_timeout\n\t\tif(this.delayShow){\n\t\t\tthis.delayShow.$cancelTimeout();\n\t\t}\n\t\tif(this.delayHide){\n\t\t\tthis.delayHide.$cancelTimeout();\n\t\t}\n\t\tthis.tooltip.hide();\n\n\t\tthis.delayShow = helpers.delay((event: MouseEvent, html: string) => {\n\t\t\tif(gantt.callEvent(\"onBeforeTooltip\", [event]) === false) {\n\t\t\t\tthis.tooltip.hide();\n\t\t\t} else {\n\t\t\t\tthis.tooltip.setContent(html);\n\t\t\t\tthis.tooltip.show(event);\n\t\t\t}\n\t\t}, gantt.config.tooltip_timeout || 1);\n\n\t\tthis.delayHide = helpers.delay(() => {\n\t\t\tthis.delayShow.$cancelTimeout();\n\t\t\tthis.tooltip.hide();\n\t\t}, gantt.config.tooltip_hide_timeout || 1);\n\t}\n\n}","import { IInlineEditState, IMonitor, IUndo, IUndoCommand, TActionType, TEntityType, TUndoValue } from \"./types\";\n\nconst noTrack = {\n\tonBeforeUndo: \"onAfterUndo\",\n\tonBeforeRedo: \"onAfterRedo\"\n};\n\nconst batchActions = [\n\t\"onTaskDragStart\",\n\t\"onAfterTaskUpdate\",\n\t\"onAfterParentExpand\",\n\t\"onAfterTaskDelete\",\n\t\"onBeforeBatchUpdate\"\n];\n\nexport class Monitor implements IMonitor {\n\tprivate _batchAction = null;\n\tprivate _batchMode = false;\n\tprivate _ignore = false;\n\tprivate _ignoreMoveEvents = false;\n\tprivate _initialTasks = {};\n\tprivate _initialLinks = {};\n\tprivate _nestedTasks =  {};\n\tprivate _nestedLinks = {};\n\tprivate _timeout;\n\tprivate _gantt: any;\n\tprivate _undo: IUndo;\n\n\tconstructor(undo: IUndo, gantt: any) {\n\t\tthis._undo = undo;\n\t\tthis._gantt = gantt;\n\t\tthis._attachEvents();\n\t}\n\n\tstore(id: TaskID | LinkID, type: TEntityType, overwrite: boolean = false) {\n\t\tif (type === this._gantt.config.undo_types.task) {\n\t\t\treturn this._storeTask(id, overwrite);\n\t\t}\n\t\tif (type === this._gantt.config.undo_types.link) {\n\t\t\treturn this._storeLink(id, overwrite);\n\t\t}\n\t\treturn false;\n\t}\n\tisMoveEventsIgnored() {\n\t\treturn this._ignoreMoveEvents;\n\t}\n\ttoggleIgnoreMoveEvents(newValue?: boolean) {\n\t\tthis._ignoreMoveEvents = newValue || false;\n\t}\n\tstartIgnore() {\n\t\tthis._ignore = true;\n\t}\n\tstopIgnore() {\n\t\tthis._ignore = false;\n\t}\n\tstartBatchAction() {\n\t\t// try catching updates made from event handlers using timeout\n\t\tif (!this._timeout){\n\t\t\tthis._timeout = setTimeout(() => {\n\t\t\t\tthis.stopBatchAction();\n\t\t\t\tthis._timeout = null;\n\t\t\t}, 10);\n\t\t}\n\n\n\t\tif (this._ignore || this._batchMode) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._batchMode = true;\n\t\tthis._batchAction = this._undo.action.create();\n\t}\n\tstopBatchAction() {\n\t\tif (this._ignore) {\n\t\t\treturn;\n\t\t}\n\t\tconst undo = this._undo;\n\t\tif (this._batchAction) {\n\t\t\tundo.logAction(this._batchAction);\n\t\t}\n\t\tthis._batchMode = false;\n\t\tthis._batchAction = null;\n\t}\n\tonTaskAdded(task: ITask) {\n\t\tif (!this._ignore) {\n\t\t\tthis._storeTaskCommand(task, this._undo.command.type.add);\n\t\t}\n\t}\n\tonTaskUpdated(task: ITask) {\n\t\tif (!this._ignore) {\n\t\t\tthis._storeTaskCommand(task, this._undo.command.type.update);\n\t\t}\n\t}\n\tonTaskMoved(task: ITask) {\n\t\tif (!this._ignore) {\n\t\t\t(task as any).$local_index = this._gantt.getTaskIndex(task.id);\n\t\t\tthis._storeEntityCommand(\n\t\t\t\ttask,\n\t\t\t\tthis.getInitialTask(task.id),\n\t\t\t\tthis._undo.command.type.move,\n\t\t\t\tthis._undo.command.entity.task\n\t\t\t);\n\t\t}\n\t}\n\tonTaskDeleted(task: ITask) {\n\t\tif (!this._ignore) {\n\t\t\tthis._storeTaskCommand(task, this._undo.command.type.remove);\n\t\t\tif (this._nestedTasks[task.id]) {\n\t\t\t\tconst children = this._nestedTasks[task.id];\n\t\t\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\t\t\tthis._storeTaskCommand(children[i], this._undo.command.type.remove);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this._nestedLinks[task.id]) {\n\t\t\t\tconst childrenLinks = this._nestedLinks[task.id];\n\t\t\t\tfor (let i = 0; i < childrenLinks.length; i++) {\n\t\t\t\t\tthis._storeLinkCommand(childrenLinks[i], this._undo.command.type.remove);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tonLinkAdded(link: ILink) {\n\t\tif (!this._ignore) {\n\t\t\tthis._storeLinkCommand(link, this._undo.command.type.add);\n\t\t}\n\t}\n\tonLinkUpdated(link: ILink) {\n\t\tif (!this._ignore) {\n\t\t\tthis._storeLinkCommand(link, this._undo.command.type.update);\n\t\t}\n\t}\n\tonLinkDeleted(link: ILink) {\n\t\tif (!this._ignore) {\n\t\t\tthis._storeLinkCommand(link, this._undo.command.type.remove);\n\t\t}\n\t}\n\tsetNestedTasks(id: TaskID, taskIds: TaskID[]) {\n\t\tconst gantt = this._gantt;\n\t\tlet task = null;\n\t\tconst tasks = [];\n\t\tlet\tlinkIds = this._getLinks(gantt.getTask(id));\n\n\t\tfor (let i = 0; i < taskIds.length; i++) {\n\t\t\ttask = this.setInitialTask(taskIds[i]);\n\t\t\tlinkIds = linkIds.concat(this._getLinks(task));\n\t\t\ttasks.push(task);\n\t\t}\n\n\t\tconst uniqueLinks = {};\n\t\tfor (let i = 0; i < linkIds.length; i++) {\n\t\t\tuniqueLinks[linkIds[i]] = true;\n\t\t}\n\t\tconst links = [];\n\t\tfor (const i in uniqueLinks) {\n\t\t\tlinks.push(this.setInitialLink(i));\n\t\t}\n\t\tthis._nestedTasks[id] = tasks;\n\t\tthis._nestedLinks[id] = links;\n\t}\n\tsetInitialTask(id: TaskID, overwrite?: boolean) {\n\t\tconst gantt = this._gantt;\n\t\tif (overwrite || (!this._initialTasks[id] || !this._batchMode)) {\n\t\t\tconst task = gantt.copy(gantt.getTask(id));\n\t\t\ttask.$index = gantt.getGlobalTaskIndex(id);\n\t\t\ttask.$local_index = gantt.getTaskIndex(id);\n\t\t\tthis.setInitialTaskObject(id, task);\n\t\t}\n\t\treturn this._initialTasks[id];\n\t}\n\tgetInitialTask(id: TaskID) {\n\t\treturn this._initialTasks[id];\n\t}\n\tclearInitialTasks() {\n\t\tthis._initialTasks = {};\n\t}\n\tsetInitialTaskObject(id: TaskID, object: ITask) {\n\t\tthis._initialTasks[id] = object;\n\t}\n\tsetInitialLink(id: LinkID, overwrite?: boolean) {\n\t\tif (!this._initialLinks[id] || !this._batchMode) {\n\t\t\tthis._initialLinks[id] = this._gantt.copy(this._gantt.getLink(id));\n\t\t}\n\t\treturn this._initialLinks[id];\n\t}\n\tgetInitialLink(id: LinkID) {\n\t\treturn this._initialLinks[id];\n\t}\n\tclearInitialLinks() {\n\t\tthis._initialLinks = {};\n\t}\n\tprivate _attachEvents() {\n\t\tlet deleteCacheCooldown = null;\n\t\tconst gantt = this._gantt;\n\n\t\tconst saveInitialAll = () => {\n\t\t\tif (!deleteCacheCooldown) {\n\t\t\t\tdeleteCacheCooldown = setTimeout(() => {\n\t\t\t\t\tdeleteCacheCooldown = null;\n\t\t\t\t});\n\n\t\t\t\tthis.clearInitialTasks();\n\t\t\t\tgantt.eachTask((task: ITask) => {\n\t\t\t\t\tthis.setInitialTask(task.id);\n\t\t\t\t});\n\n\t\t\t\tthis.clearInitialLinks();\n\t\t\t\tgantt.getLinks().forEach((link: ILink) => {\n\t\t\t\t\tthis.setInitialLink(link.id);\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t\tconst getMoveObjectByTaskId = (id: TaskID) => {\n\t\t\treturn gantt.copy(gantt.getTask(id));\n\t\t};\n\n\t\tfor (const i in noTrack) {\n\t\t\tgantt.attachEvent(i, () => {\n\t\t\t\tthis.startIgnore();\n\t\t\t\treturn true;\n\t\t\t});\n\t\t\tgantt.attachEvent(noTrack[i], () => {\n\t\t\t\tthis.stopIgnore();\n\t\t\t\treturn true;\n\t\t\t});\n\t\t}\n\n\t\tfor (let i  = 0; i < batchActions.length; i++) {\n\t\t\tgantt.attachEvent(batchActions[i], () => {\n\t\t\t\tthis.startBatchAction();\n\t\t\t\treturn true;\n\t\t\t});\n\t\t}\n\n\t\tgantt.attachEvent(\"onParse\", () => {\n\t\t\tthis._undo.clearUndoStack();\n\t\t\tthis._undo.clearRedoStack();\n\t\t\tsaveInitialAll();\n\t\t});\n\t\tgantt.attachEvent(\"onAfterTaskAdd\", (id: TaskID, task: ITask) => {\n\t\t\tthis.setInitialTask(id, true);\n\t\t\tthis.onTaskAdded(task);\n\t\t});\n\t\tgantt.attachEvent(\"onAfterTaskUpdate\", (id: TaskID, task: ITask) => {\n\t\t\tthis.onTaskUpdated(task);\n\t\t});\n\t\tgantt.attachEvent(\"onAfterParentExpand\", (id: TaskID, task: ITask) => {\n\t\t\tthis.onTaskUpdated(task);\n\t\t});\n\t\tgantt.attachEvent(\"onAfterTaskDelete\", (id: TaskID, task: ITask) => {\n\t\t\tthis.onTaskDeleted(task);\n\t\t});\n\t\tgantt.attachEvent(\"onAfterLinkAdd\", (id: LinkID, link: ILink) => {\n\t\t\tthis.setInitialLink(id, true);\n\t\t\tthis.onLinkAdded(link);\n\t\t});\n\t\tgantt.attachEvent(\"onAfterLinkUpdate\", (id: LinkID, link: ILink) => {\n\t\t\tthis.onLinkUpdated(link);\n\t\t});\n\t\tgantt.attachEvent(\"onAfterLinkDelete\", (id: LinkID, link: ILink) => {\n\t\t\tthis.onLinkDeleted(link);\n\t\t});\n\t\tgantt.attachEvent(\"onRowDragEnd\", (id: TaskID, target: TaskID) => {\n\t\t\tthis.onTaskMoved(getMoveObjectByTaskId(id));\n\t\t\tthis.toggleIgnoreMoveEvents();\n\t\t\treturn true;\n\t\t});\n\t\tgantt.attachEvent(\"onBeforeTaskDelete\", (id: TaskID) => {\n\t\t\tthis.store(id, gantt.config.undo_types.task);\n\t\t\tconst nested = [];\n\n\t\t\t// remember task indexes in case their being deleted in a loop, so they could be restored in the correct order\n\t\t\tsaveInitialAll();\n\n\t\t\tgantt.eachTask((task: ITask) => {\n\t\t\t\tnested.push(task.id);\n\t\t\t}, id);\n\t\t\tthis.setNestedTasks(id, nested);\n\t\t\treturn true;\n\t\t});\n\t\tconst datastore = gantt.getDatastore(\"task\");\n\n\t\tdatastore.attachEvent(\"onBeforeItemMove\", (id: TaskID, parent: TaskID, tindex: number) => {\n\t\t\tif (!this.isMoveEventsIgnored()) {\n\t\t\t\tsaveInitialAll();\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tdatastore.attachEvent(\"onAfterItemMove\", (id: TaskID, parent: TaskID, tindex: number) => {\n\t\t\tif (!this.isMoveEventsIgnored()) {\n\t\t\t\tthis.onTaskMoved(getMoveObjectByTaskId(id));\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tgantt.attachEvent(\"onRowDragStart\", (id: TaskID, target: TaskID, e: Event) => {\n\t\t\tthis.toggleIgnoreMoveEvents(true);\n\t\t\tsaveInitialAll();\n\t\t\treturn true;\n\t\t});\n\n\t\tlet dragId = null;\n\t\tlet projectDrag = false;\n\t\tgantt.attachEvent(\"onBeforeTaskDrag\", (taskId: TaskID) => {\n\t\t\tdragId = gantt.getState().drag_id;\n\t\t\tif (dragId === taskId){\n\t\t\t\tconst task = gantt.getTask(taskId);\n\t\t\t\tif (gantt.isSummaryTask(task) && gantt.config.drag_project){\n\t\t\t\t\tprojectDrag = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// GS-99. Store the initial task dates before multiple drag\n\t\t\tif (gantt.plugins().multiselect){\n\t\t\t\tconst selectedIds = gantt.getSelectedTasks();\n\t\t\t\tif (selectedIds.length > 1){\n\t\t\t\t\tselectedIds.forEach((id)=>{\n\t\t\t\t\t\tthis.store(id, gantt.config.undo_types.task, true);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this.store(taskId, gantt.config.undo_types.task);\n\t\t});\n\n\t\tgantt.attachEvent(\"onAfterTaskDrag\", (taskId: TaskID) => {\n\t\t\t// if we drag multiple tasks and other tasks move to another date after that,\n\t\t\t// auto-scheduling/correct work time should occur in anoher command.\n\t\t\t// otherwise, when we undo the changes, the task constraint is not restored correctly\n\t\t\tconst multipleDrag = projectDrag || (gantt.plugins().multiselect && gantt.getSelectedTasks().length > 1);\n\t\t\tif (multipleDrag && dragId === taskId){\n\t\t\t\tprojectDrag = false;\n\t\t\t\tdragId = null;\n\t\t\t\tthis.stopBatchAction();\n\t\t\t}\n\t\t\t// GS-99. When dragging multiple tasks, we need to store the initial tasks\n\t\t\tthis.store(taskId, gantt.config.undo_types.task, true);\n\t\t});\n\n\t\tgantt.attachEvent(\"onLightbox\", (taskId: TaskID) => this.store(taskId, gantt.config.undo_types.task));\n\n\t\tgantt.attachEvent(\"onBeforeTaskAutoSchedule\", (task: ITask) => {\n\t\t\tthis.store(task.id, gantt.config.undo_types.task, true);\n\t\t\treturn true;\n\t\t});\n\n\t\tif (gantt.ext.inlineEditors) {\n\t\t\t// remove the onGanttLayoutReady wrapper when GS-1288 is merged\n\t\t\tlet onBeforeEditStartId = null;\n\t\t\tlet onEditStart = null;\n\t\t\tgantt.attachEvent(\"onGanttLayoutReady\", () => {\n\t\t\t\tif (onBeforeEditStartId) {\n\t\t\t\t\tgantt.ext.inlineEditors.detachEvent(onBeforeEditStartId);\n\t\t\t\t}\n\t\t\t\tif (onEditStart) {\n\t\t\t\t\tgantt.ext.inlineEditors.detachEvent(onEditStart);\n\t\t\t\t}\n\n\t\t\t\tonEditStart = gantt.ext.inlineEditors.attachEvent(\"onEditStart\", (state: IInlineEditState) => {\n\t\t\t\t\t// GS-2598: skip saving changes of resource lightbox grid\n\t\t\t\t\tif(gantt.$data.tempAssignmentsStore && gantt._lightbox_id){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis.store(state.id, gantt.config.undo_types.task);\n\t\t\t\t});\n\n\t\t\t\t// GS-99. If another inline editor is opened and we open a new inline editor,\n\t\t\t\t// we shouldn't use the batchAction\n\t\t\t\tonBeforeEditStartId = gantt.ext.inlineEditors.attachEvent(\"onBeforeEditStart\", (state: IInlineEditState) => {\n\t\t\t\t\tthis.stopBatchAction();\n\t\t\t\t\treturn true;\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate _storeCommand(command: IUndoCommand) {\n\t\tconst undo = this._undo;\n\t\tundo.updateConfigs();\n\n\t\tif (!undo.undoEnabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._batchMode) {\n\t\t\tthis._batchAction.commands.push(command);\n\t\t} else {\n\t\t\tconst action = undo.action.create([command]);\n\t\t\tundo.logAction(action);\n\t\t}\n\t}\n\tprivate _storeEntityCommand(obj: TUndoValue, old: TUndoValue, actionType: TActionType, entityType: TEntityType) {\n\t\tconst undo = this._undo;\n\t\tconst command = undo.command.create(obj, old, actionType, entityType);\n\t\tthis._storeCommand(command);\n\t}\n\tprivate _storeTaskCommand(obj: ITask, type: TActionType) {\n\t\tif(this._gantt.isTaskExists(obj.id)){\n\t\t\t(obj as any).$local_index = this._gantt.getTaskIndex(obj.id);\n\t\t}\n\n\t\tthis._storeEntityCommand(obj, this.getInitialTask(obj.id), type, this._undo.command.entity.task);\n\t}\n\tprivate _storeLinkCommand(obj: ILink, type: TActionType) {\n\t\tthis._storeEntityCommand(obj, this.getInitialLink(obj.id), type, this._undo.command.entity.link);\n\t}\n\tprivate _getLinks(task: ITask) {\n\t\treturn task.$source.concat(task.$target);\n\t}\n\tprivate _storeTask(taskId: TaskID, overwrite: boolean = false) {\n\t\tconst gantt = this._gantt;\n\t\tthis.setInitialTask(taskId, overwrite);\n\t\tgantt.eachTask((child: ITask) => {\n\t\t\tthis.setInitialTask(child.id);\n\t\t}, taskId);\n\t\treturn true;\n\t}\n\tprivate _storeLink(linkId: LinkID, overwrite: boolean = false) {\n\t\tthis.setInitialLink(linkId, overwrite);\n\t\treturn true;\n\t}\n}","import { IUndo, IUndoCommand, IUndoCommands, IUndoPropAction, IUndoPropCommand, TActionType, TEntityType, TUndoStack, TUndoValue } from \"./types\";\n\nconst MAX_UNDO_STEPS = 100;\n\nexport class Undo implements IUndo {\n\n\tmaxSteps = MAX_UNDO_STEPS;\n\tundoEnabled = true;\n\tredoEnabled = true;\n\taction: IUndoPropAction = {\n\t\tcreate: (commands?: IUndoCommand[]): IUndoCommands => {\n\t\t\treturn { commands: (commands ? commands.slice() : []) };\n\t\t},\n\t\tinvert: (action: IUndoCommands): IUndoCommands => {\n\t\t\tconst gantt = this._gantt;\n\t\t\tconst revert = gantt.copy(action);\n\t\t\tconst commands = this.command;\n\t\t\tfor (let i = 0; i < action.commands.length; i++) {\n\t\t\t\tconst command = revert.commands[i] = commands.invert(revert.commands[i]);\n\t\t\t\tif (command.type === commands.type.update || command.type === commands.type.move) {\n\t\t\t\t\t[command.value, command.oldValue] = [command.oldValue, command.value];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn revert as IUndoCommands;\n\t\t}\n\t};\n\tcommand: IUndoPropCommand = {\n\t\t// entities that require different processing for undoing-redoing changes (gantt.config.undo_types)\n\t\tentity: null,\n\n\t\t// types of traced actions (gantt.config.undo_actions)\n\t\ttype: null,\n\n\t\tcreate: (value: TUndoValue, oldValue: TUndoValue, type: TActionType, entity: TEntityType): IUndoCommand => {\n\t\t\tconst gantt = this._gantt;\n\t\t\treturn {\n\t\t\t\tentity,\n\t\t\t\ttype,\n\t\t\t\tvalue: gantt.copy(value),\n\t\t\t\toldValue: gantt.copy(oldValue || value)\n\t\t\t};\n\t\t},\n\t\tinvert: (command: IUndoCommand): IUndoCommand => {\n\t\t\tconst gantt = this._gantt;\n\t\t\tconst revert = gantt.copy(command);\n\t\t\trevert.type = this.command.inverseCommands(command.type);\n\t\t\treturn revert;\n\t\t},\n\t\tinverseCommands: (command: TActionType): TActionType => {\n\t\t\tconst gantt = this._gantt;\n\t\t\tconst types = this.command.type;\n\t\t\tswitch (command) {\n\t\t\t\tcase types.update:\n\t\t\t\t\treturn types.update;\n\t\t\t\tcase types.remove:\n\t\t\t\t\treturn types.add;\n\t\t\t\tcase types.add:\n\t\t\t\t\treturn types.remove;\n\t\t\t\tcase types.move:\n\t\t\t\t\treturn types.move;\n\t\t\t\tdefault:\n\t\t\t\t\tgantt.assert(false, \"Invalid command \"+ command);\n\t\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t};\n\n\tprivate _undoStack = [];\n\tprivate _redoStack = [];\n\tprivate _gantt: any;\n\n\tconstructor(gantt: any){\n\t\tthis._gantt = gantt;\n\t}\n\tgetUndoStack() {\n\t\treturn this._undoStack;\n\t}\n\tsetUndoStack(stack: []) {\n\t\tthis._undoStack = stack;\n\t}\n\n\tgetRedoStack() {\n\t\treturn this._redoStack;\n\t}\n\tsetRedoStack(stack: []) {\n\t\tthis._redoStack = stack;\n\t}\n\n\tclearUndoStack() {\n\t\tthis._undoStack = [];\n\t}\n\n\tclearRedoStack() {\n\t\tthis._redoStack = [];\n\t}\n\n\tupdateConfigs() {\n\t\tconst gantt = this._gantt;\n\t\tthis.maxSteps = gantt.config.undo_steps || MAX_UNDO_STEPS;\n\t\tthis.command.entity = gantt.config.undo_types;\n\t\tthis.command.type = gantt.config.undo_actions;\n\t\tthis.undoEnabled = !!gantt.config.undo;\n\t\tthis.redoEnabled = !!gantt.config.redo; // GS-873, Redo should work even when the `gantt.config.undo` is disabled.\n\t}\n\n\tundo() {\n\t\tconst gantt = this._gantt;\n\t\tthis.updateConfigs();\n\t\tif (!this.undoEnabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst action = this._pop(this._undoStack);\n\t\tif (action) {\n\t\t\tthis._reorderCommands(action);\n\t\t}\n\t\tif (gantt.callEvent(\"onBeforeUndo\", [action]) !== false) {\n\t\t\tif (action) {\n\t\t\t\tthis._applyAction(this.action.invert(action));\n\t\t\t\tthis._push(this._redoStack, gantt.copy(action));\n\t\t\t\tgantt.callEvent(\"onAfterUndo\", [action]);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tgantt.callEvent(\"onAfterUndo\", [null]);\n\t}\n\n\tredo() {\n\t\tconst gantt = this._gantt;\n\t\tthis.updateConfigs();\n\t\tif (!this.redoEnabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst action = this._pop(this._redoStack);\n\t\tif (action) {\n\t\t\tthis._reorderCommands(action);\n\t\t}\n\n\t\tif (gantt.callEvent(\"onBeforeRedo\", [action]) !== false) {\n\t\t\tif (action) {\n\t\t\t\tthis._applyAction(action);\n\t\t\t\tthis._push(this._undoStack, gantt.copy(action));\n\t\t\t\tgantt.callEvent(\"onAfterRedo\", [action]);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tgantt.callEvent(\"onAfterRedo\", [null]);\n\t}\n\n\t// storeUndo:\n\tlogAction(action: IUndoCommands) {\n\t\tthis._push(this._undoStack, action);\n\t\tthis._redoStack = [];\n\t}\n\n\tprivate _push(stack: TUndoStack, action: IUndoCommands): IUndoCommands {\n\t\tconst gantt = this._gantt;\n\t\tif (!action.commands.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst event = stack === this._undoStack ? \"onBeforeUndoStack\" : \"onBeforeRedoStack\";\n\t\tif (gantt.callEvent(event, [action]) === false){\n\t\t\treturn;\n\t\t}\n\t\t// commands can be removed from event handler\n\t\tif (!action.commands.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tstack.push(action);\n\t\twhile (stack.length > this.maxSteps) {\n\t\t\tstack.shift();\n\t\t}\n\t\treturn action;\n\t}\n\n\tprivate _pop(stack: TUndoStack): IUndoCommands {\n\t\treturn stack.pop();\n\t}\n\n\tprivate _reorderCommands(action) {\n\t\t// firstly process tasks and only then links\n\t\t// in order to ensure links are added not earlier than their tasks\n\t\t// firstly to 'move' actions and only then updates\n\t\tconst weights = { any: 0, link:1, task:2 };\n\t\tconst actionWeights = { move: 1, any:0 };\n\t\taction.commands.sort(function(a, b) {\n\t\t\tif (a.entity === \"task\" && b.entity === \"task\") {\n\t\t\t\tif (a.type !== b.type) {\n\t\t\t\t\treturn (actionWeights[b.type] || 0) - (actionWeights[a.type] || 0);\n\t\t\t\t} else if (a.type === \"move\" && a.oldValue && b.oldValue && b.oldValue.parent === a.oldValue.parent) {\n\t\t\t\t\treturn a.oldValue.$index - b.oldValue.$index;\n\t\t\t\t} else {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst weightA = weights[a.entity] || weights.any;\n\t\t\t\tconst weightB = weights[b.entity] || weights.any;\n\t\t\t\treturn weightB - weightA;\n\t\t\t}\n\n\t\t});\n\t}\n\n\tprivate _applyAction(action: IUndoCommands) {\n\t\tlet command = null;\n\t\tconst entities = this.command.entity;\n\t\tconst actions = this.command.type;\n\t\tconst gantt = this._gantt;\n\t\tconst methods = {};\n\t\tmethods[entities.task] = {\n\t\t\tadd: \"addTask\",\n\t\t\tget: \"getTask\",\n\t\t\tupdate: \"updateTask\",\n\t\t\tremove: \"deleteTask\",\n\t\t\tmove: \"moveTask\",\n\t\t\tisExists: \"isTaskExists\"\n\t\t};\n\t\tmethods[entities.link] = {\n\t\t\tadd: \"addLink\",\n\t\t\tget: \"getLink\",\n\t\t\tupdate: \"updateLink\",\n\t\t\tremove: \"deleteLink\",\n\t\t\tisExists: \"isLinkExists\"\n\t\t};\n\n\t\tgantt.batchUpdate(function() {\n\t\t\t// it is logical to undo actions from the last one to the first one\n\t\t\t// but we have to do it from the first one because the order\n\t\t\t// of tasks ($index and $local_index) depends on the existing tasks\n\t\t\tfor (let i = 0; i < action.commands.length; i++) {\n\t\t\t\tcommand = action.commands[i];\n\t\t\t\tconst method = methods[command.entity][command.type];\n\t\t\t\tconst getMethod = methods[command.entity].get;\n\t\t\t\tconst check = methods[command.entity].isExists;\n\n\t\t\t\tif (command.type === actions.add) {\n\t\t\t\t\tgantt[method](command.oldValue, command.oldValue.parent, command.oldValue.$local_index);\n\t\t\t\t} else if (command.type === actions.remove) {\n\t\t\t\t\tif (gantt[check](command.value.id)) {\n\t\t\t\t\t\tgantt[method](command.value.id);\n\t\t\t\t\t}\n\t\t\t\t} else if (command.type === actions.update) {\n\t\t\t\t\tconst item = gantt[getMethod](command.value.id);\n\t\t\t\t\tfor(const prop in command.value){\n\t\t\t\t\t\tconst internalProperty = prop.startsWith(\"$\") || prop.startsWith(\"_\");\n\t\t\t\t\t\tconst whitelist = [\"$open\"];\n\t\t\t\t\t\tlet copyProperty = !internalProperty;\n\t\t\t\t\t\tif (whitelist.indexOf(prop) > -1){\n\t\t\t\t\t\t\tcopyProperty = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(copyProperty){\n\t\t\t\t\t\t\titem[prop] = command.value[prop];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tgantt[method](command.value.id);\n\t\t\t\t} else if (command.type === actions.move) {\n\t\t\t\t\tgantt[method](command.value.id, command.value.$local_index, command.value.parent);\n\t\t\t\t\t// GS-680: We should send the changes to the server after we undo vertical reorder\n\t\t\t\t\tgantt.callEvent(\"onRowDragEnd\", [command.value.id]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}","import auto_scheduling from \"./auto_scheduling\";\nimport click_drag from \"./click_drag\";\nimport critical_path from \"./critical_path\";\nimport drag_timeline from \"./drag_timeline\";\nimport export_api from \"./export_api\";\nimport fullscreen from \"./fullscreen\";\nimport grouping from \"./grouping\";\nimport keyboard_navigation from \"./keyboard_navigation\";\nimport marker from \"./marker\";\nimport multiselect from \"./multiselect\";\nimport overlay from \"./overlay\";\nimport quick_info from \"./quick_info\";\nimport tooltip from \"./tooltip\";\nimport undo from \"./undo\";\n\nexport default {\n\tauto_scheduling,\n\tclick_drag,\n\tcritical_path,\n\tdrag_timeline,\n\tfullscreen,\n\tkeyboard_navigation,\n\tquick_info,\n\ttooltip,\n\tundo,\n\tgrouping,\n\tmarker,\n\tmultiselect,\n\toverlay,\n\texport_api\n};","\nimport links_common from \"../core/relations/links_common\";\nimport graph_helper from \"../core/relations/graph_helper\";\n\nimport LinksBuilder from \"../core/relations/links_builder\";\nimport {ConstraintTypes} from \"./auto_scheduling/constraint_types\";\nimport {ConstraintsHelper} from \"./auto_scheduling/constraints\";\nimport {AutoSchedulingPlanner} from \"./auto_scheduling/planner\";\nimport {ConnectedGroupsHelper} from \"./auto_scheduling/connected_groups\";\nimport {LoopsFinder} from \"./auto_scheduling/loops_finder\";\n\nimport ConfigBuilder from \"../core/plugins/auto_scheduling_config\";\n\nimport {attachUIHandlers} from \"./auto_scheduling/ui_handlers\";\n\nexport default function(gantt){\n\n\tconst { getDefaultAutoSchedulingConfig, getAutoSchedulingConfig} = ConfigBuilder(gantt);\n\n\tlinks_common(gantt);\n\nvar linksBuilder = LinksBuilder(gantt);\nvar graphHelper = graph_helper(gantt);\n\n\nvar constraintsHelper = ConstraintsHelper.Create(\n\tgantt\n);\n\n\nvar planner = new AutoSchedulingPlanner(gantt, graphHelper, constraintsHelper);\n\nvar connectedGroups = new ConnectedGroupsHelper(gantt, linksBuilder);\n\nvar loopsFinder = new LoopsFinder(\n\tgantt,\n\tgraphHelper,\n\tlinksBuilder\n);\n\ngantt.getConnectedGroup = connectedGroups.getConnectedGroup;\ngantt.getConstraintType = constraintsHelper.getConstraintType;\ngantt.getConstraintLimitations = function (task) {\n\tvar plan = constraintsHelper.processConstraint(task, null);\n\tif (plan) {\n\t\treturn {\n\t\t\tearliestStart: plan.earliestStart || null,\n\t\t\tearliestEnd: plan.earliestEnd || null,\n\t\t\tlatestStart: plan.latestStart || null,\n\t\t\tlatestEnd: plan.latestEnd || null\n\t\t};\n\t} else {\n\t\treturn {\n\t\t\tearliestStart: null,\n\t\t\tearliestEnd: null,\n\t\t\tlatestStart: null,\n\t\t\tlatestEnd: null\n\t\t};\n\t}\n};\n\ngantt.isCircularLink = loopsFinder.isCircularLink;\ngantt.findCycles = loopsFinder.findCycles;\n\ngantt.config.auto_scheduling = getDefaultAutoSchedulingConfig();\ngantt.config.constraint_types = ConstraintTypes;\n\nfunction preferInitialTaskDates(startTask, relations) {\n\tif (gantt._getAutoSchedulingConfig().apply_constraints) {\n\t\treturn;\n\t}\n\n\t// .preferredStart exists only to emulate pre 6.1 auto scheduling behavior\n\tfor (var i = 0; i < relations.length; i++) {\n\t\tvar rel = relations[i];\n\t\tvar task = gantt.getTask(rel.target);\n\n\t\tif ((gantt._getAutoSchedulingConfig().gap_behavior === \"preserve\") || rel.target == startTask) {\n\t\t\trel.preferredStart = new Date(task.start_date);\n\t\t}\n\t}\n}\n\nvar afterRenderBeforeFirstRepaint = false;\ngantt.attachEvent(\"onParse\", function(){\n\tafterRenderBeforeFirstRepaint = true;\n\treturn true;\n});\n\ngantt.attachEvent(\"onBeforeGanttRender\", function(){\n\tafterRenderBeforeFirstRepaint = false;\n\treturn true;\n});\n\nfunction updateParentsAndCallEvents(updatedTasks) {\n\tif(!updatedTasks.length){\n\t\treturn;\n\t}\n\n\tgantt.batchUpdate(function payload() {\n\t\tfor (var i = 0; i < updatedTasks.length; i++) {\n\t\t\tgantt.updateTask(updatedTasks[i]);\n\t\t}\n\t}, afterRenderBeforeFirstRepaint); // don't call repaint if auto scheduling on parse before initial repain\n}\n\ngantt._autoSchedule = function (id, relations) {\n\tif (gantt.callEvent(\"onBeforeAutoSchedule\", [id]) === false) {\n\t\treturn;\n\t}\n\tgantt._autoscheduling_in_progress = true;\n\n\tvar constraints = constraintsHelper.getConstraints(\n\t\tid,\n\t\tgantt.isTaskExists(id) ? relations : null\n\t);\n\n\tvar updatedTasks = [];\n\n\tvar cycles = graphHelper.findLoops(relations);\n\tif (cycles.length) {\n\t\tgantt.callEvent(\"onAutoScheduleCircularLink\", [cycles]);\n\t} else {\n\t\tpreferInitialTaskDates(id, relations);\n\n\t\t// GS-2427. Auto-schedule twice when there are links with project tasks\n\t\t// as we cannot be sure that the project duration doesn't change\n\t\tfor (let i = 0; i < relations.length; i++) {\n\t\t\tif (relations[i].subtaskLink){\n\t\t\t\tplanner._secondIterationRequired = true;\n\t\t\t\tplanner._secondIteration = false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tvar plan = planner.generatePlan(relations, constraints);\n\t\tupdatedTasks = planner.applyProjectPlan(plan);\n\n\t\tupdateParentsAndCallEvents(updatedTasks);\n\t}\n\n\tgantt._autoscheduling_in_progress = false;\n\tgantt.callEvent(\"onAfterAutoSchedule\", [id, updatedTasks]);\n};\n\ngantt.autoSchedule = function (id, inclusive) {\n\tif (inclusive === undefined) {\n\t\tinclusive = true;\n\t} else {\n\t\tinclusive = !!inclusive;\n\t}\n\n\tvar relations;\n\tif (id !== undefined) {\n\t\tif (!gantt._getAutoSchedulingConfig().apply_constraints) {\n\t\t\trelations = linksBuilder.getLinkedTasks(id, inclusive);\n\t\t} else {\n\t\t\trelations = connectedGroups.getConnectedGroupRelations(id);\n\t\t}\n\t} else {\n\t\trelations = linksBuilder.getLinkedTasks();\n\t}\n\n\tgantt._autoSchedule(id, relations);\n};\n\ngantt.attachEvent(\"onTaskLoading\", function (task) {\n\tif (task.constraint_date && typeof task.constraint_date === \"string\") {\n\t\ttask.constraint_date = gantt.date.parseDate(task.constraint_date, \"parse_date\");\n\t}\n\ttask.constraint_type = gantt.getConstraintType(task);\n\treturn true;\n});\ngantt.attachEvent(\"onTaskCreated\", function (task) {\n\ttask.constraint_type = gantt.getConstraintType(task);\n\treturn true;\n});\n\nattachUIHandlers(gantt, linksBuilder, loopsFinder, connectedGroups);\n\n};","import { EventsManager } from \"./eventsManager\";\nimport { ISelectedRegionConfig, SelectedRegion } from \"./selectedRegion\";\n\nexport default function(gantt: any){\n\tif (!gantt.ext) {\n\t\tgantt.ext = {};\n\t}\n\n\tconst defaultConfig: ISelectedRegionConfig = {\n\t\tclassName: \"gantt_click_drag_rect\",\n\t\tuseRequestAnimationFrame: true,\n\t\tcallback: undefined,\n\t\tsingleRow: false\n\t};\n\n\tfunction setClickDrag(){\n\t\tconst config: ISelectedRegionConfig = { viewPort: gantt.$task_data, ...defaultConfig };\n\t\tif (gantt.ext.clickDrag){\n\t\t\tgantt.ext.clickDrag.destructor();\n\t\t}\n\t\tgantt.ext.clickDrag = new EventsManager(gantt);\n\t\tconst clickDrag = gantt.config.click_drag;\n\t\tconfig.render = clickDrag.render || defaultConfig.render;\n\t\tconfig.className = clickDrag.className || defaultConfig.className;\n\t\tconfig.callback = clickDrag.callback || defaultConfig.callback;\n\t\tconfig.viewPort = clickDrag.viewPort || gantt.$task_data;\n\t\tconfig.useRequestAnimationFrame = clickDrag.useRequestAnimationFrame === undefined ?\n\t\t\tdefaultConfig.useRequestAnimationFrame : clickDrag.useRequestAnimationFrame;\n\n\t\tconfig.singleRow = clickDrag.singleRow === undefined ? defaultConfig.singleRow : clickDrag.singleRow;\n\t\tconst timeline = gantt.$ui.getView(\"timeline\");\n\t\tconst selectedRegion = new SelectedRegion(config, gantt, timeline);\n\t\tgantt.ext.clickDrag.attach(selectedRegion, clickDrag.useKey, clickDrag.ignore);\n\t}\n\n\tgantt.attachEvent(\"onGanttReady\", () => {\n\t\tif (gantt.config.click_drag){\n\t\t\tsetClickDrag();\n\t\t}\n\t});\n\n\tgantt.attachEvent(\"onGanttLayoutReady\", function(){\n\t\tif (gantt.$container && gantt.config.click_drag){\n\t\t\tgantt.attachEvent(\"onGanttRender\", function(){\n\t\t\t\tsetClickDrag();\n\t\t\t}, {once:true});\n\t\t}\n\t});\n\n\tgantt.attachEvent(\"onDestroy\", () => {\n\t\tif (gantt.ext.clickDrag){\n\t\t\tgantt.ext.clickDrag.destructor();\n\t\t}\n\t});\n\n}","\n\nimport links_common from \"../core/relations/links_common\";\nimport slackPrivate from \"./critical_path/slack\";\nimport critical_path from \"./critical_path/critical_path\";\n\n\nexport default function(gantt){\n\tlinks_common(gantt);\n\nvar _private = slackPrivate(gantt);\n_private.init();\n\ngantt.getFreeSlack = function(task) {\n\treturn _private.getFreeSlack(task);\n};\n\ngantt.getTotalSlack = function(task) {\n\treturn _private.getTotalSlack(task);\n};\n\nvar criticalPath = critical_path(gantt);\ngantt.config.highlight_critical_path = false;\ncriticalPath.init(_private);\n\ngantt.isCriticalTask = function (task) {\n\tgantt.assert(!!(task && task.id !== undefined), \"Invalid argument for gantt.isCriticalTask\");\n\treturn criticalPath.isCriticalTask(task);\n};\n\ngantt.isCriticalLink = function (link) {\n\treturn this.isCriticalTask(gantt.getTask(link.source));\n};\n\n\ngantt.getSlack = function(task1, task2) {\n\tvar minSlack = 0;\n\tvar relations = [];\n\tvar common = {};\n\n\tfor (var i = 0; i < task1.$source.length; i++) {\n\t\tcommon[task1.$source[i]] = true;\n\t}\n\tfor (var i = 0; i < task2.$target.length; i++) {\n\t\tif(common[task2.$target[i]])\n\t\t\trelations.push(task2.$target[i]);\n\t}\n\t// there is at least one link\n\tif (relations[0]){\n\t\tfor (var i = 0; i < relations.length; i++) {\n\t\t\tvar link = this.getLink(relations[i]);\n\t\t\tvar newSlack = this._getSlack(task1, task2, this._convertToFinishToStartLink(link.id, link, task1, task2, task1.parent, task2.parent));\n\n\t\t\tif (minSlack > newSlack || i === 0) {\n\t\t\t\tminSlack = newSlack;\n\t\t\t}\n\t\t}\n\t}\n\telse { // there are no links, but we still need the slack (for the children of a project task)\n\t\tminSlack = this._getSlack(task1, task2, {});\n\t}\n\treturn minSlack;\n};\n\ngantt._getSlack = function (task, next_task, relation) {\n\t// relation - link expressed as finish-to-start (gantt._convertToFinishToStartLink)\n\tvar types = this.config.types;\n\n\tvar from = null;\n\tif (this.getTaskType(task.type) == types.milestone) {\n\t\tfrom = task.start_date;\n\t} else {\n\t\tfrom = task.end_date;\n\t}\n\n\tvar to = next_task.start_date;\n\n\tvar duration = 0;\n\tif (+from > +to) {\n\t\tduration = -this.calculateDuration({start_date: to, end_date: from, task: task});\n\t} else {\n\t\tduration = this.calculateDuration({start_date: from, end_date: to, task: task});\n\t}\n\n\tvar lag = relation.lag;\n\tif (lag && lag*1 == lag) {\n\t\tduration -= lag;\n\t}\n\n\treturn duration;\n};\n\n\n};","import LinksBuilder from \"../../core/relations/links_builder\";\nimport GraphHelper from \"../../core/relations/graph_helper\";\n\nexport default function(gantt) {\n\tvar linksBuilder = LinksBuilder(gantt);\n\tvar graphHelper = GraphHelper(gantt);\n\tvar _private = {\n\t\t_freeSlack: {},\n\t\t_totalSlack: {},\n\t\t_slackNeedCalculate: true,\n\t\t_linkedTasksById: {},\n\t\t_successorsByTaskId: {},\n\t\t_projectEnd: null,\n\t\t\n\t\t_calculateSlacks: function(){\n\t\t\tvar linkedTasks = linksBuilder.getLinkedTasks();\n\t\t\t\n\t\t\tvar loops = graphHelper.findLoops(linkedTasks);\n\t\t\tif(loops.length){\n\t\t\t\tgantt.callEvent(\"onAutoScheduleCircularLink\", [loops]);\n\t\t\t\tvar loopLinks = {};\n\t\t\t\t\n\t\t\t\tloops.forEach(function(loop){\n\t\t\t\t\t// remove loop\n\t\t\t\t\tloop.linkKeys.forEach(function(key){\n\t\t\t\t\t\tloopLinks[key] = true;\n\t\t\t\t\t});\n\t\t\t\t\t//const problemLink = loop.linkKeys[0];\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tfor(var i = 0; i < linkedTasks.length; i++){\n\t\t\t\t\tif(linkedTasks[i].hashSum in loopLinks){\n\t\t\t\t\t\tlinkedTasks.splice(i, 1);\n\t\t\t\t\t\ti--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tconst reversedOrder = graphHelper.topologicalSort(linkedTasks).reverse();\n\t\t\tconst successorsByTaskId = {};\n\t\t\tlinkedTasks.forEach((entry) => {\n\n\t\t\t\t// get successors\n\t\t\t\tif (!successorsByTaskId[entry.source]) {\n\t\t\t\t\tsuccessorsByTaskId[entry.source] = {\n\t\t\t\t\t\tlinked: []\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tsuccessorsByTaskId[entry.source].linked.push({\n\t\t\t\t\ttarget: entry.target,\n\t\t\t\t\tlink: entry\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tconst distCalculator = {\n\t\t\t\t_cache: {},\n\t\t\t\tgetDist: function(source, target){\n\t\t\t\t\tconst key = `${source.id}_${target.id}`;\n\t\t\t\t\tif(this._cache[key]){\n\t\t\t\t\t\treturn this._cache[key];\n\t\t\t\t\t}else{\n\t\t\t\t\t\tconst dist = gantt.calculateDuration({\n\t\t\t\t\t\t\tstart_date: source.end_date,\n\t\t\t\t\t\t\tend_date: target.start_date,\n\t\t\t\t\t\t\ttask: source});\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis._cache[key] = dist;\n\t\t\t\t\t\treturn dist;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._projectEnd = gantt.getSubtaskDates().end_date;\n\t\t\tthis._calculateFreeSlack(linkedTasks, reversedOrder, successorsByTaskId, distCalculator);\n\t\t\tthis._calculateTotalSlack(linkedTasks, reversedOrder, successorsByTaskId, distCalculator);\n\t\t},\n\t\t_isCompletedTask: function(task){\n\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\t\t\treturn autoSchedulingConfig.use_progress && task.progress == 1;\n\t\t},\n\t\t_calculateFreeSlack: function(linkedTasks, orderedFromEnd, successorsMap, distCalculator){\n\t\t\t\n\t\t\tconst freeSlack = this._freeSlack = {};\n\t\t\tconst tasksToDo = {};\n\t\t\tgantt.eachTask(function(task){\n\t\t\t\tif(!gantt.isSummaryTask(task)){\n\t\t\t\t\ttasksToDo[task.id] = task;\n\t\t\t\t}\n\t\t\t});\n\t\t\tconst processedTasks = {};\n\t\t\tlinkedTasks.forEach((entry) => {\n\t\t\t\tconst task = tasksToDo[entry.source];\n\t\t\t\t// GS-1995: Don't calculate slack if the task's parent is not loaded\n\t\t\t\tif (!task){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tprocessedTasks[entry.source] = true;\n\t\t\t\tlet ownSlack = distCalculator.getDist(task, gantt.getTask(entry.target));\n\t\t\t\townSlack -= entry.lag || 0;\n\n\t\t\t\tif(freeSlack[entry.source] !== undefined){\n\t\t\t\t\tfreeSlack[entry.source] = Math.min(ownSlack, freeSlack[entry.source]);\n\t\t\t\t}else{\n\t\t\t\t\tfreeSlack[entry.source] = ownSlack;\n\t\t\t\t}\n\t\t\t});\n\t\t\tfor(const id in tasksToDo){\n\t\t\t\tif(processedTasks[id]){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tconst task = tasksToDo[id];\n\t\t\t\tif(this._isCompletedTask(task) || task.unscheduled){\n\t\t\t\t\tfreeSlack[task.id] = 0;\n\t\t\t\t}else{\n\t\t\t\t\tfreeSlack[task.id] = gantt.calculateDuration({start_date: task.end_date, end_date: this._projectEnd, task:task});\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\treturn this._freeSlack;\n\n\t\t},\n\t\t_disconnectedTaskSlack(task){\n\t\t\tif(this._isCompletedTask(task)){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn Math.max(gantt.calculateDuration(task.end_date, this._projectEnd), 0);\n\t\t\t}\n\t\t},\n\t\t_calculateTotalSlack: function(linkedTasks, orderedFromEnd, successorsMap,  distCalculator) {\n\t\t\tthis._totalSlack = {};\n\t\t\tthis._slackNeedCalculate = false;\n\t\t\tvar totalSlackByTaskId = {};\n\t\t\tvar tasks = gantt.getTaskByTime();\n\n\t\t\tfor(var i = 0; i < orderedFromEnd.length; i++){\n\t\t\t\tconst task = gantt.getTask(orderedFromEnd[i]);\n\t\t\t\t\n\t\t\t\tif(this._isCompletedTask(task)){\n\t\t\t\t\ttotalSlackByTaskId[task.id] = 0;\n\t\t\t\t} else if(!successorsMap[task.id] && !gantt.isSummaryTask(task)){\n\t\t\t\t\ttotalSlackByTaskId[task.id] = this.getFreeSlack(task);\n\t\t\t\t}else{\n\t\t\t\t\tconst successorLinks = successorsMap[task.id].linked;\n\t\t\t\t\tlet totalSlack = null;\n\t\t\t\t\tfor(var j = 0; j < successorLinks.length; j++){\n\t\t\t\t\t\tconst successorLink = successorLinks[j];\n\t\t\t\t\t\tconst successor = gantt.getTask(successorLink.target);\n\t\t\t\t\t\tlet successorSlack = 0;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(totalSlackByTaskId[successor.id] !== undefined){\n\t\t\t\t\t\t\tsuccessorSlack += totalSlackByTaskId[successor.id];\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tsuccessorSlack += Math.max(distCalculator.getDist(task, successor) - successorLink.link.targetLag, 0);\n\n\t\t\t\t\t\tsuccessorSlack -= successorLink.link.trueLag || 0;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\tif(totalSlack === null){\n\t\t\t\t\t\t\ttotalSlack = successorSlack;\n\t\t\t\t\t\t} else{\n\t\t\t\t\t\t\ttotalSlack = Math.min(totalSlack, successorSlack);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\ttotalSlackByTaskId[task.id] = totalSlack || 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\ttasks.forEach(function(task){\n\t\t\t\tif(totalSlackByTaskId[task.id] === undefined && !gantt.isSummaryTask(task)){\n\t\t\t\t\ttotalSlackByTaskId[task.id] = this.getFreeSlack(task);\n\t\t\t\t}\n\t\t\t}.bind(this));\n\t\t\t\n\t\t\tthis._totalSlack = totalSlackByTaskId;\n\t\t\treturn this._totalSlack;\n\t\t},\n\n\t\t_resetTotalSlackCache: function() {\n\t\t\tthis._slackNeedCalculate = true;\n\t\t},\n\n\t\t_shouldCalculateTotalSlack: function() {\n\t\t\treturn this._slackNeedCalculate;\n\t\t},\n\n\t\tgetFreeSlack: function(task) {\n\t\t\tif (this._shouldCalculateTotalSlack()) {\n\t\t\t\tthis._calculateSlacks();\n\t\t\t}\n\t\t\tif (!gantt.isTaskExists(task.id)) {\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tif(this._isCompletedTask(task)){\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tif(gantt.isSummaryTask(task)){\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\treturn this._freeSlack[task.id] || 0; \n\t\t},\n\n\t\tgetTotalSlack: function(task) {\n\t\t\tif (this._shouldCalculateTotalSlack()) {\n\t\t\t\tthis._calculateSlacks();\n\t\t\t}\n\t\t\tif (task === undefined) {\n\t\t\t\treturn this._totalSlack;\n\t\t\t}\n\t\t\t\n\t\t\tvar id;\n\t\t\tif (task.id !== undefined){\n\t\t\t\tid = task.id;\n\t\t\t}else{\n\t\t\t\tid = task;\n\t\t\t}\n\n\t\t\tif(this._isCompletedTask(task)){\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tif(this._totalSlack[id] === undefined){\n\t\t\t\tif(gantt.isSummaryTask(gantt.getTask(id))){\n\t\t\t\t\tvar minSlack = null;\n\t\t\t\t\tgantt.eachTask(function(child){\n\t\t\t\t\t\tvar childSlack = this._totalSlack[child.id];\n\t\t\t\t\t\tif(childSlack !== undefined && (minSlack === null || childSlack < minSlack)){\n\t\t\t\t\t\t\tminSlack = childSlack;\n\t\t\t\t\t\t}\n\t\t\t\t\t}.bind(this), id);\n\t\t\t\t\t\n\t\t\t\t\tif(minSlack !== null){\n\t\t\t\t\t\tthis._totalSlack[id] = minSlack;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis._totalSlack[id] = gantt.calculateDuration({\n\t\t\t\t\t\t\tstart_date: task.end_date,\n\t\t\t\t\t\t\tend_date: this._projectEnd,\n\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\treturn this._totalSlack[id];\n\t\t\t\t\t\n\t\t\t\t}else{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\treturn this._totalSlack[id] || 0;\n\t\t\t}\n\t\t},\n\n\t\tdropCachedFreeSlack: function() {\n\t\t\tthis._freeSlack =  {};\n\t\t\tthis._resetTotalSlackCache();\n\t\t},\n\n\t\tinit: function(){\n\t\t\tfunction slackHandler(){\n\t\t\t\t_private.dropCachedFreeSlack();\n\t\t\t}\n\n\t\t\tgantt.attachEvent(\"onAfterLinkAdd\", slackHandler);\n\t\t\tgantt.attachEvent(\"onTaskIdChange\", slackHandler);\n\t\t\tgantt.attachEvent(\"onAfterLinkUpdate\", slackHandler);\n\t\t\tgantt.attachEvent(\"onAfterLinkDelete\", slackHandler);\n\t\t\tgantt.attachEvent(\"onAfterTaskAdd\", slackHandler);\n\t\t\tgantt.attachEvent(\"onAfterTaskUpdate\", slackHandler);\n\t\t\tgantt.attachEvent(\"onAfterTaskDelete\", slackHandler);\n\t\t\tgantt.attachEvent(\"onRowDragEnd\", slackHandler);\n\t\t\tgantt.attachEvent(\"onAfterTaskMove\", slackHandler);\n\t\t\tgantt.attachEvent(\"onParse\", slackHandler);\n\t\t\tgantt.attachEvent(\"onClear\", slackHandler);\n\t\t\tgantt.$data.tasksStore.attachEvent(\"onClearAll\", slackHandler);\n\t\t\tgantt.$data.linksStore.attachEvent(\"onClearAll\", slackHandler);\n\t\t}\n\t};\n\n\treturn _private;\n};","export default function(gantt){\n\tgantt._isProjectEnd = function(task) {\n\t\treturn !(this._hasDuration({\n\t\t\tstart_date: task.end_date,\n\t\t\tend_date: this._getProjectEnd(),\n\t\t\ttask: task\n\t\t}));\n\t};\n\n\treturn {\n\t\t_cache: {},\n\t\t_slackHelper: null,\n\t\treset: function(){\n\t\t\tthis._cache = {};\n\t\t},\n\t\t_calculateCriticalPath: function(){\n\t\t\tthis.reset();\n\t\t},\n\t\t\n\t\tisCriticalTask: function(task){\n\t\t\tif(!task) return false;\n\n\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\t\t\tif(autoSchedulingConfig.use_progress && task.progress === 1){\n\t\t\t\tthis._cache[task.id] = false;\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (task.unscheduled){\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif(this._cache[task.id] === undefined){\n\t\t\t\tif(gantt.isSummaryTask(task)){\n\t\t\t\t\tlet hasCritical = false;\n\t\t\t\t\tgantt.eachTask((function(child){\n\t\t\t\t\t\tif(!hasCritical){\n\t\t\t\t\t\t\thasCritical = this.isCriticalTask(child);\n\t\t\t\t\t\t}\n\t\t\t\t\t}).bind(this), task.id);\n\t\t\t\t\t\n\t\t\t\t\tthis._cache[task.id] = hasCritical;\n\t\t\t\t}else{\n\t\t\t\t\tthis._cache[task.id] = this._slackHelper.getTotalSlack(task) <= 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treturn this._cache[task.id];\n\t\t},\n\n\t\tinit: function(slackHelper){\n\t\t\tthis._slackHelper = slackHelper;\n\t\t\tvar resetCache = gantt.bind(function(){\n\t\t\t\tthis.reset();\n\t\t\t\treturn true;\n\t\t\t}, this);\n\n\t\t\tvar handleTaskIdChange = gantt.bind(function (oldId, newId) {\n\t\t\t\tif (this._cache) {\n\t\t\t\t\tthis._cache[newId] = this._cache[oldId];\n\t\t\t\t\tdelete this._cache[oldId];\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}, this);\n\n\t\t\tgantt.attachEvent(\"onAfterLinkAdd\", resetCache);\n\t\t\tgantt.attachEvent(\"onAfterLinkUpdate\", resetCache);\n\t\t\tgantt.attachEvent(\"onAfterLinkDelete\", resetCache);\n\t\t\tgantt.attachEvent(\"onAfterTaskAdd\", resetCache);\n\t\t\tgantt.attachEvent(\"onTaskIdChange\", handleTaskIdChange);\n\t\t\tgantt.attachEvent(\"onAfterTaskUpdate\", resetCache);\n\t\t\tgantt.attachEvent(\"onAfterTaskDelete\", resetCache);\n\t\t\tgantt.attachEvent(\"onParse\", resetCache);\n\t\t\tgantt.attachEvent(\"onClear\", resetCache);\n\t\t\tgantt.$data.tasksStore.attachEvent(\"onClearAll\", resetCache);\n\t\t\tgantt.$data.linksStore.attachEvent(\"onClearAll\", resetCache);\n\n\t\t\tvar criticalPathHandler = function(){\n\t\t\t\tif(gantt.config.highlight_critical_path && !gantt.getState(\"batchUpdate\").batch_update)\n\t\t\t\t\tgantt.render();\n\t\t\t};\n\t\t\tgantt.attachEvent(\"onAfterLinkAdd\", criticalPathHandler);\n\t\t\tgantt.attachEvent(\"onAfterLinkUpdate\", criticalPathHandler);\n\t\t\tgantt.attachEvent(\"onAfterLinkDelete\", criticalPathHandler);\n\t\t\tgantt.attachEvent(\"onAfterTaskAdd\", criticalPathHandler);\n\t\t\tgantt.attachEvent(\"onTaskIdChange\", function (oldId, newId) {\n\t\t\t\tif (gantt.config.highlight_critical_path && gantt.isTaskExists(newId)) {\n\t\t\t\t\tgantt.refreshTask(newId);\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t});\n\t\t\tgantt.attachEvent(\"onAfterTaskUpdate\", criticalPathHandler);\n\t\t\tgantt.attachEvent(\"onAfterTaskDelete\", criticalPathHandler);\n\t\t}\n\t};\n};","import { EventsManager } from \"./eventsManager\";\nexport default function(gantt: any){\n\tif (!gantt.ext){\n\t\tgantt.ext = {};\n\t}\n\n\tgantt.ext.dragTimeline = {\n\t\tcreate: () => EventsManager.create(gantt),\n\t\t_isDragInProgress: () => EventsManager._isDragInProgress\n\t};\n\n\tgantt.config.drag_timeline = {\n\t\tenabled: true,\n\t\trender: false\n\t};\n}","export default function(gantt: any){\n\ninterface IBody extends HTMLElement {\n\tmsRequestFullscreen?: () => void;\n\tmozRequestFullScreen?: () => void;\n\twebkitRequestFullscreen?: (ALLOW_KEYBOARD_INPUT: any) => void;\n}\n\n\ninterface IConsole extends Console {\n\twarning?: (str: string) => void;\n}\n\ninterface IDocument extends Document {\n\tfullscreenElement: Element;\n\tmozFullScreenElement?: Element;\n\twebkitFullscreenElement?: Element;\n\tmsFullscreenElement?: Element;\n\twebkitFullscreenEnabled?: boolean;\n\tmozFullScreenEnabled?: boolean;\n\tmsFullscreenEnabled?: boolean;\n\tmsExitFullscreen?: () => void;\n\tmozCancelFullScreen?: () => void;\n\twebkitExitFullscreen?: () => void;\n}\n\ninterface IElement extends Element {\n\tALLOW_KEYBOARD_INPUT?: boolean;\n}\n\ninterface IElementSizes extends ISizes {\n\tmodified: boolean;\n}\n\ninterface ISizes {\n\twidth: null | string;\n\theight: null | string;\n\ttop: null | string;\n\tleft: null | string;\n\tposition: null | string;\n\tzIndex: null | number;\n}\n\nfunction isExpanded() {\n\tconst element = ((document as IDocument).fullscreenElement ||\n\t\t(document as IDocument).mozFullScreenElement ||\n\t\t(document as IDocument).webkitFullscreenElement ||\n\t\t(document as IDocument).msFullscreenElement);\n\treturn !!(element && element === document.body);\n}\n\nfunction isFullscreenAvailable() {\n\ttry {\n\t\treturn (document as IDocument).fullscreenEnabled ||\n\t\t\t(document as IDocument).webkitFullscreenEnabled ||\n\t\t\t(document as IDocument).mozFullScreenEnabled ||\n\t\t\t(document as IDocument).msFullscreenEnabled;\n\t} catch (e) {\n\t\t// eslint-disable-next-line no-console\n\t\tconsole.error(\"Fullscreen is not available:\", e); \n\t}\n}\n\nconst state = gantt.$services.getService(\"state\");\nstate.registerProvider(\"fullscreen\", () => {\n\tif (isFullscreenAvailable()){\n\t\treturn { fullscreen: isExpanded() };\n\t} else {\n\t\treturn undefined;\n\t}\n});\n\nlet backupBodyPadding = {\n\toverflow: null,\n\tpadding: null,\n\tpaddingTop: null,\n\tpaddingRight: null,\n\tpaddingBottom: null,\n\tpaddingLeft: null\n};\n\nconst backupElementSizes: IElementSizes = {\n\twidth: null,\n\theight: null,\n\ttop: null,\n\tleft: null,\n\tposition: null,\n\tzIndex: null,\n\tmodified: false\n};\n\nlet backupPositioning = null;\nfunction resetParentPositioning(root){\n\tlet parent = root.parentNode;\n\tconst positions = [];\n\twhile(parent && parent.style){\n\t\tpositions.push({\n\t\t\telement: parent,\n\t\t\toriginalPositioning: parent.style.position\n\t\t});\n\t\tparent.style.position = \"static\";\n\t\tparent = parent.parentNode;\n\t}\n\treturn positions;\n}\n\nfunction restoreParentPositioning(positions: any[]){\n\tpositions.forEach(record => {\n\t\trecord.element.style.position = record.originalPositioning;\n\t});\n}\n\n// expand gantt root element to fullscreen automatically\nfunction setFullScreenSizes() {\n\tconst root = gantt.ext.fullscreen.getFullscreenElement();\n\tconst body = document.body;\n\tupdateSizes(root.style, backupElementSizes);\n\tbackupBodyPadding = {\n\t\toverflow: body.style.overflow,\n\t\tpadding: body.style.padding ? body.style.padding : null,\n\t\tpaddingTop: body.style.paddingTop ? body.style.paddingTop : null,\n\t\tpaddingRight: body.style.paddingRight ? body.style.paddingRight : null,\n\t\tpaddingBottom: body.style.paddingBottom ? body.style.paddingBottom : null,\n\t\tpaddingLeft: body.style.paddingLeft ? body.style.paddingLeft : null\n\t};\n\n\tif (body.style.padding) {\n\t\tbody.style.padding = \"0\";\n\t}\n\tif (body.style.paddingTop) {\n\t\tbody.style.paddingTop = \"0\";\n\t}\n\tif (body.style.paddingRight) {\n\t\tbody.style.paddingRight = \"0\";\n\t}\n\tif (body.style.paddingBottom) {\n\t\tbody.style.paddingBottom = \"0\";\n\t}\n\tif (body.style.paddingLeft) {\n\t\tbody.style.paddingLeft = \"0\";\n\t}\n\n\tbody.style.overflow = \"hidden\";\n\n\troot.style.width = \"100vw\";\n\troot.style.height = \"100vh\";\n\troot.style.top = \"0px\";\n\troot.style.left = \"0px\";\n\troot.style.position = \"absolute\";\n\troot.style.zIndex = 1;\n\tbackupElementSizes.modified = true;\n\tbackupPositioning = resetParentPositioning(root);\n}\n\nfunction restoreSizes() {\n\tconst root = gantt.ext.fullscreen.getFullscreenElement();\n\tconst body = document.body;\n\tif (backupElementSizes.modified) {\n\t\tif (backupBodyPadding.padding) {\n\t\t\tbody.style.padding = backupBodyPadding.padding;\n\t\t}\n\t\tif (backupBodyPadding.paddingTop) {\n\t\t\tbody.style.paddingTop = backupBodyPadding.paddingTop;\n\t\t}\n\t\tif (backupBodyPadding.paddingRight) {\n\t\t\tbody.style.paddingRight = backupBodyPadding.paddingRight;\n\t\t}\n\t\tif (backupBodyPadding.paddingBottom) {\n\t\t\tbody.style.paddingBottom = backupBodyPadding.paddingBottom;\n\t\t}\n\t\tif (backupBodyPadding.paddingLeft) {\n\t\t\tbody.style.paddingLeft = backupBodyPadding.paddingLeft;\n\t\t}\n\n\t\tbody.style.overflow = backupBodyPadding.overflow;\n\t\tbackupBodyPadding = {\n\t\t\toverflow: null,\n\t\t\tpadding: null,\n\t\t\tpaddingTop: null,\n\t\t\tpaddingRight: null,\n\t\t\tpaddingBottom: null,\n\t\t\tpaddingLeft: null\n\t\t};\n\t\tupdateSizes(backupElementSizes, root.style);\n\t\tbackupElementSizes.modified = false;\n\t}\n\trestoreParentPositioning(backupPositioning);\n\tbackupPositioning = null;\n}\n\nfunction updateSizes(source: ISizes, target: ISizes) {\n\ttarget.width = source.width;\n\ttarget.height = source.height;\n\ttarget.top = source.top;\n\ttarget.left = source.left;\n\ttarget.position = source.position;\n\ttarget.zIndex = source.zIndex;\n}\n\nfunction addDOMEvents() {\n\tgantt.event(document, \"webkitfullscreenchange\", onFullScreenChange);\n\tgantt.event(document, \"mozfullscreenchange\", onFullScreenChange);\n\tgantt.event(document, \"MSFullscreenChange\", onFullScreenChange);\n\t// For IE on Win 10\n\tgantt.event(document, \"fullscreenChange\", onFullScreenChange);\n\tgantt.event(document, \"fullscreenchange\", onFullScreenChange);\n}\n\nlet expandGantt = false;\nfunction onFullScreenChange() {\n\tif (!gantt.$container) {\n\t\t// do nothing if gantt is not yet initialized\n\t\treturn;\n\t}\n\tlet event: \"onExpand\" | \"onCollapse\";\n\tconst isBodyExpanded = isExpanded();\n\n\tif (isBodyExpanded) {\n\t\tif (expandGantt) {\n\t\t\tevent = \"onExpand\";\n\t\t\tsetFullScreenSizes();\n\t\t}\n\t} else if (expandGantt) {\n\t\texpandGantt = false;\n\t\tevent = \"onCollapse\";\n\t\trestoreSizes();\n\t}\n\tsetTimeout(() => {\n\t\tgantt.render();\n\t});\n\tsetTimeout(() => {\n\t\tgantt.callEvent(event, [gantt.ext.fullscreen.getFullscreenElement()]);\n\t});\n}\n\nfunction cantFullscreen() {\n\tif (!gantt.$container) { // check is gantt initialized or not\n\t\treturn true;\n\t}\n\tif (!gantt.ext.fullscreen.getFullscreenElement()) {\n\t\treturn true;\n\t}\n\tif (!isFullscreenAvailable()) {\n\t\t// eslint-disable-next-line no-console\n\t\tconst method = (console as IConsole).warning || console.log;\n\t\tmethod(\"The `fullscreen` feature not being allowed, or full-screen mode not being supported\");\n\t\treturn true;\n\t}\n\treturn false;\n}\n\ngantt.ext.fullscreen = {\n\texpand(): void {\n\t\tif (cantFullscreen()) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (isExpanded()) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!gantt.callEvent(\"onBeforeExpand\", [this.getFullscreenElement()])) {\n\t\t\treturn;\n\t\t}\n\t\texpandGantt = true;\n\n\t\t// we switch body to fullscreen and then expand fullscreen element to viewport\n\t\t// we do it to correct display common elements: lightboxes, tooltip etc.\n\t\tconst element = document.body as IBody;\n\t\tconst requestArguments = element.webkitRequestFullscreen ?\n\t\t\t[(Element as unknown as IElement).ALLOW_KEYBOARD_INPUT] : [];\n\n\t\tconst requestFullscreen = element.msRequestFullscreen ||\n\t\t\telement.mozRequestFullScreen ||\n\t\t\telement.webkitRequestFullscreen ||\n\t\t\telement.requestFullscreen;\n\n\t\tif (requestFullscreen) {\n\t\t\trequestFullscreen.apply(element, requestArguments);\n\t\t}\n\t},\n\tcollapse(): void {\n\t\tif (cantFullscreen()) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!isExpanded()) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!gantt.callEvent(\"onBeforeCollapse\", [this.getFullscreenElement()])) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst requestExitFullscreen = (document as IDocument).msExitFullscreen ||\n\t\t\t(document as IDocument).mozCancelFullScreen ||\n\t\t\t(document as IDocument).webkitExitFullscreen ||\n\t\t\t(document as IDocument).exitFullscreen;\n\n\t\tif (requestExitFullscreen) {\n\t\t\trequestExitFullscreen.apply(document);\n\t\t}\n\t},\n\ttoggle(): void {\n\t\tif (cantFullscreen()) {\n\t\t\treturn;\n\t\t}\n\t\tif (!isExpanded()) {\n\t\t\tthis.expand();\n\t\t} else {\n\t\t\tthis.collapse();\n\t\t}\n\n\t},\n\tgetFullscreenElement(): HTMLElement {\n\t\treturn gantt.$root;\n\t}\n};\n\ngantt.expand = function() {\n\tgantt.ext.fullscreen.expand();\n};\n\ngantt.collapse = function(){\n\tgantt.ext.fullscreen.collapse();\n};\n\ngantt.attachEvent(\"onGanttReady\", addDOMEvents);\n\n}","import eventable from \"../utils/eventable\";\nimport * as domHelpers from \"../core/ui/utils/dom_helpers\";\n\nimport keyboard_shortcuts from \"./keyboard_navigation/common/keyboard_shortcuts\";\nimport eventhandler from \"./keyboard_navigation/common/eventhandler\";\nimport trap_modal_focus from \"./keyboard_navigation/common/trap_modal_focus\";\nimport gantt_node from \"./keyboard_navigation/elements/gantt_node\";\nimport nav_node from \"./keyboard_navigation/elements/nav_node\";\nimport header_cell from \"./keyboard_navigation/elements/header_cell\";\nimport task_row from \"./keyboard_navigation/elements/task_row\";\nimport task_cell from \"./keyboard_navigation/elements/task_cell\";\nimport modals from \"./keyboard_navigation/modals\";\nimport core from \"./keyboard_navigation/core\";\n\n\n\nexport default function(gantt){\n\tfunction setupKeyNav(gantt){\n\t\tgantt.config.keyboard_navigation = true;\n\t\tgantt.config.keyboard_navigation_cells = false;\n\n\t\tgantt.$keyboardNavigation = {};\n\n\t\tgantt._compose = function(){\n\t\t\tvar parts = Array.prototype.slice.call(arguments, 0);\n\t\t\tvar res = {};\n\t\t\tfor(var i = 0; i < parts.length; i++){\n\t\t\t\tvar obj = parts[i];\n\t\t\t\tif(typeof obj == \"function\"){\n\t\t\t\t\tobj = new obj();\n\t\t\t\t}\n\n\t\t\t\tfor(var p in obj){\n\t\t\t\t\tres[p] = obj[p];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn res;\n\t\t};\n\n\t\tkeyboard_shortcuts(gantt);\n\t\teventhandler(gantt);\n\t\ttrap_modal_focus(gantt);\n\t\tgantt_node(gantt);\n\t\tnav_node(gantt);\n\t\theader_cell(gantt);\n\t\ttask_row(gantt);\n\t\ttask_cell(gantt);\n\t\tmodals(gantt);\n\t\tcore(gantt);\n\n\n\t\t(function(){\n\t\t\tvar dispatcher = gantt.$keyboardNavigation.dispatcher;\n\n\t\t\tdispatcher.isTaskFocused = function(id){\n\t\t\t\tvar node = dispatcher.activeNode;\n\t\t\t\tif(node instanceof gantt.$keyboardNavigation.TaskRow || node instanceof gantt.$keyboardNavigation.TaskCell) {\n\t\t\t\t\tif (node.taskId == id) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t};\n\n\t\t\tvar keyDownHandler = function(e){\n\t\t\t\tif(!gantt.config.keyboard_navigation) return;\n\t\t\t\t// GS-734 & GS-1078: we don't need keyboard navigation inside inline editors\n\t\t\t\tif(!gantt.config.keyboard_navigation_cells && isInlineEditorCell(e)) return;\n\n\t\t\t\tif (isNoKeyboardNavigationElement(e) || isLightboxElement(e)){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\treturn dispatcher.keyDownHandler(e);\n\t\t\t};\n\n\t\t\tvar focusHandler = function(e){\n\t\t\t\tif(dispatcher.$preventDefault){\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tgantt.$container.blur();\n\t\t\t\t\treturn false;\n\t\t\t\t// do nothing if key-nav focus is already planned\n\t\t\t\t} else if (!dispatcher.awaitsFocus()) {\n\t\t\t\t\t// otherwise - re-focus key-nav element on gantt focus\n\t\t\t\t\tdispatcher.focusGlobalNode();\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t\tvar reFocusActiveNode = function(){\n\t\t\t\tif(!dispatcher.isEnabled())\n\t\t\t\t\treturn;\n\n\t\t\t\tconst outsideGantt = !domHelpers.isChildOf(document.activeElement, gantt.$container) && document.activeElement.localName != \"body\";\n\t\t\t\tvar activeNode = dispatcher.getActiveNode();\n\t\t\t\tif(!activeNode || outsideGantt)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar domElement = activeNode.getNode();\n\t\t\t\tvar top, left;\n\t\t\t\tif(domElement && domElement.parentNode){\n\t\t\t\t\ttop = domElement.parentNode.scrollTop;\n\t\t\t\t\tleft = domElement.parentNode.scrollLeft;\n\n\t\t\t\t}\n\n\t\t\t\tactiveNode.focus(true);\n\n\t\t\t\tif(domElement && domElement.parentNode){\n\t\t\t\t\tdomElement.parentNode.scrollTop = top;\n\t\t\t\t\tdomElement.parentNode.scrollLeft = left;\n\t\t\t\t}\n\t\t\t};\n\n\n\t\t\tgantt.attachEvent(\"onDataRender\", function(){\n\t\t\t\tif(!gantt.config.keyboard_navigation) return;\n\t\t\t\treFocusActiveNode();\n\t\t\t});\n\n\t\t\tgantt.attachEvent(\"onGanttRender\", function(){\n\t\t\t\t//GS-2230: in case if `getGanttInstance` created without container\n\t\t\t\tif(!gantt.$root) return;\n\t\t\t\tgantt.eventRemove(gantt.$root, \"keydown\", keyDownHandler);\n\t\t\t\tgantt.eventRemove(gantt.$container, \"focus\", focusHandler);\n\t\t\t\tgantt.eventRemove(gantt.$container, \"mousedown\", mousedownHandler);\n\n\t\t\t\tif(gantt.config.keyboard_navigation){\n\n\t\t\t\t\tgantt.event(gantt.$root, \"keydown\", keyDownHandler);\n\t\t\t\t\tgantt.event(gantt.$container, \"focus\", focusHandler);\n\t\t\t\t\tgantt.event(gantt.$container, \"mousedown\", mousedownHandler);\n\t\t\t\t\tgantt.$container.setAttribute(\"tabindex\", \"0\");\n\n\t\t\t\t}else{\n\t\t\t\t\tgantt.$container.removeAttribute(\"tabindex\");\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tfunction getTaskNodeConstructor(){\n\t\t\t\tif (gantt.config.keyboard_navigation_cells) {\n\t\t\t\t\treturn gantt.$keyboardNavigation.TaskCell;\n\t\t\t\t} else {\n\t\t\t\t\treturn gantt.$keyboardNavigation.TaskRow;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction isInlineEditorCell(e){\n\t\t\t\treturn !!domHelpers.closest(e.target, \".gantt_grid_editor_placeholder\");\n\t\t\t}\n\t\t\t// GS-1445. Cancel keyboard navigation within custom elements\n\t\t\tfunction isNoKeyboardNavigationElement(e){\n\t\t\t\treturn !!domHelpers.closest(e.target, \".no_keyboard_navigation\");\n\t\t\t}\n\t\t\tfunction isLightboxElement(e){\n\t\t\t\treturn !!domHelpers.closest(e.target, \".gantt_cal_light\");\n\t\t\t}\n\n\t\t\tfunction mousedownHandler(e){\n\t\t\t\tif(!gantt.config.keyboard_navigation) return true;\n\t\t\t\t// GS-734 & GS-1078: we don't need keyboard navigation inside inline editors\n\t\t\t\tif(!gantt.config.keyboard_navigation_cells && isInlineEditorCell(e)) return true;\n\n\t\t\t\tif (isNoKeyboardNavigationElement(e)){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar focusNode;\n\t\t\t\tvar locateTask = dispatcher.fromDomElement(e);\n\t\t\t\tif(locateTask){\n\t\t\t\t\t//var node = getTaskNodeConstructor();\n\t\t\t\t\tif(dispatcher.activeNode instanceof gantt.$keyboardNavigation.TaskCell && domHelpers.isChildOf(e.target, gantt.$task)){\n\t\t\t\t\t\tlocateTask = new gantt.$keyboardNavigation.TaskCell(locateTask.taskId, dispatcher.activeNode.columnIndex);\n\t\t\t\t\t}\n\t\t\t\t\tfocusNode = locateTask;\n\t\t\t\t\t// GS-1541 and GS-1542. If you click on the task row element (possible with custom styles)\n\t\t\t\t\t// or the task bar element, there is no information about the target grid cell,\n\t\t\t\t\t// so we need to set focus on the first visible cell\n\t\t\t\t\tconst visibleGrid = gantt.config.show_grid && gantt.$ui.getView(\"grid\");\n\t\t\t\t\tif(visibleGrid && gantt.config.keyboard_navigation_cells){\n\t\t\t\t\t\tconst taskRow = e.target.classList.contains(\"gantt_row\");\n\t\t\t\t\t\tconst taskBar = e.target.closest(\".gantt_task_line\");\n\n\t\t\t\t\t\tconst gridLeft = gantt.utils.dom.getNodePosition(gantt.$grid).x;\n\t\t\t\t\t\tconst gridRight = gridLeft + gantt.$grid.offsetWidth;\n\t\t\t\t\t\tconst nodePosition = gantt.utils.dom.getNodePosition(document.activeElement).x;\n\t\t\t\t\t\tconst nodeHidden = nodePosition < gridLeft || gridRight < nodePosition;\n\n\t\t\t\t\t\tif (taskRow || (taskBar && nodeHidden)){\n\t\t\t\t\t\t\tlet scrollPosition = gantt.$grid.scrollLeft;\n\t\t\t\t\t\t\tconst rightPosition = scrollPosition + gantt.$grid.offsetWidth;\n\t\t\t\t\t\t\tlet positionX = 0;\n\t\t\t\t\t\t\tif (taskRow){\n\t\t\t\t\t\t\t\tscrollPosition = gantt.utils.dom.getRelativeEventPosition(e, gantt.$grid).x;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfor (let i = 0; i < gantt.config.columns.length; i++) {\n\t\t\t\t\t\t\t\tconst column = gantt.config.columns[i];\n\t\t\t\t\t\t\t\tif (column.hide){\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tpositionX += column.width;\n\t\t\t\t\t\t\t\tif (scrollPosition < positionX){\n\t\t\t\t\t\t\t\t\tif (rightPosition < positionX){\n\t\t\t\t\t\t\t\t\t\tpositionX -= column.width;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tfocusNode.columnIndex = i;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (focusNode) {\n\t\t\t\t\tif (!dispatcher.isEnabled()) {\n\t\t\t\t\t\tdispatcher.activeNode = focusNode;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdispatcher.delay(function () {\n\t\t\t\t\t\t\tdispatcher.setActiveNode(focusNode);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// empty click should drop focus from gantt, insert of reselecting default node\n\t\t\t\t\tdispatcher.$preventDefault = true;\n\t\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t\tdispatcher.$preventDefault = false;\n\t\t\t\t\t}, 300);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar onReady = gantt.attachEvent(\"onGanttReady\", function(){\n\t\t\t\t// restore focus on repainted tasks\n\t\t\t\tgantt.detachEvent(onReady);\n\n\t\t\t\tgantt.$data.tasksStore.attachEvent(\"onStoreUpdated\", function(id){\n\t\t\t\t\tif (gantt.config.keyboard_navigation && dispatcher.isEnabled()) {\n\t\t\t\t\t\tconst currentNode = dispatcher.getActiveNode();\n\t\t\t\t\t\tconst grid = gantt.$ui.getView(\"grid\");\n\t\t\t\t\t\tif (!grid || !grid.$grid_data){\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst top = grid.getItemTop(id);\n\t\t\t\t\t\tconst gridDataTopScroll = grid.$grid_data.scrollTop;\n\t\t\t\t\t\tconst gridDataBottomScroll = gridDataTopScroll + grid.$grid_data.getBoundingClientRect().height;\n\t\t\t\t\t\tif(currentNode && currentNode.taskId == id){\n\t\t\t\t\t\t\t// GS-2539: Don't refocus the node if it is selected and outside the visible range in the grid\n\t\t\t\t\t\t\tif(gridDataTopScroll <= top && gridDataBottomScroll >= top){\n\t\t\t\t\t\t\t\treFocusActiveNode();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif(gantt._smart_render){\n\t\t\t\t\tvar updateRender = gantt._smart_render._redrawTasks;\n\t\t\t\t\tgantt._smart_render._redrawTasks = function(renderers, items){\n\t\t\t\t\t\tif(gantt.config.keyboard_navigation && dispatcher.isEnabled()){\n\t\t\t\t\t\t\tvar currentNode = dispatcher.getActiveNode();\n\t\t\t\t\t\t\tif(currentNode && currentNode.taskId !== undefined){\n\t\t\t\t\t\t\t\tvar focusedItemVisible = false;\n\t\t\t\t\t\t\t\tfor(var i = 0; i < items.length; i++){\n\t\t\t\t\t\t\t\t\tif(items[i].id == currentNode.taskId && items[i].start_date){\n\t\t\t\t\t\t\t\t\t\tfocusedItemVisible = true;\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(!focusedItemVisible){\n\t\t\t\t\t\t\t\t\titems.push(gantt.getTask(currentNode.taskId));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar res = updateRender.apply(this, arguments);\n\n\t\t\t\t\t\treturn res;\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t});\n\n\n\t\t\tlet createdTaskId = null;\n\t\t\tlet keepFocusOnNewTask = false;\n\t\t\tgantt.attachEvent(\"onTaskCreated\", function (task) {\n\t\t\t\tcreatedTaskId = task.id;\n\t\t\t\treturn true;\n\t\t\t});\n\n\t\t\tgantt.attachEvent(\"onAfterTaskAdd\", function(id,item){\n\t\t\t\tif(!gantt.config.keyboard_navigation) return true;\n\t\t\t\tif(dispatcher.isEnabled()){\n\n\t\t\t\t\t// GS-1394. After adding a new task, the focus shouldn't change to the placeholder task\n\t\t\t\t\tif (id == createdTaskId) {\n\t\t\t\t\t\tkeepFocusOnNewTask = true;\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tkeepFocusOnNewTask = false;\n\t\t\t\t\t\t\tcreatedTaskId = null;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tif (keepFocusOnNewTask && item.type == gantt.config.types.placeholder) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar columnIndex = 0;\n\t\t\t\t\tvar node = dispatcher.activeNode;\n\t\t\t\t\tif(node instanceof gantt.$keyboardNavigation.TaskCell){\n\t\t\t\t\t\tcolumnIndex = node.columnIndex;\n\t\t\t\t\t}\n\t\t\t\t\tvar nodeConstructor = getTaskNodeConstructor();\n\n\t\t\t\t\tif (item.type == gantt.config.types.placeholder && gantt.config.placeholder_task.focusOnCreate === false) {\n\t\t\t\t\t\t// do not focus on the placeholder task\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdispatcher.setActiveNode(new nodeConstructor(id, columnIndex));\n\t\t\t\t\t}\n\n\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tgantt.attachEvent(\"onTaskIdChange\", function(oldId, newId){\n\t\t\t\tif(!gantt.config.keyboard_navigation) return true;\n\n\t\t\t\tvar node = dispatcher.activeNode;\n\t\t\t\tif(dispatcher.isTaskFocused(oldId)){\n\t\t\t\t\tnode.taskId = newId;\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t});\n\n\t\t\tvar interval = setInterval(function(){\n\t\t\t\tif(!gantt.config.keyboard_navigation) return;\n\t\t\t\tif(!dispatcher.isEnabled()){\n\t\t\t\t\tdispatcher.enable();\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}, 500);\n\n\t\t\tgantt.attachEvent(\"onDestroy\", function(){\n\t\t\t\tclearInterval(interval);\n\t\t\t});\n\n\t\t\tfunction getScopeName(obj){\n\t\t\t\tif(obj instanceof gantt.$keyboardNavigation.GanttNode){\n\t\t\t\t\treturn \"gantt\";\n\t\t\t\t}else if(obj instanceof gantt.$keyboardNavigation.HeaderCell){\n\t\t\t\t\treturn \"headerCell\";\n\t\t\t\t}else if(obj instanceof gantt.$keyboardNavigation.TaskRow){\n\t\t\t\t\treturn \"taskRow\";\n\t\t\t\t}else if(obj instanceof gantt.$keyboardNavigation.TaskCell){\n\t\t\t\t\treturn \"taskCell\";\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tfunction getScope(mode){\n\t\t\t\tvar scopes = {\n\t\t\t\t\t\"gantt\":gantt.$keyboardNavigation.GanttNode,\n\t\t\t\t\t\"headerCell\": gantt.$keyboardNavigation.HeaderCell,\n\t\t\t\t\t\"taskRow\": gantt.$keyboardNavigation.TaskRow,\n\t\t\t\t\t\"taskCell\": gantt.$keyboardNavigation.TaskCell\n\t\t\t\t};\n\n\t\t\t\treturn scopes[mode] || scopes.gantt;\n\t\t\t}\n\n\t\t\tfunction findVisibleColumnIndex(columnName) {\n\t\t\t\tvar columns = gantt.getGridColumns();\n\t\t\t\tfor (var i = 0; i < columns.length; i++){\n\t\t\t\t\tif(columns[i].name == columnName){\n\t\t\t\t\t\treturn i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tvar keyNavFacade = {};\n\t\t\teventable(keyNavFacade);\n\t\t\tgantt.mixin(keyNavFacade, {\n\t\t\t\taddShortcut: function(shortcut, handler, scope){\n\t\t\t\t\tvar scopeObject = getScope(scope);\n\t\t\t\t\tif(scopeObject){\n\t\t\t\t\t\tscopeObject.prototype.bind(shortcut, handler);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tgetShortcutHandler: function(shortcut, scope){\n\t\t\t\t\tvar commands = gantt.$keyboardNavigation.shortcuts.parse(shortcut);\n\t\t\t\t\tif(commands.length){\n\t\t\t\t\t\treturn keyNavFacade.getCommandHandler(commands[0], scope);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tgetCommandHandler: function(command, scope){\n\t\t\t\t\tvar scopeObject = getScope(scope);\n\t\t\t\t\tif(scopeObject){\n\t\t\t\t\t\tif(command){\n\t\t\t\t\t\t\treturn scopeObject.prototype.findHandler(command);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tremoveShortcut: function(shortcut, scope){\n\t\t\t\t\tvar scopeObject = getScope(scope);\n\t\t\t\t\tif(scopeObject){\n\t\t\t\t\t\tscopeObject.prototype.unbind(shortcut);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tfocus: function(config){\n\t\t\t\t\tvar type = config ? config.type : null;\n\t\t\t\t\tvar constructor = getScope(type);\n\t\t\t\t\tvar node;\n\t\t\t\t\tswitch (type){\n\t\t\t\t\t\tcase \"taskCell\":\n\t\t\t\t\t\t\tnode = new constructor(config.id, findVisibleColumnIndex(config.column));\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"taskRow\":\n\t\t\t\t\t\t\tnode = new constructor(config.id);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"headerCell\":\n\t\t\t\t\t\t\tnode = new constructor(findVisibleColumnIndex(config.column));\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tdispatcher.delay(function(){\n\t\t\t\t\t\tif(node){\n\t\t\t\t\t\t\tdispatcher.setActiveNode(node);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tdispatcher.enable();\n\t\t\t\t\t\t\tif(!dispatcher.getActiveNode()){\n\n\t\t\t\t\t\t\t\tdispatcher.setDefaultNode();\n\t\t\t\t\t\t\t}else{\n\n\t\t\t\t\t\t\t\tif(!dispatcher.awaitsFocus()){\n\t\t\t\t\t\t\t\t\tdispatcher.enable();\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\tgetActiveNode: function(){\n\t\t\t\t\tif(dispatcher.isEnabled()){\n\t\t\t\t\t\tvar node = dispatcher.getActiveNode();\n\t\t\t\t\t\tvar scope = getScopeName(node);\n\t\t\t\t\t\tvar columns = gantt.getGridColumns();\n\t\t\t\t\t\tswitch (scope){\n\t\t\t\t\t\t\tcase \"taskCell\":\n\t\t\t\t\t\t\t\treturn {type:\"taskCell\", id:node.taskId, column:columns[node.columnIndex].name};\n\t\t\t\t\t\t\tcase \"taskRow\":\n\t\t\t\t\t\t\t\treturn {type:\"taskRow\", id:node.taskId};\n\t\t\t\t\t\t\tcase \"headerCell\":\n\t\t\t\t\t\t\t\treturn {type:\"headerCell\", column:columns[node.index].name};\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tgantt.$keyboardNavigation.facade = keyNavFacade;\n\n\t\t\tgantt.ext.keyboardNavigation = keyNavFacade;\n\t\t\tgantt.focus = function(){\n\t\t\t\tkeyNavFacade.focus();\n\t\t\t};\n\t\t\tgantt.addShortcut = keyNavFacade.addShortcut;\n\t\t\tgantt.getShortcutHandler = keyNavFacade.getShortcutHandler;\n\t\t\tgantt.removeShortcut = keyNavFacade.removeShortcut;\n\t\t})();\n\n\n\t}\n\n\tsetupKeyNav(gantt);\n\n\n\n};","export default function(gantt) {\n\n\tgantt.$keyboardNavigation.shortcuts = {\n\t\tcreateCommand: function () {\n\t\t\treturn {\n\t\t\t\tmodifiers: {\n\t\t\t\t\t\"shift\": false,\n\t\t\t\t\t\"alt\": false,\n\t\t\t\t\t\"ctrl\": false,\n\t\t\t\t\t\"meta\": false\n\t\t\t\t},\n\t\t\t\tkeyCode: null\n\t\t\t};\n\t\t},\n\t\tparse: function (shortcut) {\n\t\t\tvar commands = [];\n\n\t\t\tvar expr = this.getExpressions(this.trim(shortcut));\n\t\t\tfor (var i = 0; i < expr.length; i++) {\n\t\t\t\tvar words = this.getWords(expr[i]);\n\n\t\t\t\tvar command = this.createCommand();\n\n\t\t\t\tfor (var j = 0; j < words.length; j++) {\n\t\t\t\t\tif (this.commandKeys[words[j]]) {\n\t\t\t\t\t\tcommand.modifiers[words[j]] = true;\n\t\t\t\t\t} else if (this.specialKeys[words[j]]) {\n\t\t\t\t\t\tcommand.keyCode = this.specialKeys[words[j]];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcommand.keyCode = words[j].charCodeAt(0);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tcommands.push(command);\n\t\t\t}\n\t\t\treturn commands;\n\t\t},\n\n\t\tgetCommandFromEvent: function (domEvent) {\n\t\t\tvar command = this.createCommand();\n\t\t\tcommand.modifiers.shift = !!domEvent.shiftKey;\n\t\t\tcommand.modifiers.alt = !!domEvent.altKey;\n\t\t\tcommand.modifiers.ctrl = !!domEvent.ctrlKey;\n\t\t\tcommand.modifiers.meta = !!domEvent.metaKey;\n\t\t\tcommand.keyCode = domEvent.which || domEvent.keyCode;\n\n\t\t\tif(command.keyCode >= 96 && command.keyCode <= 105){\n\t\t\t\t// numpad keys 96-105 -> 48-57\n\t\t\t\tcommand.keyCode -= 48;//convert numpad  number code to regular number code\n\t\t\t}\n\n\t\t\tvar printableKey = String.fromCharCode(command.keyCode);\n\t\t\tif (printableKey) {\n\t\t\t\tcommand.keyCode = printableKey.toLowerCase().charCodeAt(0);\n\t\t\t}\n\t\t\treturn command;\n\t\t},\n\n\t\tgetHashFromEvent: function (domEvent) {\n\t\t\treturn this.getHash(this.getCommandFromEvent(domEvent));\n\t\t},\n\n\t\tgetHash: function (command) {\n\t\t\tvar parts = [];\n\t\t\tfor (var i in command.modifiers) {\n\t\t\t\tif (command.modifiers[i]) {\n\t\t\t\t\tparts.push(i);\n\t\t\t\t}\n\t\t\t}\n\t\t\tparts.push(command.keyCode);\n\n\t\t\treturn parts.join(this.junctionChar);\n\t\t},\n\n\t\tgetExpressions: function (shortcut) {\n\t\t\treturn shortcut.split(this.junctionChar);\n\t\t},\n\t\tgetWords: function (term) {\n\t\t\treturn term.split(this.combinationChar);\n\t\t},\n\t\ttrim: function (shortcut) {\n\t\t\treturn shortcut.replace(/\\s/g, \"\");\n\t\t},\n\t\tjunctionChar: \",\",\n\t\tcombinationChar: \"+\",\n\t\tcommandKeys: {\n\t\t\t\"shift\": 16,\n\t\t\t\"alt\": 18,\n\t\t\t\"ctrl\": 17,\n\t\t\t\"meta\": true\n\t\t},\n\t\tspecialKeys: {\n\t\t\t\"backspace\": 8,\n\t\t\t\"tab\": 9,\n\t\t\t\"enter\": 13,\n\t\t\t\"esc\": 27,\n\t\t\t\"space\": 32,\n\t\t\t\"up\": 38,\n\t\t\t\"down\": 40,\n\t\t\t\"left\": 37,\n\t\t\t\"right\": 39,\n\t\t\t\"home\": 36,\n\t\t\t\"end\": 35,\n\t\t\t\"pageup\": 33,\n\t\t\t\"pagedown\": 34,\n\t\t\t\"delete\": 46,\n\t\t\t\"insert\": 45,\n\t\t\t\"plus\": 107,\n\t\t\t\"f1\": 112,\n\t\t\t\"f2\": 113,\n\t\t\t\"f3\": 114,\n\t\t\t\"f4\": 115,\n\t\t\t\"f5\": 116,\n\t\t\t\"f6\": 117,\n\t\t\t\"f7\": 118,\n\t\t\t\"f8\": 119,\n\t\t\t\"f9\": 120,\n\t\t\t\"f10\": 121,\n\t\t\t\"f11\": 122,\n\t\t\t\"f12\": 123\n\t\t}\n\t};\n};","export default function(gantt) {\n\n\tgantt.$keyboardNavigation.EventHandler = {\n\t\t_handlers: null,\n\t\tfindHandler: function (command) {\n\t\t\tif (!this._handlers) this._handlers = {};\n\t\t\tvar shortcuts = gantt.$keyboardNavigation.shortcuts;\n\t\t\tvar hash = shortcuts.getHash(command);\n\n\t\t\treturn this._handlers[hash];\n\t\t},\n\n\t\tdoAction: function (command, e) {\n\t\t\tvar handler = this.findHandler(command);\n\t\t\tif (handler) {\n\t\t\t\tvar eventFacade = gantt.$keyboardNavigation.facade;\n\n\t\t\t\tif(eventFacade.callEvent(\"onBeforeAction\", [command, e]) === false){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\thandler.call(this, e);\n\n\t\t\t\tif (e.preventDefault) e.preventDefault();\n\t\t\t\telse e.returnValue = false;\n\n\t\t\t}\n\t\t},\n\t\tbind: function (shortcut, handler) {\n\t\t\tif (!this._handlers) this._handlers = {};\n\n\t\t\tvar shortcuts = gantt.$keyboardNavigation.shortcuts;\n\n\t\t\tvar commands = shortcuts.parse(shortcut);\n\t\t\tfor (var i = 0; i < commands.length; i++) {\n\t\t\t\tthis._handlers[shortcuts.getHash(commands[i])] = handler;\n\t\t\t}\n\t\t},\n\t\tunbind: function (shortcut) {\n\t\t\tvar shortcuts = gantt.$keyboardNavigation.shortcuts;\n\n\t\t\tvar commands = shortcuts.parse(shortcut);\n\t\t\tfor (var i = 0; i < commands.length; i++) {\n\t\t\t\tif (this._handlers[shortcuts.getHash(commands[i])]) {\n\t\t\t\t\tdelete this._handlers[shortcuts.getHash(commands[i])];\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tbindAll: function (map) {\n\t\t\tfor (var i in map) {\n\t\t\t\tthis.bind(i, map[i]);\n\t\t\t}\n\t\t},\n\t\tinitKeys: function () {\n\t\t\tif (!this._handlers)\n\t\t\t\tthis._handlers = {};\n\t\t\tif (this.keys) {\n\t\t\t\tthis.bindAll(this.keys);\n\t\t\t}\n\t\t}\n\t};\n\n};","import * as domHelpers from \"../../../core/ui/utils/dom_helpers\";\n\nexport default function(gantt) {\n\n\t(function () {\n\t\t\n\t\tgantt.$keyboardNavigation.getFocusableNodes = domHelpers.getFocusableNodes;\n\n\t\tgantt.$keyboardNavigation.trapFocus = function trapFocus(root, e) {\n\t\t\tif (e.keyCode != 9) return false;\n\n\t\t\tvar focusable = gantt.$keyboardNavigation.getFocusableNodes(root);\n\t\t\tvar currentFocus = domHelpers.getActiveElement();\n\t\t\tvar currentIndex = -1;\n\t\t\tfor (var i = 0; i < focusable.length; i++) {\n\t\t\t\tif (focusable[i] == currentFocus) {\n\t\t\t\t\tcurrentIndex = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (e.shiftKey) {\n\t\t\t\t// back tab\n\t\t\t\tif (currentIndex <= 0) {\n\t\t\t\t\t// go to the last element if we focused on the first\n\t\t\t\t\tvar lastItem = focusable[focusable.length - 1];\n\t\t\t\t\tif (lastItem) {\n\t\t\t\t\t\tlastItem.focus();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\t// forward tab\n\t\t\t\tif (currentIndex >= focusable.length - 1) {\n\t\t\t\t\t// forward tab from last element should go back to the first element\n\t\t\t\t\tvar firstItem = focusable[0];\n\t\t\t\t\tif (firstItem) {\n\t\t\t\t\t\tfirstItem.focus();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t};\n\t})();\n\n};","export default function(gantt) {\n\n\tgantt.$keyboardNavigation.GanttNode = function () {\n\t};\n\n\tgantt.$keyboardNavigation.GanttNode.prototype = gantt._compose(\n\t\tgantt.$keyboardNavigation.EventHandler,\n\t\t{\n\n\t\t\tfocus: function () {\n\t\t\t\tgantt.focus();\n\t\t\t},\n\n\t\t\tblur: function () {\n\n\t\t\t},\n\n\t\t\tisEnabled: function () {\n\t\t\t\treturn gantt.$container.hasAttribute(\"tabindex\");\n\t\t\t},\n\n\t\t\tscrollHorizontal: function scrollHorizontal(dir) {\n\t\t\t\tvar date = gantt.dateFromPos(gantt.getScrollState().x);\n\t\t\t\tvar scale = gantt.getScale();\n\t\t\t\tvar step = dir < 0 ? -scale.step : scale.step;\n\t\t\t\tdate = gantt.date.add(date, step, scale.unit);\n\t\t\t\tgantt.scrollTo(gantt.posFromDate(date));\n\t\t\t},\n\n\t\t\tscrollVertical: function scrollVertical(dir) {\n\t\t\t\tvar top = gantt.getScrollState().y;\n\t\t\t\tvar step = gantt.config.row_height;\n\t\t\t\tgantt.scrollTo(null, top + (dir < 0 ? -1 : 1) * step);\n\t\t\t},\n\n\t\t\tkeys: {\n\t\t\t\t\"alt+left\": function (e) {\n\t\t\t\t\tthis.scrollHorizontal(-1);\n\t\t\t\t},\n\t\t\t\t\"alt+right\": function (e) {\n\t\t\t\t\tthis.scrollHorizontal(1);\n\t\t\t\t},\n\t\t\t\t\"alt+up\": function (e) {\n\t\t\t\t\tthis.scrollVertical(-1);\n\t\t\t\t},\n\t\t\t\t\"alt+down\": function (e) {\n\t\t\t\t\tthis.scrollVertical(1);\n\t\t\t\t},\n\n\t\t\t\t// undo\n\t\t\t\t\"ctrl+z\": function () {\n\t\t\t\t\tif (gantt.undo) gantt.undo();\n\t\t\t\t},\n\n\t\t\t\t// redo\n\t\t\t\t\"ctrl+r\": function () {\n\t\t\t\t\tif (gantt.redo) gantt.redo();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t);\n\n\tgantt.$keyboardNavigation.GanttNode.prototype.bindAll(gantt.$keyboardNavigation.GanttNode.prototype.keys);\n\n};","export default function(gantt) {\n\n\tgantt.$keyboardNavigation.KeyNavNode = function () {\n\t};\n\n\tgantt.$keyboardNavigation.KeyNavNode.prototype = gantt._compose(\n\t\tgantt.$keyboardNavigation.EventHandler,\n\t\t{\n\t\t\tisValid: function () {\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tfallback: function () {\n\t\t\t\treturn null;\n\t\t\t},\n\n\t\t\tmoveTo: function (element) {\n\t\t\t\tgantt.$keyboardNavigation.dispatcher.setActiveNode(element);\n\t\t\t},\n\n\t\t\tcompareTo: function (b) {\n\t\t\t\t// good enough comparison of two random objects\n\t\t\t\tif (!b) return false;\n\t\t\t\tfor (var i in this) {\n\t\t\t\t\tif (!!this[i] != !!b[i]) return false;\n\n\t\t\t\t\tvar canStringifyThis = !!(this[i] && this[i].toString);\n\t\t\t\t\tvar canStringifyThat = !!(b[i] && b[i].toString);\n\t\t\t\t\tif (canStringifyThat != canStringifyThis) return false;\n\t\t\t\t\tif (!(canStringifyThat && canStringifyThis)) {\n\t\t\t\t\t\tif (b[i] != this[i]) return false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (b[i].toString() != this[i].toString())\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t},\n\n\t\t\tgetNode: function () {\n\t\t\t},\n\t\t\tfocus: function () {\n\t\t\t\tvar node = this.getNode();\n\t\t\t\tif(!node)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar eventFacade = gantt.$keyboardNavigation.facade;\n\n\t\t\t\tif(eventFacade.callEvent(\"onBeforeFocus\", [node]) === false){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (node) {\n\t\t\t\t\tnode.setAttribute(\"tabindex\", \"-1\");\n\t\t\t\t\tif(!node.$eventAttached){\n\t\t\t\t\t\tnode.$eventAttached = true;\n\t\t\t\t\t\tgantt.event(node, \"focus\",function(e){\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}, false);\n\t\t\t\t\t}\n\t\t\t\t\t//node.className += \" gantt_focused\";\n\t\t\t\t\tif (gantt.utils.dom.isChildOf(document.activeElement, node)){\n\t\t\t\t\t\tnode = document.activeElement;\n\t\t\t\t\t}\n\t\t\t\t\tif (node.focus) node.focus();\n\n\t\t\t\t\teventFacade.callEvent(\"onFocus\", [this.getNode()]);\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tblur: function () {\n\t\t\t\tvar node = this.getNode();\n\t\t\t\tif (node) {\n\t\t\t\t\tvar eventFacade = gantt.$keyboardNavigation.facade;\n\t\t\t\t\teventFacade.callEvent(\"onBlur\", [node]);\n\t\t\t\t\tnode.setAttribute(\"tabindex\", \"-1\");\n\t\t\t\t\t//node.className = (node.className || \"\").replace(/ ?gantt_focused/g, \"\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t);\n\n};","import * as domHelpers from \"../../../core/ui/utils/dom_helpers\";\n\nexport default function(gantt) {\n\n\tgantt.$keyboardNavigation.HeaderCell = function (index) {\n\t\tthis.index = index || 0;\n\t};\n\n\tgantt.$keyboardNavigation.HeaderCell.prototype = gantt._compose(\n\t\tgantt.$keyboardNavigation.KeyNavNode,\n\t\t{\n\t\t\t_handlers: null,\n\n\t\t\tisValid: function () {\n\t\t\t\tif (!gantt.config.show_grid) {\n\t\t\t\t\tif (gantt.getVisibleTaskCount())\n\t\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn !!gantt.getGridColumns()[this.index] || !gantt.getVisibleTaskCount();\n\t\t\t},\n\t\t\tfallback: function () {\n\t\t\t\tif (!gantt.config.show_grid) {\n\t\t\t\t\tif (gantt.getVisibleTaskCount()) {\n\t\t\t\t\t\treturn new gantt.$keyboardNavigation.TaskRow();\n\t\t\t\t\t}\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\tvar visibleColumns = gantt.getGridColumns();\n\t\t\t\tvar index = this.index;\n\t\t\t\twhile (index >= 0) {\n\t\t\t\t\tif (visibleColumns[index])\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tindex--;\n\t\t\t\t}\n\t\t\t\tif (visibleColumns[index]) {\n\t\t\t\t\treturn new gantt.$keyboardNavigation.HeaderCell(index);\n\t\t\t\t} else {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tfromDomElement: function(el){\n\t\t\t\tvar cellElement = domHelpers.locateClassName(el, \"gantt_grid_head_cell\");\n\t\t\t\tif(cellElement){\n\t\t\t\t\tvar index = 0;\n\t\t\t\t\twhile(cellElement && cellElement.previousSibling){\n\t\t\t\t\t\tcellElement = cellElement.previousSibling;\n\t\t\t\t\t\tindex += 1;\n\t\t\t\t\t}\n\t\t\t\t\treturn new gantt.$keyboardNavigation.HeaderCell(index);\n\t\t\t\t}else{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tgetNode: function () {\n\t\t\t\tconst scale = gantt.$grid_scale;\n\t\t\t\tif (!scale){\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\tconst cells = scale.childNodes;\n\t\t\t\treturn cells[this.index];\n\t\t\t},\n\n\n\t\t\tkeys: {\n\n\t\t\t\t\"left\": function () {\n\t\t\t\t\tif (this.index > 0) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.HeaderCell(this.index - 1));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"right\": function () {\n\t\t\t\t\tvar columns = gantt.getGridColumns();\n\t\t\t\t\tif (this.index < columns.length - 1) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.HeaderCell(this.index + 1));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"down\": function () {\n\t\t\t\t\tvar taskRow;\n\t\t\t\t\tvar rootLevel = gantt.getChildren(gantt.config.root_id);\n\t\t\t\t\tif (gantt.isTaskExists(rootLevel[0])) {\n\t\t\t\t\t\ttaskRow = rootLevel[0];\n\t\t\t\t\t}\n\t\t\t\t\tif (taskRow) {\n\t\t\t\t\t\tif (gantt.config.keyboard_navigation_cells) {\n\t\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(taskRow, this.index));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskRow(taskRow));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\t\"end\": function () {\n\t\t\t\t\tvar columns = gantt.getGridColumns();\n\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.HeaderCell(columns.length - 1));\n\t\t\t\t},\n\t\t\t\t\"home\": function () {\n\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.HeaderCell(0));\n\t\t\t\t},\n\n\n\t\t\t\t// press header button\n\t\t\t\t\"enter, space\": function () {\n\t\t\t\t\tvar node = domHelpers.getActiveElement();\n\t\t\t\t\tnode.click();\n\t\t\t\t},\n\n\t\t\t\t// add new task\n\t\t\t\t\"ctrl+enter\": function () {\n\t\t\t\t\tif (gantt.isReadonly(this)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tgantt.createTask({}, this.taskId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t);\n\n\tgantt.$keyboardNavigation.HeaderCell.prototype.bindAll(gantt.$keyboardNavigation.HeaderCell.prototype.keys);\n\n};","export default function(gantt) {\n\n\tgantt.$keyboardNavigation.TaskRow = function (taskId) {\n\t\tif (!taskId) {\n\t\t\tvar rootLevel = gantt.getChildren(gantt.config.root_id);\n\t\t\tif (rootLevel[0]) {\n\t\t\t\ttaskId = rootLevel[0];\n\t\t\t}\n\t\t}\n\t\tthis.taskId = taskId;\n\t\tif (gantt.isTaskExists(this.taskId)) {\n\t\t\tthis.index = gantt.getTaskIndex(this.taskId);\n\t\t\tthis.globalIndex = gantt.getGlobalTaskIndex(this.taskId);\n\t\t\tthis.splitItem = !!gantt.getTask(this.taskId).$split_subtask;\n\t\t\tthis.parentId = gantt.getParent(this.taskId);\n\t\t}\n\t};\n\n\tgantt.$keyboardNavigation.TaskRow.prototype = gantt._compose(\n\t\tgantt.$keyboardNavigation.KeyNavNode,\n\t\t{\n\t\t\t_handlers: null,\n\t\t\tisValid: function () {\n\t\t\t\treturn gantt.isTaskExists(this.taskId) && (gantt.getTaskIndex(this.taskId) > -1);\n\t\t\t},\n\t\t\tfallback: function () {\n\t\t\t\tif (!gantt.getVisibleTaskCount()) {\n\t\t\t\t\tvar header = new gantt.$keyboardNavigation.HeaderCell();\n\t\t\t\t\tif (!header.isValid()) return null;\n\t\t\t\t\telse return header;\n\t\t\t\t} else {\n\n\t\t\t\t\tif(!this.splitItem){\n\t\t\t\t\t\tvar nextIndex = -1;\n\t\t\t\t\t\t// GS-1393. When Gantt tries to restore the focus, it should rely on the global index\n\t\t\t\t\t\tif (gantt.getTaskByIndex(this.globalIndex - 1)) {\n\t\t\t\t\t\t\tnextIndex = this.globalIndex - 1;\n\t\t\t\t\t\t} else if (gantt.getTaskByIndex(this.globalIndex + 1)) {\n\t\t\t\t\t\t\tnextIndex = this.globalIndex + 1;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar globalIndex = this.globalIndex;\n\t\t\t\t\t\t\twhile (globalIndex >= 0) {\n\t\t\t\t\t\t\t\tif (gantt.getTaskByIndex(globalIndex)) {\n\t\t\t\t\t\t\t\t\tnextIndex = globalIndex;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tglobalIndex--;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (nextIndex > -1) {\n\t\t\t\t\t\t\treturn new gantt.$keyboardNavigation.TaskRow(gantt.getTaskByIndex(nextIndex).id);\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\treturn new gantt.$keyboardNavigation.TaskRow(this.parentId);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tfromDomElement: function(el){\n\t\t\t\tif(gantt.config.keyboard_navigation_cells){\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tvar taskId = gantt.locate(el);\n\t\t\t\tif(gantt.isTaskExists(taskId)){\n\t\t\t\t\treturn new gantt.$keyboardNavigation.TaskRow(taskId);\n\t\t\t\t}else{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tgetNode: function () {\n\t\t\t\tif (gantt.isTaskExists(this.taskId) && gantt.isTaskVisible(this.taskId)) {\n\t\t\t\t\tif (gantt.config.show_grid) {\n\t\t\t\t\t\treturn gantt.$grid.querySelector(`.gantt_row[${gantt.config.task_attribute}=\"${String(this.taskId).replaceAll('\"', '\\\\\"')}\"]`);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn gantt.getTaskNode(this.taskId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tfocus: function (keptFocus) {\n\t\t\t\tif(!keptFocus) {\n\t\t\t\t\tconst pos = gantt.getTaskPosition(gantt.getTask(this.taskId));\n\t\t\t\t\tconst height = gantt.getTaskHeight(this.taskId);\n\t\t\t\t\tconst scroll = gantt.getScrollState();\n\n\t\t\t\t\tlet viewWidth;\n\t\t\t\t\tif(gantt.$task){\n\t\t\t\t\t\tviewWidth = gantt.$task.offsetWidth;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tviewWidth = scroll.inner_width;\n\t\t\t\t\t}\n\n\t\t\t\t\tlet viewHeight;\n\t\t\t\t\tif(gantt.$grid_data || gantt.$task_data){\n\t\t\t\t\t\tviewHeight = (gantt.$grid_data || gantt.$task_data).offsetHeight;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tviewHeight = scroll.inner_height;\n\t\t\t\t\t}\n\t\t\t\t\tconst visibleTimeline = gantt.config.show_chart && gantt.$ui.getView(\"timeline\");\n\n\t\t\t\t\tif (pos.top < scroll.y || pos.top + height > (scroll.y + viewHeight)) {\n\t\t\t\t\t\t// GS-2346: additional scrolling to be sure that the task will be in the required range\n\t\t\t\t\t\tgantt.scrollTo(null, pos.top - 20);\n\t\t\t\t\t} else if (gantt.config.scroll_on_click && visibleTimeline) {\n\t\t\t\t\t\t// horizontal scroll activated\n\t\t\t\t\t\tif (pos.left > (scroll.x + viewWidth)) { // scroll forward to the start of the task\n\t\t\t\t\t\t\tgantt.scrollTo(pos.left - gantt.config.task_scroll_offset);\n\t\t\t\t\t\t} else if (pos.left + pos.width < scroll.x) {  // scroll back to the end of the task\n\t\t\t\t\t\t\tgantt.scrollTo(pos.left + pos.width - gantt.config.task_scroll_offset);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tgantt.$keyboardNavigation.KeyNavNode.prototype.focus.apply(this, [keptFocus]);\n\n\t\t\t\t// GS-152 if there are scrollbars with custom names, change their scroll position\n\t\t\t\tscrollGrid();\n\n\t\t\t\tfunction scrollGrid() {\n\t\t\t\t\tvar grid = gantt.$ui.getView(\"grid\");\n\t\t\t\t\tif (!grid || !grid.$grid_data){\n\t\t\t\t\t\t// GS-1805. Don't try to focus the row that doesn't exist\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar scrollPositionX = parseInt(grid.$grid.scrollLeft);\n\t\t\t\t\tvar scrollPositionY = parseInt(grid.$grid_data.scrollTop);\n\n\t\t\t\t\tvar attachedScrollbarHorizontal = grid.$config.scrollX;\n\n\t\t\t\t\tif (attachedScrollbarHorizontal && grid.$config.scrollable) {\n\t\t\t\t\t\tvar scrollbarHorizontal = gantt.$ui.getView(attachedScrollbarHorizontal);\n\t\t\t\t\t\tif (scrollbarHorizontal) {\n\t\t\t\t\t\t\tscrollbarHorizontal.scrollTo(scrollPositionX, scrollPositionY);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tvar attachedScrollbarVertical = grid.$config.scrollY;\n\n\t\t\t\t\tif (attachedScrollbarVertical) {\n\t\t\t\t\t\tvar scrollbarVertical = gantt.$ui.getView(attachedScrollbarVertical);\n\t\t\t\t\t\tif (scrollbarVertical) {\n\t\t\t\t\t\t\tscrollbarVertical.scrollTo(scrollPositionX, scrollPositionY);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tkeys: {\n\t\t\t\t\"pagedown\": function () {\n\t\t\t\t\tif (gantt.getVisibleTaskCount()) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskRow(gantt.getTaskByIndex(gantt.getVisibleTaskCount() - 1).id));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"pageup\": function () {\n\t\t\t\t\tif (gantt.getVisibleTaskCount()) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskRow(gantt.getTaskByIndex(0).id));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"up\": function () {\n\t\t\t\t\tvar nextElement = null;\n\t\t\t\t\tvar prevTask = gantt.getPrev(this.taskId);\n\t\t\t\t\tif (!gantt.isTaskExists(prevTask)) {\n\t\t\t\t\t\tnextElement = new gantt.$keyboardNavigation.HeaderCell();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnextElement = new gantt.$keyboardNavigation.TaskRow(prevTask);\n\t\t\t\t\t}\n\t\t\t\t\tthis.moveTo(nextElement);\n\t\t\t\t},\n\t\t\t\t\"down\": function () {\n\t\t\t\t\tvar nextTask = gantt.getNext(this.taskId);\n\t\t\t\t\tif (gantt.isTaskExists(nextTask)) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskRow(nextTask));\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\t\"shift+down\": function(){\n\t\t\t\t\tif(gantt.hasChild(this.taskId) && !gantt.getTask(this.taskId).$open){\n\t\t\t\t\t\tgantt.open(this.taskId);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"shift+up\": function(){\n\t\t\t\t\tif(gantt.hasChild(this.taskId) && gantt.getTask(this.taskId).$open){\n\t\t\t\t\t\tgantt.close(this.taskId);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"shift+right\": function() {\n\t\t\t\t\tif (gantt.isReadonly(this)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar prevId = gantt.getPrevSibling(this.taskId);\n\t\t\t\t\tif(gantt.isTaskExists(prevId) && !gantt.isChildOf(this.taskId, prevId)){\n\t\t\t\t\t\tvar parent = gantt.getTask(prevId);\n\t\t\t\t\t\tparent.$open = true;\n\t\t\t\t\t\tvar result = gantt.moveTask(this.taskId, -1, prevId);\n\t\t\t\t\t\tif(result !== false)\n\t\t\t\t\t\t\tgantt.updateTask(this.taskId);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"shift+left\": function() {\n\t\t\t\t\tif (gantt.isReadonly(this)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar parent = gantt.getParent(this.taskId);\n\t\t\t\t\tif(gantt.isTaskExists(parent)){\n\t\t\t\t\t\tvar result =  gantt.moveTask(this.taskId, gantt.getTaskIndex(parent) + 1, gantt.getParent(parent));\n\t\t\t\t\t\tif(result !== false)\n\t\t\t\t\t\t\tgantt.updateTask(this.taskId);\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\t// select\n\t\t\t\t\"space\": function (e) {\n\t\t\t\t\tif (!gantt.isSelectedTask(this.taskId)) {\n\t\t\t\t\t\tgantt.selectTask(this.taskId);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tgantt.unselectTask(this.taskId);\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\t// collapse\n\t\t\t\t\"ctrl+left\": function (e) {\n\t\t\t\t\tgantt.close(this.taskId);\n\t\t\t\t},\n\t\t\t\t// expand\n\t\t\t\t\"ctrl+right\": function (e) {\n\t\t\t\t\tgantt.open(this.taskId);\n\t\t\t\t},\n\n\t\t\t\t// delete task\n\t\t\t\t\"delete\": function (e) {\n\t\t\t\t\tif (gantt.isReadonly(this)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tgantt.$click.buttons[\"delete\"](this.taskId);\n\t\t\t\t},\n\n\t\t\t\t// open lightbox\n\t\t\t\t\"enter\": function () {\n\t\t\t\t\tif (gantt.isReadonly(this)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tgantt.showLightbox(this.taskId);\n\t\t\t\t},\n\n\t\t\t\t// add subtask\n\t\t\t\t\"ctrl+enter\": function () {\n\t\t\t\t\tif (gantt.isReadonly(this)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tgantt.createTask({}, this.taskId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t);\n\tgantt.$keyboardNavigation.TaskRow.prototype.bindAll(gantt.$keyboardNavigation.TaskRow.prototype.keys);\n\n};","import * as domHelpers from \"../../../core/ui/utils/dom_helpers\";\nimport {replaceValidZeroId} from \"../../../utils/helpers\";\n\nexport default function(gantt) {\n\n\n\tgantt.$keyboardNavigation.TaskCell = function (taskId, index) {\n\t\ttaskId = replaceValidZeroId(taskId, gantt.config.root_id);\n\t\tif (!taskId) {\n\t\t\tvar rootLevel = gantt.getChildren(gantt.config.root_id);\n\t\t\tif (rootLevel[0]) {\n\t\t\t\ttaskId = rootLevel[0];\n\t\t\t}\n\t\t}\n\t\tthis.taskId = taskId;\n\t\tthis.columnIndex = index || 0;\n\t\t// provided task may not exist, in this case node will be detectes as invalid\n\t\tif (gantt.isTaskExists(this.taskId)) {\n\t\t\tthis.index = gantt.getTaskIndex(this.taskId);\n\t\t\tthis.globalIndex = gantt.getGlobalTaskIndex(this.taskId);\n\t\t}\n\t};\n\n\tgantt.$keyboardNavigation.TaskCell.prototype = gantt._compose(\n\t\tgantt.$keyboardNavigation.TaskRow,\n\t\t{\n\t\t\t_handlers: null,\n\t\t\tisValid: function () {\n\n\t\t\t\treturn gantt.$keyboardNavigation.TaskRow.prototype.isValid.call(this) && !!gantt.getGridColumns()[this.columnIndex];\n\t\t\t},\n\t\t\tfallback: function () {\n\n\t\t\t\tvar node = gantt.$keyboardNavigation.TaskRow.prototype.fallback.call(this);\n\t\t\t\tvar result = node;\n\t\t\t\tif (node instanceof gantt.$keyboardNavigation.TaskRow) {\n\t\t\t\t\tvar visibleColumns = gantt.getGridColumns();\n\t\t\t\t\tvar index = this.columnIndex;\n\t\t\t\t\twhile (index >= 0) {\n\t\t\t\t\t\tif (visibleColumns[index])\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tindex--;\n\t\t\t\t\t}\n\t\t\t\t\tif (visibleColumns[index]) {\n\t\t\t\t\t\tresult = new gantt.$keyboardNavigation.TaskCell(node.taskId, index);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn result;\n\t\t\t},\n\n\t\t\tfromDomElement: function(el){\n\t\t\t\tif(!gantt.config.keyboard_navigation_cells){\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tvar taskId = gantt.locate(el);\n\t\t\t\tif(gantt.isTaskExists(taskId)){\n\t\t\t\t\tvar index = 0;\n\t\t\t\t\tvar cellElement = domHelpers.locateAttribute(el, \"data-column-index\");\n\n\t\t\t\t\tif(cellElement){\n\t\t\t\t\t\tindex = cellElement.getAttribute(\"data-column-index\")*1;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn new gantt.$keyboardNavigation.TaskCell(taskId, index);\n\t\t\t\t}else{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tgetNode: function () {\n\t\t\t\tif (gantt.isTaskExists(this.taskId) && (gantt.isTaskVisible(this.taskId) || gantt.config.show_tasks_outside_timescale)) {\n\t\t\t\t\tif (gantt.config.show_grid && gantt.$grid) {\n\t\t\t\t\t\tvar row = gantt.$grid.querySelector(\".gantt_row[\" + gantt.config.task_attribute + \"='\" + this.taskId + \"']\");\n\t\t\t\t\t\tif(!row)\n\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\treturn row.querySelector(\"[data-column-index='\"+this.columnIndex+\"']\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn gantt.getTaskNode(this.taskId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tkeys: {\n\t\t\t\t\"up\": function () {\n\n\t\t\t\t\tvar nextElement = null;\n\t\t\t\t\tvar prevTask = gantt.getPrev(this.taskId);\n\t\t\t\t\tif (!gantt.isTaskExists(prevTask)) {\n\t\t\t\t\t\tnextElement = new gantt.$keyboardNavigation.HeaderCell(this.columnIndex);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnextElement = new gantt.$keyboardNavigation.TaskCell(prevTask, this.columnIndex);\n\t\t\t\t\t}\n\t\t\t\t\tthis.moveTo(nextElement);\n\t\t\t\t},\n\t\t\t\t\"down\": function () {\n\t\t\t\t\tvar nextTask = gantt.getNext(this.taskId);\n\t\t\t\t\tif (gantt.isTaskExists(nextTask)) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(nextTask, this.columnIndex));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"left\": function () {\n\t\t\t\t\tif (this.columnIndex > 0) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(this.taskId, this.columnIndex - 1));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"right\": function () {\n\t\t\t\t\tvar columns = gantt.getGridColumns();\n\t\t\t\t\tif (this.columnIndex < columns.length - 1) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(this.taskId, this.columnIndex + 1));\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\t\"end\": function () {\n\t\t\t\t\tvar columns = gantt.getGridColumns();\n\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(this.taskId, columns.length - 1));\n\t\t\t\t},\n\t\t\t\t\"home\": function () {\n\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(this.taskId, 0));\n\t\t\t\t},\n\t\t\t\t\"pagedown\": function () {\n\t\t\t\t\tif (gantt.getVisibleTaskCount()) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(gantt.getTaskByIndex(gantt.getVisibleTaskCount() - 1).id, this.columnIndex));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"pageup\": function () {\n\t\t\t\t\tif (gantt.getVisibleTaskCount()) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(gantt.getTaskByIndex(0).id, this.columnIndex));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t);\n\n\n\tgantt.$keyboardNavigation.TaskCell.prototype.bindAll(gantt.$keyboardNavigation.TaskRow.prototype.keys);\n\tgantt.$keyboardNavigation.TaskCell.prototype.bindAll(gantt.$keyboardNavigation.TaskCell.prototype.keys);\n\n};","export default function(gantt) {\n\n\tgantt.$keyboardNavigation.dispatcher = {\n\t\tisActive: false,\n\t\tactiveNode: null,\n\t\tglobalNode: new gantt.$keyboardNavigation.GanttNode(),\n\n\t\tenable: function () {\n\t\t\tthis.isActive = true;\n\t\t\tthis.setActiveNode(this.getActiveNode());\n\t\t},\n\n\t\tdisable: function () {\n\t\t\tthis.isActive = false;\n\t\t},\n\n\t\tisEnabled: function () {\n\t\t\treturn !!this.isActive;\n\t\t},\n\n\t\tgetDefaultNode: function () {\n\t\t\tvar node;\n\t\t\tif (gantt.config.keyboard_navigation_cells) {\n\t\t\t\tnode = new gantt.$keyboardNavigation.TaskCell();\n\t\t\t} else {\n\t\t\t\tnode = new gantt.$keyboardNavigation.TaskRow();\n\t\t\t}\n\n\t\t\tif (!node.isValid()) {\n\t\t\t\tnode = node.fallback();\n\t\t\t}\n\t\t\treturn node;\n\t\t},\n\n\t\tsetDefaultNode: function () {\n\t\t\tthis.setActiveNode(this.getDefaultNode());\n\t\t},\n\n\t\tgetActiveNode: function () {\n\t\t\tvar node = this.activeNode;\n\t\t\tif (node && !node.isValid()) {\n\t\t\t\tnode = node.fallback();\n\t\t\t}\n\t\t\treturn node;\n\t\t},\n\n\t\tfromDomElement: function(e){\n\t\t\tvar inputs = [\n\t\t\t\tgantt.$keyboardNavigation.TaskRow,\n\t\t\t\tgantt.$keyboardNavigation.TaskCell,\n\t\t\t\tgantt.$keyboardNavigation.HeaderCell\n\t\t\t];\n\t\t\tfor(var i = 0; i < inputs.length; i++){\n\t\t\t\tif(inputs[i].prototype.fromDomElement){\n\t\t\t\t\tvar node = inputs[i].prototype.fromDomElement(e);\n\t\t\t\t\tif(node) return node;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\n\t\tfocusGlobalNode: function () {\n\t\t\tthis.blurNode(this.globalNode);\n\t\t\tthis.focusNode(this.globalNode);\n\t\t},\n\n\t\tsetActiveNode: function (el) {\n\t\t\t//console.trace()\n\t\t\tvar focusChanged = true;\n\t\t\tif (this.activeNode) {\n\t\t\t\tif (this.activeNode.compareTo(el)) {\n\t\t\t\t\tfocusChanged = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.isEnabled()) {\n\t\t\t\tif(focusChanged)\n\t\t\t\t\tthis.blurNode(this.activeNode);\n\n\t\t\t\tthis.activeNode = el;\n\t\t\t\tthis.focusNode(this.activeNode, !focusChanged);\n\t\t\t}\n\t\t},\n\n\t\tfocusNode: function (el, keptFocus) {\n\t\t\tif (el && el.focus) {\n\t\t\t\tel.focus(keptFocus);\n\t\t\t}\n\t\t},\n\t\tblurNode: function (el) {\n\t\t\tif (el && el.blur) {\n\t\t\t\tel.blur();\n\t\t\t}\n\t\t},\n\n\t\tkeyDownHandler: function (e) {\n\n\t\t\tif (gantt.$keyboardNavigation.isModal())\n\t\t\t\treturn;\n\n\t\t\tif (!this.isEnabled())\n\t\t\t\treturn;\n\n\t\t\tif(e.defaultPrevented){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar ganttNode = this.globalNode;\n\n\t\t\tvar command = gantt.$keyboardNavigation.shortcuts.getCommandFromEvent(e);\n\n\t\t\tvar activeElement = this.getActiveNode();\n\t\t\tvar eventFacade = gantt.$keyboardNavigation.facade;\n\t\t\tif(eventFacade.callEvent(\"onKeyDown\", [command, e]) === false){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!activeElement) {\n\t\t\t\tthis.setDefaultNode();\n\t\t\t} else if (activeElement.findHandler(command)) {\n\t\t\t\tactiveElement.doAction(command, e);\n\t\t\t} else if (ganttNode.findHandler(command)) {\n\t\t\t\tganttNode.doAction(command, e);\n\t\t\t}\n\n\t\t},\n\t\t_timeout: null,\n\t\tawaitsFocus: function(){\n\t\t\treturn this._timeout !== null;\n\t\t},\n\t\tdelay: function(callback, delay){\n\n\t\t\tclearTimeout(this._timeout);\n\t\t\tthis._timeout = setTimeout(gantt.bind(function(){\n\t\t\t\tthis._timeout = null;\n\t\t\t\tcallback();\n\t\t\t}, this)  , delay || 1);\n\n\t\t},\n\t\tclearDelay: function(){\n\t\t\tclearTimeout(this._timeout);\n\t\t}\n\t};\n\n};","import { QuickInfo } from \"./quickInfo\";\n\nexport default function(gantt: any){\n\nif (!gantt.ext) {\n\tgantt.ext = {};\n}\ngantt.ext.quickInfo = new QuickInfo(gantt);\n\ngantt.config.quickinfo_buttons = [\"icon_edit\", \"icon_delete\"];\ngantt.config.quick_info_detached = true;\ngantt.config.show_quick_info = true;\n\ngantt.templates.quick_info_title = function(start, end, ev){ return ev.text.substr(0,50); };\ngantt.templates.quick_info_content = function(start, end, ev){ return ev.details || ev.text; };\ngantt.templates.quick_info_date = function(start, end, ev){\n\treturn gantt.templates.task_time(start, end, ev);\n};\ngantt.templates.quick_info_class = function(start, end, task){ return \"\"; };\n\ngantt.attachEvent(\"onTaskClick\", function(id,e){\n\t// GS-1460 and GS-1787. Don't show Quick Info when clicking on the add, collapse, and expand buttons\n\tconst addButton = gantt.utils.dom.closest(e.target, \".gantt_add\");\n\tconst collapseButton = gantt.utils.dom.closest(e.target, \".gantt_close\");\n\tconst expandButton = gantt.utils.dom.closest(e.target, \".gantt_open\");\n\tconst showQuickInfo = !addButton && !collapseButton && !expandButton;\n\tif (showQuickInfo){\n\t\tsetTimeout(function() {\n\t\t\tgantt.ext.quickInfo.show(id);\n\t\t}, 0);\n\t}\n\n\treturn true;\n});\n\nconst events = [\"onViewChange\", \"onLightbox\", \"onBeforeTaskDelete\", \"onBeforeDrag\"];\nconst hidingFunction = function(){\n\tgantt.ext.quickInfo.hide();\n\treturn true;\n};\nfor (let i=0; i<events.length; i++){\n\tgantt.attachEvent(events[i], hidingFunction);\n}\n// GS-957: We don't want to hide QuickInfo when we click on it.\ngantt.attachEvent(\"onEmptyClick\", function(e){\n\tlet hideQuickInfo = true;\n\tconst parent = document.querySelector(\".gantt_cal_quick_info\");\n\tif (parent){\n\t\tconst quickInfoClick = gantt.utils.dom.isChildOf(e.target, parent);\n\t\tif (quickInfoClick){\n\t\t\thideQuickInfo = false;\n\t\t}\n\t}\n\tif (hideQuickInfo){\n\t\thidingFunction();\n\t}\n});\nfunction clearQuickInfo() {\n\tgantt.ext.quickInfo.hide();\n\tgantt.ext.quickInfo._quickInfoBox = null;\n\treturn true;\n}\ngantt.attachEvent(\"onGanttReady\", clearQuickInfo);\ngantt.attachEvent(\"onDestroy\", clearQuickInfo);\n\n// eslint-disable-next-line no-restricted-globals\ngantt.event(window, \"keydown\", function(e){\n\tif (e.keyCode === 27){\n\t\tgantt.ext.quickInfo.hide();\n\t}\n});\n\ngantt.showQuickInfo = function(){\n\tgantt.ext.quickInfo.show.apply(gantt.ext.quickInfo, arguments);\n};\ngantt.hideQuickInfo = function(){\n\tgantt.ext.quickInfo.hide.apply(gantt.ext.quickInfo, arguments);\n};\n\n}","import {TooltipManager} from \"./tooltipManager\";\n\nexport default function(gantt: any){\n\ngantt.config.tooltip_timeout = 30;\ngantt.config.tooltip_offset_y = 20;\ngantt.config.tooltip_offset_x = 10;\ngantt.config.tooltip_hide_timeout = 30;\n\n\n\nconst tooltipManager = new TooltipManager(gantt);\n\ngantt.ext.tooltips = tooltipManager;\n\ngantt.attachEvent(\"onGanttReady\", function(){\n\t//GS-2230: in case if `getGanttInstance` created without container\n\tif(!gantt.$root) return;\n\ttooltipManager.tooltipFor({\n\t\tselector: \"[\"+gantt.config.task_attribute+\"]:not(.gantt_task_row)\",\n\t\thtml: (event: MouseEvent) => {\n\t\t\tif (gantt.config.touch && !gantt.config.touch_tooltip) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst targetTaskId = gantt.locate(event);\n\t\t\tif(gantt.isTaskExists(targetTaskId)){\n\t\t\t\tconst task = gantt.getTask(targetTaskId);\n\t\t\t\treturn gantt.templates.tooltip_text(task.start_date, task.end_date, task);\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\tglobal: false\n\t});\n});\n\ngantt.attachEvent(\"onDestroy\", function() {\n\ttooltipManager.destructor();\n});\n\ngantt.attachEvent(\"onLightbox\", function() {\n\ttooltipManager.hideTooltip();\n});\nconst isLinkCreate = () => {\n\tconst state = gantt.getState();\n\treturn !!state.link_source_id;\n};\ngantt.attachEvent(\"onBeforeTooltip\", function() {\n\tif (isLinkCreate()){\n\t\treturn false;\n\t}\n});\n\ngantt.attachEvent(\"onGanttScroll\", function(){\n\ttooltipManager.hideTooltip();\n});\n\n}","import { Monitor } from \"./monitor\";\nimport { IMonitor, IUndoCommand, TEntityType, TUndoStack } from \"./types\";\nimport { Undo } from \"./undo\";\n\nexport default function(gantt: any){\n\nconst _undo = new Undo(gantt);\nconst monitor: IMonitor = new Monitor(_undo, gantt);\n\ngantt.config.undo = true;\ngantt.config.redo = true;\n\n/**\n * entities that require different processing for undoing-redoing changes\n * @type {{link: string, task: string}}\n */\ngantt.config.undo_types = {\n\tlink: \"link\",\n\ttask: \"task\"\n};\n\n/**\n * types of traced actions\n * @type {{update: string, remove: string, add: string}}\n */\ngantt.config.undo_actions = {\n\tupdate: \"update\",\n\tremove: \"remove\", // remove item from datastore\n\tadd: \"add\",\n\tmove: \"move\" // move task in grid\n};\n\nif (!gantt.ext) {\n\tgantt.ext = {};\n}\n\ngantt.ext.undo = {\n\tundo: () => _undo.undo(),\n\tredo: () => _undo.redo(),\n\tgetUndoStack: () => _undo.getUndoStack(),\n\tsetUndoStack: (stack:[]) => _undo.setUndoStack(stack),\n\tgetRedoStack: () => _undo.getRedoStack(),\n\tsetRedoStack: (stack:[]) => _undo.setRedoStack(stack),\n\tclearUndoStack: () => _undo.clearUndoStack(),\n\tclearRedoStack: () => _undo.clearRedoStack(),\n\tsaveState: (id: TaskID | LinkID, type: TEntityType) => monitor.store(id, type, true),\n\tgetInitialState: (id: TaskID | LinkID, type: TEntityType) => {\n\t\tif(type === gantt.config.undo_types.link){\n\t\t\treturn monitor.getInitialLink(id);\n\t\t}else{\n\t\t\treturn monitor.getInitialTask(id);\n\t\t}\n\t}\n};\n\ngantt.undo = gantt.ext.undo.undo;\ngantt.redo = gantt.ext.undo.redo;\ngantt.getUndoStack = gantt.ext.undo.getUndoStack;\ngantt.getRedoStack = gantt.ext.undo.getRedoStack;\ngantt.clearUndoStack = gantt.ext.undo.clearUndoStack;\ngantt.clearRedoStack = gantt.ext.undo.clearRedoStack;\n\nfunction isEqualIds(first: TaskID, second: TaskID){\n\treturn String(first) === String(second);\n};\n\nfunction updTask(task: ITask, oldId: TaskID, newId: TaskID) {\n\tif (!task) { return; }\n\n\tif (isEqualIds(task.id, oldId)) {\n\t\ttask.id = newId;\n\t}\n\n\tif (isEqualIds(task.parent, oldId)) {\n\t\ttask.parent = newId;\n\t}\n}\n\nfunction changeTaskCommandId(command: IUndoCommand, oldId: TaskID, newId: TaskID) {\n\tupdTask(command.value, oldId, newId);\n\tupdTask(command.oldValue, oldId, newId);\n}\n\nfunction updLink(link: ILink, oldTaskId: TaskID, newTaskId: TaskID) {\n\tif (!link) { return; }\n\tif (isEqualIds(link.source, oldTaskId)) {\n\t\tlink.source = newTaskId;\n\t}\n\tif (isEqualIds(link.target, oldTaskId)) {\n\t\tlink.target = newTaskId;\n\t}\n}\n\nfunction changeLinkCommandId(command: IUndoCommand, oldId: LinkID, newId: LinkID) {\n\tupdLink(command.value, oldId, newId);\n\tupdLink(command.oldValue, oldId, newId);\n}\n\nfunction updateTasksIds(log: TUndoStack, oldId: TaskID, newId: TaskID) {\n\tconst undo = _undo;\n\n\tfor (let i = 0; i < log.length; i++) {\n\t\tconst entry = log[i];\n\t\tfor (let j = 0; j < entry.commands.length; j++) {\n\t\t\tif (entry.commands[j].entity === undo.command.entity.task) {\n\t\t\t\tchangeTaskCommandId(entry.commands[j], oldId, newId);\n\t\t\t} else if (entry.commands[j].entity === undo.command.entity.link) {\n\t\t\t\tchangeLinkCommandId(entry.commands[j], oldId, newId);\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction updateLinksIds(log: TUndoStack, oldId: LinkID, newId: LinkID) {\n\tconst undo = _undo;\n\n\tfor (let i = 0; i < log.length; i++) {\n\t\tconst entry = log[i];\n\t\tfor (let j = 0; j < entry.commands.length; j++) {\n\t\t\tconst command = entry.commands[j];\n\t\t\tif (command.entity === undo.command.entity.link) {\n\t\t\t\tif (command.value && command.value.id === oldId) {\n\t\t\t\t\tcommand.value.id = newId;\n\t\t\t\t}\n\t\t\t\tif (command.oldValue && command.oldValue.id === oldId) {\n\t\t\t\t\tcommand.oldValue.id = newId;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\ngantt.attachEvent(\"onTaskIdChange\", (oldId: TaskID, newId: TaskID) => {\n\tconst undo = _undo;\n\tupdateTasksIds(undo.getUndoStack(), oldId, newId);\n\tupdateTasksIds(undo.getRedoStack(), oldId, newId);\n});\n\ngantt.attachEvent(\"onLinkIdChange\", (oldId: LinkID, newId: LinkID) => {\n\tconst undo = _undo;\n\tupdateLinksIds(undo.getUndoStack(), oldId, newId);\n\tupdateLinksIds(undo.getRedoStack(), oldId, newId);\n});\n\ngantt.attachEvent(\"onGanttReady\", () => {\n\t_undo.updateConfigs();\n});\n\n}","import * as helpers from \"../utils/helpers\";\n\nexport default function(gantt){\n\ngantt._groups = {\n\trelation_property: null,\n\trelation_id_property: '$group_id',\n\tgroup_id: null,\n\tgroup_text: null,\n\tloading: false,\n\tloaded: 0,\n\tdynamicGroups: false,\n\tset_relation_value: undefined,\n\t_searchCache: null,\n\tinit: function(gantt){\n\t\tvar self = this;\n\n\t\tgantt.attachEvent(\"onClear\", function(){\n\t\t\tself.clear();\n\t\t});\n\t\tself.clear();\n\n\t\tvar originalGetParent = gantt.$data.tasksStore.getParent; // gantt._get_parent_id;\n\t\tthis._searchCache = null;\n\t\tgantt.attachEvent(\"onBeforeTaskMove\", function(id, parent, tindex) {\n\t\t\t// GS-504: If we allow several owners/resources, the task should be moved to \n\t\t\t// a new position only if there is the function that handles that logic\n\t\t\tvar invalidParent = parent === this.config.root_id;\n\t\t\tvar noRelationValueFunction = this._groups.dynamicGroups && !(this._groups.set_relation_value instanceof Function);\n\n\t\t\tif (self.is_active() && (invalidParent || noRelationValueFunction)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar task = gantt.getTask(id);\n\t\t\t// to allow reordering from regular task to virtual task in the group mode\n\t\t\tif (this._groups.save_tree_structure && gantt.isTaskExists(task.parent) && gantt.isTaskExists(parent)) {\n\t\t\t\tvar oldParentTask = gantt.getTask(task.parent);\n\t\t\t\tvar newParentTask = gantt.getTask(parent);\n\t\t\t\tif (newParentTask.$virtual && gantt.isChildOf(oldParentTask.id, newParentTask.id)) {\n\t\t\t\t\ttask.parent = gantt.config.root_id;\n\t\t\t\t}\n\t\t\t\t// avoid cyclic tree:\n\t\t\t\tlet cyclicTree = false;\n\t\t\t\tlet parentTask = newParentTask;\n\t\t\t\twhile (parentTask) {\n\t\t\t\t\tif (id == parentTask.parent) {\n\t\t\t\t\t\tcyclicTree = true;\n\t\t\t\t\t}\n\t\t\t\t\tif (gantt.isTaskExists(parentTask.parent)) {\n\t\t\t\t\t\tparentTask = gantt.getTask(parentTask.parent);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tparentTask = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (cyclicTree) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\t// restore initial parent if the task is moved to a different group on the root level\n\t\tgantt.attachEvent(\"onRowDragStart\", function (id, target) {\n\t\t\tvar task = gantt.getTask(id);\n\t\t\tif (this._groups.save_tree_structure && gantt.isTaskExists(task.parent) && gantt.config.order_branch && gantt.config.order_branch != \"marker\") {\n\t\t\t\ttask.$initial_parent = task.parent;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tgantt.attachEvent(\"onRowDragEnd\", function (id, target) {\n\t\t\tif (gantt.config.order_branch && gantt.config.order_branch != \"marker\") {\n\t\t\t\tvar task = gantt.getTask(id);\n\t\t\t\tif (task.$initial_parent) {\n\t\t\t\t\tif (task.parent == gantt.config.root_id) {\n\t\t\t\t\t\tvar renderedParent = gantt.getTask(task.$rendered_parent);\n\t\t\t\t\t\tvar initialParent = gantt.getTask(task.$initial_parent);\n\t\t\t\t\t\tvar restoreParent = false;\n\t\t\t\t\t\tif (this._groups.dynamicGroups && renderedParent[this._groups.group_id] != initialParent[this._groups.group_id]) {\n\t\t\t\t\t\t\trestoreParent = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!this._groups.dynamicGroups && renderedParent[this._groups.group_id] != initialParent[this._groups.relation_property]) {\n\t\t\t\t\t\t\trestoreParent = true;\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (restoreParent) {\n\t\t\t\t\t\t\ttask.parent = task.$initial_parent;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tdelete task.$initial_parent;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tgantt.$data.tasksStore._listenerToDrop = gantt.$data.tasksStore.attachEvent(\"onStoreUpdated\", gantt.bind(_initBeforeDataRender, gantt));\n\n\t\tgantt.$data.tasksStore.getParent = function(task) {\n\t\t\tif (self.is_active()) {\n\t\t\t\treturn self.get_parent(gantt, task);\n\t\t\t} else {\n\t\t\t\treturn originalGetParent.apply(this, arguments);\n\t\t\t}\n\t\t};\n\n\t\tvar originalSetParent = gantt.$data.tasksStore.setParent;\n\n\t\tgantt.$data.tasksStore.setParent = function(task, new_pid) {\n\t\t\tif (!self.is_active()) {\n\t\t\t\treturn originalSetParent.apply(this, arguments);\n\t\t\t} else if (self.set_relation_value instanceof Function && gantt.isTaskExists(new_pid)) {\n\t\t\t\tvar parent = gantt.getTask(new_pid);\n\t\t\t\tvar groupIds = parent[self.relation_id_property];\n\t\t\t\tif (!parent.$virtual) {\n\t\t\t\t\tvar groupId = _getGroupId(parent, self.relation_property);\n\t\t\t\t\tif (!self._searchCache) {\n\t\t\t\t\t\tself._buildCache();\n\t\t\t\t\t}\n\t\t\t\t\tvar virtualParentId = self._searchCache[groupId];\n\t\t\t\t\tvar virtualParent = gantt.getTask(virtualParentId);\n\t\t\t\t\tgroupIds = virtualParent[self.relation_id_property];\n\t\t\t\t}\n\t\t\t\tif (task[self.group_id] === undefined) {\n\t\t\t\t\t// to avoid nulling of relation_property if the group is not set\n\t\t\t\t\ttask[self.group_id] = groupIds;\n\t\t\t\t}\n\n\t\t\t\tif (self.save_tree_structure && task[self.group_id] != groupIds) {\n\t\t\t\t\ttask[self.group_id] = groupIds;\n\t\t\t\t}\n\n\t\t\t\tif (groupIds){\n\t\t\t\t\tif (typeof groupIds == \"string\"){\n\t\t\t\t\t\tgroupIds = groupIds.split(\",\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tgroupIds = [groupIds];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// GS-504: This is a way to save the relation_property and customize the logic\n\t\t\t\ttask[self.relation_property] = self.set_relation_value(groupIds, task.id, task[self.relation_property]) || groupIds;\n\n\t\t\t} else if (gantt.isTaskExists(new_pid)) {\n\t\t\t\tvar parent = gantt.getTask(new_pid);\n\n\t\t\t\tif (!self.dynamicGroups) {\n\t\t\t\t\tif (parent.$virtual) {\n\t\t\t\t\t\ttask[self.relation_property] = parent[self.relation_id_property];\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttask[self.relation_property] = parent[self.relation_property];\n\t\t\t\t\t}\n\t\t\t\t\t// task[self.group_id] = parent[self.group_id] || task[self.group_id];\n\t\t\t\t}\n\n\t\t\t\tthis._setParentInner.apply(this, arguments);\n\t\t\t} else if(self.dynamicGroups) {\n\t\t\t\tif (task[self.group_id] === undefined || (!task.$virtual && task[self.relation_property][0] === [][0])) {\n\t\t\t\t\tif(task[self.relation_property] !== self.group_id){\n\t\t\t\t\t\t// GS:2547 dynamically added tasks could have relation_property\n\t\t\t\t\t\ttask[self.relation_property] = task[self.relation_property] || 0;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// GS-1332 the tasks without the group should be moved to the default group:\n\t\t\t\t\t\ttask[self.relation_property] = 0;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\t\t\t// GS-1449. Update the parent when it was changed in the group mode\n\t\t\tif (gantt.isTaskExists(new_pid)) {\n\t\t\t\ttask.$rendered_parent = new_pid;\n\t\t\t\tif (!gantt.getTask(new_pid).$virtual) {\n\t\t\t\t\treturn originalSetParent.apply(this, arguments) || new_pid;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tgantt.attachEvent(\"onBeforeTaskDisplay\", function(id, task){\n\t\t\tif(self.is_active()){\n\t\t\t\tif(task.type == gantt.config.types.project && !task.$virtual)\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tgantt.attachEvent(\"onBeforeParse\", function(){\n\t\t\tself.loading = true;\n\t\t\tself._clearCache();\n\t\t});\n\n\t\tgantt.attachEvent(\"onTaskLoading\", function(){\n\t\t\tif(self.is_active()){\n\t\t\t\tself.loaded--;\n\t\t\t\tif(self.loaded <= 0){\n\t\t\t\t\tself.loading = false;\n\t\t\t\t\tself._clearCache();\n\t\t\t\t\tgantt.eachTask(gantt.bind(function(t){\n\t\t\t\t\t\tthis.get_parent(gantt, t);\n\t\t\t\t\t}, self));\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\n\t\t});\n\t\tgantt.attachEvent(\"onParse\", function(){\n\t\t\tself.loading = false;\n\t\t\tself.loaded = 0;\n\t\t});\n\t},\n\n\t_clearCache: function(){\n\t\tthis._searchCache = null;\n\t},\n\t_buildCache: function(){\n\t\tthis._searchCache = {};\n\t\tvar items = gantt.$data.tasksStore.getItems();\n\t\tfor(var i = 0; i < items.length; i++){\n\t\t\tthis._searchCache[items[i][this.relation_id_property]] = items[i].id;\n\t\t}\n\n\t},\n\tget_parent: function(gantt, task, tasks) {\n\t\tif (task.id === undefined) {\n\t\t\ttask = gantt.getTask(task);\n\t\t}\n\n\t\tvar group_id = _getGroupId(task, this.relation_property);\n\n\t\tif (this.save_tree_structure && gantt.isTaskExists(task.parent)) {\n\t\t\tlet parentTask = gantt.getTask(task.parent);\n\n\t\t\tconst parent_group_id = _getGroupId(parentTask, this.relation_property);\n\n\t\t\tif (parentTask.type != \"project\" && group_id == parent_group_id) {\n\t\t\t\treturn task.parent;\n\t\t\t}\n\t\t}\n\n\t\tif (this._groups_pull[group_id] === task.id){\n\t\t\treturn gantt.config.root_id;\n\t\t}\n\t\tif (this._groups_pull[group_id] !== undefined) {\n\t\t\treturn this._groups_pull[group_id];\n\t\t}\n\n\t\tvar parent_id = gantt.config.root_id;\n\n\t\tif (!this.loading && group_id !== undefined) {\n\n\t\t\tif(!this._searchCache){\n\t\t\t\tthis._buildCache();\n\t\t\t}\n\t\t\tvar parent = this._searchCache[group_id];\n\t\t\tif(gantt.isTaskExists(parent) && parent != task.id){\n\t\t\t\tparent_id = this._searchCache[group_id];\n\t\t\t}\n\n\t\t\tthis._groups_pull[group_id] = parent_id;\n\t\t}\n\n\t\treturn parent_id;\n\t},\n\n\tclear: function(){\n\t\tthis._groups_pull = {};\n\t\tthis.relation_property = null;\n\t\tthis.group_id = null;\n\t\tthis.group_text = null;\n\t\tthis._clearCache();\n\t},\n\tis_active: function(){\n\t\treturn !!(this.relation_property);\n\t},\n\tgenerate_sections: function(list, groups_type){\n\t\tvar groups = [];\n\t\tfor(var i = 0; i < list.length; i++){\n\t\t\tvar group = gantt.copy(list[i]);\n\t\t\tgroup.type = groups_type;\n\t\t\tif(group.open === undefined){\n\t\t\t\tgroup.open = true;\n\t\t\t}\n\t\t\tgroup.$virtual = true;\n\t\t\tgroup.readonly = true;\n\t\t\tgroup[this.relation_id_property] = group[this.group_id];\n\t\t\tgroup.text = group[this.group_text];\n\t\t\tgroups.push(group);\n\t\t}\n\t\treturn groups;\n\n\t},\n\tclear_temp_tasks: function(tasks){\n\t\tfor(var i =0; i < tasks.length; i++){\n\t\t\tif(tasks[i].$virtual){\n\t\t\t\ttasks.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t},\n\n\tgenerate_data: function(gantt, groups){\n\t\tvar links = gantt.getLinks();\n\t\tvar tasks = gantt.getTaskByTime();\n\n\t\tthis.clear_temp_tasks(tasks);\n\n\t\ttasks.forEach(function(task){\n\t\t\ttask.$calculate_duration = false;// no need to recalculate durations of tasks after group by\n\t\t});\n\n\t\tvar categories = [];\n\t\tif(this.is_active() && groups && groups.length){\n\t\t\tcategories = this.generate_sections(groups, gantt.config.types.project);\n\t\t}\n\n\t\tvar data = {links: links};\n\t\tdata.data = categories.concat(tasks);\n\n\t\treturn data;\n\t},\n\tupdate_settings: function(relation, group_id, group_text){\n\t\tthis.clear();\n\t\tthis.relation_property = relation;\n\t\tthis.group_id = group_id;\n\t\tthis.group_text = group_text;\n\t},\n\tgroup_tasks: function (gantt, groups_array, relation_property, group_id, group_text){\n\t\tthis.update_settings(relation_property, group_id, group_text);\n\t\tvar data = this.generate_data(gantt, groups_array);\n\t\tthis.loaded = data.data.length;\n\n\t\t// save task selection before grouping tasks\n\t\t// We need to iterate selected tasks with the \"isSelectedTask\" method\n\t\t// because it will work with and without the multiselect extension\n\t\tvar selectedTasks = [];\n\t\tgantt.eachTask(function(task){\n\t\t\tif (gantt.isSelectedTask(task.id)){\n\t\t\t\tselectedTasks.push(task.id);\n\t\t\t}\n\t\t});\n\n\t\tgantt._clear_data();\n\t\tconst schedulingOnParse = gantt._getAutoSchedulingConfig().schedule_on_parse;\n\t\tconst deprecatedConfig = gantt.config.auto_scheduling_initial;\n\n\t\tif(deprecatedConfig) {\n\t\t\tgantt.config.auto_scheduling_initial = false;\n\t\t} else if (schedulingOnParse){\n\t\t\tgantt.config.auto_scheduling.schedule_on_parse = false;\n\t\t}\n\t\t\n\t\tgantt.parse(data);\n\n\t\t// restore task selection after grouping tasks\n\t\tselectedTasks.forEach(function(taskId){\n\t\t\tif (gantt.isTaskExists(taskId)){\n\t\t\t\tgantt.selectTask(taskId);\n\t\t\t}\n\t\t});\n\n\t\tif(deprecatedConfig) {\n\t\t\tgantt.config.auto_scheduling_initial = schedulingOnParse;\n\t\t} else if (schedulingOnParse){\n\t\t\tgantt.config.auto_scheduling.schedule_on_parse = schedulingOnParse;\n\t\t}\n\t}\n};\n\ngantt._groups.init(gantt);\n\nfunction setRelationValueForAssignmentsArray(newGroupValues, id, oldRelationProperty) {\n\tif (!newGroupValues) {\n\t\treturn 0;\n\t}\n\n\tif (Array.isArray(oldRelationProperty) && !oldRelationProperty[0]) {\n\t\treturn 0;\n\t}\n\n\tif (newGroupValues && !Array.isArray(oldRelationProperty)) {\n\t\tconst resources = [];\n\t\tnewGroupValues.map(function(id){\n\t\t\tresources.push({ resource_id: id, value: 8 });\n\t\t});\n\t\treturn resources;\n\t}\n\tif (!oldRelationProperty[0].resource_id) {\n\t\toldRelationProperty = [{ resource_id: oldRelationProperty, value: 8 }];\n\t}\n\n\tif (typeof newGroupValues == \"string\") {\n\t\tnewGroupValues = newGroupValues.split(',');\n\t}\n\n\tif (newGroupValues.length == 1) {\n\t\toldRelationProperty[0].resource_id = newGroupValues[0];\n\t\treturn [oldRelationProperty[0]];\n\t}\n\n\tconst newRelationProperty = [];\n\t// GS-2493: need to take into account that task could have assigments on different dates\n\t// with the same resource\n\tif (newGroupValues.length > 1) {\n\t\tnewGroupValues = [...new Set(newGroupValues)]; // need to remove repeated ids if they exist\n\t}\n\t\n\tfor (let i = 0; i < newGroupValues.length; i++) {\n\t\tlet new_value = newGroupValues[i];\n\t\tlet arrOfResourceIds = oldRelationProperty.map(function (e) { return e.resource_id; });\n\t\t// need to get the positions of the resources\n\t\tlet pos = arrOfResourceIds.reduce(function(resourceAssignmentIndexes, resourceId, index) {\n\t\t\tif (resourceId === new_value)\n\t\t\t\tresourceAssignmentIndexes.push(index);\n\t\t\treturn resourceAssignmentIndexes;\n\t\t}, []);\n\t\t\n\t\tif (pos.length > 0) {\n\t\t\tpos.forEach((assignmentIndex) => {\n\t\t\t\toldRelationProperty[assignmentIndex].resource_id = new_value;\n\t\t\t\tnewRelationProperty.push(oldRelationProperty[assignmentIndex]);\n\t\t\t});\n\t\t}\n\t\telse {\n\t\t\tlet copy = gantt.copy(oldRelationProperty[0]);\n\t\t\tcopy.resource_id = new_value;\n\t\t\tnewRelationProperty.push(copy);\n\t\t}\n\t}\n\treturn newRelationProperty;\n}\n\nfunction setRelationValueForPrimitivesArray(newGroupValues, id, oldRelationProperty) {\n\treturn newGroupValues;\n}\n\nfunction inspectRelationProperty(tasks, relationProperty){\n\tvar resourceAssignments = false;\n\tvar arrays = false;\n\tfor(var i = 0; i < tasks.length; i++){\n\t\tvar value = tasks[i][relationProperty];\n\t\tif(Array.isArray(value)){\n\t\t\tarrays = true;\n\t\t\tif(value.length) {\n\t\t\t\tif(value[0].resource_id !== undefined){\n\t\t\t\t\tresourceAssignments = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn {\n\t\thaveArrays: arrays,\n\t\thaveResourceAssignments: resourceAssignments\n\t};\n}\n\nfunction selectRelationFunction(relationInfo){\n\tif(relationInfo.haveResourceAssignments){\n\t\treturn setRelationValueForAssignmentsArray;\n\t}else if(relationInfo.haveArrays){\n\t\treturn setRelationValueForPrimitivesArray;\n\t}\n\treturn null;\n}\n\ngantt.groupBy = function(config) {\n\tvar _this = this;\n\tvar tasks = gantt.getTaskByTime();\n\n\tthis._groups.set_relation_value = config.set_relation_value;\n\tthis._groups.dynamicGroups = false;\n\tthis._groups.save_tree_structure = config.save_tree_structure;\n\n\tvar relationInfo = inspectRelationProperty(tasks, config.relation_property);\n\n\tif(relationInfo.haveArrays){\n\t\tthis._groups.dynamicGroups = true;\n\t}\n\n\tif(!this._groups.set_relation_value) {\n\t\tthis._groups.set_relation_value = selectRelationFunction(relationInfo);\n\t}\n\n\tconfig = config || {};\n\tconfig.default_group_label = config.default_group_label || this.locale.labels.default_group || \"None\";\n\n\tvar relation_property = config.relation_property || null;\n\tvar group_id = config.group_id || \"key\";\n\tvar group_text = config.group_text || \"label\";\n\n\tthis._groups.regroup = function() {\n\t\tvar tasks = gantt.getTaskByTime();\n\t\tvar groupOpenCloseState = {};\n\t\tvar restoreOpenCloseState = false;\n\t\ttasks.forEach(function(task){\n\t\t\tif(task.$virtual && task.$open !== undefined){\n\t\t\t\tgroupOpenCloseState[task[group_id]] = task.$open;\n\t\t\t\trestoreOpenCloseState = true;\n\t\t\t}\n\t\t});\n\t\tvar groups = _initGroups(config, tasks, gantt);\n\t\tif(groups && restoreOpenCloseState){\n\t\t\tgroups.forEach(function(group){\n\t\t\t\tif(groupOpenCloseState[group[group_id]] !== undefined){\n\t\t\t\t\tgroup.open = groupOpenCloseState[group[group_id]];\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t_this._groups.group_tasks(_this, groups, relation_property, group_id, group_text);\n\t\treturn true;\n\t};\n\tthis._groups.regroup();\n};\n\nfunction _initGroups(config, tasks, gantt) {\n\tvar groups;\n\tif (config.groups) {\n\t\tif (gantt._groups.dynamicGroups) {\n\t\t\tgroups = _getGroupForMultiItems(tasks, config);\n\t\t} else {\n\t\t\tgroups = config.groups;\n\t\t}\n\n\t} else {\n\t\tgroups = null;\n\t}\n\treturn groups;\n}\n\nfunction _getResourcesIds(resources){\n\treturn resources.map(_getEntryId).sort().join(\",\");\n}\n\nfunction _getEntryId(entry){\n\tif(entry && typeof entry == \"object\"){\n\t\treturn String(entry.resource_id);\n\t}else{\n\t\treturn String(entry);\n\t}\n}\n\nfunction _getGroupId(task, relationProperty) {\n\tvar group_id;\n\tif (task[relationProperty] instanceof Array) {\n\t\t// GS-1332 We want to assign tasks with the empty relationProperty to a default group\n\t\tif (!task[relationProperty].length) {\n\t\t\tgroup_id = 0;\n\t\t}\n\t\telse {\n\t\t\tgroup_id = _getResourcesIds(task[relationProperty]);\n\t\t}\n\t} else {\n\t\tgroup_id = task[relationProperty];\n\t}\n\treturn group_id;\n}\n\nfunction _getGroupForMultiItems(tasks, config) {\n\tvar resultObj = {};\n\tvar result = [];\n\tvar itemsByKey = {};\n\tvar property = config.relation_property;\n\tvar delimiter = config.delimiter || \",\";\n\n\tvar hasDefaultGroup = false;\n\tvar defaultGroupId = 0;\n\n\thelpers.forEach(config.groups, function(entry) {\n\t\tif(entry.default){\n\t\t\thasDefaultGroup = true;\n\t\t\tdefaultGroupId = entry.group_id;\n\t\t}\n\t\titemsByKey[entry.key || entry[config.group_id]] = entry;\n\t});\n\n\tfor (var i=0; i < tasks.length; i++) {\n\t\tvar key;\n\t\tvar label;\n\t\tvar task = tasks[i];\n\t\tvar taskGroupValue = task[property];\n\n\t\tif (helpers.isArray(taskGroupValue)) {\n\t\t\tif(taskGroupValue.length > 0) {\n\t\t\t\tkey = _getResourcesIds(taskGroupValue);\n\t\t\t\tlabel = taskGroupValue.map(function(entry, index) {\n\t\t\t\t\tvar key;\n\t\t\t\t\tif (entry && typeof entry == \"object\") {\n\t\t\t\t\t\tkey = entry.resource_id;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tkey = entry;\n\t\t\t\t\t}\n\t\t\t\t\tentry = itemsByKey[key];\n\t\t\t\t\treturn entry.label || entry.text;\n\t\t\t\t}).sort();\n\t\t\t\t// GS-2493: need to take into account that task could have assigments on different dates\n\t\t\t\t// with the same resource\n\t\t\t\tlabel = [...new Set(label)].join(delimiter);\n\t\t\t} else {\n\t\t\t\tif(hasDefaultGroup)\n\t\t\t\t\tcontinue;\n\t\t\t\tkey = 0;\n\t\t\t\tlabel = config.default_group_label;\n\t\t\t}\n\t\t} else if (taskGroupValue) {\n\t\t\tkey = taskGroupValue;\n\t\t\tlabel = itemsByKey[key].label || itemsByKey[key].text;\n\t\t} else {\n\t\t\tif(hasDefaultGroup)\n\t\t\t\tcontinue;\n\t\t\tkey = 0;\n\t\t\tlabel = config.default_group_label;\n\t\t}\n\t\tif (key === undefined || resultObj[key] !== undefined) {\n\t\t\tcontinue;\n\t\t}\n\t\tresultObj[key] = { key: key, label: label };\n\t\tif(key === defaultGroupId){\n\t\t\tresultObj[key].default = true;\n\t\t}\n\t\tresultObj[key][config.group_text] = label;\n\t\tresultObj[key][config.group_id] = key;\n\t}\n\tresult = helpers.hashToArray(resultObj);\n\tresult.forEach(function(group){\n\t\tif(group.key == defaultGroupId){\n\t\t\tgroup.default = true;\n\t\t}\n\t});\n\treturn result;\n}\n\nvar state = gantt.$services.getService(\"state\");\nstate.registerProvider(\"groupBy\", function () {\n\treturn {\n\t\tgroup_mode: gantt._groups.is_active() ? gantt._groups.relation_property : null\n\t};\n});\n\nfunction _initBeforeDataRender() {\n\tconst _this = this;\n\tif (this.$data.tasksStore._listenerToDrop) {\n\t\tthis.$data.tasksStore.detachEvent(this.$data.tasksStore._listenerToDrop);\n\t}\n\n\t// updateTask can be called many times from batchUpdate or autoSchedule,\n\t// add a delay in order to perform grouping only once when everything is done\n\tconst delayedFunction = helpers.delay(function() {\n\t\tif (!_this._groups.dynamicGroups) {\n\t\t\treturn true;\n\t\t}\n\t\tif (_this._groups.regroup) {\n\t\t\tconst scrollState = gantt.getScrollState();\n\t\t\t_this._groups.regroup();\n\t\t\tif(scrollState){\n\t\t\t\tgantt.scrollTo(scrollState.x, scrollState.y);\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t});\n\t\n\tthis.$data.tasksStore.attachEvent(\"onAfterUpdate\", function(){\n\t\t// do not reset delayed function each time since onAfterUpdate can be called huge number of times and clearTimeout/setTimeout gets expensive\n\t\tif(!delayedFunction.$pending){\n\t\t\tdelayedFunction();\n\t\t}\n\t\treturn true;\n\t});\n\t// GS:2547 dynamically added tasks need to regroup\n\tthis.$data.tasksStore.attachEvent(\"onParse\", function(){\n\t\tif (!_this._groups.dynamicGroups) {\n\t\t\t// GS-2823: if the updated tasks change the relation property from primitive to array\n\t\t\t// need to regroup the tasks\n\t\t\tif(_this._groups.is_active()){\n\t\t\t\tconst tasks = gantt.getTaskByTime();\n\t\t\t\tconst relationInfo = inspectRelationProperty(tasks, _this._groups.relation_property);\n\t\t\t\tif(relationInfo.haveArrays){\n\t\t\t\t\t_this._groups.dynamicGroups = true;\n\t\t\t\t\tif (_this._groups.regroup && gantt.getScrollState) {\n\t\t\t\t\t\tconst scrollState = gantt.getScrollState();\n\t\t\t\t\t\t_this._groups.regroup();\n\t\t\t\t\t\tif(scrollState){\n\t\t\t\t\t\t\tgantt.scrollTo(scrollState.x, scrollState.y);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n}\n\n};","\nexport default function(gantt){\n\nif(!gantt._markers) {\n\tgantt._markers = gantt.createDatastore({\n\t\tname: \"marker\",\n\t\tinitItem: function (marker) {\n\t\t\tmarker.id = marker.id || gantt.uid();\n\t\t\treturn marker;\n\t\t}\n\t});\n}\n\ngantt.config.show_markers = true;\n\nfunction render_marker(marker){\n\tif(!gantt.config.show_markers)\n\t\treturn false;\n\n\tif(!marker.start_date)\n\t\treturn false;\n\n\tvar state = gantt.getState();\n\tif(+marker.start_date > +state.max_date)\n\t\treturn;\n\tif((!marker.end_date || +marker.end_date < +state.min_date) && +marker.start_date < +state.min_date)\n\t\treturn;\n\n\tvar div = document.createElement(\"div\");\n\n\tdiv.setAttribute(\"data-marker-id\", marker.id);\n\n\tvar css = \"gantt_marker\";\n\tif(gantt.templates.marker_class)\n\t\tcss += \" \" + gantt.templates.marker_class(marker);\n\n\tif(marker.css){\n\t\tcss += \" \" + marker.css;\n\t}\n\n\tif(gantt.templates.marker_class)\n\t\tcss += \" \" + gantt.templates.marker_class(marker);\n\n\tif(marker.title){\n\t\tdiv.title = marker.title;\n\t}\n\tdiv.className = css;\n\n\tvar start = gantt.posFromDate(marker.start_date);\n\tdiv.style.left = start + \"px\";\n\tlet markerHeight = Math.max(gantt.getRowTop(gantt.getVisibleTaskCount()), 0) + \"px\";\n\tif (gantt.config.timeline_placeholder && gantt.$task_data){\n\t\tmarkerHeight = gantt.$task_data.scrollHeight + \"px\";\n\t}\n\tdiv.style.height = markerHeight;\n\tif(marker.end_date){\n\t\tvar end = gantt.posFromDate(marker.end_date);\n\t\tdiv.style.width = Math.max((end - start), 0) + \"px\";\n\n\t}\n\n\tif(marker.text){\n\t\tlet content = null;\n\t\tif(typeof marker.text === \"function\"){\n\t\t\tcontent = marker.text(marker);\n\t\t}else {\n\t\t\tcontent = marker.text;\n\t\t}\n\t\tif(content){\n\t\t\tif(gantt.config.external_render && gantt.config.external_render.isElement(content)){\n\t\t\t\tdiv.innerHTML = \"<div class='gantt_marker_content' ></div>\";\n\t\t\t\tgantt.config.external_render.renderElement(content, div.querySelector(\".gantt_marker_content\"));\n\t\t\t}else{\n\t\t\t\tdiv.innerHTML = \"<div class='gantt_marker_content' >\" + marker.text + \"</div>\";\n\t\t\t}\n\n\t\t}\n\n\n\t\t\n\t}\n\n\treturn div;\n}\n\nfunction initMarkerArea(){\n\t// GS-481. Reset $marker_area if there is no timeline\n\tif(!gantt.$task_data || !gantt.$root.contains(gantt.$task_data)){\n\t\tgantt.$marker_area = null;\n\t\treturn;\n\t}\n\n\t// GS-2084. Don't add $marker_area when it already exists\n\tif(gantt.$marker_area && gantt.$task_data.contains(gantt.$marker_area)){\n\t\treturn;\n\t}\n\n\tvar markerArea = document.createElement(\"div\");\n\tmarkerArea.className = \"gantt_marker_area\";\n\tgantt.$task_data.appendChild(markerArea);\n\tgantt.$marker_area = markerArea;\n}\n\ngantt.attachEvent(\"onBeforeGanttRender\", function(){\n\tif(!gantt.$marker_area)\n\t\tinitMarkerArea();\n});\n\ngantt.attachEvent(\"onDataRender\", function(){\n\tif(!gantt.$marker_area){\n\t\tinitMarkerArea();\n\t\tgantt.renderMarkers();\n\t}\n});\n\ngantt.attachEvent(\"onGanttLayoutReady\", function(){\n\t// GS-1304 - markers should attach when layout is initialized, both on gantt.init and gantt.resetLayout\n\t// wait for \"onBeforeGanttRender\", so all layout elements will be in DOM\n\tgantt.attachEvent(\"onBeforeGanttRender\", function(){\n\t\t// GS-882. If markers are rendered in the onDataRender handler, \n\t\t// they are not attached to the layer, so we need to remove the DOM elements\n\t\tif (gantt.$marker_area) {\n\t\t\tgantt.$marker_area.innerHTML = \"\";\n\t\t}\n\t\tinitMarkerArea();\n\n\t\tvar layers = gantt.$services.getService(\"layers\");\n\t\tvar markerRenderer = layers.createDataRender({\n\t\t\tname: \"marker\",\n\t\t\tdefaultContainer: function(){ return gantt.$marker_area;}\n\t\t});\n\t\tmarkerRenderer.addLayer(render_marker);\n\t}, {once: true});\n});\n\ngantt.getMarker = function(id){\n\tif(!this._markers) return null;\n\n\treturn this._markers.getItem(id);\n};\n\ngantt.addMarker = function(marker){\n\treturn this._markers.addItem(marker);\n};\n\ngantt.deleteMarker = function(id){\n\tif(!this._markers.exists(id))\n\t\treturn false;\n\n\tthis._markers.removeItem(id);\n\treturn true;\n};\ngantt.updateMarker = function(id){\n\tthis._markers.refresh(id);\n};\n\ngantt._getMarkers = function(){\n\treturn this._markers.getItems();\n};\n\ngantt.renderMarkers = function () {\n\tthis._markers.refresh();\n};\n\n};","import {replaceValidZeroId} from \"../utils/helpers\";\n\nexport default function(gantt){\n\ngantt.config.multiselect = true;\ngantt.config.multiselect_one_level = false;\n\ngantt._multiselect = {\n\t_selected: {},\n\t_one_level: false,\n\t_active: true,\n\t_first_selected_when_shift: null,\n\tgetDefaultSelected: function() {\n\t\tvar selected = this.getSelected();\n\t\treturn selected.length ? selected[selected.length - 1] : null;\n\t},\n\tsetFirstSelected: function(id) {\n\t\tthis._first_selected_when_shift = id;\n\t},\n\tgetFirstSelected: function() {\n\t\treturn this._first_selected_when_shift;\n\t},\n\tisActive: function() {\n\t\tthis.updateState();\n\t\treturn this._active;\n\t},\n\tupdateState: function() {\n\t\tthis._one_level = gantt.config.multiselect_one_level;\n\t\tvar active = this._active;\n\t\tthis._active = gantt.config.select_task;\n\t\tif (this._active != active) {\n\t\t\tthis.reset();\n\t\t}\n\t},\n\treset: function () {\n\t\tthis._selected = {};\n\t},\n\tsetLastSelected: function (id) {\n\t\tgantt.$data.tasksStore.silent(function(){\n\t\t\tvar store = gantt.$data.tasksStore;\n\t\t\tif (id)\n\t\t\t\tstore.select(id+\"\");\n\t\t\telse\n\t\t\t\tstore.unselect(null);\n\t\t});\n\t},\n\tgetLastSelected: function () {\n\t\tvar last = gantt.$data.tasksStore.getSelectedId();\n\t\tif (last && gantt.isTaskExists(last))\n\t\t\treturn last;\n\t\treturn null;\n\t},\n\tselect: function (id, e) {\n\t\tif (id && gantt.callEvent(\"onBeforeTaskMultiSelect\", [id, true, e]) && gantt.callEvent(\"onBeforeTaskSelected\", [id])) {\n\t\t\tthis._selected[id] = true;\n\t\t\tthis.setLastSelected(id);\n\t\t\tthis.afterSelect(id);\n\t\t\tgantt.callEvent(\"onTaskMultiSelect\", [id, true, e]);\n\t\t\tgantt.callEvent(\"onTaskSelected\", [id]);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t},\n\ttoggle: function (id, e) {\n\t\tif (this._selected[id]) {\n\t\t\tthis.unselect(id, e);\n\t\t} else {\n\t\t\tthis.select(id, e);\n\t\t}\n\t},\n\tunselect: function (id, e) {\n\t\tif (id && gantt.callEvent(\"onBeforeTaskMultiSelect\", [id, false, e])) {\n\t\t\tthis._selected[id] = false;\n\t\t\tif (this.getLastSelected() == id)\n\t\t\t\tthis.setLastSelected(this.getDefaultSelected());\n\t\t\tthis.afterSelect(id);\n\t\t\tgantt.callEvent(\"onTaskMultiSelect\", [id, false, e]);\n\t\t\tgantt.callEvent(\"onTaskUnselected\", [id]);\n\t\t}\n\t},\n\tisSelected: function (id) {\n\t\treturn !!(gantt.isTaskExists(id) && this._selected[id]);\n\t},\n\tgetSelected: function () {\n\t\tvar res = [];\n\t\tfor (var i in this._selected) {\n\t\t\tif (this._selected[i] && gantt.isTaskExists(i)) {\n\t\t\t\tres.push(i);\n\t\t\t} else {\n\t\t\t\tthis._selected[i] = false;\n\t\t\t}\n\t\t}\n\t\tres.sort(function(a, b) {\n\t\t\treturn gantt.getGlobalTaskIndex(a) > gantt.getGlobalTaskIndex(b) ? 1 : -1;\n\t\t});\n\t\treturn res;\n\t},\n\tforSelected: function (callback) {\n\t\tvar selected = this.getSelected();\n\t\tfor (var i = 0; i < selected.length; i++) {\n\t\t\tcallback(selected[i]);\n\t\t}\n\t},\n\tisSameLevel: function(id) {\n\t\tif (!this._one_level)\n\t\t\treturn true;\n\t\tvar last = this.getLastSelected();\n\t\tif (!last)\n\t\t\treturn true;\n\t\tif (!(gantt.isTaskExists(last) && gantt.isTaskExists(id)))\n\t\t\treturn true;\n\t\treturn !!(gantt.calculateTaskLevel(gantt.getTask(last)) == gantt.calculateTaskLevel(gantt.getTask(id)));\n\t},\n\tafterSelect: function(id) {\n\t\tif (gantt.isTaskExists(id)){\n\t\t\t// FIXME: quick workaround to prevent re-filtering inside refresh on multiselect\n\t\t\tgantt._quickRefresh(function(){\n\t\t\t\tgantt.refreshTask(id);\n\t\t\t});\n\t\t}\n\t},\n\tdoSelection: function(e) {\n\t\tif (!this.isActive())\n\t\t\treturn false;\n\n\t\t// deny selection when click on 'expand' or 'collapse' icons\n\t\tif (gantt._is_icon_open_click(e))\n\t\t\treturn false;\n\n\t\tvar target_ev = gantt.locate(e);\n\t\tif (!target_ev)\n\t\t\treturn false;\n\n\t\tif (!gantt.callEvent(\"onBeforeMultiSelect\", [e]))\n\t\t\treturn false;\n\n\t\tvar selected = this.getSelected();\n\t\tvar defaultLast = this.getFirstSelected();\n\t\tvar isLast = false;\n\t\tvar last = this.getLastSelected();\n\t\tvar multiSelect = gantt.config.multiselect;\n\n\n\t\tvar singleSelection = (function () {\n\t\t\t// GS-719: If the multiselect extension is added we still need a way\n\t\t\t// to open the inline editors after clicking on the cells in the grid\n\t\t\tconst controller = gantt.ext.inlineEditors;\n\t\t\tif(controller && controller.getState){\n\t\t\t\tconst state = controller.getState();\n\t\t\t\tconst cell = controller.locateCell(e.target);\n\n\t\t\t\tif (gantt.config.inline_editors_multiselect_open && cell && controller.getEditorConfig(cell.columnName)) {\n\t\t\t\t\tif (controller.isVisible() && state.id == cell.id && state.columnName == cell.columnName) {\n\t\t\t\t\t\t// do nothing if editor is already active in this cell\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcontroller.startEdit(cell.id, cell.columnName);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.setFirstSelected(target_ev);\n\n\t\t\tif (!this.isSelected(target_ev)) {\n\t\t\t\tthis.select(target_ev, e);\n\t\t\t}\n\t\t\tselected = this.getSelected();\n\t\t\tfor (var i = 0; i < selected.length; i++) {\n\t\t\t\tif (selected[i] !== target_ev) {\n\t\t\t\t\tthis.unselect(selected[i], e);\n\t\t\t\t}\n\t\t\t}\n\t\t}).bind(this);\n\n\t\tvar blockSelection = (function(){\n\t\t\tif (!last)\n\t\t\t\tlast = target_ev;\n\t\t\telse if (target_ev) {\n\t\t\t\tvar first_indx = gantt.getGlobalTaskIndex(this.getFirstSelected());\n\t\t\t\tvar target_indx = gantt.getGlobalTaskIndex(target_ev);\n\t\t\t\tvar last_indx = gantt.getGlobalTaskIndex(last);\n\t\t\t\t// GS-1969: if the selected tasks are collapsed, need to remove them\n\t\t\t\tif(first_indx == -1 || last_indx == -1){\n\t\t\t\t\tfirst_indx = target_indx;\n\t\t\t\t\tthis.reset();\n\t\t\t\t}\n\t\t\t\t// clear prev selection\n\t\t\t\tvar tmp = last;\n\t\t\t\twhile (gantt.getGlobalTaskIndex(tmp) !== first_indx) {\n\t\t\t\t\tthis.unselect(tmp, e);\n\t\t\t\t\ttmp = (first_indx > last_indx) ? gantt.getNext(tmp) : gantt.getPrev(tmp);\n\t\t\t\t}\n\t\t\t\ttmp = target_ev;\n\t\t\t\twhile (gantt.getGlobalTaskIndex(tmp) !== first_indx) {\n\t\t\t\t\tif (this.select(tmp, e) && !isLast) {\n\t\t\t\t\t\tisLast = true;\n\t\t\t\t\t\tdefaultLast = tmp;\n\t\t\t\t\t}\n\t\t\t\t\ttmp = (first_indx > target_indx) ? gantt.getNext(tmp) : gantt.getPrev(tmp);\n\t\t\t\t}\n\t\t\t}\n\t\t}).bind(this);\n\n\n\t\tif (multiSelect && (e.ctrlKey || e.metaKey)) {\n\t\t\tif (!this.isSelected(target_ev))\n\t\t\t\tthis.setFirstSelected(target_ev);\n\n\t\t\tif (target_ev) {\n\t\t\t\tthis.toggle(target_ev, e);\n\t\t\t}\n\t\t}\n\n\t\telse if (multiSelect && e.shiftKey) {\n\t\t\tif (!gantt.isTaskExists(this.getFirstSelected()) || this.getFirstSelected() === null) {\n\t\t\t\tthis.setFirstSelected(target_ev);\n\t\t\t}\n\n\t\t\tif (selected.length) { // select a group of tasks\n\t\t\t\tblockSelection();\n\t\t\t}\n\t\t\telse { // select a task when no task is selected and Shift is pressed\n\t\t\t\tsingleSelection();\n\t\t\t}\n\t\t}\n\t\t\n\t\telse { // no key press or no multiple selection on the mouse click\n\t\t\tsingleSelection();\n\t\t}\n\n\n\t\tif (this.isSelected(target_ev)) {\n\t\t\tthis.setLastSelected(target_ev);\n\t\t} else if (defaultLast) {\n\t\t\tif (target_ev == last)\n\t\t\t\tthis.setLastSelected(e.shiftKey ? defaultLast : this.getDefaultSelected());\n\t\t} else {\n\t\t\tthis.setLastSelected(null);\n\t\t}\n\n\t\tif (!this.getSelected().length)\n\t\t\tthis.setLastSelected(null);\n\n\t\tif (!this.getLastSelected() || !this.isSelected(this.getFirstSelected()))\n\t\t\tthis.setFirstSelected(this.getLastSelected());\n\n\t\treturn true;\n\t}\n};\n\n(function(){\n\tvar old_selectTask = gantt.selectTask;\n\tgantt.selectTask = function(id) {\n\t\tid = replaceValidZeroId(id, this.config.root_id);\n\t\tif (!id)\n\t\t\treturn false;\n\t\tvar multiselect = gantt._multiselect;\n\t\tvar res = id;\n\t\tif (multiselect.isActive()) {\n\t\t\tif (multiselect.select(id, null)) {\n\t\t\t\tmultiselect.setLastSelected(id);\n\t\t\t}\n\t\t\tmultiselect.setFirstSelected(multiselect.getLastSelected());\n\t\t} else {\n\t\t\tres = old_selectTask.call(this, id);\n\t\t}\n\t\treturn res;\n\t};\n\n\tvar old_unselectTask = gantt.unselectTask;\n\tgantt.unselectTask = function(id) {\n\t\tvar multiselect = gantt._multiselect;\n\t\tvar isActive = multiselect.isActive();\n\t\tid = id || multiselect.getLastSelected();\n\t\tif(id && isActive) {\n\t\t\tmultiselect.unselect(id, null);\n\t\t\tif (id == multiselect.getLastSelected())\n\t\t\t\tmultiselect.setLastSelected(null);\n\t\t\tgantt.refreshTask(id);\n\t\t\tmultiselect.setFirstSelected(multiselect.getLastSelected());\n\t\t}\n\t\tvar res = id;\n\t\tif (!isActive)\n\t\t\tres = old_unselectTask.call(this, id);\n\t\treturn res;\n\t};\n\n\tgantt.toggleTaskSelection = function(id) {\n\t\tvar multiselect = gantt._multiselect;\n\t\tif (id && multiselect.isActive()) {\n\t\t\tmultiselect.toggle(id);\n\t\t\tmultiselect.setFirstSelected(multiselect.getLastSelected());\n\t\t}\n\t};\n\tgantt.getSelectedTasks = function() {\n\t\tvar multiselect = gantt._multiselect;\n\t\tmultiselect.isActive();\n\t\treturn multiselect.getSelected();\n\t};\n\tgantt.eachSelectedTask = function(callback){\n\t\treturn this._multiselect.forSelected(callback);\n\t};\n\tgantt.isSelectedTask = function(id){\n\t\treturn this._multiselect.isSelected(id);\n\t};\n\tgantt.getLastSelectedTask = function(){\n\t\treturn this._multiselect.getLastSelected();\n\t};\n\tgantt.attachEvent(\"onGanttReady\", function(){\n\t\tvar old_isSelected = gantt.$data.tasksStore.isSelected;\n\t\tgantt.$data.tasksStore.isSelected = function(id){\n\t\t\tif (gantt._multiselect.isActive()) {\n\t\t\t\treturn gantt._multiselect.isSelected(id);\n\t\t\t}\n\t\t\treturn old_isSelected.call(this, id);\n\t\t};\n\t});\n})();\n\ngantt.attachEvent(\"onTaskIdChange\", function (id, new_id) {\n\tvar multiselect = gantt._multiselect;\n\tif (!multiselect.isActive())\n\t\treturn true;\n\tif (gantt.isSelectedTask(id)) {\n\t\tmultiselect.unselect(id, null);\n\t\tmultiselect.select(new_id, null);\n\t}\n});\n\ngantt.attachEvent(\"onAfterTaskDelete\", function (id, item) {\n\tvar multiselect = gantt._multiselect;\n\tif (!multiselect.isActive())\n\t\treturn true;\n\n\tif (multiselect._selected[id]) {\n\t\t// GS-1057: don't unselect the task here because the task is already unselected \n\t\t// it was in the select.js file before it was deleted\n\t\t// multiselect.unselect(id, null);\n\t\tmultiselect._selected[id] = false;\n\t\tmultiselect.setLastSelected(multiselect.getDefaultSelected());\n\t}\n\n\tmultiselect.forSelected(function (task_id) {\n\t\tif (!gantt.isTaskExists(task_id))\n\t\t\tmultiselect.unselect(task_id, null);\n\t});\n});\n\ngantt.attachEvent(\"onBeforeTaskMultiSelect\", function(id, state, e){\n\tconst multiselect = gantt._multiselect;\n\tif (state && multiselect.isActive()) {\n\t\t//GS-1321: prevent unselecting task\n\t\tlet oldSelectedId = gantt.getSelectedId();\n\t\tlet oldSelectedTask = null;\n\t\tif (oldSelectedId) {\n\t\t\toldSelectedTask = gantt.getTask(oldSelectedId);\n\t\t}\n\t\tlet newSelectedTask = gantt.getTask(id);\n\t\tlet differentTreeLevel = false;\n\t\tif (oldSelectedTask && oldSelectedTask.$level != newSelectedTask.$level){\n\t\t\tdifferentTreeLevel = true;\n\t\t}\n\n\t\tif (gantt.config.multiselect_one_level && differentTreeLevel && !e.ctrlKey && !e.shiftKey) {\n\t\t\treturn true;\n\t\t}\n\t\tif (multiselect._one_level) {\n\t\t\treturn multiselect.isSameLevel(id);\n\t\t}\n\t}\n\treturn true;\n});\n\ngantt.attachEvent(\"onTaskClick\", function(id, e) {\n\tif (gantt._multiselect.doSelection(e))\n\t\tgantt.callEvent(\"onMultiSelect\", [e]);\n\treturn true;\n});\n\n};","export default function(gantt) {\n\tif (!gantt.ext) {\n\t\tgantt.ext = {};\n\t}\n\n\tgantt.ext.overlay = {};\n\n\tvar overlays = {};\n\n\tfunction createOverlay(id, render) {\n\t\tvar div = document.createElement(\"div\");\n\t\tdiv.setAttribute(\"data-overlay-id\", id);\n\t\tvar css = \"gantt_overlay\";\n\t\tdiv.className = css;\n\t\tdiv.style.display = \"none\";\n\t\treturn {\n\t\t\tid: id,\n\t\t\trender: render,\n\t\t\tisVisible: false,\n\t\t\tisAttached: false,\n\t\t\tnode: div\n\t\t};\n\t}\n\n\tfunction initOverlayArea() {\n\t\tif(!gantt.$task_data) {\n\t\t\treturn;\n\t\t}\n\t\tgantt.event(gantt.$task_data, \"scroll\", function(e){\n\t\t\tif (!gantt.ext.$overlay_area) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tgantt.ext.$overlay_area.style.top = e.target.scrollTop + \"px\";\n\t\t});\n\t\tvar overlayArea = document.createElement(\"div\");\n\t\toverlayArea.className = \"gantt_overlay_area\";\n\t\tgantt.$task_data.appendChild(overlayArea);\n\t\tgantt.ext.$overlay_area = overlayArea;\n\n\t\tattachUnnattached();\n\t}\n\n\tfunction attachUnnattached(){\n\t\tfor(var i in overlays){\n\t\t\tvar overlay = overlays[i];\n\t\t\tif(!overlay.isAttached){\n\t\t\t\tattachOverlay(overlay);\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction attachOverlay(overlay){\n\t\tgantt.ext.$overlay_area.appendChild(overlay.node);\n\t\toverlay.isAttached = true;\n\t}\n\n\tfunction showOverlayArea(){\n\t\tgantt.ext.$overlay_area.style.display = \"block\";\n\t}\n\n\tfunction hideIfNoVisibleLayers(){\n\t\tvar any = false;\n\t\tfor(var i in overlays){\n\t\t\tvar overlay = overlays[i];\n\t\t\tif(overlay.isVisible){\n\t\t\t\tany = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif(!any){\n\t\t\tgantt.ext.$overlay_area.style.display = \"none\";\n\t\t}\n\t}\n\n\tgantt.attachEvent(\"onBeforeGanttRender\", function() {\n\t\t//GS-2230: in case if `getGanttInstance` created without container\n\t\tif(!gantt.$root) return;\n\t\tif (!gantt.ext.$overlay_area) {\n\t\t\tinitOverlayArea();\n\t\t}\n\n\t\tif (!gantt.ext.$overlay_area.isConnected){\n\t\t\tgantt.ext.$overlay_area.innerHTML = \"\";\n\t\t\tgantt.ext.$overlay_area.remove();\n\t\t\tgantt.ext.$overlay_area = null;\n\t\t\tinitOverlayArea();\n\t\n\t\t\tfor(var i in overlays){\n\t\t\t\toverlays[i].isAttached = false;\n\t\t\t}\n\t\t}\n\n\t\tattachUnnattached();\n\t\thideIfNoVisibleLayers();\n\t});\n\n\tgantt.attachEvent(\"onGanttReady\", function() {\n\t\t//GS-2230: in case if `getGanttInstance` created without container\n\t\tif(!gantt.$root) return;\n\t\tinitOverlayArea();\n\t\tattachUnnattached();\n\t\thideIfNoVisibleLayers();\n\t});\n\n\tgantt.ext.overlay.addOverlay = function(render, id) {\n\t\tvar id = id || gantt.uid();\n\t\toverlays[id] = createOverlay(id, render);\n\t\treturn id;\n\t};\n\n\tgantt.ext.overlay.deleteOverlay = function(id) {\n\t\tif (!overlays[id])\n\t\t\treturn false;\n\n\t\tdelete overlays[id];\n\t\thideIfNoVisibleLayers();\n\t\treturn true;\n\t};\n\n\tgantt.ext.overlay.getOverlaysIds = function() {\n\t\tvar ids = [];\n\t\tfor(var i in overlays){\n\t\t\tids.push(i);\n\t\t}\n\t\treturn ids;\n\t};\n\n\tgantt.ext.overlay.refreshOverlay = function(id) {\n\t\tshowOverlayArea();\n\t\toverlays[id].isVisible = true;\n\t\toverlays[id].node.innerHTML = \"\";\n\t\toverlays[id].node.style.display = \"block\";\n\t\toverlays[id].render(overlays[id].node);\n\t};\n\n\tgantt.ext.overlay.showOverlay = function(id) {\n\t\tshowOverlayArea();\n\t\tthis.refreshOverlay(id);\n\t};\n\n\tgantt.ext.overlay.hideOverlay = function(id) {\n\n\t\toverlays[id].isVisible = false;\n\t\toverlays[id].node.style.display = \"none\";\n\t\thideIfNoVisibleLayers();\n\t};\n\tgantt.ext.overlay.isOverlayVisible = function(id) {\n\t\tif (!id) {\n\t\t\treturn false;\n\t\t}\n\t\treturn overlays[id].isVisible;\n\t};\n};","/* eslint-disable */\n\nimport ScaleHelper from \"../../core/ui/timeline/scales_ignore\";\nimport * as helpers from \"../../utils/helpers\";\n\nexport default function(gantt: any) {\n\n\tgantt.ext = gantt.ext || {};\n\n\tgantt.ext.export_api = gantt.ext.export_api || {\n\n\t\t_apiUrl: \"https://export.dhtmlx.com/gantt\",\n\n\t\t_preparePDFConfigRaw(config:any, type:any){\n\t\t\tlet previousDateRage:any = null;\n\t\t\tif (config.start && config.end){\n\t\t\t\tpreviousDateRage = {\n\t\t\t\t\tstart_date: gantt.config.start_date,\n\t\t\t\t\tend_date: gantt.config.end_date,\n\t\t\t\t};\n\t\t\t\tgantt.config.start_date = gantt.date.str_to_date(gantt.config.date_format)(config.start);\n\t\t\t\tgantt.config.end_date = gantt.date.str_to_date(gantt.config.date_format)(config.end);\n\t\t\t}\n\n\t\t\tconfig = gantt.mixin(config, {\n\t\t\t\tname: \"gantt.\" + type, data: gantt.ext.export_api._serializeHtml()\n\t\t\t});\n\n\t\t\tif (previousDateRage){\n\t\t\t\tgantt.config.start_date = previousDateRage.start_date;\n\t\t\t\tgantt.config.end_date = previousDateRage.end_date;\n\t\t\t}\n\t\t},\n\n\t\t_prepareConfigPDF(config:any, type:any){\n\t\t\tconfig = gantt.mixin((config || {}), {\n\t\t\t\tname: \"gantt.\" + type,\n\t\t\t\tdata: gantt.ext.export_api._serializeAll(),\n\t\t\t\tconfig: gantt.config\n\t\t\t});\n\t\t\tgantt.ext.export_api._fixColumns(config.config.columns);\n\t\t\treturn config;\n\t\t},\n\n\t\t_pdfExportRouter(config:any, type:any){\n\t\t\tif (config && config.raw) {\n\t\t\t\tgantt.ext.export_api._preparePDFConfigRaw(config, type);\n\t\t\t} else {\n\t\t\t\tconfig = gantt.ext.export_api._prepareConfigPDF(config, type);\n\t\t\t}\n\t\t\tconfig.version = gantt.version;\n\t\t\tgantt.ext.export_api._sendToExport(config, type);\n\t\t},\n\n\t\texportToPDF(config:any) {\n\t\t\tgantt.ext.export_api._pdfExportRouter(config, \"pdf\");\n\t\t},\n\n\t\texportToPNG(config:any) {\n\t\t\tgantt.ext.export_api._pdfExportRouter(config, \"png\");\n\t\t},\n\n\n\t\texportToICal(config:any) {\n\t\t\tconfig = gantt.mixin((config || {}), {\n\t\t\t\tname: \"gantt.ical\",\n\t\t\t\tdata: gantt.ext.export_api._serializePlain().data,\n\t\t\t\tversion: gantt.version\n\t\t\t});\n\t\t\tgantt.ext.export_api._sendToExport(config, \"ical\");\n\t\t},\n\n\t\texportToExcel(config:any) {\n\t\t\tconfig = config || {};\n\n\t\t\tlet tasks;\n\t\t\tlet dates: any = [];\n\t\t\tlet state;\n\t\t\tlet scroll;\n\t\t\t// GS-2124, we need to get all task nodes to correctly obtain the colors\n\t\t\tconst smartRendering = gantt.config.smart_rendering;\n\t\t\tif (config.visual === \"base-colors\"){\n\t\t\t\tgantt.config.smart_rendering = false;\n\t\t\t}\n\n\t\t\tif (config.start || config.end) {\n\t\t\t\tstate = gantt.getState();\n\t\t\t\tdates = [gantt.config.start_date, gantt.config.end_date];\n\t\t\t\tscroll = gantt.getScrollState();\n\t\t\t\tconst convert = gantt.date.str_to_date(gantt.config.date_format);\n\t\t\t\ttasks = gantt.eachTask;\n\n\t\t\t\tif (config.start){\n\t\t\t\t\tgantt.config.start_date = convert(config.start);\n\t\t\t\t}\n\t\t\t\tif (config.end){\n\t\t\t\t\tgantt.config.end_date = convert(config.end);\n\t\t\t\t}\n\n\t\t\t\tgantt.render();\n\t\t\t\tgantt.config.smart_rendering = smartRendering;\n\n\t\t\t\tgantt.eachTask = gantt.ext.export_api._eachTaskTimed(gantt.config.start_date, gantt.config.end_date);\n\t\t\t} else if (config.visual === \"base-colors\"){\n\t\t\t\tgantt.render();\n\t\t\t\tgantt.config.smart_rendering = smartRendering;\n\t\t\t}\n\n\t\t\tconfig = gantt.mixin(config, {\n\t\t\t\tname: \"gantt.xlsx\",\n\t\t\t\ttitle: \"Tasks\",\n\t\t\t\tdata: gantt.ext.export_api._serializeTimeline(config),\n\t\t\t\tcolumns: gantt.ext.export_api._serializeGrid({ raw: config.raw, rawDates: true }),\n\t\t\t\tversion: gantt.version\n\t\t\t});\n\n\t\t\tif (config.visual){\n\t\t\t\tconfig.scales = gantt.ext.export_api._serializeScales(config);\n\t\t\t}\n\n\t\t\tgantt.ext.export_api._sendToExport(config, \"excel\");\n\n\t\t\tif (config.start || config.end) {\n\t\t\t\tgantt.config.start_date = state.min_date;\n\t\t\t\tgantt.config.end_date = state.max_date;\n\t\t\t\tgantt.eachTask = tasks;\n\n\t\t\t\tgantt.render();\n\t\t\t\tgantt.scrollTo(scroll.x, scroll.y);\n\n\t\t\t\tgantt.config.start_date = dates[0];\n\t\t\t\tgantt.config.end_date = dates[1];\n\t\t\t}\n\t\t},\n\n\t\texportToJSON(config:any) {\n\t\t\tconfig = gantt.mixin((config || {}), {\n\t\t\t\tname: \"gantt.json\",\n\t\t\t\tdata: gantt.ext.export_api._serializeAll(),\n\t\t\t\tconfig: gantt.config,\n\t\t\t\tcolumns: gantt.ext.export_api._serializeGrid(),\n\t\t\t\tworktime: gantt.ext.export_api._getWorktimeSettings(),\n\t\t\t\tversion: gantt.version\n\t\t\t});\n\t\t\tgantt.ext.export_api._sendToExport(config, \"json\");\n\t\t},\n\n\n\t\timportFromExcel(config:any) {\n\t\t\ttry {\n\t\t\t\tconst formData = config.data;\n\t\t\t\tif (formData instanceof File) {\n\t\t\t\t\tconst data = new FormData();\n\t\t\t\t\tdata.append(\"file\", formData);\n\t\t\t\t\tconfig.data = data;\n\t\t\t\t}\n\t\t\t} catch (error) {}\n\t\t\tgantt.ext.export_api._sendImportAjaxExcel(config);\n\t\t},\n\n\t\timportFromMSProject(config:any) {\n\t\t\tconst formData = config.data;\n\t\t\ttry {\n\t\t\t\tif (formData  instanceof File) {\n\t\t\t\t\tconst data = new FormData();\n\t\t\t\t\tdata.append(\"file\", formData);\n\t\t\t\t\tconfig.data = data;\n\t\t\t\t}\n\t\t\t} catch (error) {}\n\t\t\tgantt.ext.export_api._sendImportAjaxMSP(config);\n\t\t},\n\n\t\timportFromPrimaveraP6(config:any) {\n\t\t\tconfig.type = \"primaveraP6-parse\";\n\t\t\treturn gantt.importFromMSProject(config);\n\t\t},\n\n\t\texportToMSProject(config:any) {\n\t\t\tconfig = config || {};\n\t\t\tconfig.skip_circular_links = config.skip_circular_links === undefined ? true : !!config.skip_circular_links;\n\n\t\t\tconst oldXmlFormat = gantt.templates.xml_format;\n\t\t\tconst oldFormatDate = gantt.templates.format_date;\n\t\t\tconst oldXmlDate = gantt.config.xml_date;\n\t\t\tconst oldDateFormat = gantt.config.date_format;\n\n\t\t\tconst exportServiceDateFormat = \"%d-%m-%Y %H:%i:%s\";\n\n\t\t\tgantt.config.xml_date = exportServiceDateFormat;\n\t\t\tgantt.config.date_format = exportServiceDateFormat;\n\t\t\tgantt.templates.xml_format = gantt.date.date_to_str(exportServiceDateFormat);\n\t\t\tgantt.templates.format_date = gantt.date.date_to_str(exportServiceDateFormat);\n\t\t\tconst data = gantt.ext.export_api._serializeAll();\n\n\t\t\tgantt.ext.export_api._customProjectProperties(data, config);\n\n\t\t\tgantt.ext.export_api._customTaskProperties(data, config);\n\n\t\t\tif (config.skip_circular_links) {\n\t\t\t\tgantt.ext.export_api._clearRecLinks(data);\n\t\t\t}\n\n\t\t\tconfig = gantt.ext.export_api._exportConfig(data, config);\n\n\t\t\tgantt.ext.export_api._sendToExport(config, config.type || \"msproject\");\n\t\t\tgantt.config.xml_date = oldXmlDate;\n\t\t\tgantt.config.date_format = oldDateFormat;\n\t\t\tgantt.templates.xml_format = oldXmlFormat;\n\t\t\tgantt.templates.format_date = oldFormatDate;\n\n\t\t\tgantt.config.$custom_data = null;\n\t\t\tgantt.config.custom = null;\n\t\t},\n\n\t\texportToPrimaveraP6(config:any) {\n\t\t\tconfig = config || {};\n\t\t\tconfig.type = \"primaveraP6\";\n\t\t\treturn gantt.exportToMSProject(config);\n\t\t},\n\n\t\t_fixColumns(columns:any) {\n\t\t\tfor (let i = 0; i < columns.length; i++) {\n\t\t\t\tcolumns[i].label = columns[i].label || gantt.locale.labels[\"column_\" + columns[i].name];\n\t\t\t\tif (typeof columns[i].width === \"string\") {\n\t\t\t\t\tcolumns[i].width = columns[i].width * 1;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_xdr(url:any, pack:any, cb:any) {\n\t\t\tgantt.ajax.post(url, pack, cb);\n\t\t},\n\n\t\t_markColumns(base:any) {\n\t\t\tconst columns = base.config.columns;\n\t\t\tif (columns){\n\t\t\t\tfor (let i = 0; i < columns.length; i++) {\n\t\t\t\t\tif (columns[i].template){\n\t\t\t\t\t\tcolumns[i].$template = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\n\t\t_sendImportAjaxExcel(config:any) {\n\t\t\tconst url = config.server || gantt.ext.export_api._apiUrl;\n\t\t\tconst store = config.store || 0;\n\t\t\tconst formData = config.data;\n\t\t\tconst callback = config.callback;\n\n\t\t\tformData.append(\"type\", \"excel-parse\");\n\t\t\tformData.append(\"data\", JSON.stringify({\n\t\t\t\tsheet: config.sheet || 0\n\t\t\t}));\n\n\t\t\tif (store){\n\t\t\t\tformData.append(\"store\", store);\n\t\t\t}\n\n\t\t\tconst xhr = new XMLHttpRequest();\n\t\t\txhr.onreadystatechange = function(e) {\n\t\t\t\tif (xhr.readyState === 4 && xhr.status === 0) {// network error\n\t\t\t\t\tif (callback) {\n\t\t\t\t\t\tcallback(null);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\txhr.onload = function() {\n\t\t\t\tconst fail = xhr.status > 400;\n\t\t\t\tlet info = null;\n\n\t\t\t\tif (!fail) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tinfo = JSON.parse(xhr.responseText);\n\t\t\t\t\t} catch (e) { }\n\t\t\t\t}\n\n\t\t\t\tif (callback) {\n\t\t\t\t\tcallback(info);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\txhr.open(\"POST\", url, true);\n\t\t\txhr.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n\t\t\txhr.send(formData);\n\t\t},\n\n\n\t\t_ajaxToExport(data:any, type:any, callback:any) {\n\t\t\tdelete data.callback;\n\n\t\t\tconst url = data.server || gantt.ext.export_api._apiUrl;\n\t\t\tconst pack = \"type=\" + type + \"&store=1&data=\" + encodeURIComponent(JSON.stringify(data));\n\n\t\t\tconst cb = function(loader:any) {\n\t\t\t\tconst xdoc = loader.xmlDoc || loader;\n\t\t\t\tconst fail = xdoc.status > 400;\n\t\t\t\tlet info = null;\n\n\t\t\t\tif (!fail) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tinfo = JSON.parse(xdoc.responseText);\n\t\t\t\t\t} catch (e) { }\n\t\t\t\t}\n\t\t\t\tcallback(info);\n\t\t\t};\n\n\t\t\tgantt.ext.export_api._xdr(url, pack, cb);\n\t\t},\n\t\t_serializableGanttConfig(config:any) {\n\t\t\tconst result = gantt.mixin({}, config);\n\n\t\t\tif (result.columns) {\n\t\t\t\tresult.columns = result.columns.map(function(col:any) {\n\t\t\t\t\tconst copy = gantt.mixin({}, col);\n\t\t\t\t\tdelete copy.editor;\n\t\t\t\t\treturn copy;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tdelete result.editor_types;\n\t\t\treturn result;\n\t\t},\n\n\t\t_sendToExport(data:any, type:any) {\n\t\t\tconst convert = gantt.date.date_to_str(gantt.config.date_format || gantt.config.xml_date);\n\t\t\tif(!data.skin){\n\t\t\t\tdata.skin = gantt.skin;\n\t\t\t}\n\t\t\tif (data.config) {\n\t\t\t\tdata.config = gantt.copy(gantt.ext.export_api._serializableGanttConfig(data.config));\n\t\t\t\tgantt.ext.export_api._markColumns(data, type);\n\n\t\t\t\tif (data.config.start_date && data.config.end_date) {\n\t\t\t\t\tif (data.config.start_date instanceof Date) {\n\t\t\t\t\t\tdata.config.start_date = convert(data.config.start_date);\n\t\t\t\t\t}\n\t\t\t\t\tif (data.config.end_date instanceof Date) {\n\t\t\t\t\t\tdata.config.end_date = convert(data.config.end_date);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (data.callback) {\n\t\t\t\treturn gantt.ext.export_api._ajaxToExport(data, type, data.callback);\n\t\t\t}\n\n\t\t\tconst form = gantt.ext.export_api._createHiddenForm();\n\t\t\tform.firstChild.action = data.server || gantt.ext.export_api._apiUrl;\n\t\t\tform.firstChild.childNodes[0].value = JSON.stringify(data);\n\t\t\tform.firstChild.childNodes[1].value = type;\n\t\t\tform.firstChild.submit();\n\t\t},\n\n\t\t_createHiddenForm() {\n\t\t\tif (!gantt.ext.export_api._hidden_export_form) {\n\t\t\t\tconst t = gantt.ext.export_api._hidden_export_form = document.createElement(\"div\");\n\t\t\t\tt.style.display = \"none\";\n\t\t\t\tt.innerHTML = \"<form method='POST' target='_blank'><textarea name='data' style='width:0px; height:0px;' readonly='true'></textarea><input type='hidden' name='type' value=''></form>\";\n\t\t\t\tdocument.body.appendChild(t);\n\t\t\t}\n\t\t\treturn gantt.ext.export_api._hidden_export_form;\n\t\t},\n\n\n\t\t_copyObjectBase(obj: any) {\n\t\t\tconst copy: any = {\n\t\t\t\tstart_date: undefined,\n\t\t\t\tend_date: undefined,\n\t\t\t\tconstraint_date: undefined,\n\t\t\t\tdeadline: undefined\n\t\t\t};\n\t\t\tfor (const key in obj) {\n\t\t\t\tif (key.charAt(0) === \"$\" || key === \"baselines\"){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tcopy[key] = obj[key];\n\t\t\t}\n\t\t\tconst formatDate = gantt.templates.xml_format || gantt.templates.format_date;\n\n\t\t\tcopy.start_date = formatDate(copy.start_date);\n\t\t\tif (copy.end_date){\n\t\t\t\tcopy.end_date = formatDate(copy.end_date);\n\t\t\t}\n\t\t\tif (copy.constraint_date){\n\t\t\t\tcopy.constraint_date = formatDate(copy.constraint_date);\n\t\t\t}\n\t\t\tif (copy.deadline){\n\t\t\t\tcopy.deadline = formatDate(copy.deadline);\n\t\t\t}\n\n\t\t\treturn copy;\n\t\t},\n\n\n\t\t_color_box: null,\n\t\t_color_hash: {},\n\n\t\t_getStyles(css:any) {\n\t\t\tif (!gantt.ext.export_api._color_box) {\n\t\t\t\tgantt.ext.export_api._color_box = document.createElement(\"DIV\");\n\t\t\t\tgantt.ext.export_api._color_box.style.cssText = \"position:absolute; display:none;\";\n\t\t\t\tdocument.body.appendChild(gantt.ext.export_api._color_box);\n\t\t\t}\n\t\t\tif (gantt.ext.export_api._color_hash[css]){\n\t\t\t\treturn gantt.ext.export_api._color_hash[css];\n\t\t\t}\n\n\t\t\tgantt.ext.export_api._color_box.className = css;\n\t\t\tconst color = gantt.ext.export_api._getColor(gantt.ext.export_api._color_box, \"color\");\n\t\t\tconst backgroundColor = gantt.ext.export_api._getColor(gantt.ext.export_api._color_box, \"backgroundColor\");\n\t\t\treturn (gantt.ext.export_api._color_hash[css] = color + \";\" + backgroundColor);\n\t\t},\n\n\n\t\t_getMinutesWorktimeSettings(parsedRanges:any) {\n\t\t\tconst minutes:any = [];\n\t\t\tparsedRanges.forEach(function(range:any) {\n\t\t\t\tminutes.push(range.startMinute);\n\t\t\t\tminutes.push(range.endMinute);\n\t\t\t});\n\t\t\treturn minutes;\n\t\t},\n\n\t\t_getWorktimeSettings() {\n\n\t\t\tconst defaultWorkTimes = {\n\t\t\t\thours: [0, 24],\n\t\t\t\tminutes: null,\n\t\t\t\tdates: { 0: true, 1: true, 2: true, 3: true, 4: true, 5: true, 6: true }\n\t\t\t};\n\n\t\t\tlet time: any;\n\t\t\tif (!gantt.config.work_time) {\n\t\t\t\ttime = defaultWorkTimes;\n\t\t\t} else {\n\t\t\t\tconst wTime = gantt._working_time_helper;\n\t\t\t\tif (wTime && wTime.get_calendar) {\n\t\t\t\t\ttime = wTime.get_calendar();\n\t\t\t\t} else if (wTime) {\n\t\t\t\t\ttime = {\n\t\t\t\t\t\thours: wTime.hours,\n\t\t\t\t\t\tminutes: null,\n\t\t\t\t\t\tdates: wTime.dates\n\t\t\t\t\t};\n\t\t\t\t} else if (gantt.config.worktimes && gantt.config.worktimes.global) {\n\t\t\t\t\tconst settings = gantt.config.worktimes.global;\n\n\t\t\t\t\tif (settings.parsed) {\n\t\t\t\t\t\tconst minutes = gantt.ext.export_api._getMinutesWorktimeSettings(settings.parsed.hours);\n\t\t\t\t\t\ttime = {\n\t\t\t\t\t\t\thours: null,\n\t\t\t\t\t\t\tminutes,\n\t\t\t\t\t\t\tdates: {}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tfor (const i in settings.parsed.dates) {\n\t\t\t\t\t\t\tif (Array.isArray(settings.parsed.dates[i])) {\n\t\t\t\t\t\t\t\ttime.dates[i] = gantt.ext.export_api._getMinutesWorktimeSettings(settings.parsed.dates[i]);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttime.dates[i] = settings.parsed.dates[i];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttime = {\n\t\t\t\t\t\t\thours: settings.hours,\n\t\t\t\t\t\t\tminutes: null,\n\t\t\t\t\t\t\tdates: settings.dates\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\t\t\t\t\ttime = defaultWorkTimes;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn time;\n\t\t},\n\n\n\t\t_eachTaskTimed(start:any, end:any) {\n\t\t\treturn function(code:any, parent:any, master:any) {\n\t\t\t\tparent = parent || gantt.config.root_id;\n\t\t\t\tmaster = master || gantt;\n\n\t\t\t\tconst branch = gantt.getChildren(parent);\n\t\t\t\tif (branch){\n\t\t\t\t\tfor (let i = 0; i < branch.length; i++) {\n\t\t\t\t\t\tconst item = gantt._pull[branch[i]];\n\t\t\t\t\t\tif ((!start || item.end_date > start) && (!end || item.start_date < end)){\n\t\t\t\t\t\t\tcode.call(master, item);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (gantt.hasChild(item.id)){\n\t\t\t\t\t\t\tgantt.eachTask(code, item.id, master);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\n\n\t\t// patch broken json serialization in gantt 2.1\n\t\t_originalCopyObject: gantt.json._copyObject,\n\n\t\t_copyObjectPlainICal(task: any) {\n\t\t\tconst text = gantt.templates.task_text(task.start_date, task.end_date, task);\n\n\t\t\tconst copy = gantt.ext.export_api._copyObjectBase(task);\n\t\t\tcopy.text = text || copy.text;\n\n\t\t\treturn copy;\n\t\t},\n\n\t\t_copyObjectPlainExcel(task: any) {\n\t\t\tconst text = gantt.templates.task_text(task.start_date, task.end_date, task);\n\n\t\t\tconst copy = gantt.json.serializeTask(task);\n\t\t\tcopy.text = text || copy.text;\n\n\t\t\treturn copy;\n\t\t},\n\n\t\t_getColor(node:any, style:any) {\n\t\t\tlet value = node.currentStyle ? node.currentStyle[style] : getComputedStyle(node, null)[style];\n\t\t\t// if we get the black background color for the progress bar, \n\t\t\t// most likely, it is the transparent color.\n\t\t\t// In that case, we need to confirm that and return the color of the task bar\n\t\t\tif (node.closest(\".gantt_task_progress\") && value === \"rgba(0, 0, 0, 0.15)\"){\n\t\t\t\tnode = node.parentNode.parentNode;\n\t\t\t\tvalue = node.currentStyle ? node.currentStyle[style] : getComputedStyle(node, null)[style];\n\t\t\t}\n\t\t\tconst rgb = value.replace(/\\s/g, \"\").match(/^rgba?\\((\\d+),(\\d+),(\\d+)/i);\n\t\t\treturn ((rgb && rgb.length === 4) ?\n\t\t\t\t(\"0\" + parseInt(rgb[1], 10).toString(16)).slice(-2) +\n\t\t\t\t(\"0\" + parseInt(rgb[2], 10).toString(16)).slice(-2) +\n\t\t\t\t(\"0\" + parseInt(rgb[3], 10).toString(16)).slice(-2) : value).replace(\"#\", \"\");\n\t\t},\n\n\n\t\t// excel serialization\n\t\t_copyObjectTable(obj:any) {\n\t\t\t// Excel interprets UTC time as local time in every timezone, send local time instead of actual UTC time.\n\t\t\t// https://github.com/SheetJS/js-xlsx/issues/126#issuecomment-60531614\n\t\t\tconst toISOstring = gantt.date.date_to_str(\"%Y-%m-%dT%H:%i:%s.000Z\");\n\n\t\t\tconst copy = gantt.ext.export_api._copyObjectColumns(obj, gantt.ext.export_api._copyObjectPlainExcel(obj));\n\t\t\tif (copy.start_date){\n\t\t\t\tif (typeof copy.start_date === \"string\"){\n\t\t\t\t\tcopy.original_start_date = gantt.date.str_to_date(gantt.config.date_format)(copy.start_date);\n\t\t\t\t} else {\n\t\t\t\t\tcopy.original_start_date = copy.start_date;\n\t\t\t\t\tcopy.start_date = toISOstring(obj.start_date);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (copy.end_date){\n\t\t\t\tif (typeof copy.end_date === \"string\"){\n\t\t\t\t\tcopy.original_end_date = gantt.date.str_to_date(gantt.config.date_format)(copy.end_date);\n\t\t\t\t} else {\n\t\t\t\t\tcopy.original_end_date = copy.end_date;\n\t\t\t\t\tcopy.end_date = toISOstring(obj.end_date);\n\t\t\t\t}\n\t\t\t} else if (copy.original_start_date){\n\t\t\t\tcopy.original_end_date = gantt.calculateEndDate({\n\t\t\t\t\tstart_date: copy.original_start_date,\n\t\t\t\t\tduration: copy.duration,\n\t\t\t\t\ttask: copy\n\t\t\t\t});\n\t\t\t\tcopy.end_date = toISOstring(copy.original_end_date);\n\t\t\t}\n\n\t\t\treturn copy;\n\t\t},\n\n\t\t_generatedScales: null,\n\t\t_generateScales(){\n\t\t\tconst state = gantt.getState();\n\t\t\tconst scaleHelper = ScaleHelper(gantt);\n\t\t\tconst scales = [scaleHelper.primaryScale(gantt.config)].concat(scaleHelper.getSubScales(gantt.config));\n\n\t\t\tconst scalesConfig = scaleHelper.prepareConfigs(scales, gantt.config.min_column_width, 1000, gantt.config.scale_height - 1, state.min_date, state.max_date, gantt.config.rtl);\n\t\t\tgantt.ext.export_api._generatedScales = scalesConfig;\n\t\t\treturn scalesConfig;\n\t\t},\n\n\t\t_getDayIndex (scales:any, date:any){\n\t\t\tlet days = scales.trace_indexes\n\t\t\tif (days[+date]) {\n\t\t\t\treturn days[+date]\n\t\t\t} else {\n\t\t\t\tdays = scales.trace_x;\n\t\t\t\tconst state = gantt.getState();\n\n\t\t\t\tif (+date <= state.min_date) {\n\t\t\t\t\tif (gantt.config.rtl) {\n\t\t\t\t\t\treturn days.length;\n\t\t\t\t\t} else{\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t}\n\t\t\t\t} else if (+date >= state.max_date) {\n\t\t\t\t\tif (gantt.config.rtl) {\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn days.length;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconst index = helpers.findBinary(days, +date);\n\t\t\t\treturn index;\n\t\t\t}\n\t\t},\n\n\t\t_copyObjectColors(obj:any, config:any) {\n\t\t\tconst copy = gantt.ext.export_api._copyObjectTable(obj);\n\n\t\t\tlet startDate = copy.original_start_date;\n\t\t\tlet endDate = copy.original_end_date;\n\n\t\t\tlet getDayIndex = gantt.columnIndexByDate;\n\n\t\t\tlet scales;\n\t\t\tif (gantt.ext.export_api._generatedScales){ \n\t\t\t\tconst allScales = gantt.ext.export_api._generatedScales;\n\t\t\t\tscales = allScales[allScales.length - 1];\n\n\t\t\t\tcopy.$start = gantt.ext.export_api._getDayIndex(scales, startDate);\n\t\t\t\tcopy.$end = gantt.ext.export_api._getDayIndex(scales, endDate);\n\t\t\t} else {\n\t\t\t\tscales = gantt.getScale();\n\t\t\t\tcopy.$start = getDayIndex.call(gantt, startDate);\n\t\t\t\tcopy.$end = getDayIndex.call(gantt, endDate);\n\t\t\t}\n\n\t\t\t// GS-2100. Correct bar position considering hidden cells\n\t\t\tlet hiddenCells = 0;\n\t\t\tconst scaleCellsWidth = scales.width;\n\t\t\tif (scaleCellsWidth.indexOf(0) > -1) {\n\t\t\t\tlet i = 0;\n\t\t\t\tfor (i; i < copy.$start; i++) {\n\t\t\t\t\tif (!scaleCellsWidth[i]) {\n\t\t\t\t\t\thiddenCells++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcopy.$start -= hiddenCells;\n\n\t\t\t\tfor (i; i < copy.$end; i++) {\n\t\t\t\t\tif (!scaleCellsWidth[i]) {\n\t\t\t\t\t\thiddenCells++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcopy.$end -= hiddenCells;\n\t\t\t}\n\n\t\t\tcopy.$level = obj.$level;\n\t\t\tcopy.$type = obj.$rendered_type;\n\n\t\t\tconst tmps = gantt.templates;\n\t\t\tcopy.$text = tmps.task_text(obj.start, obj.end_date, obj);\n\t\t\tcopy.$left = tmps.leftside_text ? tmps.leftside_text(obj.start, obj.end_date, obj) : \"\";\n\t\t\tcopy.$right = tmps.rightside_text ? tmps.rightside_text(obj.start, obj.end_date, obj) : \"\";\n\n\t\t\tconst node = gantt.getTaskNode && gantt.getTaskNode(obj.id);\n\t\t\tif (node && node.firstChild) {\n\t\t\t\tlet targetNode = node;\n\t\t\t\tif (config.visual !== \"base-colors\"){\n\t\t\t\t\ttargetNode = node.querySelector(\".gantt_task_progress\")\n\t\t\t\t}\n\n\t\t\t\tlet color = gantt.ext.export_api._getColor(targetNode, \"backgroundColor\");\n\t\t\t\tif (color === \"363636\"){\n\t\t\t\t\tcolor = gantt.ext.export_api._getColor(node, \"backgroundColor\");\n\t\t\t\t}\n\n\t\t\t\tcopy.$color = color;\n\t\t\t} else if (obj.color){\n\t\t\t\tcopy.$color = obj.color;\n\t\t\t} else {\n\t\t\t\tconst cellCss = gantt.templates.task_class(obj.start, obj.end, obj);\n\t\t\t\tif (cellCss){\n\t\t\t\t\tconst styles = gantt.ext.export_api._getStyles(cellCss);\n\t\t\t\t\tcopy.$color = styles.split(\";\")[1]\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn copy;\n\t\t},\n\n\t\t_copyObjectColumns(obj:any, copy:any) {\n\t\t\tfor (let i = 0; i < gantt.config.columns.length; i++) {\n\t\t\t\tconst ct = gantt.config.columns[i].template;\n\t\t\t\tif (ct) {\n\t\t\t\t\tlet val = ct(obj);\n\t\t\t\t\tif (val instanceof Date){\n\t\t\t\t\t\tval = gantt.templates.date_grid(val, obj);\n\t\t\t\t\t}\n\t\t\t\t\tcopy[\"_\" + i] = val;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn copy;\n\t\t},\n\n\t\t_copyObjectAll(obj:any) {\n\t\t\tconst copy = gantt.ext.export_api._copyObjectBase(obj);\n\n\t\t\tconst templates = [\n\t\t\t\t\"leftside_text\",\n\t\t\t\t\"rightside_text\",\n\t\t\t\t\"task_text\",\n\t\t\t\t\"progress_text\",\n\t\t\t\t\"task_class\"\n\t\t\t];\n\n\t\t\t// serialize all text templates\n\t\t\tfor (let i = 0; i < templates.length; i++) {\n\t\t\t\tconst template = gantt.templates[templates[i]];\n\t\t\t\tif (template){\n\t\t\t\t\tcopy[\"$\" + i] = template(obj.start_date, obj.end_date, obj);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tgantt.ext.export_api._copyObjectColumns(obj, copy);\n\t\t\tcopy.open = obj.$open;\n\t\t\treturn copy;\n\t\t},\n\n\n\t\t_serializeHtml() {\n\t\t\tconst smartScales = gantt.config.smart_scales;\n\t\t\tconst smartRendering = gantt.config.smart_rendering;\n\t\t\tif (smartScales || smartRendering) {\n\t\t\t\tgantt.config.smart_rendering = false;\n\t\t\t\tgantt.config.smart_scales = false;\n\t\t\t\tgantt.render();\n\t\t\t}\n\n\t\t\tconst html = gantt.$container.parentNode.innerHTML;\n\n\t\t\tif (smartScales || smartRendering) {\n\t\t\t\tgantt.config.smart_scales = smartScales;\n\t\t\t\tgantt.config.smart_rendering = smartRendering;\n\t\t\t\tgantt.render();\n\t\t\t}\n\n\t\t\treturn html;\n\t\t},\n\n\t\t_serializeAll() {\n\t\t\tgantt.json._copyObject = gantt.ext.export_api._copyObjectAll;\n\t\t\tconst data = gantt.ext.export_api._exportSerialize();\n\t\t\tgantt.json._copyObject = gantt.ext.export_api._originalCopyObject;\n\t\t\treturn data;\n\t\t},\n\n\t\t_serializePlain() {\n\t\t\tconst oldXmlFormat = gantt.templates.xml_format;\n\t\t\tconst oldFormatDate = gantt.templates.format_date;\n\t\t\tgantt.templates.xml_format = gantt.date.date_to_str(\"%Y%m%dT%H%i%s\", true);\n\t\t\tgantt.templates.format_date = gantt.date.date_to_str(\"%Y%m%dT%H%i%s\", true);\n\t\t\tgantt.json._copyObject = gantt.ext.export_api._copyObjectPlainICal;\n\n\t\t\tconst data = gantt.ext.export_api._exportSerialize();\n\n\t\t\tgantt.templates.xml_format = oldXmlFormat;\n\t\t\tgantt.templates.format_date = oldFormatDate;\n\t\t\tgantt.json._copyObject = gantt.ext.export_api._originalCopyObject;\n\n\t\t\tdelete data.links;\n\t\t\treturn data;\n\t\t},\n\n\t\t_getRaw() {\n\t\t\tconst timeline = gantt.$ui.getView(\"timeline\");\n\t\t\tif (timeline && gantt.config.show_chart) {\n\t\t\t\tlet availWidth = timeline.$config.width;\n\t\t\t\tif (gantt.config.autosize === \"x\" || gantt.config.autosize === \"xy\") {\n\t\t\t\t\tavailWidth = Math.max(gantt.config.autosize_min_width, 0);\n\t\t\t\t}\n\t\t\t\tconst state = gantt.getState();\n\t\t\t\tconst scales = timeline._getScales();\n\t\t\t\tconst minWidth = gantt.config.min_column_width;\n\t\t\t\tconst height = gantt.config.scale_height - 1;\n\t\t\t\tconst rtl = gantt.config.rtl;\n\n\t\t\t\treturn timeline.$scaleHelper.prepareConfigs(scales, minWidth, availWidth, height, state.min_date, state.max_date, rtl);\n\t\t\t} else {\n\t\t\t\treturn gantt.ext.export_api._generateScales();\n\t\t\t}\n\t\t},\n\n\t\t_serializeTimeline(config:any) {\n\t\t\tgantt.ext.export_api._generatedScales = null;\n\t\t\tlet scales;\n\t\t\tif (config.visual){\n\t\t\t\tscales = gantt.ext.export_api._getRaw(config.start, config.end);\n\t\t\t}\n\t\t\tif (config.data){\n\t\t\t\tconfig.custom_dataset = true;\n\t\t\t}\n\n\t\t\tlet tasks = config.data || gantt.serialize().data;\n\t\t\ttasks.forEach(function(task:any, index:any){\n\t\t\t\tif (config.visual){\n\t\t\t\t\t// Save split tasks dates inside the parent object\n\t\t\t\t\tif (task.render == \"split\"){\n\t\t\t\t\t\tconst children:any = [];\n\t\t\t\t\t\tif (config.custom_dataset){\n\t\t\t\t\t\t\ttasks.forEach(function(child:any){\n\t\t\t\t\t\t\t\tif (child.parent == task.id){\n\t\t\t\t\t\t\t\t\tconst childBar = gantt.ext.export_api._copyObjectColors(child, config);\n\t\t\t\t\t\t\t\t\tchildBar.$split_subtask = true;\n\t\t\t\t\t\t\t\t\tchildren.push(childBar);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tgantt.eachTask(function(child:any){\n\t\t\t\t\t\t\t\tconst childBar = gantt.ext.export_api._copyObjectColors(child, config);\n\t\t\t\t\t\t\t\tchildren.push(childBar);\n\t\t\t\t\t\t\t}, task.id);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttask.split_bars = [];\n\n\t\t\t\t\t\t// Skip overlap children\n\t\t\t\t\t\tconst skippedTasks:any = {};\n\t\t\t\t\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\t\t\t\t\tconst child = children[i];\n\t\t\t\t\t\t\tfor (let j = 0; j < children.length; j++) {\n\t\t\t\t\t\t\t\tconst sibling = children[j];\n\t\t\t\t\t\t\t\tif (child.id == sibling.id || skippedTasks[sibling.id]){\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tconst overlap = +child.original_start_date < +sibling.original_start_date && +sibling.original_start_date <= +child.original_end_date;\n\t\t\t\t\t\t\t\t// const overlap = +child.original_start_date < +sibling.original_end_date && +sibling.original_end_date <= +child.original_end_date;\n\t\t\t\t\t\t\t\tconst cover = +sibling.original_start_date <= +child.original_start_date && +child.original_end_date <= +sibling.original_end_date;\n\t\t\t\t\t\t\t\tif (overlap){\n\t\t\t\t\t\t\t\t\tchild.original_end_date = sibling.original_start_date;\n\t\t\t\t\t\t\t\t\tchild.end_date = sibling.start_date;\n\t\t\t\t\t\t\t\t\tchild.$end = sibling.$start;\n\t\t\t\t\t\t\t\t\t// child.original_start_date = sibling.original_end_date;\n\t\t\t\t\t\t\t\t\t// child.start_date = sibling.end_date;\n\t\t\t\t\t\t\t\t\t// child.$start = sibling.$end;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (cover){\n\t\t\t\t\t\t\t\t\t// skip the task as it won't be visible\n\t\t\t\t\t\t\t\t\tskippedTasks[child.id] = true;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!skippedTasks[child.id]){\n\t\t\t\t\t\t\t\ttask.split_bars.push(child)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttasks[index] = task;\n\t\t\t\t\t} else if (!task.$split_subtask){\n\t\t\t\t\t\ttasks[index] = gantt.ext.export_api._copyObjectColors(task, config);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\ttasks[index] = gantt.ext.export_api._copyObjectTable(task);\n\t\t\t\t}\n\t\t\t})\n\n\t\t\t// Filter tasks\n\t\t\tif (config.raw && !config.data){\n\t\t\t\tconst taskStore = gantt.getDatastore(\"task\");\n\t\t\t\tconst filteredIds = taskStore.visibleOrder;\n\t\t\t\tif (tasks.length !== filteredIds.length){\n\t\t\t\t\tconst filteredDataset:any = [];\n\t\t\t\t\ttasks.forEach(function(task:any){\n\t\t\t\t\t\tif (filteredIds.indexOf(task.id) > -1){\n\t\t\t\t\t\t\tfilteredDataset.push(task);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\ttasks = filteredDataset;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (config.cellColors) {\n\t\t\t\tconst css = gantt.templates.timeline_cell_class || gantt.templates.task_cell_class;\n\t\t\t\tif (css) {\n\t\t\t\t\tlet steps = scales[0].trace_x;\n\t\t\t\t\tfor (let i = 1; i < scales.length; i++){\n\t\t\t\t\t\tif (scales[i].trace_x.length > steps.length){\n\t\t\t\t\t\t\tsteps = scales[i].trace_x;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (let i = 0; i < tasks.length; i++) {\n\t\t\t\t\t\ttasks[i].styles = [];\n\t\t\t\t\t\tconst task = gantt.getTask(tasks[i].id);\n\t\t\t\t\t\tfor (let j = 0; j < steps.length; j++) {\n\t\t\t\t\t\t\tconst date = steps[j];\n\t\t\t\t\t\t\tconst cellCss = css(task, date);\n\t\t\t\t\t\t\tif (cellCss){\n\t\t\t\t\t\t\t\ttasks[i].styles.push({ index: j, styles: gantt.ext.export_api._getStyles(cellCss) });\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn tasks;\n\t\t},\n\n\t\t_serializeScales(config:any) {\n\t\t\tconst scales:any = [];\n\t\t\tconst raw = gantt.ext.export_api._getRaw();\n\n\t\t\tlet min = Infinity;\n\t\t\tlet max = 0;\n\t\t\tfor (let i = 0; i < raw.length; i++) {\n\t\t\t\tmin = Math.min(min, raw[i].col_width);\n\t\t\t}\n\n\t\t\tfor (let i = 0; i < raw.length; i++) {\n\t\t\t\tlet start = 0;\n\t\t\t\tlet end = 0;\n\t\t\t\tconst row:any = [];\n\n\t\t\t\tscales.push(row);\n\t\t\t\tconst step = raw[i];\n\t\t\t\tmax = Math.max(max, step.trace_x.length);\n\t\t\t\tconst template = step.format || step.template || gantt.date.date_to_str(step.date);\n\n\t\t\t\tfor (let j = 0; j < step.trace_x.length; j++) {\n\t\t\t\t\tconst date = step.trace_x[j];\n\t\t\t\t\tend = start + Math.round(step.width[j] / min);\n\n\t\t\t\t\tconst scaleCell = { text: template(date), start, end, styles: \"\" };\n\n\t\t\t\t\tif (config.cellColors) {\n\t\t\t\t\t\tconst css = step.css || gantt.templates.scaleCell_class;\n\t\t\t\t\t\tif (css) {\n\t\t\t\t\t\t\tconst scaleCss = css(date);\n\t\t\t\t\t\t\tif (scaleCss){\n\t\t\t\t\t\t\t\tscaleCell.styles = gantt.ext.export_api._getStyles(scaleCss);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\trow.push(scaleCell);\n\t\t\t\t\tstart = end;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn { width: max, height: scales.length, data: scales };\n\t\t},\n\n\t\t_serializeGrid(config:any) {\n\t\t\tgantt.exportMode = true;\n\n\t\t\tconst columns:any = [];\n\t\t\tconst cols = gantt.config.columns;\n\n\t\t\tlet ccount = 0;\n\t\t\tfor (let i = 0; i < cols.length; i++) {\n\t\t\t\tif (cols[i].name === \"add\" || cols[i].name === \"buttons\") {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (config && config.raw && cols[i].hide){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tcolumns[ccount] = {\n\t\t\t\t\tid: ((cols[i].template) ? (\"_\" + i) : cols[i].name),\n\t\t\t\t\theader: cols[i].label || gantt.locale.labels[\"column_\" + cols[i].name],\n\t\t\t\t\twidth: (cols[i].width ? Math.floor(cols[i].width / 4) : \"\"),\n\t\t\t\t\ttree: cols[i].tree || false\n\t\t\t\t};\n\n\t\t\t\tif (cols[i].name === \"duration\"){\n\t\t\t\t\tcolumns[ccount].type = \"number\";\n\t\t\t\t}\n\t\t\t\tif (cols[i].name === \"start_date\" || cols[i].name === \"end_date\") {\n\t\t\t\t\tcolumns[ccount].type = \"date\";\n\t\t\t\t\tif (config && config.rawDates){\n\t\t\t\t\t\tcolumns[ccount].id = cols[i].name;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tccount++;\n\t\t\t}\n\n\t\t\tgantt.exportMode = false;\n\t\t\treturn columns;\n\t\t},\n\n\t\t_exportSerialize() {\n\t\t\tgantt.exportMode = true;\n\n\t\t\tconst xmlFormat = gantt.templates.xml_format;\n\t\t\tconst formatDate = gantt.templates.format_date;\n\n\t\t\t// use configuration date format for serialization so date could be parsed on the export\n\t\t\t// required when custom format date function is defined\n\t\t\tgantt.templates.xml_format =\n\t\t\t\tgantt.templates.format_date =\n\t\t\t\tgantt.date.date_to_str(gantt.config.date_format || gantt.config.xml_date);\n\n\t\t\tconst data = gantt.serialize();\n\n\t\t\tgantt.templates.xml_format = xmlFormat;\n\t\t\tgantt.templates.format_date = formatDate;\n\t\t\tgantt.exportMode = false;\n\t\t\treturn data;\n\t\t},\n\n\n\t\t_setLevel(data:any) {\n\t\t\tfor (let i = 0; i < data.length; i++) {\n\t\t\t\t// tslint:disable-next-line triple-equals\n\t\t\t\tif (data[i].parent == 0) {\n\t\t\t\t\tdata[i]._lvl = 1;\n\t\t\t\t}\n\t\t\t\tfor (let j = i + 1; j < data.length; j++) {\n\t\t\t\t\t// tslint:disable-next-line triple-equals\n\t\t\t\t\tif (data[i].id == data[j].parent) {\n\t\t\t\t\t\tdata[j]._lvl = data[i]._lvl + 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_clearLevel(data:any) {\n\t\t\tfor (let i = 0; i < data.length; i++) {\n\t\t\t\tdelete data[i]._lvl;\n\t\t\t}\n\t\t},\n\n\t\t_clearRecLinks(data:any) {\n\t\t\tgantt.ext.export_api._setLevel(data.data);\n\t\t\tconst tasks:any = {};\n\t\t\tfor (let i = 0; i < data.data.length; i++) {\n\t\t\t\ttasks[data.data[i].id] = data.data[i];\n\t\t\t}\n\n\t\t\tconst links:any = {};\n\n\t\t\tfor (let i = 0; i < data.links.length; i++) {\n\t\t\t\tconst link = data.links[i];\n\t\t\t\tif (gantt.isTaskExists(link.source) && gantt.isTaskExists(link.target) &&\n\t\t\t\t\ttasks[link.source] && tasks[link.target]) {\n\t\t\t\t\tlinks[link.id] = link;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (const j in links) {\n\t\t\t\tgantt.ext.export_api._makeLinksSameLevel(links[j], tasks);\n\t\t\t}\n\n\t\t\tconst skippedLinks = {};\n\t\t\tfor (const j in tasks) {\n\t\t\t\tgantt.ext.export_api._clearCircDependencies(tasks[j], links, tasks, {}, skippedLinks, null);\n\t\t\t}\n\n\t\t\tif (Object.keys(links)) {\n\t\t\t\tgantt.ext.export_api._clearLinksSameLevel(links, tasks);\n\t\t\t}\n\n\t\t\tfor (let i = 0; i < data.links.length; i++) {\n\t\t\t\tif (!links[data.links[i].id]) {\n\t\t\t\t\tdata.links.splice(i, 1);\n\t\t\t\t\ti--;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tgantt.ext.export_api._clearLevel(data.data);\n\t\t},\n\n\t\t_clearCircDependencies(task:any, links:any, tasks:any, usedTasks:any, skippedLinks:any, prevLink:any) {\n\t\t\tconst sources = task.$_source;\n\t\t\tif (!sources) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (usedTasks[task.id]) {\n\t\t\t\tgantt.ext.export_api._onCircDependencyFind(prevLink, links, usedTasks, skippedLinks);\n\t\t\t}\n\n\t\t\tusedTasks[task.id] = true;\n\n\t\t\tconst targets:any = {};\n\n\t\t\tfor (let i = 0; i < sources.length; i++) {\n\t\t\t\tif (skippedLinks[sources[i]]) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tconst curLink = links[sources[i]];\n\t\t\t\tconst targetTask = tasks[curLink._target];\n\t\t\t\tif (targets[targetTask.id]) { // two link from one task to another\n\t\t\t\t\tgantt.ext.export_api._onCircDependencyFind(curLink, links, usedTasks, skippedLinks);\n\t\t\t\t}\n\t\t\t\ttargets[targetTask.id] = true;\n\t\t\t\tgantt.ext.export_api._clearCircDependencies(targetTask, links, tasks, usedTasks, skippedLinks, curLink);\n\t\t\t}\n\t\t\tusedTasks[task.id] = false;\n\t\t},\n\n\t\t_onCircDependencyFind(link:any, links:any, usedTasks:any, skippedLinks:any) {\n\t\t\tif (link) {\n\t\t\t\tif (gantt.callEvent(\"onExportCircularDependency\", [link.id, link])) {\n\t\t\t\t\tdelete links[link.id];\n\t\t\t\t}\n\n\t\t\t\tdelete usedTasks[link._source];\n\t\t\t\tdelete usedTasks[link._target];\n\t\t\t\tskippedLinks[link.id] = true;\n\t\t\t}\n\t\t},\n\n\t\t_makeLinksSameLevel(link:any, tasks:any) {\n\t\t\tlet task;\n\t\t\tlet targetLvl;\n\t\t\tconst linkT:any = {\n\t\t\t\ttarget: tasks[link.target],\n\t\t\t\tsource: tasks[link.source]\n\t\t\t};\n\t\t\t// tslint:disable-next-line triple-equals\n\t\t\tif (linkT.target._lvl != linkT.source._lvl) {\n\t\t\t\tif (linkT.target._lvl < linkT.source._lvl) {\n\t\t\t\t\ttask = \"source\";\n\t\t\t\t\ttargetLvl = linkT.target._lvl;\n\t\t\t\t} else {\n\t\t\t\t\ttask = \"target\";\n\t\t\t\t\ttargetLvl = linkT.source._lvl;\n\t\t\t\t}\n\n\t\t\t\tdo {\n\t\t\t\t\tconst parent = tasks[linkT[task].parent];\n\t\t\t\t\tif (!parent) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tlinkT[task] = parent;\n\t\t\t\t} while (linkT[task]._lvl < targetLvl);\n\n\t\t\t\tlet sourceParent = tasks[linkT.source.parent];\n\t\t\t\tlet\ttargetParent = tasks[linkT.target.parent];\n\t\t\t\t// tslint:disable-next-line triple-equals\n\t\t\t\twhile (sourceParent && targetParent && sourceParent.id != targetParent.id) {\n\t\t\t\t\tlinkT.source = sourceParent;\n\t\t\t\t\tlinkT.target = targetParent;\n\t\t\t\t\tsourceParent = tasks[linkT.source.parent];\n\t\t\t\t\ttargetParent = tasks[linkT.target.parent];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlink._target = linkT.target.id;\n\t\t\tlink._source = linkT.source.id;\n\n\t\t\tif (!linkT.target.$_target){\n\t\t\t\tlinkT.target.$_target = [];\n\t\t\t}\n\t\t\tlinkT.target.$_target.push(link.id);\n\n\t\t\tif (!linkT.source.$_source){\n\t\t\t\tlinkT.source.$_source = [];\n\t\t\t}\n\t\t\tlinkT.source.$_source.push(link.id);\n\t\t},\n\n\t\t_clearLinksSameLevel(links:any, tasks:any) {\n\t\t\tfor (const link in links) {\n\t\t\t\tdelete links[link]._target;\n\t\t\t\tdelete links[link]._source;\n\t\t\t}\n\n\t\t\tfor (const task in tasks) {\n\t\t\t\tdelete tasks[task].$_source;\n\t\t\t\tdelete tasks[task].$_target;\n\t\t\t}\n\t\t},\n\n\n\t\t_customProjectProperties(data:any, config:any) {\n\t\t\tif (config && config.project) {\n\t\t\t\tfor (const i in config.project) {\n\t\t\t\t\tif (!gantt.config.$custom_data){\n\t\t\t\t\t\tgantt.config.$custom_data = {};\n\t\t\t\t\t}\n\t\t\t\t\tgantt.config.$custom_data[i] = typeof config.project[i] === \"function\" ? config.project[i](gantt.config) : config.project[i];\n\t\t\t\t}\n\t\t\t\tdelete config.project;\n\t\t\t}\n\t\t},\n\n\t\t_customTaskProperties(data:any, config:any) {\n\t\t\tif (config && config.tasks) {\n\t\t\t\tdata.data.forEach(function(el:any) {\n\t\t\t\t\tfor (const i in config.tasks) {\n\t\t\t\t\t\tif (!el.$custom_data){\n\t\t\t\t\t\t\tel.$custom_data = {};\n\t\t\t\t\t\t}\n\t\t\t\t\t\tel.$custom_data[i] = typeof config.tasks[i] === \"function\" ? config.tasks[i](el, gantt.config) : config.tasks[i];\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tdelete config.tasks;\n\t\t\t}\n\t\t},\n\n\t\t_exportConfig(data:any, config:any) {\n\t\t\tconst projectName = config.name || \"gantt.xml\";\n\t\t\tdelete config.name;\n\n\t\t\tgantt.config.custom = config;\n\n\t\t\tconst time = gantt.ext.export_api._getWorktimeSettings();\n\n\t\t\tconst projectDates = gantt.getSubtaskDates();\n\t\t\tif (projectDates.start_date && projectDates.end_date) {\n\t\t\t\tconst formatDate = gantt.templates.format_date || gantt.templates.xml_format;\n\t\t\t\tgantt.config.start_end = {\n\t\t\t\t\tstart_date: formatDate(projectDates.start_date),\n\t\t\t\t\tend_date: formatDate(projectDates.end_date)\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\n\t\t\tconst manual = !!(autoSchedulingConfig.enabled);\n\n\t\t\tconst res:any = {\n\t\t\t\tcallback: config.callback || null,\n\t\t\t\tconfig: gantt.config,\n\t\t\t\tdata,\n\t\t\t\tmanual,\n\t\t\t\tname: projectName,\n\t\t\t\tworktime: time\n\t\t\t};\n\t\t\tfor (const i in config) {\n\t\t\t\tres[i] = config[i];\n\t\t\t}\n\t\t\treturn res;\n\t\t},\n\n\n\t\t_sendImportAjaxMSP(config:any) {\n\t\t\tconst url = config.server || gantt.ext.export_api._apiUrl;\n\t\t\tconst store = config.store || 0;\n\t\t\tconst formData = config.data;\n\t\t\tconst callback = config.callback;\n\n\t\t\tconst settings = {\n\t\t\t\tdurationUnit: config.durationUnit || undefined,\n\t\t\t\tprojectProperties: config.projectProperties || undefined,\n\t\t\t\ttaskProperties: config.taskProperties || undefined\n\t\t\t};\n\n\t\t\tformData.append(\"type\", config.type || \"msproject-parse\");\n\t\t\tformData.append(\"data\", JSON.stringify(settings));\n\n\t\t\tif (store){\n\t\t\t\tformData.append(\"store\", store);\n\t\t\t}\n\n\t\t\tconst xhr = new XMLHttpRequest();\n\t\t\txhr.onreadystatechange = function(e) {\n\t\t\t\tif (xhr.readyState === 4 && xhr.status === 0) {// network error\n\t\t\t\t\tif (callback) {\n\t\t\t\t\t\tcallback(null);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\txhr.onload = function(){\n\t\t\t\tconst fail = xhr.status > 400;\n\t\t\t\tlet info = null;\n\n\t\t\t\tif (!fail) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tinfo = JSON.parse(xhr.responseText);\n\t\t\t\t\t} catch (e) { }\n\t\t\t\t}\n\n\t\t\t\tif (callback) {\n\t\t\t\t\tcallback(info);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\txhr.open(\"POST\", url, true);\n\t\t\txhr.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n\t\t\txhr.send(formData);\n\t\t}\n\n\t};\n\n\n\tgantt.exportToPDF = gantt.ext.export_api.exportToPDF;\n\tgantt.exportToPNG = gantt.ext.export_api.exportToPNG;\n\tgantt.exportToICal = gantt.ext.export_api.exportToICal;\n\tgantt.exportToExcel = gantt.ext.export_api.exportToExcel;\n\tgantt.exportToJSON = gantt.ext.export_api.exportToJSON;\n\tgantt.importFromExcel = gantt.ext.export_api.importFromExcel;\n\tgantt.importFromMSProject = gantt.ext.export_api.importFromMSProject;\n\tgantt.exportToMSProject = gantt.ext.export_api.exportToMSProject;\n\tgantt.importFromPrimaveraP6 = gantt.ext.export_api.importFromPrimaveraP6;\n\tgantt.exportToPrimaveraP6 = gantt.ext.export_api.exportToPrimaveraP6;\n\n\n\treturn gantt.ext.export_api;\n}\n","export default class ExtensionsManager{\n\tprivate _extensions:{[key:string]: GanttPlugin };\n\n\tconstructor(config: {[key:string]: GanttPlugin }){\n\t\tthis._extensions = {};\n\t\tfor(const i in config){\n\t\t\tthis._extensions[i] = config[i];\n\t\t}\n\t}\n\n\taddExtension = (name: string, ext: GanttPlugin) => {\n\t\tthis._extensions[name] = ext;\n\t};\n\n\tgetExtension = (name: string): GanttPlugin => {\n\t\treturn this._extensions[name];\n\t};\n}","export default {\n\tKEY_CODES: {\n\t\tUP: 38,\n\t\tDOWN: 40,\n\t\tLEFT: 37,\n\t\tRIGHT: 39,\n\t\tSPACE: 32,\n\t\tENTER: 13,\n\t\tDELETE: 46,\n\t\tESC: 27,\n\t\tTAB: 9\n\t}\n};","import global from \"./global\";\n\n/* eslint-disable no-restricted-globals */\nvar isWindowAwailable = typeof window !== \"undefined\";\n\n/* eslint-enable no-restricted-globals */\n\nconst nav = typeof navigator !== \"undefined\" ? navigator : {userAgent:\"\"};\n\nexport default {\n\tisIE: isWindowAwailable && (nav.userAgent.indexOf(\"MSIE\") >= 0 || nav.userAgent.indexOf(\"Trident\") >= 0),\n\tisOpera: isWindowAwailable && (nav.userAgent.indexOf(\"Opera\") >= 0 || nav.userAgent.indexOf(\"OPR\") >= 0),\n\tisChrome: isWindowAwailable && (nav.userAgent.indexOf(\"Chrome\") >= 0),\n\tisSafari: isWindowAwailable && (nav.userAgent.indexOf(\"Safari\") >= 0 || nav.userAgent.indexOf(\"Konqueror\") >= 0),\n\tisFF: isWindowAwailable && (nav.userAgent.indexOf(\"Firefox\") >= 0),\n\tisIPad: isWindowAwailable && (nav.userAgent.search(/iPad/gi) >= 0),\n\tisEdge: isWindowAwailable && (nav.userAgent.indexOf(\"Edge\")!=-1),\n\tisNode: (!isWindowAwailable || typeof navigator == \"undefined\" || (typeof PRODUCTION !== \"undefined\" && PRODUCTION === \"test\")),\n\tisSalesforce: isWindowAwailable && (!!global[\"Sfdc\"] || !!global[\"$A\"] || global[\"Aura\"])\n};\n","export default function serialize(data: object | string) {\n\tif (typeof data === \"string\" || typeof data === \"number\") {\n\t\treturn data;\n\t}\n\n\tlet result = \"\";\n\n\tfor (const key in data) {\n\t\tlet serialized = \"\";\n\t\tif (data.hasOwnProperty(key)) {\n\t\t\tif (typeof data[key] === \"string\") {\n\t\t\t\tserialized = encodeURIComponent(data[key]);\n\t\t\t} else if (typeof data[key] === \"number\") {\n\t\t\t\tserialized = String(data[key]);\n\t\t\t} else {\n\t\t\t\tserialized = encodeURIComponent(JSON.stringify(data[key]));\n\t\t\t}\n\t\t\tserialized = key + \"=\" + serialized;\n\n\t\t\tif (result.length) {\n\t\t\t\tserialized = \"&\" + serialized;\n\t\t\t}\n\t\t\tresult += serialized;\n\t\t}\n\t}\n\treturn result;\n}\n","import env from \"../../utils/env\";\nimport global from \"../../utils/global\";\nimport serialize from \"./serialize\";\n\nfunction createConfig(method, args) {\n\tvar result = {\n\t\tmethod: method\n\t};\n\n\tif (args.length === 0) {\n\t\tthrow new Error(\"Arguments list of query is wrong.\");\n\t}\n\tif (args.length === 1) {\n\t\tif (typeof args[0] === \"string\") {\n\t\t\tresult.url = args[0];\n\t\t\tresult.async = true;\n\t\t} else {\n\t\t\tresult.url = args[0].url;\n\t\t\tresult.async = (args[0].async || true);\n\t\t\tresult.callback = args[0].callback;\n\t\t\tresult.headers = args[0].headers;\n\t\t}\n\t\tif (method === \"POST\" || \"PUT\") {\n\t\t\tif (args[0].data) {\n\t\t\t\tif (typeof args[0].data !== \"string\") {\n\t\t\t\t\tresult.data = serialize(args[0].data);\n\t\t\t\t} else {\n\t\t\t\t\tresult.data = args[0].data;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresult.data = \"\";\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tresult.url = args[0];\n\tswitch(method) {\n\t\tcase \"GET\":\n\t\tcase \"DELETE\":\n\t\t\tresult.callback = args[1];\n\t\t\tresult.headers = args[2];\n\t\tbreak;\n\t\tcase \"POST\":\n\t\tcase \"PUT\":\n\t\t\tif (args[1]) {\n\t\t\t\tif (typeof args[1] !== \"string\") {\n\t\t\t\t\tresult.data = serialize(args[1]);\n\t\t\t\t} else {\n\t\t\t\t\tresult.data = args[1];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresult.data = \"\";\n\t\t\t}\n\t\t\tresult.callback = args[2];\n\t\t\tresult.headers = args[3];\n\t\tbreak;\n\t}\n\treturn result;\n}\n\nexport default function(gantt) {\n\treturn {\n\n\t\t// if false - dhxr param will added to prevent caching on client side (default),\n\t\t// if true - do not add extra params\n\t\tcache: true,\n\n\t\t// default method for load/loadStruct, post/get allowed\n\t\t// get - since 4.1.1, this should fix 412 error for macos safari\n\t\tmethod: \"get\",\n\n\t\tparse: function(data) {\n\t\t\tif (typeof data !== \"string\") return data;\n\n\t\t\tvar obj;\n\t\t\tdata = data.replace(/^[\\s]+/,\"\");\n\t\t\tif (typeof DOMParser !== \"undefined\" && !env.isIE) { // ff,ie9\n\t\t\t\tobj = (new DOMParser()).parseFromString(data, \"text/xml\");\n\t\t\t} else if (typeof global.ActiveXObject !== \"undefined\") {\n\t\t\t\tobj = new global.ActiveXObject(\"Microsoft.XMLDOM\");\n\t\t\t\tobj.async = \"false\";\n\t\t\t\tobj.loadXML(data);\n\t\t\t}\n\t\t\treturn obj;\n\t\t},\n\t\txmltop: function(tagname, xhr, obj) {\n\t\t\tif (typeof xhr.status == \"undefined\" || xhr.status < 400) {\n\t\t\t\tvar xml = (!xhr.responseXML) ? this.parse(xhr.responseText || xhr) : (xhr.responseXML || xhr);\n\t\t\t\tif (xml && xml.documentElement !== null && !xml.getElementsByTagName(\"parsererror\").length) {\n\t\t\t\t\treturn xml.getElementsByTagName(tagname)[0];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (obj !== -1) gantt.callEvent(\"onLoadXMLError\",[\"Incorrect XML\", arguments[1], obj]);\n\t\t\treturn document.createElement(\"DIV\");\n\t\t},\n\t\txpath: function(xpathExp, docObj) {\n\t\t\tif (!docObj.nodeName) docObj = docObj.responseXML || docObj;\n\t\t\tif (env.isIE) {\n\t\t\t\treturn docObj.selectNodes(xpathExp)||[];\n\t\t\t} else {\n\t\t\t\tvar rows = [];\n\t\t\t\tvar first;\n\t\t\t\tvar col = (docObj.ownerDocument||docObj).evaluate(xpathExp, docObj, null, XPathResult.ANY_TYPE, null);\n\n\t\t\t\twhile (true){\n\t\t\t\t\tfirst = col.iterateNext();\n\t\t\t\t\tif(first){\n\t\t\t\t\t\trows.push(first);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn rows;\n\t\t\t}\n\t\t},\n\t\tquery: function(config) {\n\t\t\treturn this._call(\n\t\t\t\t(config.method || \"GET\"),\n\t\t\t\tconfig.url,\n\t\t\t\tconfig.data || \"\",\n\t\t\t\t(config.async || true),\n\t\t\t\tconfig.callback,\n\t\t\t\tconfig.headers\n\t\t\t);\n\t\t},\n\t\tget: function(url, onLoad, headers) {\n\t\t\tvar config = createConfig(\"GET\", arguments);\n\t\t\treturn this.query(config);\n\t\t},\n\t\tgetSync: function(url, headers) {\n\t\t\tvar config = createConfig(\"GET\", arguments);\n\t\t\tconfig.async = false;\n\t\t\treturn this.query(config);\n\t\t},\n\t\tput: function(url, postData, onLoad, headers) {\n\t\t\tvar config = createConfig(\"PUT\", arguments);\n\t\t\treturn this.query(config);\n\t\t},\n\t\tdel: function(url, onLoad, headers) {\n\t\t\t/**\n\t\t\t * https://tools.ietf.org/html/rfc7231#section-4.3.5\n\t\t\t * A payload within a DELETE request message has no defined semantics;\n\t\t\t * sending a payload body on a DELETE request might cause some existing\n\t\t\t * implementations to reject the request.\n\t\t\t */\n\t\t\tvar config = createConfig(\"DELETE\", arguments);\n\t\t\treturn this.query(config);\n\t\t},\n\t\tpost: function(url, postData, onLoad, headers) {\n\t\t\tif (arguments.length == 1) {\n\t\t\t\tpostData = \"\";\n\t\t\t} else if (arguments.length == 2 && typeof(postData) == \"function\") {\n\t\t\t\tonLoad = postData;\n\t\t\t\tpostData = \"\";\n\t\t\t}\n\t\t\tvar config = createConfig(\"POST\", arguments);\n\t\t\treturn this.query(config);\n\t\t},\n\t\tpostSync: function(url, postData, headers) {\n\t\t\tpostData = (postData === null ? \"\" : String(postData));\n\n\t\t\tvar config = createConfig(\"POST\", arguments);\n\t\t\tconfig.async = false;\n\t\t\treturn this.query(config);\n\t\t},\n\t\t_call: function(method, url, postData, async, onLoad, headers) {\n\t\t\treturn new gantt.Promise(function(resolve, reject) {\n\t\t\t\tvar t = (typeof XMLHttpRequest !== undefined ? new XMLHttpRequest() : new global.ActiveXObject(\"Microsoft.XMLHTTP\"));\n\t\t\t\tvar isQt = (navigator.userAgent.match(/AppleWebKit/) !== null && navigator.userAgent.match(/Qt/) !== null && navigator.userAgent.match(/Safari/) !== null);\n\n\t\t\t\tif (!!async) {\n\t\t\t\t\tt.onreadystatechange = function() {\n\t\t\t\t\t\tif ((t.readyState == 4) || (isQt && t.readyState == 3)) { // what for long response and status 404?\n\t\t\t\t\t\t\tconst errorStatus = t.status < 200 || t.status > 299;\n\t\t\t\t\t\t\tif (errorStatus || t.responseText === \"\")\n\t\t\t\t\t\t\t\tif (!gantt.callEvent(\"onAjaxError\", [t])) return;\n\n\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\tif (typeof(onLoad) == \"function\") {\n\t\t\t\t\t\t\t\t\tonLoad.apply(global, [{xmlDoc:t, filePath:url}]); // dhtmlx-compat, response.xmlDoc.responseXML/responseText\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tresolve(t);\n\t\t\t\t\t\t\t\tif (typeof(onLoad) == \"function\") {\n\t\t\t\t\t\t\t\t\tonLoad = null;\n\t\t\t\t\t\t\t\t\tt = null;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, 0);\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar noCache = !this || !this.cache;\n\t\t\t\tif (method == \"GET\" && noCache) {\n\t\t\t\t\turl += (url.indexOf(\"?\")>=0?\"&\":\"?\")+\"dhxr\"+new Date().getTime()+\"=1\";\n\t\t\t\t}\n\n\t\t\t\tt.open(method, url, async);\n\n\t\t\t\tif (headers){\n\t\t\t\t\tfor (var key in headers)\n\t\t\t\t\t\tt.setRequestHeader(key, headers[key]);\n\t\t\t\t} else if (method.toUpperCase() == \"POST\" || method == \"PUT\" || method == \"DELETE\") {\n\t\t\t\t\tt.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\n\t\t\t\t} else if (method == \"GET\") {\n\t\t\t\t\tpostData = null;\n\t\t\t\t}\n\n\t\t\t\tt.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n\n\t\t\t\tt.send(postData);\n\n\t\t\t\tif (!async) return {xmlDoc:t, filePath:url}; // dhtmlx-compat, response.xmlDoc.responseXML/responseText\n\t\t\t});\n\t\t},\n\t\turlSeparator: function(str){\n\t\t\tif (str.indexOf(\"?\") != -1)\n\t\t\t\treturn \"&\";\n\t\t\telse\n\t\t\t\treturn \"?\";\n\t\t}\n\t};\n};\n","const dateToStr = (format: string, utc: boolean, gantt) => {\n\tformat = format.replace(/%[a-zA-Z]/g, (a) => {\n\t\tswitch (a) {\n\t\t\tcase \"%d\":\n\t\t\t\treturn `\"+to_fixed(date.get${utc?\"UTC\":\"\"}Date())+\"`;\n\t\t\tcase \"%m\":\n\t\t\t\treturn `\"+to_fixed((date.get${utc?\"UTC\":\"\"}Month()+1))+\"`;\n\t\t\tcase \"%j\":\n\t\t\t\treturn `\"+date.get${utc?\"UTC\":\"\"}Date()+\"`;\n\t\t\tcase \"%n\":\n\t\t\t\treturn `\"+(date.get${utc?\"UTC\":\"\"}Month()+1)+\"`;\n\t\t\tcase \"%y\":\n\t\t\t\treturn `\"+to_fixed(date.get${utc?\"UTC\":\"\"}FullYear()%100)+\"`;\n\t\t\tcase \"%Y\":\n\t\t\t\treturn `\"+date.get${utc?\"UTC\":\"\"}FullYear()+\"`;\n\t\t\tcase \"%D\":\n\t\t\t\treturn `\"+locale.date.day_short[date.get${utc?\"UTC\":\"\"}Day()]+\"`;\n\t\t\tcase \"%l\":\n\t\t\t\treturn `\"+locale.date.day_full[date.get${utc?\"UTC\":\"\"}Day()]+\"`;\n\t\t\tcase \"%M\":\n\t\t\t\treturn `\"+locale.date.month_short[date.get${utc?\"UTC\":\"\"}Month()]+\"`;\n\t\t\tcase \"%F\":\n\t\t\t\treturn `\"+locale.date.month_full[date.get${utc?\"UTC\":\"\"}Month()]+\"`;\n\t\t\tcase \"%h\":\n\t\t\t\treturn `\"+to_fixed((date.get${utc?\"UTC\":\"\"}Hours()+11)%12+1)+\"`;\n\t\t\tcase \"%g\":\n\t\t\t\treturn `\"+((date.get${utc?\"UTC\":\"\"}Hours()+11)%12+1)+\"`;\n\t\t\tcase \"%G\":\n\t\t\t\treturn `\"+date.get${utc?\"UTC\":\"\"}Hours()+\"`;\n\t\t\tcase \"%H\":\n\t\t\t\treturn `\"+to_fixed(date.get${utc?\"UTC\":\"\"}Hours())+\"`;\n\t\t\tcase \"%i\":\n\t\t\t\treturn `\"+to_fixed(date.get${utc?\"UTC\":\"\"}Minutes())+\"`;\n\t\t\tcase \"%a\":\n\t\t\t\treturn `\"+(date.get${utc?\"UTC\":\"\"}Hours()>11?\"pm\":\"am\")+\"`;\n\t\t\tcase \"%A\":\n\t\t\t\treturn `\"+(date.get${utc?\"UTC\":\"\"}Hours()>11?\"PM\":\"AM\")+\"`;\n\t\t\tcase \"%s\":\n\t\t\t\treturn `\"+to_fixed(date.get${utc?\"UTC\":\"\"}Seconds())+\"`;\n\t\t\tcase \"%W\":\n\t\t\t\treturn `\"+to_fixed(getISOWeek(date))+\"`;\n\t\t\tcase \"%w\":\n\t\t\t\treturn `\"+to_fixed(getWeek(date))+\"`;\n\t\t\tdefault:\n\t\t\t\treturn a;\n\t\t}\n\t});\n\n\t// tslint:disable-next-line: function-constructor\n\tconst dateToStrFn = new Function(\"date\", \"to_fixed\", \"locale\", \"getISOWeek\", \"getWeek\", `return \"${format}\";`);\n\n\treturn (date: Date) => {\n\t\treturn dateToStrFn(date, gantt.date.to_fixed, gantt.locale, gantt.date.getISOWeek, gantt.date.getWeek);\n\t};\n};\n\n\nconst strToDate = (format: string, utc: boolean, gantt:any) => {\n\tlet splt = \"var temp=date.match(/[a-zA-Z]+|[0-9]+/g);\";\n\tconst mask = format.match(/%[a-zA-Z]/g);\n\tfor (let i = 0; i < mask.length; i++) {\n\t\tswitch (mask[i]) {\n\t\t\tcase \"%j\":\n\t\t\tcase \"%d\":\n\t\t\t\tsplt += `set[2]=temp[${i}]||1;`;\n\t\t\t\tbreak;\n\t\t\tcase \"%n\":\n\t\t\tcase \"%m\":\n\t\t\t\tsplt += `set[1]=(temp[${i}]||1)-1;`;\n\t\t\t\tbreak;\n\t\t\tcase \"%y\":\n\t\t\t\tsplt += `set[0]=temp[${i}]*1+(temp[${i}]>50?1900:2000);`;\n\t\t\t\tbreak;\n\t\t\tcase \"%g\":\n\t\t\tcase \"%G\":\n\t\t\tcase \"%h\":\n\t\t\tcase \"%H\":\n\t\t\t\tsplt += `set[3]=temp[${i}]||0;`;\n\t\t\t\tbreak;\n\t\t\tcase \"%i\":\n\t\t\t\tsplt += `set[4]=temp[${i}]||0;`;\n\t\t\t\tbreak;\n\t\t\tcase \"%Y\":\n\t\t\t\tsplt += `set[0]=temp[${i}]||0;`;\n\t\t\t\tbreak;\n\t\t\tcase \"%a\":\n\t\t\tcase \"%A\":\n\t\t\t\tsplt += `set[3]=set[3]%12+((temp[${i}]||'').toLowerCase()=='am'?0:12);`;\n\t\t\t\tbreak;\n\t\t\tcase \"%s\":\n\t\t\t\tsplt += `set[5]=temp[${i}]||0;`;\n\t\t\t\tbreak;\n\t\t\tcase \"%M\":\n\t\t\t\tsplt += `set[1]=locale.date.month_short_hash[temp[${i}]]||0;`;\n\t\t\t\tbreak;\n\t\t\tcase \"%F\":\n\t\t\t\tsplt += `set[1]=locale.date.month_full_hash[temp[${i}]]||0;`;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t}\n\tlet code = \"set[0],set[1],set[2],set[3],set[4],set[5]\";\n\tif (utc) { code = ` Date.UTC(${code})`; }\n\t// tslint:disable-next-line: function-constructor\n\tconst strToDateFn = new Function(\"date\", \"locale\", `var set=[0,0,1,0,0,0]; ${splt} return new Date(${code});`);\n\n\treturn (dateString) => {\n\t\treturn strToDateFn(dateString, gantt.locale);\n\t};\n};\n\nconst fastVersion = {\n\tdate_to_str: dateToStr,\n\tstr_to_date: strToDate\n};\n\nexport default fastVersion;","const dateToStr = (format: string, utc: boolean, gantt) => {\n\treturn (date) => {\n\t\treturn format.replace(/%[a-zA-Z]/g, (a) => {\n\t\t\tswitch (a) {\n\t\t\t\tcase \"%d\": return utc ? gantt.date.to_fixed(date.getUTCDate()) : gantt.date.to_fixed(date.getDate());\n\t\t\t\tcase \"%m\": return utc ? gantt.date.to_fixed((date.getUTCMonth() + 1)) : gantt.date.to_fixed((date.getMonth() + 1));\n\t\t\t\tcase \"%j\": return utc ? date.getUTCDate() : date.getDate();\n\t\t\t\tcase \"%n\": return utc ? (date.getUTCMonth() + 1) : (date.getMonth() + 1);\n\t\t\t\tcase \"%y\": return utc ? gantt.date.to_fixed(date.getUTCFullYear() % 100) : gantt.date.to_fixed(date.getFullYear() % 100);\n\t\t\t\tcase \"%Y\": return utc ? date.getUTCFullYear() : date.getFullYear();\n\t\t\t\tcase \"%D\": return utc ? gantt.locale.date.day_short[date.getUTCDay()] : gantt.locale.date.day_short[date.getDay()];\n\t\t\t\tcase \"%l\": return utc ? gantt.locale.date.day_full[date.getUTCDay()] : gantt.locale.date.day_full[date.getDay()];\n\t\t\t\tcase \"%M\": return utc ? gantt.locale.date.month_short[date.getUTCMonth()] : gantt.locale.date.month_short[date.getMonth()];\n\t\t\t\tcase \"%F\": return utc ? gantt.locale.date.month_full[date.getUTCMonth()] : gantt.locale.date.month_full[date.getMonth()];\n\t\t\t\tcase \"%h\": return utc ? gantt.date.to_fixed((date.getUTCHours() + 11) % 12 + 1) : gantt.date.to_fixed((date.getHours() + 11) % 12 + 1);\n\t\t\t\tcase \"%g\": return utc ? ((date.getUTCHours() + 11) % 12 + 1) : ((date.getHours() + 11) % 12 + 1);\n\t\t\t\tcase \"%G\": return utc ? date.getUTCHours() : date.getHours();\n\t\t\t\tcase \"%H\": return utc ? gantt.date.to_fixed(date.getUTCHours()) : gantt.date.to_fixed(date.getHours());\n\t\t\t\tcase \"%i\": return utc ? gantt.date.to_fixed(date.getUTCMinutes()) : gantt.date.to_fixed(date.getMinutes());\n\t\t\t\tcase \"%a\": return utc ? (date.getUTCHours() > 11 ? \"pm\" : \"am\") : (date.getHours() > 11 ? \"pm\" : \"am\");\n\t\t\t\tcase \"%A\": return utc ? (date.getUTCHours() > 11 ? \"PM\" : \"AM\") : (date.getHours() > 11 ? \"PM\" : \"AM\");\n\t\t\t\tcase \"%s\": return utc ? gantt.date.to_fixed(date.getUTCSeconds()) : gantt.date.to_fixed(date.getSeconds());\n\t\t\t\tcase \"%W\": return utc ? gantt.date.to_fixed(gantt.date.getUTCISOWeek(date)) : gantt.date.to_fixed(gantt.date.getISOWeek(date));\n\t\t\t\tcase \"%w\": return gantt.date.to_fixed(gantt.date.getWeek(date));\n\t\t\t\tdefault: return a;\n\t\t\t}\n\t\t});\n\t};\n};\nconst strToDate = (format: string, utc: boolean, gantt:any) => {\n\treturn (date: string) => {\n\t\tconst set: Array<string|number> = [0, 0, 1, 0, 0, 0];\n\t\tconst temp = date.match(/[a-zA-Z]+|[0-9]+/g);\n\t\tconst mask = format.match(/%[a-zA-Z]/g);\n\n\t\tfor (let i = 0; i < mask.length; i++) {\n\t\t\tswitch (mask[i]) {\n\t\t\t\tcase \"%j\":\n\t\t\t\tcase \"%d\":\n\t\t\t\t\tset[2] = temp[i] as unknown as number || 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%n\":\n\t\t\t\tcase \"%m\":\n\t\t\t\t\tset[1] = (temp[i] as unknown as number || 1) - 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%y\":\n\t\t\t\t\tset[0] = temp[i] as unknown as number * 1 + ((temp[i] as unknown as number) > 50 ? 1900 : 2000);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%g\":\n\t\t\t\tcase \"%G\":\n\t\t\t\tcase \"%h\":\n\t\t\t\tcase \"%H\":\n\t\t\t\t\tset[3] = temp[i] as unknown as number || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%i\":\n\t\t\t\t\tset[4] = temp[i] as unknown as number || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%Y\":\n\t\t\t\t\tset[0] = temp[i] as unknown as number || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%a\":\n\t\t\t\tcase \"%A\":\n\t\t\t\t\tset[3] = set[3] as number % 12 + ((temp[i] || \"\").toLowerCase() === \"am\" ? 0 : 12);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%s\":\n\t\t\t\t\tset[5] = temp[i] || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%M\":\n\t\t\t\t\tset[1] = gantt.locale.date.month_short_hash[temp[i]] || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%F\":\n\t\t\t\t\tset[1] = gantt.locale.date.month_full_hash[temp[i]] || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (utc) {\n\t\t\treturn new Date(Date.UTC(\n\t\t\t\tset[0] as number,\n\t\t\t\tset[1] as number,\n\t\t\t\tset[2] as number,\n\t\t\t\tset[3] as number,\n\t\t\t\tset[4] as number,\n\t\t\t\tset[5] as number\n\t\t\t));\n\t\t}\n\t\treturn new Date(\n\t\t\tset[0] as number,\n\t\t\tset[1] as number,\n\t\t\tset[2] as number,\n\t\t\tset[3] as number,\n\t\t\tset[4] as number,\n\t\t\tset[5] as number\n\t\t);\n\t};\n\n};\n\n\nconst cspVersion = {\n\tdate_to_str: dateToStr,\n\tstr_to_date: strToDate\n};\n\nexport default cspVersion;","/*\n %d - the day as a number with a leading zero ( 01 to 31 );\n %j - the day as a number without a leading zero ( 1 to 31 );\n %D - the day as an abbreviation ( Sun to Sat );\n %l - the day as a full name ( Sunday to Saturday );\n %W - the ISO-8601 week number of the year. Weeks start on Monday; 1)\n %m - the month as a number without a leading zero ( 1 to 12 );\n %n - the month as a number with a leading zero ( 01 to 12);\n %M - the month as an abbreviation ( Jan to Dec );\n %F - the month as a full name ( January to December );\n %y - the year as a two-digit number ( 00 to 99 );\n %Y - the year as a four-digit number ( 19009999 );\n %h - the hour based on the 12-hour clock ( 00 to 11 );\n %H - the hour based on the 24-hour clock ( 00 to 23 );\n %i - the minute as a number with a leading zero ( 00 to 59 );\n %s - the second as a number without a leading zero ( 00 to 59 ); 2)\n %a - displays am (for times from midnight until noon) and pm (for times from noon until midnight);\n %A - displays AM (for times from midnight until noon) and PM (for times from noon until midnight).\n*/\n\nimport fastVersion from \"./date_parsers/fast_version\";\nimport cspCompliantVersion from \"./date_parsers/csp_compliant_version\";\n\nexport default function(gantt) {\n\tvar canUseCsp = null;\n\tfunction cspAutoCheck() {\n\t\ttry {\n\t\t\tnew Function(\"canUseCsp = false;\");\n\t\t} catch(e) {\n\t\t\tcanUseCsp = true;\n\t\t}\n\t}\n\tfunction useCsp() {\n\t\tvar result = false;\n\t\tif (gantt.config.csp === \"auto\") {\n\t\t\tif(canUseCsp === null) {\n\t\t\t\tcspAutoCheck();\n\t\t\t}\n\t\t\tresult = canUseCsp;\n\t\t} else {\n\t\t\tresult = gantt.config.csp;\n\t\t}\n\t\treturn result;\n\t}\n\n\tvar dateHelper = {\n\t\tinit: function () {\n\t\t\tvar locale = gantt.locale;\n\n\t\t\tvar s = locale.date.month_short;\n\t\t\tvar t = locale.date.month_short_hash = {};\n\t\t\tfor (var i = 0; i < s.length; i++)\n\t\t\t\tt[s[i]] = i;\n\n\t\t\tvar s = locale.date.month_full;\n\t\t\tvar t = locale.date.month_full_hash = {};\n\t\t\tfor (var i = 0; i < s.length; i++)\n\t\t\t\tt[s[i]] = i;\n\t\t},\n\t\tdate_part: function (date) {\n\t\t\tvar old = new Date(date);\n\t\t\tdate.setHours(0);\n\t\t\tthis.hour_start(date);\n\t\t\tif (date.getHours() && //shift to yesterday on dst\n\t\t\t\t(date.getDate() < old.getDate() || date.getMonth() < old.getMonth() || date.getFullYear() < old.getFullYear()))\n\t\t\t\tdate.setTime(date.getTime() + 60 * 60 * 1000 * (24 - date.getHours()));\n\t\t\treturn date;\n\t\t},\n\t\ttime_part: function (date) {\n\t\t\treturn (date.valueOf() / 1000 - date.getTimezoneOffset() * 60) % 86400;\n\t\t},\n\t\tweek_start: function (date) {\n\t\t\tvar shift = date.getDay();\n\t\t\tif (gantt.config.start_on_monday) {\n\t\t\t\tif (shift === 0) shift = 6;\n\t\t\t\telse shift--;\n\t\t\t}\n\t\t\treturn this.date_part(this.add(date, -1 * shift, \"day\"));\n\t\t},\n\t\tmonth_start: function (date) {\n\t\t\tdate.setDate(1);\n\t\t\treturn this.date_part(date);\n\t\t},\n\t\tquarter_start: function (date) {\n\t\t\tthis.month_start(date);\n\t\t\tvar m = date.getMonth(),\n\t\t\t\tres_month;\n\n\t\t\tif (m >= 9) {\n\t\t\t\tres_month = 9;\n\t\t\t} else if (m >= 6) {\n\t\t\t\tres_month = 6;\n\t\t\t} else if (m >= 3) {\n\t\t\t\tres_month = 3;\n\t\t\t} else {\n\t\t\t\tres_month = 0;\n\t\t\t}\n\n\t\t\tdate.setMonth(res_month);\n\t\t\treturn date;\n\t\t},\n\t\tyear_start: function (date) {\n\t\t\tdate.setMonth(0);\n\t\t\treturn this.month_start(date);\n\t\t},\n\t\tday_start: function (date) {\n\t\t\treturn this.date_part(date);\n\t\t},\n\t\thour_start: function (date) {\n\t\t\tif (date.getMinutes())\n\t\t\t\tdate.setMinutes(0);\n\t\t\tthis.minute_start(date);\n\n\t\t\treturn date;\n\t\t},\n\t\tminute_start: function (date) {\n\t\t\tif (date.getSeconds())\n\t\t\t\tdate.setSeconds(0);\n\t\t\tif (date.getMilliseconds())\n\t\t\t\tdate.setMilliseconds(0);\n\t\t\treturn date;\n\t\t},\n\t\t_add_days: function (modifiedDate, inc, originalDate) {\n\n\t\t\tmodifiedDate.setDate(modifiedDate.getDate() + inc);\n\t\t\tvar incCondition = inc >= 0;\n\t\t\tvar getHoursCondition = !originalDate.getHours() && modifiedDate.getHours(); //shift to yesterday on dst\n\t\t\tvar getDateCondition = (modifiedDate.getDate() <= originalDate.getDate() || modifiedDate.getMonth() < originalDate.getMonth() || modifiedDate.getFullYear() < originalDate.getFullYear());\n\t\t\tif (incCondition && getHoursCondition && getDateCondition){\n\t\t\t\tmodifiedDate.setTime(modifiedDate.getTime() + 60 * 60 * 1000 * (24 - modifiedDate.getHours()));\n\t\t\t}\n\t\t\tvar worktimeCalculation = inc > 1;\n\t\t\tif (worktimeCalculation && getHoursCondition){\n\t\t\t\t// try to shift the modified Date to 00:00\n\t\t\t\tmodifiedDate.setHours(0);\n\t\t\t}\n\t\t\treturn modifiedDate;\n\t\t},\n\n\t\tadd: function (date, inc, mode) {\n\t\t\t/*jsl:ignore*/\n\t\t\tvar ndate = new Date(date.valueOf());\n\t\t\tswitch (mode) {\n\t\t\t\tcase \"day\":\n\t\t\t\t\tndate = this._add_days(ndate, inc, date);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"week\":\n\t\t\t\t\tndate = this._add_days(ndate, inc * 7, date);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"month\":\n\t\t\t\t\tndate.setMonth(ndate.getMonth() + inc);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"year\":\n\t\t\t\t\tndate.setYear(ndate.getFullYear() + inc);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"hour\":\n\t\t\t\t\t/*\n\t\t\t\t\t\tadding hours/minutes via setHour(getHour() + inc) gives weird result when\n\t\t\t\t\t\tadding one hour to the time before switch to a Daylight Saving time\n\n\t\t\t\t\t\texample: //Sun Mar 30 2014 01:00:00 GMT+0100 (W. Europe Standard Time)\n\t\t\t\t\t\tnew Date(2014, 02, 30, 1).setHours(2)\n\t\t\t\t\t\t>>Sun Mar 30 2014 01:00:00 GMT+0100 (W. Europe Standard Time)\n\n\t\t\t\t\t\tsetTime seems working as expected\n\t\t\t\t\t */\n\t\t\t\t\tndate.setTime(ndate.getTime() + inc * 60 * 60 * 1000);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"minute\":\n\n\t\t\t\t\tndate.setTime(ndate.getTime() + inc * 60 * 1000);\n\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\treturn this[\"add_\" + mode](date, inc, mode);\n\t\t\t}\n\t\t\treturn ndate;\n\t\t\t/*jsl:end*/\n\t\t},\n\t\tadd_quarter: function (date, inc) {\n\t\t\treturn this.add(date, inc * 3, \"month\");\n\t\t},\n\n\t\tto_fixed: function (num) {\n\t\t\tif (num < 10) return \"0\" + num;\n\t\t\treturn num;\n\t\t},\n\t\tcopy: function (date) {\n\t\t\treturn new Date(date.valueOf());\n\t\t},\n\t\tdate_to_str: function (format, utc) {\n\t\t\tvar result = fastVersion;\n\t\t\tif (useCsp()) {\n\t\t\t\tresult = cspCompliantVersion;\n\t\t\t}\n\t\t\treturn result.date_to_str(format, utc, gantt);\n\t\t},\n\t\tstr_to_date: function (format, utc) {\n\t\t\tvar result = fastVersion;\n\t\t\tif (useCsp()) {\n\t\t\t\tresult = cspCompliantVersion;\n\t\t\t}\n\t\t\treturn result.str_to_date(format, utc, gantt);\n\t\t},\n\t\tgetISOWeek: function (ndate) {\n\t\t\treturn gantt.date._getWeekNumber(ndate, true);\n\t\t},\n\t\t_getWeekNumber: function(ndate, isoWeek){\n\t\t\tif (!ndate) return false;\n\t\t\tvar nday = ndate.getDay();\n\t\t\tif(isoWeek){\n\t\t\t\tif (nday === 0) {\n\t\t\t\t\tnday = 7;\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar first_thursday = new Date(ndate.valueOf());\n\t\t\tfirst_thursday.setDate(ndate.getDate() + (4 - nday));\n\t\t\tvar year_number = first_thursday.getFullYear(); // year of the first Thursday\n\t\t\tvar ordinal_date = Math.round((first_thursday.getTime() - new Date(year_number, 0, 1).getTime()) / 86400000); //ordinal date of the first Thursday - 1 (so not really ordinal date)\n\t\t\tvar week_number = 1 + Math.floor(ordinal_date / 7);\n\t\t\treturn week_number;\n\t\t},\n\n\t\tgetWeek: function(ndate){\n\t\t\treturn gantt.date._getWeekNumber(ndate, gantt.config.start_on_monday);\n\t\t},\n\t\tgetUTCISOWeek: function (ndate) {\n\t\t\treturn gantt.date.getISOWeek(ndate);\n\t\t},\n\t\tconvert_to_utc: function (date) {\n\t\t\treturn new Date(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(), date.getUTCHours(), date.getUTCMinutes(), date.getUTCSeconds());\n\t\t},\n\t\tparseDate: function (date, format) {\n\t\t\t// raw date may be of type string, number (timestamp) or something else\n\t\t\t// do not check for instanceof Date explicitly, since we may swap native date with different date implementation at some point\n\t\t\tif (date && !date.getFullYear) {\n\t\t\t\tif (typeof(format) !== \"function\") {\n\t\t\t\t\tif (typeof(format) === \"string\") {\n\t\t\t\t\t\tif (format === \"parse_date\" || format === \"xml_date\") {\n\t\t\t\t\t\t\tformat = gantt.defined(gantt.templates.xml_date) ? gantt.templates.xml_date : gantt.templates.parse_date;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tformat = gantt.defined(gantt.templates[format]) ? gantt.templates[format] : gantt.date.str_to_date(format);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tformat = gantt.defined(gantt.templates.xml_date) ? gantt.templates.xml_date : gantt.templates.parse_date;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (date) {\n\t\t\t\t\tdate = format(date);\n\t\t\t\t} else {\n\t\t\t\t\tdate = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn date;\n\t\t}\n\t};\n\treturn dateHelper;\n};","class t{constructor(t){const{url:e,token:s}=t;this._url=e,this._token=s,this._mode=1,this._seed=1,this._queue=[],this.data={},this.api={},this._events={}}headers(){return{Accept:\"application/json\",\"Content-Type\":\"application/json\",\"Remote-Token\":this._token}}fetch(t,e){const s={credentials:\"include\",headers:this.headers()};return e&&(s.method=\"POST\",s.body=e),fetch(t,s).then(t=>t.json())}load(t){return t&&(this._url=t),this.fetch(this._url).then(t=>this.parse(t))}parse(t){const{key:e,websocket:s}=t;e&&(this._token=t.key);for(const e in t.data)this.data[e]=t.data[e];for(const e in t.api){const s=this.api[e]={},i=t.api[e];for(const t in i)s[t]=this._wrapper(e+\".\"+t)}return s&&this.connect(),this}connect(){const t=this._socket;t&&(this._socket=null,t.onclose=function(){},t.close()),this._mode=2,this._socket=function(t,e,s,i){let n=e;\"/\"===n[0]&&(n=document.location.protocol+\"//\"+document.location.host+e);n=n.replace(/^http(s|):/,\"ws$1:\");const o=-1!=n.indexOf(\"?\")?\"&\":\"?\";n=`${n}${o}token=${s}&ws=1`;const r=new WebSocket(n);return r.onclose=()=>setTimeout(()=>t.connect(),2e3),r.onmessage=e=>{const s=JSON.parse(e.data);switch(s.action){case\"result\":t.result(s.body,[]);break;case\"event\":t.fire(s.body.name,s.body.value);break;case\"start\":i();break;default:t.onError(s.data)}},r}(this,this._url,this._token,()=>(this._mode=3,this._send(),this._resubscribe(),this))}_wrapper(t){return function(){const e=[].slice.call(arguments);let s=null;const i=new Promise((i,n)=>{s={data:{id:this._uid(),name:t,args:e},status:1,resolve:i,reject:n},this._queue.push(s)});return this.onCall(s,i),3===this._mode?this._send(s):setTimeout(()=>this._send(),1),i}.bind(this)}_uid(){return(this._seed++).toString()}_send(t){if(2==this._mode)return void setTimeout(()=>this._send(),100);const e=t?[t]:this._queue.filter(t=>1===t.status);if(!e.length)return;const s=e.map(t=>(t.status=2,t.data));3!==this._mode?this.fetch(this._url,JSON.stringify(s)).catch(t=>this.onError(t)).then(t=>this.result(t,s)):this._socket.send(JSON.stringify({action:\"call\",body:s}))}result(t,e){const s={};if(t)for(let e=0;e<t.length;e++)s[t[e].id]=t[e];else for(let t=0;t<e.length;t++)s[e[t].id]={id:e[t].id,error:\"Network Error\",data:null};for(let t=this._queue.length-1;t>=0;t--){const e=this._queue[t],i=s[e.data.id];i&&(this.onResponse(e,i),i.error?e.reject(i.error):e.resolve(i.data),this._queue.splice(t,1))}}on(t,e){const s=this._uid();let i=this._events[t];const n=!!i;return n||(i=this._events[t]=[]),i.push({id:s,handler:e}),n||3!=this._mode||this._socket.send(JSON.stringify({action:\"subscribe\",name:t})),{name:t,id:s}}_resubscribe(){if(3==this._mode)for(const t in this._events)this._socket.send(JSON.stringify({action:\"subscribe\",name:t}))}detach(t){if(!t){if(3==this._mode)for(const t in this._events)this._socket.send(JSON.stringify({action:\"unsubscribe\",key:t}));return void(this._events={})}const{id:e,name:s}=t,i=this._events[s];if(i){const t=i.filter(t=>t.id!=e);t.length?this._events[s]=t:(delete this._events[s],3==this._mode&&this._socket.send(JSON.stringify({action:\"unsubscribe\",name:s})))}}fire(t,e){const s=this._events[t];if(s)for(let t=0;t<s.length;t++)s[t].handler(e)}onError(t){return null}onCall(t,e){}onResponse(t,e){}}export{t as Client};\n//# sourceMappingURL=remote.es6.js.map\n","import * as remote_client from \"remote-client\";\nexport const remoteEvents = function(url, token) {\n    const remote = new remote_client.Client({\n      url,\n      token\n    });\n\n    // temporary patch, as we do not want credentials\n    remote.fetch = function (url, body) {\n      const req = {\n        headers: this.headers()\n      };\n      if (body) {\n        req.method = \"POST\";\n        req.body = body;\n      }\n\n      return fetch(url, req).then((res) => res.json());\n    };\n\n    this._ready = remote.load().then((back) => (this._remote = back));\n\n    function ready() {\n      return this._ready;\n    }\n  \n    function on(name, handler) {\n      this.ready().then((back) => {\n        if (typeof name === \"string\") back.on(name, handler);\n        else {\n          for (const key in name) {\n            back.on(key, name[key]);\n          }\n        }\n      });\n    }\n\n    this.ready = ready;\n    this.on = on;\n  };\n\n","function checkTimeout(host, updPerSecond){\n\tif (!updPerSecond)\n\t\treturn true;\n\t\n\tif (host._on_timeout)\n\t\treturn false;\n\t\n\tvar timeout = Math.ceil(1000/updPerSecond);\n\tif (timeout < 2) return true;\n\n\tsetTimeout(function(){\n\t\tdelete host._on_timeout;\n\t}, timeout);\n\n\thost._on_timeout = true;\n\treturn true;\n}\n\nexport default checkTimeout;","import * as utils from \"../../utils/utils\";\n\nvar StateService = (function(){\n\tvar stateProviders = {};\n\n\tfunction getState(name){\n\t\tvar provider = stateProviders[name];\n\t\tif(provider){\n\t\t\treturn stateProviders[name].method();\n\t\t}else{\n\t\t\tvar res = {};\n\t\t\tfor(var i in stateProviders){\n\t\t\t\tif(!stateProviders[i].internal)\n\t\t\t\t\tutils.mixin(res, stateProviders[i].method(), true);\n\t\t\t}\n\t\t\treturn res;\n\t\t}\n\t}\n\n\tfunction registerProvider(name, provider, internal){\n\t\tstateProviders[name] = { method: provider, internal: internal};\n\t}\n\n\tfunction unregisterProvider(name){\n\t\tdelete stateProviders[name];\n\t}\n\n\treturn {\n\t\tgetState: getState,\n\t\tregisterProvider: registerProvider,\n\t\tunregisterProvider: unregisterProvider\n\t};\n});\n\nexport default StateService;\n\n","export default Promise;","import * as utils from \"../../utils/utils\";\nimport {replaceValidZeroId} from \"../../utils/helpers\";\n\nvar createTasksDatastoreFacade = function(){\n\treturn {\n\tgetTask: function (id) {\n\t\tid = replaceValidZeroId(id, this.config.root_id);\n\t\tthis.assert(id, \"Invalid argument for gantt.getTask\");\n\t\tvar task = this.$data.tasksStore.getItem(id);\n\t\tthis.assert(task, \"Task not found id=\" + id);\n\t\treturn task;\n\t},\n\tgetTaskByTime: function (from, to) {\n\t\tvar p = this.$data.tasksStore.getItems();\n\n\t\tvar res = [];\n\n\t\tif (!(from || to)) {\n\t\t\tres = p;\n\t\t} else {\n\t\t\tfrom = +from || -Infinity;\n\t\t\tto = +to || Infinity;\n\t\t\tfor (var t = 0; t < p.length; t++){\n\t\t\t\tvar task = p[t];\n\t\t\t\tif (+task.start_date < to && +task.end_date > from)\n\t\t\t\t\tres.push(task);\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t},\n\tisTaskExists: function (id) {\n\t\tif(!this.$data || !this.$data.tasksStore){\n\t\t\treturn false;\n\t\t}\n\t\treturn this.$data.tasksStore.exists(id);\n\t},\n\tupdateTask: function (id, item) {\n\t\tif (!utils.defined(item)) item = this.getTask(id);\n\t\tthis.$data.tasksStore.updateItem(id, item);\n\t\tif(this.isTaskExists(id))\n\t\t\tthis.refreshTask(id);\n\t},\n\taddTask: function (item, parent, index) {\n\t\tif (!utils.defined(item.id))\n\t\t\titem.id = utils.uid();\n\n\t\t//GS-761: assert unique ID\n\t\tif (this.isTaskExists(item.id)){\n\t\t\tvar task = this.getTask(item.id);\n\t\t\tif (task.$index != item.$index) {\n\t\t\t\t// Someone may try to mistakenly add a task with the same ID, and most likely\n\t\t\t\t// use the string format for the dates. Gantt shouldn't break in this scenario\n\t\t\t\tif (item.start_date && typeof item.start_date === \"string\"){\n\t\t\t\t\titem.start_date = this.date.parseDate(item.start_date, \"parse_date\");\n\t\t\t\t}\n\t\t\t\tif (item.end_date && typeof item.end_date === \"string\"){\n\t\t\t\t\titem.end_date = this.date.parseDate(item.end_date, \"parse_date\");\n\t\t\t\t}\n\n\t\t\t\treturn this.$data.tasksStore.updateItem(item.id, item);\n\t\t\t}\n\t\t}\n\n\n\t\tif (!utils.defined(parent)) parent = this.getParent(item) || 0;\n\t\tif (!this.isTaskExists(parent)) parent = this.config.root_id;\n\t\tthis.setParent(item, parent);\n\n\t\t// GS-1583. Save the $open state to the Undo Stack\n\t\tif (this.getState().lightbox && this.isTaskExists(parent)) {\n\t\t\tvar parentObj = this.getTask(parent);\n\t\t\tthis.callEvent(\"onAfterParentExpand\", [parent, parentObj]);\n\t\t}\n\t\treturn this.$data.tasksStore.addItem(item, index, parent);\n\t},\n\tdeleteTask: function (id) {\n\t\tid = replaceValidZeroId(id, this.config.root_id);\n\t\treturn this.$data.tasksStore.removeItem(id);\n\t},\n\tgetTaskCount: function () {\n\t\treturn this.$data.tasksStore.count();\n\t},\n\tgetVisibleTaskCount: function () {\n\t\treturn this.$data.tasksStore.countVisible();\n\t},\n\tgetTaskIndex: function (id) {\n\t\treturn this.$data.tasksStore.getBranchIndex(id);\n\t},\n\tgetGlobalTaskIndex: function (id) {\n\t\tid = replaceValidZeroId(id, this.config.root_id);\n\t\tthis.assert(id, \"Invalid argument\");\n\t\treturn this.$data.tasksStore.getIndexById(id);\n\t},\n\teachTask: function (code, parent, master) {\n\t\treturn this.$data.tasksStore.eachItem(utils.bind(code, master||this), parent);\n\t},\n\teachParent: function (callback, startTask, master) {\n\t\treturn this.$data.tasksStore.eachParent(utils.bind(callback, master || this), startTask);\n\t},\n\tchangeTaskId: function (oldid, newid) {\n\t\tthis.$data.tasksStore.changeId(oldid, newid);\n\t\tvar task = this.$data.tasksStore.getItem(newid);\n\n\t\tvar links = [];\n\n\t\tif (task.$source) {\n\t\t\tlinks = links.concat(task.$source);\n\t\t}\n\t\tif (task.$target) {\n\t\t\tlinks = links.concat(task.$target);\n\t\t}\n\n\t\tfor (var i = 0; i < links.length; i++) {\n\t\t\tvar link = this.getLink(links[i]);\n\t\t\tif (link.source == oldid) {\n\t\t\t\tlink.source = newid;\n\t\t\t}\n\t\t\tif (link.target == oldid) {\n\t\t\t\tlink.target = newid;\n\t\t\t}\n\t\t}\n\t},\n\tcalculateTaskLevel: function (item) {\n\t\treturn this.$data.tasksStore.calculateItemLevel(item);\n\t},\n\tgetNext: function (id) {\n\t\treturn this.$data.tasksStore.getNext(id);\n\t},\n\tgetPrev: function (id) {\n\t\treturn this.$data.tasksStore.getPrev(id);\n\t},\n\tgetParent: function (id) {\n\t\treturn this.$data.tasksStore.getParent(id);\n\t},\n\tsetParent: function (task, new_pid, silent) {\n\t\treturn this.$data.tasksStore.setParent(task, new_pid, silent);\n\t},\n\tgetSiblings: function (id) {\n\t\treturn this.$data.tasksStore.getSiblings(id).slice();\n\t},\n\tgetNextSibling: function (id) {\n\t\treturn this.$data.tasksStore.getNextSibling(id);\n\t},\n\tgetPrevSibling: function (id) {\n\t\treturn this.$data.tasksStore.getPrevSibling(id);\n\t},\n\tgetTaskByIndex: function(index){\n\t\tvar id = this.$data.tasksStore.getIdByIndex(index);\n\t\tif(this.isTaskExists(id)){\n\t\t\treturn this.getTask(id);\n\t\t}else{\n\t\t\treturn null;\n\t\t}\n\t},\n\tgetChildren: function (id) {\n\t\tif(!this.hasChild(id)){\n\t\t\treturn [];\n\t\t}else{\n\t\t\treturn this.$data.tasksStore.getChildren(id).slice();\n\t\t}\n\t},\n\thasChild: function (id) {\n\t\treturn this.$data.tasksStore.hasChild(id);\n\t},\n\topen: function (id) {\n\t\tthis.$data.tasksStore.open(id);\n\t},\n\tclose: function (id) {\n\t\tthis.$data.tasksStore.close(id);\n\t},\n\tmoveTask: function (sid, tindex, parent) {\n\t\tparent = replaceValidZeroId(parent, this.config.root_id);\n\t\treturn this.$data.tasksStore.move.apply(this.$data.tasksStore, arguments);\n\t},\n\tsort: function(field, desc, parent, silent) {\n\t\tvar render = !silent;//4th argument to cancel redraw after sorting\n\n\t\tthis.$data.tasksStore.sort(field, desc, parent);\n\t\tthis.callEvent(\"onAfterSort\", [field, desc, parent]);\n\n\t\tif (render) {\n\t\t\tthis.render();\n\t\t}\n\t}\n};\n};\n\nexport default createTasksDatastoreFacade;\n\n\n","import * as utils from \"../../utils/utils\";\n\nvar $powerArray  = {\n\t$create: function(array){\n\t\treturn utils.mixin(array || [], this);\n\t},\n\t//remove element at specified position\n\t$removeAt:function(pos,len){\n\t\tif (pos>=0) this.splice(pos,(len||1));\n\t},\n\t//find element in collection and remove it\n\t$remove:function(value){\n\t\tthis.$removeAt(this.$find(value));\n\t},\n\t//add element to collection at specific position\n\t$insertAt:function(data,pos){\n\t\tif (!pos && pos!==0) \t//add to the end by default\n\t\t\tthis.push(data);\n\t\telse {\n\t\t\tvar b = this.splice(pos,(this.length-pos));\n\t\t\tthis[pos] = data;\n\t\t\tthis.push.apply(this,b); //reconstruct array without loosing this pointer\n\t\t}\n\t},\n\t//return index of element, -1 if it doesn't exists\n\t$find:function(data){\n\t\tfor (var i=0; i<this.length; i++)\n\t\t\tif (data==this[i]) return i;\n\t\treturn -1;\n\t},\n\t//execute some method for each element of array\n\t$each:function(functor,master){\n\t\tfor (var i=0; i < this.length; i++)\n\t\t\tfunctor.call((master||this),this[i]);\n\t},\n\t//create new array from source, by using results of functor\n\t$map:function(functor,master){\n\t\tfor (var i=0; i < this.length; i++)\n\t\t\tthis[i]=functor.call((master||this),this[i]);\n\t\treturn this;\n\t},\n\t$filter:function(functor, master){\n\t\tfor (var i=0; i < this.length; i++)\n\t\t\tif (!functor.call((master||this),this[i])){\n\t\t\t\tthis.splice(i,1);\n\t\t\t\ti--;\n\t\t\t}\n\t\treturn this;\n\t}\n};\n\nexport default $powerArray;","/**\n * Check the over task or draggble task is placeholder task\n */\n\nexport default function isPlaceholderTask(id, gantt, store, config) {\n\t// return false;\n\tvar config = gantt ? gantt.config : config;\n\tif (config && config.placeholder_task) {\n\t\tif (store.exists(id)){\n\t\t\tvar item = store.getItem(id);\n\t\t\treturn item.type === config.types.placeholder;\n\t\t}\n\t}\n\treturn false;\n};","import powerArray from \"./power_array\";\nimport * as utils from \"../../utils/utils\";\nimport eventable from \"../../utils/eventable\";\nimport isPlaceholderTask from \"../../utils/placeholder_task\";\n\nvar DataStore = function(config){\n\tthis.pull = {};\n\tthis.$initItem = config.initItem;\n\tthis.visibleOrder = powerArray.$create();\n\tthis.fullOrder = powerArray.$create();\n\tthis._skip_refresh = false;\n\tthis._filterRule = null;\n\tthis._searchVisibleOrder = {};\n\tthis._indexRangeCache = {};\n\tthis._getItemsCache = null;\n\tthis.$config = config;\n\teventable(this);\n\n\tthis._attachDataChange(function(){\n\t\tthis._indexRangeCache = {};\n\t\tthis._getItemsCache = null;\n\t\treturn true;\n\t});\n\treturn this;\n};\nDataStore.prototype = {\n\n\t_attachDataChange: function(callback){\n\t\tthis.attachEvent(\"onClearAll\", callback);\n\t\tthis.attachEvent(\"onBeforeParse\", callback);\n\t\tthis.attachEvent(\"onBeforeUpdate\", callback);\n\t\tthis.attachEvent(\"onBeforeDelete\", callback);\n\t\tthis.attachEvent(\"onBeforeAdd\", callback);\n\t\tthis.attachEvent(\"onParse\", callback);\n\t\tthis.attachEvent(\"onBeforeFilter\", callback);\n\t},\n\t_parseInner: function(data){\n\t\tvar item = null,\n\t\t\tloaded = [];\n\t\tfor(var i = 0, len = data.length; i< len; i++){\n\t\t\titem = data[i];\n\t\t\tif(this.$initItem){\n\t\t\t\tif(this.$config.copyOnParse()){\n\t\t\t\t\titem = utils.copy(item);\n\t\t\t\t}\n\t\t\t\titem = this.$initItem(item);\n\t\t\t}\n\t\t\t\n\t\t\tif(this.callEvent(\"onItemLoading\", [item])){\n\t\t\t\tif (!this.pull.hasOwnProperty(item.id)) {\n\t\t\t\t\tthis.fullOrder.push(item.id);\n\t\t\t\t}\n\t\t\t\tloaded.push(item);\n\t\t\t\tthis.pull[item.id] = item;\n\t\t\t}\n\t\t}\n\t\treturn loaded;\n\t},\n\tparse: function(data){\n\t\tif (!this.isSilent()) {\n\t\t\tthis.callEvent(\"onBeforeParse\", [data]);\n\t\t}\n\t\tvar loaded = this._parseInner(data);\n\t\tif (!this.isSilent()) {\n\t\t\tthis.refresh();\n\t\t\tthis.callEvent(\"onParse\", [loaded]);\n\t\t}\n\t},\n\tgetItem: function(id){\n\t\treturn this.pull[id];\n\t},\n\n\t_updateOrder: function(code){\n\t\tcode.call(this.visibleOrder);\n\t\tcode.call(this.fullOrder);\n\t},\n\tupdateItem: function(id, item){\n\t\tif (!utils.defined(item)) item = this.getItem(id);\n\n\t\tif (!this.isSilent()) {\n\t\t\tif (this.callEvent(\"onBeforeUpdate\", [item.id, item]) === false) return false;\n\t\t}\n\t\t// This is how it worked before updating the properties:\n\t\t// this.pull[id]=item;\n\t\tutils.mixin(this.pull[id],item, true);\n\t\tif (!this.isSilent()) {\n\t\t\tthis.callEvent(\"onAfterUpdate\", [item.id, item]);\n\t\t\tthis.callEvent(\"onStoreUpdated\", [item.id, item, \"update\"]);\n\t\t}\n\t},\n\n\t_removeItemInner: function(id){\n\t\t//clear from collections\n\t\t//this.visibleOrder.$remove(id);\n\t\tthis._updateOrder(function(){ this.$remove(id);});\n\t\tdelete this.pull[id];\n\t},\n\n\tremoveItem: function(id){\n\t\t//utils.assert(this.exists(id), \"Not existing ID in remove command\"+id);\n\n\t\tvar obj = this.getItem(id);\t//save for later event\n\t\tif (!this.isSilent()) {\n\t\t\tif (this.callEvent(\"onBeforeDelete\", [obj.id, obj]) === false) return false;\n\t\t}\n\n\t\tthis.callEvent(\"onAfterDeleteConfirmed\", [obj.id, obj]);\n\t\tthis._removeItemInner(id);\n\t\t\n\t\tif (this.isSilent()) {\n\t\t\tthis.callEvent(\"onAfterSilentDelete\", [obj.id, obj]);\n\t\t}\n\n\t\tif (!this.isSilent()) {\n\t\t\tthis.filter();\n\t\t\tthis.callEvent(\"onAfterDelete\", [obj.id, obj]);\n\t\t\t//repaint signal\n\t\t\tthis.callEvent(\"onStoreUpdated\", [obj.id, obj, \"delete\"]);\n\t\t}\n\t},\n\n\t_addItemInner: function(item, index){\n\t\t//in case of treetable order is sent as 3rd parameter\n\t\t//var order = index;\n\n\t\tif(this.exists(item.id)){\n\t\t\tthis.silent(function(){this.updateItem(item.id, item);});\n\t\t}else{\n\t\t\tvar order = this.visibleOrder;\n\n\t\t\t//by default item is added to the end of the list\n\t\t\tvar data_size = order.length;\n\n\t\t\tif (!utils.defined(index) || index < 0)\n\t\t\t\tindex = data_size;\n\t\t\t//check to prevent too big indexes\n\t\t\tif (index > data_size){\n\t\t\t\t//dhx.log(\"Warning\",\"DataStore:add\",\"Index of out of bounds\");\n\t\t\t\tindex = Math.min(order.length,index);\n\t\t\t}\n\t\t}\n\n\n\t\t//gantt.assert(!this.exists(id), \"Not unique ID\");\n\n\t\tthis.pull[item.id]=item;\n\t\tthis._updateOrder(function(){\n\t\t\tif(this.$find(item.id) === -1)\n\t\t\t\tthis.$insertAt(item.id,index);\n\t\t});\n\t\tthis.filter();\n\t\t//order.$insertAt(item.id,index);\n\t},\n\n\n\tisVisible: function(id){\n\t\treturn this.visibleOrder.$find(id) > -1;\n\t},\n\tgetVisibleItems: function(){\n\t\treturn this.getIndexRange();\n\t},\n\n\taddItem: function(item, index){\n\t\tif (!utils.defined(item.id))\n\t\t\titem.id = utils.uid();\n\n\t\tif(this.$initItem){\n\t\t\titem = this.$initItem(item);\n\t\t}\n\n\t\tif (!this.isSilent()){\n\t\t\tif (this.callEvent(\"onBeforeAdd\", [item.id, item]) === false) return false;\n\t\t}\n\n\n\t\tthis._addItemInner(item, index);\n\n\t\tif (!this.isSilent()){\n\t\t\tthis.callEvent(\"onAfterAdd\",[item.id, item]);\n\t\t\t//repaint signal\n\t\t\tthis.callEvent(\"onStoreUpdated\",[item.id,item,\"add\"]);\n\t\t} else {\n\t\t\tif(this.sync_link){\n\t\t\t\tthis.sync_link(item);\n\t\t\t}\n\t\t}\n\t\treturn item.id;\n\t},\n\n\t_changeIdInner: function(oldId, newId){\n\t\tif(this.pull[oldId])\n\t\t\tthis.pull[newId] = this.pull[oldId];\n\n\t\tvar visibleOrder = this._searchVisibleOrder[oldId];\n\t\tthis.pull[newId].id = newId;\n\t\tthis._updateOrder(function(){\n\t\t\tthis[this.$find(oldId)] = newId;\n\t\t});\n\t\tthis._searchVisibleOrder[newId] = visibleOrder;\n\t\tdelete this._searchVisibleOrder[oldId];\n\n\t\t//this.visibleOrder[this.visibleOrder.$find(oldId)]=newId;\n\t\tdelete this.pull[oldId];\n\t},\n\tchangeId: function(oldId, newId){\n\t\tthis._changeIdInner(oldId, newId);\n\n\t\tthis.callEvent(\"onIdChange\", [oldId, newId]);\n\n\t},\n\texists: function(id){\n\t\treturn !!(this.pull[id]);\n\t},\n\n\t_moveInner: function(sindex, tindex){\n\t\tvar id = this.getIdByIndex(sindex);\n\n\t\tthis._updateOrder(function(){\n\t\t\tthis.$removeAt(sindex);\n\t\t\tthis.$insertAt(id,Math.min(this.length, tindex));\n\t\t});\n\t\t//this.visibleOrder.$removeAt(sindex);\t//remove at old position\n\t\t//if (sindex<tindex) tindex--;\t//correct shift, caused by element removing\n\t\t//this.visibleOrder.$insertAt(id,Math.min(this.visibleOrder.length, tindex));\t//insert at new position\n\t},\n\n\tmove: function(sindex, tindex){\n\t\t//gantt.assert(sindex>=0 && tindex>=0, \"DataStore::move\",\"Incorrect indexes\");\n\n\t\tvar id = this.getIdByIndex(sindex);\n\t\tvar obj = this.getItem(id);\n\t\tthis._moveInner(sindex, tindex);\n\n\t\tif (!this.isSilent()) {\n\t\t\t//repaint signal\n\t\t\tthis.callEvent(\"onStoreUpdated\", [obj.id, obj, \"move\"]);\n\t\t}\n\t},\n\tclearAll: function(){\n\t\tif(this.$destroyed){\n\t\t\treturn;\n\t\t}\n\t\t// GS-956 We need to unselect the resource as its ID is cached\n\t\tthis.silent(function(){\n\t\t\tthis.unselect();\n\t\t});\n\t\tthis.pull = {};\n\t\tthis.visibleOrder = powerArray.$create();\n\t\tthis.fullOrder = powerArray.$create();\n\t\tif (this.isSilent()) return;\n\t\tthis.callEvent(\"onClearAll\",[]);\n\t\tthis.refresh();\n\t},\n\n\tsilent:function(code, master){\n\t\tvar alreadySilent = false;\n\t\tif(this.isSilent()) {\n\t\t\talreadySilent = true;\n\t\t}\n\t\tthis._skip_refresh = true;\n\t\tcode.call(master||this);\n\t\t\n\t\tif (!alreadySilent) {\n\t\t\tthis._skip_refresh = false;\n\t\t}\n\t},\n\tisSilent: function(){\n\t\treturn !!this._skip_refresh;\n\t},\n\n\tarraysEqual: function (arr1, arr2) {\n\t\tif(arr1.length !== arr2.length)\n\t\t\treturn false;\n\t\tfor(var i = 0; i < arr1.length; i++) {\n\t\t\tif(arr1[i] !== arr2[i])\n\t\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t},\n\n\trefresh: function(id, quick){\n\t\tif(this.$destroyed){\n\t\t\treturn;\n\t\t}\n\t\tif (this.isSilent()) return;\n\n\t\tvar item;\n\t\tif(id){\n\t\t\titem = this.getItem(id);\n\t\t}\n\n\t\tvar args;\n\t\tif (id){\n\t\t\targs = [id, item, \"paint\"];\n\t\t}else{\n\t\t\targs = [null,null,null];\n\t\t}\n\n\t\tif(this.callEvent(\"onBeforeStoreUpdate\", args) === false){\n\t\t\treturn;\n\t\t}\n\n\t\tvar skipFilter = this._quick_refresh && !this._mark_recompute;\n\t\tthis._mark_recompute = false;\n\t\tif(id){\n\t\t\t// if item changes visible order (e.g. expand-collapse branch) - do a complete repaint\n\t\t\tif(!quick && !skipFilter){\n\t\t\t\tvar oldOrder = this.visibleOrder;\n\t\t\t\tthis.filter();\n\t\t\t\tif(!this.arraysEqual(oldOrder, this.visibleOrder)){\n\t\t\t\t\tid = undefined;\n\t\t\t\t}\n\t\t\t}\n\n\t\t}else if(!skipFilter){\n\t\t\tthis.filter();\n\t\t}\n\n\t\tif (id){\n\t\t\targs = [id, item, \"paint\"];\n\t\t}else{\n\t\t\targs = [null,null,null];\n\t\t}\n\n\t\tthis.callEvent(\"onStoreUpdated\",args);\n\t},\n\n\tcount: function(){\n\t\treturn this.fullOrder.length;\n\t},\n\tcountVisible: function(){\n\t\treturn this.visibleOrder.length;\n\t},\n\n\tsort: function(sort){},\n\n\tserialize: function(){},\n\n\teachItem: function(code){\n\t\tfor (var i=0; i<this.fullOrder.length; i++) {\n\t\t\tvar item = this.getItem(this.fullOrder[i]);\n\t\t\tcode.call(this, item);\n\t\t}\n\t},\n\n\tfind: function(filter) {\n\t\tvar result = [];\n\t\tthis.eachItem(function(item) {\n\t\t\tif(filter(item)){\n\t\t\t\tresult.push(item);\n\t\t\t}\n\t\t});\n\t\treturn result;\n\t},\n\n\tfilter: function(rule){\n\t\tif (!this.isSilent()) {\n\t\t\tthis.callEvent(\"onBeforeFilter\", []);\n\t\t}\n\t\tthis.callEvent(\"onPreFilter\", []);\n\t\tvar filteredOrder = powerArray.$create();\n\t\tvar placeholderIds = [];\n\t\tthis.eachItem(function(item){\n\t\t\tif(this.callEvent(\"onFilterItem\", [item.id, item])){\n\t\t\t\tif(isPlaceholderTask(item.id, null, this, this._ganttConfig)){\n\t\t\t\t\tplaceholderIds.push(item.id);\n\t\t\t\t} else {\n\t\t\t\t\tfilteredOrder.push(item.id);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tfor(var i = 0; i < placeholderIds.length; i++){\n\t\t\tfilteredOrder.push(placeholderIds[i]);\n\t\t}\n\n\t\tthis.visibleOrder = filteredOrder;\n\t\tthis._searchVisibleOrder = {};\n\t\tfor(var i = 0; i < this.visibleOrder.length; i++){\n\t\t\tthis._searchVisibleOrder[this.visibleOrder[i]] = i;\n\t\t}\n\t\tif (!this.isSilent()) {\n\t\t\tthis.callEvent(\"onFilter\", []);\n\t\t}\n\t},\n\n\tgetIndexRange: function(from, to){\n\t\tvar max = Math.min((to||Infinity),this.countVisible()-1);\n\t\tvar min = from||0;\n\n\t\tvar cacheKey = min + '-' + max;\n\t\tif(this._indexRangeCache[cacheKey]){\n\t\t\treturn this._indexRangeCache[cacheKey].slice();\n\t\t}\n\n\t\tvar ret= [];\n\t\tfor (var i=min; i <= max; i++)\n\t\t\tret.push(this.getItem(this.visibleOrder[i]));\n\n\t\tthis._indexRangeCache[cacheKey] = ret.slice();\n\t\treturn ret;\n\t},\n\tgetItems: function(){\n\t\tif(this._getItemsCache){\n\t\t\treturn this._getItemsCache.slice();\n\t\t}\n\n\t\tvar res = [];\n\t\tfor(var i in this.pull){\n\t\t\tres.push(this.pull[i]);\n\t\t}\n\t\tthis._getItemsCache = res.slice();\n\n\t\treturn res;\n\t},\n\n\tgetIdByIndex: function(index){\n\t\treturn this.visibleOrder[index];\n\t},\n\tgetIndexById: function(id){\n\t\tvar res = this._searchVisibleOrder[id];\n\t\tif(res === undefined){\n\t\t\tres = -1;\n\t\t}\n\t\treturn res;\n\t},\n\t_getNullIfUndefined: function(value){\n\t\tif(value === undefined){\n\t\t\treturn null;\n\t\t}else{\n\t\t\treturn value;\n\t\t}\n\t},\n\tgetFirst: function(){\n\t\treturn this._getNullIfUndefined(this.visibleOrder[0]);\n\t},\n\tgetLast: function(){\n\t\treturn this._getNullIfUndefined(this.visibleOrder[this.visibleOrder.length-1]);\n\t},\n\tgetNext: function(id){\n\t\treturn this._getNullIfUndefined(this.visibleOrder[this.getIndexById(id) + 1]);\n\t},\n\tgetPrev: function(id){\n\t\treturn this._getNullIfUndefined(this.visibleOrder[this.getIndexById(id) - 1]);\n\t},\n\tdestructor: function(){\n\t\tthis.callEvent(\"onDestroy\", []);\n\t\tthis.detachAllEvents();\n\t\tthis.$destroyed = true;\n\t\tthis.pull = null;\n\t\tthis.$initItem = null;\n\t\tthis.visibleOrder = null;\n\t\tthis.fullOrder = null;\n\t\tthis._skip_refresh = null;\n\t\tthis._filterRule = null;\n\t\tthis._searchVisibleOrder = null;\n\t\tthis._indexRangeCache = {};\n\t}\n};\n\nexport default DataStore;","export default class SplitTasksHelper {\n\n\t_datastore: any = null;\n\n\tconstructor (datastore: any) {\n\t\tthis._datastore = datastore;\n\t}\n\tisSplitItem = (item: any) => {\n\t\treturn (item.render == \"split\" && this._datastore.hasChild(item.id));\n\t};\n\tisSubrowSplitItem = (item: any) => {\n\t\treturn (item.split_placement == \"subrow\");\n\t};\n\tisDefaultSplitItem = (item: any) => {\n\t\treturn (item.split_placement == \"auto\" || item.split_placement === undefined);\n\t};\n\tisInlineSplitItem = (item: any) => {\n\t\treturn (item.split_placement == \"inline\");\n\t};\n};","import powerArray from \"./power_array\";\nimport * as utils from \"../../utils/utils\";\nimport * as helpers from \"../../utils/helpers\";\nimport DataStore from \"./datastore\";\nimport isPlaceholderTask from \"../../utils/placeholder_task\";\nimport {replaceValidZeroId} from \"../../utils/helpers\";\nimport SplitTasksHelper from \"../common/split_task_helpers\";\n\nvar TreeDataStore = function(config){\n\tDataStore.apply(this, [config]);\n\tthis._branches = {};\n\tthis._splitTaskHelper = new SplitTasksHelper(this);\n\n\tthis.pull = {};\n\t//GS-761 Update existing item instead of adding it to the new position\n\tthis.$initItem = function (item){\n\t\tvar loadedItem = item;\n\t\tif(config.initItem){\n\t\t\tloadedItem = config.initItem(loadedItem);\n\t\t}\n\t\tvar existingItem = this.getItem(item.id);\n\t\tif(existingItem && !isEqualIds(existingItem.parent,loadedItem.parent)){\n\t\t\tthis.move(loadedItem.id, loadedItem.$index || -1, loadedItem.parent || this._ganttConfig.root_id);\n\t\t}\n\t\treturn loadedItem;\n\t};\n\tthis.$parentProperty = config.parentProperty || \"parent\";\n\n\tif(typeof config.rootId !== \"function\"){\n\t\tthis.$getRootId = (function(val){\n\t\t\treturn function(){return val;};\n\t\t})(config.rootId || 0);\n\t}else{\n\t\tthis.$getRootId = config.rootId;\n\t}\n\n\t// TODO: replace with live reference to gantt config\n\tthis.$openInitially = config.openInitially;\n\n\tthis.visibleOrder = powerArray.$create();\n\tthis.fullOrder = powerArray.$create();\n\tthis._searchVisibleOrder = {};\n\tthis._indexRangeCache = {};\n\tthis._eachItemMainRangeCache = null;\n\tthis._getItemsCache = null;\n\tthis._skip_refresh = false;\n\n\tthis._ganttConfig = null;\n\tif(config.getConfig){\n\t\tthis._ganttConfig = config.getConfig();\n\t}\n\n\tvar splitParents = {};\n\tvar splitItems = {};\n\n\tvar taskOpenState = {};\n\tvar taskVisibility = {};\n\tvar haveSplitItems = false;\n\n\tthis._attachDataChange(function(){\n\t\tthis._indexRangeCache = {};\n\t\tthis._eachItemMainRangeCache = null;\n\t\tthis._getItemsCache = null;\n\t\treturn true;\n\t});\n\n\tthis.attachEvent(\"onPreFilter\", function(){\n\t\tthis._indexRangeCache = {};\n\t\tthis._eachItemMainRangeCache = null;\n\n\t\tsplitParents = {};\n\t\tsplitItems = {};\n\t\ttaskOpenState = {};\n\t\ttaskVisibility = {};\n\t\thaveSplitItems = false;\n\n\t\tthis.eachItem(function(item){\n\t\t\tvar parent = this.getParent(item.id);\n\t\t\tif(item.$open && taskOpenState[parent] !== false){\n\t\t\t\ttaskOpenState[item.id] = true;\n\t\t\t}else{\n\t\t\t\ttaskOpenState[item.id] = false;\n\t\t\t}\n\n\t\t\tif(this._isSplitItem(item)){\n\t\t\t\thaveSplitItems = true;\n\t\t\t\tsplitParents[item.id] = true;\n\t\t\t\tsplitItems[item.id] = true;\n\t\t\t}\n\n\n\t\t\tif(haveSplitItems && splitItems[parent]){\n\t\t\t\tif(this._isDefaultItem(item) || this._isInlineChildItem(item)) splitItems[item.id] = true;\n\t\t\t}\n\n\n\t\t\tif(taskOpenState[parent] || taskOpenState[parent] === undefined || this._isInlineChildItem(item)){\n\t\t\t\ttaskVisibility[item.id] = true;\n\t\t\t}else{\n\t\t\t\ttaskVisibility[item.id] = false;\n\t\t\t}\n\t\t});\n\t});\n\n\tthis.attachEvent(\"onFilterItem\", function(id, item){\n\n\t\tvar canOpenSplitTasks = false;\n\t\tif(this._ganttConfig){\n\t\t\tvar canOpenSplitTasks = this._ganttConfig.open_split_tasks;\n\t\t}\n\n\t\tvar open = taskVisibility[item.id];\n\n\t\tif(haveSplitItems){\n\t\t\tif(open && splitItems[item.id] && !splitParents[item.id]){\n\t\t\t\topen = !!canOpenSplitTasks;\n\t\t\t}\n\n\t\t\tif(splitItems[item.id] && !splitParents[item.id]){\n\t\t\t\tif(!this._isSplitChildItem(item)) item.$split_subtask = true;\n\t\t\t}\n\t\t}\n\n\t\titem.$expanded_branch = !!taskVisibility[item.id];\n\t\tif(this._isInlineChildItem(item)){\n\t\t\topen = false;\n\t\t}\n\t\treturn !!open;\n\t});\n\n\tthis.attachEvent(\"onFilter\", function(){\n\t\tsplitParents = {};\n\t\tsplitItems = {};\n\n\t\ttaskOpenState = {};\n\t\ttaskVisibility = {};\n\t});\n\n\treturn this;\n};\n\nTreeDataStore.prototype = utils.mixin({\n\n\t\t_buildTree: function(data){\n\t\t\tvar item = null;\n\t\t\tvar rootId = this.$getRootId();\n\t\t\tfor (var i = 0, len = data.length; i < len; i++){\n\t\t\t\titem = data[i];\n\t\t\t\tthis.setParent(item, replaceValidZeroId(this.getParent(item), rootId) || rootId);\n\t\t\t}\n\n\t\t\t// calculating $level for each item\n\t\t\tfor (var i = 0, len = data.length; i < len; i++){\n\t\t\t\titem = data[i];\n\t\t\t\tthis._add_branch(item);\n\t\t\t\titem.$level = this.calculateItemLevel(item);\n\t\t\t\titem.$local_index = this.getBranchIndex(item.id);\n\n\t\t\t\tif (!utils.defined(item.$open)) {\n\t\t\t\t\titem.$open = utils.defined(item.open) ? item.open : this.$openInitially();\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tthis._updateOrder();\n\t\t},\n\t\t_isSplitItem: function(item){\n\t\t\treturn this._splitTaskHelper.isSplitItem(item);\n\t\t},\n\t\t_isSplitChildItem: function(item){\n\t\t\treturn this._splitTaskHelper.isSubrowSplitItem(item);\n\t\t},\n\t\t_isDefaultItem: function(item){\n\t\t\treturn this._splitTaskHelper.isDefaultSplitItem(item);\n\t\t},\n\t\t_isInlineChildItem: function(item){\n\t\t\treturn this._splitTaskHelper.isInlineSplitItem(item);\n\t\t},\n\t\tparse: function(data){\n\t\t\tif (!this._skip_refresh) {\n\t\t\t\tthis.callEvent(\"onBeforeParse\", [data]);\n\t\t\t}\n\t\t\tvar loaded = this._parseInner(data);\n\t\t\tthis._buildTree(loaded);\n\t\t\tthis.filter();\n\t\t\tif (!this._skip_refresh) {\n\t\t\t\tthis.callEvent(\"onParse\", [loaded]);\n\t\t\t}\n\t\t},\n\n\t\t_addItemInner: function(item, index){\n\n\t\t\tvar parent = this.getParent(item);\n\n\t\t\tif(!utils.defined(parent)){\n\t\t\t\tparent = this.$getRootId();\n\t\t\t\tthis.setParent(item, parent);\n\t\t\t}\n\n\t\t\tvar parentIndex = this.getIndexById(parent);\n\t\t\tvar targetIndex = parentIndex + Math.min(Math.max(index, 0), this.visibleOrder.length);\n\n\t\t\tif(targetIndex*1 !== targetIndex){\n\t\t\t\ttargetIndex = undefined;\n\t\t\t}\n\t\t\tDataStore.prototype._addItemInner.call(this, item, targetIndex);\n\t\t\tthis.setParent(item, parent);\n\n\t\t\tif(item.hasOwnProperty(\"$rendered_parent\")){\n\t\t\t\tthis._move_branch(item, item.$rendered_parent);\n\t\t\t}\n\t\t\tthis._add_branch(item, index);\n\t\t},\n\t\t_changeIdInner: function(oldId, newId){\n\t\t\tvar children = this.getChildren(oldId);\n\t\t\tvar visibleOrder = this._searchVisibleOrder[oldId];\n\n\t\t\tDataStore.prototype._changeIdInner.call(this, oldId, newId);\n\n\t\t\tvar parent = this.getParent(newId);\n\n\t\t\tthis._replace_branch_child(parent, oldId, newId);\n\n\t\t\tif(this._branches[oldId]){\n\t\t\t\tthis._branches[newId] = this._branches[oldId];\n\t\t\t}\n\t\t\tfor(var i = 0; i < children.length; i++){\n\t\t\t\tvar child = this.getItem(children[i]);\n\t\t\t\tchild[this.$parentProperty] = newId;\n\t\t\t\tchild.$rendered_parent = newId;\n\t\t\t}\n\n\t\t\tthis._searchVisibleOrder[newId] = visibleOrder;\n\t\t\tdelete this._branches[oldId];\n\t\t},\n\n\t\t_traverseBranches: function(code, parent){\n\t\t\tif (!utils.defined(parent)) {\n\t\t\t\tparent = this.$getRootId();\n\t\t\t}\n\t\t\tvar branch = this._branches[parent];\n\t\t\tif (branch) {\n\t\t\t\tfor (var i = 0; i < branch.length; i++) {\n\t\t\t\t\tvar itemId = branch[i];\n\t\t\t\t\tcode.call(this, itemId);\n\t\t\t\t\tif (this._branches[itemId])\n\t\t\t\t\t\tthis._traverseBranches(code, itemId);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_updateOrder: function(code){\n\n\t\t\tthis.fullOrder = powerArray.$create();\n\t\t\tthis._traverseBranches(function(taskId){\n\t\t\t\tthis.fullOrder.push(taskId);\n\t\t\t});\n\n\t\t\tif(code)\n\t\t\t\tDataStore.prototype._updateOrder.call(this, code);\n\t\t},\n\n\t\t_removeItemInner: function(id){\n\n\t\t\tvar items = [];\n\t\t\tthis.eachItem(function(child){\n\t\t\t\titems.push(child);\n\t\t\t}, id);\n\n\t\t\titems.push(this.getItem(id));\n\n\t\t\tfor(var i = 0; i < items.length; i++){\n\n\t\t\t\tthis._move_branch(items[i], this.getParent(items[i]), null);\n\t\t\t\tDataStore.prototype._removeItemInner.call(this, items[i].id);\n\t\t\t\tthis._move_branch(items[i], this.getParent(items[i]), null);\n\t\t\t}\n\t\t},\n\n\t\tmove: function(sid, tindex, parent){\n\t\t\t//target id as 4th parameter\n\t\t\tvar id = arguments[3];\n\t\t\tvar config = this._ganttConfig || {};\n\t\t\tvar root_id = config.root_id || 0;\n\t\t\tid = replaceValidZeroId(id, root_id);\n\t\t\tif (id) {\n\t\t\t\tif (id === sid) return;\n\n\t\t\t\tparent = this.getParent(id);\n\t\t\t\ttindex = this.getBranchIndex(id);\n\t\t\t}\n\t\t\tif(isEqualIds(sid, parent)){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!utils.defined(parent)) {\n\t\t\t\tparent = this.$getRootId();\n\t\t\t}\n\t\t\tvar source = this.getItem(sid);\n\t\t\tvar source_pid = this.getParent(source.id);\n\n\t\t\tvar tbranch = this.getChildren(parent);\n\n\t\t\tif (tindex == -1)\n\t\t\t\ttindex = tbranch.length + 1;\n\t\t\tif (isEqualIds(source_pid, parent)) {\n\t\t\t\tvar sindex = this.getBranchIndex(sid);\n\t\t\t\tif (sindex == tindex) return;\n\t\t\t}\n\n\t\t\tif(this.callEvent(\"onBeforeItemMove\", [sid, parent, tindex]) === false)\n\t\t\t\treturn false;\n\n\t\t\tvar placeholderIds = [];\n\t\t\tfor(var i = 0; i < tbranch.length; i++){\n\t\t\t\tif (isPlaceholderTask(tbranch[i], null, this, this._ganttConfig)){\n\t\t\t\t\tplaceholderIds.push(tbranch[i]);\n\t\t\t\t\ttbranch.splice(i, 1);\n\t\t\t\t\ti--;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._replace_branch_child(source_pid, sid);\n\t\t\ttbranch = this.getChildren(parent);\n\n\t\t\tvar tid = tbranch[tindex];\n\t\t\ttid = replaceValidZeroId(tid, root_id);\n\t\t\tif (!tid) //adding as last element\n\t\t\t\ttbranch.push(sid);\n\t\t\telse\n\t\t\t\ttbranch = tbranch.slice(0, tindex).concat([ sid ]).concat(tbranch.slice(tindex));\n\n\t\t\tif (placeholderIds.length){\n\t\t\t\ttbranch = tbranch.concat(placeholderIds);\n\t\t\t}\n\t\t\t// GS-2423 to return initial parent to the task before it will be moved\n\t\t\tif (!isEqualIds(source.$rendered_parent, source_pid) && !isEqualIds(source_pid, parent)){\n\t\t\t\tsource.$rendered_parent = source_pid;\n\t\t\t}\n\t\t\tthis.setParent(source, parent);\n\t\t\tthis._branches[parent] = tbranch;\n\n\t\t\tvar diff = this.calculateItemLevel(source) - source.$level;\n\t\t\tsource.$level += diff;\n\t\t\tthis.eachItem(function(item){\n\t\t\t\titem.$level += diff;\n\t\t\t}, source.id, this);\n\n\n\t\t\tthis._moveInner(this.getIndexById(sid), this.getIndexById(parent) + tindex);\n\n\t\t\tthis.callEvent(\"onAfterItemMove\", [sid, parent, tindex]);\n\t\t\tthis.refresh();\n\t\t},\n\n\t\tgetBranchIndex: function(id){\n\t\t\tvar branch = this.getChildren(this.getParent(id));\n\t\t\tlet index = branch.indexOf(id + \"\");\n\t\t\tif (index == -1){\n\t\t\t\tindex = branch.indexOf(+id);\n\t\t\t}\n\t\t\treturn index;\n\t\t},\n\t\thasChild: function(id){\n\t\t\tvar branch = this._branches[id];\n\t\t\treturn branch && branch.length;\n\t\t},\n\t\tgetChildren: function(id){\n\t\t\tvar branch = this._branches[id];\n\t\t\treturn branch ? branch : powerArray.$create();\n\t\t},\n\n\t\tisChildOf: function(childId, parentId){\n\t\t\tif (!this.exists(childId))\n\t\t\t\treturn false;\n\t\t\tif (parentId === this.$getRootId())\n\t\t\t\treturn true;\n\n\t\t\tif (!this.hasChild(parentId))\n\t\t\t\treturn false;\n\n\t\t\tvar item = this.getItem(childId);\n\t\t\tvar pid = this.getParent(childId);\n\n\t\t\tvar parent = this.getItem(parentId);\n\t\t\tif(parent.$level >= item.$level){\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\twhile (item && this.exists(pid)) {\n\t\t\t\titem = this.getItem(pid);\n\n\t\t\t\tif (item && isEqualIds(item.id, parentId))\n\t\t\t\t\treturn true;\n\t\t\t\tpid = this.getParent(item);\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\n\t\tgetSiblings: function(id){\n\t\t\tif(!this.exists(id)){\n\t\t\t\treturn powerArray.$create();\n\t\t\t}\n\t\t\tvar parent = this.getParent(id);\n\t\t\treturn this.getChildren(parent);\n\n\t\t},\n\t\tgetNextSibling: function(id){\n\t\t\tvar siblings = this.getSiblings(id);\n\t\t\tfor(var i= 0, len = siblings.length; i < len; i++){\n\t\t\t\tif(isEqualIds(siblings[i], id)){\n\t\t\t\t\tvar nextSibling = siblings[i+1];\n\t\t\t\t\tif (nextSibling === 0 && i > 0){\n\t\t\t\t\t\tnextSibling = \"0\";\n\t\t\t\t\t}\n\t\t\t\t\treturn nextSibling || null;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\tgetPrevSibling: function(id){\n\t\t\tvar siblings = this.getSiblings(id);\n\t\t\tfor(var i= 0, len = siblings.length; i < len; i++){\n\t\t\t\tif(isEqualIds(siblings[i], id)){\n\t\t\t\t\tvar previousSibling = siblings[i-1];\n\t\t\t\t\tif (previousSibling === 0 && i > 0){\n\t\t\t\t\t\tpreviousSibling = \"0\";\n\t\t\t\t\t}\n\t\t\t\t\treturn previousSibling || null;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\tgetParent: function(id){\n\t\t\tvar item = null;\n\t\t\tif(id.id !== undefined){\n\t\t\t\titem = id;\n\t\t\t}else{\n\t\t\t\titem = this.getItem(id);\n\t\t\t}\n\n\t\t\tvar parent;\n\t\t\tif(item){\n\t\t\t\tparent = item[this.$parentProperty];\n\t\t\t}else{\n\t\t\t\tparent = this.$getRootId();\n\t\t\t}\n\t\t\treturn parent;\n\n\t\t},\n\n\t\tclearAll: function(){\n\t\t\tthis._branches = {};\n\t\t\tDataStore.prototype.clearAll.call(this);\n\t\t},\n\n\t\tcalculateItemLevel: function(item){\n\t\t\tvar level = 0;\n\t\t\tthis.eachParent(function(){\n\t\t\t\tlevel++;\n\t\t\t}, item);\n\t\t\treturn level;\n\t\t},\n\n\t\t_setParentInner: function(item, new_pid, silent){\n\t\t\tif(!silent){\n\t\t\t\tif(item.hasOwnProperty(\"$rendered_parent\")){\n\t\t\t\t\tthis._move_branch(item, item.$rendered_parent, new_pid);\n\t\t\t\t}else{\n\t\t\t\t\tthis._move_branch(item, item[this.$parentProperty], new_pid);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tsetParent: function(item, new_pid, silent){\n\t\t\tthis._setParentInner(item, new_pid, silent);\n\n\t\t\titem[this.$parentProperty] = new_pid;\n\t\t},\n\n\t\t_eachItemCached: function(code, cache){\n\t\t\tfor(var i = 0, len = cache.length; i < len; i++){\n\t\t\t\tcode.call(this, cache[i]);\n\t\t\t}\n\t\t},\n\t\t_eachItemIterate: function(code, startId, cache){\n\t\t\tvar itemsStack = this.getChildren(startId);\n\t\t\tif(itemsStack.length){\n\t\t\t\titemsStack = itemsStack.slice().reverse();\n\t\t\t}\n\t\t\twhile(itemsStack.length){\n\t\t\t\tvar itemId = itemsStack.pop();\n\t\t\t\tvar item = this.getItem(itemId);\n\t\t\t\tcode.call(this, item);\n\t\t\t\tif(cache){\n\t\t\t\t\tcache.push(item);\n\t\t\t\t}\n\n\t\t\t\tif(this.hasChild(item.id)){\n\t\t\t\t\tvar children = this.getChildren(item.id);\n\t\t\t\t\tvar len = children.length;\n\t\t\t\t\tfor(var i = len - 1; i >= 0; i--){\n\t\t\t\t\t\titemsStack.push(children[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t},\n\n\t\teachItem: function(code, parent){\n\t\t\tvar rootId = this.$getRootId();\n\t\t\tif (!utils.defined(parent)) {\n\t\t\t\tparent = rootId;\n\t\t\t}\n\t\t\tvar startId = replaceValidZeroId(parent, rootId) || rootId;\n\n\t\t\tvar useCache = false;\n\t\t\tvar buildCache = false;\n\t\t\tvar cache = null;\n\t\t\tif(startId === rootId){\n\t\t\t\tif(this._eachItemMainRangeCache){\n\t\t\t\t\tuseCache = true;\n\t\t\t\t\tcache = this._eachItemMainRangeCache;\n\t\t\t\t}else{\n\t\t\t\t\tbuildCache = true;\n\t\t\t\t\tcache = this._eachItemMainRangeCache = [];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(useCache){\n\t\t\t\tthis._eachItemCached(code, cache);\n\t\t\t}else{\n\t\t\t\tthis._eachItemIterate(code, startId, buildCache ? cache : null);\n\t\t\t}\n\t\t},\n\t\teachParent: function(code, startItem) {\n\t\t\tvar parentsHash = {};\n\t\t\tvar item = startItem;\n\t\t\tvar parent = this.getParent(item);\n\n\t\t\twhile (this.exists(parent)) {\n\t\t\t\tif (parentsHash[parent]) {\n\t\t\t\t\tthrow new Error(\"Invalid tasks tree. Cyclic reference has been detected on task \" + parent);\n\t\t\t\t}\n\t\t\t\tparentsHash[parent] = true;\n\t\t\t\titem = this.getItem(parent);\n\t\t\t\tcode.call(this, item);\n\t\t\t\tparent = this.getParent(item);\n\t\t\t}\n\t\t},\n\t\t_add_branch: function(item, index, parent){\n\t\t\tvar pid = parent === undefined ? this.getParent(item) : parent;\n\t\t\tif (!this.hasChild(pid))\n\t\t\t\tthis._branches[pid] = powerArray.$create();\n\t\t\tvar branch = this.getChildren(pid);\n\t\t\tvar added_already = branch.indexOf(item.id + \"\") > -1 || branch.indexOf(+item.id) > -1;\n\t\t\tif(!added_already){\n\t\t\t\tif(index*1 == index){\n\n\t\t\t\t\tbranch.splice(index, 0, item.id);\n\t\t\t\t}else{\n\t\t\t\t\tbranch.push(item.id);\n\t\t\t\t}\n\n\t\t\t\titem.$rendered_parent = pid;\n\t\t\t}\n\t\t},\n\t\t_move_branch: function(item, old_parent, new_parent){\n\t\t\tthis._eachItemMainRangeCache = null;\n\t\t\t//this.setParent(item, new_parent);\n\t\t\t//this._sync_parent(task);\n\t\t\tthis._replace_branch_child(old_parent, item.id);\n\t\t\tif(this.exists(new_parent) || isEqualIds(new_parent, this.$getRootId())){\n\n\t\t\t\tthis._add_branch(item, undefined, new_parent);\n\t\t\t}else{\n\t\t\t\tdelete this._branches[item.id];\n\t\t\t}\n\t\t\titem.$level =  this.calculateItemLevel(item);\n\t\t\tthis.eachItem(function(child){\n\t\t\t\tchild.$level = this.calculateItemLevel(child);\n\t\t\t}, item.id);\n\t\t},\n\n\t\t_replace_branch_child: function(node, old_id, new_id){\n\t\t\tvar branch = this.getChildren(node);\n\t\t\tif (branch && node !== undefined){\n\t\t\t\tvar newbranch = powerArray.$create();\n\n\t\t\t\tlet index = branch.indexOf(old_id + \"\");\n\t\t\t\tif (index == -1 && !isNaN(+old_id)){\n\t\t\t\t\tindex = branch.indexOf(+old_id);\n\t\t\t\t} \n\n\t\t\t\tif (index > -1){\n\t\t\t\t\tif (new_id){\n\t\t\t\t\t\tbranch.splice(index, 1, new_id);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbranch.splice(index, 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tnewbranch = branch;\n\n\t\t\t\tthis._branches[node] = newbranch;\n\t\t\t}\n\n\t\t},\n\n\t\tsort: function(field, desc, parent){\n\t\t\tif (!this.exists(parent)) {\n\t\t\t\tparent = this.$getRootId();\n\t\t\t}\n\n\t\t\tif (!field) field = \"order\";\n\t\t\tvar criteria = (typeof(field) == \"string\") ? (function(a, b) {\n\t\t\t\tif (a[field] == b[field] ||\n\t\t\t\t\t(helpers.isDate(a[field]) && helpers.isDate(b[field]) && a[field].valueOf() == b[field].valueOf()))\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\tvar result = a[field] > b[field];\n\t\t\t\treturn result ? 1 : -1;\n\t\t\t}) : field;\n\n\t\t\tif (desc) {\n\t\t\t\tvar original_criteria = criteria;\n\t\t\t\tcriteria = function (a, b) {\n\t\t\t\t\treturn original_criteria(b, a);\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tvar els = this.getChildren(parent);\n\n\t\t\tif (els){\n\t\t\t\tvar temp = [];\n\t\t\t\tfor (var i = els.length - 1; i >= 0; i--)\n\t\t\t\t\ttemp[i] = this.getItem(els[i]);\n\n\t\t\t\ttemp.sort(criteria);\n\n\t\t\t\tfor (var i = 0; i < temp.length; i++) {\n\t\t\t\t\tels[i] = temp[i].id;\n\t\t\t\t\tthis.sort(field, desc, els[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tfilter: function(rule){\n\t\t\tfor(let i in this.pull){\n\t\t\t\tconst renderedParent = this.pull[i].$rendered_parent;\n\t\t\t\tconst actualParent = this.getParent(this.pull[i]);\n\t\t\t\t//GS-2339: could be different types of the ids\n\t\t\t\tif(!isEqualIds(renderedParent,actualParent)){\n\t\t\t\t\tthis._move_branch(this.pull[i], renderedParent, actualParent);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn DataStore.prototype.filter.apply(this, arguments);\n\t\t},\n\n\t\topen: function(id){\n\t\t\tif(this.exists(id)){\n\t\t\t\tthis.getItem(id).$open = true;\n\t\t\t\t// GS-2170. Do not recalculate the indexes and dates as they will be recalculated later\n\t\t\t\tthis._skipTaskRecalculation = true;\n\t\t\t\tthis.callEvent(\"onItemOpen\", [id]);\n\t\t\t}\n\t\t},\n\n\t\tclose: function(id){\n\t\t\tif(this.exists(id)){\n\t\t\t\tthis.getItem(id).$open = false;\n\t\t\t\t// GS-2170. Do not recalculate the indexes and dates as they will be recalculated later\n\t\t\t\tthis._skipTaskRecalculation = true;\n\t\t\t\tthis.callEvent(\"onItemClose\", [id]);\n\t\t\t}\n\t\t},\n\n\t\tdestructor: function(){\n\t\t\tDataStore.prototype.destructor.call(this);\n\t\t\tthis._branches = null;\n\t\t\tthis._indexRangeCache = {};\n\t\t\tthis._eachItemMainRangeCache = null;\n\t\t}\n\t},\n\tDataStore.prototype\n);\n\nfunction isEqualIds(first, second){\n\treturn String(first) === String(second);\n};\n\nexport default TreeDataStore;","import env from \"./env\";\n\nexport default function(gantt){\n\treturn env.isNode || !gantt.$root;\n};","import isHeadless from \"../../utils/is_headless\";\n\nconst storeRenderCreator = function(name, gantt){\n\n\tconst store = gantt.getDatastore(name);\n\n\tconst itemRepainter = {\n\t\trenderItem: function(id, renderer){\n\n\t\t\tconst renders = renderer.getLayers();\n\n\t\t\tconst item = store.getItem(id);\n\t\t\tif(item && store.isVisible(id)) {\n\t\t\t\tfor (let i = 0; i < renders.length; i++)\n\t\t\t\t\trenders[i].render_item(item);\n\t\t\t}\n\t\t},\n\t\trenderItems: function(renderer){\n\t\t\tconst renderers = renderer.getLayers();\n\t\t\tfor (let i = 0; i < renderers.length; i++) {\n\t\t\t\trenderers[i].clear();\n\t\t\t}\n\n\t\t\tlet allData = null;\n\n\t\t\tconst loadedRanges = {};\n\t\t\tfor (let i = 0; i < renderers.length; i++) {\n\t\t\t\tconst layer = renderers[i];\n\t\t\t\tlet layerData;\n\t\t\t\tif(layer.get_visible_range){\n\n\t\t\t\t\tvar range = layer.get_visible_range(store);\n\t\t\t\t\tif(range.start !== undefined && range.end !== undefined){\n\t\t\t\t\t\tvar key = range.start + \" - \" + range.end;\n\t\t\t\t\t\tif(loadedRanges[key]){\n\t\t\t\t\t\t\tlayerData = loadedRanges[key];\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tlayerData = store.getIndexRange(range.start, range.end);\n\t\t\t\t\t\t\tloadedRanges[key] = layerData;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else if(range.ids !== undefined){\n\t\t\t\t\t\tlayerData = range.ids.map(function(id){\n\t\t\t\t\t\t\treturn store.getItem(id);\n\t\t\t\t\t\t});\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthrow new Error(\"Invalid range returned from 'getVisibleRange' of the layer\");\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tif(!allData){\n\t\t\t\t\t\tallData = store.getVisibleItems();\n\t\t\t\t\t}\n\t\t\t\t\tlayerData = allData;\n\t\t\t\t}\n\n\t\t\t\tif (layer.prepare_data) {\n\t\t\t\t\t// GS-1605. Highlight timeline cells below tasks and in an empty chart\n\t\t\t\t\tlayer.prepare_data(layerData);\n\t\t\t\t}\n\n\t\t\t\trenderers[i].render_items(layerData);\n\t\t\t}\n\t\t},\n\t\tupdateItems: function(layer) {\n\t\t\tif(layer.update_items){\n\t\t\t\tlet data = [];\n\t\t\t\tif(layer.get_visible_range){\n\n\t\t\t\t\tvar range = layer.get_visible_range(store);\n\t\t\t\t\tif(range.start !== undefined && range.end !== undefined){\n\t\t\t\t\t\tdata = store.getIndexRange(range.start, range.end);\n\t\t\t\t\t}\n\t\t\t\t\tif(range.ids !== undefined){\n\t\t\t\t\t\tlet extraDataArr = range.ids.map(function(id){\n\t\t\t\t\t\t\treturn store.getItem(id);\n\t\t\t\t\t\t});\n\t\t\t\t\t\t// GS-2502: range.ids might not exist in other datastores\n\t\t\t\t\t\tif(extraDataArr.length > 0){\n\t\t\t\t\t\t\textraDataArr = extraDataArr.filter(element => element !== undefined);\n\t\t\t\t\t\t\tdata = data.concat(extraDataArr);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif((range.start == undefined || range.end == undefined) && range.ids == undefined)  {\n\t\t\t\t\t\tthrow new Error(\"Invalid range returned from 'getVisibleRange' of the layer\");\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tdata = store.getVisibleItems();\n\t\t\t\t}\n\n\t\t\t\tif (layer.prepare_data) {\n\t\t\t\t\t// GS-1605. Highlight timeline cells below tasks and in an empty chart\n\t\t\t\t\tlayer.prepare_data(data, layer);\n\t\t\t\t}\n\t\t\t\tlayer.update_items(data);\n\t\t\t}\n\t\t}\n\t};\n\n\tstore.attachEvent(\"onStoreUpdated\", function(id, item, action){\n\t\tif(isHeadless(gantt)){\n\t\t\treturn true;\n\t\t}\n\n\t\tconst renderer = gantt.$services.getService(\"layers\").getDataRender(name);\n\t\tif(renderer){\n\t\t\trenderer.onUpdateRequest = function(layer){\n\t\t\t\titemRepainter.updateItems(layer);\n\t\t\t};\n\t\t}\n\t});\n\n\tfunction skipRepaint(gantt){\n\t\tconst state = gantt.$services.getService(\"state\");\n\t\tif(state.getState(\"batchUpdate\").batch_update){\n\t\t\treturn true;\n\t\t}else{\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tstore.attachEvent(\"onStoreUpdated\", function(id, item, action){\n\t\tif(skipRepaint(gantt)){\n\t\t\treturn;\n\t\t}\n\t\tif(!id || action == \"move\" || action == \"delete\"){\n\t\t\tstore.callEvent(\"onBeforeRefreshAll\", []);\n\t\t\tstore.callEvent(\"onAfterRefreshAll\", []);\n\t\t}else{\n\t\t\tstore.callEvent(\"onBeforeRefreshItem\", [item.id]);\n\t\t\tstore.callEvent(\"onAfterRefreshItem\", [item.id]);\n\t\t}\n\t});\n\n\tstore.attachEvent(\"onAfterRefreshAll\", function(){\n\t\tif(isHeadless(gantt)){\n\t\t\treturn true;\n\t\t}\n\n\t\tconst renderer = gantt.$services.getService(\"layers\").getDataRender(name);\n\t\tif(renderer && !skipRepaint(gantt)){\n\t\t\titemRepainter.renderItems(renderer);\n\t\t}\n\t});\n\tstore.attachEvent(\"onAfterRefreshItem\", function(id){\n\t\tif(isHeadless(gantt)){\n\t\t\treturn true;\n\t\t}\n\n\t\tconst renderer = gantt.$services.getService(\"layers\").getDataRender(name);\n\t\tif(renderer){\n\t\t\titemRepainter.renderItem(id, renderer);\n\t\t}\n\t});\n\n\t// TODO: probably can be done more in a more efficient way\n\tstore.attachEvent(\"onItemOpen\", function(){\n\t\tif(isHeadless(gantt) || store.isSilent()){\n\t\t\treturn true;\n\t\t}\n\n\t\tgantt.render();\n\t});\n\n\tstore.attachEvent(\"onItemClose\", function(){\n\t\tif(isHeadless(gantt) || store.isSilent()){\n\t\t\treturn true;\n\t\t}\n\n\t\tgantt.render();\n\t});\n\n\tfunction refreshId(renders, oldId, newId, item) {\n\t\tfor (let i = 0; i < renders.length; i++) {\n\t\t\trenders[i].change_id(oldId, newId);\n\t\t}\n\t}\n\n\tstore.attachEvent(\"onIdChange\", function(oldId, newId){\n\t\tif(isHeadless(gantt)){\n\t\t\treturn true;\n\t\t}\n\n\t\t// in case of linked datastores (tasks <-> links), id change should recalculate something in linked datastore before any repaint\n\t\t// use onBeforeIdChange for this hook.\n\t\t// TODO: use something more reasonable instead\n\t\tstore.callEvent(\"onBeforeIdChange\", [oldId, newId]);\n\n\t\tif(skipRepaint(gantt)){\n\t\t\treturn;\n\t\t}\n\t\tif(!store.isSilent()){\n\t\t\tconst renderer = gantt.$services.getService(\"layers\").getDataRender(name);\n\t\t\tif(renderer){ // missing check for renderer GS-1814\n\t\t\t\trefreshId(renderer.getLayers(), oldId, newId, store.getItem(newId));\n\t\t\t\titemRepainter.renderItem(newId, renderer);\n\t\t\t}else{\n\t\t\t\t// GS-1814 repaint ui to apply new id when the datastore don't have own renderer\n\t\t\t\tgantt.render();\n\t\t\t}\n\t\t}\n\t});\n\n};\n\nexport default {\n\tbindDataStore: storeRenderCreator\n};","import * as utils from \"../../utils/utils\";\nimport createTasksFacade from \"./datastore_tasks\";\nimport createLinksFacade from \"./datastore_links\";\nimport DataStore from \"../datastore/datastore\";\nimport TreeDataStore from \"../datastore/treedatastore\";\nimport createDatastoreSelect from \"../datastore/select\";\nimport datastoreRender from \"../datastore/datastore_render\";\nimport isHeadless from \"../../utils/is_headless\";\nimport {replaceValidZeroId} from \"../../utils/helpers\";\n\nfunction getDatastores(){\n\tvar storeNames = this.$services.getService(\"datastores\");\n\tvar res = [];\n\tfor(var i = 0; i < storeNames.length; i++){\n\t\tvar store = this.getDatastore(storeNames[i]);\n\t\tif(!store.$destroyed){\n\t\t\tres.push(store);\n\t\t}\n\t}\n\treturn res;\n}\n\nvar createDatastoreFacade = function(){\n\treturn {\n\tcreateDatastore: function(config){\n\n\t\tvar $StoreType = (config.type || \"\").toLowerCase() == \"treedatastore\" ? TreeDataStore : DataStore;\n\n\t\tif (config) {\n\t\t\tvar self = this;\n\t\t\tconfig.openInitially = function(){ return self.config.open_tree_initially; };\n\t\t\tconfig.copyOnParse = function(){ return self.config.deepcopy_on_parse; };\n\t\t}\n\n\t\tvar store = new $StoreType(config);\n\t\tthis.mixin(store, createDatastoreSelect(store));\n\n\t\tif (config.name) {\n\t\t\tvar servicePrefix = \"datastore:\";\n\t\t\tvar storeAccessName = servicePrefix + config.name;\n\n\t\t\tstore.attachEvent(\"onDestroy\", function(){\n\t\t\t\tthis.$services.dropService(storeAccessName);\n\t\t\t\tvar storeList = this.$services.getService(\"datastores\");\n\t\t\t\tfor(var i = 0; i < storeList.length; i++){\n\t\t\t\t\tif(storeList[i] === config.name){\n\t\t\t\t\t\tstoreList.splice(i, 1);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}.bind(this));\n\n\t\t\tthis.$services.dropService(storeAccessName);\n\t\t\tthis.$services.setService(storeAccessName, function() { return store; } );\n\n\t\t\tvar storeList = this.$services.getService(\"datastores\");\n\t\t\tif (!storeList) {\n\t\t\t\tstoreList = [];\n\t\t\t\tthis.$services.setService(\"datastores\", function() { return storeList; });\n\t\t\t\tstoreList.push(config.name);\n\t\t\t} else if (storeList.indexOf(config.name) < 0) {\n\t\t\t\tstoreList.push(config.name);\n\t\t\t}\n\n\t\t\tdatastoreRender.bindDataStore(config.name, this);\n\n\t\t}\n\n\t\treturn store;\n\t},\n\tgetDatastore: function(name){\n\t\treturn this.$services.getService(\"datastore:\" + name);\n\t},\n\t_getDatastores: getDatastores,\n\n\trefreshData: function () {\n\t\tvar scrollState;\n\t\tif(!isHeadless(this)){\n\t\t\tscrollState = this.getScrollState();\n\t\t}\n\n\t\tthis.callEvent(\"onBeforeDataRender\", []);\n\n\t\tvar stores = getDatastores.call(this);\n\t\tfor(var i = 0; i < stores.length; i++){\n\t\t\tstores[i].refresh();\n\t\t}\n\n\t\tif(this.config.preserve_scroll && !isHeadless(this)){\n\t\t\tif(scrollState.x || scrollState.y){\n\t\t\t\tthis.scrollTo(scrollState.x, scrollState.y);\n\t\t\t}\n\t\t\t// GS-2866: need to restore the scroll position after resizing the resource view\n\t\t\t// in case if it was increased\n\t\t\tconst scrollbarsInfo = this.$layout.getScrollbarsInfo();\n\t\t\tscrollbarsInfo.forEach((scroll_info) => {\n\t\t\t\tconst scroll = this.$ui.getView(scroll_info.id);\n\t\t\t\tif(!scroll) return;\n\t\t\t\tconst scrollbarNodeVisible = this.utils.dom.isChildOf(scroll.$view, this.$container);\n\t\t\t\tscroll_info.boundViews.forEach((viewName) => {\n\t\t\t\t\tconst view = this.$ui.getView(viewName);\n\t\t\t\t\tif(scroll_info.y){\n\t\t\t\t\t\tif(view && !scrollbarNodeVisible){\n\t\t\t\t\t\t\tview.scrollTo(undefined, 0);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\tthis.callEvent(\"onDataRender\", []);\n\n\t},\n\n\tisChildOf: function(childId, parentId){\n\t\treturn this.$data.tasksStore.isChildOf(childId, parentId);\n\t},\n\n\trefreshTask: function (taskId, refresh_links) {\n\t\tvar task = this.getTask(taskId);\n\t\tvar self = this;\n\t\tfunction refreshLinks(){\n\t\t\tif (refresh_links !== undefined && !refresh_links)\n\t\t\t\treturn;\n\t\t\tfor (var i = 0; i < task.$source.length; i++) {\n\t\t\t\tself.refreshLink(task.$source[i]);\n\t\t\t}\n\t\t\tfor (var i = 0; i < task.$target.length; i++) {\n\t\t\t\tself.refreshLink(task.$target[i]);\n\t\t\t}\n\t\t}\n\n\t\tif (task && this.isTaskVisible(taskId)) {\n\t\t\tthis.$data.tasksStore.refresh(taskId, !!this.getState(\"tasksDnd\").drag_id || refresh_links === false);// do quick refresh during drag and drop\n\t\t\trefreshLinks();\n\t\t}else if(this.isTaskExists(taskId) && this.isTaskExists(this.getParent(taskId)) && !this._bulk_dnd){\n\t\t\tthis.refreshTask(this.getParent(taskId));\n\n\t\t\tvar hasSplitParent = false;\n\t\t\tthis.eachParent(function(parent){\n\t\t\t\tif(hasSplitParent || this.isSplitTask(parent)){\n\t\t\t\t\thasSplitParent = true;\n\t\t\t\t}\n\t\t\t}, taskId);\n\t\t\tif(hasSplitParent){\n\t\t\t\trefreshLinks();\n\t\t\t}\n\t\t}\n\n\t},\n\trefreshLink: function (linkId) {\n\t\tthis.$data.linksStore.refresh(linkId, !!this.getState(\"tasksDnd\").drag_id);// do quick refresh during drag and drop\n\t},\n\n\tsilent: function(code){\n\t\tvar gantt = this;\n\t\tgantt.$data.tasksStore.silent(function(){\n\t\t\tgantt.$data.linksStore.silent(function(){\n\t\t\t\tcode();\n\t\t\t});\n\t\t});\n\t},\n\n\tclearAll: function () {\n\t\tvar stores = getDatastores.call(this);\n\t\t\n\t\t// clear all stores without invoking clearAll event\n\t\t// in order to prevent calling handlers when only some stores are cleared\n\t\tfor(var i = 0; i < stores.length; i++){\n\t\t\tstores[i].silent(function(){\n\t\t\t\tstores[i].clearAll();\t\n\t\t\t});\n\t\t}\n\t\t// run clearAll again to invoke events\n\t\tfor(var i = 0; i < stores.length; i++){\n\t\t\tstores[i].clearAll();\t\n\t\t}\n\n\t\tthis._update_flags();\n\t\tthis.userdata = {};\n\t\tthis.callEvent(\"onClear\", []);\n\t\tthis.render();\n\t},\n\t_clear_data: function () {\n\t\tthis.$data.tasksStore.clearAll();\n\t\tthis.$data.linksStore.clearAll();\n\t\tthis._update_flags();\n\t\tthis.userdata = {};\n\t},\n\n\tselectTask: function(id){\n\t\tvar store = this.$data.tasksStore;\n\t\tif(!this.config.select_task)\n\t\t\treturn false;\n\t\tid = replaceValidZeroId(id, this.config.root_id);\n\t\tif (id){\n\t\t\tlet oldSelectId = this.getSelectedId();\n\t\t\t// Don't repaint the resource panel as the data didn't change\n\t\t\tstore._skipResourceRepaint = true;\n\t\t\tstore.select(id);\n\t\t\tstore._skipResourceRepaint = false;\n\t\t\t// GS-730. Split task is not included in the tree, \n\t\t\t// so the datastore renderer will think that the task is not visible\n\t\t\tif (oldSelectId && store.pull[oldSelectId].$split_subtask && oldSelectId != id) {\n\t\t\t\tthis.refreshTask(oldSelectId);\n\t\t\t}\n\t\t\tif (store.pull[id].$split_subtask && oldSelectId != id) {// GS-1850. Do not repaint split task after double click\n\t\t\t\tthis.refreshTask(id);\n\t\t\t}\n\t\t}\n\t\treturn store.getSelectedId();\n\t},\n\tunselectTask: function(id){\n\t\tvar store = this.$data.tasksStore;\n\t\tstore.unselect(id);\n\t\t// GS-730. Split task is not included in the tree, \n\t\t// so the datastore renderer will think that the task is not visible\n\t\tif (id && store.pull[id].$split_subtask) {\n\t\t\tthis.refreshTask(id);\n\t\t}\n\t},\n\tisSelectedTask: function(id){\n\t\treturn this.$data.tasksStore.isSelected(id);\n\t},\n\tgetSelectedId: function() {\n\t\treturn this.$data.tasksStore.getSelectedId();\n\t}\n};\n};\n\nfunction createFacade(){\n\tvar res = utils.mixin({}, createDatastoreFacade());\n\tutils.mixin(res, createTasksFacade());\n\tutils.mixin(res, createLinksFacade());\n\treturn res;\n}\n\n\n\n\nexport default {create: createFacade};","function createDataStoreSelectMixin(store){\n\tvar selectedId = null;\n\n\tvar deleteItem = store._removeItemInner;\n\t\n\tfunction unselect(id){\n\t\tselectedId = null;\n\t\tthis.callEvent(\"onAfterUnselect\", [id]);\n\t}\n\n\tstore._removeItemInner = function(id){\n\t\tif(selectedId == id){\n\t\t\tunselect.call(this, id);\n\t\t}\n\n\t\tif(selectedId && this.eachItem){\n\t\t\tthis.eachItem(function(subItem){\n\t\t\t\tif(subItem.id == selectedId){\n\t\t\t\t\tunselect.call(this, subItem.id);\n\t\t\t\t}\n\t\t\t}, id);\n\t\t}\n\n\t\treturn deleteItem.apply(this, arguments);\n\t};\n\n\tstore.attachEvent(\"onIdChange\", function(oldId, newId) {\n\t\tif (store.getSelectedId() == oldId) {\n\t\t\tstore.silent(function () {\n\t\t\t\tstore.unselect(oldId);\n\t\t\t\tstore.select(newId);\n\t\t\t});\n\t\t}\n\t});\n\n\treturn {\n\t\tselect: function(id){\n\t\t\tif (id){\n\n\t\t\t\tif(selectedId == id)\n\t\t\t\t\treturn selectedId;\n\n\t\t\t\tif(!this._skip_refresh) {\n\t\t\t\t\tif (!this.callEvent(\"onBeforeSelect\", [id])) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.unselect();\n\n\t\t\t\tselectedId = id;\n\n\t\t\t\tif(!this._skip_refresh) {\n\t\t\t\t\tthis.refresh(id);\n\t\t\t\t\tthis.callEvent(\"onAfterSelect\", [id]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn selectedId;\n\t\t},\n\t\tgetSelectedId: function(){\n\t\t\treturn selectedId;\n\t\t},\n\t\tisSelected: function(id){\n\t\t\treturn id == selectedId;\n\t\t},\n\t\tunselect: function(id){\n\t\t\tvar id = id || selectedId;\n\t\t\tif(!id)\n\t\t\t\treturn;\n\t\t\tselectedId = null;\n\t\t\tif(!this._skip_refresh){\n\t\t\t\tthis.refresh(id);\n\t\t\t\tunselect.call(this, id);\n\t\t\t}\n\t\t}\n\t};\n}\n\nexport default createDataStoreSelectMixin;","import * as utils from \"../../utils/utils\";\n\n\nvar createLinksStoreFacade = function(){\n\treturn {\n\tgetLinkCount: function () {\n\t\treturn this.$data.linksStore.count();\n\t},\n\n\tgetLink : function (id) {\n\t\treturn this.$data.linksStore.getItem(id);\n\t},\n\n\tgetLinks : function () {\n\t\treturn this.$data.linksStore.getItems();\n\t},\n\n\tisLinkExists : function (id) {\n\t\treturn this.$data.linksStore.exists(id);\n\t},\n\n\taddLink : function (link) {\n\t\treturn this.$data.linksStore.addItem(link);\n\t},\n\n\tupdateLink : function (id, data) {\n\t\tif (!utils.defined(data))\n\t\t\tdata = this.getLink(id);\n\t\tthis.$data.linksStore.updateItem(id, data);\n\t},\n\n\tdeleteLink : function (id) {\n\t\treturn this.$data.linksStore.removeItem(id);\n\t},\n\n\tchangeLinkId : function (oldid, newid) {\n\t\treturn this.$data.linksStore.changeId(oldid, newid);\n\t}\n};\n};\n\nexport default createLinksStoreFacade;","import ScaleHelper from \"./ui/timeline/scales_ignore\";\nimport PrimaryScaleHelper from \"./ui/timeline/scales\";\n\nfunction resolveConfigRange(unit, gantt){\n\tvar range = {\n\t\tstart_date:null,\n\t\tend_date:null\n\t};\n\n\tif (gantt.config.start_date && gantt.config.end_date) {\n\t\trange.start_date = gantt.date[unit + \"_start\"](new Date(gantt.config.start_date));\n\n\t\tvar end = new Date(gantt.config.end_date);\n\t\tvar start_interval = gantt.date[unit + \"_start\"](new Date(end));\n\t\tif (+end != +start_interval) {\n\t\t\tend = gantt.date.add(start_interval, 1, unit);\n\t\t} else {\n\t\t\tend = start_interval;\n\t\t}\n\n\t\trange.end_date = end;\n\t}\n\treturn range;\n}\n\nfunction _scale_range_unit(gantt) {\n\tconst primaryScale = (new PrimaryScaleHelper(gantt)).primaryScale();\n\tlet unit = primaryScale.unit;\n\tlet step = primaryScale.step;\n\tif (gantt.config.scale_offset_minimal) {\n\n\t\tconst helper = new ScaleHelper(gantt);\n\t\tconst scales = [helper.primaryScale()].concat(helper.getAdditionalScales());\n\n\t\thelper.sortScales(scales);\n\t\tunit = scales[scales.length - 1].unit;\n\t\tstep = scales[scales.length - 1].step || 1;\n\t}\n\treturn { unit:unit, step:step };\n}\n\nfunction _init_tasks_range(gantt) {\n\tvar cfg = _scale_range_unit(gantt);\n\tvar unit = cfg.unit,\n\t\tstep = cfg.step;\n\tvar range = resolveConfigRange(unit, gantt);\n\n\t// GS-1544: Show correct date range if we have tasks or only projects\n\tif(!(range.start_date && range.end_date)){\n\t\tvar onlyProjectTasks = true;\n\t\tvar tasks = gantt.getTaskByTime();\n\t\tfor (var i = 0; i < tasks.length; i++) {\n\t\t\tvar task = tasks[i];\n\t\t\tif (task.type !== gantt.config.types.project){\n\t\t\t\tonlyProjectTasks = false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (tasks.length && onlyProjectTasks){\n\t\t\tvar start_date = tasks[0].start_date;\n\t\t\tvar end_date = gantt.date.add(start_date, 1, gantt.config.duration_unit);\n\t\t\trange = {\n\t\t\t\tstart_date: new Date(start_date),\n\t\t\t\tend_date: new Date(end_date)\n\t\t\t};\n\t\t} else{\n\t\t\trange = gantt.getSubtaskDates();\n\t\t}\n\n\t\tif(!range.start_date || !range.end_date){\n\t\t\trange = {\n\t\t\t\tstart_date: new Date(),\n\t\t\t\tend_date: new Date()\n\t\t\t};\n\t\t}\n\t\t// extend the displayed date range including the constraints, deadlines and baselines\n\t\tgantt.eachTask(function(task){\n\t\t\tif (gantt.config.deadlines && task.deadline){\n\t\t\t\textendRangeForDates(range, task.deadline, task.deadline);\n\t\t\t}\n\t\t\tif (task.constraint_date && task.constraint_type){\n\t\t\t\tif (gantt._getAutoSchedulingConfig().apply_constraints && gantt.config.constraint_types && task.constraint_type !== gantt.config.constraint_types.ASAP && task.constraint_type !== gantt.config.constraint_types.ALAP){\n\t\t\t\t\textendRangeForDates(range, task.constraint_date, task.constraint_date);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (gantt.config.baselines && task.baselines){\n\t\t\t\ttask.baselines.forEach(function(baseline){\n\t\t\t\t\textendRangeForDates(range, baseline.start_date, baseline.end_date);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\trange.start_date = gantt.date[unit + \"_start\"](range.start_date);\n\t\trange.start_date = gantt.calculateEndDate({\n\t\t\tstart_date: gantt.date[unit + \"_start\"](range.start_date),\n\t\t\tduration: -1,\n\t\t\tunit: unit,\n\t\t\tstep:step\n\t\t});//one free column before first task\n\n\t\trange.end_date = gantt.date[unit + \"_start\"](range.end_date);\n\t\trange.end_date = gantt.calculateEndDate({start_date: range.end_date, duration: 2, unit: unit, step:step});//one free column after last task\n\t}\n\n\tgantt._min_date = range.start_date;\n\tgantt._max_date = range.end_date;\n}\n\nfunction extendRangeForDates(range, start_date, end_date){\n\tif (start_date < range.start_date){\n\t\trange.start_date = new Date(start_date);\n\t}\n\tif (end_date > range.end_date){\n\t\trange.end_date = new Date(end_date);\n\t}\n}\n\nfunction _adjust_scales(gantt) {\n\tif (gantt.config.fit_tasks) {\n\t\tvar old_min = +gantt._min_date,\n\t\t\told_max = +gantt._max_date;\n\t\t//this._init_tasks_range();\n\t\tif (+gantt._min_date != old_min || +gantt._max_date != old_max) {\n\t\t\tgantt.render();\n\n\t\t\tgantt.callEvent(\"onScaleAdjusted\", []);\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nexport default function updateTasksRange(gantt){\n\t_init_tasks_range(gantt);\n\t_adjust_scales(gantt);\n};\n","function copyLinkIdsArray(gantt, linkIds, targetHash){\n\tfor(var i = 0; i < linkIds.length; i++) {\n\t\tif(gantt.isLinkExists(linkIds[i])){\n\t\t\ttargetHash[linkIds[i]] = gantt.getLink(linkIds[i]);\n\t\t}\n\t}\n}\n\nfunction copyLinkIds(gantt, task, targetHash){\n\tcopyLinkIdsArray(gantt, task.$source, targetHash);\n\tcopyLinkIdsArray(gantt, task.$target, targetHash);\n}\n\nfunction getSubtreeLinks(gantt, rootId){\n\tvar res = {};\n\n\tif(gantt.isTaskExists(rootId)){\n\t\tcopyLinkIds(gantt, gantt.getTask(rootId), res);\n\t}\n\n\tgantt.eachTask(function(child){\n\t\tcopyLinkIds(gantt, child, res);\n\t}, rootId);\n\n\treturn res;\n}\n\nfunction getSubtreeTasks(gantt, rootId){\n\tvar res = {};\n\n\tgantt.eachTask(function(child){\n\t\tres[child.id] = child;\n\t}, rootId);\n\n\treturn res;\n}\n\nexport default {\n\tgetSubtreeLinks: getSubtreeLinks,\n\tgetSubtreeTasks: getSubtreeTasks\n};","import * as helpers from \"../../utils/helpers\";\nimport treeHelper from \"../../utils/task_tree_helpers\";\n\n\nexport default class DataProcessorEvents {\n\tprotected _dataProcessorHandlers: any[];\n\tprotected $gantt: any;\n\tprotected $dp: any;\n\n\tconstructor(gantt: any, dp: any) {\n\t\tthis.$gantt = gantt;\n\t\tthis.$dp = dp;\n\t\tthis._dataProcessorHandlers = [];\n\t}\n\n\tattach() {\n\t\tconst dp = this.$dp;\n\t\tconst gantt = this.$gantt;\n\t\tconst cascadeDelete = {};\n\n\t\tconst clientSideDelete = (id) => {\n\t\t\treturn this.clientSideDelete(id, dp, gantt);\n\t\t};\n\n\t\tfunction getTaskLinks(task) {\n\t\t\tlet _links = [];\n\n\t\t\tif (task.$source) {\n\t\t\t\t_links = _links.concat(task.$source);\n\t\t\t}\n\t\t\tif (task.$target) {\n\t\t\t\t_links = _links.concat(task.$target);\n\t\t\t}\n\n\t\t\treturn _links;\n\t\t}\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onAfterTaskAdd\", function(id, item) { // tslint:disable-line\n\t\t\tif (gantt.isTaskExists(id)) {\n\t\t\t\tdp.setGanttMode(\"tasks\");\n\t\t\t\tdp.setUpdated(id, true, \"inserted\");\n\t\t\t}\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onAfterTaskUpdate\", function(id, item) { // tslint:disable-line\n\t\t\tif (gantt.isTaskExists(id)) {\n\t\t\t\tdp.setGanttMode(\"tasks\");\n\t\t\t\tdp.setUpdated(id, true);\n\n\t\t\t\t// gantt can be destroyed/reinitialized after dp.setUpdated\n\t\t\t\tif(gantt._sendTaskOrder){\n\t\t\t\t\tgantt._sendTaskOrder(id, item);\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onBeforeTaskDelete\", function(id, item) { // tslint:disable-line\n\t\t\tif (gantt.config.cascade_delete) {\n\t\t\t\tcascadeDelete[id] = {\n\t\t\t\t\ttasks: treeHelper.getSubtreeTasks(gantt, id),\n\t\t\t\t\tlinks: treeHelper.getSubtreeLinks(gantt, id)\n\t\t\t\t};\n\t\t\t}\n\t\t\t// GS-631. Keep the deleted item in Gantt until we receive the successful response from the server\n\t\t\tif (dp.deleteAfterConfirmation) {\n\t\t\t\tdp.setGanttMode(\"tasks\");\n\t\t\t\tdp.setUpdated(id, true, \"deleted\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onAfterTaskDelete\", function(id, item) { // tslint:disable-line\n\t\t\tdp.setGanttMode(\"tasks\");\n\n\t\t\t// not send delete request if item is not inserted into the db - just remove it from the client\n\t\t\tconst needDbDelete = !clientSideDelete(id);\n\t\t\tconst needCascadeDelete = gantt.config.cascade_delete && cascadeDelete[id];\n\t\t\tif (!needDbDelete && !needCascadeDelete) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (needCascadeDelete) {\n\t\t\t\tconst dpMode = dp.updateMode;\n\t\t\t\tdp.setUpdateMode(\"off\");\n\n\t\t\t\tconst cascade = cascadeDelete[id];\n\t\t\t\tfor (const i in cascade.tasks) {\n\t\t\t\t\tif (!clientSideDelete(i)) {\n\t\t\t\t\t\tdp.storeItem(cascade.tasks[i]);\n\t\t\t\t\t\tdp.setUpdated(i, true, \"deleted\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdp.setGanttMode(\"links\");\n\t\t\t\tfor (const i in cascade.links) {\n\t\t\t\t\tif (!clientSideDelete(i)) {\n\t\t\t\t\t\tdp.storeItem(cascade.links[i]);\n\t\t\t\t\t\tdp.setUpdated(i, true, \"deleted\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcascadeDelete[id] = null;\n\n\t\t\t\tif (dpMode !== \"off\") {\n\t\t\t\t\tdp.sendAllData();\n\t\t\t\t}\n\t\t\t\tdp.setGanttMode(\"tasks\");\n\t\t\t\tdp.setUpdateMode(dpMode);\n\t\t\t}\n\n\t\t\tif (needDbDelete){\n\t\t\t\tdp.storeItem(item);\n\t\t\t\tif (!dp.deleteAfterConfirmation){\n\t\t\t\t\tdp.setUpdated(id, true, \"deleted\");\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\tif (dp.updateMode !== \"off\" && !dp._tSend) {\n\t\t\t\tdp.sendAllData();\n\t\t\t}\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onAfterLinkUpdate\", function(id, item) { // tslint:disable-line\n\t\t\tif (gantt.isLinkExists(id)) {\n\t\t\t\tdp.setGanttMode(\"links\");\n\t\t\t\tdp.setUpdated(id, true);\n\t\t\t}\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onAfterLinkAdd\", function(id, item) { // tslint:disable-line\n\t\t\tif (gantt.isLinkExists(id)) {\n\t\t\t\tdp.setGanttMode(\"links\");\n\t\t\t\tdp.setUpdated(id, true,\"inserted\");\n\t\t\t}\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onAfterLinkDelete\", function(id, item) { // tslint:disable-line\n\t\t\tdp.setGanttMode(\"links\");\n\n\t\t\tconst needDbDelete = !clientSideDelete(id);\n\t\t\tif (!needDbDelete) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdp.storeItem(item);\n\t\t\tdp.setUpdated(id, true,\"deleted\");\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onRowDragEnd\", function(id, target) { // tslint:disable-line\n\t\t\tgantt._sendTaskOrder(id, gantt.getTask(id));\n\t\t}));\n\n\t\tlet tasks = null;\n\t\tlet links = null;\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onTaskIdChange\", function(oldId, newId) { // tslint:disable-line\n\t\t\tif (!dp._waitMode) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst children = gantt.getChildren(newId);\n\t\t\tif (children.length) {\n\t\t\t\ttasks = tasks || {};\n\n\t\t\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\t\t\tconst ch = this.getTask(children[i]);\n\t\t\t\t\ttasks[ch.id] = ch;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst item = this.getTask(newId);\n\t\t\tconst itemLinks = getTaskLinks(item);\n\n\t\t\tif (itemLinks.length) {\n\t\t\t\tlinks = links || {};\n\n\t\t\t\tfor (let i = 0; i < itemLinks.length; i++) {\n\t\t\t\t\tconst link = this.getLink(itemLinks[i]);\n\t\t\t\t\tlinks[link.id] = link;\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\tdp.attachEvent(\"onAfterUpdateFinish\", function() {\n\t\t\tif (tasks || links) {\n\t\t\t\tgantt.batchUpdate(function() {\n\t\t\t\t\tfor (const id in tasks) {\n\t\t\t\t\t\tgantt.updateTask(tasks[id].id);\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (const id in links) {\n\t\t\t\t\t\tgantt.updateLink(links[id].id);\n\t\t\t\t\t}\n\t\t\t\t\ttasks = null;\n\t\t\t\t\tlinks = null;\n\t\t\t\t});\n\t\t\t\tif (tasks) {\n\t\t\t\t\tgantt._dp.setGanttMode(\"tasks\");\n\t\t\t\t} else {\n\t\t\t\t\tgantt._dp.setGanttMode(\"links\");\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tdp.attachEvent(\"onBeforeDataSending\", function() {\n\t\t\tif (this._tMode === \"CUSTOM\") {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tlet url = this._serverProcessor;\n\t\t\tif (this._tMode === \"REST-JSON\" || this._tMode === \"REST\") {\n\t\t\t\tconst mode = this._ganttMode;\n\n\t\t\t\turl = url.substring(0, url.indexOf(\"?\") > -1 ? url.indexOf(\"?\") : url.length);\n\t\t\t\t// editing=true&\n\t\t\t\tthis.serverProcessor = url + (url.slice(-1) === \"/\" ? \"\" : \"/\") + mode;\n\t\t\t} else {\n\t\t\t\tconst pluralizedMode = this._ganttMode + \"s\";\n\t\t\t\tthis.serverProcessor = url + gantt.ajax.urlSeparator(url) + \"gantt_mode=\" + pluralizedMode;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t});\n\n\t\tdp.attachEvent(\"insertCallback\", function insertCallback(upd, id, parent, mode) { // tslint:disable-line\n\t\t\tconst data = upd.data || gantt.xml._xmlNodeToJSON(upd.firstChild);\n\t\t\tconst methods = {\n\t\t\t\tadd: gantt.addTask,\n\t\t\t\tisExist: gantt.isTaskExists\n\t\t\t};\n\t\t\tif (mode === \"links\") {\n\t\t\t\tmethods.add = gantt.addLink;\n\t\t\t\tmethods.isExist = gantt.isLinkExists;\n\t\t\t}\n\t\t\tif (methods.isExist.call(gantt, id)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdata.id = id;\n\t\t\tmethods.add.call(gantt, data);\n\t\t});\n\n\t\tdp.attachEvent(\"updateCallback\", function updateCallback(upd, id) {\n\t\t\tconst data = upd.data || gantt.xml._xmlNodeToJSON(upd.firstChild);\n\t\t\tif (!gantt.isTaskExists(id)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst objData = gantt.getTask(id);\n\t\t\tfor (const key in data) {\n\t\t\t\tlet property = data[key];\n\t\t\t\tswitch (key) {\n\t\t\t\t\tcase \"id\":\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tcase \"start_date\":\n\t\t\t\t\tcase \"end_date\":\n\t\t\t\t\t\tproperty = gantt.defined(gantt.templates.xml_date) ? gantt.templates.xml_date(property) : gantt.templates.parse_date(property);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"duration\":\n\t\t\t\t\t\tobjData.end_date = gantt.calculateEndDate({start_date: objData.start_date, duration: property, task:objData});\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tobjData[key] = property;\n\t\t\t}\n\t\t\tgantt.updateTask(id);\n\t\t\tgantt.refreshData();\n\t\t});\n\t\tdp.attachEvent(\"deleteCallback\", function deleteCallback(upd, id, parent, mode) { // tslint:disable-line\n\t\t\tconst methods = {\n\t\t\t\tdelete: gantt.deleteTask,\n\t\t\t\tisExist: gantt.isTaskExists\n\t\t\t};\n\t\t\tif (mode === \"links\") {\n\t\t\t\tmethods.delete = gantt.deleteLink;\n\t\t\t\tmethods.isExist = gantt.isLinkExists;\n\t\t\t} else if(mode === \"assignment\") {\n\t\t\t\tmethods.delete = function(val) {\n\t\t\t\t\tgantt.$data.assignmentsStore.remove(val);\n\t\t\t\t};\n\t\t\t\tmethods.isExist = function(val){\n\t\t\t\t\treturn gantt.$data.assignmentsStore.exists(val);\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (methods.isExist.call(gantt, id)) {\n\t\t\t\tmethods.delete.call(gantt, id);\n\t\t\t}\n\t\t});\n\n\t\tthis.handleResourceCRUD(dp, gantt);\n\t\tthis.handleResourceAssignmentCRUD(dp, gantt);\n\t\tthis.handleBaselineCRUD(dp, gantt);\n\t}\n\n\tclientSideDelete(id, dp, gantt){\n\t\tconst updated = dp.updatedRows.slice();\n\t\tlet clientOnly = false;\n\n\t\tif(gantt.getUserData(id, \"!nativeeditor_status\", dp._ganttMode) === \"true_deleted\"){\n\t\t\tclientOnly = true;\n\t\t\tdp.setUpdated(id,false);\n\t\t}\n\n\t\tfor (let i = 0; i < updated.length && !dp._in_progress[id]; i++) {\n\t\t\tif (updated[i] === id) {\n\t\t\t\tif (gantt.getUserData(id, \"!nativeeditor_status\", dp._ganttMode) === \"inserted\") {\n\t\t\t\t\tclientOnly = true;\n\t\t\t\t}\n\t\t\t\tdp.setUpdated(id,false);\n\t\t\t}\n\t\t}\n\t\treturn clientOnly;\n\t}\n\n\thandleResourceAssignmentCRUD(dp, gantt){\n\t\tif(!gantt.config.resources || gantt.config.resources.dataprocessor_assignments !== true){\n\t\t\treturn;\n\t\t}\n\n\t\tconst assignmentsStore = gantt.getDatastore(gantt.config.resource_assignment_store);\n\t\tconst insertedTasks = {};\n\t\tconst pendingAssignments = {};\n\n\t\tgantt.attachEvent(\"onBeforeTaskAdd\", function(id, task){\n\t\t\tinsertedTasks[id] = true;\n\t\t\treturn true;\n\t\t});\n\n\t\tfunction putAssignmentToQueue(item){\n\t\t\tpendingAssignments[item.id] = item;\n\t\t\tinsertedTasks[item.task_id] = true;\n\t\t}\n\n\t\tfunction insertResourceAssignment(assignment){\n\t\t\tconst id = assignment.id;\n\t\t\tif (assignmentsStore.exists(id)) {\n\t\t\t\tdp.setGanttMode(\"assignment\");\n\t\t\t\tdp.setUpdated(id, true,\"inserted\");\n\t\t\t}\n\t\t\tdelete pendingAssignments[id];\n\t\t}\n\n\t\tgantt.attachEvent(\"onTaskIdChange\", function(id, newId){\n\t\t\tdelete insertedTasks[id];\n\t\t});\n\n\t\tassignmentsStore.attachEvent(\"onAfterAdd\", (id, item) => {\n\t\t\tif(insertedTasks[item.task_id]){\n\t\t\t\t// inserting assignment of new task\n\t\t\t\t// task is not saved yet, need to wait till it gets permanent id and save assigmnents after that\n\t\t\t\tputAssignmentToQueue(item);\n\t\t\t}else{\n\t\t\t\tinsertResourceAssignment(item);\n\t\t\t}\n\t\t});\n\n\t\tassignmentsStore.attachEvent(\"onAfterUpdate\", (id, item) => {\n\t\t\tif (assignmentsStore.exists(id)) {\n\t\t\t\tif(pendingAssignments[id]){\n\t\t\t\t\tinsertResourceAssignment(item);\n\t\t\t\t}else{\n\t\t\t\t\tdp.setGanttMode(\"assignment\");\n\t\t\t\t\tdp.setUpdated(id, true);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tassignmentsStore.attachEvent(\"onAfterDelete\", (id, item) => {\n\t\t\tdp.setGanttMode(\"assignment\");\n\n\t\t\tconst needDbDelete = !this.clientSideDelete(id, dp, gantt);\n\t\t\tif (!needDbDelete) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdp.storeItem(item);\n\t\t\tdp.setUpdated(id, true,\"deleted\");\n\t\t});\n\n\t}\n\n\thandleResourceCRUD(dp, gantt){\n\t\tif(!gantt.config.resources || gantt.config.resources.dataprocessor_resources !== true){\n\t\t\treturn;\n\t\t}\n\n\t\tconst resourcesStore = gantt.getDatastore(gantt.config.resource_store);\n\n\t\tfunction insertResource(resource){\n\t\t\tconst id = resource.id;\n\t\t\tif (resourcesStore.exists(id)) {\n\t\t\t\tdp.setGanttMode(\"resource\");\n\t\t\t\tdp.setUpdated(id, true,\"inserted\");\n\t\t\t}\n\t\t}\n\n\t\tresourcesStore.attachEvent(\"onAfterAdd\", (id, item) => {\n\t\t\tinsertResource(item);\n\t\t});\n\n\t\tresourcesStore.attachEvent(\"onAfterUpdate\", (id, item) => {\n\t\t\tif (resourcesStore.exists(id)) {\n\t\t\t\tdp.setGanttMode(\"resource\");\n\t\t\t\tdp.setUpdated(id, true);\n\t\t\t}\n\t\t});\n\n\t\tresourcesStore.attachEvent(\"onAfterDelete\", (id, item) => {\n\t\t\tdp.setGanttMode(\"resource\");\n\n\t\t\tconst needDbDelete = !this.clientSideDelete(id, dp, gantt);\n\t\t\tif (!needDbDelete) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdp.storeItem(item);\n\t\t\tdp.setUpdated(id, true,\"deleted\");\n\t\t});\n\n\t}\n\n\thandleBaselineCRUD(dp, gantt){\n\t\tif(!gantt.config.baselines || gantt.config.baselines.dataprocessor_baselines !== true){\n\t\t\treturn;\n\t\t}\n\n\t\tconst baselineStore = gantt.getDatastore(gantt.config.baselines.datastore);\n\n\t\tfunction insertResource(resource){\n\t\t\tconst id = resource.id;\n\t\t\tif (baselineStore.exists(id)) {\n\t\t\t\tdp.setGanttMode(\"baseline\");\n\t\t\t\tdp.setUpdated(id, true,\"inserted\");\n\t\t\t}\n\t\t}\n\n\t\tbaselineStore.attachEvent(\"onAfterAdd\", (id, item) => {\n\t\t\tinsertResource(item);\n\t\t});\n\n\t\tbaselineStore.attachEvent(\"onAfterUpdate\", (id, item) => {\n\t\t\tif (baselineStore.exists(id)) {\n\t\t\t\tdp.setGanttMode(\"baseline\");\n\t\t\t\tdp.setUpdated(id, true);\n\t\t\t}\n\t\t});\n\n\t\tbaselineStore.attachEvent(\"onAfterDelete\", (id, item) => {\n\t\t\tdp.setGanttMode(\"baseline\");\n\n\t\t\tconst needDbDelete = !this.clientSideDelete(id, dp, gantt);\n\t\t\tif (!needDbDelete) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdp.storeItem(item);\n\t\t\tdp.setUpdated(id, true,\"deleted\");\n\t\t});\n\t}\n\n\tdetach() {\n\t\thelpers.forEach(this._dataProcessorHandlers, (e) => {\n\t\t\tthis.$gantt.detachEvent(e);\n\t\t});\n\t\tthis._dataProcessorHandlers = [];\n\t}\n}\n","import * as utils from \"../../utils/utils\";\n\nexport default class SimpleStorage {\n\tpublic static create = () : SimpleStorage => {\n\t\treturn new SimpleStorage();\n\t};\n\n\tprotected _storage: { [id: string]: any; };\n\n\tprotected constructor() {\n\t\tthis._storage = {};\n\t}\n\n\tpublic clear = (): void => {\n\t\tthis._storage = {};\n\t};\n\n\tpublic storeItem = (item: any): void => {\n\t\tthis._storage[item.id] = utils.copy(item);\n\t};\n\n\tpublic getStoredItem = (id: string): any => {\n\t\treturn this._storage[id] || null;\n\t};\n}","import eventable from \"../../utils/eventable\";\nimport * as helpers from \"../../utils/helpers\";\nimport * as utils from \"../../utils/utils\";\nimport DataProcessorEvents from \"./data_processor_events\";\nimport extendGantt from \"./extend_gantt\";\nimport SimpleStorage from \"./simple_storage\";\nimport global from \"../../utils/global\";\n\nexport interface DataProcessor { // tslint:disable-line\n\t$gantt: any;\n\tdetachAllEvents: any;\n\tattachEvent: any;\n\tcallEvent: any;\n\n\tserverProcessor: string;\n\taction_param: string;\n\tupdatedRows: any[];\n\tautoUpdate: boolean;\n\tupdateMode: string;\n\tmessages: any[];\n\tstyles: object;\n\tdnd: any;\n\tdeleteAfterConfirmation?: any;\n}\n\nexport function createDataProcessor(config: any) {\n\tlet router;\n\tlet tMode;\n\tlet headers;\n\tif (config instanceof Function) {\n\t\trouter = config;\n\t} else if (config.hasOwnProperty(\"router\")) {\n\t\trouter = config.router;\n\t} else if (config.hasOwnProperty(\"assignment\") || config.hasOwnProperty(\"baseline\") || config.hasOwnProperty(\"link\") || config.hasOwnProperty(\"task\")) {\n\t\trouter = config;\n\t} else if(config.hasOwnProperty(\"headers\")){\n\t\t// GS-2312 for custom headers\n\t\theaders = config.headers;\n\t}\n\tif (router) {\n\t\ttMode = \"CUSTOM\";\n\t} else {\n\t\ttMode = config.mode || \"REST-JSON\";\n\t}\n\tconst gantt = this; // tslint:disable-line\n\tconst dp = new DataProcessor(config.url);\n\n\n\tdp.init(gantt);\n\tdp.setTransactionMode({\n\t\tmode: tMode,\n\t\trouter,\n\t\theaders\n\t}, config.batchUpdate);\n\tif(config.deleteAfterConfirmation){\n\t\tdp.deleteAfterConfirmation = config.deleteAfterConfirmation;\n\t}\n\treturn dp;\n}\n\nexport class DataProcessor {\n\tpublic modes: object;\n\tpublic serverProcessor: string;\n\tpublic action_param: string; // tslint:disable-line\n\tpublic updatedRows: any[];\n\tpublic autoUpdate: boolean;\n\tpublic updateMode: string;\n\tpublic messages: any[];\n\tpublic styles: object;\n\tpublic dnd: any;\n\n\tprotected _tMode: string;\n\tprotected _headers: any;\n\tprotected _payload: any;\n\tprotected _postDelim: string;\n\tprotected _waitMode: number;\n\tprotected _in_progress: object; // tslint:disable-line\n\tprotected _invalid: object;\n\tprotected _storage: SimpleStorage;\n\tprotected _tSend: boolean;\n\tprotected _serializeAsJson: boolean;\n\tprotected _router: any;\n\tprotected _utf: boolean;\n\tprotected _methods: any[];\n\tprotected _user: any;\n\tprotected _uActions: object;\n\tprotected _needUpdate: boolean;\n\tprotected _ganttMode: \"task\"|\"link\";\n\tprotected _routerParametersFormat: \"parameters\"|\"object\";\n\n\tprotected _silent_mode: any; // tslint:disable-line\n\tprotected _updateBusy: any;\n\tprotected _serverProcessor: any;\n\tprotected _initialized: boolean;\n\n\tconstructor(serverProcessorURL?) {\n\t\tthis.serverProcessor = serverProcessorURL;\n\t\tthis.action_param = \"!nativeeditor_status\";\n\n\t\tthis.updatedRows = []; // ids of updated rows\n\n\t\tthis.autoUpdate = true;\n\t\tthis.updateMode = \"cell\";\n\t\tthis._headers = null;\n\t\tthis._payload = null;\n\t\tthis._postDelim = \"_\";\n\t\tthis._routerParametersFormat = \"parameters\";\n\n\t\tthis._waitMode = 0;\n\t\tthis._in_progress = {}; // ?\n\t\tthis._storage = SimpleStorage.create();\n\t\tthis._invalid = {};\n\t\tthis.messages = [];\n\n\t\tthis.styles = {\n\t\t\tupdated: \"font-weight:bold;\",\n\t\t\tinserted: \"font-weight:bold;\",\n\t\t\tdeleted: \"text-decoration : line-through;\",\n\t\t\tinvalid: \"background-color:FFE0E0;\",\n\t\t\tinvalid_cell: \"border-bottom:2px solid red;\",\n\t\t\terror: \"color:red;\",\n\t\t\tclear: \"font-weight:normal;text-decoration:none;\"\n\t\t};\n\t\tthis.enableUTFencoding(true);\n\t\teventable(this);\n\t}\n\n\tsetTransactionMode(mode:any, total?:any) {\n\t\tif (typeof mode === \"object\") {\n\t\t\tthis._tMode = mode.mode || this._tMode;\n\n\t\t\tif (utils.defined(mode.headers)) {\n\t\t\t\tthis._headers = mode.headers;\n\t\t\t}\n\n\t\t\tif (utils.defined(mode.payload)) {\n\t\t\t\tthis._payload = mode.payload;\n\t\t\t}\n\t\t\tthis._tSend = !!total;\n\t\t} else {\n\t\t\tthis._tMode = mode;\n\t\t\tthis._tSend = total;\n\t\t}\n\n\t\tif (this._tMode === \"REST\") {\n\t\t\tthis._tSend = false;\n\t\t}\n\n\t\tif (this._tMode === \"JSON\" || this._tMode === \"REST-JSON\") {\n\t\t\tthis._tSend = false;\n\t\t\tthis._serializeAsJson = true;\n\t\t\tthis._headers = this._headers || {};\n\t\t\tthis._headers[\"Content-Type\"] = \"application/json\";\n\t\t}else{\n\t\t\tif(this._headers && !this._headers[\"Content-Type\"]){\n\t\t\t\tthis._headers[\"Content-Type\"] = \"application/x-www-form-urlencoded\";\n\t\t\t}\n\t\t}\n\n\t\tif (this._tMode === \"CUSTOM\") {\n\t\t\tthis._tSend = false;\n\t\t\tthis._router = mode.router;\n\t\t}\n\t}\n\n\tescape(data:any) {\n\t\tif (this._utf) {\n\t\t\treturn encodeURIComponent(data);\n\t\t} else {\n\t\t\treturn escape(data);\n\t\t}\n\t}\n\n\t/**\n\t * @desc: allows to set escaping mode\n\t * @param: true - utf based escaping, simple - use current page encoding\n\t * @type: public\n\t */\n\tenableUTFencoding(mode:boolean) {\n\t\tthis._utf = !!mode;\n\t}\n\n\t/**\n\t * @desc: get state of updating\n\t * @returns:   true - all in sync with server, false - some items not updated yet.\n\t * @type: public\n\t */\n\tgetSyncState() {\n\t\treturn !this.updatedRows.length;\n\t}\n\n\t/**\n\t * @desc: set if rows should be send to server automatically\n\t * @param: mode - \"row\" - based on row selection changed, \"cell\" - based on cell editing finished, \"off\" - manual data sending\n\t * @type: public\n\t */\n\tsetUpdateMode(mode: string, dnd: any) {\n\t\tthis.autoUpdate = (mode === \"cell\");\n\t\tthis.updateMode = mode;\n\t\tthis.dnd = dnd;\n\t}\n\n\tignore(code: any, master: any) {\n\t\tthis._silent_mode = true;\n\t\tcode.call(master || global);\n\t\tthis._silent_mode = false;\n\t}\n\n\t/**\n\t * @desc: mark row as updated/normal. check mandatory fields, initiate autoupdate (if turned on)\n\t * @param: rowId - id of row to set update-status for\n\t * @param: state - true for \"updated\", false for \"not updated\"\n\t * @param: mode - update mode name\n\t * @type: public\n\t */\n\tsetUpdated(rowId:number|string, state: boolean, mode?: string) {\n\t\tif (this._silent_mode) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst ind = this.findRow(rowId);\n\n\t\tmode = mode || \"updated\";\n\t\tconst existing = this.$gantt.getUserData(rowId, this.action_param, this._ganttMode);\n\t\tif (existing && mode === \"updated\") {\n\t\t\tmode = existing;\n\t\t}\n\t\tif (state) {\n\t\t\tthis.set_invalid(rowId, false); // clear previous error flag\n\t\t\tthis.updatedRows[ind] = rowId;\n\t\t\tthis.$gantt.setUserData(rowId, this.action_param, mode, this._ganttMode);\n\t\t\tif (this._in_progress[rowId]) {\n\t\t\t\tthis._in_progress[rowId] = \"wait\";\n\t\t\t}\n\t\t} else {\n\t\t\tif (!this.is_invalid(rowId)) {\n\t\t\t\tthis.updatedRows.splice(ind, 1);\n\t\t\t\tthis.$gantt.setUserData(rowId, this.action_param, \"\", this._ganttMode);\n\t\t\t}\n\t\t}\n\n\t\tthis.markRow(rowId, state, mode);\n\t\tif (state && this.autoUpdate) {\n\t\t\tthis.sendData(rowId);\n\t\t}\n\t}\n\n\tmarkRow(id: number | string, state: boolean, mode: string) {\n\t\tlet str = \"\";\n\t\tconst invalid = this.is_invalid(id);\n\t\tif (invalid) {\n\t\t\tstr = this.styles[invalid];\n\t\t\tstate = true;\n\t\t}\n\t\tif (this.callEvent(\"onRowMark\", [id, state, mode, invalid])) {\n\t\t\t// default logic\n\t\t\tstr = this.styles[state ? mode : \"clear\"] + \" \" + str;\n\n\t\t\tthis.$gantt[this._methods[0]](id, str);\n\n\t\t\tif (invalid && invalid.details) {\n\t\t\t\tstr += this.styles[invalid + \"_cell\"];\n\t\t\t\tfor (let i = 0; i < invalid.details.length; i++) {\n\t\t\t\t\tif (invalid.details[i]) {\n\t\t\t\t\t\tthis.$gantt[this._methods[1]](id, i, str);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetActionByState(state: string):string {\n\t\tif (state === \"inserted\") {\n\t\t\treturn \"create\";\n\t\t}\n\n\t\tif (state === \"updated\") {\n\t\t\treturn \"update\";\n\t\t}\n\n\t\tif (state === \"deleted\") {\n\t\t\treturn \"delete\";\n\t\t}\n\n\t\t// reorder\n\t\treturn \"update\";\n\t}\n\n\tgetState(id: number | string) {\n\t\treturn this.$gantt.getUserData(id, this.action_param, this._ganttMode);\n\t}\n\n\tis_invalid(id: number | string) {\n\t\treturn this._invalid[id];\n\t}\n\n\tset_invalid(id: number | string, mode: any, details?) {\n\t\tif (details) {\n\t\t\tmode = {\n\t\t\t\tvalue: mode,\n\t\t\t\tdetails,\n\t\t\t\ttoString: function() { // tslint:disable-line\n\t\t\t\t\treturn this.value.toString();\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\tthis._invalid[id] = mode;\n\t}\n\n\t/**\n\t * @desc: check mandatory fields and verify values of cells, initiate update (if specified). Can be redefined in order to provide custom validation\n\t * @param: rowId - id of row to set update-status for\n\t * @type: public\n\t */\n\t// tslint:disable-next-line\n\tcheckBeforeUpdate(rowId: number | string) {\n\t\treturn true;\n\t}\n\n\t/**\n\t * @desc: send row(s) values to server\n\t * @param: rowId - id of row which data to send. If not specified, then all \"updated\" rows will be send\n\t * @type: public\n\t */\n\tsendData(rowId?: any) {\n\t\tif (this.$gantt.editStop) {\n\t\t\tthis.$gantt.editStop();\n\t\t}\n\n\t\tif (typeof rowId === \"undefined\" || this._tSend) {\n\n\t\t\tconst pendingUpdateModes = [];\n\t\t\tif(this.modes){\n\t\t\t\tconst knownModes = [\"task\", \"link\", \"assignment\", \"baseline\"];\n\t\t\t\tknownModes.forEach((mode) => {\n\t\t\t\t\tif(this.modes[mode] && this.modes[mode].updatedRows.length){\n\t\t\t\t\t\tpendingUpdateModes.push(mode);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (pendingUpdateModes.length){\n\t\t\t\tfor(let i = 0; i < pendingUpdateModes.length; i++){\n\t\t\t\t\tthis.setGanttMode(pendingUpdateModes[i]);\n\t\t\t\t\tthis.sendAllData();\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\treturn this.sendAllData();\n\t\t\t}\n\t\t}\n\t\tif (this._in_progress[rowId]) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.messages = [];\n\t\tif (!this.checkBeforeUpdate(rowId) && this.callEvent(\"onValidationError\", [rowId, this.messages])) {\n\t\t\treturn false;\n\t\t}\n\t\tthis._beforeSendData(this._getRowData(rowId), rowId);\n\t}\n\n\tserialize(data: any, id: any) {\n\t\tif (this._serializeAsJson) {\n\t\t\treturn  this._serializeAsJSON(data);\n\t\t}\n\n\t\tif (typeof data === \"string\") {\n\t\t\treturn data;\n\t\t}\n\t\tif (typeof id !== \"undefined\") {\n\t\t\treturn this.serialize_one(data, \"\");\n\t\t} else {\n\t\t\tconst stack = [];\n\t\t\tconst keys = [];\n\t\t\tfor (const key in data) {\n\t\t\t\tif (data.hasOwnProperty(key)) {\n\t\t\t\t\tstack.push(this.serialize_one(data[key], key + this._postDelim));\n\t\t\t\t\tkeys.push(key);\n\t\t\t\t}\n\t\t\t}\n\t\t\tstack.push(\"ids=\" + this.escape(keys.join(\",\")));\n\t\t\tif (this.$gantt.security_key) {\n\t\t\t\tstack.push(\"dhx_security=\" + this.$gantt.security_key);\n\t\t\t}\n\t\t\treturn stack.join(\"&\");\n\t\t}\n\t}\n\n\tserialize_one(data: any, pref: string) {\n\t\tif (typeof data === \"string\") {\n\t\t\treturn data;\n\t\t}\n\t\tconst stack: string[] = [];\n\t\tlet serialized = \"\";\n\t\tfor (const key in data)\n\t\t\tif (data.hasOwnProperty(key)) {\n\t\t\t\tif ((key === \"id\" ||\n\t\t\t\t\tkey == this.action_param) && // tslint:disable-line\n\t\t\t\t\tthis._tMode === \"REST\") {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (typeof data[key] === \"string\" || typeof data[key] === \"number\") {\n\t\t\t\t\tserialized = String(data[key]);\n\t\t\t\t} else {\n\t\t\t\t\tserialized = JSON.stringify(data[key]);\n\t\t\t\t}\n\t\t\t\tstack.push(this.escape((pref || \"\") + key) + \"=\" + this.escape(serialized));\n\t\t\t}\n\t\treturn stack.join(\"&\");\n\t}\n\n\tsendAllData() {\n\t\tif (!this.updatedRows.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.messages = [];\n\t\tlet valid: any = true;\n\n\t\tthis._forEachUpdatedRow(function(rowId) {\n\t\t\tvalid = valid && this.checkBeforeUpdate(rowId);\n\t\t});\n\n\t\tif (!valid && !this.callEvent(\"onValidationError\", [\"\", this.messages])) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this._tSend) {\n\t\t\tthis._sendData(this._getAllData());\n\t\t} else {\n\t\t\t// this.updatedRows can be spliced from onBeforeUpdate via dp.setUpdated false\n\t\t\t// use an iterator instead of for(var i = 0; i < this.updatedRows; i++) then\n\t\t\tthis._forEachUpdatedRow(function(rowId) {\n\t\t\t\tif (!this._in_progress[rowId]) {\n\t\t\t\t\tif (this.is_invalid(rowId)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis._beforeSendData(this._getRowData(rowId), rowId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tfindRow(pattern: any) {\n\t\tlet i = 0;\n\t\tfor (i = 0; i < this.updatedRows.length; i++) {\n\t\t\tif (pattern == this.updatedRows[i]) { // tslint:disable-line\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn i;\n\t}\n\n\t/**\n\t * @desc: define custom actions\n\t * @param: name - name of action, same as value of action attribute\n\t * @param: handler - custom function, which receives a XMl response content for action\n\t * @type: private\n\t */\n\tdefineAction(name: string, handler: any) {\n\t\tif (!this._uActions) {\n\t\t\tthis._uActions = {};\n\t\t}\n\t\tthis._uActions[name] = handler;\n\t}\n\n\t/**\n\t * @desc: used in combination with setOnBeforeUpdateHandler to create custom client-server transport system\n\t * @param: sid - id of item before update\n\t * @param: tid - id of item after up0ate\n\t * @param: action - action name\n\t * @type: public\n\t * @topic: 0\n\t */\n\tafterUpdateCallback(sid: number | string, tid: number | string, action: string, btag: any, ganttMode: string) {\n\t\tif(!this.$gantt){\n\t\t\t// destructor has been called before the callback\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setGanttMode(ganttMode);\n\n\t\tconst marker = sid;\n\t\tconst correct = (action !== \"error\" && action !== \"invalid\");\n\t\tif (!correct) {\n\t\t\tthis.set_invalid(sid, action);\n\t\t}\n\t\tif ((this._uActions) && (this._uActions[action]) && (!this._uActions[action](btag))) {\n\t\t\treturn (delete this._in_progress[marker]);\n\t\t}\n\n\t\tif (this._in_progress[marker] !== \"wait\") {\n\t\t\tthis.setUpdated(sid, false);\n\t\t}\n\n\t\tconst originalSid = sid;\n\n\t\tswitch (action) {\n\t\t\tcase \"inserted\":\n\t\t\tcase \"insert\":\n\t\t\t\tif (tid != sid) { // tslint:disable-line\n\t\t\t\t\tthis.setUpdated(sid, false);\n\t\t\t\t\tthis.$gantt[this._methods[2]](sid, tid);\n\t\t\t\t\tsid = tid;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"delete\":\n\t\t\tcase \"deleted\":\n\t\t\t\tif(!this.deleteAfterConfirmation || this._ganttMode !== \"task\"){\n\t\t\t\t\tthis.$gantt.setUserData(sid, this.action_param, \"true_deleted\", this._ganttMode);\n\t\t\t\t\tthis.$gantt[this._methods[3]](sid);\n\t\t\t\t\tdelete this._in_progress[marker];\n\t\t\t\t\treturn this.callEvent(\"onAfterUpdate\", [sid, action, tid, btag]);\n\t\t\t\t}else{\n\t\t\t\t\tif (this._ganttMode === \"task\" && this.$gantt.isTaskExists(sid)) {\n\t\t\t\t\t\tthis.$gantt.setUserData(sid, this.action_param, \"true_deleted\", this._ganttMode);\n\t\t\t\t\t\tconst task = this.$gantt.getTask(sid);\n\t\t\t\t\t\tthis.$gantt.silent(() => {\n\t\t\t\t\t\t\tthis.$gantt.deleteTask(sid);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.$gantt.callEvent(\"onAfterTaskDelete\", [sid, task]);\n\t\t\t\t\t\tthis.$gantt.render();\n\t\t\t\t\t\tdelete this._in_progress[marker];\n\t\t\t\t\t}\n\t\t\t\t\treturn this.callEvent(\"onAfterUpdate\", [sid, action, tid, btag]);\n\t\t\t\t}\n\n\t\t}\n\n\t\tif (this._in_progress[marker] !== \"wait\") {\n\t\t\tif (correct) {\n\t\t\t\tthis.$gantt.setUserData(sid, this.action_param, \"\", this._ganttMode);\n\t\t\t}\n\t\t\tdelete this._in_progress[marker];\n\t\t} else {\n\t\t\tdelete this._in_progress[marker];\n\t\t\tthis.setUpdated(tid, true, this.$gantt.getUserData(sid, this.action_param, this._ganttMode));\n\t\t}\n\n\t\tthis.callEvent(\"onAfterUpdate\", [originalSid, action, tid, btag]);\n\t}\n\n\t/**\n\t * @desc: response from server\n\t * @param: xml - XMLLoader object with response XML\n\t * @type: private\n\t */\n\tafterUpdate(that: any, xml: any, id?:any) {\n\t\tlet _xml;\n\t\tif (arguments.length === 3) {\n\t\t\t_xml = arguments[1];\n\t\t} else {\n\t\t\t// old dataprocessor\n\t\t\t_xml = arguments[4];\n\t\t}\n\t\tlet mode = this.getGanttMode();\n\t\tconst reqUrl = _xml.filePath || _xml.url;\n\n\t\tif (this._tMode !== \"REST\" && this._tMode !== \"REST-JSON\") {\n\t\t\tif (reqUrl.indexOf(\"gantt_mode=links\") !== -1) {\n\t\t\t\tmode = \"link\";\n\t\t\t} else if (reqUrl.indexOf(\"gantt_mode=assignments\") !== -1) {\n\t\t\t\tmode = \"assignment\";\n\t\t\t} else if (reqUrl.indexOf(\"gantt_mode=baselines\") !== -1) {\n\t\t\t\tmode = \"baseline\";\n\t\t\t} else {\n\t\t\t\tmode = \"task\";\n\t\t\t}\n\t\t} else {\n\t\t\tif (reqUrl.indexOf(\"/link\") >= 0) {\n\t\t\t\tmode = \"link\";\n\t\t\t} else if(reqUrl.indexOf(\"/assignment\") >= 0){\n\t\t\t\tmode = \"assignment\";\n\t\t\t} else if(reqUrl.indexOf(\"/baseline\") >= 0){\n\t\t\t\tmode = \"baseline\";\n\t\t\t} else {\n\t\t\t\tmode = \"task\";\n\t\t\t}\n\t\t}\n\t\tthis.setGanttMode(mode);\n\n\t\tconst ajax = this.$gantt.ajax;\n\t\t// try to use json first\n\t\tlet tag;\n\n\t\ttry {\n\t\t\ttag = JSON.parse(xml.xmlDoc.responseText);\n\t\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\t\t} catch (e) {\n\n\t\t\t// empty response also can be processed by json handler\n\t\t\tif (!xml.xmlDoc.responseText.length) {\n\t\t\t\ttag = {};\n\t\t\t}\n\t\t}\n\n\t\tconst processCallback = (itemId: any) => {\n\t\t\tconst action = tag.action || this.getState(itemId) || \"updated\";\n\t\t\tconst sid = tag.sid || itemId[0];\n\t\t\tconst tid = tag.tid || itemId[0];\n\t\t\tthat.afterUpdateCallback(sid, tid, action, tag, mode);\n\t\t};\n\t\tif (tag) {\n\t\t\t// GS-753. When multiple tasks are updated, unhighlight all of them\n\t\t\tif (Array.isArray(id) && id.length > 1) {\n\t\t\t\tid.forEach((taskId) => processCallback(taskId));\n\t\t\t} else {\n\t\t\t\tprocessCallback(id);\n\t\t\t}\n\t\t\tthat.finalizeUpdate();\n\t\t\tthis.setGanttMode(mode);\n\t\t\treturn;\n\t\t}\n\n\t\t// xml response\n\t\tconst top = ajax.xmltop(\"data\", xml.xmlDoc); // fix incorrect content type in IE\n\t\tif (!top) {\n\t\t\treturn this.cleanUpdate(id);\n\t\t}\n\t\tconst atag = ajax.xpath(\"//data/action\", top);\n\t\tif (!atag.length) {\n\t\t\treturn this.cleanUpdate(id);\n\t\t}\n\n\t\tfor (let i = 0; i < atag.length; i++) {\n\t\t\tconst btag = atag[i];\n\t\t\tconst action = btag.getAttribute(\"type\");\n\t\t\tconst sid = btag.getAttribute(\"sid\");\n\t\t\tconst tid = btag.getAttribute(\"tid\");\n\n\t\t\tthat.afterUpdateCallback(sid, tid, action, btag, mode);\n\t\t}\n\t\tthat.finalizeUpdate();\n\t}\n\n\tcleanUpdate(id: any[]) {\n\t\tif (id) {\n\t\t\tfor (let i = 0; i < id.length; i++) {\n\t\t\t\tdelete this._in_progress[id[i]];\n\t\t\t}\n\t\t}\n\t}\n\n\tfinalizeUpdate() {\n\t\tif (this._waitMode) {\n\t\t\tthis._waitMode--;\n\t\t}\n\n\t\tthis.callEvent(\"onAfterUpdateFinish\", []);\n\t\tif (!this.updatedRows.length) {\n\t\t\tthis.callEvent(\"onFullSync\", []);\n\t\t}\n\t}\n\n\t/**\n\t * @desc: initializes data-processor\n\t * @param: gantt - dhtmlxGantt object to attach this data-processor to\n\t * @type: public\n\t */\n\tinit(gantt: any) {\n\t\tif (this._initialized) {\n\t\t\treturn;\n\t\t}\n\t\tthis.$gantt = gantt;\n\t\tif (this.$gantt._dp_init) {\n\t\t\tthis.$gantt._dp_init(this);\n\t\t}\n\n\t\tthis._setDefaultTransactionMode();\n\n\t\tthis.styles = {\n\t\t\tupdated:\"gantt_updated\",\n\t\t\torder:\"gantt_updated\",\n\t\t\tinserted:\"gantt_inserted\",\n\t\t\tdeleted:\"gantt_deleted\",\n\t\t\tdelete_confirmation:\"gantt_deleted\",\n\t\t\tinvalid:\"gantt_invalid\",\n\t\t\terror:\"gantt_error\",\n\t\t\tclear:\"\"\n\t\t};\n\n\t\tthis._methods=[\"_row_style\",\"setCellTextStyle\",\"_change_id\",\"_delete_task\"];\n\t\textendGantt(this.$gantt, this);\n\t\tconst dataProcessorEvents = new DataProcessorEvents(this.$gantt, this);\n\t\tdataProcessorEvents.attach();\n\t\tthis.attachEvent(\"onDestroy\", function() {\n\t\t\tdelete this.setGanttMode;\n\t\t\tdelete this._getRowData;\n\n\t\t\tdelete this.$gantt._dp;\n\t\t\tdelete this.$gantt._change_id;\n\t\t\tdelete this.$gantt._row_style;\n\t\t\tdelete this.$gantt._delete_task;\n\t\t\tdelete this.$gantt._sendTaskOrder;\n\t\t\tdelete this.$gantt;\n\n\t\t\tdataProcessorEvents.detach();\n\t\t});\n\t\tthis.$gantt.callEvent(\"onDataProcessorReady\", [this]);\n\t\tthis._initialized = true;\n\t}\n\n\tsetOnAfterUpdate(handler) {\n\t\tthis.attachEvent(\"onAfterUpdate\", handler);\n\t}\n\n\tsetOnBeforeUpdateHandler(handler) {\n\t\tthis.attachEvent(\"onBeforeDataSending\", handler);\n\t}\n\n\t/* starts autoupdate mode\n\t\t@param interval time interval for sending update requests\n\t*/\n\tsetAutoUpdate(interval, user) {\n\t\tinterval = interval || 2000;\n\n\t\tthis._user = user || (new Date()).valueOf();\n\t\tthis._needUpdate = false;\n\n\t\tthis._updateBusy = false;\n\n\t\tthis.attachEvent(\"onAfterUpdate\", this.afterAutoUpdate); // arguments sid, action, tid, xml_node;\n\n\t\tthis.attachEvent(\"onFullSync\", this.fullSync);\n\n\t\tsetInterval(() => {\n\t\t\tthis.loadUpdate();\n\t\t}, interval);\n\t}\n\n\t/* process updating request response\n\t\tif status == collision version is deprecated\n\t\tset flag for autoupdating immediately\n\t*/\n\tafterAutoUpdate(sid, action, tid, xml_node) { // tslint:disable-line\n\t\tif (action === \"collision\") {\n\t\t\tthis._needUpdate = true;\n\t\t\treturn false;\n\t\t} else {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\t/* callback function for onFillSync event\n\t\tcall update function if it's need\n\t*/\n\tfullSync() {\n\t\tif (this._needUpdate) {\n\t\t\tthis._needUpdate = false;\n\t\t\tthis.loadUpdate();\n\t\t}\n\t\treturn true;\n\t}\n\n\t/* sends query to the server and call callback function\n\t*/\n\tgetUpdates(url, callback) {\n\t\tconst ajax = this.$gantt.ajax;\n\t\tif (this._updateBusy) {\n\t\t\treturn false;\n\t\t} else {\n\t\t\tthis._updateBusy = true;\n\t\t}\n\n\t\tajax.get(url, callback);\n\n\t}\n\n\t/* loads updates and processes them\n\t*/\n\tloadUpdate() {\n\t\tconst ajax = this.$gantt.ajax;\n\t\tconst version = this.$gantt.getUserData(0, \"version\", this._ganttMode);\n\t\tlet url = this.serverProcessor + ajax.urlSeparator(this.serverProcessor) + [\"dhx_user=\" + this._user, \"dhx_version=\" + version].join(\"&\");\n\t\turl = url.replace(\"editing=true&\", \"\");\n\t\tthis.getUpdates(url, (xml) => {\n\t\t\tconst vers = ajax.xpath(\"//userdata\", xml);\n\t\t\tthis.$gantt.setUserData(0, \"version\", this._getXmlNodeValue(vers[0]), this._ganttMode);\n\n\t\t\tconst updates = ajax.xpath(\"//update\", xml);\n\t\t\tif (updates.length) {\n\t\t\t\tthis._silent_mode = true;\n\n\t\t\t\tfor (let i = 0; i < updates.length; i++) {\n\t\t\t\t\tconst status = updates[i].getAttribute(\"status\");\n\t\t\t\t\tconst id = updates[i].getAttribute(\"id\");\n\t\t\t\t\tconst parent = updates[i].getAttribute(\"parent\");\n\t\t\t\t\tswitch (status) {\n\t\t\t\t\t\tcase \"inserted\":\n\t\t\t\t\t\t\tthis.callEvent(\"insertCallback\", [updates[i], id, parent]);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"updated\":\n\t\t\t\t\t\t\tthis.callEvent(\"updateCallback\", [updates[i], id, parent]);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"deleted\":\n\t\t\t\t\t\t\tthis.callEvent(\"deleteCallback\", [updates[i], id, parent]);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis._silent_mode = false;\n\t\t\t}\n\n\t\t\tthis._updateBusy = false;\n\t\t});\n\t}\n\n\tdestructor() {\n\t\tthis.callEvent(\"onDestroy\", []);\n\t\tthis.detachAllEvents();\n\n\t\tthis.updatedRows = [];\n\t\tthis._in_progress = {}; // ?\n\t\tthis._invalid = {};\n\t\tthis._storage.clear();\n\t\tthis._storage = null;\n\t\tthis._headers = null;\n\t\tthis._payload = null;\n\t\tdelete this._initialized;\n\t}\n\n\tsetGanttMode(mode) {\n\t\tif (mode === \"tasks\") {\n\t\t\tmode = \"task\";\n\t\t} else if (mode === \"links\") {\n\t\t\tmode = \"link\";\n\t\t}\n\n\t\tconst modes = this.modes || {};\n\t\tconst ganttMode = this.getGanttMode();\n\t\tif (ganttMode) {\n\t\t\tmodes[ganttMode] = {\n\t\t\t\t_in_progress : this._in_progress,\n\t\t\t\t_invalid: this._invalid,\n\t\t\t\t_storage: this._storage,\n\t\t\t\tupdatedRows : this.updatedRows\n\t\t\t};\n\t\t}\n\n\t\tlet newState = modes[mode];\n\t\tif (!newState) {\n\t\t\tnewState = modes[mode] = {\n\t\t\t\t_in_progress : {},\n\t\t\t\t_invalid : {},\n\t\t\t\t_storage : SimpleStorage.create(),\n\t\t\t\tupdatedRows : []\n\t\t\t};\n\t\t}\n\t\tthis._in_progress = newState._in_progress;\n\t\tthis._invalid = newState._invalid;\n\t\tthis._storage = newState._storage;\n\t\tthis.updatedRows = newState.updatedRows;\n\t\tthis.modes = modes;\n\t\tthis._ganttMode = mode;\n\t}\n\tgetGanttMode():string {\n\t\treturn this._ganttMode;\n\t}\n\n\tstoreItem(item) {\n\t\tthis._storage.storeItem(item);\n\t}\n\n\turl(url: string) {\n\t\tthis.serverProcessor = this._serverProcessor = url;\n\t}\n\n\tprotected _beforeSendData(data: any, rowId: any) {\n\t\tif (!this.callEvent(\"onBeforeUpdate\", [rowId, this.getState(rowId), data])) {\n\t\t\treturn false;\n\t\t}\n\t\tthis._sendData(data, rowId);\n\t}\n\n\tprotected _serializeAsJSON(data: any) {\n\t\tif (typeof data === \"string\") {\n\t\t\treturn data;\n\t\t}\n\n\t\tconst copy = utils.copy(data);\n\t\tif (this._tMode === \"REST-JSON\") {\n\t\t\tdelete copy.id;\n\t\t\tdelete copy[this.action_param];\n\t\t}\n\n\t\treturn JSON.stringify(copy);\n\t}\n\n\tprotected _applyPayload(url: string) {\n\t\tconst ajax = this.$gantt.ajax;\n\t\tif (this._payload) {\n\t\t\tfor (const key in this._payload) {\n\t\t\t\turl = url + ajax.urlSeparator(url) + this.escape(key) + \"=\" + this.escape(this._payload[key]);\n\t\t\t}\n\t\t}\n\t\treturn url;\n\t}\n\n\t// GET/POST/JSON modes of the dataProcessor didn't send the whole data items in 'delete' requests\n\t// clear extra info from the data in order not to change the request format\n\tprotected _cleanupArgumentsBeforeSend(dataToSend: any) {\n\t\tlet processedData;\n\t\tif(dataToSend[this.action_param] === undefined){// hash of updated items, and not an individual item\n\t\t\tprocessedData = {};\n\t\t\tfor(const i in dataToSend) {\n\t\t\t\tprocessedData[i] = this._cleanupArgumentsBeforeSend(dataToSend[i]);\n\t\t\t}\n\t\t} else {\n\t\t\tprocessedData = this._cleanupItemBeforeSend(dataToSend);\n\t\t}\n\t\treturn processedData;\n\t}\n\tprotected _cleanupItemBeforeSend(updatedItem: any) {\n\t\tlet output = null;\n\t\tif(updatedItem){\n\t\t\tif(updatedItem[this.action_param] === \"deleted\"){\n\t\t\t\toutput = {};\n\t\t\t\toutput.id = updatedItem.id;\n\t\t\t\toutput[this.action_param] = updatedItem[this.action_param];\n\t\t\t}else{\n\t\t\t\toutput = updatedItem;\n\t\t\t}\n\t\t}\n\n\t\treturn output;\n\t}\n\n\tprotected _sendData(dataToSend: any, rowId?: any) {\n\t\tif (!dataToSend) {\n\t\t\treturn; // nothing to send\n\t\t}\n\t\tif (!this.callEvent(\"onBeforeDataSending\", rowId ? [rowId, this.getState(rowId), dataToSend] : [null, null, dataToSend])) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (rowId) {\n\t\t\tthis._in_progress[rowId] = (new Date()).valueOf();\n\t\t}\n\n\t\tconst ajax = this.$gantt.ajax;\n\n\t\tif (this._tMode === \"CUSTOM\") {\n\t\t\tconst taskState = this.getState(rowId);\n\t\t\tconst taskAction = this.getActionByState(taskState);\n\t\t\tdelete dataToSend[this.action_param]; // not send !nativeeditor_status parameter in router mode\n\t\t\tconst ganttMode = this.getGanttMode();\n\t\t\tconst _onResolvedCreateUpdate = (tag) => {\n\t\t\t\tlet action = taskState || \"updated\";\n\t\t\t\tlet sid = rowId;\n\t\t\t\tlet tid = rowId;\n\n\t\t\t\tif (tag) {\n\t\t\t\t\taction = tag.action || taskState;\n\t\t\t\t\tsid = tag.sid || sid;\n\t\t\t\t\ttid = tag.id || tag.tid || tid;\n\t\t\t\t}\n\t\t\t\tthis.afterUpdateCallback(sid, tid, action, tag, ganttMode);\n\t\t\t};\n\n\t\t\tlet actionPromise;\n\t\t\tif (this._router instanceof Function) {\n\t\t\t\tif(this._routerParametersFormat === \"object\"){\n\t\t\t\t\tconst obj = {\n\t\t\t\t\t\tentity: ganttMode,\n\t\t\t\t\t\taction: taskAction,\n\t\t\t\t\t\tdata: dataToSend,\n\t\t\t\t\t\tid: rowId\n\t\t\t\t\t};\n\t\t\t\t\tactionPromise = this._router(obj);\n\t\t\t\t} else {\n\t\t\t\t\tactionPromise = this._router(ganttMode, taskAction, dataToSend, rowId);\n\t\t\t\t}\n\t\t\t} else if (this._router[ganttMode] instanceof Function) {\n\t\t\t\tactionPromise = this._router[ganttMode](taskAction, dataToSend, rowId);\n\t\t\t} else {\n\n\t\t\t\tconst errorMsgStart = \"Incorrect configuration of gantt.createDataProcessor\";\n\t\t\t\tconst errorMsgEnd = `\nYou need to either add missing properties to the dataProcessor router object or to use a router function.\nSee https://docs.dhtmlx.com/gantt/desktop__server_side.html#customrouting and https://docs.dhtmlx.com/gantt/api__gantt_createdataprocessor.html for details.`;\n\n\t\t\t\tif(!this._router[ganttMode]){\n\t\t\t\t\tthrow new Error(`${errorMsgStart}: router for the **${ganttMode}** entity is not defined. ${errorMsgEnd}`);\n\t\t\t\t}\n\t\t\t\tswitch (taskState) {\n\t\t\t\t\tcase \"inserted\":\n\t\t\t\t\t\tif(!this._router[ganttMode].create){\n\t\t\t\t\t\t\tthrow new Error(`${errorMsgStart}: **create** action for the **${ganttMode}** entity is not defined. ${errorMsgEnd}`);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tactionPromise = this._router[ganttMode].create(dataToSend);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"deleted\":\n\t\t\t\t\t\tif(!this._router[ganttMode].delete){\n\t\t\t\t\t\t\tthrow new Error(`${errorMsgStart}: **delete** action for the **${ganttMode}** entity is not defined. ${errorMsgEnd}`);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tactionPromise = this._router[ganttMode].delete(rowId);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif(!this._router[ganttMode].update){\n\t\t\t\t\t\t\tthrow new Error(`${errorMsgStart}: **update**\" action for the **${ganttMode}** entity is not defined. ${errorMsgEnd}`);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tactionPromise = this._router[ganttMode].update(dataToSend, rowId);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(actionPromise){\n\t\t\t\t// neither promise nor {tid: newId} response object\n\t\t\t\tif(!actionPromise.then &&\n\t\t\t\t\t(actionPromise.id === undefined && actionPromise.tid === undefined && actionPromise.action === undefined)){\n\t\t\t\t\tthrow new Error(\"Incorrect router return value. A Promise or a response object is expected\");\n\t\t\t\t}\n\n\t\t\t\tif(actionPromise.then){\n\t\t\t\t\tactionPromise.then(_onResolvedCreateUpdate).catch((error) => {\n\t\t\t\t\t\tif(error && error.action){\n\t\t\t\t\t\t\t_onResolvedCreateUpdate(error);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t_onResolvedCreateUpdate({ action: \"error\", value: error});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}else{\n\t\t\t\t\t// custom method may return a response object in case of sync action\n\t\t\t\t\t_onResolvedCreateUpdate(actionPromise);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\t_onResolvedCreateUpdate(null);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tlet queryParams: any;\n\t\tqueryParams = {\n\t\t\tcallback: (xml) => {\n\t\t\t\tconst ids = [];\n\n\t\t\t\tif (rowId) {\n\t\t\t\t\tids.push(rowId);\n\t\t\t\t} else if (dataToSend) {\n\t\t\t\t\tfor (const key in dataToSend) {\n\t\t\t\t\t\tids.push(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn this.afterUpdate(this, xml, ids);\n\t\t\t},\n\t\t\theaders: this._headers\n\t\t};\n\n\t\tconst dhxVersion = \"dhx_version=\" + this.$gantt.getUserData(0, \"version\", this._ganttMode);\n\t\tconst urlParams = this.serverProcessor + (this._user ? (ajax.urlSeparator(this.serverProcessor) + [\"dhx_user=\" + this._user, dhxVersion].join(\"&\")) : \"\");\n\t\tlet url: any = this._applyPayload(urlParams);\n\t\tlet data;\n\n\t\tswitch (this._tMode) {\n\t\t\tcase \"GET\":\n\t\t\t\tdata = this._cleanupArgumentsBeforeSend(dataToSend);\n\t\t\t\tqueryParams.url = url + ajax.urlSeparator(url) + this.serialize(data, rowId);\n\t\t\t\tqueryParams.method = \"GET\";\n\t\t\t\tbreak;\n\t\t\tcase \"POST\":\n\t\t\t\tdata = this._cleanupArgumentsBeforeSend(dataToSend);\n\t\t\t\tqueryParams.url = url;\n\t\t\t\tqueryParams.method = \"POST\";\n\t\t\t\tqueryParams.data = this.serialize(data, rowId);\n\t\t\t\tbreak;\n\t\t\tcase \"JSON\":\n\t\t\t\tdata = {};\n\t\t\t\tconst preprocessedData = this._cleanupItemBeforeSend(dataToSend);\n\t\t\t\tfor (const key in preprocessedData) {\n\t\t\t\t\tif (key === this.action_param || key === \"id\" || key === \"gr_id\") {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tdata[key] = preprocessedData[key];\n\t\t\t\t}\n\n\t\t\t\tqueryParams.url = url;\n\t\t\t\tqueryParams.method = \"POST\";\n\t\t\t\tqueryParams.data = JSON.stringify({\n\t\t\t\t\tid: rowId,\n\t\t\t\t\taction: dataToSend[this.action_param],\n\t\t\t\t\tdata\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase \"REST\":\n\t\t\tcase \"REST-JSON\":\n\t\t\t\turl = urlParams.replace(/(&|\\?)editing=true/, \"\");\n\t\t\t\tdata = \"\";\n\n\t\t\t\tswitch (this.getState(rowId)) {\n\t\t\t\t\tcase \"inserted\":\n\t\t\t\t\t\tqueryParams.method = \"POST\";\n\t\t\t\t\t\tqueryParams.data = this.serialize(dataToSend, rowId);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"deleted\":\n\t\t\t\t\t\tqueryParams.method = \"DELETE\";\n\t\t\t\t\t\turl = url + (url.slice(-1) === \"/\" ? \"\" : \"/\") + rowId;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tqueryParams.method = \"PUT\";\n\t\t\t\t\t\tqueryParams.data = this.serialize(dataToSend, rowId);\n\t\t\t\t\t\turl = url + (url.slice(-1) === \"/\" ? \"\" : \"/\") + rowId;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tqueryParams.url = this._applyPayload(url);\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis._waitMode++;\n\t\treturn ajax.query(queryParams);\n\t}\n\n\tprotected _forEachUpdatedRow(code: any) {\n\t\tconst updatedRows = this.updatedRows.slice();\n\t\tfor (let i = 0; i < updatedRows.length; i++) {\n\t\t\tconst rowId = updatedRows[i];\n\t\t\tif (this.$gantt.getUserData(rowId, this.action_param, this._ganttMode)) {\n\t\t\t\tcode.call(this, rowId);\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _setDefaultTransactionMode() {\n\t\tif (this.serverProcessor) {\n\t\t\tthis.setTransactionMode(\"POST\", true);\n\t\t\tthis.serverProcessor += (this.serverProcessor.indexOf(\"?\") !== -1 ? \"&\" : \"?\") + \"editing=true\";\n\t\t\tthis._serverProcessor = this.serverProcessor;\n\t\t}\n\t}\n\n\t/* returns xml node value\n\t\t@param node\n\t\t\txml node\n\t*/\n\tprotected _getXmlNodeValue(node) {\n\t\tif (node.firstChild) {\n\t\t\treturn node.firstChild.nodeValue;\n\t\t}\n\t\treturn \"\";\n\t}\n\n\tprotected _getAllData() {\n\t\tconst out = {};\n\t\tlet hasOne = false;\n\n\t\tthis._forEachUpdatedRow(function(id) {\n\t\t\tif (this._in_progress[id] || this.is_invalid(id)){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst row = this._getRowData(id);\n\t\t\tif (!this.callEvent(\"onBeforeUpdate\", [id, this.getState(id), row])) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tout[id] = row;\n\t\t\thasOne = true;\n\t\t\tthis._in_progress[id] = (new Date()).valueOf();\n\t\t});\n\n\t\treturn hasOne ? out : null;\n\t}\n\n\tprotected _prepareDate(value: Date) : string {\n\t\treturn this.$gantt.defined(this.$gantt.templates.xml_format) ? this.$gantt.templates.xml_format(value) : this.$gantt.templates.format_date(value);\n\t}\n\n\tprotected _prepareArray(value: any[], traversedObjects: object[]) : any[] {\n\t\ttraversedObjects.push(value);\n\n\t\treturn value.map((item) => {\n\t\t\tif(helpers.isDate(item)){\n\t\t\t\treturn this._prepareDate(item);\n\t\t\t} else if (Array.isArray(item) && !helpers.arrayIncludes(traversedObjects, item)){\n\t\t\t\treturn this._prepareArray(item, traversedObjects);\n\t\t\t} else if (item && typeof item === \"object\" && !helpers.arrayIncludes(traversedObjects, item)) {\n\t\t\t\treturn this._prepareObject(item, traversedObjects);\n\t\t\t} else {\n\t\t\t\treturn item;\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected _prepareObject(rawItem: any, traversedObjects: object[]) : any {\n\t\tconst processedItem = {};\n\t\ttraversedObjects.push(rawItem);\n\n\t\tfor (const key in rawItem) {\n\t\t\tif (key.substr(0, 1) === \"$\") {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst value = rawItem[key];\n\t\t\tif (helpers.isDate(value)) {\n\t\t\t\tprocessedItem[key] = this._prepareDate(value);\n\t\t\t} else if(value === null) {\n\t\t\t\tprocessedItem[key] = \"\";\n\t\t\t} else if (Array.isArray(value) && !helpers.arrayIncludes(traversedObjects, value)){\n\t\t\t\tprocessedItem[key] = this._prepareArray(value, traversedObjects);\n\t\t\t} else if (value && typeof value === \"object\" && !helpers.arrayIncludes(traversedObjects, value)) {\n\t\t\t\tprocessedItem[key] = this._prepareObject(value, traversedObjects);\n\t\t\t} else {\n\t\t\t\tprocessedItem[key] = value;\n\t\t\t}\n\t\t}\n\t\treturn processedItem;\n\t}\n\n\tprotected _prepareDataItem(rawItem: any): any {\n\t\tconst processedItem = this._prepareObject(rawItem, []);\n\n\t\tprocessedItem[this.action_param] = this.$gantt.getUserData(rawItem.id, this.action_param, this._ganttMode);\n\t\treturn processedItem;\n\t}\n\n\tprotected getStoredItem(id){\n\t\treturn this._storage.getStoredItem(id);\n\t}\n\n\tprotected _getRowData(id) {\n\t\tlet dataItem;\n\t\tconst gantt = this.$gantt;\n\t\tif (this.getGanttMode() === \"task\") {\n\t\t\tif(gantt.isTaskExists(id)){\n\t\t\t\tdataItem =this.$gantt.getTask(id);\n\t\t\t}\n\t\t} else if (this.getGanttMode() === \"assignment\") {\n\t\t\tif(this.$gantt.$data.assignmentsStore.exists(id)){\n\t\t\t\tdataItem =this.$gantt.$data.assignmentsStore.getItem(id);\n\t\t\t}\n\t\t} else if (this.getGanttMode() === \"baseline\") {\n\t\t\tif(this.$gantt.$data.baselineStore.exists(id)){\n\t\t\t\tdataItem =this.$gantt.$data.baselineStore.getItem(id);\n\t\t\t}\n\t\t} else {\n\t\t\tif(gantt.isLinkExists(id)){\n\t\t\t\tdataItem =this.$gantt.getLink(id);\n\t\t\t}\n\t\t}\n\n\t\tif (!dataItem) {\n\t\t\tdataItem = this.getStoredItem(id);\n\t\t}\n\n\t\tif (!dataItem) {\n\t\t\tdataItem = { id };\n\t\t}\n\n\t\treturn this._prepareDataItem(dataItem);\n\t}\n}","\nexport default function extendGantt(gantt: any, dp: any) {\n\tgantt.getUserData = function(id, name, store) {\n\t\tif (!this.userdata) {\n\t\t\tthis.userdata = {};\n\t\t}\n\t\tthis.userdata[store] = this.userdata[store] || {};\n\t\tif (this.userdata[store][id] && this.userdata[store][id][name]) {\n\t\t\treturn this.userdata[store][id][name];\n\t\t}\n\t\treturn \"\";\n\t};\n\tgantt.setUserData = function(id, name, value, store) {\n\t\tif (!this.userdata) {\n\t\t\tthis.userdata = {};\n\t\t}\n\t\tthis.userdata[store] = this.userdata[store] || {};\n\t\tthis.userdata[store][id] = this.userdata[store][id] || {};\n\t\tthis.userdata[store][id][name] = value;\n\t};\n\n\tgantt._change_id = function(oldId, newId) {\n\t\tswitch (this._dp._ganttMode) {\n\t\t\tcase \"task\":\n\t\t\t\tthis.changeTaskId(oldId, newId);\n\t\t\t\tbreak;\n\t\t\tcase \"link\":\n\t\t\t\tthis.changeLinkId(oldId, newId);\n\t\t\t\tbreak;\n\t\t\tcase \"assignment\":\n\t\t\t\tthis.$data.assignmentsStore.changeId(oldId, newId);\n\t\t\t\tbreak;\n\t\t\tcase \"resource\":\n\t\t\t\tthis.$data.resourcesStore.changeId(oldId, newId);\n\t\t\t\tbreak;\n\t\t\tcase \"baseline\":\n\t\t\t\tthis.$data.baselineStore.changeId(oldId, newId);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthrow new Error(`Invalid mode of the dataProcessor after database id is received: ${this._dp._ganttMode}, new id: ${newId}`);\n\t\t}\n\t};\n\n\tgantt._row_style = function(rowId, classname){\n\t\tif (this._dp._ganttMode !== \"task\") {\n\t\t\treturn;\n\t\t}\n\t\tif (!gantt.isTaskExists(rowId)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst task = gantt.getTask(rowId);\n\t\ttask.$dataprocessor_class = classname;\n\t\tgantt.refreshTask(rowId);\n\t};\n\n\t// fake method for dataprocessor\n\tgantt._delete_task = function(rowId, node) {}; // tslint:disable-line\n\n\tgantt._sendTaskOrder = function(id, item){\n\t\tif (item.$drop_target) {\n\t\t\tthis._dp.setGanttMode(\"task\");\n\t\t\tthis.getTask(id).target = item.$drop_target;\n\t\t\tthis._dp.setUpdated(id, true,\"order\");\n\t\t\tdelete this.getTask(id).$drop_target;\n\t\t}\n\t};\n\n\tgantt.setDp = function() {\n\t\tthis._dp = dp;\n\t};\n\n\tgantt.setDp();\n}","import * as DataProcessor from \"./data_processor\";\nexport default {\n\tDEPRECATED_api: function(server) {\n\t\treturn new (DataProcessor.DataProcessor)(server);\n\t},\n\tcreateDataProcessor: DataProcessor.createDataProcessor\n};","import global from \"../../utils/global\";\n\nfunction createMethod(gantt){\n\tvar methods = {};\n\tvar isActive = false;\n\tfunction disableMethod(methodName, dummyMethod){\n\t\tdummyMethod = typeof dummyMethod == \"function\" ? dummyMethod : function(){};\n\n\t\tif(!methods[methodName]){\n\t\t\tmethods[methodName] = this[methodName];\n\t\t\tthis[methodName] = dummyMethod;\n\t\t}\n\t}\n\tfunction restoreMethod(methodName){\n\t\tif(methods[methodName]){\n\t\t\tthis[methodName] = methods[methodName];\n\t\t\tmethods[methodName] = null;\n\t\t}\n\t}\n\tfunction disableMethods(methodsHash){\n\t\tfor(var i in methodsHash){\n\t\t\tdisableMethod.call(this, i, methodsHash[i]);\n\t\t}\n\t}\n\tfunction restoreMethods(){\n\t\tfor(var i in methods){\n\t\t\trestoreMethod.call(this, i);\n\t\t}\n\t}\n\n\tfunction batchUpdatePayload(callback){\n\t\ttry{\n\t\t\tcallback();\n\t\t}catch(e){\n\t\t\tglobal.console.error(e);\n\t\t}\n\t}\n\n\tvar state = gantt.$services.getService(\"state\");\n\tstate.registerProvider(\"batchUpdate\", function(){\n\t\treturn {\n\t\t\tbatch_update: isActive\n\t\t};\n\t}, false);\n\n\treturn function batchUpdate(callback, noRedraw) {\n\t\tif(isActive){\n\t\t\t// batch mode is already active\n\t\t\tbatchUpdatePayload(callback);\n\t\t\treturn;\n\t\t}\n\n\t\tvar call_dp = (this._dp && this._dp.updateMode != \"off\");\n\t\tvar dp_mode;\n\t\tif (call_dp){\n\t\t\tdp_mode = this._dp.updateMode;\n\t\t\tthis._dp.setUpdateMode(\"off\");\n\t\t}\n\n\t\t// temporary disable some methods while updating multiple tasks\n\t\tvar resetProjects = {};\n\t\tvar methods = {\n\t\t\t\"render\":true,\n\t\t\t\"refreshData\":true,\n\t\t\t\"refreshTask\":true,\n\t\t\t\"refreshLink\":true,\n\t\t\t\"resetProjectDates\":function(task){\n\t\t\t\tresetProjects[task.id] = task;\n\t\t\t}\n\t\t};\n\n\t\tdisableMethods.call(this, methods);\n\n\t\tisActive = true;\n\t\tthis.callEvent(\"onBeforeBatchUpdate\", []);\n\n\t\tbatchUpdatePayload(callback);\n\n\t\tthis.callEvent(\"onAfterBatchUpdate\", []);\n\n\t\trestoreMethods.call(this);\n\n\t\t// do required updates after changes applied\n\t\tfor(var i in resetProjects){\n\t\t\tthis.resetProjectDates(resetProjects[i]);\n\t\t}\n\n\t\tisActive = false;\n\n\t\tif(!noRedraw){\n\t\t\tthis.render();\n\t\t}\n\n\t\tif (call_dp) {\n\t\t\tthis._dp.setUpdateMode(dp_mode);\n\t\t\tthis._dp.setGanttMode(\"task\");\n\t\t\tthis._dp.sendData();\n\t\t\tthis._dp.setGanttMode(\"link\");\n\t\t\tthis._dp.sendData();\n\t\t}\n\t};\n\n\n\n}\n\nexport default function(gantt){\n\tgantt.batchUpdate = createMethod(gantt);\n};","const createWbs = (function(gantt){\n\treturn {\n\t_needRecalc: true,\n\treset: function(){\n\t\tthis._needRecalc = true;\n\t},\n\t_isRecalcNeeded: function(){\n\t\treturn (!this._isGroupSort() && this._needRecalc);\n\t},\n\t_isGroupSort: function() {\n\t\treturn !!(gantt.getState().group_mode);\n\t},\n\t_getWBSCode: function(task) {\n\t\tif(!task) return \"\";\n\n\t\tif(this._isRecalcNeeded()){\n\t\t\tthis._calcWBS();\n\t\t}\n\n\t\tif(task.$virtual) return \"\";\n\t\tif(this._isGroupSort()) return task.$wbs || \"\";\n\n\t\tif(!task.$wbs) {\n\t\t\tthis.reset();\n\t\t\tthis._calcWBS();\n\t\t}\n\t\treturn task.$wbs;\n\t},\n\t_setWBSCode: function(task, value) {\n\t\ttask.$wbs = value;\n\t},\n\tgetWBSCode: function(task) {\n\t\treturn this._getWBSCode(task);\n\t},\n\tgetByWBSCode: function(code){\n\t\tlet parts = code.split(\".\");\n\t\tlet currentNode = gantt.config.root_id;\n\t\tfor(let i = 0; i < parts.length; i++){\n\t\t\tconst children = gantt.getChildren(currentNode);\n\t\t\tlet index = parts[i]*1 - 1;\n\t\t\tif(gantt.isTaskExists(children[index])){\n\t\t\t\tcurrentNode = children[index];\n\t\t\t}else{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t\tif(gantt.isTaskExists(currentNode)){\n\t\t\treturn gantt.getTask(currentNode);\n\t\t}else{\n\t\t\treturn null;\n\t\t}\n\t},\n\t_calcWBS: function() {\n\t\tif(!this._isRecalcNeeded()) return;\n\n\t\tlet _isFirst = true;\n\t\tgantt.eachTask(function(ch) {\n\t\t\tif(ch.type == gantt.config.types.placeholder) return;\n\t\t\tif(_isFirst) {\n\t\t\t\t_isFirst = false;\n\t\t\t\tthis._setWBSCode(ch, \"1\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst _prevSibling = this._getPrevNonPlaceholderSibling(ch.id);\n\t\t\tif (_prevSibling !== null) {\n\t\t\t\tthis._increaseWBS(ch, _prevSibling);\n\t\t\t} else {\n\t\t\t\tlet _parent = gantt.getParent(ch.id);\n\t\t\t\tthis._setWBSCode(ch, gantt.getTask(_parent).$wbs + \".1\");\n\t\t\t}\n\t\t}, gantt.config.root_id, this);\n\n\t\tthis._needRecalc = false;\n\t},\n\t_increaseWBS: function(task, siblingiId){\n\t\tlet _wbs = gantt.getTask(siblingiId).$wbs;\n\t\tif(_wbs) {\n\t\t\t_wbs = _wbs.split(\".\");\n\t\t\t_wbs[_wbs.length-1]++;\n\t\t\tthis._setWBSCode(task, _wbs.join(\".\"));\n\t\t}\n\t},\n\t_getPrevNonPlaceholderSibling: function(childId) {\n\t\tlet prevSibling;\n\t\tlet currentId = childId;\n\t\tdo {\n\t\t\tprevSibling = gantt.getPrevSibling(currentId);\n\t\t\tcurrentId = prevSibling;\n\t\t} while (prevSibling !== null && gantt.getTask(prevSibling).type == gantt.config.types.placeholder);\n\t\treturn prevSibling;\n   }\n};\n});\n\nexport default function(gantt){\n\tconst wbs = createWbs(gantt);\n\tgantt.getWBSCode = function getWBSCode(task) {\n\t\treturn wbs.getWBSCode(task);\n\t};\n\n\tgantt.getTaskByWBSCode = function(code) {\n\t\treturn wbs.getByWBSCode(code);\n\t};\n\n\tfunction resetCache(){\n\t\twbs.reset();\n\t\treturn true;\n\t}\n\n\tgantt.attachEvent(\"onAfterTaskMove\", resetCache);\n\tgantt.attachEvent(\"onBeforeParse\", resetCache);\n\tgantt.attachEvent(\"onAfterTaskDelete\", resetCache);\n\tgantt.attachEvent(\"onAfterTaskAdd\", resetCache);\n\tgantt.attachEvent(\"onAfterSort\", resetCache);\n\n};\n","import * as helpers from \"../../utils/helpers\";\nimport * as dom_helpers from \"../ui/utils/dom_helpers\";\nfunction createResourceMethods(gantt){\n\n\tvar resourceTaskCache = {};\n\tvar singleResourceCacheBuilt = false;\n\n\tgantt.$data.tasksStore.attachEvent(\"onStoreUpdated\", function(){\n\t\tresourceTaskCache = {};\n\t\tsingleResourceCacheBuilt = false;\n\t});\n\tgantt.attachEvent(\"onBeforeGanttRender\", function(){\n\t\tresourceTaskCache = {};\n\t});\n\n\tfunction getTaskBy(propertyName, propertyValue, typeFilter) {\n\t\tif (typeof propertyName == \"function\") {\n\t\t\treturn filterResourceTasks(propertyName);\n\t\t} else {\n\t\t\tif (helpers.isArray(propertyValue)) {\n\t\t\t\treturn getResourceTasks(propertyName, propertyValue, typeFilter);\n\t\t\t} else {\n\t\t\t\treturn getResourceTasks(propertyName, [propertyValue], typeFilter);\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction filterResourceTasks(filter) {\n\t\tvar res = [];\n\t\tgantt.eachTask(function (task) {\n\t\t\tif (filter(task)) {\n\t\t\t\tres.push(task);\n\t\t\t}\n\t\t});\n\t\treturn res;\n\t}\n\n\tvar falsyValuePrefix = String(Math.random());\n\tfunction resourceHashFunction(value){\n\t\tif (value === null){\n\t\t\treturn falsyValuePrefix + String(value);\n\t\t}\n\t\treturn String(value);\n\t}\n\n\tfunction getCacheKey(resourceIds, property, typeFilter) {\n\t\tif (Array.isArray(resourceIds)) {\n\t\t\treturn resourceIds.map(function (value) {\n\t\t\t\treturn resourceHashFunction(value);\n\t\t\t}).join(\"_\") + `_${property}_${typeFilter}`;\n\t\t} else {\n\t\t\treturn resourceHashFunction(resourceIds) + `_${property}_${typeFilter}`;\n\t\t}\n\t}\n\n\tfunction getResourceTasks(property, resourceIds, typeFilter) {\n\t\tvar res;\n\t\tvar cacheKey = getCacheKey(resourceIds, property, JSON.stringify(typeFilter));\n\t\tvar matchingResources = {};\n\t\thelpers.forEach(resourceIds, function(resourceId) {\n\t\t\tmatchingResources[resourceHashFunction(resourceId)] = true;\n\t\t});\n\n\t\tif (!resourceTaskCache[cacheKey]) {\n\t\t\tres = resourceTaskCache[cacheKey] = [];\n\t\t\tgantt.eachTask(function (task) {\n\t\t\t\tif (typeFilter) {\n\t\t\t\t\tif (!typeFilter[gantt.getTaskType(task)]) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t} else if (task.type == gantt.config.types.project) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (property in task) {\n\t\t\t\t\tvar resourceValue;\n\t\t\t\t\tif (!helpers.isArray(task[property])) {\n\t\t\t\t\t\tresourceValue = [task[property]];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresourceValue = task[property];\n\t\t\t\t\t}\n\n\t\t\t\t\thelpers.forEach(resourceValue, function(value) {\n\t\t\t\t\t\tvar resourceValue = (value && value.resource_id) ? value.resource_id : value;\n\n\t\t\t\t\t\tif (matchingResources[resourceHashFunction(resourceValue)]) {\n\t\t\t\t\t\t\tres.push(task);\n\t\t\t\t\t\t}else if(!singleResourceCacheBuilt){\n\n\t\t\t\t\t\t\tvar key = getCacheKey(value, property);\n\t\t\t\t\t\t\tif(!resourceTaskCache[key]){\n\t\t\t\t\t\t\t\tresourceTaskCache[key] = [];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresourceTaskCache[key].push(task);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tsingleResourceCacheBuilt = true;\n\t\t} else {\n\t\t\tres = resourceTaskCache[cacheKey];\n\t\t}\n\n\t\treturn res;\n\t}\n\n\tfunction selectAssignments(resourceId, taskId, result){\n\t\tvar property = gantt.config.resource_property;\n\t\tvar owners = [];\n\t\tif (gantt.getDatastore(\"task\").exists(taskId)) {\n\t\t\tvar task = gantt.getTask(taskId);\n\t\t\towners = task[property] || [];\n\t\t}\n\n\t\tif (!Array.isArray(owners)) {\n\t\t\towners = [owners];\n\t\t}\n\t\tfor (var i = 0; i < owners.length; i++) {\n\t\t\tif (owners[i].resource_id == resourceId) {\n\t\t\t\tresult.push({task_id: task.id, resource_id:owners[i].resource_id, value:owners[i].value});\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction getResourceAssignments(resourceId, taskId){\n\t\t// resource assignment as an independent module:\n\t\t// {taskId:, resourceId, value}\n\t\t// TODO: probably should add a separate datastore for these\n\t\tvar assignments = [];\n\t\tvar property = gantt.config.resource_property;\n\t\tif(taskId !== undefined){\n\t\t\tselectAssignments(resourceId, taskId, assignments);\n\t\t}else{\n\t\t\tvar tasks = gantt.getTaskBy(property, resourceId);\n\t\t\ttasks.forEach(function(task){\n\t\t\t\tselectAssignments(resourceId, task.id, assignments);\n\t\t\t});\n\t\t}\n\t\treturn assignments;\n\t}\n\n\treturn {\n\t\tgetTaskBy: getTaskBy,\n\t\tgetResourceAssignments: getResourceAssignments\n\t};\n}\n\nfunction createHelper(gantt){\n\tconst resourcePlugin = {\n\t\trenderEditableLabel: function(start_date, end_date, resource, tasks, assignments){\n\t\t\tconst editable = gantt.config.readonly ? \"\" : \"contenteditable\";\n\t\t\tif(start_date < resource.end_date && end_date > resource.start_date){\n\t\t\t\tfor(let i = 0; i < assignments.length; i++){\n\t\t\t\t\tconst a = assignments[i];\n\t\t\t\t\t\treturn \"<div \"+editable+\" data-assignment-cell data-assignment-id='\"+a.id+\"'\"+\n\t\t\t\t\t\t\" data-row-id='\"+resource.id+\"'\"+\n\t\t\t\t\t\t\" data-task='\"+resource.$task_id+\"'\"+\n\t\t\t\t\t\t\" data-start-date='\"+gantt.templates.format_date(start_date)+\"'\"+\n\t\t\t\t\t\t\" data-end-date='\"+gantt.templates.format_date(end_date)+\"'>\" + a.value + \"</div>\";\n\t\t\t\t}\n\t\t\t\treturn \"<div \"+editable+\" data-assignment-cell data-empty \"+ \n\t\t\t\t\t\t\" data-row-id='\"+resource.id+\"'\"+\n\t\t\t\t\t\t\" data-resource-id='\"+resource.$resource_id+\"'\"+\n\t\t\t\t\t\t\" data-task='\"+resource.$task_id+\"'\"+\n\t\t\t\t\t\t\" data-start-date='\"+gantt.templates.format_date(start_date)+\"'\"+\n\t\t\t\t\t\t\"'  data-end-date='\"+gantt.templates.format_date(end_date)+\"'>-</div>\";\n\t\t\t}\n\t\t\treturn \"\";\n\t\t},\n\t\trenderSummaryLabel: function(start_date, end_date, resource, tasks, assignments){\n\t\t\tlet sum = assignments.reduce(function(total, assignment){ \n\t\t\t\treturn total + Number(assignment.value);\n\t\t\t}, 0);\n\n\t\t\tif(sum % 1){\n\t\t\t\tsum = Math.round(sum * 10)/10;\n\t\t\t}\n\n\t\t\tif(sum){\n\t\t\t\treturn \"<div>\" + sum + \"</div>\";\n\t\t\t}\n\t\t\treturn \"\";\n\t\t},\n\t\teditableResourceCellTemplate: function(start_date, end_date, resource, tasks, assignments){\n\t\t\tif(resource.$role === \"task\"){\n\t\t\t\treturn resourcePlugin.renderEditableLabel(start_date, end_date, resource, tasks, assignments);\n\t\t\t}else{\n\t\t\t\treturn resourcePlugin.renderSummaryLabel(start_date, end_date, resource, tasks, assignments);\n\t\t\t}\n\n\t\t},\n\t\t\n\t\teditableResourceCellClass: function(start_date, end_date, resource, tasks, assignments){\n\t\t\tconst css = [];\n\t\t\tcss.push(\"resource_marker\");\n\n\t\t\tif(resource.$role === \"task\"){\n\t\t\t\tcss.push(\"task_cell\");\n\t\t\t}else{\n\t\t\t\tcss.push(\"resource_cell\");\n\t\t\t}\n\n\t\t\tconst sum = assignments.reduce(function(total, assignment){ \n\t\t\t\treturn total + Number(assignment.value);\n\t\t\t}, 0);\n\n\t\t\tlet capacity = Number(resource.capacity);\n\t\t\tif(isNaN(capacity)){\n\t\t\t\tcapacity = 8;\n\t\t\t}\n\t\t\tif (sum <= capacity) {\n\t\t\t\tcss.push(\"workday_ok\");\n\t\t\t} else {\n\t\t\t\tcss.push(\"workday_over\");\n\t\t\t}\n\t\t\treturn css.join(\" \");\n\t\t},\n\t\tgetSummaryResourceAssignments: function getResourceAssignments(resourceId) {\n\t\t\tlet assignments;\n\t\t\tconst store = gantt.getDatastore(gantt.config.resource_store);\n\t\t\tconst resource = store.getItem(resourceId);\n\n\t\t\tif(resource.$role === \"task\"){\n\t\t\t\tassignments = gantt.getResourceAssignments(resource.$resource_id, resource.$task_id);\n\t\t\t}else{\n\t\t\t\tassignments = gantt.getResourceAssignments(resourceId);\n\t\t\t\tif(store.eachItem){\n\t\t\t\t\tstore.eachItem(function(childResource){\n\t\t\t\t\t\tif(childResource.$role !== \"task\"){\n\t\t\t\t\t\t\tassignments = assignments.concat(gantt.getResourceAssignments(childResource.id));\n\t\t\t\t\t\t}\n\t\t\t\t\t}, resourceId);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn assignments;\n\t\t},\n\t\t\n\t\tinitEditableDiagram: function(){\n\t\t\tgantt.config.resource_render_empty_cells = true;\n\t\t\t\n\t\t\t\n\t\t\t(function(){\n\t\t\t\t/// salesforce locker workaround\n\t\t\t\t// SF removes 'contenteditable' attribute from cells\n\t\t\t\t// restore it on render\n\t\t\t\tlet timeoutId = null;\n\t\t\t\tfunction makeEditable() {\n\t\t\t\t\tif (timeoutId) {\n\t\t\t\t\t\tcancelAnimationFrame(timeoutId);\n\t\t\t\t\t}\n\t\t\t\t\ttimeoutId = requestAnimationFrame(function () {\n\t\t\t\t\t\tif (gantt.$container){\n\t\t\t\t\t\t\tvar cells = Array.prototype.slice.call(gantt.$container.querySelectorAll(\".resourceTimeline_cell [data-assignment-cell]\"));\n\t\t\t\t\t\t\tcells.forEach(function (cell) {\n\t\t\t\t\t\t\t\tcell.contentEditable = true;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tgantt.attachEvent(\"onGanttReady\", function(){\n\t\t\t\t\tgantt.getDatastore(gantt.config.resource_assignment_store).attachEvent(\"onStoreUpdated\", makeEditable);\n\t\t\t\t\tgantt.getDatastore(gantt.config.resource_store).attachEvent(\"onStoreUpdated\", makeEditable);\n\t\t\t\t}, {once: true});\n\t\t\t\tgantt.attachEvent(\"onGanttLayoutReady\", function(){\n\t\t\t\t\tconst ganttViews = gantt.$layout.getCellsByType(\"viewCell\");\n\t\t\t\t\tganttViews.forEach(function(view){\n\t\t\t\t\t\tif(view.$config && view.$config.view === \"resourceTimeline\" && view.$content){\n\t\t\t\t\t\t\tview.$content.attachEvent(\"onScroll\", makeEditable);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t})();\n\t\t\t//GS-2766: need to restore focus after updating assignments\n\t\t\tlet currentFocusIndex = null;\n\t\t\tfunction setNextFocus(){\n\t\t\t\tsetTimeout(function(){\n\t\t\t\t\tconst focusableElementsAfterRender = dom_helpers.getFocusableNodes(gantt.$container);\n\t\t\t\t\tif(currentFocusIndex > -1){\n\t\t\t\t\t\tfocusableElementsAfterRender[currentFocusIndex +1]?.focus();\n\t\t\t\t\t}\n\t\t\t\t}, 300);\n\t\t\t};\n\n\t\t\tfunction handleAssignmentEdit(e, elem){\n\t\t\t\tlet target = elem || e.target.closest(\".resourceTimeline_cell [data-assignment-cell]\");\n\t\t\t\tif(target){\n\t\t\t\t\tlet strValue = (target.innerText || \"\").trim();\n\t\t\t\t\tif(strValue == \"-\"){\n\t\t\t\t\t\tstrValue = \"0\";\n\t\t\t\t\t}\n\t\t\t\t\tlet value = Number(strValue);\n\t\t\t\t\tlet rowId = target.getAttribute(\"data-row-id\");\n\t\t\t\t\tlet assignmentId = target.getAttribute(\"data-assignment-id\");\n\t\t\t\t\tlet taskId = target.getAttribute(\"data-task\");\n\t\t\t\t\tlet resourceId = target.getAttribute(\"data-resource-id\");\n\t\t\t\t\tlet startDate = gantt.templates.parse_date(target.getAttribute(\"data-start-date\"));\n\t\t\t\t\tlet endDate = gantt.templates.parse_date(target.getAttribute(\"data-end-date\"));\n\n\t\t\t\t\tconst assignmentStore = gantt.getDatastore(gantt.config.resource_assignment_store);\n\t\t\t\t\tif(isNaN(value)){\n\t\t\t\t\t\tgantt.getDatastore(gantt.config.resource_store).refresh(rowId);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tconst task = gantt.getTask(taskId);\n\t\t\t\t\t\tif(assignmentId){\n\t\t\t\t\t\t\t// GS-2141. Track the changes by the Undo extension\n\t\t\t\t\t\t\tif (gantt.plugins().undo){\n\t\t\t\t\t\t\t\tgantt.ext.undo.saveState(taskId, \"task\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst assignment = assignmentStore.getItem(assignmentId);\n\t\t\t\t\t\t\tif(!assignment || value === assignment.value){\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(assignment.start_date.valueOf() === startDate.valueOf() && assignment.end_date.valueOf() === endDate.valueOf()){\n\t\t\t\t\t\t\t\tassignment.value = value;\n\t\t\t\t\t\t\t\tif(!value){\n\t\t\t\t\t\t\t\t\tassignmentStore.removeItem(assignment.id);\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\tassignmentStore.updateItem(assignment.id);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif(assignment.end_date.valueOf() > endDate.valueOf()){\n\t\t\t\t\t\t\t\t\tconst nextChunk = gantt.copy(assignment);\n\t\t\t\t\t\t\t\t\tnextChunk.id = gantt.uid();\n\t\t\t\t\t\t\t\t\tnextChunk.start_date = endDate;\n\t\t\t\t\t\t\t\t\tnextChunk.duration = gantt.calculateDuration({\n\t\t\t\t\t\t\t\t\t\tstart_date: nextChunk.start_date,\n\t\t\t\t\t\t\t\t\t\tend_date: nextChunk.end_date,\n\t\t\t\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tnextChunk.delay = gantt.calculateDuration({\n\t\t\t\t\t\t\t\t\t\tstart_date: task.start_date,\n\t\t\t\t\t\t\t\t\t\tend_date: nextChunk.start_date,\n\t\t\t\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tnextChunk.mode = assignment.mode || \"default\";\n\t\t\t\t\t\t\t\t\tif(nextChunk.duration !== 0){\n\t\t\t\t\t\t\t\t\t\tassignmentStore.addItem(nextChunk);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif(assignment.start_date.valueOf() < startDate.valueOf()){\n\t\t\t\t\t\t\t\t\tassignment.end_date = startDate;\n\t\t\t\t\t\t\t\t\tassignment.duration = gantt.calculateDuration({\n\t\t\t\t\t\t\t\t\t\tstart_date: assignment.start_date,\n\t\t\t\t\t\t\t\t\t\tend_date: assignment.end_date,\n\t\t\t\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tassignment.mode = \"fixedDuration\";\n\n\t\t\t\t\t\t\t\t\tif(assignment.duration === 0){\n\t\t\t\t\t\t\t\t\t\tassignmentStore.removeItem(assignment.id);\n\t\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\tassignmentStore.updateItem(assignment.id);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\tassignmentStore.removeItem(assignment.id);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif(value){\n\t\t\t\t\t\t\t\t\tassignmentStore.addItem({\n\t\t\t\t\t\t\t\t\t\ttask_id: assignment.task_id,\n\t\t\t\t\t\t\t\t\t\tresource_id: assignment.resource_id,\n\t\t\t\t\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t\t\t\t\t\tstart_date: startDate,\n\t\t\t\t\t\t\t\t\t\tend_date: endDate,\n\t\t\t\t\t\t\t\t\t\tduration: gantt.calculateDuration({\n\t\t\t\t\t\t\t\t\t\t\tstart_date: startDate,\n\t\t\t\t\t\t\t\t\t\t\tend_date: endDate,\n\t\t\t\t\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\tdelay: gantt.calculateDuration({\n\t\t\t\t\t\t\t\t\t\t\tstart_date: task.start_date,\n\t\t\t\t\t\t\t\t\t\t\tend_date: startDate,\n\t\t\t\t\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\tmode: \"fixedDuration\"\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tgantt.updateTaskAssignments(task.id);\n\t\t\t\t\t\t\tgantt.updateTask(task.id);\n\n\t\t\t\t\t\t}else if(value){\n\t\t\t\t\t\t\tlet assignment = {\n\t\t\t\t\t\t\t\ttask_id: taskId,\n\t\t\t\t\t\t\t\tresource_id: resourceId,\n\t\t\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t\t\t\tstart_date: startDate,\n\t\t\t\t\t\t\t\tend_date: endDate,\n\t\t\t\t\t\t\t\tduration: gantt.calculateDuration({\n\t\t\t\t\t\t\t\t\tstart_date: startDate,\n\t\t\t\t\t\t\t\t\tend_date: endDate,\n\t\t\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tdelay: gantt.calculateDuration({\n\t\t\t\t\t\t\t\t\tstart_date: task.start_date,\n\t\t\t\t\t\t\t\t\tend_date: startDate,\n\t\t\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tmode: \"fixedDuration\"\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\tassignmentStore.addItem(assignment);\n\t\t\t\t\t\t\tgantt.updateTaskAssignments(task.id);\n\t\t\t\t\t\t\tgantt.updateTask(task.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tgantt.attachEvent(\"onGanttReady\", function(){\n\t\t\t\tlet editedElem = null;\n\t\t\t\tgantt.event(gantt.$container, \"keypress\", function(e){\n\t\t\t\t\tlet target = e.target.closest(\".resourceTimeline_cell [data-assignment-cell]\");\n\t\t\t\t\tif(target){\n\t\t\t\t\t\tif (e.keyCode === 13 || e.keyCode === 27) {\n\t\t\t\t\t\t\ttarget.blur();\n\t\t\t\t\t\t\thandleAssignmentEdit(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t\teditedElem = e.target;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tgantt.event(gantt.$container, \"keydown\", function(event){\n\t\t\t\t\tif (event.key === \"Tab\") {\n\t\t\t\t\t\tconst focusableElements = dom_helpers.getFocusableNodes(gantt.$container);\n\t\t\t\t\t\tcurrentFocusIndex = focusableElements.indexOf(document.activeElement);\n\t\t\t\t\t\thandleAssignmentEdit(event);\n\t\t\t\t\t\tsetNextFocus();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tgantt.event(gantt.$container, \"click\", function(e) {\n\t\t\t\t\tif(editedElem){\n\t\t\t\t\t\thandleAssignmentEdit(e, editedElem);\n\t\t\t\t\t\teditedElem = null;\n\t\t\t\t\t\t//handle click on the editable content\n\t\t\t\t\t\tif(e.target.hasAttribute(\"data-assignment-id\")){\n\t\t\t\t\t\t\tconst focusableElements = gantt.$container.querySelectorAll(\"[contenteditable='true']\");\n\t\t\t\t\t\t\tconst target = Array.from(focusableElements).find(elem =>\n\t\t\t\t\t\t\t\telem.getAttribute(\"data-start-date\") == e.target.getAttribute(\"data-start-date\") &&\n\t\t\t\t\t\t\t\telem.getAttribute(\"data-assignment-id\") == e.target.getAttribute(\"data-assignment-id\")\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t//set focus after editing assignment\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tconst focusableElementsAfterUpdate = gantt.$container.querySelectorAll(\"[contenteditable='true']\");\n\t\t\t\t\t\t\t\tconst targetAfterUpdate = Array.from(focusableElementsAfterUpdate).find(elem =>\n\t\t\t\t\t\t\t\t\telem.getAttribute(\"data-start-date\") == target.getAttribute(\"data-start-date\") &&\n\t\t\t\t\t\t\t\t\telem.getAttribute(\"data-row-id\") == target.getAttribute(\"data-row-id\")\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tif (targetAfterUpdate) {\n\t\t\t\t\t\t\t\t\ttargetAfterUpdate.focus();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, 400);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}, {once: true});\n\t\t}\n\t};\n\treturn resourcePlugin;\n}\n\nexport default function(gantt){\n\tvar methods = createResourceMethods(gantt);\n\t\n\tgantt.ext.resources = createHelper(gantt);\n\n\tgantt.config.resources = {\n\t\tdataprocessor_assignments: false,\n\t\tdataprocessor_resources: false,\n\t\teditable_resource_diagram: false,\n\t\tresource_store: {\n\t\t\ttype: \"treeDataStore\",\n\t\t\tfetchTasks: false,\n\t\t\tinitItem: function(item) {\n\t\t\t\titem.parent = item.parent || gantt.config.root_id;\n\t\t\t\titem[gantt.config.resource_property] = item.parent;\n\t\t\t\titem.open = true;\n\t\t\t\treturn item;\n\t\t\t}\n\t\t},\n\t\tlightbox_resources: function selectResourceControlOptions(resources){\n\t\t\tconst lightboxOptions = [];\n\t\t\tconst store = gantt.getDatastore(gantt.config.resource_store);\n\t\t\tresources.forEach(function(res) {\n\t\t\t\tif (!store.hasChild(res.id)) {\n\t\t\t\t\tconst copy = gantt.copy(res);\n\t\t\t\t\tcopy.key = res.id;\n\t\t\t\t\tcopy.label = res.text;\n\t\t\t\t\tlightboxOptions.push(copy);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn lightboxOptions;\n\t\t}\n\t};\n\n\tgantt.attachEvent(\"onBeforeGanttReady\", function(){\n\t\tif(gantt.getDatastore(gantt.config.resource_store)){\n\t\t\treturn;\n\t\t}\n\n\t\tconst resourceStoreConfig = gantt.config.resources ? gantt.config.resources.resource_store : undefined;\n\t\tlet fetchTasks = resourceStoreConfig ? resourceStoreConfig.fetchTasks : undefined;\n\t\tif(gantt.config.resources && gantt.config.resources.editable_resource_diagram){\n\t\t\tfetchTasks = true;\n\t\t}\n\n\t\tlet initItems = function(item) {\n\t\t\titem.parent = item.parent || gantt.config.root_id;\n\t\t\titem[gantt.config.resource_property] = item.parent;\n\t\t\titem.open = true;\n\t\t\treturn item;\n\t\t};\n\n\t\tif(resourceStoreConfig && resourceStoreConfig.initItem){\n\t\t\tinitItems = resourceStoreConfig.initItem;\n\t\t}\n\n\t\tconst storeType = resourceStoreConfig && resourceStoreConfig.type ? resourceStoreConfig.type : \"treeDatastore\";\n\n\t\tgantt.$resourcesStore = gantt.createDatastore({\n\t\t\tname: gantt.config.resource_store,\n\t\t\ttype: storeType,\n\t\t\tfetchTasks: fetchTasks !== undefined ? fetchTasks : false,\n\t\t\tinitItem: initItems\n\t\t});\n\n\t\tgantt.$data.resourcesStore = gantt.$resourcesStore;\n\n\t\tgantt.$resourcesStore.attachEvent(\"onParse\", function() {\n\t\t\tfunction selectResourceControlOptions(resources){\n\t\t\t\tconst lightboxOptions = [];\n\t\t\t\tresources.forEach(function(res) {\n\t\t\t\t\tconst copy = gantt.copy(res);\n\t\t\t\t\tcopy.key = res.id;\n\t\t\t\t\tcopy.label = res.text;\n\t\t\t\t\tlightboxOptions.push(copy);\n\t\t\t\t});\n\t\t\t\treturn lightboxOptions;\n\t\t\t}\n\n\t\t\tlet lightboxOptionsFnc = selectResourceControlOptions;\n\t\t\tlet options;\n\t\t\tif(gantt.config.resources && gantt.config.resources.lightbox_resources){\n\t\t\t\tlightboxOptionsFnc = gantt.config.resources.lightbox_resources;\n\t\t\t}\n\t\t\tif(gantt.config.resources && gantt.config.resources.editable_resource_diagram){\n\t\t\t\t// GS-2604: case for the next parsed resources\n\t\t\t\t// to filter only resources with assignments\n\t\t\t\tconst resources = gantt.$resourcesStore.getItems();\n\t\t\t\tconst filteredResources = resources.filter(resource => {\n\t\t\t\t\tlet assignments = gantt.getResourceAssignments(resource.id);\n\t\t\t\t\tif(!gantt.$resourcesStore.hasChild(resource.id) || (assignments && assignments.length)){\n\t\t\t\t\t\tif(resource.$resource_id && resource.$task_id){\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\toptions = lightboxOptionsFnc(filteredResources);\n\t\t\t} else {\n\t\t\t\toptions = lightboxOptionsFnc(gantt.$resourcesStore.getItems());\n\t\t\t}\n\t\t\tgantt.updateCollection(\"resourceOptions\", options);\n\t\t});\n\t});\n\n\tgantt.getTaskBy = methods.getTaskBy;\n\tgantt.getResourceAssignments = methods.getResourceAssignments;\n\tgantt.config.resource_property = \"owner_id\";\n\tgantt.config.resource_store = \"resource\";\n\tgantt.config.resource_render_empty_cells = false;\n\n\t/**\n\t * these are placeholder functions that should be redefined by the user\n\t*/\n\tgantt.templates.histogram_cell_class = function(start_date, end_date, resource, tasks, assignments) {};\n\tgantt.templates.histogram_cell_label = function(start_date, end_date, resource, tasks, assignments) {\n\t\treturn tasks.length + \"/3\";\n\t};\n\tgantt.templates.histogram_cell_allocated = function(start_date, end_date, resource, tasks, assignments) {\n\t\treturn tasks.length / 3;\n\t};\n\tgantt.templates.histogram_cell_capacity = function(start_date, end_date, resource, tasks, assignments) {\n\t\treturn 0;\n\t};\n\n\n\tconst defaultResourceCellClass = function(start, end, resource, tasks, assignments) {\n\t\tvar css = \"\";\n\t\tif (tasks.length <= 1) {\n\t\t\tcss = \"gantt_resource_marker_ok\";\n\t\t} else {\n\t\t\tcss = \"gantt_resource_marker_overtime\";\n\t\t}\n\t\treturn css;\n\t};\n\n\tconst defaultResourceCellTemplate = function(start, end, resource, tasks, assignments) {\n\t\treturn tasks.length * 8;\n\t};\n\n\tgantt.templates.resource_cell_value = defaultResourceCellTemplate;\n\tgantt.templates.resource_cell_class = defaultResourceCellClass;\n\n\t//editable_resource_diagram\n\tgantt.attachEvent(\"onBeforeGanttReady\", function(){\n\t\tif(gantt.config.resources && gantt.config.resources.editable_resource_diagram){\n\n\t\t\tgantt.config.resource_render_empty_cells = true;\n\t\t\tif(gantt.templates.resource_cell_value === defaultResourceCellTemplate){\n\t\t\t\tgantt.templates.resource_cell_value = gantt.ext.resources.editableResourceCellTemplate;\n\t\t\t}\n\t\t\tif(gantt.templates.resource_cell_class === defaultResourceCellClass){\n\t\t\t\tgantt.templates.resource_cell_class = gantt.ext.resources.editableResourceCellClass;\n\t\t\t}\n\t\t\t\n\t\t\tgantt.ext.resources.initEditableDiagram(gantt);\n\t\t}\n\t});\n};\n\n\n","export default function (gantt) {\n\tvar resourceAssignmentsProperty = \"$resourceAssignments\";\n\tgantt.config.resource_assignment_store = \"resourceAssignments\";\n\tgantt.config.process_resource_assignments = true;\n\n\tvar resourceAssignmentFormats = {\n\t\tauto: \"auto\",\n\t\tsingleValue: \"singleValue\",\n\t\tvalueArray: \"valueArray\",\n\t\tresourceValueArray: \"resourceValueArray\",\n\t\tassignmentsArray: \"assignmentsArray\"\n\t};\n\tvar resourceAssignmentFormat = resourceAssignmentFormats.auto;//\"primitiveSingle\";//\"primitive\";//\"object\"|\"assignment\"\n\n\tvar assignmentModes = {\n\t\tfixedDates: \"fixedDates\",\n\t\tfixedDuration: \"fixedDuration\",\n\t\tdefault: \"default\"\n\t};\n\n\n\tfunction initAssignmentFields(item, task){\n\t\tif (item.start_date) {\n\t\t\titem.start_date = gantt.date.parseDate(item.start_date, \"parse_date\");\n\t\t} else {\n\t\t\titem.start_date = null;\n\t\t}\n\n\t\tif (item.end_date) {\n\t\t\titem.end_date = gantt.date.parseDate(item.end_date, \"parse_date\");\n\t\t} else {\n\t\t\titem.end_date = null;\n\t\t}\n\n\t\tvar delay = Number(item.delay);\n\t\tvar initDelay = false;\n\t\tif (!isNaN(delay)) {\n\t\t\titem.delay = delay;\n\t\t} else {\n\t\t\titem.delay = 0;\n\t\t\tinitDelay = true;\n\t\t}\n\n\t\tif (!gantt.defined(item.value)) {\n\t\t\titem.value = null;\n\t\t}\n\n\t\tif (!item.task_id || !item.resource_id) {\n\t\t\treturn false;\n\t\t}\n\n\t\titem.mode = item.mode || assignmentModes.default;\n\n\t\tif(item.mode === assignmentModes.fixedDuration){\n\t\t\tif(isNaN(Number(item.duration))){\n\t\t\t\ttask = task || gantt.getTask(item.task_id);\n\t\t\t\titem.duration = gantt.calculateDuration({\n\t\t\t\t\tstart_date: item.start_date,\n\t\t\t\t\tend_date: item.end_date,\n\t\t\t\t\tid: task\n\t\t\t\t});\n\t\t\t}\n\t\t\tif(initDelay){\n\t\t\t\ttask = task || gantt.getTask(item.task_id);\n\t\t\t\titem.delay = gantt.calculateDuration({\n\t\t\t\t\tstart_date: task.start_date,\n\t\t\t\t\tend_date: item.start_date,\n\t\t\t\t\tid: task\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (item.mode !== assignmentModes.fixedDates && (task || gantt.isTaskExists(item.task_id))) {\n\t\t\ttask = task || gantt.getTask(item.task_id);\n\t\t\tvar timing = _assignmentTimeFromTask(item, task);\n\t\t\titem.start_date = timing.start_date;\n\t\t\titem.end_date = timing.end_date;\n\t\t\titem.duration = timing.duration;\n\t\t}\n\t}\n\t// gantt init\n\tvar resourceAssignmentsStore = gantt.createDatastore({\n\t\tname: gantt.config.resource_assignment_store,\n\t\tinitItem: function (item) {\n\t\t\tif (!item.id) {\n\t\t\t\titem.id = gantt.uid();\n\t\t\t}\n\n\t\t\tinitAssignmentFields(item);\n\n\t\t\treturn item;\n\t\t}\n\t});\n\t\n\tgantt.$data.assignmentsStore = resourceAssignmentsStore;\n\n\tfunction _assignmentTimeFromTask(assignment, task) {\n\n\t\tif (assignment.mode === assignmentModes.fixedDates) {\n\t\t\treturn {\n\t\t\t\tstart_date: assignment.start_date,\n\t\t\t\tend_date: assignment.end_date,\n\t\t\t\tduration: assignment.duration\n\t\t\t};\n\t\t} else {\n\t\t\tvar start = assignment.delay ? gantt.calculateEndDate({\n\t\t\t\tstart_date: task.start_date,\n\t\t\t\tduration: assignment.delay,\n\t\t\t\ttask: task\n\t\t\t}) : new Date(task.start_date);\n\n\t\t\tvar end;\n\t\t\tvar duration;\n\t\t\tif (assignment.mode === assignmentModes.fixedDuration) {\n\t\t\t\tend = gantt.calculateEndDate({\n\t\t\t\t\tstart_date: start,\n\t\t\t\t\tduration: assignment.duration,\n\t\t\t\t\ttask: task\n\t\t\t\t});\n\t\t\t\tduration = assignment.duration;\n\t\t\t} else {\n\t\t\t\tend = new Date(task.end_date);\n\t\t\t\tduration = task.duration - assignment.delay;\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tstart_date: start,\n\t\t\tend_date: end,\n\t\t\tduration: duration\n\t\t};\n\t}\n\n\t// data loading\n\n\tfunction _makeAssignmentsFromTask(task) {\n\t\tconst property = gantt.config.resource_property;\n\t\tlet assignments = task[property];\n\t\tconst resourceAssignments = [];\n\t\tlet detectFormat = resourceAssignmentFormat === resourceAssignmentFormats.auto;\n\n\t\tif (gantt.defined(assignments) && assignments) {\n\t\t\tif (!Array.isArray(assignments)) {\n\t\t\t\tassignments = [assignments];\n\t\t\t\tif (detectFormat) {\n\t\t\t\t\tresourceAssignmentFormat = resourceAssignmentFormats.singleValue;\n\t\t\t\t\tdetectFormat = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst usedIds = {};\n\t\t\tassignments.forEach(function (res) {\n\t\t\t\tif (!res.resource_id) { // when resource is a string/number\n\t\t\t\t\tres = { resource_id: res };\n\t\t\t\t\tif (detectFormat) {\n\t\t\t\t\t\tresourceAssignmentFormat = resourceAssignmentFormats.valueArray;\n\t\t\t\t\t\tdetectFormat = false;\n\t\t\t\t\t}\n\t\t\t\t\t//\tisSimpleArray = true;\n\t\t\t\t}\n\n\t\t\t\tif (detectFormat) {\n\t\t\t\t\tif (res.id && res.resource_id) {\n\t\t\t\t\t\tresourceAssignmentFormat = resourceAssignmentFormats.assignmentsArray;\n\t\t\t\t\t\tdetectFormat = false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresourceAssignmentFormat = resourceAssignmentFormats.resourceValueArray;\n\t\t\t\t\t\tdetectFormat = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlet defaultMode = assignmentModes.default;\n\t\t\t\tif(!res.mode){\n\t\t\t\t\tif((res.start_date && res.end_date) || (res.start_date && res.duration)){\n\t\t\t\t\t\tdefaultMode = assignmentModes.fixedDuration;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlet id;\n\t\t\t\tif(!res.id && res.$id && !usedIds[res.$id]){\n\t\t\t\t\tid = res.$id;\n\t\t\t\t} else if(res.id && !usedIds[res.id]){\n\t\t\t\t\tid = res.id;\n\t\t\t\t} else{\n\t\t\t\t\tid = gantt.uid();\n\t\t\t\t}\n\t\t\t\tusedIds[id] = true;\n\n\t\t\t\tconst assignment = {\n\t\t\t\t\tid: id,\n\t\t\t\t\tstart_date: res.start_date,\n\t\t\t\t\tduration: res.duration,\n\t\t\t\t\tend_date: res.end_date,\n\t\t\t\t\tdelay: res.delay,\n\t\t\t\t\ttask_id: task.id,\n\t\t\t\t\tresource_id: res.resource_id,\n\t\t\t\t\tvalue: res.value,\n\t\t\t\t\tmode: res.mode || defaultMode\n\t\t\t\t};\n\t\t\t\t// GS-2490: to add custom properties to assignment\n\t\t\t\t// need to exclude $id which incfluences on render \n\t\t\t\tObject.keys(res).forEach(key => {\n\t\t\t\t\tif(key != \"$id\") {\n\t\t\t\t\t\tassignment[key] = res[key];\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif(!(assignment.start_date && assignment.start_date.getMonth \n\t\t\t\t\t&& assignment.end_date && assignment.end_date.getMonth && typeof assignment.duration === \"number\")){\n\t\t\t\t\tinitAssignmentFields(assignment, task);\n\t\t\t\t}\n\n\t\t\t\tresourceAssignments.push(assignment);\n\t\t\t});\n\t\t}\n\t\treturn resourceAssignments;\n\t}\n\n\tfunction _updateTaskBack(taskId) {\n\t\t// GS-1493. In some cases, the resource assignment store has the tasks that no longer exist\n\t\tif (!gantt.isTaskExists(taskId)){\n\t\t\treturn;\n\t\t}\n\n\t\tvar task = gantt.getTask(taskId);\n\t\tvar assignments = gantt.getTaskAssignments(task.id);\n\t\t_assignAssignments(task, assignments);\n\t}\n\n\tfunction _assignAssignments(task, assignments){\n\t\tassignments.sort(function(a, b){\n\t\t\tif(a.start_date && b.start_date && a.start_date.valueOf() != b.start_date.valueOf()){\n\t\t\t\treturn a.start_date - b.start_date;\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t});\n\t\tif (resourceAssignmentFormat == resourceAssignmentFormats.assignmentsArray) {\n\t\t\ttask[gantt.config.resource_property] = assignments;\n\t\t} else if (resourceAssignmentFormat == resourceAssignmentFormats.resourceValueArray) {\n\t\t\ttask[gantt.config.resource_property] = assignments.map(function (a) {\n\t\t\t\treturn {\n\t\t\t\t\t$id: a.id,\n\t\t\t\t\tstart_date: a.start_date,\n\t\t\t\t\tduration: a.duration,\n\t\t\t\t\tend_date: a.end_date,\n\t\t\t\t\tdelay: a.delay,\n\t\t\t\t\tresource_id: a.resource_id,\n\t\t\t\t\tvalue: a.value,\n\t\t\t\t\tmode: a.mode\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\n\t\ttask[resourceAssignmentsProperty] = assignments;\n\t}\n\n\tfunction _loadAssignmentsFromTask(task) {\n\t\tvar assignments = _makeAssignmentsFromTask(task);\n\t\tvar taskAssignments = [];\n\t\tassignments.forEach(function (a) {\n\t\t\ta.id = a.id || gantt.uid();\n\t\t\t//var newId = resourceAssignmentsStore.addItem(a);\n\t\t\ttaskAssignments.push(a);\n\t\t});\n\n\t\treturn assignments;\n\t}\n\n\tfunction diffAssignments(taskValues, assignmentsStoreValues) {\n\t\tvar result = {\n\t\t\tinBoth: [],\n\t\t\tinTaskNotInStore: [],\n\t\t\tinStoreNotInTask: []\n\t\t};\n\n\t\tif (resourceAssignmentFormat == resourceAssignmentFormats.singleValue) {\n\t\t\tvar taskOwner = taskValues[0];\n\t\t\tvar ownerId = taskOwner ? taskOwner.resource_id : null;\n\t\t\tvar foundOwnerAssignment = false;\n\t\t\tassignmentsStoreValues.forEach(function (a) {\n\t\t\t\tif (a.resource_id != ownerId) {\n\t\t\t\t\tresult.inStoreNotInTask.push(a);\n\t\t\t\t} else if (a.resource_id == ownerId) {\n\t\t\t\t\tresult.inBoth.push({ store: a, task: taskOwner });\n\t\t\t\t\tfoundOwnerAssignment = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (!foundOwnerAssignment && taskOwner) {\n\t\t\t\tresult.inTaskNotInStore.push(taskOwner);\n\t\t\t}\n\n\n\t\t} else if (resourceAssignmentFormat == resourceAssignmentFormats.valueArray){\n\n\t\t\tvar taskSearch = {};\n\t\t\tvar storeSearch = {};\n\t\t\tvar processedIds = {};\n\t\t\ttaskValues.forEach(function (a) {\n\t\t\t\ttaskSearch[a.resource_id] = a;\n\t\t\t});\n\t\t\tassignmentsStoreValues.forEach(function (a) {\n\t\t\t\tstoreSearch[a.resource_id] = a;\n\t\t\t});\n\t\t\ttaskValues.concat(assignmentsStoreValues).forEach(function (a) {\n\t\t\t\tif (processedIds[a.resource_id]) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tprocessedIds[a.resource_id] = true;\n\t\t\t\tvar inTask = taskSearch[a.resource_id];\n\t\t\t\tvar inStore = storeSearch[a.resource_id];\n\n\t\t\t\tif (inTask && inStore) {\n\t\t\t\t\tresult.inBoth.push({ store: inStore, task: inTask });\n\t\t\t\t} else if (inTask && !inStore) {\n\t\t\t\t\tresult.inTaskNotInStore.push(inTask);\n\t\t\t\t} else if (!inTask && inStore) {\n\t\t\t\t\tresult.inStoreNotInTask.push(inStore);\n\t\t\t\t}\n\t\t\t});\n\t\t} else if ((resourceAssignmentFormat == resourceAssignmentFormats.assignmentsArray)\n\t\t\t|| (resourceAssignmentFormat == resourceAssignmentFormats.resourceValueArray)) {\n\t\t\tvar taskSearch = {};\n\t\t\tvar storeSearch = {};\n\t\t\tvar processedIds = {};\n\t\t\ttaskValues.forEach(function (a) {\n\t\t\t\ttaskSearch[a.id || a.$id] = a;\n\t\t\t});\n\t\t\tassignmentsStoreValues.forEach(function (a) {\n\t\t\t\tstoreSearch[a.id] = a;\n\t\t\t});\n\t\t\ttaskValues.concat(assignmentsStoreValues).forEach(function (a) {\n\t\t\t\tvar id = a.id || a.$id;\n\t\t\t\tif (processedIds[id]) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tprocessedIds[id] = true;\n\t\t\t\tvar inTask = taskSearch[id];\n\t\t\t\tvar inStore = storeSearch[id];\n\n\t\t\t\tif (inTask && inStore) {\n\t\t\t\t\tresult.inBoth.push({ store: inStore, task: inTask });\n\t\t\t\t} else if (inTask && !inStore) {\n\t\t\t\t\tresult.inTaskNotInStore.push(inTask);\n\t\t\t\t} else if (!inTask && inStore) {\n\t\t\t\t\tresult.inStoreNotInTask.push(inStore);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction assignmentHasChanged(source, target) {\n\t\tvar ignoreFields = {\n\t\t\tid: true\n\t\t};\n\n\t\tfor (var i in source) {\n\t\t\tif (!ignoreFields[i]) {\n\t\t\t\tif (String(source[i]) !== String(target[i])) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\tfunction updateAssignment(source, target) {\n\t\tvar ignoreFields = {\n\t\t\tid: true\n\t\t};\n\n\t\tfor (var i in source) {\n\t\t\tif (!ignoreFields[i]) {\n\t\t\t\ttarget[i] = source[i];\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction _syncAssignments(task, storeAssignments){\n\t\tvar tasksAssignments = _makeAssignmentsFromTask(task);\n\n\t\tvar diff = diffAssignments(tasksAssignments, storeAssignments);\n\t\tdiff.inStoreNotInTask.forEach(function (a) {\n\t\t\tresourceAssignmentsStore.removeItem(a.id);\n\t\t});\n\t\tdiff.inTaskNotInStore.forEach(function (a) {\n\t\t\tresourceAssignmentsStore.addItem(a);\n\t\t});\n\n\t\tdiff.inBoth.forEach(function (a) {\n\t\t\tif (assignmentHasChanged(a.task, a.store)) {\n\t\t\t\tupdateAssignment(a.task, a.store);\n\t\t\t\tresourceAssignmentsStore.updateItem(a.store.id);\n\t\t\t} else {\n\t\t\t\tif (a.task.start_date && a.task.end_date && a.task.mode !== assignmentModes.fixedDates) {\n\t\t\t\t\tvar timing = _assignmentTimeFromTask(a.store, task);\n\t\t\t\t\tif (a.store.start_date.valueOf() != timing.start_date.valueOf() || a.store.end_date.valueOf() != timing.end_date.valueOf()) {\n\t\t\t\t\t\ta.store.start_date = timing.start_date;\n\t\t\t\t\t\ta.store.end_date = timing.end_date;\n\t\t\t\t\t\ta.store.duration = timing.duration;\n\t\t\t\t\t\tresourceAssignmentsStore.updateItem(a.store.id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t_updateTaskBack(task.id);\n\t}\n\n\tfunction _syncOnTaskUpdate(task) {\n\t\tvar storeAssignments = task[resourceAssignmentsProperty] || resourceAssignmentsStore.find(function (a) {\n\t\t\treturn a.task_id == task.id;\n\t\t});\n\n\t\t_syncAssignments(task, storeAssignments);\n\t}\n\n\tfunction _syncOnTaskDelete(ids) {\n\t\tvar idsSearch = {};\n\t\tids.forEach(function (id) {\n\t\t\tidsSearch[id] = true;\n\t\t});\n\t\tvar taskResources = resourceAssignmentsStore.find(function (a) {\n\t\t\treturn idsSearch[a.task_id];\n\t\t});\n\t\ttaskResources.forEach(function (a) {\n\t\t\tresourceAssignmentsStore.removeItem(a.id);\n\t\t});\n\t}\n\n\tgantt.attachEvent(\"onGanttReady\", function(){\n\n\t\tif (gantt.config.process_resource_assignments) {\n\t\t\tgantt.attachEvent(\"onParse\", function () {\n\t\t\t\tgantt.silent(function () {\n\t\t\t\t\tresourceAssignmentsStore.clearAll();\n\t\t\t\t\tvar totalAssignments = [];\n\t\t\t\t\tgantt.eachTask(function (task) {\n\t\t\t\t\t\tif (task.type === gantt.config.types.project) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar assignments = _loadAssignmentsFromTask(task);\n\t\t\t\t\t\t_assignAssignments(task, assignments);\n\n\t\t\t\t\t\tassignments.forEach(function (a) {\n\t\t\t\t\t\t\ttotalAssignments.push(a);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t\tresourceAssignmentsStore.parse(totalAssignments);\n\t\t\t\t});\n\n\t\t\t});\n\n\t\t\tvar batchUpdate = false;\n\t\t\tvar needUpdate = false;\n\t\t\tvar needUpdateFor = {};\n\t\t\tvar undoBatchCancel = false;\n\t\t\tgantt.attachEvent(\"onBeforeBatchUpdate\", function(){\n\t\t\t\tbatchUpdate = true;\n\t\t\t});\n\t\t\tgantt.attachEvent(\"onAfterBatchUpdate\", function(){\n\t\t\t\t\n\t\t\t\tif(needUpdate){\n\t\t\t\t\tvar assignmentsHash = {};\n\t\t\t\t\tfor(var i in needUpdateFor){\n\t\t\t\t\t\tassignmentsHash[i] = gantt.getTaskAssignments(needUpdateFor[i].id);\n\t\t\t\t\t}\n\t\t\t\t\t// GS-2546. If we add a task that has the data in the old format,\n\t\t\t\t\t// we need to reset the cache as the assignment will be added\n\t\t\t\t\t// to the assignment store, but the cache won't have the changes\n\t\t\t\t\tif (gantt.config.process_resource_assignments && resourceAssignmentFormat === \"resourceValueArray\"){\n\t\t\t\t\t\ttaskAssignmentsCache = null;\n\t\t\t\t\t}\n\t\t\t\t\tfor(var i in needUpdateFor){\n\t\t\t\t\t\t_syncAssignments(needUpdateFor[i], assignmentsHash[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tneedUpdate = false;\n\t\t\t\tbatchUpdate = false;\n\t\t\t\tneedUpdateFor = {};\n\t\t\t});\n\n\t\t\tgantt.attachEvent(\"onTaskCreated\", function (item) {\n\t\t\t\tvar assignments = _loadAssignmentsFromTask(item);\n\t\t\t\tresourceAssignmentsStore.parse(assignments);\n\t\t\t\t_assignAssignments(item, assignments);\n\t\t\t\treturn true;\n\t\t\t});\n\t\t\tgantt.attachEvent(\"onAfterTaskUpdate\", function (id, item) {\n\t\t\t\tif(batchUpdate){\n\t\t\t\t\tneedUpdate = true;\n\t\t\t\t\tneedUpdateFor[id] = item;\n\t\t\t\t}else if (!item.unscheduled){\n\t\t\t\t\t_syncOnTaskUpdate(item);\n\t\t\t\t}\n\t\t\t});\n\t\t\tgantt.attachEvent(\"onAfterTaskAdd\", function (id, item) {\n\t\t\t\tif(batchUpdate){\n\t\t\t\t\tneedUpdate = true;\n\t\t\t\t\tneedUpdateFor[id] = item;\n\t\t\t\t}else{\n\t\t\t\t\t_syncOnTaskUpdate(item);\n\t\t\t\t}\n\t\t\t});\n\n\t\t/*\tgantt.attachEvent(\"onRowDragMove\", function (id) {\n\t\t\t\t_syncOnTaskUpdate(gantt.getTask(id));\n\t\t\t});*/\n\t\t\tgantt.attachEvent(\"onRowDragEnd\", function (id) {\n\t\t\t\t_syncOnTaskUpdate(gantt.getTask(id));\n\t\t\t});\n\t\t\tgantt.$data.tasksStore.attachEvent(\"onAfterDeleteConfirmed\", function (id, item) {\n\t\t\t\tvar deleteIds = [id];\n\t\t\t\tgantt.eachTask(function (task) {\n\t\t\t\t\tdeleteIds.push(task.id);\n\t\t\t\t}, id);\n\t\t\t\t_syncOnTaskDelete(deleteIds);\n\t\t\t});\n\t\t\tgantt.$data.tasksStore.attachEvent(\"onClearAll\", function () {\n\t\t\t\tresourceAssignmentsCache = null;\n\t\t\t\tresourceTaskAssignmentsCache = null;\n\t\t\t\ttaskAssignmentsCache = null;\n\t\t\t\tresourceAssignmentsStore.clearAll();\n\t\t\t\treturn true;\n\t\t\t});\n\t\t\tgantt.attachEvent(\"onTaskIdChange\", function (id, new_id) {\n\t\t\t\tvar taskResources = resourceAssignmentsStore.find(function (a) {\n\t\t\t\t\treturn a.task_id == id;\n\t\t\t\t});\n\t\t\t\ttaskResources.forEach(function (a) {\n\t\t\t\t\ta.task_id = new_id;\n\t\t\t\t\tresourceAssignmentsStore.updateItem(a.id);\n\t\t\t\t});\n\t\t\t\t_updateTaskBack(new_id);\n\t\t\t\t//any custom logic here\n\t\t\t});\n\t\t\t// GS-2144. When we Undo something, the cache should be reset\n\t\t\t// during the `onStoreUpdated` event to properly update the assignments\n\t\t\tgantt.attachEvent(\"onBeforeUndo\", function (action) {\n\t\t\t\tundoBatchCancel = true;\n\t\t\t\treturn true;\n\t\t\t});\n\t\t\tgantt.attachEvent(\"onAfterUndo\", function (action) {\n\t\t\t\tundoBatchCancel = true;\n\t\t\t});\n\n\n\t\t\tvar resourceAssignmentsCache = null;\n\t\t\tvar resourceTaskAssignmentsCache = null;\n\t\t\tvar taskAssignmentsCache = null;\n\n\t\t\tresourceAssignmentsStore.attachEvent(\"onStoreUpdated\", function resetCache(){\n\t\t\t\tif(batchUpdate && !undoBatchCancel){\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tresourceAssignmentsCache = null;\n\t\t\t\tresourceTaskAssignmentsCache = null;\n\t\t\t\ttaskAssignmentsCache = null;\n\t\t\t\treturn true;\n\t\t\t});\n\n\t\t\tgantt.getResourceAssignments = function (resourceId, taskId) {\n\t\t\t\tvar searchTaskId = gantt.defined(taskId) && taskId !== null;\n\n\t\t\t\tif(resourceAssignmentsCache === null){\n\t\t\t\t\tresourceAssignmentsCache = {};\n\t\t\t\t\tresourceTaskAssignmentsCache = {};\n\n\t\t\t\t\tresourceAssignmentsStore.eachItem(function (a) {\n\t\t\t\t\t\tif(!resourceAssignmentsCache[a.resource_id]){\n\t\t\t\t\t\t\tresourceAssignmentsCache[a.resource_id] = [];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresourceAssignmentsCache[a.resource_id].push(a);\n\n\t\t\t\t\t\tvar resourceTaskCacheKey = a.resource_id + \"-\" + a.task_id;\n\t\t\t\t\t\tif(!resourceTaskAssignmentsCache[resourceTaskCacheKey]){\n\t\t\t\t\t\t\tresourceTaskAssignmentsCache[resourceTaskCacheKey] = [];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresourceTaskAssignmentsCache[resourceTaskCacheKey].push(a);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\n\t\t\t\tif(searchTaskId){\n\t\t\t\t\treturn (resourceTaskAssignmentsCache[resourceId + \"-\" + taskId] || []).slice();\n\t\t\t\t}else{\n\t\t\t\t\treturn (resourceAssignmentsCache[resourceId] || []).slice();\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t\n\t\t\tgantt.getTaskAssignments = function (taskId) {\n\t\t\t\tif(taskAssignmentsCache === null){\n\t\t\t\t\tvar result = [];\n\t\t\t\t\ttaskAssignmentsCache = {};\n\t\t\t\t\tresourceAssignmentsStore.eachItem(function (a) {\n\t\t\t\t\t\tif(!taskAssignmentsCache[a.task_id]){\n\t\t\t\t\t\t\ttaskAssignmentsCache[a.task_id] = [];\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttaskAssignmentsCache[a.task_id].push(a);\n\t\t\t\t\t\tif (a.task_id == taskId) {\n\t\t\t\t\t\t\tresult.push(a);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn (taskAssignmentsCache[taskId] || []).slice();\n\t\t\t};\n\t\t\t\n\t\t\tgantt.getTaskResources = function (taskId) {\n\t\t\t\tconst store = gantt.getDatastore(\"resource\");\n\t\t\t\tconst assignments = gantt.getTaskAssignments(taskId);\n\t\n\t\t\t\tconst uniqueResources = {};\n\t\t\t\tassignments.forEach(function(a){\n\t\t\t\t\tif(!uniqueResources[a.resource_id]){\n\t\t\t\t\t\tuniqueResources[a.resource_id] = a.resource_id;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tconst resources = [];\n\t\t\t\tfor(const i in uniqueResources){\n\t\t\t\t\tconst res = store.getItem(uniqueResources[i]);\n\t\t\t\t\tif(res){\n\t\t\t\t\t\tresources.push(res);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn resources;\n\t\t\t};\n\n\t\t\tgantt.updateTaskAssignments = _updateTaskBack;\n\t\t}\n\t}, {once: true});\n};","export default function addPlaceholder(gantt){\n\tfunction isEnabled(){\n\t\treturn gantt.config.placeholder_task;\n\t}\n\n\tfunction callIfEnabled(callback){\n\t\treturn function(){\n\t\t\tif(!isEnabled()){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn callback.apply(this, arguments);\n\t\t};\n\t}\n\n\tfunction silenceDataProcessor(dataProcessor){\n\t\tif(dataProcessor && !dataProcessor._silencedPlaceholder){\n\t\t\tdataProcessor._silencedPlaceholder = true;\n\t\t\tdataProcessor.attachEvent(\"onBeforeUpdate\", callIfEnabled(function(id, state, data){\n\t\t\t\tif(data.type == gantt.config.types.placeholder){\n\t\t\t\t\tdataProcessor.setUpdated(id, false);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}));\n\t\t}\n\t}\n\n\tfunction insertPlaceholder(){\n\t\tvar placeholders = gantt.getTaskBy(\"type\", gantt.config.types.placeholder);\n\t\tif(!placeholders.length || !gantt.isTaskExists(placeholders[0].id)){\n\t\t\tvar placeholder = {\n\t\t\t\tunscheduled: true,\n\t\t\t\ttype: gantt.config.types.placeholder,\n\t\t\t\tduration:0,\n\t\t\t\ttext: gantt.locale.labels.new_task\n\t\t\t};\n\t\t\tif(gantt.callEvent(\"onTaskCreated\", [placeholder]) === false){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tgantt.addTask(placeholder);\n\t\t\t\n\t\t}\n\t}\n\n\tfunction afterEdit(id){\n\t\tvar item = gantt.getTask(id);\n\t\tif(item.type == gantt.config.types.placeholder) {\n\t\t\tif(item.start_date && item.end_date && item.unscheduled){\n\t\t\t\titem.unscheduled = false;\n\t\t\t}\n\n\t\t\tgantt.batchUpdate(function(){\n\t\t\t\tvar newTask = gantt.copy(item);\n\t\t\t\tgantt.silent(function(){\n\t\t\t\t\tgantt.deleteTask(item.id);\n\t\t\t\t});\n\n\t\t\t\tdelete newTask[\"!nativeeditor_status\"];\n\t\t\t\tnewTask.type = gantt.config.types.task;\n\t\t\t\tnewTask.id = gantt.uid();\n\t\t\t\tgantt.addTask(newTask);\n\n\t\t\t\t//insertPlaceholder();\n\t\t\t});\n\n\t\t}\n\t}\n\n\tgantt.config.types.placeholder = \"placeholder\";\n\tgantt.attachEvent(\"onDataProcessorReady\", callIfEnabled(silenceDataProcessor));\n\n\tvar ready = false;\n\tgantt.attachEvent(\"onGanttReady\", function(){\n\t\tif(ready){\n\t\t\treturn;\n\t\t}\n\t\tready = true;\n\t\tgantt.attachEvent(\"onAfterTaskUpdate\", callIfEnabled(afterEdit));\n\t\tgantt.attachEvent(\"onAfterTaskAdd\", callIfEnabled(function(id, task){\n\t\t\tif(task.type != gantt.config.types.placeholder){\n\t\t\t\tvar placeholders = gantt.getTaskBy(\"type\", gantt.config.types.placeholder);\n\t\t\t\tplaceholders.forEach(function(p){\n\t\t\t\t\tgantt.silent(function(){\n\t\t\t\t\t\tif(gantt.isTaskExists(p.id))\n\t\t\t\t\t\t\tgantt.deleteTask(p.id);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tinsertPlaceholder();\n\t\t\t}\n\t\t}));\n\t\tgantt.attachEvent(\"onParse\", callIfEnabled(insertPlaceholder));\n\t});\n\n\tfunction isPlaceholderTask(taskId){\n\t\tif(gantt.config.types.placeholder && gantt.isTaskExists(taskId)){\n\t\t\tvar task = gantt.getTask(taskId);\n\t\t\tif(task.type == gantt.config.types.placeholder){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\tfunction isPlaceholderLink(link){\n\t\tif(isPlaceholderTask(link.source) || isPlaceholderTask(link.target)){\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\tgantt.attachEvent(\"onLinkValidation\", function(link){\n\t\tif(isPlaceholderLink(link)){\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t});\n\tgantt.attachEvent(\"onBeforeLinkAdd\", function(id,link){\n\t\tif(isPlaceholderLink(link)){\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t});\n\n\tgantt.attachEvent(\"onBeforeUndoStack\", function(action){\n\t\tfor(var i = 0; i < action.commands.length; i++){\n\t\t\tvar command = action.commands[i];\n\t\t\tif(command.entity === \"task\" && command.value.type === gantt.config.types.placeholder){\n\t\t\t\taction.commands.splice(i,1);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t});\n\n};","export default function(gantt) {\n\tfunction isEnabled() {\n\t\treturn gantt.config.auto_types && // if enabled\n\t\t\t(gantt.getTaskType(gantt.config.types.project) == gantt.config.types.project);// and supported\n\t}\n\n\tfunction callIfEnabled(callback) {\n\t\treturn function() {\n\t\t\tif (!isEnabled()) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn callback.apply(this, arguments);\n\t\t};\n\t}\n\n\tfunction checkTaskType(id, changedTypes) {\n\t\tvar task = gantt.getTask(id);\n\t\tvar targetType = getTaskTypeToUpdate(task);\n\t\tif (targetType !== false && gantt.getTaskType(task) !== targetType) {\n\t\t\tchangedTypes.$needsUpdate = true;\n\t\t\tchangedTypes[task.id] = {task: task, type: targetType};\n\t\t}\n\t}\n\n\tfunction getUpdatedTypes(id, changedTypes) {\n\t\tchangedTypes = changedTypes || {};\n\t\t\n\t\tcheckTaskType(id, changedTypes);\n\t\tgantt.eachParent(function(parent) {\n\t\t\tcheckTaskType(parent.id, changedTypes);\n\t\t}, id);\n\n\t\treturn changedTypes;\n\t}\n\n\tfunction applyChanges(changedTypes) {\n\t\tfor (var i in changedTypes) {\n\t\t\tif(changedTypes[i] && changedTypes[i].task){\n\t\t\t\tvar task = changedTypes[i].task;\n\t\t\t\ttask.type = changedTypes[i].type;\n\t\t\t\tgantt.updateTask(task.id);\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction updateParentTypes(startId) {\n\t\tif (gantt.getState().group_mode) {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tvar changedTypes = getUpdatedTypes(startId);\n\t\tif (changedTypes.$needsUpdate) {\n\t\t\tgantt.batchUpdate(function() {\n\t\t\t\tapplyChanges(changedTypes);\n\t\t\t});\n\t\t}\n\t}\n\n\tvar delTaskParent;\n\n\tfunction updateTaskType(task, targetType) {\n\t\tif(!gantt.getState().group_mode){\n\t\t\ttask.type = targetType;\n\t\t\tgantt.updateTask(task.id);\n\t\t}\n\t}\n\n\tfunction getTaskTypeToUpdate(task) {\n\t\tvar allTypes = gantt.config.types;\n\t\tvar hasChildren = gantt.hasChild(task.id);\n\t\tvar taskType = gantt.getTaskType(task.type);\n\n\t\tif (hasChildren && taskType === allTypes.task) {\n\t\t\treturn allTypes.project;\n\t\t}\n\n\t\tif (!hasChildren && taskType === allTypes.project) {\n\t\t\treturn allTypes.task;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tvar isParsingDone = true;\n\n\tgantt.attachEvent(\"onParse\", callIfEnabled(function() {\n\t\tisParsingDone = false;\n\t\tif(gantt.getState().group_mode){\n\t\t\treturn;\n\t\t}\n\n\t\tgantt.batchUpdate(function() {\n\t\t\tgantt.eachTask(function(task) {\n\t\t\t\tvar targetType = getTaskTypeToUpdate(task);\n\t\t\t\tif (targetType !== false) {\n\t\t\t\t\tupdateTaskType(task, targetType);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tisParsingDone = true;\n\t}));\n\n\tgantt.attachEvent(\"onAfterTaskAdd\", callIfEnabled(function(id) {\n\t\tif (isParsingDone) {\n\t\t\tupdateParentTypes(id);\n\t\t}\n\t}));\n\n\tgantt.attachEvent(\"onAfterTaskUpdate\", callIfEnabled(function(id) {\n\t\tif (isParsingDone) {\n\t\t\tupdateParentTypes(id);\n\t\t}\n\t}));\n\n\tfunction updateAfterRemoveChild(id){\n\t\tif (id != gantt.config.root_id && gantt.isTaskExists(id)) {\n\t\t\tupdateParentTypes(id);\n\t\t}\n\t}\n\n\tgantt.attachEvent(\"onBeforeTaskDelete\", callIfEnabled(function(id, task) {\n\t\tdelTaskParent = gantt.getParent(id);\n\t\treturn true;\n\t}));\n\n\tgantt.attachEvent(\"onAfterTaskDelete\", callIfEnabled(function(id, task) {\n\t\tupdateAfterRemoveChild(delTaskParent);\n\t}));\n\n\n\tvar originalRowDndParent;\n\n\tgantt.attachEvent(\"onRowDragStart\", callIfEnabled(function(id, target, e) {\n\t\toriginalRowDndParent = gantt.getParent(id);\n\t\treturn true;\n\t}));\n\n\tgantt.attachEvent(\"onRowDragEnd\", callIfEnabled(function(id, target) {\n\t\tupdateAfterRemoveChild(originalRowDndParent);\n\t\tupdateParentTypes(id);\n\t}));\n\n\tvar originalMoveTaskParent;\n\n\tgantt.attachEvent(\"onBeforeTaskMove\", callIfEnabled(function(sid, parent, tindex) {\n\t\toriginalMoveTaskParent = gantt.getParent(sid);\n\t\treturn true;\n\t}));\n\n\tgantt.attachEvent(\"onAfterTaskMove\", callIfEnabled(function(id, parent, tindex) {\n\t\tif (document.querySelector(\".gantt_drag_marker\")) {\n\t\t\t// vertical dnd in progress\n\t\t\treturn;\n\t\t}\n\t\tupdateAfterRemoveChild(originalMoveTaskParent);\n\t\tupdateParentTypes(id);\n\t}));\n};","interface IFormatterTransfer {\n\ttoMinutes: (value: number) => number;\n\tfromMinutes: (value: number) => number;\n}\n\nexport default class DurationFormatter implements IDurationFormatter {\n\tstatic create = (settings: IDurationFormatterConfig = null): IDurationFormatter => {\n\t\treturn new DurationFormatter(settings);\n\t};\n\tprotected transferUnits: { [unit: string]: IFormatterTransfer };\n\tprotected _config: IDurationFormatterConfig;\n\tconstructor(settings: IDurationFormatterConfig = null) {\n\n\t\tthis._config = this._defaultSettings(settings);\n\t\tthis.transferUnits = {\n\t\t\tminute: {\n\t\t\t\ttoMinutes: (value: number) => {\n\t\t\t\t\treturn value;\n\t\t\t\t},\n\t\t\t\tfromMinutes: (value: number) => {\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\t\t\t},\n\t\t\thour: {\n\t\t\t\ttoMinutes: (value: number) => {\n\t\t\t\t\treturn value * this._config.minutesPerHour;\n\t\t\t\t},\n\t\t\t\tfromMinutes: (value: number) => {\n\t\t\t\t\treturn value / this._config.minutesPerHour;\n\t\t\t\t}\n\t\t\t},\n\t\t\tday: {\n\t\t\t\ttoMinutes: (value: number) => {\n\t\t\t\t\treturn value * this._config.minutesPerHour * this._config.hoursPerDay;\n\t\t\t\t},\n\t\t\t\tfromMinutes: (value: number) => {\n\t\t\t\t\treturn value / (this._config.minutesPerHour * this._config.hoursPerDay);\n\t\t\t\t}\n\t\t\t},\n\t\t\tweek: {\n\t\t\t\ttoMinutes: (value: number) => {\n\t\t\t\t\treturn value * this._config.minutesPerHour * this._config.hoursPerWeek;\n\t\t\t\t},\n\t\t\t\tfromMinutes: (value: number) => {\n\t\t\t\t\treturn value / (this._config.minutesPerHour * this._config.hoursPerWeek);\n\t\t\t\t}\n\t\t\t},\n\t\t\tmonth: {\n\t\t\t\ttoMinutes: (value: number) => {\n\t\t\t\t\treturn value * this._config.minutesPerHour * this._config.hoursPerDay * this._config.daysPerMonth;\n\t\t\t\t},\n\t\t\t\tfromMinutes: (value: number) => {\n\t\t\t\t\treturn value / (this._config.minutesPerHour * this._config.hoursPerDay * this._config.daysPerMonth);\n\t\t\t\t}\n\t\t\t},\n\t\t\tyear: {\n\t\t\t\ttoMinutes: (value: number) => {\n\t\t\t\t\treturn value * this._config.minutesPerHour * this._config.hoursPerDay * this._config.daysPerYear;\n\t\t\t\t},\n\t\t\t\tfromMinutes: (value: number) => {\n\t\t\t\t\treturn value / (this._config.minutesPerHour * this._config.hoursPerDay * this._config.daysPerYear);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\tcanParse = (value: string) : boolean => {\n\t\tlet units = \"\";\n\t\t// create all possible unit names\n\t\tconst labels = this._config.labels;\n\t\tfor(const labelName in labels){\n\t\t\tconst label = labels[labelName];\n\t\t\tunits += `${label.full}|${label.plural}|${label.short}|`;\n\t\t}\n\t\tconst reg = new RegExp(`^([+\\-]? *[0-9\\.]{1,}\\\\s*(${units})\\\\s*)*$`); // model looks like: 4h 20 minute\n\t\treturn reg.test((value||\"\").trim());\n\t};\n\n\tformat = (value:number) : string => {\n\n\t\tconst durationUnit = this._config.store;\n\t\tconst formatUnits = this._config.format;\n\t\tconst useShortLabels = this._config.short;\n\n\t\tlet totalMinutes = this.transferUnits[durationUnit]\n\t\t\t.toMinutes(value);\n\n\t\tlet units = formatUnits;\n\t\tif(units && units === \"auto\") {\n\t\t\tunits = this._selectFormatForValue(totalMinutes);\n\t\t}\n\t\tif(!units) {\n\t\t\tunits = \"day\";\n\t\t}\n\n\t\tif(formatUnits === \"auto\" && !value){\n\t\t\treturn \"\";\n\t\t}\n\t\tunits = Array.isArray(units) ? units : [units];\n\t\tlet result = \"\";\n\t\tconst last = units.length - 1;\n\t\tfor(let i = 0; i < units.length; i++){\n\t\t\tconst unit = units[i];\n\t\t\tconst countedValue = this._getValueFromMinutes(totalMinutes, unit, i === last);\n\t\t\ttotalMinutes -= this._getValueInMinutes(countedValue, unit);\n\n\t\t\tresult += `${this._getLabelForConvert(countedValue, unit, useShortLabels)}${i === last ? \"\" : \" \"}`;\n\t\t}\n\t\treturn result;\n\t};\n\n\tparse = (value: string) : number => {\n\t\tif(this.canParse(value)){\n\t\t\tvalue = (value||\"\").trim();\n\t\t\tlet part = \"\";\n\t\t\tlet isPartReady = false;\n\t\t\tlet needToParse = false;\n\t\t\tlet result = 0;\n\t\t\tconst last = value.length - 1;\n\t\t\tconst isNumber = /^[+\\-0-9\\. ]$/; // numbers and .;\n\n\t\t\tfor(let i = 0; i < value.length; i++){\n\t\t\t\tconst symbol = value[i];\n\t\t\t\tif(isNumber.test(symbol)){\n\t\t\t\t\t// found the next number. can parse the part of value\n\t\t\t\t\tneedToParse = isPartReady;\n\t\t\t\t} else {\n\t\t\t\t\t// the number is over. letters in turn. find the next number to get whole unit name\n\t\t\t\t\tisPartReady = true;\n\t\t\t\t}\n\n\t\t\t\t// parse the part of number or the resulting part, if the last element\n\t\t\t\tif(needToParse || last === i){\n\t\t\t\t\t// add the last symbol to the part if the last element\n\t\t\t\t\tif(!needToParse) {\n\t\t\t\t\t\tpart += symbol;\n\t\t\t\t\t}\n\n\t\t\t\t\t// parse the part to minutes\n\t\t\t\t\tresult += this._getNumericValue(part);\n\t\t\t\t\tisPartReady = needToParse = false;\n\t\t\t\t\tpart = \"\";\n\t\t\t\t}\n\t\t\t\tpart += symbol;\n\t\t\t}\n\t\t\tif(result){\n\t\t\t\tconst durationUnit = this._config.store;\n\t\t\t\treturn Math.round(this.transferUnits[durationUnit]\n\t\t\t\t\t.fromMinutes(Math.ceil(result)));\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t};\n\n\tprotected _defaultSettings(settings: IDurationFormatterConfig = null){\n\t\tconst preparedSettings: IDurationFormatterConfig = {\n\t\t\tenter: \"day\",\n\t\t\tstore: \"hour\",\n\t\t\tformat: \"auto\",\n\t\t\tshort: false,\n\t\t\tminutesPerHour: 60,\n\t\t\thoursPerDay: 8,\n\t\t\thoursPerWeek: 40,\n\t\t\tdaysPerMonth: 30,\n\t\t\tdaysPerYear: 365,\n\t\t\tlabels: {\n\t\t\t\tminute: {\n\t\t\t\t\tfull: \"minute\",\n\t\t\t\t\tplural: \"minutes\",\n\t\t\t\t\tshort: \"min\"\n\t\t\t\t},\n\t\t\t\thour: {\n\t\t\t\t\tfull: \"hour\",\n\t\t\t\t\tplural: \"hours\",\n\t\t\t\t\tshort: \"h\"\n\t\t\t\t},\n\t\t\t\tday: {\n\t\t\t\t\tfull: \"day\",\n\t\t\t\t\tplural: \"days\",\n\t\t\t\t\tshort: \"d\"\n\t\t\t\t},\n\t\t\t\tweek: {\n\t\t\t\t\tfull: \"week\",\n\t\t\t\t\tplural: \"weeks\",\n\t\t\t\t\tshort: \"wk\"\n\t\t\t\t},\n\t\t\t\tmonth: {\n\t\t\t\t\tfull: \"month\",\n\t\t\t\t\tplural: \"months\",\n\t\t\t\t\tshort: \"mon\"\n\t\t\t\t},\n\t\t\t\tyear: {\n\t\t\t\t\tfull: \"year\",\n\t\t\t\t\tplural: \"years\",\n\t\t\t\t\tshort: \"y\"\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tif(settings){\n\t\t\tfor(const i in settings){\n\t\t\t\tif(settings[i] !== undefined && i !== \"labels\") {\n\t\t\t\t\tpreparedSettings[i] = settings[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(settings.labels){\n\t\t\t\tfor(const i in settings.labels) {\n\t\t\t\t\tpreparedSettings.labels[i] = settings.labels[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn preparedSettings;\n\n\t}\n\n\tprotected _selectFormatForValue(value: number): string {\n\t\tconst units = [\"year\",\"month\",\"day\",\"hour\",\"minute\"];\n\t\tconst values = [];\n\t\tfor(let i = 0; i < units.length; i++) {\n\t\t\tvalues[i] = Math.abs(this.transferUnits[units[i]].fromMinutes(value));\n\t\t}\n\n\t\tfor(let i = 0; i < values.length; i++) {\n\t\t\tconst valueInUnit = values[i];\n\t\t\tif(valueInUnit < 1 && i < values.length - 1){\n\t\t\t\tcontinue;\n\t\t\t} else {\n\t\t\t\treturn units[i];\n\t\t\t}\n\t\t}\n\n\t\treturn \"day\";\n\t}\n\n\tprotected _getNumericValue(value: string) : number {\n\t\tconst numericValue = parseFloat(value.replace(/ /g, \"\")) || 0;\n\t\tconst lettersValue = value.match(/\\p{L}/gu) ? value.match(/\\p{L}/gu).join(\"\") : \"\";\n\t\tconst unitName = this._getUnitName(lettersValue); // leave only letters\n\n\t\tif(!numericValue || !unitName){\n\t\t\treturn 0;\n\t\t}\n\n\t\treturn this._getValueInMinutes(numericValue, unitName);\n\t}\n\n\tprotected _getValueInMinutes = (value: number, unit: string) => {\n\t\tif(this.transferUnits[unit] && this.transferUnits[unit].toMinutes){\n\t\t\treturn this.transferUnits[unit].toMinutes(value);\n\t\t}\n\t\treturn 0;\n\t};\n\n\tprotected _getLabelForConvert = (value: number, unit: string, short: boolean) : string => {\n\t\tconst labels = this._config.labels;\n\t\tconst label = labels[unit];\n\t\tif(short){\n\t\t\treturn `${value}${label.short}`;\n\t\t}\n\t\tconst plural = (value !== 1 && value !== -1);\n\t\treturn `${value} ${plural ? label.plural : label.full}`;\n\t};\n\n\tprotected _getValueFromMinutes = (value: number, unit: string, last: boolean) : number => {\n\t\tif(this.transferUnits[unit] && this.transferUnits[unit].fromMinutes){\n\t\t\tconst result = this.transferUnits[unit].fromMinutes(value);\n\n\t\t\tif(last){\n\t\t\t\treturn parseFloat(result.toFixed(2));\n\t\t\t}\n\t\t\treturn parseInt(result.toString(), 10);\n\t\t}\n\t\treturn null;\n\t};\n\n\tprotected _isUnitName = (unit: any, value: string) : boolean => {\n\t\tvalue = value.toLowerCase();\n\t\treturn unit.full.toLowerCase() === value\n\t\t\t|| unit.plural.toLowerCase() === value\n\t\t\t|| unit.short.toLowerCase() === value;\n\t};\n\n\tprotected _getUnitName = (value: string) : string => {\n\t\tconst labels = this._config.labels;\n\t\tlet labelName: string;\n\t\tlet isUnit = false;\n\t\tfor(labelName in labels){\n\t\t\tif(this._isUnitName(labels[labelName], value)){\n\t\t\t\tisUnit = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(isUnit){\n\t\t\treturn labelName;\n\t\t}\n\t\treturn this._config.enter;\n\t};\n}","export default class LinkFormatterSimple implements ILinkFormatter {\n\tstatic create = (settings: ILinkFormatterConfig = null, gantt: any): LinkFormatterSimple => {\n\t\treturn new LinkFormatterSimple(gantt);\n\t};\n\tprotected _linkReg: RegExp;\n\tprotected _gantt: any;\n\n\tconstructor(gantt: any) {\n\t\tthis._linkReg = /^[0-9\\.]+/;\n\t\tthis._gantt = gantt;\n\t}\n\n\tformat = (link: ILink) : string => {\n\t\tconst wbs = this._getWBSCode(link.source);\n\t\treturn wbs;\n\t};\n\n\tcanParse = (value: string) : boolean => {\n\t\treturn this._linkReg.test(value);\n\t};\n\tparse = (value: string) : ILink => {\n\t\tif(!this.canParse(value)){\n\t\t\treturn null;\n\t\t}\n\n\t\tconst linkPart = this._linkReg.exec(value)[0].trim();\n\n\t\tconst source = this._findSource(linkPart) || null;\n\n\t\treturn {\n\t\t\tid: undefined,\n\t\t\tsource,\n\t\t\ttarget: null,\n\t\t\ttype: this._gantt.config.links.finish_to_start,\n\t\t\tlag: 0\n\t\t};\n\t};\n\n\tprotected _getWBSCode = (source: number | string) => {\n\t\tconst pred = this._gantt.getTask(source);\n\t\treturn this._gantt.getWBSCode(pred);\n\t};\n\n\tprotected _findSource = (value: string) => {\n\t\tconst reqTemplate = new RegExp(\"^[0-9\\.]+\", \"i\");\n\t\tif(reqTemplate.exec(value)){\n\t\t\tconst wbs = reqTemplate.exec(value)[0];\n\t\t\tconst task = this._gantt.getTaskByWBSCode(wbs);\n\t\t\tif(task){\n\t\t\t\treturn task.id;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t};\n}","import LinkFormatterSimple from \"./link_formatter_simple\";\n\nexport default class LinkFormatter extends LinkFormatterSimple implements ILinkFormatter {\n\tstatic create = (settings: ILinkFormatterConfig = null, gantt: any): LinkFormatter => {\n\t\treturn new LinkFormatter(settings, gantt);\n\t};\n\tprotected _config: ILinkFormatterConfig;\n\n\tconstructor(settings: ILinkFormatterConfig, gantt: any) {\n\t\tsuper(gantt);\n\t\tthis._config = this._defaultSettings(settings);\n\t\tthis._linkReg = /^[0-9\\.]+[a-zA-Z]*/;\n\t}\n\n\tformat = (link: ILink) : string => {\n\t\tconst formattedType = this._getFormattedLinkType(this._getLinkTypeName(link.type));\n\t\tconst wbs = this._getWBSCode(link.source);\n\t\tconst lag = this._getLagString(link.lag);\n\n\t\tif(link.type === this._gantt.config.links.finish_to_start && !link.lag){\n\t\t\treturn wbs;\n\t\t}else{\n\t\t\treturn `${wbs}${formattedType}${lag}`;\n\t\t}\n\t};\n\n\tparse = (value: string) : ILink => {\n\t\tif(!this.canParse(value)){\n\t\t\treturn null;\n\t\t}\n\n\t\tconst linkPart = this._linkReg.exec(value)[0].trim();\n\t\tconst lagPart = value.replace(linkPart, \"\").trim();\n\n\t\tconst typeFormat = this._findTypeFormat(linkPart);\n\t\tconst typeNumber = this._getLinkTypeNumber(typeFormat);\n\t\tconst source = this._findSource(linkPart) || null;\n\t\tconst lag = this._parseLag(lagPart);\n\n\t\treturn {\n\t\t\tid: undefined,\n\t\t\tsource,\n\t\t\ttarget: null,\n\t\t\ttype: typeNumber,\n\t\t\tlag\n\t\t};\n\t};\n\n\tprotected _defaultSettings(settings: ILinkFormatterConfig = null) : ILinkFormatterConfig{\n\t\tconst preparedSettings: ILinkFormatterConfig = {\n\t\t\tdurationFormatter: this._gantt.ext.formatters.durationFormatter(),\n\t\t\tlabels: {\n\t\t\t\tfinish_to_finish: \"FF\",\n\t\t\t\tfinish_to_start: \"FS\",\n\t\t\t\tstart_to_start: \"SS\",\n\t\t\t\tstart_to_finish: \"SF\"\n\t\t\t}\n\t\t};\n\n\t\tif(settings && settings.durationFormatter){\n\t\t\tpreparedSettings.durationFormatter = settings.durationFormatter;\n\t\t}\n\n\t\tif(settings && settings.labels){\n\t\t\tfor(const i in settings.labels){\n\t\t\t\tpreparedSettings.labels[i] = settings.labels[i];\n\t\t\t}\n\t\t}\n\t\treturn preparedSettings;\n\t}\n\n\tprotected _getLinkTypeName = (value: string) => {\n\t\tlet linkName = \"\";\n\t\tfor(linkName in this._config.labels){\n\t\t\tif(String(this._gantt.config.links[linkName]).toLowerCase() === String(value).toLowerCase()){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn linkName;\n\t};\n\n\tprotected _getLinkTypeNumber = (value: string) => {\n\t\tlet linkName = \"\";\n\t\tfor(linkName in this._gantt.config.links){\n\t\t\tif(linkName.toLowerCase() === value.toLowerCase()){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn this._gantt.config.links[linkName];\n\t};\n\n\tprotected _getFormattedLinkType = (name: string) => {\n\t\treturn this._config.labels[name] || \"\";\n\t};\n\n\tprotected _getLagString = (lag: number) => {\n\t\tif(!lag){\n\t\t\treturn \"\";\n\t\t}\n\n\t\tconst formatted = this._config.durationFormatter.format(lag);\n\t\tif(lag < 0) {\n\t\t\treturn formatted;// -3 days\n\t\t}else{\n\t\t\treturn `+${formatted}`;// + 3 days\n\t\t}\n\t};\n\n\tprotected _findTypeFormat = (value: string) => {\n\t\tconst format = value.replace(/[^a-zA-Z]/gi, \"\"); // leave only letters\n\t\tlet name = \"finish_to_start\";\n\t\tfor(const i in this._config.labels){\n\t\t\tif(this._config.labels[i].toLowerCase() === format.toLowerCase()){\n\t\t\t\tname = i;\n\t\t\t}\n\t\t}\n\t\treturn name;\n\t};\n\n\tprotected _parseLag = (value: string) => {\n\t\tif(!value){\n\t\t\treturn 0;\n\t\t}\n\t\treturn this._config.durationFormatter.parse(value);\n\t};\n}","\nimport DurationFormatter from \"../common/duration_formatter\";\nimport LinkFormatter from \"../common/link_formatter\";\n\nexport default function(gantt){\n\tgantt.ext.formatters = {\n\t\tdurationFormatter: function(settings){\n\t\t\tif(!settings){\n\t\t\t\tsettings = {};\n\t\t\t}\n\t\t\tif(!settings.store){\n\t\t\t\tsettings.store = gantt.config.duration_unit;\n\t\t\t}\n\t\t\tif(!settings.enter){\n\t\t\t\tsettings.enter = gantt.config.duration_unit;\n\t\t\t}\n\t\t\treturn DurationFormatter.create(settings, gantt);\n\t\t},\n\t\tlinkFormatter: function(settings){\n\t\t\treturn LinkFormatter.create(settings, gantt);\n\t\t}\n\t};\n};","export default function(gantt: any){\n\n\tgantt.ext = gantt.ext || {};\n\tgantt.config.show_empty_state = false;\n\n\tgantt.ext.emptyStateElement = gantt.ext.emptyStateElement || {\n\t\tisEnabled() {\n\t\t\treturn gantt.config.show_empty_state === true;\n\t\t},\n\t\tisGanttEmpty(){\n\t\t\treturn !gantt.getTaskByTime().length;\n\t\t},\n\t\trenderContent(container){\n\t\t\tconst placeholderTextElement = `<div class='gantt_empty_state_text'>\n    <div class='gantt_empty_state_text_link' data-empty-state-create-task>${gantt.locale.labels.empty_state_text_link}</div>\n    <div class='gantt_empty_state_text_description'>${gantt.locale.labels.empty_state_text_description}</div>\n    </div>`;\n\t\t\tconst placeholderImageElement = \"<div class='gantt_empty_state_image'></div>\";\n\n\t\t\tconst placeholderContainer = `<div class='gantt_empty_state'>${placeholderImageElement}${placeholderTextElement}</div>`;\n\t\t\tcontainer.innerHTML = placeholderContainer;\n\t\t},\n\n\t\tclickEvents: [],\n\t\tattachAddTaskEvent(){\n\t\t\tconst id = gantt.attachEvent(\"onEmptyClick\", function(e){\n\t\t\t\tconst domHelpers = gantt.utils.dom;\n\t\t\t\tconst gridPlaceholder = domHelpers.closest(e.target, \"[data-empty-state-create-task]\");\n\t\t\t\tif (gridPlaceholder){\n\t\t\t\t\tgantt.createTask({\n\t\t\t\t\t\tid: gantt.uid(),\n\t\t\t\t\t\ttext: \"New Task\"\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.clickEvents.push(id);\n\t\t},\n\t\tdetachAddTaskEvents(){\n\t\t\tthis.clickEvents.forEach(function(event){\n\t\t\t\tgantt.detachEvent(event);\n\t\t\t});\n\t\t\tthis.clickEvents = [];\n\t\t},\n\n\t\tgetContainer(){\n\t\t\tif (gantt.$container) {\n\t\t\t\tconst domHelpers = gantt.utils.dom;\n\t\t\t\tif (gantt.$container.contains(gantt.$grid_data)) {\n\t\t\t\t\treturn domHelpers.closest(gantt.$grid_data, \".gantt_layout_content\");\n\t\t\t\t}\n\t\t\t\tif (gantt.$container.contains(gantt.$task_data)){\n\t\t\t\t\treturn domHelpers.closest(gantt.$task_data, \".gantt_layout_content\");\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\n\t\tgetNode(){\n\t\t\tconst container = this.getContainer();\n\t\t\tif (!container){\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tconst emptyStateElementNode = container.querySelector(\".gantt_empty_state_wrapper\");\n\t\t\treturn emptyStateElementNode;\n\t\t},\n\n\t\tshow(){\n\t\t\tconst container = this.getContainer();\n\t\t\tif (!container && this.isGanttEmpty()){\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst wrapper = document.createElement(\"div\");\n\t\t\twrapper.className = \"gantt_empty_state_wrapper\";\n\t\t\twrapper.style.marginTop = (gantt.config.scale_height - container.offsetHeight) + \"px\";\n\t\t\tconst oldNodes = gantt.$container.querySelectorAll(\".gantt_empty_state_wrapper\");\n\t\t\t// for IE11\n\t\t\tArray.prototype.forEach.call(oldNodes, function(node){\n\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t});\n\n\t\t\tthis.detachAddTaskEvents();\n\t\t\tthis.attachAddTaskEvent();\n\n\t\t\tcontainer.appendChild(wrapper);\n\t\t\tthis.renderContent(wrapper);\n\t\t},\n\t\thide(){\n\t\t\tconst emptyStateElementNode = this.getNode();\n\t\t\tif (emptyStateElementNode){\n\t\t\t\temptyStateElementNode.parentNode.removeChild(emptyStateElementNode);\n\t\t\t} else{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t},\n\t\tinit(){ }\n\t};\n\n\tgantt.attachEvent(\"onDataRender\", function() {\n\t\tconst emptyStateElement = gantt.ext.emptyStateElement;\n\t\tif (emptyStateElement.isEnabled() && emptyStateElement.isGanttEmpty()) {\n\t\t\temptyStateElement.show();\n\t\t} else {\n\t\t\temptyStateElement.hide();\n\t\t}\n\t});\n\n\n\n\n}\n","export const hasBaselinesBelow = function (gantt, task) {\n  const baselines = task.baselines && task.baselines.length;\n  const baselinesOnDifferentRow = gantt.config.baselines.render_mode == \"separateRow\" || gantt.config.baselines.render_mode == \"individualRow\";\n  if (baselines && baselinesOnDifferentRow) {\n    return true;\n  }\n};\n\nexport const childrenHaveBaselines = function (gantt, taskId) {\n  let hasBaselines = false;\n  gantt.eachTask(function (child) {\n    if (hasBaselines) {\n      return;\n    }\n    hasBaselines = hasBaselinesBelow(gantt, child);\n  }, taskId);\n  return hasBaselines;\n};\n\nexport const isSplitChild = function (gantt, id) {\n  let splitChild = false;\n  gantt.eachParent(function (parent) {\n    if (isSplitParent(parent)) {\n      splitChild = true;\n    }\n  }, id);\n  return splitChild;\n};\n\nexport const isSplitParent = function (task) {\n  return task.render && task.render == \"split\" && !task.$open;\n};\n\nexport const getMaxParentHeight = function (gantt, view, task, heightLimit) {\n  let maxHeight = heightLimit || view.$task_data.scrollHeight;\n  let shrinkHeight = false;\n  let splitChild = false;\n\n  gantt.eachParent(function (parent) {\n    if (isSplitParent(parent)) {\n      splitChild = true;\n      const parentSizes = view.getItemPosition(parent);\n      const parentHeight = parentSizes.rowHeight;\n      if (parentHeight < maxHeight) {\n        maxHeight = parentHeight;\n        shrinkHeight = true;\n      }\n    }\n  }, task.id);\n\n  return { maxHeight, shrinkHeight, splitChild };\n};\n\nexport const getMilestoneHeight = function (height) {\n  return Math.sqrt(2 * height * height);\n};\n\nexport const getInvertedMilestoneHeight = function (height) {\n  return Math.round(height / Math.sqrt(2));\n};\n\nexport const getAdjustedPosition = function (gantt, timeline, sizes, heightLimit, task, childBaselines) {\n  const baselines = hasBaselinesBelow(gantt, task);\n\n  const splitParams = getMaxParentHeight(gantt, timeline, task);\n  let maxHeight = splitParams.maxHeight;\n\n  let height = sizes.height;\n  let largerHeight = height > heightLimit;\n  let noNeedToShrink = sizes.rowHeight >= heightLimit && !splitParams.splitChild && !baselines;\n  if (largerHeight || noNeedToShrink) {\n    height = heightLimit;\n  }\n\n  if (maxHeight < height) {\n    height = maxHeight;\n  }\n\n  let marginTop = Math.floor((sizes.rowHeight - height) / 2);\n\n  if (splitParams.splitChild) {\n    marginTop = Math.floor((maxHeight - height) / 2);\n  }\n  if (childBaselines || baselines) {\n    let heightDiff = Math.min(sizes.height, maxHeight) - height;\n\n    let additionalMargin = 2;\n    let exceedBarHeight = baselines && task.bar_height >= task.row_height;\n    let exceedParentHeight = splitParams.splitChild && sizes.height >= maxHeight;\n    if (exceedBarHeight || exceedParentHeight){\n      additionalMargin = 0;\n    }\n\n    marginTop = Math.floor(heightDiff / 2) + additionalMargin;\n    const bottom = height + marginTop;\n    if (bottom > sizes.rowHeight || bottom > maxHeight) {\n      // marginTop = 0;\n    }\n  }\n\n  return { height, marginTop };\n};\n\nexport default {\n  hasBaselinesBelow,\n  childrenHaveBaselines,\n  isSplitChild,\n  isSplitParent,\n  getMaxParentHeight,\n  getMilestoneHeight,\n  getInvertedMilestoneHeight,\n  getAdjustedPosition\n};\n","import { hasBaselinesBelow, isSplitParent } from \"../ui/render/baseline_helper\";\nimport isHeadless from \"../../utils/is_headless\";\n\nexport default function (gantt) {\n  gantt.config.baselines = {\n    datastore: \"baselines\",\n    render_mode: false,\n    dataprocessor_baselines: false,\n    row_height: 16,\n    bar_height: 8\n  };\n\n  function initBaselineFields(item, task) {\n    // don't add baseline if it doesn't belong to any task\n    // or if doesn't have the dates\n    if (!item.task_id || (!item.start_date && !item.end_date)) {\n      return false;\n    }\n\n    if (item.start_date) {\n      item.start_date = gantt.date.parseDate(item.start_date, \"parse_date\");\n    } else {\n      item.start_date = null;\n    }\n\n    if (item.end_date) {\n      item.end_date = gantt.date.parseDate(item.end_date, \"parse_date\");\n    } else {\n      item.end_date = null;\n    }\n\n    // set min baseline duration\n    item.duration = item.duration || 1;\n\n    // GS-2636. Calculate the 3rd date parameter basing on existing date parameters\n    if (item.start_date && !item.end_date){\n      item.end_date = gantt.calculateEndDate(item.start_date, item.duration);\n    } else if (item.end_date && !item.start_date){\n      item.start_date = gantt.calculateEndDate(item.end_date, -item.duration);\n    } \n  }\n  // gantt init\n  const baselineStore = gantt.createDatastore({\n    name: gantt.config.baselines.datastore,\n    initItem: function (item) {\n      if (!item.id) {\n        item.id = gantt.uid();\n      }\n\n      initBaselineFields(item);\n\n      return item;\n    }\n  });\n\n  gantt.$data.baselineStore = baselineStore;\n\n  function _syncBaselines(task) {\n    let shouldRepaint = false;\n    const iteratedBaselines = {};\n\n    const taskBaselines = task.baselines || [];\n    const exisingBaselines = gantt.getTaskBaselines(task.id);\n\n    if (taskBaselines.length != exisingBaselines.length) {\n      shouldRepaint = true;\n    }\n\n    taskBaselines.forEach(function (baseline) {\n      iteratedBaselines[baseline.id] = true;\n      const exisingBaseline = baselineStore.getItem(baseline.id);\n      if (exisingBaseline) {\n        const start = +exisingBaseline.start_date !== +baseline.start_date;\n        const end = +exisingBaseline.end_date !== +baseline.end_date;\n        if (start || end) {\n          baselineStore.updateItem(baseline.id, baseline);\n        }\n      } else {\n        baselineStore.addItem(baseline);\n      }\n    });\n\n    exisingBaselines.forEach(function (baseline) {\n      if (!iteratedBaselines[baseline.id]) {\n        baselineStore.removeItem(baseline.id);\n      }\n    });\n\n    if (shouldRepaint) {\n      if (isSplitParent(task)){\n        // here we adjust the parent height, then adjust it with the total child height\n        _adjustSplitParentHeight (task);\n      } else {\n        gantt.adjustTaskHeightForBaselines(task);\n      }\n      gantt.render();\n    }\n  }\n\n  function _deleteOrphanBaselines() {\n    baselineStore.eachItem(function (baseline) {\n      if (!gantt.isTaskExists(baseline.task_id)) {\n        baselineStore.removeItem(baseline.id);\n      }\n    });\n  }\n\n  function _adjustSplitParentHeight (task){\n    let maxParentHeight = 0;\n\n    gantt.adjustTaskHeightForBaselines(task);\n\n    gantt.eachTask(function(child){\n      let childHeight = child.row_height || gantt.config.row_height;\n\n      maxParentHeight = maxParentHeight || childHeight;\n      if (childHeight > maxParentHeight){\n        maxParentHeight = childHeight;\n      }\n    }, task.id);\n\n    if (task.row_height < maxParentHeight){\n      task.row_height = maxParentHeight;\n    }\n  }\n\n  gantt.adjustTaskHeightForBaselines = function (task) {\n    let height, baselineSize, betweenBaselines;\n    let margins = 2;\n    let baselineAmount = task.baselines && task.baselines.length || 0;\n    const subrowHeight = gantt.config.baselines.row_height;\n    //const baselineBarHeight = task?.baselines.bar_height\n\n    const timelineView = gantt.getLayoutView(\"timeline\");\n    if (!timelineView || !gantt.config.show_chart){\n      return;\n    }\n\n    switch (gantt.config.baselines.render_mode) {\n      case \"taskRow\":\n        task.row_height = task.bar_height + 8;\n        break;\n\n      case \"separateRow\":\n        height = timelineView.getBarHeight(task.id);\n        if (baselineAmount) {\n          task.bar_height = task.bar_height || height;\n\n          if (task.bar_height > height){\n            height = task.bar_height;\n          }\n\n          task.row_height = height + subrowHeight;\n        } else if (task.bar_height) {\n          task.row_height = task.bar_height + 4;\n        }\n\n        _increaseSplitParentHeight(task);\n        break;\n\n      case \"individualRow\":\n        height = timelineView.getBarHeight(task.id);\n\n        if (baselineAmount) {\n          task.bar_height = task.bar_height || height;\n\n          if (task.bar_height > height){\n            height = task.bar_height;\n          }\n\n          baselineSize = subrowHeight * baselineAmount;\n       //   betweenBaselines = 3 * (baselineAmount + 1);\n\n          task.row_height = height + baselineSize + margins;\n        } else if (task.bar_height){\n          task.row_height = task.bar_height + 4;\n        }\n\n        _increaseSplitParentHeight(task);\n        break;\n      default:\n        task.row_height = task.bar_height + 8;\n        break;\n    }\n  };\n\n  function _increaseSplitParentHeight(task) {\n    gantt.eachParent(function (parent) {\n      if (isSplitParent(parent)) {\n        const parentHeight = parent.row_height || gantt.getLayoutView(\"timeline\").getBarHeight(parent.id);\n        let maxHeight = task.row_height;\n\n        // iterate only direct children\n        const subtasks = gantt.getChildren(parent.id);\n        subtasks.forEach(function (subtaskId) {\n          const subtask = gantt.getTask(subtaskId);\n          if (subtask.id == task.id) {\n            return;\n          }\n          const subtaskHeight = subtask.row_height || gantt.getLayoutView(\"timeline\").getBarHeight(subtask.id);\n          maxHeight = maxHeight || subtaskHeight;\n          if (subtaskHeight > maxHeight) {\n            maxHeight = subtaskHeight;\n          }\n        });\n\n        parent.row_height = maxHeight;\n        parent.bar_height = parent.bar_height || parentHeight;\n      }\n    }, task.id);\n  }\n\n  gantt.attachEvent(\n    \"onGanttReady\",\n    function () {\n\n      if(!gantt.config.baselines){\n        return;\n      }\n\n      gantt.attachEvent(\"onParse\", function () {\n        baselineStore.eachItem(function (baseline) {\n          const taskId = baseline.task_id;\n          if (gantt.isTaskExists(taskId)) {\n            const task = gantt.getTask(taskId);\n\n            task.baselines = task.baselines || [];\n\n            let newBaseline = true;\n            for (let i = 0; i < task.baselines.length; i++) {\n              let existingBaseline = task.baselines[i];\n              if (existingBaseline.id == baseline.id){\n                newBaseline = false;\n                gantt.mixin(existingBaseline, baseline, true);\n                break;\n              }\n            }\n            if (newBaseline){\n              task.baselines.push(baseline);\n            }\n\n            if(!isHeadless(gantt)){\n              if (isSplitParent(task)){\n                _adjustSplitParentHeight (task);\n              } else {\n                gantt.adjustTaskHeightForBaselines(task);\n              }\n            }\n          }\n        });\n      });\n\n      gantt.attachEvent(\"onBeforeTaskUpdate\", function (id, task) {\n        _syncBaselines(task);\n        return true;\n      });\n\n      gantt.attachEvent(\"onAfterUndo\", function(action){\n        const baselinesRenderedBelow = gantt.config.baselines.render_mode == \"separateRow\" || gantt.config.baselines.render_mode == \"individualRow\";\n        if (baselinesRenderedBelow && action){\n          let repaint = false;\n          action.commands.forEach(function(command){\n            if (command.entity == \"task\"){\n              const taskId = command.value.id;\n              if (gantt.isTaskExists(taskId)){\n                const task = gantt.getTask(taskId);\n                if (task.parent && gantt.isTaskExists(task.parent)){\n                  const parent = gantt.getTask(task.parent);\n                  if (isSplitParent(parent)){\n                    _adjustSplitParentHeight (parent);\n                    repaint = true;\n                  }\n                }\n              }    \n            }\n          });\n          if (repaint){\n            gantt.render();\n          }\n        }\n      });\n\n      gantt.attachEvent(\"onAfterTaskDelete\", function (id, task) {\n        if (hasBaselinesBelow){\n          if (task.parent && gantt.isTaskExists(task.parent)){\n            const parent = gantt.getTask(task.parent);\n            if (isSplitParent(parent)){\n              _adjustSplitParentHeight (parent);\n            }\n          }\n        }\n        _deleteOrphanBaselines();\n      });\n\n      gantt.getTaskBaselines = function (taskId) {\n        const baselines = [];\n        baselineStore.eachItem(function (baseline) {\n          if (baseline.task_id == taskId) {\n            baselines.push(baseline);\n          }\n        });\n        return baselines;\n      };\n      gantt.$data.baselineStore.attachEvent(\"onClearAll\", function () {\n        gantt.eachTask(function(task){\n          if (task.baselines){\n            delete task.baselines;\n          }\n        });\n        // The data should not be repainted as otherwise it causes issues when we have resource \n        // assignments and group tasks. It should be fixed when we add a repaint stack\n        // gantt.refreshData();\n        return true;\n      });\n\n      gantt.$data.tasksStore.attachEvent(\"onClearAll\", function () {\n        baselineStore.clearAll();\n        return true;\n      });\n      gantt.attachEvent(\"onTaskIdChange\", function (id, new_id) {\n        const baselines = baselineStore.find(function (a) {\n          return a.task_id == id;\n        });\n        baselines.forEach(function (a) {\n          a.task_id = new_id;\n          baselineStore.updateItem(a.id);\n        });\n      });\n    },\n    { once: true }\n  );\n};\n","import { Client } from \"remote-client\";\n\nexport default class RemoteEvents {\n\tprotected _remote: any;\n\tprotected _ready: Promise<any>;\n\n\tconstructor(url: string, token: string) {\n\t\tconst remote = new Client({\n\t\t\turl,\n\t\t\ttoken\n\t\t});\n\n\t\t// temporary patch, as we do not want credentials\n\t\tremote.fetch = function (url: string, body?: BodyInit) {\n\t\t\tconst req: RequestInit = {\n\t\t\t\theaders: this.headers()\n\t\t\t};\n\t\t\tif (body) {\n\t\t\t\treq.method = \"POST\";\n\t\t\t\treq.body = body;\n\t\t\t}\n\n\t\t\treturn fetch(url, req).then(res => res.json());\n\t\t};\n\n\t\tthis._ready = remote.load().then(back => (this._remote = back));\n\t}\n\n\tprotected ready() {\n\t\treturn this._ready;\n\t}\n\n\tprotected on(name: string | any, handler?: any) {\n\t\tthis.ready().then(back => {\n\t\t\tif (typeof name === \"string\") back.on(name, handler);\n\t\t\telse {\n\t\t\t\tfor (const key in name) {\n\t\t\t\t\tback.on(key, name[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n","function createHandlers(gantt) {\n\tlet updateQueue = [];\n\tlet updateTimeout = null;\n\tconst UPDATE_DELAY = 50;\n\n\tfunction remoteUpdates(message) {\n\t\tif (!message || !message.type || !(message.task?.id || message.link?.id)) {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.error(\"Invalid message format:\", message);\n\t\t\treturn;\n\t\t}\n\n\t\tconst { type, task, link } = message;\n\t\tif ((task && gantt._dp._in_progress[task.id]) || (link && gantt._dp._in_progress[link.id])) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (type === \"add-task\") {\n\t\t\tfor (const id in gantt._dp._in_progress) {\n\t\t\t\tif (gantt._dp.getState(id) === \"inserted\") {\n\t\t\t\t\tgantt._dp.attachEvent(\"onFullSync\", function () {\n\t\t\t\t\t\tif (!gantt.isTaskExists(task.id)) {\n\t\t\t\t\t\t\tprocessUpdate(message);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, { once: true });\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tupdateQueue.push(message);\n\t\tif (updateTimeout) clearTimeout(updateTimeout);\n\t\tupdateTimeout = setTimeout(processQueue, UPDATE_DELAY);\n\t}\n\n\tfunction processQueue() {\n\t\tif (updateQueue.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (updateQueue.length === 1) {\n\t\t\tprocessUpdate(updateQueue[0]);\n\t\t} else {\n\t\t\tgantt.batchUpdate(function () {\n\t\t\t\t\tupdateQueue.forEach(message => {\n\t\t\t\t\t\tprocessUpdate(message);\n\t\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tupdateQueue = [];\n\t}\n\n\tfunction processUpdate(message) {\n\t\tconst { type, task, link } = message;\n\t\tswitch (type) {\n\t\t\tcase \"add-task\":\n\t\t\t\thandleAddTask(task);\n\t\t\t\tbreak;\n\t\t\tcase \"update-task\":\n\t\t\t\thandleUpdateTask(task);\n\t\t\t\tbreak;\n\t\t\tcase \"delete-task\":\n\t\t\t\thandleDeleteTask(task);\n\t\t\t\tbreak;\n\t\t\tcase \"add-link\":\n\t\t\t\thandleAddLink(link);\n\t\t\t\tbreak;\n\t\t\tcase \"update-link\":\n\t\t\t\thandleUpdateLink(link);\n\t\t\t\tbreak;\n\t\t\tcase \"delete-link\":\n\t\t\t\thandleDeleteLink(link);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tfunction ignore(code){\n\t\tif(gantt._dp){\n\t\t\tgantt._dp.ignore(code);\n\t\t}\n\t\telse {\n\t\t\tcode();\n\t\t}\n\t}\n\n\tfunction handleAddTask(taskData) {\n\t\tif (gantt.isTaskExists(taskData.id)) {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.warn(`Task with ID ${taskData.id} already exists. Skipping add.`);\n\t\t\treturn;\n\t\t}\n\n\t\ttaskData.start_date = gantt.templates.parse_date(taskData.start_date);\n\t\tif (taskData.end_date) taskData.end_date = gantt.templates.parse_date(taskData.end_date);\n\n\t\tignore(() => {\n\t\t\tgantt.addTask(taskData);\n\t\t});\n\n\t}\n\n\tfunction handleUpdateTask(taskData) {\n\t\tconst sid = taskData.id;\n\n\t\tif (!gantt.getTask(sid)) {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.warn(`Task with ID ${sid} does not exist. Skipping update.`);\n\t\t\treturn;\n\t\t}\n\n\t\tconst initTask = gantt.getDatastore(\"task\").$initItem.bind(gantt.getDatastore(\"task\"));\n\n\t\tconst existingTask = gantt.getTask(sid);\n\n\t\tignore(() => {\n\n\t\t\tconst remoteTask = initTask(taskData);\n\t\t\t\n\t\t\tfor (let key in remoteTask) {\n\t\t\t\texistingTask[key] = remoteTask[key];\n\t\t\t}\n\t\t\t//Object.assign(existingTask, taskData);\n\t\t//\texistingTask.start_date = gantt.templates.parse_date(taskData.start_date);\n\t\t\t//if (existingTask.end_date && taskData.end_date) { \n\t\t\t//\texistingTask.end_date = gantt.templates.parse_date(taskData.end_date);\n\t\t\tif (!remoteTask.end_date) {\n\t\t\t\texistingTask.end_date = gantt.calculateEndDate(existingTask);\n\t\t\t}\n\n\t\t\tgantt.updateTask(sid);\n\n\t\t\tif (sid !== taskData.id) {\n\t\t\t\tgantt.changeTaskId(sid, taskData.id);\n\t\t\t}\n\t\t});\n\n\t}\n\n\tfunction handleDeleteTask(taskData) {\n\t\tconst sid = taskData.id;\n\n\t\tif (!gantt.isTaskExists(sid)) {\n\t\t\treturn;\n\t\t}\n\n\t\tignore(() => {\n\t\t\tconst task = gantt.getTask(sid);\n\n\t\t\tif (task) {\n\t\t\t\t// handle unsaved edits in the lightbox\n\t\t\t\tif (gantt.getState().lightbox_id == sid) {\n\t\t\t\t\t//this._new_event = this._lightbox_id;\n\t\t\t\t\ttaskData.id = this._lightbox_id;\n\t\t\t\t\tlet currentTask = gantt.getTask(this._lightbox_id);\n\t\t\t\t\tcurrentTask = taskData;\n\t\t\t\t}\n\n\t\t\t\t// delete the task\n\t\t\t\tgantt.deleteTask(sid, true);\n\t\t\t}\n\n\t\t});\n\n\t}\n\n\tfunction handleAddLink(linkData) {\n\t\tif (gantt.isLinkExists(linkData.id)) {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.warn(`Link with ID ${linkData.id} already exists. Skipping add.`);\n\t\t\treturn;\n\t\t}\n\n\t\tignore(() => {\n\t\t\tgantt.addLink(linkData);\n\t\t});\n\n\t}\n\n\tfunction handleUpdateLink(linkData) {\n\t\tconst sid = linkData.id;\n\n\t\tif (!gantt.isLinkExists(sid)) {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.warn(`Link with ID ${sid} does not exist. Skipping update.`);\n\t\t\treturn;\n\t\t}\n\n\t\tconst existingLink= gantt.getLink(sid);\n\n\t\tignore(() => {\n\t\t\tObject.assign(existingLink, linkData);\n\t\t\tgantt.updateLink(sid);\n\n\t\t\tif (sid !== linkData.id) {\n\t\t\t\tgantt.changeLinkId(sid, linkData.id);\n\t\t\t}\n\t\t});\n\n\t}\n\n\tfunction handleDeleteLink(linkData) {\n\t\tconst sid = linkData.id;\n\n\t\tif (!gantt.getLink(sid)) {\n\t\t\treturn;\n\t\t}\n\n\t\tignore(() => {\n\t\t\tconst task = gantt.getLink(sid);\n\n\t\t\tif (task) {\n\t\t\t\t// handle unsaved edits in the lightbox\n\t\t\t\tif (gantt.getState().lightbox_id == sid) {\n\t\t\t\t\t//this._new_event = this._lightbox_id;\n\t\t\t\t\tlinkData.id = this._lightbox_id;\n\t\t\t\t\tlet currentTask = gantt.getLink(this._lightbox_id);\n\t\t\t\t\tcurrentTask = linkData;\n\t\t\t\t}\n\n\t\t\t\t// delete the link\n\t\t\t\tgantt.deleteLink(sid, true);\n\t\t\t}\n\n\t\t});\n\n\t}\n\n\treturn {\n\t\ttasks: remoteUpdates,\n\t\tlinks: remoteUpdates\n\t};\n}\n\nexport default createHandlers;","import RemoteEvents from \"./remote_events\";\nimport createHandlers from \"./handlers\";\n\nexport default function remoteEvents(gantt) {\n\tif (!gantt.ext){\n\t\tgantt.ext = {};\n\t}\n\n\tgantt.ext.liveUpdates = {\n\t\tRemoteEvents,\n\t\tremoteUpdates: createHandlers(gantt)\n\t};\n}\n\n","import quickPositionHelperFactory from \"./row_position_fixed_height\";\n\nfunction createMixin(view){\n\tvar getItemTopCache = {};\n\tvar getRowTopCache = {};\n\tvar getItemHeightCache = null;\n\tvar totalHeightCache = -1;\n\tvar getItemHeightCacheState = null;\n\n\tvar quickPosition = quickPositionHelperFactory(view);\n\n\treturn {\n\t\t_resetTopPositionHeight: function(){\n\t\t\tgetItemTopCache = {};\n\t\t\tgetRowTopCache = {};\n\t\t\tquickPosition.resetCache();\n\t\t},\n\t\t_resetHeight: function(){\n\t\t\tvar store = this.$config.rowStore;\n\t\t\tvar newState = this.getCacheStateTotalHeight(store);\n\t\t\tif(!getItemHeightCacheState){\n\t\t\t\tgetItemHeightCacheState = newState;\n\t\t\t}else if(this.shouldClearHeightCache(getItemHeightCacheState, newState)){\n\t\t\t\tgetItemHeightCacheState = newState;\n\t\t\t\tgetItemHeightCache = null;\n\t\t\t}\n\n\t\t\ttotalHeightCache = -1;\n\t\t\tquickPosition.resetCache();\n\t\t},\n\n\t\t/**\n\t\t * Get top coordinate by row index (order)\n\t\t * @param {number} index\n\t\t */\n\t\tgetRowTop: function(index){\n\t\t\tif(quickPosition.canUseSimpleCalculation()){\n\t\t\t\treturn quickPosition.getRowTop(index);\n\t\t\t}\n\n\t\t\tvar store = this.$config.rowStore;\n\t\t\tif(!store){\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tif(getRowTopCache[index] !== undefined){\n\t\t\t\treturn getRowTopCache[index];\n\t\t\t}else {\n\t\t\t\tvar all = store.getIndexRange();\n\t\t\t\tvar top = 0;\n\t\t\t\tvar result = 0;\n\t\t\t\tfor(var i = 0; i < all.length; i++){\n\t\t\t\t\tgetRowTopCache[i] = top;\n\t\t\t\t\ttop += this.getItemHeight(all[i].id);\n\t\t\t\t\tif(i < index){\n\t\t\t\t\t\tresult = top;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Get top coordinate by item id\n\t\t * @param {*} task_id\n\t\t */\n\t\tgetItemTop: function (taskId) {\n\t\t\tif(this.$config.rowStore){\n\t\t\t\tif(getItemTopCache[taskId] !== undefined){\n\t\t\t\t\treturn getItemTopCache[taskId];\n\t\t\t\t}\n\t\t\t\tvar store = this.$config.rowStore;\n\t\t\t\tif(!store) return 0;\n\n\t\t\t\tvar itemIndex = store.getIndexById(taskId);\n\n\t\t\t\tif (itemIndex === -1 && store.getParent && store.exists(taskId)) {\n\t\t\t\t\tvar parentId = store.getParent(taskId);\n\t\t\t\t\tif (store.exists(parentId)) {\n\t\t\t\t\t\t// if task is not found in list - maybe it's parent is a split task and we should use parents index instead\n\t\t\t\t\t\tvar parent = store.getItem(parentId);\n\t\t\t\t\t\tif (this.$gantt.isSplitTask(parent)) {\n\t\t\t\t\t\t\treturn this.getItemTop(parentId);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tgetItemTopCache[taskId] = this.getRowTop(itemIndex);\n\t\t\t\treturn getItemTopCache[taskId];\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t},\n\n\t\t/**\n\t\t * Get height of the item by item id\n\t\t * @param {*} itemId\n\t\t */\n\t\tgetItemHeight: function (itemId) {\n\t\t\tif(quickPosition.canUseSimpleCalculation()){\n\t\t\t\treturn quickPosition.getItemHeight(itemId);\n\t\t\t}\n\n\t\t\tif(!getItemHeightCache && this.$config.rowStore){\n\t\t\t\tthis._fillHeightCache(this.$config.rowStore);\n\t\t\t}\n\n\t\t\tif(getItemHeightCache[itemId] !== undefined){\n\t\t\t\treturn getItemHeightCache[itemId];\n\t\t\t}\n\n\t\t\tvar defaultHeight = this.$getConfig().row_height;\n\n\t\t\tif(this.$config.rowStore){\n\t\t\t\tvar store = this.$config.rowStore;\n\t\t\t\tif(!store) return defaultHeight;\n\n\t\t\t\tvar item = store.getItem(itemId);\n\n\t\t\t\treturn getItemHeightCache[itemId] = item && item.row_height || defaultHeight;\n\t\t\t}else{\n\t\t\t\treturn defaultHeight;\n\t\t\t}\n\t\t},\n\n\t\t_fillHeightCache: function(store){\n\t\t\tif(!store){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tgetItemHeightCache = {};\n\t\t\tvar defaultHeight = this.$getConfig().row_height;\n\t\t\tstore.eachItem(function(item){\n\t\t\t\treturn getItemHeightCache[item.id] = item && item.row_height || defaultHeight;\n\t\t\t});\n\t\t},\n\n\t\tgetCacheStateTotalHeight: function(store){\n\n\t\t\tvar globalHeight = this.$getConfig().row_height;\n\t\t\tvar itemHeightCache = {};\n\t\t\tvar items = [];\n\t\t\tvar sumHeight = 0;\n\t\t\tif(store){\n\t\t\t\tstore.eachItem(function(item){\n\t\t\t\t\titems.push(item);\n\t\t\t\t\titemHeightCache[item.id] = item.row_height;\n\t\t\t\t\tsumHeight += item.row_height || globalHeight;\n\t\t\t\t});\n\t\t\t}\n\n\n\t\t\treturn {\n\t\t\t\tglobalHeight: globalHeight,\n\t\t\t\titems: items,\n\t\t\t\tcount: items.length,\n\t\t\t\tsumHeight: sumHeight\n\t\t\t};\n\t\t},\n\t\tshouldClearHeightCache: function(oldState, newState){\n\n\t\t\tif(oldState.count != newState.count){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif(oldState.globalHeight != newState.globalHeight){\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif(oldState.sumHeight != newState.sumHeight){\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tfor(var i in oldState.items){\n\t\t\t\tvar newValue = newState.items[i];\n\t\t\t\tif(newValue !== undefined && newValue != oldState.items[i]){\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\t/**\n\t\t * Get total height of items\n\t\t */\n\t\tgetTotalHeight: function () {\n\t\t\tif(quickPosition.canUseSimpleCalculation()){\n\t\t\t\treturn quickPosition.getTotalHeight();\n\t\t\t}\n\n\t\t\tif(totalHeightCache != -1){\n\t\t\t\treturn totalHeightCache;\n\t\t\t}\n\n\t\t\tif(this.$config.rowStore){\n\t\t\t\tvar store = this.$config.rowStore;\n\t\t\t\tthis._fillHeightCache(store);\n\t\t\t\tvar getHeight = this.getItemHeight.bind(this);\n\t\t\t\tvar visibleItems = store.getVisibleItems();\n\t\t\t\tvar totalHeight = 0;\n\n\t\t\t\tvisibleItems.forEach(function(item){\n\t\t\t\t\ttotalHeight += getHeight(item.id);\n\t\t\t\t});\n\n\t\t\t\ttotalHeightCache = totalHeight;\n\t\t\t\treturn totalHeight;\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Get item by top position\n\t\t * @param {*} top\n\t\t */\n\t\tgetItemIndexByTopPosition: function (top) {\n\t\t\tif(this.$config.rowStore){\n\t\t\t\tif(quickPosition.canUseSimpleCalculation()){\n\t\t\t\t\treturn quickPosition.getItemIndexByTopPosition(top);\n\t\t\t\t}\n\n\t\t\t\tvar store = this.$config.rowStore;\n\t\t\t\tfor(var i = 0; i < store.countVisible(); i++){\n\t\t\t\t\tvar current = this.getRowTop(i);\n\t\t\t\t\tvar next = this.getRowTop(i+1);\n\t\t\t\t\tif(!next){\n\t\t\t\t\t\tvar taskId = store.getIdByIndex(i);\n\t\t\t\t\t\tnext = current + this.getItemHeight(taskId);\n\t\t\t\t\t}\n\t\t\t\t\tif(top >= current && top < next){\n\t\t\t\t\t\treturn i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// GS-1723: If we iterated all tasks and didn't find the position, the target is below all other tasks\n\t\t\t\treturn store.countVisible() + 2;\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t};\n}\n\nexport default createMixin;","function createHelper(view){\n\tvar cachedRowHeight = -1;\n\tvar canUseSimpleCalc = -1;\n\treturn {\n\t\tresetCache: function(){\n\t\t\tcachedRowHeight = -1;\n\t\t\tcanUseSimpleCalc = -1;\n\t\t},\n\t\t_getRowHeight: function(){\n\t\t\tif(cachedRowHeight === -1){\n\t\t\t\tcachedRowHeight = view.$getConfig().row_height;\n\t\t\t}\n\t\t\treturn cachedRowHeight;\n\t\t},\n\t\t_refreshState: function(){\n\t\t\tthis.resetCache();\n\t\t\tcanUseSimpleCalc = true;\n\t\t\tvar store = view.$config.rowStore;\n\t\t\tif(!store){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar globalRowHeight = this._getRowHeight();\n\t\t\tfor (var i=0; i<store.fullOrder.length; i++) {\n\t\t\t\tvar item = store.getItem(store.fullOrder[i]);\n\t\t\t\t// GS-1491: ignore the task when it is filtered:\n\t\t\t\tif (!item) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif(item.row_height && item.row_height !== globalRowHeight){\n\t\t\t\t\tcanUseSimpleCalc = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t},\n\t\tcanUseSimpleCalculation: function(){\n\t\t\tif(canUseSimpleCalc === -1){\n\t\t\t\tthis._refreshState();\n\t\t\t}\n\t\t\treturn canUseSimpleCalc;\n\t\t},\n\n\t\t/**\n\t\t * Get top coordinate by row index (order)\n\t\t * @param {number} index\n\t\t */\n\t\tgetRowTop: function(index){\n\t\t\tvar store = view.$config.rowStore;\n\t\t\tif(!store){\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\treturn index * this._getRowHeight();\n\t\t},\n\n\t\t/**\n\t\t * Get height of the item by item id\n\t\t * @param {*} itemId\n\t\t */\n\t\tgetItemHeight: function (itemId) {\n\t\t\treturn this._getRowHeight();\n\t\t},\n\n\t\t/**\n\t\t * Get total height of items\n\t\t */\n\t\tgetTotalHeight: function () {\n\t\t\tif(view.$config.rowStore){\n\t\t\t\tvar store = view.$config.rowStore;\n\t\t\t\treturn store.countVisible() * this._getRowHeight();\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Get item by top position\n\t\t * @param {*} top\n\t\t */\n\t\tgetItemIndexByTopPosition: function (top) {\n\t\t\tif(view.$config.rowStore){\n\t\t\t\treturn Math.floor(top / this._getRowHeight());\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t};\n}\n\nexport default createHelper;","const SENSITIVITY = 20;\nconst TIMEOUT = 50;\nconst SCROLLSTEP = 10;\n\nexport default class ScrollableGrid {\n\tpublic getCurrentX;\n\tprivate $gantt;\n\tprivate $grid;\n\tprivate _dnd;\n\tprivate _scrollView;\n\tprivate _scrollOrder: 0 | 1 | -1 = 0;\n\n\tconstructor(params) {\n\t\tconst {gantt, grid, dnd, getCurrentX} = params;\n\t\tthis.$gantt = gantt;\n\t\tthis.$grid = grid;\n\t\tthis._dnd = dnd;\n\t\tthis.getCurrentX = getCurrentX;\n\t\tthis._scrollView = this.$gantt.$ui.getView(this.$grid.$config.scrollX);\n\t\tthis.attachEvents();\n\t}\n\tattachEvents() {\n\t\tif (this.isScrollable()) {\n\t\t\tthis._dnd.attachEvent(\"onDragMove\", (obj, e) => {\n\t\t\t\tconst gridBoundingRect = this.$grid.$grid.getBoundingClientRect();\n\t\t\t\tconst maxLeft = gridBoundingRect.right;\n\t\t\t\tconst minLeft = gridBoundingRect.left;\n\t\t\t\tconst currentX = this.getCurrentX(e.clientX);\n\n\t\t\t\tif (currentX >= maxLeft - SENSITIVITY) {\n\t\t\t\t\tthis.autoscrollRight();\n\t\t\t\t\tthis.autoscrollStart();\n\t\t\t\t}\n\t\t\t\tif (currentX <= minLeft + SENSITIVITY) {\n\t\t\t\t\tthis.autoscrollLeft();\n\t\t\t\t\tthis.autoscrollStart();\n\t\t\t\t}\n\t\t\t\tif (currentX < maxLeft - SENSITIVITY && currentX > minLeft + SENSITIVITY) {\n\t\t\t\t\tthis.autoscrollStop();\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t});\n\t\t\tthis._dnd.attachEvent(\"onDragEnd\", () => {\n\t\t\t\tthis.autoscrollStop();\n\t\t\t});\n\t\t}\n\t}\n\tautoscrollStart() {\n\t\tif (this._scrollOrder === 0) {\n\t\t\treturn;\n\t\t}\n\t\tconst scrollStep = SCROLLSTEP * this._scrollOrder;\n\t\tconst scrollState = this._scrollView.getScrollState();\n\t\tthis._scrollView.scrollTo(scrollState.position + scrollStep);\n\t\tsetTimeout(() => { this.autoscrollStart(); }, TIMEOUT);\n\t}\n\tautoscrollRight() {\n\t\tthis._scrollOrder = 1;\n\t}\n\tautoscrollLeft() {\n\t\tthis._scrollOrder = -1;\n\t}\n\tautoscrollStop() {\n\t\tthis._scrollOrder = 0;\n\t}\n\tgetCorrection() {\n\t\tif (!this.isScrollable()) {\n\t\t\treturn 0;\n\t\t}\n\t\treturn this._scrollView.getScrollState().position;\n\t}\n\tisScrollable() {\n\t\treturn !!this.$grid.$config.scrollable;\n\t}\n}","import * as domHelpers from \"../../utils/dom_helpers\";\nimport ScrollableGrid from \"./scrollable_grid\";\n\nconst COLUMN_ID_ATTR_NAME = \"data-column-id\";\n\nexport class ColumnsGridDnd {\n\tprivate $gantt;\n\tprivate $grid;\n\tprivate _dragX;\n\tprivate _dnd;\n\tprivate _originAutoscroll;\n\tprivate _scrollableGrid: ScrollableGrid;\n\tprivate _draggedCell;\n\tprivate _targetMarker = null;\n\tprivate _gridConfig;\n\tconstructor(gantt, grid) {\n\t\tthis.$gantt = gantt;\n\t\tthis.$grid = grid;\n\t}\n\tinit() {\n\t\tconst DND = this.$gantt.$services.getService(\"dnd\");\n\t\tthis._dnd = new DND(this.$grid.$grid_scale, { updates_per_second: 60 });\n\t\tthis._scrollableGrid = new ScrollableGrid({\n\t\t\tgantt: this.$gantt,\n\t\t\tgrid: this.$grid,\n\t\t\tdnd: this._dnd,\n\t\t\tgetCurrentX: this.calculateCurrentPosition\n\t\t});\n\t\tthis.attachEvents();\n\t}\n\tattachEvents() {\n\t\tthis._dnd.attachEvent(\"onBeforeDragStart\", (obj, e) => {\n\t\t\tthis._draggedCell = this.$gantt.utils.dom.closest(e.target, \".gantt_grid_head_cell\");\n\t\t\tif(!this._draggedCell){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst columns = this.$grid.$getConfig().columns;\n\t\t\tconst columnName = this._draggedCell.getAttribute(COLUMN_ID_ATTR_NAME);\n\t\t\tlet draggedColumn;\n\t\t\tlet draggedIndex;\n\t\t\tcolumns.map(function(column, index){\n\t\t\t\tif(column.name === columnName){\n\t\t\t\t\tdraggedColumn = column;\n\t\t\t\t\tdraggedIndex = index;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (this.$grid.callEvent(\"onBeforeColumnDragStart\", [{ draggedColumn, draggedIndex}]) === false) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!this._draggedCell || !draggedColumn) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis._gridConfig = this.$grid.$getConfig();\n\t\t\tthis._originAutoscroll = this.$gantt.config.autoscroll;\n\t\t\tthis.$gantt.config.autoscroll = false;\n\t\t\treturn true;\n\t\t});\n\n\t\tthis._dnd.attachEvent(\"onAfterDragStart\", (obj, e) => {\n\t\t\tif (!this._draggedCell) {\n\t\t\t\treturn; // GS-1333: don't try to reorder a column when we resize it\n\t\t\t}\n\t\t\tthis._dnd.config.column = this._draggedCell.getAttribute(COLUMN_ID_ATTR_NAME);\n\t\t\tthis._dnd.config.marker.innerHTML = this._draggedCell.outerHTML;\n\t\t\tthis._dnd.config.marker.classList.add(\"gantt_column_drag_marker\");\n\t\t\tthis._dnd.config.marker.style.height = this._gridConfig.scale_height + \"px\";\n\t\t\tthis._dnd.config.marker.style.lineHeight = this._gridConfig.scale_height + \"px\";\n\t\t\tthis._draggedCell.classList.add(\"gantt_grid_head_cell_dragged\");\n\t\t});\n\n\t\tthis._dnd.attachEvent(\"onDragMove\", (obj, e) => {\n\t\t\tif(!this._draggedCell){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._dragX = e.clientX;\n\t\t\tconst x = this.calculateCurrentPosition(e.clientX);\n\t\t\tconst columnIndexes = this.findColumnsIndexes();\n\t\t\tthis.setMarkerPosition(x);\n\t\t\tthis.drawTargetMarker(columnIndexes);\n\t\t\treturn true;\n\t\t});\n\n\t\tthis._dnd.attachEvent(\"onDragEnd\", () => {\n\t\t\tif (!this._draggedCell) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst columnIndexes = this.findColumnsIndexes();\n\t\t\tconst targetIndex = columnIndexes.targetIndex;\n\t\t\tconst draggedIndex = columnIndexes.draggedIndex;\n\t\t\tconst columns = this.$grid.$getConfig().columns;\n\n\t\t\tconst draggedColumn = columns[draggedIndex];\n\t\t\tconst targetColumn = columns[targetIndex];\n\t\t\tif (this.$grid.callEvent(\"onColumnDragMove\", [{ draggedColumn, targetColumn, draggedIndex, targetIndex }]) === false) {\n\t\t\t\tthis.cleanTargetMarker();\n\t\t\t\tthis.$gantt.render();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.$gantt.config.autoscroll = this._originAutoscroll;\n\t\t\tthis._draggedCell.classList.remove(\"gantt_grid_head_cell_dragged\");\n\t\t\tthis.cleanTargetMarker();\n\t\t\tthis.reorderColumns();\n\t\t});\n\n\t}\n\treorderColumns() {\n\t\tconst { targetIndex, draggedIndex } = this.findColumnsIndexes();\n\n\t\tconst columns = this.$grid.$getConfig().columns;\n\t\tconst draggedColumn = columns[draggedIndex];\n\t\tconst targetColumn = columns[targetIndex];\n\n\t\tif (this.$grid.callEvent(\"onBeforeColumnReorder\", [{ draggedColumn, targetColumn, draggedIndex, targetIndex }]) === false) {\n\t\t\treturn;\n\t\t}\n\t\tif (targetIndex === draggedIndex) {\n\t\t\treturn;\n\t\t}\n\t\tcolumns.splice(draggedIndex, 1);\n\t\tcolumns.splice(targetIndex, 0, draggedColumn);\n\t\tthis.$gantt.render();\n\t\tthis.$grid.callEvent(\"onAfterColumnReorder\", [{ draggedColumn, targetColumn, draggedIndex, targetIndex }]);\n\t}\n\tfindColumnsIndexes() {\n\t\tconst draggedId = this._dnd.config.column;\n\t\tconst columns = this.$grid.$getConfig().columns;\n\t\tlet targetIndex: number;\n\t\tlet draggedIndex: number;\n\t\tlet xBefore: number;\n\t\tlet xAfter: number;\n\t\tconst currentColumn = { startX: 0, endX: 0 };\n\n\t\tlet start = 0;\n\t\tlet end = columns.length - 1;\n\t\tlet compare = (a, b) => a <= b;\n\t\tlet next = (index) => ++index;\n\t\tif (this.$gantt.config.rtl) {\n\t\t\tstart = columns.length - 1;\n\t\t\tend = 0;\n\t\t\tcompare = (a, b) => a >= b;\n\t\t\tnext = (index) => --index;\n\t\t}\n\n\t\tlet columnRelativePos: number;\n\n\t\tconst relativeX = this._dragX - this.$grid.$grid.getBoundingClientRect().left + this._scrollableGrid.getCorrection();\n\t\tfor (let i = start; compare(i, end); i = next(i)) {\n\t\t\tif (targetIndex !== undefined && draggedIndex !== undefined) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(!columns[i].hide) {\n\t\t\t\tcurrentColumn.startX = currentColumn.endX;\n\t\t\t\tcurrentColumn.endX += columns[i].width;\n\n\t\t\t\t// if drop on a column or drop after the last column\n\t\t\t\tif (relativeX >= currentColumn.startX && (relativeX <= currentColumn.endX || !compare(next(i), end))) {\n\t\t\t\t\ttargetIndex = i;\n\t\t\t\t\txBefore = currentColumn.startX;\n\t\t\t\t\txAfter = currentColumn.endX;\n\t\t\t\t\tcolumnRelativePos = (relativeX - currentColumn.startX) / (currentColumn.endX - currentColumn.startX);\n\t\t\t\t}\n\t\t\t\tif (draggedId === columns[i].name) {\n\t\t\t\t\tdraggedIndex = i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\ttargetIndex,\n\t\t\tdraggedIndex,\n\t\t\txBefore,\n\t\t\txAfter,\n\t\t\tcolumnRelativePos\n\t\t};\n\t}\n\tsetMarkerPosition(x: number, y: number = 10) {\n\t\tconst { marker } = this._dnd.config;\n\t\tconst gridOffset = this._dnd._obj.getBoundingClientRect();\n\t\tmarker.style.top = `${gridOffset.y + y}px`;\n\t\tmarker.style.left = `${x}px`;\n\t}\n\tcalculateCurrentPosition = (eventX: number) => {\n\t\tconst gridBoundingRect = this.$grid.$grid.getBoundingClientRect();\n\t\tconst maxLeft = gridBoundingRect.right;\n\t\tconst minLeft = gridBoundingRect.left;\n\t\tlet x = eventX;\n\t\tif (x > maxLeft) {\n\t\t\tx = maxLeft;\n\t\t}\n\t\tif (x < minLeft) {\n\t\t\tx = minLeft;\n\t\t}\n\t\treturn x;\n\t};\n\tdrawTargetMarker({ targetIndex, draggedIndex, xBefore, xAfter, columnRelativePos }) {\n\t\tif (!this._targetMarker) {\n\t\t\tthis._targetMarker = document.createElement(\"div\");\n\t\t\tdomHelpers.addClassName(this._targetMarker, \"gantt_grid_target_marker\");\n\t\t\tthis._targetMarker.style.display = \"none\";\n\t\t\tthis._targetMarker.style.height = `${this._gridConfig.scale_height}px`;\n\t\t}\n\n\t\t// marker can be detached after gantt.render\n\t\tif(!this._targetMarker.parentNode){\n\t\t\tthis.$grid.$grid_scale.appendChild(this._targetMarker);\n\t\t}\n\n\t\tlet nextPosition: number;\n\t\tif (targetIndex > draggedIndex) {\n\t\t\tnextPosition = xAfter;\n\t\t} else if (targetIndex < draggedIndex) {\n\t\t\tnextPosition = xBefore;\n\t\t} else {\n\t\t\tif(columnRelativePos > 0.5){\n\t\t\t\tnextPosition = xAfter;\n\t\t\t}else{\n\t\t\t\tnextPosition = xBefore;\n\t\t\t}\n\t\t}\n\n\t\tthis._targetMarker.style.left = `${nextPosition}px`;\n\t\tthis._targetMarker.style.display = \"block\";\n\t}\n\tcleanTargetMarker() {\n\t\tif (this._targetMarker && this._targetMarker.parentNode) {\n\t\t\tthis.$grid.$grid_scale.removeChild(this._targetMarker);\n\t\t}\n\t\tthis._targetMarker = null;\n\t}\n}","function create(gantt){\n\tvar events = [];\n\n\treturn {\n\t\tdelegate:function(event, className, handler, root) {\n\t\t\tevents.push([event, className, handler, root]);\n\n\t\t\tvar helper = gantt.$services.getService(\"mouseEvents\");\n\t\t\thelper.delegate(event, className, handler, root);\n\t\t},\n\t\tdestructor: function(){\n\t\t\tvar mouseEvents = gantt.$services.getService(\"mouseEvents\");\n\t\t\tfor(var i = 0; i < events.length; i++){\n\t\t\t\tvar h = events[i];\n\t\t\t\tmouseEvents.detach(h[0], h[1], h[2], h[3]);\n\t\t\t}\n\t\t\tevents = [];\n\t\t}\n\t};\n}\n\nexport default create;","import * as domHelpers from \"../utils/dom_helpers\";\nimport * as utils from \"../../../utils/utils\";\nimport eventable from \"../../../utils/eventable\";\nimport gridResize from \"./grid_resize\";\nimport topPositionMixin from \"../row_position_mixin\";\nimport rowResize from \"./task_grid_row_resize\";\n\nimport ColumnDnd from \"../plugins/column_grid_dnd\";\n\nimport mouseEventContainer from \"../mouse_event_container\";\n\nvar Grid = function (parent, config, factory, gantt) {\n\tthis.$config = utils.mixin({}, config || {});\n\tthis.$gantt = gantt;\n\tthis.$parent = parent;\n\teventable(this);\n\tthis.$state = {};\n\tutils.mixin(this, topPositionMixin(this));\n};\n\n\nGrid.prototype = {\n\tinit: function(container) {\n\t\tvar gantt = this.$gantt;\n\t\tvar gridAriaAttr = gantt._waiAria.gridAttrString();\n\t\tvar gridDataAriaAttr = gantt._waiAria.gridDataAttrString();\n\t\tvar _ganttConfig = this.$getConfig();\n\t\tvar reorderColumns = _ganttConfig.reorder_grid_columns || false;\n\t\tif (this.$config.reorder_grid_columns !== undefined) {\n\t\t\treorderColumns = this.$config.reorder_grid_columns;\n\t\t}\n\n\n\t\tcontainer.innerHTML = \"<div class='gantt_grid' style='height:inherit;width:inherit;' \" + gridAriaAttr + \"></div>\";\n\t\tthis.$grid = container.childNodes[0];\n\n\t\tthis.$grid.innerHTML = \"<div class='gantt_grid_scale' \" +\n\t\t\tgantt._waiAria.gridScaleRowAttrString() + \"></div><div class='gantt_grid_data' \" + gridDataAriaAttr + \"></div>\";\n\n\t\tthis.$grid_scale = this.$grid.childNodes[0];\n\t\tthis.$grid_data = this.$grid.childNodes[1];\n\n\t\tvar attr = _ganttConfig[this.$config.bind + \"_attribute\"];\n\t\tif (!attr && this.$config.bind) {\n\t\t\tattr = \"data-\" + this.$config.bind + \"-id\";\n\t\t}\n\t\tthis.$config.item_attribute = attr || null;\n\n\t\tif (!this.$config.layers) {\n\t\t\tvar layers = this._createLayerConfig();\n\t\t\tthis.$config.layers = layers;\n\t\t}\n\n\t\tvar resizer = gridResize(gantt, this);\n\t\tresizer.init();\n\t\tthis._renderHeaderResizers = resizer.doOnRender;\n\t\tthis._mouseDelegates = mouseEventContainer(gantt);\n\n\t\tvar resizerrow = rowResize(gantt, this);\n\t\tresizerrow.init();\n\n\t\tthis._addLayers(this.$gantt);\n\t\tthis._initEvents();\n\n\t\tif (reorderColumns) {\n\t\t\tthis._columnDND = new ColumnDnd(gantt, this);\n\t\t\tthis._columnDND.init();\n\t\t}\n\n\t\tthis.callEvent(\"onReady\", []);\n\t\t//this.refresh();\n\t},\n\n\t_validateColumnWidth: function (column, property) {\n\t\t// user can set {name:\"text\", width:\"200\",...} for some reason,\n\t\t// check and convert it to number when possible\n\t\tvar value = column[property];\n\t\tif (value && value != \"*\") {\n\t\t\tvar gantt = this.$gantt;\n\t\t\tvar numericWidth = value * 1;\n\t\t\tif (isNaN(numericWidth)) {\n\t\t\t\tgantt.assert(false, \"Wrong \" + property + \" value of column \" + column.name);\n\t\t\t} else {\n\t\t\t\tcolumn[property] = numericWidth;\n\t\t\t}\n\t\t}\n\t},\n\n\tsetSize: function (width, height) {\n\t\tthis.$config.width = this.$state.width = width;\n\t\tthis.$config.height = this.$state.height = height;\n\n\t\t// TODO: maybe inherit and override in a subclass instead of extending here\n\n\t\tvar columns = this.getGridColumns(),\n\t\t\tinnerWidth = 0;\n\n\t\tvar config = this.$getConfig();\n\t\tvar elasticColumns = config.grid_elastic_columns;\n\n\t\tfor (var i = 0, l = columns.length; i < l; i++) {\n\t\t\tthis._validateColumnWidth(columns[i], \"min_width\");\n\t\t\tthis._validateColumnWidth(columns[i], \"max_width\");\n\t\t\tthis._validateColumnWidth(columns[i], \"width\");\n\n\t\t\tinnerWidth += columns[i].width * 1;\n\t\t}\n\n\t\tvar outerWidth;\n\t\tif (isNaN(innerWidth) || !this.$config.scrollable) {\n\t\t\touterWidth = this._setColumnsWidth(width + 1);\n\t\t\tinnerWidth = outerWidth;\n\t\t}\n\n\t\tif(this.$config.scrollable && elasticColumns && !isNaN(innerWidth)){\n\t\t\t// GS-1352: Allow resizing the grid columns, then the grid width is increased\n\t\t\t// or keep the grid width, but don't allow column resize to affect the grid width\n\t\t\tlet columnProperty = \"width\";\n\t\t\tif (elasticColumns == \"min_width\"){\n\t\t\t\tcolumnProperty = \"min_width\";\n\t\t\t}\n\t\t\tlet newColumnWidth = 0;\n\t\t\tcolumns.forEach(function(col){\n\t\t\t\tnewColumnWidth += col[columnProperty] || config.min_grid_column_width;\n\t\t\t});\n\t\t\t//newColumnWidth--; // the total column width shouldn't match the outerWidth // GS-2190 reducing width seems to be not needed\n\t\t\tvar columnsWidth = Math.max(newColumnWidth, width);\n\t\t\tinnerWidth = this._setColumnsWidth(columnsWidth);\n\t\t\touterWidth = width;\n\t\t}\n\n\t\tif (this.$config.scrollable) {\n\t\t\tthis.$grid_scale.style.width = innerWidth + \"px\";\n\t\t\tthis.$grid_data.style.width = innerWidth + \"px\";\n\t\t} else {\n\t\t\tthis.$grid_scale.style.width = \"inherit\";\n\t\t\tthis.$grid_data.style.width = \"inherit\";\n\t\t}\n\t\tthis.$config.width -= 1;\n\n\t\tvar config = this.$getConfig();\n\t\tif (outerWidth !== width) {\n\t\t\tif(outerWidth !== undefined){\n\t\t\t\tconfig.grid_width = outerWidth;\n\t\t\t\tthis.$config.width = outerWidth - 1;\n\t\t\t}else{\n\t\t\t\tif(!isNaN(innerWidth)){\n\t\t\t\t\tthis._setColumnsWidth(innerWidth);\n\t\t\t\t\tconfig.grid_width = innerWidth;\n\t\t\t\t\tthis.$config.width = innerWidth - 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tvar dataHeight = Math.max(this.$state.height - config.scale_height, 0);\n\t\tthis.$grid_data.style.height = dataHeight + \"px\";\n\t\tthis.refresh();\n\t},\n\tgetSize: function () {\n\n\t\tvar config = this.$getConfig();\n\n\t\tvar store = this.$config.rowStore;\n\n\t\tvar contentHeight = store ? this.getTotalHeight() : 0,\n\t\t\tcontentWidth = this._getGridWidth();\n\n\t\tvar size = {\n\t\t\tx: this.$state.width,\n\t\t\ty: this.$state.height,\n\t\t\tcontentX: this.isVisible() ? contentWidth : 0,\n\t\t\tcontentY: this.isVisible() ? (config.scale_height + contentHeight) : 0,\n\t\t\tscrollHeight: this.isVisible() ? contentHeight : 0,\n\t\t\tscrollWidth: this.isVisible() ? contentWidth : 0\n\t\t};\n\n\t\treturn size;\n\t},\n\n\t_bindStore: function () {\n\t\tif (this.$config.bind){\n\t\t\tvar rowStore = this.$gantt.getDatastore(this.$config.bind);\n\t\t\tthis.$config.rowStore = rowStore;\n\t\t\tif(rowStore && !rowStore._gridCacheAttached){\n\t\t\t\tvar self = this;\n\t\t\t\trowStore._gridCacheAttached = rowStore.attachEvent(\"onBeforeFilter\", function(){\n\t\t\t\t\tself._resetTopPositionHeight();\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t},\n\t_unbindStore: function(){\n\t\tif (this.$config.bind){\n\t\t\tvar rowStore = this.$gantt.getDatastore(this.$config.bind);\n\t\t\tif(rowStore && rowStore._gridCacheAttached){\n\t\t\t\trowStore.detachEvent(rowStore._gridCacheAttached);\n\t\t\t\trowStore._gridCacheAttached = false;\n\t\t\t}\n\t\t}\n\t},\n\n\trefresh: function () {\n\t\tthis._bindStore();\n\n\t\tthis._resetTopPositionHeight();\n\t\tthis._resetHeight();\n\t\tthis._initSmartRenderingPlaceholder();\n\n\t\tthis._calculateGridWidth();\n\t\tthis._renderGridHeader();\n\t},\n\n\tgetViewPort: function(){\n\t\tvar scrollLeft = this.$config.scrollLeft || 0;\n\t\tvar scrollTop = this.$config.scrollTop || 0;\n\t\tvar height = this.$config.height || 0;\n\t\tvar width = this.$config.width || 0;\n\t\treturn {\n\t\t\ty: scrollTop,\n\t\t\ty_end: scrollTop + height,\n\t\t\tx: scrollLeft,\n\t\t\tx_end: scrollLeft + width,\n\t\t\theight: height,\n\t\t\twidth: width\n\t\t};\n\t},\n\n\tscrollTo: function (left, top) {\n\t\tif (!this.isVisible())\n\t\t\treturn;\n\n\t\tvar scrolled = false;\n\n\t\tthis.$config.scrollTop = this.$config.scrollTop || 0;\n\t\tthis.$config.scrollLeft = this.$config.scrollLeft || 0;\n\n\t\tif (left * 1 == left) {\n\t\t\tthis.$config.scrollLeft = this.$state.scrollLeft = this.$grid.scrollLeft = left;\n\t\t\tscrolled = true;\n\t\t}\n\n\t\t// var config = this.$getConfig();\n\t\tif (top * 1 == top) {\n\t\t\tthis.$config.scrollTop = this.$state.scrollTop = this.$grid_data.scrollTop = top;\n\t\t\tscrolled = true;\n\t\t}\n\n\t\tif(scrolled){\n\t\t\tthis.callEvent(\"onScroll\", [this.$config.scrollLeft, this.$config.scrollTop]);\n\t\t}\n\t},\n\n\tgetColumnIndex: function (name, excludeHidden) {\n\t\tvar columns = this.$getConfig().columns;\n\t\tvar hiddenIndexShift = 0;\n\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\t// GS-1257. If the cell is hidden, the target column index should be correct\n\t\t\tif (excludeHidden && columns[i].hide){\n\t\t\t\thiddenIndexShift++;\n\t\t\t}\n\t\t\tif (columns[i].name == name) {\n\t\t\t\treturn i - hiddenIndexShift;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t},\n\n\tgetColumn: function (name) {\n\t\tvar index = this.getColumnIndex(name);\n\t\tif (index === null) {\n\t\t\treturn null;\n\t\t}\n\t\treturn this.$getConfig().columns[index];\n\t},\n\n\tgetGridColumns: function () {\n\t\tvar config = this.$getConfig();\n\t\treturn config.columns.slice();\n\t},\n\tisVisible: function () {\n\t\tif (this.$parent && this.$parent.$config) {\n\t\t\treturn !this.$parent.$config.hidden;\n\t\t} else {\n\t\t\treturn this.$grid.offsetWidth;\n\t\t}\n\t},\n\n\t// getItemHeight: function () {\n\t// \tvar config = this.$getConfig();\n\t// \treturn config.row_height;\n\t// },\n\n\t_createLayerConfig: function () {\n\t\tvar gantt = this.$gantt;\n\t\tvar self = this;\n\t\tvar layers = [\n\t\t\t{\n\t\t\t\trenderer: gantt.$ui.layers.gridLine(),\n\t\t\t\tcontainer: this.$grid_data,\n\t\t\t\tfilter: [function () {\n\t\t\t\t\treturn self.isVisible();\n\t\t\t\t}]\n\t\t\t},\n\t\t\t{\n\t\t\t\trenderer: gantt.$ui.layers.gridTaskRowResizer(),\n\t\t\t\tcontainer: this.$grid_data,\n\t\t\t\tappend: true,\n\t\t\t\tfilter: [function () {\n\t\t\t\t\treturn gantt.config.resize_rows;\n\t\t\t\t}]\n\t\t\t}\n\t\t];\n\t\treturn layers;\n\t},\n\n\t_addLayers: function (gantt) {\n\t\tif (!this.$config.bind)\n\t\t\treturn;\n\n\t\tthis._taskLayers = [];\n\n\t\tvar self = this;\n\n\t\tvar layers = this.$gantt.$services.getService(\"layers\");\n\t\tvar taskRenderer = layers.getDataRender(this.$config.bind);\n\n\t\tif (!taskRenderer) {\n\t\t\ttaskRenderer = layers.createDataRender({\n\t\t\t\tname: this.$config.bind,\n\t\t\t\tdefaultContainer: function () { return self.$grid_data; }\n\t\t\t});\n\t\t}\n\n\t\tvar taskLayers = this.$config.layers;\n\t\tfor (var i = 0; taskLayers && i < taskLayers.length; i++) {\n\t\t\tvar layer = taskLayers[i];\n\t\t\tlayer.view = this;\n\n\t\t\tvar bar_layer = taskRenderer.addLayer(layer);\n\t\t\tthis._taskLayers.push(bar_layer);\n\t\t}\n\n\t\tthis._bindStore();\n\n\t\tthis._initSmartRenderingPlaceholder();\n\t},\n\n\t_refreshPlaceholderOnStoreUpdate: function (id) {\n\t\tvar config = this.$getConfig(),\n\t\t\tstore = this.$config.rowStore;\n\n\t\tif (!store || id !== null || !this.isVisible() || !config.smart_rendering) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar contentHeight;\n\t\tif (this.$config.scrollY) {\n\t\t\tvar scroll = this.$gantt.$ui.getView(this.$config.scrollY);\n\t\t\tif (scroll)\n\t\t\t\tcontentHeight = scroll.getScrollState().scrollSize;\n\t\t}\n\n\t\tif (!contentHeight) {\n\t\t\tcontentHeight = store ? this.getTotalHeight() : 0;\n\t\t}\n\n\t\tif (contentHeight) {\n\t\t\tif (this.$rowsPlaceholder && this.$rowsPlaceholder.parentNode) {\n\t\t\t\tthis.$rowsPlaceholder.parentNode.removeChild(this.$rowsPlaceholder);\n\t\t\t}\n\n\t\t\tvar placeholder = this.$rowsPlaceholder = document.createElement(\"div\");\n\t\t\tplaceholder.style.visibility = \"hidden\";\n\t\t\tplaceholder.style.height = contentHeight + \"px\";\n\t\t\tplaceholder.style.width = \"1px\";\n\t\t\tthis.$grid_data.appendChild(placeholder);\n\t\t}\n\t},\n\n\t_initSmartRenderingPlaceholder: function () {\n\t\tvar store = this.$config.rowStore;\n\t\tif (!store) {\n\t\t\treturn;\n\t\t} else {\n\t\t\tthis._initSmartRenderingPlaceholder = function () { };\n\t\t}\n\t\tthis._staticBgHandler = store.attachEvent(\"onStoreUpdated\", utils.bind(this._refreshPlaceholderOnStoreUpdate, this));\n\t},\n\n\t_initEvents: function () {\n\t\tvar gantt = this.$gantt;\n\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_close\", gantt.bind(function (e, id, trg) {\n\t\t\tvar store = this.$config.rowStore;\n\t\t\tif (!store) return true;\n\n\t\t\tvar target = domHelpers.locateAttribute(e, this.$config.item_attribute);\n\t\t\tif (target) {\n\t\t\t\tstore.close(target.getAttribute(this.$config.item_attribute));\n\n\t\t\t}\n\t\t\treturn false;\n\t\t}, this), this.$grid);\n\n\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_open\", gantt.bind(function (e, id, trg) {\n\t\t\tvar store = this.$config.rowStore;\n\t\t\tif (!store) return true;\n\n\t\t\tvar target = domHelpers.locateAttribute(e, this.$config.item_attribute);\n\t\t\tif (target) {\n\t\t\t\tstore.open(target.getAttribute(this.$config.item_attribute));\n\n\t\t\t}\n\t\t\treturn false;\n\t\t}, this), this.$grid);\n\t},\n\n\t_clearLayers: function (gantt) {\n\t\tvar layers = this.$gantt.$services.getService(\"layers\");\n\t\tvar taskRenderer = layers.getDataRender(this.$config.bind);\n\n\t\tif (this._taskLayers) {\n\t\t\tfor (var i = 0; i < this._taskLayers.length; i++) {\n\t\t\t\ttaskRenderer.removeLayer(this._taskLayers[i]);\n\t\t\t}\n\t\t}\n\n\t\tthis._taskLayers = [];\n\t},\n\n\t_getColumnWidth: function (column, config, width) {\n\t\tvar min_width = column.min_width || config.min_grid_column_width;\n\t\tvar new_width = Math.max(width, min_width || 10);\n\t\tif (column.max_width)\n\t\t\tnew_width = Math.min(new_width, column.max_width);\n\t\treturn new_width;\n\t},\n\t// set min width only if width < than config.min_grid_column_width\n\t_checkGridColumnMinWidthLimits: function (columns, config) {\n\t\tfor (var i = 0, l = columns.length; i < l; i++) {\n\t\t\tvar width = columns[i].width * 1;\n\t\t\tif (!columns[i].min_width && width < config.min_grid_column_width){\n\t\t\t\tcolumns[i].min_width = width;\n\t\t\t}\n\t\t}\n\t},\n\t// return min and max possible grid width according to restricts\n\t_getGridWidthLimits: function () {\n\t\tvar config = this.$getConfig(),\n\t\t\tcolumns = this.getGridColumns(),\n\t\t\tmin_limit = 0,\n\t\t\tmax_limit = 0;\n\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tmin_limit += columns[i].min_width ? columns[i].min_width : config.min_grid_column_width;\n\t\t\tif (max_limit !== undefined) {\n\t\t\t\tmax_limit = columns[i].max_width ? (max_limit + columns[i].max_width) : undefined;\n\t\t\t}\n\t\t}\n\t\tthis._checkGridColumnMinWidthLimits(columns, config); // FIX ME: should it be before calculating limits?\n\t\treturn [min_limit, max_limit];\n\t},\n\t// resize columns to get total newWidth, starting from columns[start_index]\n\t_setColumnsWidth: function (newWidth, start_index) {\n\t\tvar config = this.$getConfig();\n\t\tvar columns = this.getGridColumns(),\n\t\t\tcolumns_width = 0,\n\t\t\tfinal_width = newWidth;\n\n\t\tstart_index = !window.isNaN(start_index) ? start_index : -1;\n\n\t\tfor (var i = 0, l = columns.length; i < l; i++) {\n\t\t\tcolumns_width += columns[i].width * 1;\n\t\t}\n\n\t\tif (window.isNaN(columns_width)) {\n\t\t\tthis._calculateGridWidth();\n\t\t\tcolumns_width = 0;\n\t\t\tfor (var i = 0, l = columns.length; i < l; i++) {\n\t\t\t\tcolumns_width += columns[i].width * 1;\n\t\t\t}\n\t\t}\n\n\t\tvar extra_width = final_width - columns_width;\n\n\t\tvar start_width = 0;\n\t\tfor (var i = 0; i < start_index + 1; i++) {\n\t\t\tstart_width += columns[i].width;\n\t\t}\n\n\t\tcolumns_width -= start_width;\n\n\t\tfor (var i = start_index + 1; i < columns.length; i++) {\n\n\t\t\tvar col = columns[i];\n\t\t\tvar share = Math.round(extra_width * (col.width / columns_width));\n\n\t\t\t// columns have 2 additional restrict fields - min_width & max_width that are set by user\n\t\t\tif (extra_width < 0) {\n\t\t\t\tif (col.min_width && col.width + share < col.min_width)\n\t\t\t\t\tshare = col.min_width - col.width;\n\t\t\t\telse if (!col.min_width && config.min_grid_column_width && col.width + share < config.min_grid_column_width)\n\t\t\t\t\tshare = config.min_grid_column_width - col.width;\n\t\t\t} else if (col.max_width && col.width + share > col.max_width)\n\t\t\t\tshare = col.max_width - col.width;\n\n\t\t\tcolumns_width -= col.width;\n\t\t\tcol.width += share;\n\t\t\textra_width -= share;\n\n\t\t}\n\n\t\tvar iterator = extra_width > 0 ? 1 : -1;\n\t\twhile ((extra_width > 0 && iterator === 1) || (extra_width < 0 && iterator === -1)) {\n\t\t\tvar curExtra = extra_width;\n\t\t\tfor (i = start_index + 1; i < columns.length; i++) {\n\t\t\t\tvar new_width = columns[i].width + iterator;\n\n\t\t\t\tif (new_width == this._getColumnWidth(columns[i], config, new_width)) {\n\t\t\t\t\textra_width -= iterator;\n\t\t\t\t\tcolumns[i].width = new_width;\n\t\t\t\t}\n\n\t\t\t\tif (!extra_width)\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif (curExtra == extra_width)\n\t\t\t\tbreak;\n\t\t}\n\n\t\t// if impossible to resize the right-side columns, resize the start column\n\t\tif (extra_width && start_index > -1) {\n\t\t\tvar new_width = columns[start_index].width + extra_width;\n\t\t\tif (new_width == this._getColumnWidth(columns[start_index], config, new_width))\n\t\t\t\tcolumns[start_index].width = new_width;\n\t\t}\n\n\t\t//if (this.callEvent(\"onGridResizeEnd\", [config.grid_width, final_width]) === false)\n\t\t//\treturn;\n\n\t\treturn this._getColsTotalWidth();\n\t},\n\n\t_getColsTotalWidth: function () {\n\t\tvar columns = this.getGridColumns();\n\t\tvar cols_width = 0;\n\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tvar v = parseFloat(columns[i].width);\n\t\t\tif (window.isNaN(v)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tcols_width += v;\n\t\t}\n\t\treturn cols_width;\n\t},\n\t_calculateGridWidth: function () {\n\t\tvar config = this.$getConfig();\n\t\tvar columns = this.getGridColumns();\n\t\tvar cols_width = 0;\n\t\tvar unknown = [];\n\t\tvar width = [];\n\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tvar v = parseFloat(columns[i].width);\n\t\t\tif (window.isNaN(v)) {\n\t\t\t\tv = config.min_grid_column_width || 10;\n\t\t\t\tunknown.push(i);\n\t\t\t}\n\t\t\twidth[i] = v;\n\t\t\tcols_width += v;\n\t\t}\n\t\tvar gridWidth = this._getGridWidth() + 1;\n\t\tif (config.autofit || unknown.length) {\n\t\t\tvar diff = gridWidth - cols_width;\n\t\t\t// TODO: logic may be improved for proportional changing of width\n\n\t\t\t// autofit adjusts columns widths to the outer grid width\n\t\t\t// it doesn't makes sense if grid has inner scroll with elastic columns\n\t\t\tif (config.autofit && !config.grid_elastic_columns) {\n\t\t\t\t// delta must be added for all columns\n\t\t\t\tfor (var i = 0; i < width.length; i++) {\n\t\t\t\t\tvar delta = Math.round(diff / (width.length - i));\n\t\t\t\t\twidth[i] += delta;\n\t\t\t\t\tvar new_width = this._getColumnWidth(columns[i], config, width[i]);\n\n\t\t\t\t\tif (new_width != width[i]) {\n\t\t\t\t\t\tdelta = new_width - width[i];\n\t\t\t\t\t\twidth[i] = new_width;\n\t\t\t\t\t}\n\t\t\t\t\tdiff -= delta;\n\t\t\t\t}\n\t\t\t} else if (unknown.length) {\n\t\t\t\t// there are several columns with undefined width\n\t\t\t\tfor (var i = 0; i < unknown.length; i++) {\n\t\t\t\t\tvar delta = Math.round(diff / (unknown.length - i)); // no float values, just integer\n\t\t\t\t\tvar index = unknown[i];\n\t\t\t\t\twidth[index] += delta;\n\t\t\t\t\tvar new_width = this._getColumnWidth(columns[index], config, width[index]);\n\t\t\t\t\tif (new_width != width[index]) {\n\t\t\t\t\t\tdelta = new_width - width[index];\n\t\t\t\t\t\twidth[index] = new_width;\n\t\t\t\t\t}\n\t\t\t\t\tdiff -= delta;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (var i = 0; i < width.length; i++) {\n\t\t\t\tcolumns[i].width = width[i];\n\t\t\t}\n\t\t} else {\n\t\t\tvar changed = (gridWidth != cols_width);\n\t\t\tthis.$config.width = cols_width - 1;\n\t\t\tconfig.grid_width = cols_width;\n\t\t\tif (changed) {\n\t\t\t\tthis.$parent._setContentSize(this.$config.width, null);\n\t\t\t}\n\t\t}\n\n\t},\n\n\t_renderGridHeader: function () {\n\t\tvar gantt = this.$gantt;\n\t\tvar config = this.$getConfig();\n\t\tvar locale = this.$gantt.locale;\n\t\tvar templates = this.$gantt.templates;\n\n\t\tvar columns = this.getGridColumns();\n\t\tif (config.rtl) {\n\t\t\tcolumns = columns.reverse();\n\t\t}\n\t\tvar cells = [];\n\t\tvar width = 0,\n\t\t\tlabels = locale.labels;\n\n\t\tvar lineHeigth = config.scale_height - 1;\n\n\t\tconst renderableComponents = {};\n\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tvar last = i == columns.length - 1;\n\t\t\tvar col = columns[i];\n\n\t\t\t// ensure columns have non-empty names\n\t\t\tif (!col.name) {\n\t\t\t\tcol.name = gantt.uid() + \"\";\n\t\t\t}\n\n\t\t\tvar colWidth = col.width * 1;\n\n\t\t\tvar gridWidth = this._getGridWidth();\n\t\t\tif (last && gridWidth > width + colWidth)\n\t\t\t\tcol.width = colWidth = gridWidth - width;\n\t\t\twidth += colWidth;\n\t\t\tvar sort = (gantt._sort && col.name == gantt._sort.name) ? (`<div data-column-id=\"${col.name}\" class=\"gantt_sort gantt_${gantt._sort.direction}\"></div>`) : \"\";\n\t\t\tvar cssClass = [\"gantt_grid_head_cell\",\n\t\t\t\t(\"gantt_grid_head_\" + col.name),\n\t\t\t\t(last ? \"gantt_last_cell\" : \"\"),\n\t\t\t\ttemplates.grid_header_class(col.name, col)].join(\" \");\n\n\t\t\tvar style = \"width:\" + (colWidth - (last ? 1 : 0)) + \"px;\";\n\t\t\tvar label = (col.label || labels[\"column_\" + col.name] || labels[col.name]);\n\t\t\tif(typeof label === \"function\"){\n\t\t\t\tlabel = label.call(gantt, col.name, col);\n\t\t\t}\n\t\t\tlabel = label || \"\";\n\t\t\tlet componentLabel = false;\n\t\t\tif(gantt.config.external_render && gantt.config.external_render.isElement(label)){\n\t\t\t\tcomponentLabel = true;\n\t\t\t\trenderableComponents[col.name] = label;\n\t\t\t}\n\n\t\t\tvar ariaAttrs = gantt._waiAria.gridScaleCellAttrString(col, label);\n\n\t\t\tvar cell = \"<div class='\" + cssClass + \"' style='\" + style + \"' \" + ariaAttrs + \n\t\t\t\t\" data-column-id='\" + col.name + \"' column_id='\" + col.name + \"'\" +\n\t\t\t\t\" data-column-name='\" + col.name + \"' data-column-index='\" + i + \"'\" +\n\t\t\t\t\">\" + (!componentLabel ? label : \"<div data-component-container></div>\") + sort + \"</div>\";\n\t\t\tcells.push(cell);\n\t\t}\n\t\tthis.$grid_scale.style.height = (config.scale_height) + \"px\";\n\t\tthis.$grid_scale.style.lineHeight = lineHeigth + \"px\";\n\t\t//this.$grid_scale.style.width = \"inherit\";\n\t\tthis.$grid_scale.innerHTML = cells.join(\"\");\n\t\tfor(let i in renderableComponents){\n\t\t\tgantt.config.external_render.renderElement(renderableComponents[i], this.$grid_scale.querySelector(\"[data-column-id='\" + i + \"'] [data-component-container]\"));\n\t\t}\n\n\t\tif (this._renderHeaderResizers) {\n\t\t\tthis._renderHeaderResizers();\n\t\t}\n\t},\n\n\t_getGridWidth: function () {\n\t\t// TODO: refactor/remove/comment some of _getGridWidth/this.$config.width/this.$state.width, it's not clear what they do\n\t\treturn this.$config.width;\n\t},\n\n\tdestructor: function () {\n\t\tthis._clearLayers(this.$gantt);\n\t\tif (this._mouseDelegates) {\n\t\t\tthis._mouseDelegates.destructor();\n\t\t\tthis._mouseDelegates = null;\n\t\t}\n\t\tthis._unbindStore();\n\t\tthis.$grid = null;\n\t\tthis.$grid_scale = null;\n\t\tthis.$grid_data = null;\n\t\tthis.$gantt = null;\n\t\tif (this.$config.rowStore) {\n\t\t\tthis.$config.rowStore.detachEvent(this._staticBgHandler);\n\t\t\tthis.$config.rowStore = null;\n\t\t}\n\n\t\tthis.callEvent(\"onDestroy\", []);\n\t\tthis.detachAllEvents();\n\t}\n};\n\nexport default Grid;\n","import * as helpers from \"../../utils/helpers\";\n\nexport default function(gantt) {\n\tgantt.load = function(){\n\t\tthrow new Error(\"gantt.load() method is not available in the node.js, use gantt.parse() instead\");\n\t};\n\tgantt.parse = function (data, type) {\n\t\tthis.on_load({xmlDoc: {responseText: data}}, type);\n\t};\n\n\tgantt.serialize = function (type) {\n\t\ttype = type || \"json\";\n\t\treturn this[type].serialize();\n\t};\n\n\t/*\n\ttasks and relations\n\t{\n\tdata:[\n\t\t{\n\t\t\t\"id\":\"string\",\n\t\t\t\"text\":\"...\",\n\t\t\t\"start_date\":\"Date or string\",\n\t\t\t\"end_date\":\"Date or string\",\n\t\t\t\"duration\":\"number\",\n\t\t\t\"progress\":\"0..1\",\n\t\t\t\"parent_id\":\"string\",\n\t\t\t\"order\":\"number\"\n\t\t},...],\n\tlinks:[\n\t\t{\n\t\t\tid:\"string\",\n\t\t\tsource:\"string\",\n\t\t\ttarget:\"string\",\n\t\t\ttype:\"string\"\n\t\t},...],\n\tcollections:{\n\t\t\tcollectionName:[\n\t\t\t\t{key:, label:, optional:...},...\n\t\t\t],...\n\t\t}\n\t}\n\n\t* */\n\n\tgantt.on_load = function (resp, type) {\n\t\tif(resp.xmlDoc && resp.xmlDoc.status === 404){ // work if we don't have a file at current url\n\t\t\tthis.assert(false, \"Failed to load the data from <a href='\" + resp.xmlDoc.responseURL + \"' target='_blank'>\" \n\t\t\t\t+ resp.xmlDoc.responseURL + \"</a>, server returns 404\");\n\t\t\treturn;\n\t\t}\n\t\tif(gantt.$destroyed){\n\t\t\treturn;\n\t\t}\n\t\tthis.callEvent(\"onBeforeParse\", []);\n\t\tif (!type)\n\t\t\ttype = \"json\";\n\t\tthis.assert(this[type], \"Invalid data type:'\" + type + \"'\");\n\n\t\tvar raw = resp.xmlDoc.responseText;\n\n\t\tvar data = this[type].parse(raw, resp);\n\t\tthis._process_loading(data);\n\t};\n\n\tfunction attachAssignmentsToTasks(tasks, assignments) {\n\t\tconst assignmentsByTasks = {};\n\t\tassignments.forEach((a)=>{\n\t\t\tif(!assignmentsByTasks[a.task_id]) {\n\t\t\t\tassignmentsByTasks[a.task_id] = [];\n\t\t\t}\n\t\t\tassignmentsByTasks[a.task_id].push(a);\n\t\t});\n\t\ttasks.forEach((t) => {\n\t\t\tt[gantt.config.resource_property] = assignmentsByTasks[t.id] || [];\n\t\t});\t\n\t}\n\t\n\tgantt._process_loading = function (data) {\n\t\tif(data.collections)\n\t\t\tthis._load_collections(data.collections);\n\n\t\tif(data.resources && this.$data.resourcesStore){\n\t\t\tthis.$data.resourcesStore.parse(data.resources);\n\t\t}\n\t\tif(gantt.config.baselines && data.baselines && this.$data.baselineStore){\n\t\t\tthis.$data.baselineStore.parse(data.baselines);\n\t\t}\n\t\t\n\t\tconst tasks = data.data || data.tasks;\n\t\tif(data.assignments){\n\t\t\tattachAssignmentsToTasks(tasks, data.assignments);\n\t\t}\n\n\t\tthis.$data.tasksStore.parse(tasks);\n\t\tvar links = data.links || ((data.collections && data.collections.links) ? data.collections.links : []);\n\t\tthis.$data.linksStore.parse(links);\n\n\t\t//this._sync_links();\n\t\tthis.callEvent(\"onParse\", []);\n\t\tthis.render();\n\t};\n\n\tgantt._load_collections = function (collections) {\n\t\tvar collections_loaded = false;\n\t\tfor (var key in collections) {\n\t\t\tif (collections.hasOwnProperty(key)) {\n\t\t\t\tcollections_loaded = true;\n\t\t\t\tvar collection = collections[key];\n\t\t\t\t// GS-1728. Create an empty serverList if it doesn't exist\n\t\t\t\tthis.serverList[key] = this.serverList[key] || [];\n\t\t\t\tvar arr = this.serverList[key];\n\t\t\t\tif (!arr) continue;\n\t\t\t\tarr.splice(0, arr.length); //clear old options\n\t\t\t\tfor (var j = 0; j < collection.length; j++) {\n\t\t\t\t\tvar option = collection[j];\n\t\t\t\t\tvar obj = this.copy(option);\n\t\t\t\t\tobj.key = obj.value;// resulting option object\n\n\t\t\t\t\tfor (var option_key in option) {\n\t\t\t\t\t\tif (option.hasOwnProperty(option_key)) {\n\t\t\t\t\t\t\tif (option_key == \"value\" || option_key == \"label\")\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\tobj[option_key] = option[option_key]; // obj['value'] = option['value']\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tarr.push(obj);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (collections_loaded)\n\t\t\tthis.callEvent(\"onOptionsLoad\", []);\n\t};\n\n\tgantt.attachEvent(\"onBeforeTaskDisplay\", function (id, task) {\n\t\treturn !task.$ignore;\n\t});\n\n\tfunction jsonParseError(data){\n\t\tgantt.assert(false, \"Can't parse data: incorrect value of gantt.parse or gantt.load method. \"\n\t\t\t+ \"Actual argument value: \" + JSON.stringify(data));\n\t\tthrow new Error(\"Invalid argument for gantt.parse or gantt.load. An object or a JSON string of format https://docs.dhtmlx.com/gantt/desktop__supported_data_formats.html#json is expected. Actual argument value: \"\n\t\t\t+ JSON.stringify(data));\n\t}\n\n\tgantt.json = {\n\t\tparse: function (data) {\n\t\t\tif(!data){\n\t\t\t\tjsonParseError(data);\n\t\t\t}\n\n\t\t\tif (typeof data == \"string\") {\n\t\t\t\tif (typeof JSON != undefined){\n\t\t\t\t\ttry{\n\t\t\t\t\t\tdata = JSON.parse(data);\n\t\t\t\t\t}\n\t\t\t\t\tcatch(e) {\n\t\t\t\t\t\tjsonParseError(data);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tgantt.assert(false, \"JSON is not supported\");\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(!data.data && !data.tasks){\n\t\t\t\tjsonParseError(data);\n\t\t\t}\n\n\t\t\tif (data.dhx_security)\n\t\t\t\tgantt.security_key = data.dhx_security;\n\t\t\treturn data;\n\t\t},\n\t\tserializeTask: function (task) {\n\t\t\treturn this._copyObject(task);\n\t\t},\n\t\tserializeLink: function (link) {\n\t\t\treturn this._copyLink(link);\n\t\t},\n\t\t_copyLink: function (obj) {\n\t\t\tvar copy = {};\n\t\t\tfor (var key in obj)\n\t\t\t\tcopy[key] = obj[key];\n\t\t\treturn copy;\n\t\t},\n\t\t_copyObject: function (obj) {\n\t\t\tvar copy = {};\n\t\t\tfor (var key in obj) {\n\t\t\t\tif (key.charAt(0) == \"$\")\n\t\t\t\t\tcontinue;\n\t\t\t\tcopy[key] = obj[key];\n\n\t\t\t\tif (helpers.isDate(copy[key])) {\n\t\t\t\t\tcopy[key] = gantt.defined(gantt.templates.xml_format) ? gantt.templates.xml_format(copy[key]) : gantt.templates.format_date(copy[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn copy;\n\t\t},\n\t\tserialize: function () {\n\t\t\tvar tasks = [];\n\t\t\tvar links = [];\n\t\t\tlet baselines = [];\n\n\t\t\tgantt.eachTask(function (obj) {\n\t\t\t\tgantt.resetProjectDates(obj);\n\t\t\t\ttasks.push(this.serializeTask(obj));\n\t\t\t}, gantt.config.root_id, this);\n\n\t\t\tvar rawLinks = gantt.getLinks();\n\t\t\tfor (var i = 0; i < rawLinks.length; i++) {\n\t\t\t\tlinks.push(this.serializeLink(rawLinks[i]));\n\t\t\t}\n\n\t\t\tconst baselineStore = gantt.getDatastore(\"baselines\");\n\t\t\tbaselineStore.eachItem(function(baseline){\n\t\t\t\tconst baselineCopy = gantt.json.serializeTask(baseline);\n\t\t\t\tbaselines.push(baselineCopy);\n\t\t\t});\n\n\t\t\treturn {\n\t\t\t\tdata: tasks,\n\t\t\t\tlinks,\n\t\t\t\tbaselines\n\t\t\t};\n\t\t}\n\t};\n\n\t/*\n\t<data>\n\t\t<task id:\"some\" parent_id=\"0\" progress=\"0.5\">\n\t\t\t<text>My task 1</text>\n\t\t\t<start_date>16.08.2013</start_date>\n\t\t\t<end_date>22.08.2013</end_date>\n\t\t</task>\n\t\t<coll_options>\n\t\t\t<links>\n\t\t\t\t<link source='a1' target='b2' type='c3' />\n\t\t\t</links>\n\t\t</coll_options>\n\t</data>\n\t*/\n\n\tfunction xmlParseError(data){\n\t\tgantt.assert(false, \"Can't parse data: incorrect value of gantt.parse or gantt.load method. \"\n\t\t\t+ \"Actual argument value: \" + JSON.stringify(data));\n\t\tthrow new Error(\"Invalid argument for gantt.parse or gantt.load. An XML of format https://docs.dhtmlx.com/gantt/desktop__supported_data_formats.html#xmldhtmlxgantt20 is expected. Actual argument value: \"\n\t\t\t+ JSON.stringify(data));\n\t}\n\n\tgantt.xml = {\n\t\t_xmlNodeToJSON: function (node, attrs_only) {\n\t\t\tvar t = {};\n\t\t\tfor (var i = 0; i < node.attributes.length; i++)\n\t\t\t\tt[node.attributes[i].name] = node.attributes[i].value;\n\n\t\t\tif (!attrs_only) {\n\t\t\t\tfor (var i = 0; i < node.childNodes.length; i++) {\n\t\t\t\t\tvar child = node.childNodes[i];\n\t\t\t\t\tif (child.nodeType == 1)\n\t\t\t\t\t\tt[child.tagName] = child.firstChild ? child.firstChild.nodeValue : \"\";\n\t\t\t\t}\n\n\t\t\t\tif (!t.text) t.text = node.firstChild ? node.firstChild.nodeValue : \"\";\n\t\t\t}\n\n\t\t\treturn t;\n\t\t},\n\t\t_getCollections: function (loader) {\n\t\t\tvar collection = {};\n\t\t\tvar opts = gantt.ajax.xpath(\"//coll_options\", loader);\n\t\t\tfor (var i = 0; i < opts.length; i++) {\n\t\t\t\tvar bind = opts[i].getAttribute(\"for\");\n\t\t\t\tvar arr = collection[bind] = [];\n\t\t\t\tvar itms = gantt.ajax.xpath(\".//item\", opts[i]);\n\t\t\t\tfor (var j = 0; j < itms.length; j++) {\n\t\t\t\t\tvar itm = itms[j];\n\t\t\t\t\tvar attrs = itm.attributes;\n\t\t\t\t\tvar obj = {key: itms[j].getAttribute(\"value\"), label: itms[j].getAttribute(\"label\")};\n\t\t\t\t\tfor (var k = 0; k < attrs.length; k++) {\n\t\t\t\t\t\tvar attr = attrs[k];\n\t\t\t\t\t\tif (attr.nodeName == \"value\" || attr.nodeName == \"label\")\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\tobj[attr.nodeName] = attr.nodeValue;\n\t\t\t\t\t}\n\t\t\t\t\tarr.push(obj);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn collection;\n\t\t},\n\t\t_getXML: function (text, loader, toptag) {\n\t\t\ttoptag = toptag || \"data\";\n\t\t\tif (!loader.getXMLTopNode) {\n\t\t\t\tloader = gantt.ajax.parse(loader);\n\t\t\t}\n\n\t\t\tvar xml = gantt.ajax.xmltop(toptag, loader.xmlDoc);\n\t\t\tif (!xml || xml.tagName != toptag) {\n\t\t\t\txmlParseError(text);\n\t\t\t}\n\n\t\t\tvar skey = xml.getAttribute(\"dhx_security\");\n\t\t\tif (skey)\n\t\t\t\tgantt.security_key = skey;\n\n\t\t\treturn xml;\n\t\t},\n\t\tparse: function (text, loader) {\n\t\t\tloader = this._getXML(text, loader);\n\t\t\tvar data = {};\n\n\t\t\tvar evs = data.data = [];\n\t\t\tvar xml = gantt.ajax.xpath(\"//task\", loader);\n\n\t\t\tfor (var i = 0; i < xml.length; i++)\n\t\t\t\tevs[i] = this._xmlNodeToJSON(xml[i]);\n\n\t\t\tdata.collections = this._getCollections(loader);\n\t\t\treturn data;\n\t\t},\n\t\t_copyLink: function (obj) {\n\t\t\treturn \"<item id='\" + obj.id + \"' source='\" + obj.source + \"' target='\" + obj.target + \"' type='\" + obj.type + \"' />\";\n\t\t},\n\t\t_copyObject: function (obj) {\n\t\t\treturn \"<task id='\" + obj.id + \"' parent='\" + (obj.parent || \"\") + \"' start_date='\" + obj.start_date + \"' duration='\" + obj.duration + \"' open='\" + (!!obj.open) + \"' progress='\" + obj.progress + \"' end_date='\" + obj.end_date + \"'><![CDATA[\" + obj.text + \"]]></task>\";\n\t\t},\n\t\tserialize: function () {\n\t\t\tvar tasks = [];\n\t\t\tvar links = [];\n\n\t\t\tvar json = gantt.json.serialize();\n\t\t\tfor (var i = 0, len = json.data.length; i < len; i++) {\n\t\t\t\ttasks.push(this._copyObject(json.data[i]));\n\t\t\t}\n\t\t\tfor (var i = 0, len = json.links.length; i < len; i++) {\n\t\t\t\tlinks.push(this._copyLink(json.links[i]));\n\t\t\t}\n\t\t\treturn \"<data>\" + tasks.join(\"\") + \"<coll_options for='links'>\" + links.join(\"\") + \"</coll_options></data>\";\n\t\t}\n\t};\n\n\n\tgantt.oldxml = {\n\t\tparse: function (text, loader) {\n\t\t\tloader = gantt.xml._getXML(text, loader, \"projects\");\n\t\t\tvar data = {collections: {links: []}};\n\n\t\t\tvar evs = data.data = [];\n\t\t\tvar xml = gantt.ajax.xpath(\"//task\", loader);\n\n\t\t\tfor (var i = 0; i < xml.length; i++) {\n\t\t\t\tevs[i] = gantt.xml._xmlNodeToJSON(xml[i]);\n\t\t\t\tvar parent = xml[i].parentNode;\n\n\t\t\t\tif (parent.tagName == \"project\")\n\t\t\t\t\tevs[i].parent = \"project-\" + parent.getAttribute(\"id\");\n\t\t\t\telse\n\t\t\t\t\tevs[i].parent = parent.parentNode.getAttribute(\"id\");\n\t\t\t}\n\n\t\t\txml = gantt.ajax.xpath(\"//project\", loader);\n\t\t\tfor (var i = 0; i < xml.length; i++) {\n\t\t\t\tvar ev = gantt.xml._xmlNodeToJSON(xml[i], true);\n\t\t\t\tev.id = \"project-\" + ev.id;\n\t\t\t\tevs.push(ev);\n\t\t\t}\n\n\t\t\tfor (var i = 0; i < evs.length; i++) {\n\t\t\t\tvar ev = evs[i];\n\t\t\t\tev.start_date = ev.startdate || ev.est;\n\t\t\t\tev.end_date = ev.enddate;\n\t\t\t\tev.text = ev.name;\n\t\t\t\tev.duration = ev.duration / 8;\n\t\t\t\tev.open = 1;\n\t\t\t\tif (!ev.duration && !ev.end_date) ev.duration = 1;\n\t\t\t\tif (ev.predecessortasks)\n\t\t\t\t\tdata.collections.links.push({\n\t\t\t\t\t\ttarget: ev.id,\n\t\t\t\t\t\tsource: ev.predecessortasks,\n\t\t\t\t\t\ttype: gantt.config.links.finish_to_start\n\t\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn data;\n\t\t},\n\t\tserialize: function () {\n\t\t\tgantt.message(\"Serialization to 'old XML' is not implemented\");\n\t\t}\n\t};\n\n\tgantt.serverList = function (name, array) {\n\t\tif (array) {\n\t\t\tthis.serverList[name] = array.slice(0);\n\t\t} else if (!this.serverList[name]) {\n\t\t\tthis.serverList[name] = [];\n\t\t}\n\t\treturn this.serverList[name];\n\t};\n\n};","import * as utils from \"../../utils/utils\";\nimport * as helpers from \"../../utils/helpers\";\n\n\nfunction IsWorkTimeArgument(date, unit, task, id, calendar){\n\tthis.date = date;\n\tthis.unit = unit;\n\tthis.task = task;\n\tthis.id = id;\n\tthis.calendar = calendar;\n\treturn this;\n}\n\nfunction ClosestWorkTimeArgument(date, dir, unit, task, id, calendar){\n\tthis.date = date;\n\tthis.dir = dir;\n\tthis.unit = unit;\n\tthis.task = task;\n\tthis.id = id;\n\tthis.calendar = calendar;\n\treturn this;\n}\n\nfunction CalculateEndDateArgument(start_date, duration, unit, step, task, id, calendar){\n\tthis.start_date = start_date;\n\tthis.duration = duration;\n\tthis.unit = unit;\n\tthis.step = step;\n\tthis.task = task;\n\tthis.id = id;\n\tthis.calendar = calendar;\n\treturn this;\n}\n\nfunction GetDurationArgument(start, end, task, calendar) {\n\tthis.start_date = start;\n\tthis.end_date = end;\n\tthis.task = task;\n\tthis.calendar = calendar;\n\tthis.unit = null;\n\tthis.step = null;\n\treturn this;\n}\n\nvar calendarArgumentsHelper = function(gantt){\n\treturn {\n\t\tgetWorkHoursArguments: function () {\n\t\t\tvar config = arguments[0];\n\t\t\tif (helpers.isDate(config)) {\n\t\t\t\tconfig = {\n\t\t\t\t\tdate: config\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tconfig = utils.mixin({}, config);\n\t\t\t}\n\n\t\t\tif(!helpers.isValidDate(config.date)){\n\t\t\t\tgantt.assert(false, \"Invalid date argument for getWorkHours method\");\n\t\t\t\tthrow new Error(\"Invalid date argument for getWorkHours method\");\n\t\t\t}\n\n\t\t\treturn config;\n\t\t},\n\t\tsetWorkTimeArguments: function () {\n\t\t\treturn arguments[0];\n\t\t},\n\t\tunsetWorkTimeArguments: function () {\n\t\t\treturn arguments[0];\n\t\t},\n\t\tisWorkTimeArguments: function () {\n\t\t\tvar config = arguments[0];\n\t\t\tif(config instanceof IsWorkTimeArgument){\n\t\t\t\treturn config;\n\t\t\t}\n\n\t\t\tvar processedConfig;\n\t\t\tif (!config.date) {\n\t\t\t\t//IsWorkTimeArgument(date, unit, task, id, calendar)\n\t\t\t\tprocessedConfig = new IsWorkTimeArgument(arguments[0], arguments[1], arguments[2], null, arguments[3]);\n\t\t\t} else {\n\t\t\t\tprocessedConfig = new IsWorkTimeArgument(config.date, config.unit, config.task, null, config.calendar);\n\t\t\t}\n\n\t\t\tprocessedConfig.unit = processedConfig.unit || gantt.config.duration_unit;\n\n\t\t\tif(!helpers.isValidDate(processedConfig.date)){\n\t\t\t\tgantt.assert(false, \"Invalid date argument for isWorkTime method\");\n\t\t\t\tthrow new Error(\"Invalid date argument for isWorkTime method\");\n\t\t\t}\n\n\t\t\treturn processedConfig;\n\t\t},\n\t\tgetClosestWorkTimeArguments: function (arg) {\n\t\t\tvar config = arguments[0];\n\t\t\tif (config instanceof ClosestWorkTimeArgument)\n\t\t\t\treturn config;\n\n\t\t\tvar processedConfig;\n\t\t\tif (helpers.isDate(config)) {\n\t\t\t\tprocessedConfig = new ClosestWorkTimeArgument(config);\n\n\t\t\t} else {\n\t\t\t\tprocessedConfig = new ClosestWorkTimeArgument(\n\t\t\t\t\tconfig.date,\n\t\t\t\t\tconfig.dir,\n\t\t\t\t\tconfig.unit,\n\t\t\t\t\tconfig.task,\n\t\t\t\t\tnull,//config.id,\n\t\t\t\t\tconfig.calendar\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif(config.id){\n\t\t\t\tprocessedConfig.task = config;\n\t\t\t}\n\t\t\tprocessedConfig.dir = config.dir || 'any';\n\t\t\tprocessedConfig.unit = config.unit || gantt.config.duration_unit;\n\n\t\t\tif(!helpers.isValidDate(processedConfig.date)){\n\t\t\t\tgantt.assert(false, \"Invalid date argument for getClosestWorkTime method\");\n\t\t\t\tthrow new Error(\"Invalid date argument for getClosestWorkTime method\");\n\t\t\t}\n\t\t\treturn processedConfig;\n\t\t},\n\n\t\t_getStartEndConfig: function (param) {\n\t\t\tvar argumentType = GetDurationArgument;\n\t\t\tvar config;\n\t\t\tif (param instanceof argumentType)\n\t\t\t\treturn param;\n\n\t\t\tif (helpers.isDate(param)) {\n\t\t\t\tconfig = new argumentType(arguments[0], arguments[1], arguments[2], arguments[3]);\n\t\t\t} else {\n\t\t\t\tconfig = new argumentType(param.start_date, param.end_date, param.task);\n\t\t\t\tif (param.id !== null && param.id !== undefined) {\n\t\t\t\t\tconfig.task = param;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconfig.unit = config.unit || gantt.config.duration_unit;\n\t\t\tconfig.step = config.step || gantt.config.duration_step;\n\t\t\tconfig.start_date = config.start_date || config.start || config.date;\n\n\t\t\tif(!helpers.isValidDate(config.start_date)){\n\t\t\t\tgantt.assert(false, \"Invalid start_date argument for getDuration method\");\n\t\t\t\tthrow new Error(\"Invalid start_date argument for getDuration method\");\n\t\t\t}\n\n\t\t\tif(!helpers.isValidDate(config.end_date)){\n\t\t\t\tgantt.assert(false, \"Invalid end_date argument for getDuration method\");\n\t\t\t\tthrow new Error(\"Invalid end_date argument for getDuration method\");\n\t\t\t}\n\n\t\t\treturn config;\n\t\t},\n\n\t\tgetDurationArguments: function (start, end, unit, step) {\n\t\t\treturn this._getStartEndConfig.apply(this, arguments);\n\t\t},\n\n\t\thasDurationArguments: function (start, end, unit, step) {\n\t\t\treturn this._getStartEndConfig.apply(this, arguments);\n\t\t},\n\n\t\tcalculateEndDateArguments: function (start, duration, unit, step) {\n\t\t\tvar config = arguments[0];\n\t\t\tif (config instanceof CalculateEndDateArgument)\n\t\t\t\treturn config;\n\n\t\t\tvar processedConfig;\n\t\t\t//CalculateEndDateArgument(start_date, duration, unit, step, task, id, calendar)\n\t\t\tif (helpers.isDate(config)) {\n\t\t\t\tprocessedConfig = new CalculateEndDateArgument(\n\t\t\t\t\targuments[0],\n\t\t\t\t\targuments[1],\n\t\t\t\t\targuments[2],\n\t\t\t\t\tundefined,\n\t\t\t\t\targuments[3],\n\t\t\t\t\tundefined,\n\t\t\t\t\targuments[4]\n\t\t\t\t);\n\n\t\t\t} else {\n\t\t\t\tprocessedConfig = new CalculateEndDateArgument(\n\t\t\t\t\tconfig.start_date,\n\t\t\t\t\tconfig.duration,\n\t\t\t\t\tconfig.unit,\n\t\t\t\t\tconfig.step,\n\t\t\t\t\tconfig.task,\n\t\t\t\t\tnull,//config.id,\n\t\t\t\t\tconfig.calendar\n\t\t\t\t);\n\t\t\t}\n\t\t\tif(config.id !== null && config.id !== undefined){\n\t\t\t\tprocessedConfig.task = config;\n\n\t\t\t\t// received a task object as an argument\n\t\t\t\t// ignore 'unit' and 'step' properties in this case, since it's likely a part of data model of a task\n\t\t\t\tprocessedConfig.unit = null;\n\t\t\t\tprocessedConfig.step = null;\n\t\t\t}\n\n\t\t\tprocessedConfig.unit = processedConfig.unit || gantt.config.duration_unit;\n\t\t\tprocessedConfig.step = processedConfig.step || gantt.config.duration_step;\n\n\t\t\tif(!helpers.isValidDate(processedConfig.start_date)){\n\t\t\t\tgantt.assert(false, \"Invalid start_date argument for calculateEndDate method\");\n\t\t\t\tthrow new Error(\"Invalid start_date argument for calculateEndDate method\");\n\t\t\t}\n\n\t\t\treturn processedConfig;\n\t\t}\n\t};\n};\n\n\nexport default calendarArgumentsHelper;","import * as domHelpers from \"../utils/dom_helpers\";\n\nfunction createResizer(gantt, grid){\n// renders resize elements in the grid header\n\tvar _render_grid_header_resize = function () {\n\t\tvar columns = grid.getGridColumns(),\n\t\t\tconfig = grid.$getConfig(),\n\t\t\twidth = 0,\n\t\t\ttotalWidth = grid.$config.width,\n\t\t\tlineHeigth = config.scale_height;\n\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tvar col = columns[i];\n\n\t\t\tvar pos;\n\t\t\twidth += col.width;\n\t\t\tif(config.rtl){\n\t\t\t\tpos = totalWidth - width;\n\t\t\t}else{\n\t\t\t\tpos = width;\n\t\t\t}\n\n\t\t\t// GS-205. don't add resizer for the last column\n\t\t\tif (col.resize && i != columns.length - 1) {\n\t\t\t\tvar resize_el = document.createElement(\"div\");\n\t\t\t\tresize_el.className = \"gantt_grid_column_resize_wrap\";\n\t\t\t\tresize_el.style.top = \"0px\";\n\t\t\t\tresize_el.style.height = lineHeigth + \"px\";\n\t\t\t\tresize_el.innerHTML = \"<div class='gantt_grid_column_resize'></div>\";\n\t\t\t\tresize_el.setAttribute(config.grid_resizer_column_attribute, i);\n\t\t\t\tresize_el.setAttribute(\"column_index\", i); // hardcoded for backward compatibility\n\n\t\t\t\tgantt._waiAria.gridSeparatorAttr(resize_el);\n\n\t\t\t\tgrid.$grid_scale.appendChild(resize_el);\n\n\t\t\t\tresize_el.style.left = Math.max(0, pos) + \"px\";\n\t\t\t}\n\t\t}\n\t};\n\n\tvar _grid_resize = {\n\t\tcolumn_before_start: gantt.bind(function (dnd, obj, e) {\n\t\t\tvar config = grid.$getConfig();\n\n\t\t\tvar el = domHelpers.locateAttribute(e, config.grid_resizer_column_attribute);\n\t\t\tif (!el) return false;\n\n\t\t\tif (!domHelpers.closest(el,\".gantt_grid_column_resize_wrap\")) {\n\t\t\t\t// column resize should work only when we use the resizer\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tvar column_index = this.locate(e, config.grid_resizer_column_attribute),\n\t\t\t\tcolumn = grid.getGridColumns()[column_index];\n\n\t\t\tif (grid.callEvent(\"onColumnResizeStart\", [column_index, column]) === false)\n\t\t\t\treturn false;\n\t\t}, gantt),\n\n\t\tcolumn_after_start: gantt.bind(function (dnd, obj, e) {\n\t\t\tvar config = grid.$getConfig();\n\n\t\t\tvar column_index = this.locate(e, config.grid_resizer_column_attribute);\n\t\t\tdnd.config.marker.innerHTML = \"\";\n\t\t\tdnd.config.marker.className += \" gantt_grid_resize_area\";\n\t\t\tdnd.config.marker.style.height = grid.$grid.offsetHeight + \"px\";\n\t\t\tdnd.config.marker.style.top = \"0px\";\n\t\t\tdnd.config.drag_index = column_index;\n\n\t\t}, gantt),\n\n\t\tcolumn_drag_move: gantt.bind(function (dnd, obj, e) {\n\t\t\tvar config = grid.$getConfig();\n\n\t\t\tvar dd = dnd.config,\n\t\t\t\tcolumns = grid.getGridColumns();\n\t\t\tvar index = parseInt(dd.drag_index, 10);\n\t\t\tvar target_column = columns[index];\n\t\t\tvar\tpos = domHelpers.getNodePosition(grid.$grid_scale),\n\t\t\t\tpointerPosition = parseInt(dd.marker.style.left, 10),\n\t\t\t\tminPointerPosition = target_column.min_width ? target_column.min_width : config.min_grid_column_width,\n\t\t\t\tmaxPointerPosition = grid.$grid_data.offsetWidth,// - config.min_grid_column_width * (columns.length - dd.drag_index - 2),// 1 for current column + 1 for last column\n\t\t\t\tmarkerStartPosition = 0,\n\t\t\t\tmarker_width = 0;\n\n\t\t\t\n\t\t/*\tif(config.rtl){\n\t\t\t\tindex = columns.length - 1 - index;\n\t\t\t\tcolumns = columns.reverse();\n\t\t\t}*/\n\n\t\t\tif(!config.rtl){\n\t\t\t\tpointerPosition -= pos.x - 1;\n\t\t\t}else{\n\t\t\t\tpointerPosition = (pos.x + pos.width - 1) - pointerPosition;\n\t\t\t}\n\n\t\t\t//pointerPosition -= pos.x - 1;\n\t\t\tfor (var i = 0; i < index; i++) {\n\t\t\t\tminPointerPosition += columns[i].width;\n\t\t\t\tmarkerStartPosition += columns[i].width;\n\t\t\t}\n\n\t\t\tif (pointerPosition < minPointerPosition) {\n\t\t\t\tpointerPosition = minPointerPosition;\n\t\t\t}\n\n\t\t\tif (config.keep_grid_width) {\n\t\t\t\tvar limit_max = 0;\n\t\t\t\tfor (var i=index+1; i<columns.length; i++) {\n\t\t\t\t\tif (columns[i].min_width)\n\t\t\t\t\t\tmaxPointerPosition -= columns[i].min_width;\n\t\t\t\t\telse if (config.min_grid_column_width)\n\t\t\t\t\t\tmaxPointerPosition -= config.min_grid_column_width;\n\n\t\t\t\t\tif (columns[i].max_width && limit_max !== false)\n\t\t\t\t\t\tlimit_max += columns[i].max_width;\n\t\t\t\t\telse\n\t\t\t\t\t\tlimit_max = false;\t\t\t\t\t\n\t\t\t\t}\n\n\t\t\t\t// we have to restrict min value if only ALL right-side columns have 'max_width' field\n\t\t\t\tif (limit_max) {\n\t\t\t\t\tminPointerPosition = grid.$grid_data.offsetWidth - limit_max;\n\t\t\t\t}\n\t\t\t\tif (pointerPosition < minPointerPosition) {\n\t\t\t\t\tpointerPosition = minPointerPosition;\n\t\t\t\t}\n\n\t\t\t\tif (pointerPosition > maxPointerPosition) {\n\t\t\t\t\tpointerPosition = maxPointerPosition;\n\t\t\t\t}\n\t\t\t} else if (!grid.$config.scrollable) {\n\t\t\t\tvar targetWidth = pointerPosition;\n\t\t\t\tvar maxWidth = gantt.$container.offsetWidth;\n\n\t\t\t\tvar rightColumnsWidth = 0;\n\t\t\t\t// 25 is a scrollbar width. due to GS-1314 fix, the grid should always be visible\n\t\t\t\t// because of that, the internal grid width can be larger than the visible grid width\n\t\t\t\tif (grid.$grid_data.offsetWidth <= (maxWidth - 25)){\n\t\t\t\t\tfor (var i=index+1; i<columns.length; i++) {\n\t\t\t\t\t\trightColumnsWidth += columns[i].width;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// GS-627. When the grid is not scrollable and occupies almost all Gantt container's width\n\t\t\t\t\tfor (var i=index+1; i >= 0; i--) {\n\t\t\t\t\t\trightColumnsWidth += columns[i].width;\n\t\t\t\t\t}\n\t\t\t\t\trightColumnsWidth = maxWidth - rightColumnsWidth;\n\t\t\t\t}\n\n\t\t\t\t// in case if something went wrong in the previous part\n\t\t\t\tif (rightColumnsWidth > maxWidth){\n\t\t\t\t\trightColumnsWidth -= maxWidth;\n\t\t\t\t}\n\n\t\t\t\t// prevent grid from occupying the whole layout cell, which would disable the timeline\n\t\t\t\tvar parentLayout = grid.$parent.$parent;\n\t\t\t\tif(parentLayout && parentLayout.$config.mode == \"y\"){\n\t\t\t\t\tvar parentWidth = parentLayout.$lastSize.x;\n\t\t\t\t\tmaxWidth = Math.min(maxWidth, parentWidth - (parentLayout.$cells.length - 1));\n\t\t\t\t}\n\t\n\t\t\t\tif(targetWidth + rightColumnsWidth > maxWidth){\n\t\t\t\t\tpointerPosition = maxWidth - rightColumnsWidth;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tdd.left = pointerPosition - 1;// -1 for border\n\n\t\t\tmarker_width = Math.abs(pointerPosition - markerStartPosition);\n\n\t\t\t// column.max_width - maximum width of the column, user defined\n\t\t\tif (target_column.max_width && marker_width > target_column.max_width)\n\t\t\t\tmarker_width = target_column.max_width;\n\n\t\t\tif(config.rtl){\n\t\t\t\tmarkerStartPosition = (pos.width - markerStartPosition) + 2 - marker_width;\n\t\t\t}\n\t\t\tdd.marker.style.top = pos.y + \"px\";\n\t\t\tdd.marker.style.left = pos.x - 1 + markerStartPosition + \"px\";\n\t\t\tdd.marker.style.width = marker_width + \"px\";\n\n\t\t\tgrid.callEvent(\"onColumnResize\", [index, columns[index], marker_width - 1]);\n\t\t\treturn true;\n\t\t}, gantt),\n\n\t\tcolumn_drag_end: gantt.bind(function (dnd, obj, e) {\n\t\t\tvar config = grid.$getConfig();\n\t\t\tvar columns = grid.getGridColumns(),\n\t\t\t\tcolumns_width = 0,\n\t\t\t\tindex = parseInt(dnd.config.drag_index, 10),\n\t\t\t\ttarget_column = columns[index];\n\n\t\t\t// var colIndex = index;\n\t\t\t/*if(config.rtl){\n\t\t\t\tcolIndex = columns.length - 1 - target_index;\n\t\t\t\tcolumns = columns.reverse();\n\t\t\t}*/\n\n\t\t\tfor (var i = 0; i < index; i++) {\n\t\t\t\tcolumns_width += columns[i].width;\n\t\t\t}\n\n\t\t\tvar final_width = (target_column.min_width && (dnd.config.left - columns_width) < target_column.min_width) ?\n\t\t\t\ttarget_column.min_width : (dnd.config.left - columns_width);\n\n\t\t\tif (target_column.max_width && target_column.max_width < final_width) // TODO: probably can be omitted\n\t\t\t\tfinal_width = target_column.max_width;\n\n\t\t\tif (grid.callEvent(\"onColumnResizeEnd\", [index, target_column, final_width]) === false)\n\t\t\t\treturn;\n\n\t\t\tif (target_column.width == final_width)\n\t\t\t\treturn;\n\n\t\t\ttarget_column.width = final_width;\n\n\t\t\tif (config.keep_grid_width) {\n\t\t\t\tcolumns_width = config.grid_width;\n\t\t\t} else {\n\t\t\t\t// in other case we set a new grid width and call gantt render\n\t\t\t\tfor (var i = index, l = columns.length; i < l; i++) {\n\t\t\t\t\tcolumns_width += columns[i].width;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tgrid.callEvent(\"onColumnResizeComplete\", [columns, grid._setColumnsWidth(columns_width, index)]);\n\n\t\t\tif(!grid.$config.scrollable){\n\t\t\t\tgantt.$layout._syncCellSizes(grid.$config.group, {value: config.grid_width, isGravity: false});\n\t\t\t}\n\t\t\t//grid.callEvent(\"onColumnResizeComplete\", [columns, columns_width]);\n\n\t\t\tthis.render();\n\t\t}, gantt)\n\t};\n\n// calls the initialization of the D'n'D events for resize elements\n\tvar _init_resize = function () {\n\t\tvar DnD = gantt.$services.getService(\"dnd\");\n\n\t\tvar config = grid.$getConfig();\n\n\t\tvar dnd = new DnD(grid.$grid_scale, {updates_per_second: 60});\n\t\tif (gantt.defined(config.dnd_sensitivity))\n\t\t\tdnd.config.sensitivity = config.dnd_sensitivity;\n\n\t\tdnd.attachEvent(\"onBeforeDragStart\", function (obj, e) {\n\t\t\treturn _grid_resize.column_before_start(dnd, obj, e);\n\t\t});\n\t\tdnd.attachEvent(\"onAfterDragStart\", function (obj, e) {\n\t\t\treturn _grid_resize.column_after_start(dnd, obj, e);\n\t\t});\n\t\tdnd.attachEvent(\"onDragMove\", function (obj, e) {\n\t\t\treturn _grid_resize.column_drag_move(dnd, obj, e);\n\t\t});\n\t\tdnd.attachEvent(\"onDragEnd\", function (obj, e) {\n\t\t\treturn _grid_resize.column_drag_end(dnd, obj, e);\n\t\t});\n\n\t};\n\n\treturn {\n\t\tinit: _init_resize,\n\t\tdoOnRender: _render_grid_header_resize\n\t};\n}\n\nexport default createResizer;\n","import * as domHelpers from \"../utils/dom_helpers\";\n\nfunction createRowResizer(gantt, grid){\n\n\tvar _task_grid_row_resize = {\n\t\trow_before_start: gantt.bind(function (dnd, obj, e) {\n\t\t\tvar config = grid.$getConfig();\n\t\t\tvar store = grid.$config.rowStore;\n\n\t\t\tvar el = domHelpers.locateAttribute(e, config.task_grid_row_resizer_attribute);\n\t\t\tif (!el) return false;\n\n\t\t\tvar row_id = this.locate(e, config.task_grid_row_resizer_attribute),\n\t\t\t\trow = store.getItem(row_id);\n\n\t\t\tif (grid.callEvent(\"onBeforeRowResize\", [row]) === false)\n\t\t\t\treturn false;\n\t\t}, gantt),\n\n\t\trow_after_start: gantt.bind(function (dnd, obj, e) {\n\t\t\tvar config = grid.$getConfig();\n\n\t\t\tvar row_id = this.locate(e, config.task_grid_row_resizer_attribute);\n\t\t\tdnd.config.marker.innerHTML = \"\";\n\n\t\t\tdnd.config.marker.className += \" gantt_row_grid_resize_area\";\n\t\t\tdnd.config.marker.style.width = grid.$grid.offsetWidth + \"px\";\n\t\t\tdnd.config.drag_id = row_id;\n\n\t\t}, gantt),\n\n\t\trow_drag_move: gantt.bind(function (dnd, obj, e) {\n\t\t\tvar store = grid.$config.rowStore;\n\t\t\tvar config = grid.$getConfig();\n\t\t\tvar dd = dnd.config;\n\t\t\tvar id = dd.drag_id,\n\t\t\t\titemHeight = grid.getItemHeight(id),\n\t\t\t\titemTop = grid.getItemTop(id) - obj.scrollTop;\n\t\t\tvar pos = domHelpers.getNodePosition(grid.$grid_data),\n\t\t\t\tpointerPosition = parseInt(dd.marker.style.top, 10),\n\t\t\t\tmarkerStartPosition = itemTop + pos.y,\n\t\t\t\tmarker_height = 0,\n\t\t\t\tminPointerPosition = config.min_task_grid_row_height;\n\n\t\t\tmarker_height = pointerPosition - markerStartPosition;\n\t\t\tif(marker_height < minPointerPosition){\n\t\t\t\tmarker_height = minPointerPosition;\n\t\t\t}\n\n\t\t\tdd.marker.style.left = pos.x + \"px\";\n\t\t\tdd.marker.style.top = markerStartPosition - 1 + \"px\";\n\t\t\tdd.marker.style.height = Math.abs(marker_height) + 1 + \"px\";\n\n\t\t\tdd.marker_height = marker_height;\n\t\t\t\n\t\t\tgrid.callEvent(\"onRowResize\", [id, store.getItem(id), marker_height + itemHeight]);\n\t\t\treturn true;\n\t\t}, gantt),\n\n\t\trow_drag_end: gantt.bind(function (dnd, obj, e) {\n\t\t\tvar store = grid.$config.rowStore;\n\t\t\tvar dd = dnd.config;\n\t\t\tvar id = dd.drag_id,\n\t\t\t\titem = store.getItem(id),\n\t\t\t\toldItemHeight = grid.getItemHeight(id);\n\n\t\t\tvar finalHeight = dd.marker_height;\n\n\t\t\tif (grid.callEvent(\"onBeforeRowResizeEnd\", [id, item, finalHeight]) === false)\n\t\t\t\treturn;\n\n\t\t\tif (item.row_height == finalHeight)\n\t\t\t\treturn;\n\n\t\t\titem.row_height = finalHeight;\n\t\t\t// GS-2275: case for resizing resource grid row and others\n\t\t\tstore.updateItem(id);\n\t\t\tgrid.callEvent(\"onAfterRowResize\", [id, item, oldItemHeight, finalHeight]);\n\n\t\t\tthis.render();\n\t\t}, gantt)\n\t};\n\n\t// calls the initialization of the D'n'D events for resize elements\n\tvar _init_resize = function () {\n\n\t\tvar DnD = gantt.$services.getService(\"dnd\");\n\n\t\tvar config = grid.$getConfig();\n\n\t\tvar dnd = new DnD(grid.$grid_data, {updates_per_second: 60});\n\t\tif (gantt.defined(config.dnd_sensitivity))\n\t\t\tdnd.config.sensitivity = config.dnd_sensitivity;\n\n\t\tdnd.attachEvent(\"onBeforeDragStart\", function (obj, e) {\n\t\t\treturn _task_grid_row_resize.row_before_start(dnd, obj, e);\n\t\t});\n\t\tdnd.attachEvent(\"onAfterDragStart\", function (obj, e) {\n\t\t\treturn _task_grid_row_resize.row_after_start(dnd, obj, e);\n\t\t});\n\t\tdnd.attachEvent(\"onDragMove\", function (obj, e) {\n\t\t\treturn _task_grid_row_resize.row_drag_move(dnd, obj, e);\n\t\t});\n\t\tdnd.attachEvent(\"onDragEnd\", function (obj, e) {\n\t\t\treturn _task_grid_row_resize.row_drag_end(dnd, obj, e);\n\t\t});\n\n\t};\n\n\treturn {\n\t\tinit: _init_resize\n\t};\n}\n\nexport default createRowResizer;","import * as utils from \"../../../utils/utils\";\nfunction WorkTimeCalendarMerger(){\n}\n\nWorkTimeCalendarMerger.prototype = {\n\n\n\t/**\n\t * convert hours array items into objects, e.g. [8, 12, 17, 18] -> [{start: 8, end: 12}, {start:17, end:18}]\n\t * @param {Array} hoursArray\n\t */\n\t_getIntervals: function(hoursArray){\n\t\tvar result = [];\n\t\tfor(var i = 0; i < hoursArray.length; i += 2){\n\n\t\t\tresult.push({\n\t\t\t\tstart: hoursArray[i],\n\t\t\t\tend: hoursArray[i+1]\n\t\t\t});\n\t\t}\n\t\treturn result;\n\t},\n\n\t/**\n\t * Convert ranges config into hours array\n\t * [{start: 8, end: 12}, {start:17, end:18}] --> [8, 12, 17, 18]\n\t * @param {*} intervalsArray\n\t */\n\t_toHoursArray: function(intervalsArray){\n\t\tvar result = [];\n\n\t\tfunction toFixed(value){\n\t\t\tvar str = String(value);\n\t\t\tif(str.length < 2){\n\t\t\t\tstr = \"0\" + str;\n\t\t\t}\n\t\t\treturn str;\n\t\t}\n\t\tfunction formatHHMM(secondsValue){\n\t\t\tvar hours = Math.floor(secondsValue / (60*60));\n\t\t\tvar minutePart = secondsValue - hours * 60 * 60;\n\n\t\t\tvar minutes = Math.floor(minutePart / (60));\n\t\t\treturn hours + \":\" + toFixed(minutes);\n\t\t}\n\t\tfor(var i = 0; i < intervalsArray.length; i++){\n\t\t\tresult.push(\n\t\t\t\tformatHHMM(intervalsArray[i].start) +\n\t\t\t\t\"-\" +\n\t\t\t\tformatHHMM(intervalsArray[i].end)\n\t\t\t);\n\t\t}\n\t\treturn result;\n\t},\n\n\t/**\n\t * Build intersection of hour intervals. e.g.\n\t * first: [{start: 8, end: 12}, {start:13, end:18}]\n\t * second: [{start: 10, end: 15}]\n\t * result: [{start: 10, end: 12}, {start: 13, end: 15}]\n\t * @param {Array} first\n\t * @param {Array} second\n\t */\n\t_intersectHourRanges: function(first, second){\n\t\tvar result = [];\n\n\t\tvar baseArray = first.length > second.length ? first : second;\n\t\tvar overridesArray = first === baseArray ? second: first;\n\t\tbaseArray = baseArray.slice();\n\t\toverridesArray = overridesArray.slice();\n\n\t\tvar result = [];\n\t\tfor(var i = 0; i < baseArray.length; i++){\n\t\t\tvar base = baseArray[i];\n\n\t\t\tfor(var j = 0; j < overridesArray.length; j++){\n\t\t\t\tvar current = overridesArray[j];\n\t\t\t\tif(current.start < base.end && current.end > base.start){\n\t\t\t\t\tresult.push({\n\t\t\t\t\t\tstart: Math.max(base.start, current.start),\n\t\t\t\t\t\tend: Math.min(base.end, current.end)\n\t\t\t\t\t});\n\t\t\t\t\tif(base.end > current.end){\n\t\t\t\t\t\toverridesArray.splice(j, 1);\n\t\t\t\t\t\tj--;\n\t\t\t\t\t\ti--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t},\n\n\t/**\n\t * Reduce the number of ranges in config when possible,\n\t * joins ranges that can be merged\n\t * parts: [{start: 8, end: 12}, {start:12, end:13}, {start: 15, end: 17}]\n\t * result: [{start: 8, end: 13}, {start: 15, end: 17}]\n\t * @param {Array} parts\n\t */\n\t_mergeAdjacentIntervals: function(parts){\n\t\tvar result = parts.slice();\n\t\tresult.sort(function(a, b){\n\t\t\treturn a.start - b.start;\n\t\t});\n\t\tvar base = result[0];\n\t\tfor(var i = 1; i < result.length; i++){\n\t\t\tvar current = result[i];\n\t\t\tif(current.start <= base.end){\n\t\t\t\tif(current.end > base.end){\n\t\t\t\t\tbase.end = current.end;\n\t\t\t\t}\n\t\t\t\tresult.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}else{\n\t\t\t\tbase = current;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t},\n\n\t_mergeHoursConfig: function(firstHours, secondHours){\n\t\t//var firstIntervals = this._getIntervals(firstHours);\n\t\t//var secondIntervals = this._getIntervals(secondHours);\n\n\t\treturn this._mergeAdjacentIntervals(\n\t\t\tthis._intersectHourRanges(firstHours, secondHours)\n\t\t);\n\t},\n\n\tmerge: function(first, second){\n\t\tconst firstCalendar = utils.copy(first.getConfig());\n\t\tconst secondCalendar = utils.copy(second.getConfig());\n\n\t\tconst firstConfig = firstCalendar.parsed;\n\t\tconst secondConfig = secondCalendar.parsed;\n\n\t\t// GS-2101. The customWeeks config shouldn't have parsed values as we'll parse them later\n\t\tfirstConfig.customWeeks = firstCalendar.customWeeks;\n\t\tsecondConfig.customWeeks = secondCalendar.customWeeks;\n\n\t\tvar mergedSettings = {\n\t\t\thours: this._toHoursArray(this._mergeHoursConfig(firstConfig.hours, secondConfig.hours)),\n\t\t\tdates: {},\n\t\t\tcustomWeeks: {}\n\t\t};\n\n\t\tconst processCalendar = (config1, config2) => {\n\t\t\tfor (let i in config1.dates) {\n\t\t\t\tconst date1 = config1.dates[i];\n\t\n\t\t\t\t// dates contain day-of-week rules [0-7] and rules for specific dates (js date timestamps) - set false date rules initially\n\t\t\t\tif (+i > 1000) {\n\t\t\t\t\tmergedSettings.dates[i] = false;\n\t\t\t\t}\n\t\t\t\t// Check if the key exists in the fisrt calendar object\n\t\t\t\tfor (const key in config2.dates) {\n\t\t\t\t\tconst date2 = config2.dates[key];\n\t\n\t\t\t\t\t// Logical AND for week days\n\t\t\t\t\tif (key == i) {\n\t\t\t\t\t\tmergedSettings.dates[i] = !!(date1 && date2);\n\t\t\t\t\t}\n\t\n\t\t\t\t\t// Handle case where dates are arrays\n\t\t\t\t\tif (Array.isArray(date1)) {\n\t\t\t\t\t\tconst hours2 = Array.isArray(date2) ? date2 : config2.hours;\n\t\t\t\t\t\tmergedSettings.dates[i] = this._toHoursArray(this._mergeHoursConfig(date1, hours2));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\n\t\t// Check both calendars\n\t\tprocessCalendar(firstConfig, secondConfig);\n\t\tprocessCalendar(secondConfig, firstConfig);\n\n\t\t// transfer and overwrite custom week calendars\n\t\tif(firstConfig.customWeeks){\n\t\t\tfor(var i in firstConfig.customWeeks){\n\t\t\t\tmergedSettings.customWeeks[i] = firstConfig.customWeeks[i];\n\t\t\t}\n\t\t}\n\t\tif(secondConfig.customWeeks){\n\t\t\tfor(var i in secondConfig.customWeeks){\n\t\t\t\t// GS-2101. If both calendars have the same name for a period, we need to rename it\n\t\t\t\tif (mergedSettings.customWeeks[i]){\n\t\t\t\t\tmergedSettings.customWeeks[i + \"_second\"] = secondConfig.customWeeks[i];\n\t\t\t\t} else {\n\t\t\t\t\tmergedSettings.customWeeks[i] = secondConfig.customWeeks[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn mergedSettings;\n\n\t}\n\n};\n\nexport default WorkTimeCalendarMerger;","\n\nimport { IWorkUnitCache } from \"./workunit_cache_interface\";\n\nexport class WorkUnitsMapCache implements IWorkUnitCache {\n\tprivate _cache: Map<string, Array<Map<string, boolean>>>;\n\tconstructor() {\n\t\tthis.clear();\n\t}\n\n\tgetItem(unit: string, timestamp: string, value: Date): number|boolean {\n\t\tif (this._cache.has(unit)) {\n\t\t\tconst unitCache = this._cache.get(unit);\n\n\t\t\tconst subCache = unitCache[value.getFullYear()];\n\t\t\tif (subCache && subCache.has(timestamp)) {\n\t\t\t\treturn subCache.get(timestamp);\n\t\t\t}\n\t\t}\n\n\t\treturn -1;\n\t}\n\tsetItem(unit: string, timestamp: string, value: boolean, rawValue: Date): void {\n\t\tif (!unit || !timestamp) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst cache = this._cache;\n\t\tconst year = rawValue.getFullYear();\n\n\t\tlet unitCache;\n\t\tif (!cache.has(unit)) {\n\t\t\tunitCache = [];\n\t\t\tcache.set(unit, unitCache);\n\t\t} else {\n\t\t\tunitCache = cache.get(unit);\n\t\t}\n\n\t\tlet yearCache = unitCache[year];\n\t\tif(!yearCache){\n\t\t\tyearCache = unitCache[year] = new Map<string, boolean>();\n\t\t}\n\n\n\t\tyearCache.set(timestamp, value);\n\t}\n\tclear(): void{\n\t\tthis._cache = new Map<string, Array<Map<string, boolean>>>();\n\t}\n}","import { IWorkUnitCache } from \"./workunit_cache_interface\";\n\nexport class WorkUnitsObjectCache implements IWorkUnitCache {\n\tprivate _cache: any;\n\tconstructor() {\n\t\tthis.clear();\n\t}\n\n\tgetItem(unit: string, timestamp: string, value: Date): number|boolean {\n\t\tconst cache = this._cache;\n\t\tif (cache && cache[unit]) {\n\t\t\tconst units = cache[unit];\n\t\t\tif(units === undefined){\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\tconst subCache = units[value.getFullYear()];\n\t\t\tif (subCache && subCache[timestamp] !== undefined) {\n\t\t\t\treturn subCache[timestamp];\n\t\t\t}\n\t\t}\n\n\t\treturn -1;\n\t}\n\tsetItem(unit: string, timestamp: string, value: boolean, rawValue: Date): void {\n\t\tif (!unit || !timestamp) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst cache = this._cache;\n\n\t\tif (!cache) {\n\t\t\treturn;\n\t\t}\n\t\tif (!cache[unit]) {\n\t\t\tcache[unit] = [];\n\t\t}\n\t\tconst unitCache = cache[unit];\n\n\t\tconst year = rawValue.getFullYear();\n\t\tlet yearCache = unitCache[year];\n\t\tif(!yearCache){\n\t\t\tyearCache = unitCache[year] = {};\n\t\t}\n\t\tyearCache[timestamp] = value;\n\t}\n\tclear(): void{\n\t\tthis._cache = {};\n\t}\n}","\n\nexport class LargerUnitsCache {\n\tprivate _weekCache: Map<number, number>;\n\tprivate _monthCache: Map<number, number>;\n\tprivate _calendar: any;\n\tconstructor(calendar) {\n\t\tthis.clear();\n\t\tthis._calendar = calendar;\n\t}\n\n\tgetMinutesPerWeek = (weekStart: Date) => {\n\t\tconst key = weekStart.valueOf();\n\n\t\tif(this._weekCache.has(key)){\n\t\t\treturn this._weekCache.get(key);\n\t\t}\n\n\t\tconst calendar = this._calendar;\n\t\tconst gantt = this._calendar.$gantt;\n\n\t\tlet minutesPerWeek = 0;\n\t\tlet start = gantt.date.week_start(new Date(weekStart));\n\t\tfor(let i = 0; i < 7; i++){\n\t\t\tminutesPerWeek += calendar.getHoursPerDay(start) * 60;\n\t\t\tstart = gantt.date.add(start, 1, \"day\");\n\t\t}\n\n\t\tthis._weekCache.set(key, minutesPerWeek);\n\t\treturn minutesPerWeek;\n\t};\n\n\tgetMinutesPerMonth = (monthStart: Date) => {\n\t\tconst key = monthStart.valueOf();\n\n\t\tif(this._monthCache.has(key)){\n\t\t\treturn this._monthCache.get(key);\n\t\t}\n\n\t\tconst calendar = this._calendar;\n\t\tconst gantt = this._calendar.$gantt;\n\n\t\tlet minutesPerMonth = 0;\n\t\tlet start = gantt.date.week_start(new Date(monthStart));\n\t\tconst nextMonth = gantt.date.add(start, 1, \"month\").valueOf();\n\t\twhile(start.valueOf() < nextMonth){\n\t\t\tminutesPerMonth += calendar.getHoursPerDay(start) * 60;\n\t\t\tstart = gantt.date.add(start, 1, \"day\");\n\t\t}\n\n\t\tthis._monthCache.set(key, minutesPerMonth);\n\t\treturn minutesPerMonth;\n\t};\n\n\tclear = (): void => {\n\t\tthis._weekCache = new Map<number, number>();\n\t\tthis._monthCache = new Map<number, number>();\n\t};\n}","export class DateDurationCache  {\n\tprivate _cache: any;\n\tconstructor() {\n\t\tthis.clear();\n\t}\n\n\t_getCacheObject(startDate: Date, unit: string, step:number){\n\t\tconst cache = this._cache;\n\t\tif (!cache[unit]) {\n\t\t\tcache[unit] = [];\n\t\t}\n\t\tlet unitCache = cache[unit];\n\t\tif(!unitCache) {\n\t\t\tunitCache = cache[unit] = {};\n\t\t}\n\n\t\tlet stepCache = unitCache[step];\n\t\tif(!stepCache) {\n\t\t\tstepCache = unitCache[step] = {};\n\t\t}\n\n\t\tconst year = startDate.getFullYear();\n\t\tlet yearCache = stepCache[year];\n\t\tif(!yearCache){\n\t\t\tyearCache = stepCache[year] = {durations: {}, endDates: {}};\n\t\t}\n\n\t\treturn yearCache;\n\t}\n\t_endDateCacheKey(startDate: number, duration: number){\n\t\treturn String(startDate) + \"-\" + String(duration);\n\t}\n\t_durationCacheKey(startDate: number, endDate: number){\n\t\treturn String(startDate) + \"-\" + String(endDate);\n\t}\n\tgetEndDate(startDate: Date, duration: number, unit: string, step: number, compute: () => Date): number|null{\n\t\tconst cache = this._getCacheObject(startDate, unit, step);\n\n\t\tconst startDateTimestamp = startDate.valueOf();\n\t\tconst key = this._endDateCacheKey(startDateTimestamp, duration);\n\t\tlet endDate;\n\t\tif(cache.endDates[key] === undefined){\n\t\t\tconst result = compute();\n\t\t\tconst resultTimestamp = result.valueOf();\n\t\t\tcache.endDates[key] = resultTimestamp;\n\t\t\tcache.durations[this._durationCacheKey(startDateTimestamp, resultTimestamp)] = duration;\n\t\t\tendDate = result;\n\t\t}else{\n\t\t\tendDate = new Date(cache.endDates[key]);\n\t\t}\n\n\t\treturn endDate;\n\t}\n\n\tgetDuration(startDate: Date, endDate: Date, unit: string, step: number, compute: () => number): number|null{\n\t\tconst cache = this._getCacheObject(startDate, unit, step);\n\n\t\tconst startDateTimestamp = startDate.valueOf();\n\t\tconst endDateTimestamp = endDate.valueOf();\n\t\tconst key = this._durationCacheKey(startDateTimestamp, endDateTimestamp);\n\t\tlet duration;\n\t\tif(cache.durations[key] === undefined){\n\t\t\tconst result = compute();\n\t\t\tcache.durations[key] = result.valueOf();\n\n\t\t\t// can't populate end date due to logic of end date calculation, current unit tests capture it\n\t\t\t// cache.endDates[this._endDateCacheKey(startDateTimestamp, result)] = endDateTimestamp;\n\t\t\tduration = result;\n\t\t}else{\n\t\t\tduration = cache.durations[key];\n\t\t}\n\n\t\treturn duration;\n\t}\n\n\tclear(): void{\n\t\tthis._cache = {};\n\t}\n}","import {createCacheObject} from \"./work_unit_cache\";\nimport {LargerUnitsCache} from \"./work_unit_cache\";\nimport * as utils from \"../../../utils/utils\";\nimport {DateDurationCache} from \"./work_unit_cache/date_duration_cache\";\n\nfunction CalendarWorkTimeStrategy(gantt, argumentsHelper) {\n\tthis.argumentsHelper = argumentsHelper;\n\tthis.$gantt = gantt;\n\tthis._workingUnitsCache = createCacheObject();\n\tthis._largeUnitsCache = new LargerUnitsCache(this);\n\tthis._dateDurationCache = new DateDurationCache();\n\tthis._worktime = null;\n\tthis._cached_timestamps = {};\n\tthis._cached_timestamps_count = 0;\n}\n\nCalendarWorkTimeStrategy.prototype = {\n\tunits: [\n\t\t\"year\",\n\t\t\"month\",\n\t\t\"week\",\n\t\t\"day\",\n\t\t\"hour\",\n\t\t\"minute\"\n\t],\n\t_clearCaches: function(){\n\t\tthis._workingUnitsCache.clear();\n\t\tthis._largeUnitsCache.clear();\n\t\tthis._dateDurationCache.clear();\n\t},\n\t// cache previously calculated worktime\n\t_getUnitOrder: function (unit) {\n\t\tfor (var i = 0, len = this.units.length; i < len; i++) {\n\t\t\tif (this.units[i] == unit)\n\t\t\t\treturn i;\n\t\t}\n\t},\n\t_resetTimestampCache: function(){\n\t\tthis._cached_timestamps = {};\n\t\tthis._cached_timestamps_count = 0;\n\t},\n\t_timestamp: function (settings) {\n\t\t// minor optimization, store calculated timestamps to reduce computations\n\t\t// reset cache when number of keys exceeds large number where key lookup may became more expensive than the recalculation\n\t\tif(this._cached_timestamps_count > 1000000){\n\t\t\tthis._resetTimestampCache();\n\t\t}\n\n\t\tvar timestamp = null;\n\t\tif ((settings.day || settings.day === 0)) {\n\t\t\ttimestamp = settings.day;\n\t\t} else if (settings.date) {\n\t\t\tvar value = String(settings.date.valueOf());\n\t\t\tif(this._cached_timestamps[value]){\n\t\t\t\ttimestamp = this._cached_timestamps[value];\n\t\t\t}else{\n\t\t\t\t// store worktime datestamp in utc so it could be recognized in different timezones (e.g. opened locally and sent to the export service in different timezone)\n\t\t\t\ttimestamp = Date.UTC(settings.date.getFullYear(), settings.date.getMonth(), settings.date.getDate());\n\t\t\t\tthis._cached_timestamps[value] = timestamp;\n\t\t\t\tthis._cached_timestamps_count++;\n\t\t\t}\n\n\t\t}\n\t\treturn timestamp;\n\t},\n\t_checkIfWorkingUnit: function (date, unit) {\n\t\t// GS-596: If unit is larger than day or has a custom logic\n\t\tif (!this[\"_is_work_\" + unit]) {\n\t\t\tconst from = this.$gantt.date[`${unit}_start`](new Date(date));\n\t\t\tconst to = this.$gantt.date.add(from, 1, unit);\n\t\t\treturn this.hasDuration(from, to);\n\t\t}\n\t\treturn this[\"_is_work_\" + unit](date);\n\t},\n\t//checkings for particular time units\n\t//methods for month-year-week can be defined, otherwise always return 'true'\n\t_is_work_day: function (date) {\n\t\tvar val = this._getWorkHours(date);\n\n\t\tif (Array.isArray(val)) {\n\t\t\treturn val.length > 0;\n\t\t}\n\t\treturn false;\n\t},\n\t_is_work_hour: function (date) {\n\t\tvar hours = this._getWorkHours(date); // [{start: 8*60*60, end: 12*60*60}, {start: 13*60*60, end: 17*60*60}]\n\t\tvar value = date.getHours();\n\t\tfor (var i = 0; i < hours.length; i++) {\n\t\t\tif(value >= hours[i].startHour && value < hours[i].endHour){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t},\n\n\t_getTimeOfDayStamp: function(date, dayEnd) {\n\t\tvar hours = date.getHours();\n\t\tif(!date.getHours() && !date.getMinutes() && dayEnd){\n\t\t\thours = 24;\n\t\t}\n\t\treturn hours * 60 * 60 + date.getMinutes() * 60;\n\t},\n\n\t_is_work_minute: function(date){\n\t\tvar hours = this._getWorkHours(date); // [{start: 8*60*60, end: 12*60*60}, {start: 13*60*60, end: 17*60*60}]\n\t\tvar checkTime = this._getTimeOfDayStamp(date);\n\t\tfor (var i = 0; i < hours.length; i++) {\n\t\t\tif(checkTime >= hours[i].start && checkTime < hours[i].end){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t},\n\n\t_nextDate: function (start, unit, step) {\n\t\treturn this.$gantt.date.add(start, step, unit);\n\t},\n\t_getWorkUnitsBetweenGeneric: function (from, to, unit, step) {\n\t\tvar dateHelper = this.$gantt.date;\n\t\tvar start = new Date(from),\n\t\t\tend = new Date(to);\n\t\tstep = step || 1;\n\t\tvar units = 0;\n\n\n\t\tvar next = null;\n\t\tvar stepStart,\n\t\t\tstepEnd;\n\n\t\t// calculating decimal durations, i.e. 2016-09-20 00:05:00 - 2016-09-20 01:00:00 ~ 0.95 instead of 1\n\t\t// and also  2016-09-20 00:00:00 - 2016-09-20 00:05:00 ~ 0.05 instead of 1\n\t\t// durations must be rounded later\n\t\tvar checkFirst = false;\n\t\tstepStart = dateHelper[unit + \"_start\"](new Date(start));\n\t\tif (stepStart.valueOf() != start.valueOf()) {\n\t\t\tcheckFirst = true;\n\t\t}\n\t\tvar checkLast = false;\n\t\tstepEnd = dateHelper[unit + \"_start\"](new Date(to));\n\t\tif (stepEnd.valueOf() != to.valueOf()) {\n\t\t\tcheckLast = true;\n\t\t}\n\n\t\tvar isLastStep = false;\n\t\twhile (start.valueOf() < end.valueOf()) {\n\t\t\tnext = this._nextDate(start, unit, step);\n\t\t\tisLastStep = (next.valueOf() > end.valueOf());\n\n\t\t\tif (this._isWorkTime(start, unit)) {\n\t\t\t\tif (checkFirst || (checkLast && isLastStep)) {\n\t\t\t\t\tstepStart = dateHelper[unit + \"_start\"](new Date(start));\n\t\t\t\t\tstepEnd = dateHelper.add(stepStart, step, unit);\n\t\t\t\t}\n\n\t\t\t\tif (checkFirst) {\n\t\t\t\t\tcheckFirst = false;\n\t\t\t\t\tnext = this._nextDate(stepStart, unit, step);\n\t\t\t\t\tunits += ((stepEnd.valueOf() - start.valueOf()) / (stepEnd.valueOf() - stepStart.valueOf()));\n\t\t\t\t} else if (checkLast && isLastStep) {\n\t\t\t\t\tcheckLast = false;\n\t\t\t\t\tunits += ((end.valueOf() - start.valueOf()) / (stepEnd.valueOf() - stepStart.valueOf()));\n\n\t\t\t\t} else {\n\t\t\t\t\tunits++;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tvar unitOrder = this._getUnitOrder(unit);\n\t\t\t\tvar biggerTimeUnit = this.units[unitOrder - 1];\n\t\t\t\tif(biggerTimeUnit && !this._isWorkTime(start, biggerTimeUnit)){\n\t\t\t\t\tnext = this._getClosestWorkTimeFuture(start, biggerTimeUnit);\n\t\t\t\t}\n\t\t\t}\n\t\t\tstart = next;\n\t\t}\n\t\treturn units;\n\t},\n\n\t_getMinutesPerHour: function (date) {\n\t\tvar hourStart = this._getTimeOfDayStamp(date);\n\t\tvar hourEnd = this._getTimeOfDayStamp(this._nextDate(date, \"hour\", 1));\n\t\tif (hourEnd === 0){\n\t\t\thourEnd = 24 * 60 * 60;\n\t\t}\n\t\tvar worktimes = this._getWorkHours(date);\n\n\t\tfor(var i = 0; i < worktimes.length; i++){\n\t\t\tvar interval = worktimes[i];\n\t\t\tif(hourStart >= interval.start && hourEnd <= interval.end){\n\t\t\t\treturn 60;// hour inside a working interval, all hour is a work hour\n\t\t\t}else if(hourStart < interval.end && hourEnd > interval.start){\n\t\t\t\t// hour is partially work time\n\t\t\t\tvar duration = Math.min(hourEnd, interval.end) - Math.max(hourStart, interval.start);\n\t\t\t\treturn duration / 60;\n\t\t\t}\n\t\t}\n\n\t\treturn 0;\n\t},\n\n\t_getMinutesPerDay: function (date) {\n\t\tvar hours = this._getWorkHours(date);\n\t\tvar res = 0;\n\t\thours.forEach(function(interval){\n\t\t\tres+= interval.durationMinutes;\n\t\t});\n\t\treturn res;\n\t},\n\tgetHoursPerDay: function (date) {\n\t\tvar hours = this._getWorkHours(date);\n\t\tvar res = 0;\n\t\thours.forEach(function(interval){\n\t\t\tres+= interval.durationHours;\n\t\t});\n\t\treturn res;\n\t},\n\t_getWorkUnitsForRange: function (from, to, unit, step) {\n\t\tvar total = 0;\n\t\tvar start = new Date(from),\n\t\t\tend = new Date(to);\n\n\t\tvar getUnitsPerDay;\n\t\tif (unit == \"minute\") {\n\t\t\tgetUnitsPerDay = utils.bind(this._getMinutesPerDay, this);\n\t\t} else {\n\t\t\tgetUnitsPerDay = utils.bind(this.getHoursPerDay, this);\n\t\t}\n\n\t\twhile (start.valueOf() < end.valueOf()) {\n\t\t\tif(end - start > 1000*60*60*24*32 && start.getDate() === 0) {\n\t\t\t\tvar units = this._largeUnitsCache.getMinutesPerMonth(start);\n\t\t\t\tif(unit == \"hour\"){\n\t\t\t\t\tunits = units / 60;\n\t\t\t\t}\n\t\t\t\ttotal += units;\n\t\t\t\tstart = this.$gantt.date.add(start, 1, \"month\");\n\t\t\t\tcontinue;\n\t\t\t}else if(end - start > 1000*60*60*24*16) {\n\t\t\t\tvar weekStart = this.$gantt.date.week_start(new Date(start));\n\t\t\t\tif(start.valueOf() === weekStart.valueOf()){\n\t\t\t\t\tvar units = this._largeUnitsCache.getMinutesPerWeek(start);\n\t\t\t\t\tif(unit == \"hour\"){\n\t\t\t\t\t\tunits = units / 60;\n\t\t\t\t\t}\n\t\t\t\t\ttotal += units;\n\t\t\t\t\tstart = this.$gantt.date.add(start, 7, \"day\");\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t//\tif (this._isWorkTime(start, \"day\")) {\n\t\t\ttotal += getUnitsPerDay(start);\n\t\t//\t}\n\t\t\tstart = this._nextDate(start, \"day\", 1);\n\t\t}\n\n\t\treturn total / step;\n\t},\n\n\n\t_getMinutesBetweenSingleDay: function(from, to){\n\t\tvar range = this._getIntervalTimestamp(from, to);\n\t\tvar worktimes = this._getWorkHours(from);\n\t\tvar result = 0;\n\n\t\tfor(var i = 0; i < worktimes.length; i++){\n\t\t\tvar interval = worktimes[i];\n\t\t\tif(range.end >= interval.start && range.start <= interval.end){\n\t\t\t\tvar minuteFrom = Math.max(interval.start, range.start);\n\t\t\t\tvar minuteTo = Math.min(interval.end, range.end);\n\n\t\t\t\tresult += (minuteTo - minuteFrom) / 60;\n\t\t\t\trange.start = minuteTo;\n\t\t\t}\n\t\t}\n\n\t\treturn Math.floor(result);\n\t},\n\n\t_getMinutesBetween: function(from, to, unit, step){\n\t\tvar start = new Date(from),\n\t\t\tend = new Date(to);\n\t\tstep = step || 1;\n\n\t\tvar firstDayStart = new Date(start);\n\t\tvar firstDayEnd = this.$gantt.date.add(this.$gantt.date.day_start(new Date(start)), 1, \"day\");\n\n\t\tif (end.valueOf() <= firstDayEnd.valueOf()) {\n\t\t\treturn this._getMinutesBetweenSingleDay(from, to);\n\t\t} else {\n\n\t\t\tvar lastDayStart = this.$gantt.date.day_start(new Date(end));\n\t\t\tvar lastDayEnd = end;\n\n\t\t\tvar startPart = this._getMinutesBetweenSingleDay(firstDayStart, firstDayEnd);\n\t\t\tvar endPart = this._getMinutesBetweenSingleDay(lastDayStart, lastDayEnd);\n\n\t\t\tvar rangePart = this._getWorkUnitsForRange(firstDayEnd, lastDayStart, unit, step);\n\t\t\tvar total = startPart + rangePart + endPart;\n\n\t\t\treturn total;\n\t\t}\n\t},\n\t// optimized method for calculating work units duration of large time spans\n\t// implemented for hours and minutes units, bigger time units don't benefit from the optimization so much\n\t_getHoursBetween: function (from, to, unit, step) {\n\t\tvar start = new Date(from),\n\t\t\tend = new Date(to);\n\t\tstep = step || 1;\n\n\t\tvar firstDayStart = new Date(start);\n\t\tvar firstDayEnd = this.$gantt.date.add(this.$gantt.date.day_start(new Date(start)), 1, \"day\");\n\n\t\tif (end.valueOf() <= firstDayEnd.valueOf()) {\n\t\t\treturn Math.round(this._getMinutesBetweenSingleDay(from, to) / 60);\n\t\t} else {\n\n\t\t\tvar lastDayStart = this.$gantt.date.day_start(new Date(end));\n\t\t\tvar lastDayEnd = end;\n\n\t\t\tvar startPart = this._getMinutesBetweenSingleDay(firstDayStart, firstDayEnd, unit, step) / 60;\n\t\t\tvar endPart = this._getMinutesBetweenSingleDay(lastDayStart, lastDayEnd, unit, step) / 60;\n\n\t\t\tvar rangePart = this._getWorkUnitsForRange(firstDayEnd, lastDayStart, unit, step);\n\t\t\tvar total = startPart + rangePart + endPart;\n\n\t\t\treturn Math.round(total);\n\t\t}\n\t},\n\n\tgetConfig: function () {\n\t\treturn this._worktime;\n\t},\n\t_setConfig: function (settings) {\n\t\tthis._worktime = settings;\n\t\tthis._parseSettings();\n\t\tthis._clearCaches();\n\t},\n\t_parseSettings: function() {\n\t\tvar settings = this.getConfig();\n\t\tsettings.parsed = {\n\t\t\tdates: {},\n\t\t\thours: null,\n\t\t\thaveCustomWeeks: false,\n\t\t\tcustomWeeks: {},\n\t\t\tcustomWeeksRangeStart: null,\n\t\t\tcustomWeeksRangeEnd: null,\n\t\t\tcustomWeeksBoundaries: []\n\t\t};\n\n\t\tsettings.parsed.hours = this._parseHours(settings.hours);\n\t\tfor(var i in settings.dates){\n\t\t\tsettings.parsed.dates[i] = this._parseHours(settings.dates[i]);\n\t\t}\n\n\t\tif(settings.customWeeks) {\n\t\t\tvar minCustomRangeStart = null;\n\t\t\tvar maxCustomRangeEnd = null;\n\t\t\tfor(var i in settings.customWeeks){\n\t\t\t\tvar customTime = settings.customWeeks[i];\n\n\t\t\t\tif(customTime.from && customTime.to){\n\t\t\t\t\tvar rangeStart = customTime.from;\n\t\t\t\t\tvar rangeEnd = customTime.to;\n\t\t\t\t\tif(!minCustomRangeStart || minCustomRangeStart > rangeStart.valueOf()){\n\t\t\t\t\t\tminCustomRangeStart = rangeStart.valueOf();\n\t\t\t\t\t}\n\t\t\t\t\tif(!maxCustomRangeEnd || maxCustomRangeEnd < rangeEnd.valueOf()){\n\t\t\t\t\t\tmaxCustomRangeEnd = rangeEnd.valueOf();\n\t\t\t\t\t}\n\n\t\t\t\t\tsettings.parsed.customWeeksBoundaries.push({\n\t\t\t\t\t\tfrom: rangeStart.valueOf(),\n\t\t\t\t\t\tfromReadable: new Date(rangeStart),\n\t\t\t\t\t\tto: rangeEnd.valueOf(),\n\t\t\t\t\t\ttoReadable: new Date(rangeEnd),\n\t\t\t\t\t\tname: i\n\t\t\t\t\t});\n\n\t\t\t\t\tsettings.parsed.haveCustomWeeks = true;\n\t\t\t\t\tvar currentWeek = settings.parsed.customWeeks[i] = {\n\t\t\t\t\t\tfrom: customTime.from,\n\t\t\t\t\t\tto: customTime.to,\n\t\t\t\t\t\thours: this._parseHours(customTime.hours),\n\t\t\t\t\t\tdates: {}\n\t\t\t\t\t};\n\n\t\t\t\t\t// GS-1840. If there are no dates, it should work correctly with the weekdays\n\t\t\t\t\tif (customTime.days && !customTime.dates) {\n\t\t\t\t\t\tcustomTime.dates = customTime.dates || {};\n\t\t\t\t\t\tfor (var i = 0; i < customTime.days.length; i++) {\n\t\t\t\t\t\t\tcustomTime.dates[i] = customTime.days[i];\n\t\t\t\t\t\t\tif (!(customTime.days[i] instanceof Array)) {\n\t\t\t\t\t\t\t\tcustomTime.dates[i] = !!customTime.days[i];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdelete customTime.days;\n\t\t\t\t\t}\n\n\t\t\t\t\tfor(var d in customTime.dates){\n\t\t\t\t\t\tcurrentWeek.dates[d] = this._parseHours(customTime.dates[d]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsettings.parsed.customWeeksRangeStart = minCustomRangeStart;\n\t\t\tsettings.parsed.customWeeksRangeEnd = maxCustomRangeEnd;\n\n\t\t}\n\t},\n\n\t_tryChangeCalendarSettings: function (payload) {\n\t\tvar backup = JSON.stringify(this.getConfig());\n\t\tpayload();\n\t\tif (!this.hasWorkTime()) {\n\t\t//\tthis.$gantt.assert(false, \"Invalid calendar settings, no worktime available\");\n\t\t\tthis._setConfig(JSON.parse(backup));\n\t\t\tthis._clearCaches();\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\n\t},\n\n\t_arraysEqual: function(a, b){\n\t\tif (a === b) return true;\n\t\tif (!a || !b) return false;\n\t\tif (a.length != b.length) return false;\n\n\t\tfor (var i = 0; i < a.length; ++i) {\n\t\t\tif (a[i] !== b[i]) return false;\n\t\t}\n\t\treturn true;\n\t},\n\n\n\t_compareSettings: function (mySettings, thatSettings) {\n\t\tif (!this._arraysEqual(mySettings.hours, thatSettings.hours)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar myDays = Object.keys(mySettings.dates);\n\t\tvar otherDates = Object.keys(thatSettings.dates);\n\t\tmyDays.sort();\n\t\totherDates.sort();\n\n\t\tif (!this._arraysEqual(myDays, otherDates)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tfor(var i = 0; i < myDays.length; i++){\n\t\t\tvar timestamp = myDays[i];\n\t\t\tvar myHours = mySettings.dates[timestamp];\n\t\t\tvar otherHours = mySettings.dates[timestamp];\n\n\t\t\t// day settings not equal\n\t\t\tif(myHours !== otherHours &&\n\t\t\t\t// but still can be two arrays with the equivalent hour settings\n\t\t\t\t!(Array.isArray(myHours) && Array.isArray(otherHours) && this._arraysEqual(myHours, otherHours))\n\t\t\t\t){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t},\n\n\tequals: function (calendar) {\n\t\tif(!(calendar instanceof CalendarWorkTimeStrategy)){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar mySettings = this.getConfig();\n\t\tvar thatSettings = calendar.getConfig();\n\n\t\tif(!this._compareSettings(mySettings, thatSettings)){\n\t\t\treturn false;\n\t\t}\n\n\t\tif(mySettings.parsed.haveCustomWeeks && thatSettings.parsed.haveCustomWeeks){\n\t\t\tif(mySettings.parsed.customWeeksBoundaries.length != thatSettings.parsed.customWeeksBoundaries.length){\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tfor(var i in mySettings.parsed.customWeeks){\n\t\t\t\tvar myWeek = mySettings.parsed.customWeeks[i];\n\t\t\t\tvar thatWeek = thatSettings.parsed.customWeeks[i];\n\t\t\t\tif(!thatWeek){\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif(!this._compareSettings(myWeek, thatWeek)){\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}else if(mySettings.parse.haveCustomWeeks !== thatSettings.parsed.haveCustomWeeks){\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t},\n\n\tgetWorkHours: function () {\n\t\tvar config = this.argumentsHelper.getWorkHoursArguments.apply(this.argumentsHelper, arguments);\n\t\treturn this._getWorkHours(config.date, false);\n\t},\n\t_getWorkHours: function (date, parsed) {\n\t\tvar calendar = this.getConfig();\n\t\tif(parsed !== false){\n\t\t\tcalendar = calendar.parsed;\n\t\t}\n\n\t\tif(!date){\n\t\t\treturn calendar.hours;\n\t\t}\n\n\t\tconst dayStartDate = new Date(date.getFullYear(), date.getMonth(), date.getDate());\n\n\t\tvar dateValue = this._timestamp({date: dayStartDate});\n\n\t\tif(calendar.haveCustomWeeks){\n\t\t\tif(calendar.customWeeksRangeStart <= dateValue && calendar.customWeeksRangeEnd > dateValue){\n\t\t\t\tfor(var i = 0; i < calendar.customWeeksBoundaries.length; i++){\n\t\t\t\t\tif(calendar.customWeeksBoundaries[i].from <= dateValue && calendar.customWeeksBoundaries[i].to > dateValue){\n\t\t\t\t\t\tcalendar = calendar.customWeeks[calendar.customWeeksBoundaries[i].name];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tvar hours = true;\n\n\t\tif (calendar.dates[dateValue] !== undefined) {\n\t\t\thours = calendar.dates[dateValue];//custom day\n\t\t} else if (calendar.dates[date.getDay()] !== undefined) {\n\t\t\thours = calendar.dates[date.getDay()];//week day\n\t\t}\n\t\tif (hours === true) {\n\t\t\treturn calendar.hours;\n\t\t} else if (hours) {\n\t\t\treturn hours;\n\t\t}\n\t\treturn [];\n\t},\n\n\t_getIntervalTimestamp: function(from, to){\n\t\tvar res = {\n\t\t\tstart: 0,\n\t\t\tend: 0\n\t\t};\n\n\t\tres.start = from.getHours() * 60 * 60 + from.getMinutes() * 60 + from.getSeconds();\n\t\tvar endHours = to.getHours();\n\t\tif(!endHours && !to.getMinutes() && !to.getSeconds() && from.valueOf() < to.valueOf()){\n\t\t\tendHours = 24;\n\t\t}\n\t\tres.end = endHours * 60 * 60 + to.getMinutes() * 60 + to.getSeconds();\n\t\treturn res;\n\t},\n\n\t_parseHours: function(hours) {\n\t\tif(Array.isArray(hours)){\n\n\t\t\tvar timestampRanges = [];// worktime as seconds range\n\t\t\thours.forEach(function(hour){\n\t\t\t\tif(typeof hour === \"number\"){\n\t\t\t\t\ttimestampRanges.push(hour*60*60);\n\t\t\t\t}else if(typeof hour === \"string\") {\n\t\t\t\t\t// \"12-13\", or \"12:00-13:00\", or \"12:00:00-13:00:00\"\n\t\t\t\t\thour.split(\"-\").map(function(time){\n\t\t\t\t\t\treturn time.trim();\n\t\t\t\t\t}).forEach(function(part){\n\t\t\t\t\t\tvar parsed = part.split(\":\").map(function(time){\n\t\t\t\t\t\t\treturn time.trim();\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tvar value = parseInt(parsed[0]*60*60);\n\t\t\t\t\t\tif(parsed[1]){\n\t\t\t\t\t\t\tvalue += parseInt(parsed[1]*60);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(parsed[2]){\n\t\t\t\t\t\t\tvalue += parseInt(parsed[2]);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttimestampRanges.push(value);\n\t\t\t\t\t});\n\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tvar timerangeConfig = [];\n\t\t\tfor (var i = 0; i < timestampRanges.length; i += 2) {\n\t\t\t\tvar start = timestampRanges[i];\n\t\t\t\tvar end = timestampRanges[i + 1];\n\t\t\t\tvar duration = end - start;\n\n\t\t\t\ttimerangeConfig.push({\n\t\t\t\t\tstart: start,\n\t\t\t\t\tend: end,\n\t\t\t\t\tstartHour: Math.floor(start / (60*60)),\n\t\t\t\t\tstartMinute: Math.floor(start / (60)),\n\t\t\t\t\tendHour: Math.ceil(end / (60*60)),\n\t\t\t\t\tendMinute: Math.ceil(end / (60)),\n\t\t\t\t\tdurationSeconds: duration,\n\t\t\t\t\tdurationMinutes: duration/60,\n\t\t\t\t\tdurationHours: duration/(60 * 60)\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn timerangeConfig;\n\t\t} else {\n\t\t\treturn hours;\n\t\t}\n\t},\n\n\tsetWorkTime: function (settings) {\n\t\treturn this._tryChangeCalendarSettings(utils.bind(function () {\n\t\t\tvar hours = settings.hours !== undefined ? settings.hours : true;\n\t\t\tvar timestamp = this._timestamp(settings);\n\t\t\tvar calendarConfig = this.getConfig();\n\t\t\tif (timestamp !== null) {\n\t\t\t\tcalendarConfig.dates[timestamp] = hours;\n\t\t\t} else if(!settings.customWeeks) {\n\t\t\t\tcalendarConfig.hours = hours;\n\t\t\t}\n\n\t\t\tif(settings.customWeeks){\n\t\t\t\tif(!calendarConfig.customWeeks){\n\t\t\t\t\tcalendarConfig.customWeeks = {};\n\t\t\t\t}\n\t\t\t\t// GS-1867. allow setWorkTime to exclude dates in the customWeeks range\n\t\t\t\tif (typeof settings.customWeeks == \"string\"){\n\t\t\t\t\tif (timestamp !== null) {\n\t\t\t\t\t\tcalendarConfig.customWeeks[settings.customWeeks].dates[timestamp] = hours;\n\t\t\t\t\t} else if(!settings.customWeeks) {\n\t\t\t\t\t\tcalendarConfig.customWeeks[settings.customWeeks].hours = hours;\n\t\t\t\t\t}\t\t\n\t\t\t\t} else if (typeof settings.customWeeks === \"object\"\n\t\t\t\t&& settings.customWeeks.constructor === Object){\n\t\t\t\t\tfor(var i in settings.customWeeks){\n\t\t\t\t\t\tcalendarConfig.customWeeks[i] = settings.customWeeks[i];\n\t\t\t\t\t}\t\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._parseSettings();\n\t\t\tthis._clearCaches();\n\t\t}, this));\n\t},\n\n\tunsetWorkTime: function (settings) {\n\t\treturn this._tryChangeCalendarSettings(utils.bind(function () {\n\t\t\tif (!settings) {\n\t\t\t\tthis.reset_calendar();\n\t\t\t} else {\n\n\t\t\t\tvar timestamp = this._timestamp(settings);\n\n\t\t\t\tif (timestamp !== null) {\n\t\t\t\t\tdelete this.getConfig().dates[timestamp];\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Load updated settings and clear work units cache\n\t\t\tthis._parseSettings();\n\t\t\tthis._clearCaches();\n\t\t}, this));\n\t},\n\n\t_isWorkTime: function (date, unit) {\n\t\t// Check if this item has in the cache\n\n\t\tvar useCache = true;//unit === \"day\"; // use cache only for days. In case of hours/minutes cache size grows too large and the overhead exceeds the gains\n\t\tvar isWorkUnit = -1;\n\t\tvar dateKey = null;\n\n\t\tif(useCache){\n\t\t\t// use string keys\n\t\t\tdateKey = String(date.valueOf());\n\t\t\tisWorkUnit = this._workingUnitsCache.getItem(unit, dateKey, date);\n\t\t}\n\n\t\tif (isWorkUnit == -1) {\n\t\t\t// calculate if not cached\n\t\t\tisWorkUnit = this._checkIfWorkingUnit(date, unit);\n\t\t\tif(useCache){\n\t\t\t\tthis._workingUnitsCache.setItem(unit, dateKey, isWorkUnit, date);\n\t\t\t}\n\t\t}\n\n\t\treturn isWorkUnit;\n\t},\n\n\tisWorkTime: function () {\n\t\tvar config =  this.argumentsHelper.isWorkTimeArguments.apply( this.argumentsHelper, arguments);\n\t\treturn this._isWorkTime(config.date, config.unit);\n\t},\n\n\tcalculateDuration: function () {\n\t\tvar config =  this.argumentsHelper.getDurationArguments.apply( this.argumentsHelper, arguments);\n\n\t\tif (!config.unit) {\n\t\t\treturn false;\n\t\t}\n\t\t//return this._calculateDuration(config.start_date, config.end_date, config.unit, config.step);\n\n\t\tvar self = this;\n\t\treturn this._dateDurationCache.getDuration(config.start_date, config.end_date, config.unit, config.step, function(){ \n\t\t\treturn self._calculateDuration(config.start_date, config.end_date, config.unit, config.step);\n\t\t});\n\t},\n\n\t_calculateDuration: function (from, to, unit, step) {\n\t\tvar res = 0;\n\n\t\tvar sign = 1;\n\t\tif(from.valueOf() > to.valueOf()){\n\t\t\tvar tmp = to;\n\t\t\tto = from;\n\t\t\tfrom = tmp;\n\t\t\tsign = -1;\n\t\t}\n\n\t\tif (unit == \"hour\" && step == 1) {\n\t\t\tres = this._getHoursBetween(from, to, unit, step);\n\t\t} else if(unit == \"minute\" && step == 1){\n\t\t\t// quick calculation for minutes with 1 minute step\n\t\t\tres = this._getMinutesBetween(from, to, unit, step);\n\t\t} else {\n\t\t\tres = this._getWorkUnitsBetweenGeneric(from, to, unit, step);\n\t\t}\n\n\t\t// getWorkUnits.. returns decimal durations\n\t\treturn sign * Math.round(res);\n\t},\n\thasDuration: function () {\n\t\tvar config =  this.argumentsHelper.getDurationArguments.apply( this.argumentsHelper, arguments);\n\n\t\tvar from = config.start_date,\n\t\t\tto = config.end_date,\n\t\t\tunit = config.unit,\n\t\t\tstep = config.step;\n\n\t\tif (!unit) {\n\t\t\treturn false;\n\t\t}\n\t\tvar start = new Date(from),\n\t\t\tend = new Date(to);\n\t\tstep = step || 1;\n\n\t\twhile (start.valueOf() < end.valueOf()) {\n\t\t\tif (this._isWorkTime(start, unit))\n\t\t\t\treturn true;\n\t\t\tstart = this._nextDate(start, unit, step);\n\t\t}\n\t\treturn false;\n\t},\n\n\tcalculateEndDate: function () {\n\t\tvar config =  this.argumentsHelper.calculateEndDateArguments.apply( this.argumentsHelper, arguments);\n\n\t\tvar from = config.start_date,\n\t\t\tduration = config.duration,\n\t\t\tunit = config.unit,\n\t\t\tstep = config.step;\n\n\t\tif (!unit)\n\t\t\treturn false;\n\n\t\tvar mult = (config.duration >= 0) ? 1 : -1;\n\t\tduration = Math.abs(duration * 1);\n\t//\tvar endDate = this._calculateEndDate(from, duration, unit, step * mult);\n\t//\treturn endDate;\n\t\tvar self = this;\n\t\treturn this._dateDurationCache.getEndDate(from, duration, unit, step * mult, function(){ \n\t\t\treturn self._calculateEndDate(from, duration, unit, step * mult);\n\t\t} );\n\t},\n\n\t_calculateEndDate: function (from, duration, unit, step) {\n\t\tif (!unit)\n\t\t\treturn false;\n\n\t\tif (step == 1 && unit == \"minute\") {\n\t\t\treturn this._calculateMinuteEndDate(from, duration, step);\n\t\t} else if(step == -1 && unit == \"minute\") {\n\t\t\treturn this._subtractMinuteDate(from, duration, step);\n\t\t} else if (step == 1 && unit == \"hour\") {\n\t\t\treturn this._calculateHourEndDate(from, duration, step);\n\t\t} else {\n\t\t\tvar interval = this._addInterval(from, duration, unit, step, null);\n\t\t\treturn interval.end;\n\t\t}\n\t},\n\n\t_addInterval: function (start, duration, unit, step, stopAction) {\n\t\tvar added = 0;\n\t\tvar current = start;\n\t\tvar dstShift = false;\n\n\t\twhile (added < duration && !(stopAction && stopAction(current))) {\n\t\t\tvar next = this._nextDate(current, unit, step);\n\n\t\t\t// GS-1501. Correct hours after DST change\n\t\t\tif (unit == \"day\"){\n\t\t\t\tdstShift = dstShift || !current.getHours() && next.getHours();\n\n\t\t\t\tif (dstShift){\n\t\t\t\t\tnext.setHours(0);\n\t\t\t\t\tif (next.getHours()){\n\t\t\t\t\t// the day when the timezone is changed, try to correct hours next time\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdstShift = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar dateValue = new Date(next.valueOf() + 1);\n\t\t\tif (step > 0) {\n\t\t\t\tdateValue = new Date(next.valueOf() - 1);\n\t\t\t}\n\t\t\tvar workTimeCheck = this._isWorkTime(dateValue, unit);\n\n\t\t\tif (workTimeCheck && !dstShift) {\n\t\t\t\tadded++;\n\t\t\t}\n\t\t\tcurrent = next;\n\t\t}\n\t\treturn {\n\t\t\tend: current,\n\t\t\tstart: start,\n\t\t\tadded: added\n\t\t};\n\t},\n\n\t_addHoursUntilDayEnd: function(from, duration) {\n\t\tvar dayEnd = this.$gantt.date.add(this.$gantt.date.day_start(new Date(from)), 1, \"day\");\n\t\tvar added = 0;\n\t\tvar left = duration;\n\n\t\tvar range = this._getIntervalTimestamp(from, dayEnd);\n\t\tvar worktimes = this._getWorkHours(from);\n\t\tfor(var i = 0; i < worktimes.length && added < duration; i++){\n\t\t\tvar interval = worktimes[i];\n\t\t\tif(range.end >= interval.start && range.start <= interval.end){\n\t\t\t\tvar minuteFrom = Math.max(interval.start, range.start);\n\t\t\t\tvar minuteTo = Math.min(interval.end, range.end);\n\t\t\t\tvar rangeHours = (minuteTo - minuteFrom) / (60 * 60);\n\t\t\t\tif(rangeHours > left){\n\t\t\t\t\trangeHours = left;\n\t\t\t\t\tminuteTo = minuteFrom + (left * 60 * 60);\n\t\t\t\t}\n\n\t\t\t\tvar addHours = Math.round((minuteTo - minuteFrom) / (60 * 60));\n\t\t\t\tadded += addHours;\n\t\t\t\tleft -= addHours;\n\t\t\t\trange.start = minuteTo;\n\t\t\t}\n\t\t}\n\n\t\tvar intervalEnd = dayEnd;\n\t\tif(added === duration){\n\t\t\tintervalEnd = new Date(from.getFullYear(), from.getMonth(), from.getDate(), 0, 0, range.start);\n\t\t}\n\t\treturn {\n\t\t\tadded: added,\n\t\t\tend: intervalEnd\n\t\t};\n\t},\n\n\t_calculateHourEndDate: function (from, duration,  step) {\n\t\tvar start = new Date(from),\n\t\tadded = 0;\n\t\tstep = step || 1;\n\t\tduration = Math.abs(duration * 1);\n\n\t\tvar interval = this._addHoursUntilDayEnd(start, duration);\n\t\tadded = interval.added;\n\t\tstart = interval.end;\n\n\t\tvar durationLeft = duration - added;\n\n\t\tif (durationLeft) {\n\t\t\tvar current = start;\n\t\t\twhile (added < duration) {\n\t\t\t\tvar next = this._nextDate(current, \"day\", step);\n\t\t\t\t// reset to day start in case DST switch happens in the process\n\t\t\t\tnext.setHours(0);\n\t\t\t\tnext.setMinutes(0);\n\t\t\t\tnext.setSeconds(0);\n\n\t\t\t\tvar hoursPerDay = 0;\n\t\t\t\tif(step > 0){\n\t\t\t\t\thoursPerDay = this.getHoursPerDay(new Date(next.valueOf() - 1));\n\t\t\t\t}else{\n\t\t\t\t\thoursPerDay = this.getHoursPerDay(new Date(next.valueOf() + 1));\n\t\t\t\t}\n\n\t\t\t\tif (added + hoursPerDay >= duration) {\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\tadded += hoursPerDay;\n\t\t\t\t}\n\n\t\t\t\tcurrent = next;\n\t\t\t}\n\t\t\tstart = current;\n\t\t}\n\n\t\tif (added < duration) {\n\t\t\tvar durationLeft = duration - added;\n\t\t\tinterval = this._addHoursUntilDayEnd(start, durationLeft);\n\t\t\tstart = interval.end;\n\t\t}\n\n\t\treturn start;\n\t},\n\n\t_addMinutesUntilHourEnd: function(from, duration){\n\t\tif(from.getMinutes() === 0) {\n\t\t\t// already at hour end\n\t\t\treturn {\n\t\t\t\tadded: 0,\n\t\t\t\tend: new Date(from)\n\t\t\t};\n\t\t}\n\t\tvar hourEnd = this.$gantt.date.add(this.$gantt.date.hour_start(new Date(from)), 1, \"hour\");\n\t\tvar added = 0;\n\t\tvar left = duration;\n\n\t\tvar range = this._getIntervalTimestamp(from, hourEnd);\n\t\tvar worktimes = this._getWorkHours(from);\n\t\tfor(var i = 0; i < worktimes.length && added < duration; i++){\n\t\t\tvar interval = worktimes[i];\n\t\t\tif(range.end >= interval.start && range.start <= interval.end){\n\t\t\t\tvar minuteFrom = Math.max(interval.start, range.start);\n\t\t\t\tvar minuteTo = Math.min(interval.end, range.end);\n\t\t\t\tvar rangeMinutes = (minuteTo - minuteFrom) / 60;\n\t\t\t\tif(rangeMinutes > left){\n\t\t\t\t\trangeMinutes = left;\n\t\t\t\t\tminuteTo = minuteFrom + (left * 60);\n\t\t\t\t}\n\n\t\t\t\t// TODO: verify testcase https://dhtmlxsupport.teamwork.com/desk/tickets/9625700/messages\n\t\t\t\t/*if (rangeMinutes === 0) {\n\t\t\t\t\trangeMinutes = left;\n\t\t\t\t\tminuteTo = minuteFrom + (left * 60);\n\t\t\t\t}*/\n\n\t\t\t\tvar addMinutes = Math.round((minuteTo - minuteFrom) / 60);\n\t\t\t\tleft -= addMinutes;\n\t\t\t\tadded += addMinutes;\n\t\t\t\trange.start = minuteTo;\n\t\t\t}\n\t\t}\n\n\t\tvar intervalEnd = hourEnd;\n\t\tif(added === duration){\n\t\t\tintervalEnd = new Date(from.getFullYear(), from.getMonth(), from.getDate(), 0, 0, range.start);\n\t\t}\n\t\treturn {\n\t\t\tadded: added,\n\t\t\tend: intervalEnd\n\t\t};\n\t},\n\n\t_subtractMinutesUntilHourStart: function(from, duration){\n\t\tvar hourStart = this.$gantt.date.hour_start(new Date(from));\n\t\tvar added = 0;\n\t\tvar left = duration;\n\n\t\tvar hourStartTimestamp = hourStart.getHours() * 60 * 60 + hourStart.getMinutes() * 60 + hourStart.getSeconds();\n\t\tvar initialDateTimestamp = from.getHours() * 60 * 60 + from.getMinutes() * 60 + from.getSeconds();\n\n\t\tvar worktimes = this._getWorkHours(from);\n\t\tfor(var i = worktimes.length - 1; i >= 0 && added < duration; i--){\n\t\t\tvar interval = worktimes[i];\n\t\t\tif(initialDateTimestamp > interval.start && hourStartTimestamp <= interval.end){\n\t\t\t\tvar minuteFrom = Math.min(initialDateTimestamp, interval.end);\n\t\t\t\tvar minuteTo = Math.max(hourStartTimestamp, interval.start);\n\n\t\t\t//\tvar minuteFrom = Math.max(interval.start, currentHour.start);\n\t\t\t//\tvar minuteTo = Math.min(interval.end, currentHour.end);\n\t\t\t\tvar rangeMinutes = (minuteFrom - minuteTo) / 60;\n\t\t\t\tif(rangeMinutes > left){\n\t\t\t\t\trangeMinutes = left;\n\t\t\t\t\tminuteTo = minuteFrom - (left * 60);\n\t\t\t\t}\n\n\t\t\t\t// TODO: verify testcase https://dhtmlxsupport.teamwork.com/desk/tickets/9625700/messages\n\t\t\t\t/*if (rangeMinutes === 0) {\n\t\t\t\t\trangeMinutes = left;\n\t\t\t\t\tminuteTo = minuteFrom - (left * 60);\n\t\t\t\t}*/\n\n\t\t\t\tvar addMinutes = Math.abs(Math.round((minuteFrom - minuteTo) / 60));\n\t\t\t\tleft -= addMinutes;\n\t\t\t\tadded += addMinutes;\n\t\t\t\tinitialDateTimestamp = minuteTo;\n\t\t\t}\n\t\t}\n\n\t\tvar intervalEnd = hourStart;\n\t\tif(added === duration){\n\t\t\tintervalEnd = new Date(from.getFullYear(), from.getMonth(), from.getDate(), 0, 0, initialDateTimestamp);\n\t\t}\n\t\treturn {\n\t\t\tadded: added,\n\t\t\tend: intervalEnd\n\t\t};\n\t},\n\n\t_subtractMinuteDate: function (from, duration, step) {\n\t\t// var start = new Date(from),\n\t\t// GS-2683. We should start calculating minutes from the working time\n\t\tvar start = this.getClosestWorkTime({ date: from, dir: \"past\", unit: \"minute\" }),\n\t\t\tadded = 0;\n\t\tstep = step || -1;\n\t\tduration = Math.abs(duration * 1);\n\t\tduration = Math.round(duration);\n\n\t\tconst minutePrecision = this._isMinutePrecision(start);\n\n\t\tlet addedInterval = this._subtractMinutesUntilHourStart(start, duration);\n\t\tadded += addedInterval.added;\n\n\t\tstart = addedInterval.end;\n\n\t\tvar calculatedDay = 0;\n\t\tvar daySchedule = [];\n\t\tvar minutesInDay = 0;\n\n\t\twhile (added < duration) {\n\t\t\tvar dayStart = this.$gantt.date.day_start(new Date(start));\n\n\t\t\tvar iterateFromDayEnd = false;\n\t\t\tif(start.valueOf() === dayStart.valueOf()){\n\t\t\t\tdayStart = this.$gantt.date.add(dayStart, -1, \"day\");\n\t\t\t\titerateFromDayEnd = true;\n\t\t\t}\n\t\t\t//var dayStartTimestamp = this.$gantt.date.day_start(new Date(start)).valueOf();\n\t\t\tvar dayEnd = new Date(dayStart.getFullYear(), dayStart.getMonth(), dayStart.getDate(), 23, 59,59,999).valueOf();\n\n\t\t\tif(dayEnd !== calculatedDay){\n\t\t\t\tdaySchedule = this._getWorkHours(dayStart);\n\t\t\t\tminutesInDay = this._getMinutesPerDay(dayStart);\n\t\t\t\tcalculatedDay = dayEnd;\n\t\t\t}\n\n\t\t\tvar left = duration - added;\n\t\t\tvar timestamp = this._getTimeOfDayStamp(start, iterateFromDayEnd);\n\n\t\t\tif(!daySchedule.length || !minutesInDay){\n\t\t\t\tstart = this.$gantt.date.add(start, -1, \"day\");\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(daySchedule[daySchedule.length - 1].end <= timestamp){\n\t\t\t\tif(left > minutesInDay){\n\t\t\t\t\tadded += minutesInDay;\n\t\t\t\t\tstart = this.$gantt.date.add(start, -1, \"day\");\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar isWorkHour = false;\n\t\t\tvar workInterval = null;\n\t\t\tvar prevInterval = null;\n\t\t\tfor(var i = daySchedule.length - 1; i >= 0; i--){\n\t\t\t\tif(daySchedule[i].start < timestamp - 1 && daySchedule[i].end >= timestamp - 1){\n\t\t\t\t\tisWorkHour = true;\n\t\t\t\t\tworkInterval = daySchedule[i];\n\t\t\t\t\tprevInterval = daySchedule[i-1];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(isWorkHour){\n\n\t\t\t\t// we're at the end of worktime interval and subtracting more than the duration of the interval\n\t\t\t\t// -> subtract the duration of the interval and move to the start of the interval (we're moving from end)\n\t\t\t\tif(timestamp === workInterval.end && left >= workInterval.durationMinutes){\n\t\t\t\t\tadded += workInterval.durationMinutes;\n\t\t\t\t\tstart = this.$gantt.date.add(start, -workInterval.durationMinutes, \"minute\");\n\t\t\t\t} // worktime is set in whole hours (no intervals like 9:15-10:00)\n\t\t\t\t// the amount we need to subtract lies inside the interval\n\t\t\t\telse if(!minutePrecision && left <= (timestamp/60 - workInterval.startMinute)){\n\t\t\t\t\tadded += left;\n\t\t\t\t\tstart = this.$gantt.date.add(start, -left, \"minute\");\n\t\t\t\t}else if (minutePrecision){\n\t\t\t\t\t// GS-2129. If the working time is set in minutes, we accumulate the working time in minutes from right to left\n\t\t\t\t\t\n\t\t\t\t\t// duration we need to subtract lies completely inside the work interval\n\t\t\t\t\tif(left <= (timestamp/60 - workInterval.startMinute)){\n\t\t\t\t\t\tadded += left;\n\t\t\t\t\t\tstart = this.$gantt.date.add(start, -left, \"minute\");\n\t\t\t\t\t}else {\n\t\t\t\t\t\t// we need to go trough multiple work intervals to subtract needed time\n\t\t\t\t\t\tadded += (timestamp/60 - workInterval.startMinute);\n\t\t\t\t\t\tif(prevInterval){\n\t\t\t\t\t\t\tstart = new Date(start.getFullYear(), start.getMonth(), start.getDate(), 0, 0, prevInterval.end);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tstart = this.$gantt.date.day_start(start);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\n\t\t\t\t}else{\n\t\t\t\t\tvar minutesInHour = this._getMinutesPerHour(start);\n\t\t\t\t\tif(minutesInHour <= left){\n\t\t\t\t\t\tadded += minutesInHour;\n\t\t\t\t\t\tstart = this._nextDate(start, \"hour\", step);\n\t\t\t\t\t}else{\n\t\t\t\t\t\taddedInterval = this._subtractMinutesUntilHourStart(start, left);\n\t\t\t\t\t\tadded += addedInterval.added;\n\t\t\t\t\t\tstart = addedInterval.end;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(start.getHours() === 0 && start.getMinutes() === 0 && start.getSeconds() === 0){\n\t\t\t\t\tvar prev = this._getClosestWorkTimePast(start, \"hour\");\n\t\t\t\t\tif(prev.valueOf() === start.valueOf()){\n\t\t\t\t\t\tvar prev = this.$gantt.date.add(start, -1, \"day\");\n\t\t\t\t\t\tvar times = this._getWorkHours(prev);\n\t\t\t\t\t\tif(times.length){\n\t\t\t\t\t\t\tvar lastInterval = times[times.length - 1];\n\t\t\t\t\t\t\tprev.setSeconds(lastInterval.durationSeconds);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tstart = prev;\n\n\t\t\t\t} else{\n\t\t\t\t\tstart = this._getClosestWorkTimePast(new Date(start - 1), \"hour\");\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tif (added < duration) {\n\t\t\tvar durationLeft = duration - added;\n\t\t\taddedInterval = this._subtractMinutesUntilHourStart(start, durationLeft);\n\t\t\tadded += addedInterval.added;\n\t\t\tstart = addedInterval.end;\n\t\t}\n\n\t\treturn start;\n\t},\n\t_calculateMinuteEndDate: function (from, duration, step) {\n\t\tvar start = new Date(from),\n\t\t\tadded = 0;\n\t\tstep = step || 1;\n\t\tduration = Math.abs(duration * 1);\n\t\tduration = Math.round(duration);\n\n\t\tvar addedInterval = this._addMinutesUntilHourEnd(start, duration);\n\t\tadded += addedInterval.added;\n\n\t\tstart = addedInterval.end;\n\n\t\tvar calculatedDay = 0;\n\t\tvar daySchedule = [];\n\t\tvar minutesInDay = 0;\n\n\t\tvar minutePrecision = this._isMinutePrecision(start);\n\n\t\twhile (added < duration) {\n\t\t\tvar dayStart = this.$gantt.date.day_start(new Date(start)).valueOf();\n\t\t\tif(dayStart !== calculatedDay){\n\t\t\t\tdaySchedule = this._getWorkHours(start);\n\t\t\t\tminutesInDay = this._getMinutesPerDay(start);\n\t\t\t\tcalculatedDay = dayStart;\n\n\t\t\t}\n\n\t\t\tvar left = duration - added;\n\t\t\tvar timestamp = this._getTimeOfDayStamp(start);\n\n\t\t\tif(!daySchedule.length || !minutesInDay){\n\t\t\t\tstart = this.$gantt.date.add(this.$gantt.date.day_start(start), 1, \"day\");\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(daySchedule[0].start >= timestamp){\n\t\t\t\tif(left >= minutesInDay){\n\t\t\t\t\tadded += minutesInDay;\n\t\t\t\t\tif (left == minutesInDay) {\n\t\t\t\t\t\tstart = new Date(start.getFullYear(), start.getMonth(), start.getDate(), 0, 0, daySchedule[daySchedule.length - 1].end);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tstart = this.$gantt.date.add(start, 1, \"day\");\n\t\t\t\t\t\tstart = this.$gantt.date.day_start(start);\n\t\t\t\t\t}\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar isWorkHour = false;\n\t\t\tvar workInterval = null;\n\t\t\tfor(var i = 0; i < daySchedule.length; i++){\n\t\t\t\tif(daySchedule[i].start <= timestamp && daySchedule[i].end > timestamp){\n\t\t\t\t\tisWorkHour = true;\n\t\t\t\t\tworkInterval = daySchedule[i];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(isWorkHour){\n\n\t\t\t\tif(timestamp === workInterval.start && left >= workInterval.durationMinutes){\n\t\t\t\t\tadded += workInterval.durationMinutes;\n\t\t\t\t\tstart = this.$gantt.date.add(start, workInterval.durationMinutes, \"minute\");\n\t\t\t\t}else if(left <= (workInterval.endMinute - timestamp/60)){\n\t\t\t\t\tadded += left;\n\t\t\t\t\tstart = this.$gantt.date.add(start, left, \"minute\");\n\t\t\t\t}else{\n\t\t\t\t\tvar minutesInHour = this._getMinutesPerHour(start);\n\t\t\t\t\tif(minutesInHour <= left){\n\t\t\t\t\t\tadded += minutesInHour;\n\t\t\t\t\t\t// when the working time settings are set in minutes move to the next minutes\n\t\t\t\t\t\tif (minutePrecision) {\n\t\t\t\t\t\t\tstart = this.$gantt.date.add(start, minutesInHour, \"minute\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tstart = this._nextDate(start, \"hour\", step);\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\taddedInterval = this._addMinutesUntilHourEnd(start, left);\n\t\t\t\t\t\tadded += addedInterval.added;\n\t\t\t\t\t\tstart = addedInterval.end;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tstart = this._getClosestWorkTimeFuture(start, \"hour\");\n\t\t\t}\n\t\t}\n\n\t\tif (added < duration) {\n\t\t\tvar durationLeft = duration - added;\n\t\t\taddedInterval = this._addMinutesUntilHourEnd(start, durationLeft);\n\t\t\tadded += addedInterval.added;\n\t\t\tstart = addedInterval.end;\n\t\t}\n\n\t\treturn start;\n\t},\n\n\tgetClosestWorkTime: function () {\n\t\tvar settings =  this.argumentsHelper.getClosestWorkTimeArguments.apply( this.argumentsHelper, arguments);\n\t\treturn this._getClosestWorkTime(settings.date, settings.unit, settings.dir);\n\t},\n\n\t_getClosestWorkTime: function (inputDate, unit, direction) {\n\t\tvar result = new Date(inputDate);\n\n\t\tif (this._isWorkTime(result, unit)) {\n\t\t\treturn result;\n\t\t}\n\n\t\tresult = this.$gantt.date[unit + '_start'](result);\n\n\t\tif (direction == 'any' || !direction) {\n\t\t\tvar closestFuture = this._getClosestWorkTimeFuture(result, unit);\n\t\t\tvar closestPast = this._getClosestWorkTimePast(result, unit);\n\t\t\tif (Math.abs(closestFuture - inputDate) <= Math.abs(inputDate - closestPast)) {\n\t\t\t\tresult = closestFuture;\n\t\t\t} else {\n\t\t\t\tresult = closestPast;\n\t\t\t}\n\t\t} else if (direction == \"past\") {\n\t\t\tresult = this._getClosestWorkTimePast(result, unit);\n\t\t} else {\n\t\t\tresult = this._getClosestWorkTimeFuture(result, unit);\n\t\t}\n\t\treturn result;\n\t},\n\n\t_getClosestWorkTimeFuture: function (date, unit) {\n\t\treturn this._getClosestWorkTimeGeneric(date, unit, 1);\n\t},\n\n\t_getClosestWorkTimePast: function (date, unit) {\n\t\tvar result = this._getClosestWorkTimeGeneric(date, unit, -1);\n\t\t// should return the end of the closest work interval\n\t\treturn this.$gantt.date.add(result, 1, unit);\n\t},\n\n\t_findClosestTimeInDay: function(date, direction, worktimes) {\n\t\tvar start = new Date(date);\n\t\tvar resultDate = null;\n\t\tvar fromDayEnd = false;\n\t\tif(!this._getWorkHours(start).length){\n\t\t\tstart = this._getClosestWorkTime(start, \"day\", direction < 0 ? \"past\" : \"future\");\n\t\t\tif(direction < 0){\n\t\t\t\tstart = new Date(start.valueOf() - 1);\n\t\t\t\tfromDayEnd = true;\n\t\t\t}\n\t\t\tworktimes = this._getWorkHours(start);\n\t\t}\n\n\t\tvar value = this._getTimeOfDayStamp(start);\n\t\tif(fromDayEnd){\n\t\t\tvalue = this._getTimeOfDayStamp(new Date(start.valueOf() + 1), fromDayEnd);\n\t\t}\n\t\tif(direction > 0){\n\t\t\tfor(var i = 0; i < worktimes.length; i++){\n\t\t\t\tif(worktimes[i].start >= value){\n\t\t\t\t\tresultDate = new Date(start.getFullYear(), start.getMonth(), start.getDate(), 0, 0, worktimes[i].start);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}else{\n\t\t\tfor(var i = worktimes.length - 1; i >= 0; i--){\n\t\t\t\tif(worktimes[i].end <= value){\n\t\t\t\t\tresultDate = new Date(start.getFullYear(), start.getMonth(), start.getDate(), 0, 0, worktimes[i].end);\n\t\t\t\t\tbreak;\n\t\t\t\t}else if(worktimes[i].end > value && worktimes[i].start <= value) {\n\t\t\t\t\tresultDate = new Date(start.getFullYear(), start.getMonth(), start.getDate(), 0, 0, value);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn resultDate;\n\t},\n\t_getClosestWorkMinute: function(date, unit, direction) {\n\t\tvar start = new Date(date);\n\t\tvar worktimes = this._getWorkHours(start);\n\t\tvar resultDate = this._findClosestTimeInDay(start, direction, worktimes);\n\t\tif(!resultDate){\n\t\t\tif(direction > 0){\n\t\t\t\tstart = this.calculateEndDate(start, direction, unit);\n\t\t\t\tstart = this.$gantt.date.day_start(start);\n\t\t\t}else{\n\t\t\t\tstart = this.calculateEndDate(start, direction, \"day\");\n\t\t\t\tstart = this.$gantt.date.day_start(start);\n\t\t\t\tstart = this.$gantt.date.add(start, 1, \"day\");\n\t\t\t\tstart = new Date(start.valueOf() - 1);\n\t\t\t}\n\t\t\tworktimes = this._getWorkHours(start);\n\t\t\tresultDate = this._findClosestTimeInDay(start, direction, worktimes);\n\t\t}\n\t\tif(direction < 0){\n\t\t\t// getClosestWorkTimePast adds one time unit to the result date after this\n\t\t\tresultDate = this.$gantt.date.add(resultDate, -1, unit);\n\t\t}\n\t\treturn resultDate;\n\t},\n\n\t_getClosestWorkTimeGeneric: function (date, unit, increment) {\n\t\tif(unit === \"hour\" || unit === \"minute\"){\n\t\t\treturn this._getClosestWorkMinute(date, unit, increment);\n\t\t}\n\n\t\tvar unitOrder = this._getUnitOrder(unit),\n\t\t\tbiggerTimeUnit = this.units[unitOrder - 1];\n\n\t\tvar result = date;\n\n\t\t// be extra sure we won't fall into infinite loop, 3k seems big enough\n\t\tvar maximumLoop = 3000,\n\t\t\tcount = 0;\n\n\t\twhile (!this._isWorkTime(result, unit)) {\n\t\t\tif (biggerTimeUnit && !this._isWorkTime(result, biggerTimeUnit)) {\n\t\t\t\t// if we look for closest work hour and detect a week-end - first find the closest work day,\n\t\t\t\t// and continue iterations after that\n\t\t\t\tif (increment > 0) {\n\t\t\t\t\tresult = this._getClosestWorkTimeFuture(result, biggerTimeUnit);\n\t\t\t\t} else {\n\t\t\t\t\tresult = this._getClosestWorkTimePast(result, biggerTimeUnit);\n\t\t\t\t}\n\n\t\t\t\tif (this._isWorkTime(result, unit)) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcount++;\n\t\t\tif (count > maximumLoop) {\n\t\t\t\tthis.$gantt.assert(false, \"Invalid working time check\");\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tvar tzOffset = result.getTimezoneOffset();\n\t\t\tresult = this.$gantt.date.add(result, increment, unit);\n\n\t\t\tresult = this.$gantt._correct_dst_change(result, tzOffset, increment, unit);\n\t\t\tif (this.$gantt.date[unit + '_start']) {\n\t\t\t\tresult = this.$gantt.date[unit + '_start'](result);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t},\n\n\t/**\n\t * Check whether this calendar has working time. Calendar has working time only if there are regular working days of week\n\t *\n\t */\n\thasWorkTime: function () {\n\t\tvar worktime = this.getConfig();\n\t\tvar dates = worktime.dates;\n\n\t\tvar daysOfWeek = [0, 1, 2, 3, 4, 5, 6];\n\t\tvar exceptions = [];\n\t\tfor(var i in worktime.dates){\n\t\t\tif(Number(i) > 6){\n\t\t\t\texceptions.push(Number(i));\n\t\t\t}\n\t\t}\n\n\t\tvar hasRegularHours = this._checkWorkHours(worktime.hours);\n\n\t\tvar result = false;\n\t\tdaysOfWeek.forEach((function(day){\n\t\t\tif(result){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar dayConfig = dates[day];\n\t\t\tif(dayConfig === true){\n\t\t\t\t// workday uses global hours\n\t\t\t\tresult = hasRegularHours;\n\t\t\t}else if(Array.isArray(dayConfig)){\n\t\t\t\t// workday uses custom hours\n\t\t\t\tresult = this._checkWorkHours(dayConfig);\n\t\t\t}\n\t\t}).bind(this));\n\n\t\treturn result;\n\n\t},\n\n\t_checkWorkHours: function(hoursArray) {\n\t\tif (hoursArray.length === 0) {\n\t\t\treturn false;\n\t\t}\n\t\tvar result = false;\n\t\tfor (var i = 0; i < hoursArray.length; i += 2) {\n\t\t\tif (hoursArray[i] !== hoursArray[i + 1]) {\n\t\t\t\tresult = true;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t},\n\n\t_isMinutePrecision: function (date) {\n\t\tlet minutePrecision = false;\n\t\tthis._getWorkHours(date).forEach(function(interval){\n\t\t\tif (interval.startMinute % 60 || interval.endMinute % 60){\n\t\t\t\tminutePrecision = true;\n\t\t\t}\n\t\t});\n\t\treturn minutePrecision;\n\t}\n};\n\nexport default CalendarWorkTimeStrategy;","import { IWorkUnitCache } from \"./workunit_cache_interface\";\nimport { WorkUnitsMapCache } from \"./workunit_map_cache\";\nimport { WorkUnitsObjectCache } from \"./workunit_object_cache\";\nexport { LargerUnitsCache } from \"./larger_units_helper\";\n\nexport function createCacheObject(): IWorkUnitCache {\n\n\t// worktime hash is on the hot path,\n\t// Map seems to work faster than plain array, use it whenever possible\n\tif (typeof Map !== \"undefined\") {\n\t\treturn new WorkUnitsMapCache();\n\t} else {\n\t\treturn new WorkUnitsObjectCache();\n\t}\n}\n","export default {\n\tisLegacyResourceCalendarFormat: function(resourceCalendarsProperty){\n\t\t// modern format:\n\t\t//gantt.config.resource_calendars = {\n\t\t//\tresourceId: calendarId,\n\t\t//\tresourceId: calendarId,\n\t\t//\tresourceId: calendarId\n\t\t//\t};\n\t\t\n\t\t// legacy format:\n\t\t// gantt.config.resource_calendars = {\n\t\t//\t\"resourceProperty\": {\n\t\t//\t\tresourceId: calendarId,\n\t\t//\t\tresourceId: calendarId,\n\t\t//\t\tresourceId: calendarId\n\t\t//\t\t}\n\t\t//\t};\n\n\t\tif(!resourceCalendarsProperty){\n\t\t\treturn false;\n\t\t}\n\t\tfor(var i in resourceCalendarsProperty){\n\t\t\tif(resourceCalendarsProperty[i] && typeof resourceCalendarsProperty[i] === \"object\"){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t},\n\tgetResourceProperty: function(config){\n\t\tvar resourceCalendarsConfig = config.resource_calendars;\n\t\tvar propertyName = config.resource_property;\n\t\tif(this.isLegacyResourceCalendarFormat(resourceCalendarsConfig)){\n\t\t\tfor(var i in config){\n\t\t\t\tpropertyName = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn propertyName;\n\t},\n\tgetCalendarIdFromLegacyConfig: function(task, config){\n\t\tif (config) {\n\t\t\tfor (var field in config) {\n\t\t\t\tvar resource = config[field];\n\t\t\t\tif (task[field]) {\n\t\t\t\t\tvar calendarId = resource[task[field]];\n\t\t\t\t\tif (calendarId) {\n\t\t\t\t\t\treturn calendarId;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n};","import * as utils from \"../../utils/utils\";\nimport createArgumentsHelper from \"./calendar_arguments_helper\";\nimport CalendarMergeHelper from \"./strategy/work_calendar_merger\";\nimport CalendarWorkTimeStrategy from \"./strategy/calendar_strategy\";\nimport legacyResourceCalendarConfig from \"./legacy_resource_config\";\nimport dynamicResourceCalendarsFactory from \"./dynamic_resource_calendars\";\n\nconst dynamicResourceCalendars = dynamicResourceCalendarsFactory();\n\nfunction CalendarManager (gantt){\n\tthis.$gantt = gantt;\n\tthis._calendars = {};\n\tthis._legacyConfig = undefined;\n\tthis.$gantt.attachEvent(\"onGanttReady\", function(){\n\t\tif(this.$gantt.config.resource_calendars){\n\t\t\tthis._isLegacyConfig = legacyResourceCalendarConfig.isLegacyResourceCalendarFormat(this.$gantt.config.resource_calendars);\n\t\t}\n\t}.bind(this));\n\n\tthis.$gantt.attachEvent(\"onBeforeGanttReady\", function(){\n\t\tthis.createDefaultCalendars();\n\t}.bind(this));\n\tthis.$gantt.attachEvent(\"onBeforeGanttRender\", function(){\n\t\tthis.createDefaultCalendars();\n\t}.bind(this));\n}\n\nCalendarManager.prototype = {\n\t_calendars: {},\n\t_convertWorkTimeSettings: function (settings) {\n\t\tconst days = settings.days;\n\t\t//GS-2864: opportunity to specify specific dates\n\t\tif(typeof days === \"object\" && !Array.isArray(days) && days !== null){\n\t\t\tconst datesConfig = {};\n\t\t\tif(days?.weekdays){\n\t\t\t\tfor(let i = 0; i < 7; i++) {\n\t\t\t\t\tdatesConfig[i] = days.weekdays[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (days?.dates) {\n\t\t\t\tObject.entries(days.dates).forEach(([date, setting]) => {\n\t\t\t\t\tdatesConfig[(new Date(date)).valueOf()] = setting;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tObject.entries(datesConfig).forEach(([key, setting]) => {\n\t\t\t\tif (!(setting instanceof Array)) {\n\t\t\t\t\tdatesConfig[key] = !!setting;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tsettings = {\n\t\t\t\t...settings,\n\t\t\t\tdates: datesConfig\n\t\t\t};\n\n\t\t} else if (days && !settings.dates) {\n\t\t\tsettings.dates = settings.dates || {};\n\t\t\tfor (let i = 0; i < days.length; i++) {\n\t\t\t\tsettings.dates[i] = days[i];\n\t\t\t\tif (!(days[i] instanceof Array)) {\n\t\t\t\t\tsettings.dates[i] = !!days[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tdelete settings.days;\n\t\treturn settings;\n\t},\n\tmergeCalendars: function(){\n\t\tvar calendars = [];\n\t\tvar args = arguments;\n\t\tif(Array.isArray(args[0])){\n\t\t\tcalendars = args[0].slice();\n\t\t}else{\n\t\t\tfor(var i = 0; i < arguments.length; i++){\n\t\t\t\tcalendars.push(arguments[i]);\n\t\t\t}\n\t\t}\n\n\t\tvar mergeHelper = new CalendarMergeHelper();\n\n\t\tvar result;\n\t\tcalendars.forEach(function(calendar){\n\t\t\tif(!result){\n\t\t\t\tresult = calendar;\n\t\t\t} else{\n\t\t\t\tresult = this._createCalendarFromConfig(mergeHelper.merge(result, calendar));\n\t\t\t}\n\n\t\t}.bind(this));\n\t\treturn this.createCalendar(result);\n\t},\n\n\t_createCalendarFromConfig: function(config){\n\t\tvar apiCore = new CalendarWorkTimeStrategy(this.$gantt, createArgumentsHelper(this.$gantt));\n\t\tapiCore.id = String(utils.uid());\n\n\t\tvar preparedConfig = this._convertWorkTimeSettings(config);\n\t\tif(preparedConfig.customWeeks){\n\t\t\tfor(var i in preparedConfig.customWeeks){\n\t\t\t\tpreparedConfig.customWeeks[i] = this._convertWorkTimeSettings(preparedConfig.customWeeks[i]);\n\t\t\t}\n\t\t}\n\t\tapiCore._setConfig(preparedConfig);\n\n\t\treturn apiCore;\n\t},\n\n\tcreateCalendar: function (parentCalendar) {\n\t\tvar settings;\n\n\t\tif (!parentCalendar) {\n\t\t\tparentCalendar = {};\n\t\t}\n\n\t\tif (parentCalendar.getConfig){\n\t\t\tsettings = utils.copy(parentCalendar.getConfig());\n\t\t} else if (parentCalendar.worktime) {\n\t\t\tsettings = utils.copy(parentCalendar.worktime);\n\t\t} else {\n\t\t\tsettings = utils.copy(parentCalendar);\n\t\t}\n\n\t\tvar defaults = utils.copy(this.defaults.fulltime.worktime);\n\t\tutils.mixin(settings, defaults);\n\n\t\treturn this._createCalendarFromConfig(settings);\n\t},\n\n\tgetCalendar: function (id) {\n\t\tid = id || \"global\";\n\t\tvar calendar = this._calendars[id];\n\t\tif(!calendar){\n\t\t\tthis.createDefaultCalendars();\n\t\t\tcalendar = this._calendars[id];\n\t\t}\n\n\t\treturn calendar;\n\t},\n\n\tgetCalendars: function () {\n\t\tvar res = [];\n\t\tfor (var i in this._calendars) {\n\t\t\tres.push(this.getCalendar(i));\n\t\t}\n\t\treturn res;\n\t},\n\n\t_getOwnCalendar: function(task){\n\t\tvar config = this.$gantt.config;\n\t\tif (task[config.calendar_property]) {\n\t\t\treturn this.getCalendar(task[config.calendar_property]);\n\t\t}\n\n\t\tif (config.resource_calendars) {\n\t\t\tvar calendar;\n\t\t\tvar calendarId;\n\t\t\tvar resourceProperty;\n\t\t\tif(this._legacyConfig === false){\n\t\t\t\tresourceProperty = config.resource_property;\n\t\t\t}else{\n\t\t\t\tresourceProperty = legacyResourceCalendarConfig.getResourceProperty(config);\n\t\t\t}\n\t\t\t// GS-2821. If no resource is assigned to a task,\n\t\t\t// there is no need to check the resource calendar\n\t\t\tif(Array.isArray(task[resourceProperty]) && task[resourceProperty].length){\n\t\t\t\t// if multiple resources are attached to the task - merge their calendars\n\t\t\t\tif(config.dynamic_resource_calendars){\n\t\t\t\t\tcalendarId = dynamicResourceCalendars.getCalendarIdFromMultipleResources(task[resourceProperty], this);\n\t\t\t\t} else {\n\t\t\t\t\tcalendar = this.getResourceCalendar(task[resourceProperty]);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(this._legacyConfig === undefined){\n\t\t\t\t\tthis._legacyConfig = legacyResourceCalendarConfig.isLegacyResourceCalendarFormat(config.resource_calendars);\n\t\t\t\t}\n\n\t\t\t\tif(this._legacyConfig){\n\t\t\t\t\tvar calendarId = legacyResourceCalendarConfig.getCalendarIdFromLegacyConfig(task, config.resource_calendars);\n\t\t\t\t}else if(resourceProperty && task[resourceProperty] && config.resource_calendars[task[resourceProperty]]){\n\t\t\t\t\tvar calendar = this.getResourceCalendar(task[resourceProperty]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(calendarId){\n\t\t\t\tcalendar = this.getCalendar(calendarId);\n\t\t\t}\n\n\t\t\tif(calendar){\n\t\t\t\treturn calendar;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t},\n\n\t/**\n\t * Returns calendar assigned to the specified resource.\n\t * Returns the global calendar if no custom calendar is associated with the resource.\n\t * @param {(string|number|Object)} resource - resource object or resource id\n\t * @returns {object} Calendar object\n\t */\n\tgetResourceCalendar: function(resource) {\n\t\tif (resource === null || resource === undefined) {\n\t\t\treturn this.getCalendar();\n\t\t}\n\n\t\tvar resourceId = null;\n\t\t// if task id is provided\n\t\tif((typeof resource === \"number\" || typeof resource === \"string\")){\n\t\t\tresourceId = resource;\n\t\t}else{\n\t\t\tresourceId = resource.id || resource.key;\n\t\t}\n\n\t\tvar config = this.$gantt.config;\n\t\tvar calendarsConfig = config.resource_calendars;\n\t\tvar calendarId = null;\n\n\t\t// GS-1714: if resource is specified through array\n\t\tif (Array.isArray(resource)){\n\t\t\tif (resource.length === 1){\n\t\t\t\tif (typeof resource[0] === 'object'){\n\t\t\t\t\tresourceId = resource[0].resource_id; // if resource: [\"resource_id: \"6\", value: \"4\", ...\"]\n\t\t\t\t} else {\n\t\t\t\t\tresourceId = resource[0]; // if resource: [1]\n\t\t\t\t}\n\t\t\t} \n\t\t}\n\t\t\n\t\tif (calendarsConfig) {\n\t\t\tif(this._legacyConfig === undefined){\n\t\t\t\tthis._legacyConfig = legacyResourceCalendarConfig.isLegacyResourceCalendarFormat(config.resource_calendars);\n\t\t\t}\n\n\t\t\tif(this._legacyConfig){\n\t\t\t\tfor(var field in calendarsConfig){\n\t\t\t\t\tif(calendarsConfig[field][resourceId]){\n\t\t\t\t\t\tcalendarId = calendarsConfig[field][resourceId];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tvar calendarId = calendarsConfig[resourceId];\n\t\t\t}\n\n\t\t\tif(calendarId){\n\t\t\t\treturn this.getCalendar(calendarId);\n\t\t\t}\n\n\t\t}\n\t\treturn this.getCalendar();\n\t},\n\n\t/**\n\t * Returns the calendar assigned to a task.\n\t * - Returns a calendar assigned via task[gantt.config.calendar_property] if specified.\n\t * - Returns a calendar assigned to the task resource if specified.\n\t * - Returns the global calendar otherwise.\n\t * @param {(string|number|Object)} task - task object or task id\n\t * @returns {object} Calendar object\n\t */\n\tgetTaskCalendar: function (task) {\n\t\tvar gantt = this.$gantt;\n\t\tvar taskObject;\n\t\tif (task === null || task === undefined) {\n\t\t\treturn this.getCalendar();\n\t\t}\n\n\t\t// if task id is provided\n\t\tif((typeof task === \"number\" || typeof task === \"string\") && gantt.isTaskExists(task)){\n\t\t\ttaskObject = gantt.getTask(task);\n\t\t}else{\n\t\t\ttaskObject = task;\n\t\t}\n\n\t\tif(!taskObject){\n\t\t\treturn this.getCalendar();\n\t\t}\n\n\t\tvar calendar = this._getOwnCalendar(taskObject);\n\t\tvar groupMode = !!gantt.getState().group_mode;\n\n\t\tif (!calendar && gantt.config.inherit_calendar && gantt.isTaskExists(taskObject.parent)){\n\t\t\t// GS-1579  group mode overrides tree hierarchy, iterate using `.parent` property, instead of using eachParent iterator\n\t\t\tvar currentTask = taskObject;\n\t\t\twhile(gantt.isTaskExists(currentTask.parent)){\n\t\t\t\tcurrentTask = gantt.getTask(currentTask.parent);\n\t\t\t\tif(gantt.isSummaryTask(currentTask)){\n\t\t\t\t\tcalendar = this._getOwnCalendar(currentTask);\n\t\t\t\t\tif(calendar){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(groupMode && !calendar){\n\t\t\t\t// if group mode and inherit_calendars is enabled - preserve previously applied parent calendar\n\t\t\t\t// we may need it when groupBy parses grouped data, old parent may be not loaded yet\n\t\t\t\tif(task.$effective_calendar){\n\t\t\t\t\tcalendar = this.getCalendar(task.$effective_calendar);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn calendar || this.getCalendar();\n\t},\n\n\taddCalendar: function(calendar) { // puts new calendar to Global Storage - gantt.calendarManager._calendars {}\n\t\tif (!(this.isCalendar(calendar))) {\n\t\t\tvar id = calendar.id;\n\t\t\tcalendar = this.createCalendar(calendar);\n\t\t\tcalendar.id = id;\n\t\t}\n\n\t\t// validate/check if empty calendar\n\t\tif (!calendar._tryChangeCalendarSettings(function () {\n\t\t\t})) {\n\n\t\t\tthis.$gantt.callEvent(\"onCalendarError\", [{message: \"Invalid calendar settings, no worktime available\"}, calendar]);\n\t\t\treturn null;\n\t\t} else {\n\t\t\tvar config = this.$gantt.config;\n\n\t\t\tcalendar.id = calendar.id || utils.uid();\n\t\t\tthis._calendars[calendar.id] = calendar;\n\t\t\tif (!config.worktimes)\n\t\t\t\tconfig.worktimes = {};\n\t\t\tconfig.worktimes[calendar.id] = calendar.getConfig();\n\t\t\treturn calendar.id;\n\t\t}\n\t},\n\n\tdeleteCalendar: function (calendar) {\n\t\tvar config = this.$gantt.config;\n\t\tif (!calendar) return false;\n\t\tif (this._calendars[calendar]) {\n\t\t\tdelete this._calendars[calendar];\n\t\t\tif (config.worktimes && config.worktimes[calendar])\n\t\t\t\tdelete config.worktimes[calendar];\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t},\n\n\trestoreConfigCalendars: function (configs) {\n\t\tfor (var i in configs) {\n\t\t\tif (this._calendars[i])\n\t\t\t\tcontinue;\n\n\t\t\tvar settings = configs[i];\n\t\t\tvar calendar = this.createCalendar(settings);\n\t\t\tcalendar.id = i;\n\t\t\tthis.addCalendar(calendar);\n\t\t}\n\t},\n\n\tdefaults: {\n\t\tglobal: {\n\t\t\tid: \"global\",\n\t\t\tworktime: {\n\t\t\t\thours: [8, 12, 13, 17],\n\t\t\t\tdays: [0, 1, 1, 1, 1, 1, 0]\n\t\t\t}\n\t\t},\n\t\tfulltime: {\n\t\t\tid: \"fulltime\",\n\t\t\tworktime: {\n\t\t\t\thours: [0, 24],\n\t\t\t\tdays: [1, 1, 1, 1, 1, 1, 1]\n\t\t\t}\n\t\t}\n\t},\n\n\tcreateDefaultCalendars: function () {\n\t\tvar config = this.$gantt.config;\n\t\tthis.restoreConfigCalendars(this.defaults);\n\t\tthis.restoreConfigCalendars(config.worktimes);\n\t},\n\n\tisCalendar: function(possibleCalendar) {\n\t\t// because we don't have any way to check without dependency to CalendarWorkTimeStrategy\n\t\tvar props = [\n\t\t\tpossibleCalendar.isWorkTime,\n\t\t\tpossibleCalendar.setWorkTime,\n\t\t\tpossibleCalendar.getWorkHours,\n\t\t\tpossibleCalendar.unsetWorkTime,\n\t\t\tpossibleCalendar.getClosestWorkTime,\n\t\t\tpossibleCalendar.calculateDuration,\n\t\t\tpossibleCalendar.hasDuration,\n\t\t\tpossibleCalendar.calculateEndDate\n\t\t];\n\t\treturn props.every(function(entry) {\n\t\t\treturn entry instanceof Function;\n\t\t});\n\t}\n};\n\nexport default CalendarManager;","export default function() {\n\tfunction getResourcesCalendarKey(resourceAssignments){\n\t\treturn resourceAssignments.map(function(res){\n\t\t\tif(res && res.resource_id){\n\t\t\t\treturn res.resource_id;\n\t\t\t} else {\n\t\t\t\treturn res;\n\t\t\t}\n\t\t}).sort().join(\"-\");\n\t}\n\n\tvar dynamicCalendars = {};\n\n\tfunction mergeResourceCalendars(resourceAssignments, manager){\n\t\treturn manager.mergeCalendars(resourceAssignments.map(function(assignment){\n\t\t\tvar resourceId = (assignment && assignment.resource_id) ? assignment.resource_id : assignment;\n\t\t\treturn manager.getResourceCalendar(resourceId);\n\t\t}));\n\t}\n\tfunction getCalendarIdFromMultipleResources(resourceAssignments, manager){\n\t\tvar key = getResourcesCalendarKey(resourceAssignments);\n\t\tif(!resourceAssignments.length){\n\t\t\treturn null;\n\t\t}else if(resourceAssignments.length === 1){\n\t\t\treturn manager.getResourceCalendar(key).id;\n\t\t}else if (dynamicCalendars[key]){\n\t\t\treturn dynamicCalendars[key].id;\n\t\t} else {\n\t\t\tvar tempCalendar = mergeResourceCalendars(resourceAssignments, manager);\n\n\t\t\tdynamicCalendars[key] = tempCalendar;\n\t\t\treturn manager.addCalendar(tempCalendar);\n\t\t}\n\t}\n\n\treturn {\n\t\tgetCalendarIdFromMultipleResources: getCalendarIdFromMultipleResources\n\t};\n};","function CalendarDisabledTimeStrategy(gantt, argumentsHelper){\n\tthis.argumentsHelper = argumentsHelper;\n\tthis.$gantt = gantt;\n}\n\nCalendarDisabledTimeStrategy.prototype = {\n\tgetWorkHours: function () {\n\t\treturn [0, 24];\n\t},\n\tsetWorkTime: function () {\n\t\treturn true;\n\t},\n\tunsetWorkTime: function () {\n\t\treturn true;\n\t},\n\tisWorkTime: function () {\n\t\treturn true;\n\t},\n\tgetClosestWorkTime: function (config) {\n\t\tvar config = this.argumentsHelper.getClosestWorkTimeArguments.apply(this.argumentsHelper, arguments);\n\t\treturn config.date;\n\t},\n\n\tcalculateDuration: function () {\n\t\tvar config = this.argumentsHelper.getDurationArguments.apply(this.argumentsHelper, arguments);\n\t\tvar from = config.start_date,\n\t\t\tto = config.end_date,\n\t\t\tunit = config.unit,\n\t\t\tstep = config.step;\n\n\t\treturn this._calculateDuration(from, to, unit, step);\n\t},\n\t_calculateDuration: function (start, end, unit, step) {\n\t\tvar dateHelper = this.$gantt.date;\n\t\tvar fixedUnits = {\n\t\t\t\"week\": 1000 * 60 * 60 * 24 * 7,\n\t\t\t\"day\": 1000 * 60 * 60 * 24,\n\t\t\t\"hour\": 1000 * 60 * 60,\n\t\t\t\"minute\": 1000 * 60\n\t\t};\n\n\t\tvar res = 0;\n\t\tif (fixedUnits[unit]) {\n\t\t\tres = Math.round((end - start) / (step * fixedUnits[unit]));\n\t\t} else {\n\t\t\tvar from = new Date(start),\n\t\t\t\tto = new Date(end);\n\t\t\twhile (from.valueOf() < to.valueOf()) {\n\t\t\t\tres += 1;\n\t\t\t\tfrom = dateHelper.add(from, step, unit);\n\t\t\t}\n\n\t\t\tif (from.valueOf() != end.valueOf()) {\n\t\t\t\tres += (to - from) / (dateHelper.add(from, step, unit) - from);\n\t\t\t}\n\t\t}\n\n\t\treturn Math.round(res);\n\t},\n\n\thasDuration: function () {\n\t\tvar config = this.argumentsHelper.getDurationArguments.apply(this.argumentsHelper, arguments);\n\t\tvar from = config.start_date,\n\t\t\tto = config.end_date,\n\t\t\tunit = config.unit;\n\n\t\tif (!unit) {\n\t\t\treturn false;\n\t\t}\n\t\tfrom = new Date(from);\n\t\tto = new Date(to);\n\n\t\treturn (from.valueOf() < to.valueOf());\n\t},\n\n\thasWorkTime: function() {\n\t\treturn true;\n\t},\n\n\tequals: function(calendar) {\n\t\tif(!(calendar instanceof CalendarDisabledTimeStrategy)){\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t},\n\n\tcalculateEndDate: function () {\n\t\tvar config = this.argumentsHelper.calculateEndDateArguments.apply(this.argumentsHelper, arguments);\n\n\t\tvar start = config.start_date,\n\t\t\tduration = config.duration,\n\t\t\tunit = config.unit,\n\t\t\tstep = config.step;\n\n\t\treturn this.$gantt.date.add(start, step * duration, unit);\n\t}\n};\n\nexport default CalendarDisabledTimeStrategy;","import createArgumentsHelper from \"./calendar_arguments_helper\";\nimport NoWorkTimeCalendar from \"./strategy/no_work_time\";\n\nfunction TimeCalculator(calendarManager){\n\n\tthis.$gantt = calendarManager.$gantt;\n\tthis.argumentsHelper = createArgumentsHelper(this.$gantt);\n\tthis.calendarManager = calendarManager;\n\tthis.$disabledCalendar = new NoWorkTimeCalendar(this.$gantt, this.argumentsHelper);\n}\n\nTimeCalculator.prototype = {\n\t_getCalendar: function (config) {\n\t\tvar calendar;\n\t\tif (!this.$gantt.config.work_time) {\n\t\t\tcalendar = this.$disabledCalendar;\n\t\t} else {\n\t\t\tvar manager = this.calendarManager;\n\t\t\tif (config.task) {\n\t\t\t\tcalendar = manager.getTaskCalendar(config.task);\n\t\t\t} else if (config.id) {\n\t\t\t\tcalendar = manager.getTaskCalendar(config);\n\t\t\t} else if (config.calendar) {\n\t\t\t\tcalendar = config.calendar;\n\t\t\t}\n\t\t\tif (!calendar) {\n\t\t\t\tcalendar = manager.getTaskCalendar();\n\t\t\t}\n\t\t}\n\t\treturn calendar;\n\t},\n\n\tgetWorkHours: function (config) {\n\t\tconfig = this.argumentsHelper.getWorkHoursArguments.apply(this.argumentsHelper, arguments);\n\n\t\tvar calendar = this._getCalendar(config);\n\n\t\treturn calendar.getWorkHours(config.date);\n\t},\n\n\tsetWorkTime: function (config, calendar) {\n\t\tconfig = this.argumentsHelper.setWorkTimeArguments.apply(this.argumentsHelper, arguments);\n\n\t\tif (!calendar)\n\t\t\tcalendar = this.calendarManager.getCalendar(); // Global\n\t\treturn calendar.setWorkTime(config);\n\t},\n\n\tunsetWorkTime: function (config, calendar) {\n\t\tconfig = this.argumentsHelper.unsetWorkTimeArguments.apply(this.argumentsHelper, arguments);\n\n\t\tif (!calendar)\n\t\t\tcalendar = this.calendarManager.getCalendar(); // Global\n\t\treturn calendar.unsetWorkTime(config);\n\t},\n\tisWorkTime: function (date, unit, task, calendar) {\n\t\tvar config = this.argumentsHelper.isWorkTimeArguments.apply(this.argumentsHelper, arguments);\n\n\t\tcalendar = this._getCalendar(config);\n\t\treturn calendar.isWorkTime(config);\n\t},\n\tgetClosestWorkTime: function (config) {\n\t\tconfig = this.argumentsHelper.getClosestWorkTimeArguments.apply(this.argumentsHelper, arguments);\n\n\t\tvar calendar = this._getCalendar(config);\n\n\t\treturn calendar.getClosestWorkTime(config);\n\t},\n\n\tcalculateDuration: function () { // start_date_date, end_date, task\n\t\tvar config = this.argumentsHelper.getDurationArguments.apply(this.argumentsHelper, arguments);\n\n\n\t\tvar calendar = this._getCalendar(config);\n\t\treturn calendar.calculateDuration(config);\n\t},\n\thasDuration: function () {\n\t\tvar config = this.argumentsHelper.hasDurationArguments.apply(this.argumentsHelper, arguments);\n\n\t\tvar calendar = this._getCalendar(config);\n\n\t\treturn calendar.hasDuration(config);\n\t},\n\tcalculateEndDate: function (config) { // start_date, duration, unit, task\n\t\tvar config = this.argumentsHelper.calculateEndDateArguments.apply(this.argumentsHelper, arguments);\n\n\t\tvar calendar = this._getCalendar(config);\n\t\treturn calendar.calculateEndDate(config);\n\t}\n};\n\nexport default TimeCalculator;\n\n","// TODO: rework public api for date methods\nimport * as utils from \"../../utils/utils\";\n\nvar createWorkTimeFacade = function(calendarManager, timeCalculator){\n\treturn {\n\t\tgetWorkHours: function (date) {\n\t\t\treturn timeCalculator.getWorkHours(date);\n\t\t},\n\n\t\tsetWorkTime: function (config) {\n\t\t\treturn timeCalculator.setWorkTime(config);\n\t\t},\n\n\t\tunsetWorkTime: function (config) {\n\t\t\ttimeCalculator.unsetWorkTime(config);\n\t\t},\n\n\t\tisWorkTime: function (date, unit, task) {\n\t\t\treturn timeCalculator.isWorkTime(date, unit, task);\n\t\t},\n\n\t\tgetClosestWorkTime: function (config) {\n\t\t\treturn timeCalculator.getClosestWorkTime(config);\n\t\t},\n\n\t\tcalculateDuration: function (start_date, end_date, task) {\n\t\t\treturn timeCalculator.calculateDuration(start_date, end_date, task);\n\t\t},\n\t\t_hasDuration: function (start_date, end_date, task) {\n\t\t\treturn timeCalculator.hasDuration(start_date, end_date, task);\n\t\t},\n\n\t\tcalculateEndDate: function (start, duration, unit, task) {\n\t\t\treturn timeCalculator.calculateEndDate(start, duration, unit, task);\n\t\t},\n\n\t\tmergeCalendars: utils.bind(calendarManager.mergeCalendars, calendarManager),\n\t\tcreateCalendar: utils.bind(calendarManager.createCalendar, calendarManager),\n\t\taddCalendar: utils.bind(calendarManager.addCalendar, calendarManager),\n\t\tgetCalendar: utils.bind(calendarManager.getCalendar, calendarManager),\n\t\tgetCalendars: utils.bind(calendarManager.getCalendars, calendarManager),\n\t\tgetResourceCalendar: utils.bind(calendarManager.getResourceCalendar, calendarManager),\n\t\tgetTaskCalendar: utils.bind(calendarManager.getTaskCalendar, calendarManager),\n\t\tdeleteCalendar: utils.bind(calendarManager.deleteCalendar, calendarManager)\n\t};\n};\n\n\nexport default { create: createWorkTimeFacade };","import * as helpers from \"../utils/helpers\";\n\nexport default function(gantt) {\n\n\tgantt.isUnscheduledTask = function (task) {\n\t\tgantt.assert(task && task instanceof Object, \"Invalid argument <b>task</b>=\"+task+\" of gantt.isUnscheduledTask. Task object was expected\");\n\t\treturn (!!task.unscheduled || !task.start_date);\n\t};\n\n\tgantt._isAllowedUnscheduledTask = function (task) {\n\t\treturn !!(task.unscheduled && gantt.config.show_unscheduled);\n\t};\n\n\tgantt._isTaskInTimelineLimits = function(task) {\n\t\tvar taskStart = task.start_date ? task.start_date.valueOf() : null;\n\t\tvar taskEnd = task.end_date ? task.end_date.valueOf() : null;\n\t\treturn !!(taskStart && taskEnd && taskStart <= this._max_date.valueOf() && taskEnd >= this._min_date.valueOf());\n\t};\n\tgantt.isTaskVisible = function (id) {\n\t\tif (!this.isTaskExists(id)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar task = this.getTask(id);\n\t\tif (!(this._isAllowedUnscheduledTask(task) || this._isTaskInTimelineLimits(task))) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn !!(this.getGlobalTaskIndex(id) >= 0);\n\t};\n\n\tgantt._getProjectEnd = function() {\n\t\tif(gantt.config.project_end){\n\t\t\treturn gantt.config.project_end;\n\t\t}else{\n\t\t\tvar tasks = gantt.getTaskByTime();\n\t\t\ttasks = tasks.sort(function (a, b) {\n\t\t\t\treturn +a.end_date > +b.end_date ? 1 : -1;\n\t\t\t});\n\t\t\treturn tasks.length ? tasks[tasks.length - 1].end_date : null;\n\t\t}\n\t};\n\tgantt._getProjectStart = function() {\n\t\tif (gantt.config.project_start) {\n\t\t\treturn gantt.config.project_start;\n\t\t}\n\n\t\t// use timeline start if project start is not specified\n\t\tif (gantt.config.start_date) {\n\t\t\treturn gantt.config.start_date;\n\t\t}\n\t\tif (gantt.getState().min_date) {\n\t\t\treturn gantt.getState().min_date;\n\t\t}\n\n\t\t// earliest task start if neither project start nor timeline are specified\n\t\tvar tasks = gantt.getTaskByTime();\n\t\ttasks = tasks.sort(function (a, b) {\n\t\t\treturn +a.start_date > +b.start_date ? 1 : -1;\n\t\t});\n\t\treturn tasks.length ? tasks[0].start_date : null;\n\t};\n\n\tvar getDefaultTaskDate = function (item, parent_id) {\n\t\tvar parentExists = parent_id && parent_id != gantt.config.root_id && gantt.isTaskExists(parent_id);\n\t\tvar parent = parentExists ? gantt.getTask(parent_id) : false,\n\t\t\tstartDate = null;\n\t\tif (parent) {\n\t\t\tif(gantt._getAutoSchedulingConfig().schedule_from_end){\n\t\t\t\tstartDate = gantt.calculateEndDate({\n\t\t\t\t\tstart_date: parent.end_date,\n\t\t\t\t\tduration: - gantt.config.duration_step,\n\t\t\t\t\ttask:item\n\t\t\t\t});\n\t\t\t}else{\n\t\t\t\tif(!parent.start_date){\n\t\t\t\t\treturn getDefaultTaskDate(parent, gantt.getParent(parent));\n\t\t\t\t}\n\t\t\t\tstartDate = parent.start_date;\n\t\t\t}\n\n\t\t} else if(gantt._getAutoSchedulingConfig().schedule_from_end) {\n\t\t\tstartDate = gantt.calculateEndDate({\n\t\t\t\tstart_date: gantt._getProjectEnd(),\n\t\t\t\tduration: - gantt.config.duration_step,\n\t\t\t\ttask:item\n\t\t\t});\n\t\t} else {\n\t\t\tconst first = gantt.getTaskByIndex(0);\n\t\t\tconst minDate = gantt.config.start_date || gantt.getState().min_date;\n\n\t\t\tif (first){\n\t\t\t\tif (first.start_date){\n\t\t\t\t\tstartDate = first.start_date;\n\t\t\t\t}\n\t\t\t\telse if (first.end_date){\n\t\t\t\t\tstartDate = gantt.calculateEndDate({\n\t\t\t\t\t\tstart_date: first.end_date,\n\t\t\t\t\t\tduration: -gantt.config.duration_step,\n\t\t\t\t\t\ttask:item\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tstartDate = minDate;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tstartDate = minDate;\n\t\t\t}\n\t\t}\n\t\tgantt.assert(startDate, \"Invalid dates\");\n\t\treturn new Date(startDate);\n\t};\n\n\tgantt._set_default_task_timing = function (task) {\n\t\ttask.start_date = task.start_date || getDefaultTaskDate(task, gantt.getParent(task));\n\t\ttask.duration = task.duration || gantt.config.duration_step;\n\t\ttask.end_date = task.end_date || gantt.calculateEndDate(task);\n\t};\n\n\tgantt.createTask = function (item, parent, index) {\n\t\titem = item || {};\n\n\t\tif (!gantt.defined(item.id))\n\t\t\titem.id = gantt.uid();\n\n\t\tif (!item.start_date) {\n\t\t\titem.start_date = getDefaultTaskDate(item, parent);\n\t\t}\n\t\tif (item.text === undefined) {\n\t\t\titem.text = gantt.locale.labels.new_task;\n\t\t}\n\t\tif (item.duration === undefined) {\n\t\t\titem.duration = 1;\n\t\t}\n\n\t\tif (this.isTaskExists(parent)) {\n\t\t\tthis.setParent(item, parent, true);\n\t\t\tvar parentObj = this.getTask(parent);\n\t\t\tparentObj.$open = true;\n\t\t\t// GS-1583. Save the $open state to the Undo Stack\n\t\t\tif (!this.config.details_on_create){\n\t\t\t\tthis.callEvent(\"onAfterParentExpand\", [parent, parentObj]);\n\t\t\t}\n\t\t}\n\n\t\tif (!this.callEvent(\"onTaskCreated\", [item])) {\n\t\t\treturn null;\n\t\t}\n\t\tif (this.config.details_on_create) {\n\t\t\t//GS-761: assert unique ID\n\t\t\tif (gantt.isTaskExists(item.id)){\n\t\t\t\tvar task = gantt.getTask(item.id);\n\t\t\t\tif (task.$index != item.$index) {\n\t\t\t\t\t// Someone may try to mistakenly add a task with the same ID, and most likely\n\t\t\t\t\t// use the string format for the dates. Gantt shouldn't break in this scenario\n\t\t\t\t\tif (item.start_date && typeof item.start_date === \"string\"){\n\t\t\t\t\t\titem.start_date = this.date.parseDate(item.start_date, \"parse_date\");\n\t\t\t\t\t}\n\t\t\t\t\tif (item.end_date && typeof item.end_date === \"string\"){\n\t\t\t\t\t\titem.end_date = this.date.parseDate(item.end_date, \"parse_date\");\n\t\t\t\t\t}\n\t\t\t\t\tthis.$data.tasksStore.updateItem(item.id, item);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\titem.$new = true;\n\t\t\t\tthis.silent(function(){\n\t\t\t\t\tgantt.$data.tasksStore.addItem(item, index);\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis.selectTask(item.id);\n\t\t\tthis.refreshData();\n\t\t\tthis.showLightbox(item.id);\n\t\t} else {\n\t\t\tif (this.addTask(item, parent, index)) {\n\t\t\t\tthis.showTask(item.id);\n\t\t\t\tthis.selectTask(item.id);\n\t\t\t}\n\t\t}\n\t\treturn item.id;\n\t};\n\n\tgantt._update_flags = function (oldid, newid) {\n\t\t//  TODO: need a proper way to update all possible flags\n\t\tvar store = gantt.$data.tasksStore;\n\t\tif (oldid === undefined) {\n\t\t\tthis._lightbox_id = null;\n\n\t\t\tstore.silent(function(){\n\t\t\t\tstore.unselect();\n\t\t\t});\n\t\t\t// GS-1522. If we have multiselect, unselect all previously selected tasks\n\t\t\tif (this.getSelectedTasks) {\n\t\t\t\tthis._multiselect.reset();\n\t\t\t}\n\n\t\t\tif (this._tasks_dnd && this._tasks_dnd.drag) {\n\t\t\t\tthis._tasks_dnd.drag.id = null;\n\t\t\t}\n\t\t} else {\n\t\t\tif (this._lightbox_id == oldid)\n\t\t\t\tthis._lightbox_id = newid;\n\n\t\t\t// TODO: probably can be removed\n\t\t\tif (store.getSelectedId() == oldid) {\n\t\t\t\tstore.silent(function(){\n\t\t\t\t\tstore.unselect(oldid);\n\t\t\t\t\tstore.select(newid);\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (this._tasks_dnd && this._tasks_dnd.drag && this._tasks_dnd.drag.id == oldid) {\n\t\t\t\tthis._tasks_dnd.drag.id = newid;\n\t\t\t}\n\t\t}\n\t};\n\n\tvar getTaskTimingMode = function (task, force) {\n\t\tvar task_type = gantt.getTaskType(task.type);\n\n\t\tvar state = {\n\t\t\ttype: task_type,\n\t\t\t$no_start: false,\n\t\t\t$no_end: false,\n\t\t\tscheduled_summary: false\n\t\t};\n\n\t\tif(task_type === gantt.config.types.project && task.auto_scheduling === false){\n\t\t\tstate.scheduled_summary = true;\n\t\t}\n\n\t\tif (!force && task_type == task.$rendered_type) {\n\t\t\tstate.$no_start = task.$no_start;\n\t\t\tstate.$no_end = task.$no_end;\n\t\t\treturn state;\n\t\t}\n\n\t\tif (task_type == gantt.config.types.project) {\n\t\t\t//project duration is always defined by children duration\n\t\t\tstate.$no_end = state.$no_start = true;\n\t\t} else if (task_type != gantt.config.types.milestone) {\n\t\t\t//tasks can have fixed duration, children duration(as projects), or one date fixed, and other defined by nested items\n\t\t\tstate.$no_end = !(task.end_date || task.duration);\n\t\t\tstate.$no_start = !task.start_date;\n\n\t\t\tif (gantt._isAllowedUnscheduledTask(task)) {\n\t\t\t\tstate.$no_end = state.$no_start = false;\n\t\t\t}\n\t\t}\n\n\t\treturn state;\n\t};\n\n\tgantt._init_task_timing = function (task) {\n\t\tvar task_mode = getTaskTimingMode(task, true);\n\n\t\tvar dirty = task.$rendered_type != task_mode.type;\n\n\t\tvar task_type = task_mode.type;\n\n\t\tif (dirty) {\n\t\t\ttask.$no_start = task_mode.$no_start;\n\t\t\ttask.$no_end = task_mode.$no_end;\n\t\t\ttask.$rendered_type = task_mode.type;\n\t\t}\n\n\t\tif (dirty && task_type != this.config.types.milestone) {\n\t\t\tif (task_type == this.config.types.project) {\n\t\t\t\t//project duration is always defined by children duration\n\t\t\t\tthis._set_default_task_timing(task);\n\t\t\t\ttask.$calculate_duration = false;// do not recalculate duration below\n\t\t\t}\n\t\t}\n\n\t\tif (task_type == this.config.types.milestone) {\n\t\t\ttask.end_date = task.start_date;\n\t\t}\n\t\tif (task.start_date && task.end_date && task.$calculate_duration !== false) {\n\t\t\ttask.duration = this.calculateDuration(task);\n\t\t}\n\n\t\tif(!task.$calculate_duration){\n\t\t\ttask.$calculate_duration = true;\n\t\t}\n\n\t\tif (!task.end_date) {\n\t\t\ttask.end_date = task.start_date;\n\t\t}\n\n\t\ttask.duration = task.duration || 0;\n\t\t// GS-1145. We should let tasks to have 0 duration if user wants it\n\t\tif (this.config.min_duration === 0 && task.duration === 0){\n\t\t\ttask.$no_end = false;\n\t\t\t//GS-2813: special case for project that has 0 duration with milestone child\n\t\t\tif(task.type === gantt.config.types.project && gantt.hasChild(task.id)){\n\t\t\t\ttask.$no_end = true;\n\t\t\t}\n\t\t}\n\n\t\t// work calendar of task has changed\n\t\tvar effectiveCalendar = this.getTaskCalendar(task);\n\t\tif(task.$effective_calendar && task.$effective_calendar !== effectiveCalendar.id){\n\t\t\tupdateTaskTiming(task);\n\t\t\tif(this.config.inherit_calendar && this.isSummaryTask(task)){\n\t\t\t\tthis.eachTask(function(child){\n\t\t\t\t\tupdateTaskTiming(child);\n\t\t\t\t}, task.id);\n\t\t\t}\n\t\t}\n\n\t\ttask.$effective_calendar = effectiveCalendar.id;\n\t};\n\n\tfunction updateTaskTiming(task) {\n\t\ttask.$effective_calendar = gantt.getTaskCalendar(task).id;\n\t\ttask.start_date = gantt.getClosestWorkTime({\n\t\t\tdir: \"future\",\n\t\t\tdate: task.start_date,\n\t\t\tunit: gantt.config.duration_unit,\n\t\t\ttask: task\n\t\t});\n\t\ttask.end_date = gantt.calculateEndDate(task);\n\t}\n\n\tgantt.isSummaryTask = function (task) {\n\t\tgantt.assert(task && task instanceof Object, \"Invalid argument <b>task</b>=\"+task+\" of gantt.isSummaryTask. Task object was expected\");\n\n\t\tvar mode = getTaskTimingMode(task);\n\n\t\treturn !!(mode.$no_end || mode.$no_start);\n\t};\n\n// downward calculation of project duration\n\tgantt.resetProjectDates = function (task) {\n\t\tvar taskMode = getTaskTimingMode(task);\n\t\tif (taskMode.$no_end || taskMode.$no_start) {\n\t\t\tvar info = getSubtaskInfo(task.id);\n\t\t\tassignProjectDates.call(this, task, taskMode, info.start_date, info.end_date);\n\t\t\ttask.$rollup = info.rollup;\n\t\t\ttask.$inlineSplit = info.splitItems;\n\t\t}\n\t};\n\n\tfunction assignProjectDates(task, taskTiming, from, to) {\n\n\t\tconst summaryDateFields = {\n\t\t\tstart: \"start_date\",\n\t\t\tend: \"end_date\"\n\t\t};\n\t\tconst manuallyScheduledSummaryDateFields = {\n\t\t\tstart: \"$auto_start_date\",\n\t\t\tend: \"$auto_end_date\"\n\t\t};\n\n\t\tlet dateFields;\n\t\tif(task.type === gantt.config.types.project && task.auto_scheduling === false){\n\t\t\tdateFields = manuallyScheduledSummaryDateFields;\n\t\t}else{\n\t\t\tdateFields = summaryDateFields;\n\t\t}\n\n\t\tif (taskTiming.$no_start) {\n\t\t\tif (from) {\n\t\t\t\ttask[dateFields.start] = new Date(from);\n\t\t\t} else {\n\t\t\t\ttask[dateFields.start] = getDefaultTaskDate(task, this.getParent(task));\n\t\t\t}\n\t\t}\n\n\t\tif (taskTiming.$no_end) {\n\t\t\tif (to) {\n\t\t\t\ttask[dateFields.end] = new Date(to);\n\t\t\t} else {\n\t\t\t\ttask[dateFields.end] = this.calculateEndDate({\n\t\t\t\t\tstart_date: task[dateFields.start],\n\t\t\t\t\tduration: this.config.duration_step,\n\t\t\t\t\ttask: task\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tif (taskTiming.$no_start || taskTiming.$no_end) {\n\t\t\tthis._init_task_timing(task);\n\t\t}\n\t}\n\n\tgantt.getSubtaskDuration = function (taskId) {\n\t\tvar res = 0,\n\t\t\troot = taskId !== undefined ? taskId : gantt.config.root_id;\n\n\t\tthis.eachTask(function (child) {\n\t\t\tif (this.getTaskType(child.type) == gantt.config.types.project || this.isUnscheduledTask(child))\n\t\t\t\treturn;\n\n\t\t\tres += child.duration;\n\t\t}, root);\n\n\t\treturn res;\n\t};\n\n\tfunction getSubtaskInfo (taskId){\n\t\tlet min = null;\n\t\tlet max = null;\n\t\tlet root = taskId !== undefined ? taskId : gantt.config.root_id;\n\t\tconst rollup = [];\n\t\tconst inlineSplit = [];\n\n\t\tlet rootTask = null;\n\t\tif(gantt.isTaskExists(root)){\n\t\t\trootTask = gantt.getTask(root);\n\t\t}\n\n\t\tgantt.eachTask(function (child) {\n\t\t\tconst isScheduledSummary = (gantt.getTaskType(child.type) == gantt.config.types.project && (child.auto_scheduling === false));\n\t\t\tif ((gantt.getTaskType(child.type) == gantt.config.types.project && !isScheduledSummary) || gantt.isUnscheduledTask(child))\n\t\t\t\treturn;\n\n\t\t\tif(child.rollup){\n\t\t\t\trollup.push(child.id);\n\t\t\t}\n\n\t\t\tif ((child.start_date && (!child.$no_start || isScheduledSummary)) && (!min || min > child.start_date.valueOf()))\n\t\t\t\tmin = child.start_date.valueOf();\n\t\t\tif ((child.end_date && (!child.$no_end || isScheduledSummary)) && (!max || max < child.end_date.valueOf()))\n\t\t\t\tmax = child.end_date.valueOf();\n\n\n\t\t\tif(rootTask && rootTask.render == \"split\"){\n\t\t\t\tif(child.split_placement === \"inline\"){\n\t\t\t\t\tinlineSplit.push(child);\n\t\t\t\t}else if(child.split_placement !== \"subrow\" && (!rootTask.$open || !gantt.config.open_split_tasks)){\n\t\t\t\t\tinlineSplit.push(child);\n\t\t\t\t}\n\t\t\t}\n\t\t}, root);\n\n\t\treturn {\n\t\t\tstart_date: min ? new Date(min) : null,\n\t\t\tend_date: max ? new Date(max) : null,\n\t\t\trollup: rollup,\n\t\t\tsplitItems: inlineSplit\n\t\t};\n\t}\n\n\tgantt.getSubtaskDates = function (task_id) {\n\t\tvar info = getSubtaskInfo(task_id);\n\t\treturn {\n\t\t\tstart_date: info.start_date,\n\t\t\tend_date: info.end_date\n\t\t};\n\t};\n\n\n// upward calculation of project duration\n\tgantt._update_parents = function (taskId, silent, updateAll) {\n\t\tif (!taskId) return;\n\n\t\tvar task = this.getTask(taskId);\n\t\tif(task.rollup){\n\t\t\tupdateAll = true;\n\t\t}\n\t\tvar pid = this.getParent(task);\n\n\t\tvar taskTiming = getTaskTimingMode(task);\n\n\t\tvar has_changed = true;\n\t\t// GS-761 the dates check is necessary for adding empty tasks: gantt.addTask({id:\"2\"})\n\t\tif (updateAll || (task.start_date && task.end_date && (taskTiming.$no_start || taskTiming.$no_end))) {\n\n\t\t\tconst startDateField = task.$auto_start_date ? \"$auto_start_date\" : \"start_date\";\n\t\t\tconst endDateField = task.$auto_end_date ? \"$auto_end_date\" : \"end_date\";\n\n\t\t\tvar oldStart = task[startDateField].valueOf(),\n\t\t\t\toldEnd = task[endDateField].valueOf();\n\n\t\t\tgantt.resetProjectDates(task);\n\n\t\t\t// not refresh parent projects if dates hasn't changed\n\t\t\tif (!updateAll && oldStart == task[startDateField].valueOf() && oldEnd == task[endDateField].valueOf()) {\n\t\t\t\thas_changed = false;\n\t\t\t}\n\n\t\t\tif (has_changed && !silent) {\n\t\t\t\tthis.refreshTask(task.id, true);\n\t\t\t}\n\n\t\t\tif(taskTiming.scheduled_summary){\n\t\t\t\thas_changed = true;//recalculate upwards from scheduled summaries\n\t\t\t}\n\t\t}\n\n\n\t\tif (has_changed && pid && this.isTaskExists(pid)) {\n\t\t\tthis._update_parents(pid, silent, updateAll);\n\t\t}\n\t};\n\n\tgantt.roundDate = function (config) {\n\t\tvar scale = gantt.getScale();\n\n\t\tif (helpers.isDate(config)) {\n\t\t\tconfig = {\n\t\t\t\tdate: config,\n\t\t\t\tunit: scale ? scale.unit : gantt.config.duration_unit,\n\t\t\t\tstep: scale ?  scale.step : gantt.config.duration_step\n\t\t\t};\n\t\t}\n\t\tvar date = config.date,\n\t\t\tsteps = config.step,\n\t\t\tunit = config.unit;\n\n\t\tif(!scale){\n\t\t\treturn date;\n\t\t}\n\n\t\tvar upper, lower, colIndex;\n\t\tif (unit == scale.unit && steps == scale.step &&\n\t\t\t+date >= +scale.min_date && +date <= +scale.max_date) {\n\t\t\t//find date in time scale config\n\t\t\tcolIndex = Math.floor(gantt.columnIndexByDate(date));\n\n\t\t\tif (!scale.trace_x[colIndex]) {\n\t\t\t\tcolIndex -= 1;// end of time scale\n\t\t\t\tif(scale.rtl){\n\t\t\t\t\tcolIndex = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\tlower = new Date(scale.trace_x[colIndex]);\n\t\t\tupper = gantt.date.add(lower, steps, unit);\n\t\t} else {\n\t\t\tcolIndex = Math.floor(gantt.columnIndexByDate(date));\n\n\t\t\tupper = gantt.date[unit + \"_start\"](new Date(scale.min_date));\n\t\t\tif (scale.trace_x[colIndex]) {\n\t\t\t\tupper = gantt.date[unit + \"_start\"](scale.trace_x[colIndex]);// end of time scale\n\t\t\t}\n\n\t\t\twhile (+upper < +date) {\n\t\t\t\tupper = gantt.date[unit + \"_start\"](gantt.date.add(upper, steps, unit));\n\n\t\t\t\tvar tzOffset = upper.getTimezoneOffset();\n\n\t\t\t\tupper = gantt._correct_dst_change(upper, tzOffset, upper, unit);\n\t\t\t\tif (gantt.date[unit + '_start'])\n\t\t\t\t\tupper = gantt.date[unit + '_start'](upper);\n\t\t\t}\n\n\t\t\tlower = gantt.date.add(upper, -1 * steps, unit);\n\n\t\t}\n\t\tif (config.dir && config.dir == 'future')\n\t\t\treturn upper;\n\t\tif (config.dir && config.dir == 'past')\n\t\t\treturn lower;\n\n\t\tif (Math.abs(date - lower) < Math.abs(upper - date)) {\n\t\t\treturn lower;\n\t\t} else {\n\t\t\treturn upper;\n\t\t}\n\n\t};\n\n\tgantt.correctTaskWorkTime = function (task) {\n\t\tif (gantt.config.work_time && gantt.config.correct_work_time) {\n\t\t\tif (!this.isWorkTime(task.start_date, undefined, task)) {\n\t\t\t\ttask.start_date = this.getClosestWorkTime({date: task.start_date, dir: 'future', task: task});\n\t\t\t\ttask.end_date = this.calculateEndDate(task);\n\t\t\t} else if (!this.isWorkTime(new Date(+task.end_date - 1), undefined, task)) {\n\t\t\t\ttask.end_date = this.calculateEndDate(task);\n\t\t\t}\n\t\t}\n\t};\n\n\tgantt.attachEvent(\"onBeforeTaskUpdate\", function (id, task) {\n\t\tgantt._init_task_timing(task);\n\t\treturn true;\n\t});\n\tgantt.attachEvent(\"onBeforeTaskAdd\", function (id, task) {\n\t\tgantt._init_task_timing(task);\n\t\treturn true;\n\t});\n\n\tgantt.attachEvent(\"onAfterTaskMove\", function (id, parent, tindex) {\n\t\tgantt._init_task_timing(gantt.getTask(id));\n\t\treturn true;\n\t});\n\n};","function addResizeListener(gantt){\n\tvar containerStyles = window.getComputedStyle(gantt.$root);\n\tif(containerStyles.getPropertyValue(\"position\") == \"static\"){\n\t\tgantt.$root.style.position = \"relative\";\n\t}\n\n\tvar resizeWatcher = document.createElement('iframe');\n\tresizeWatcher.className = \"gantt_container_resize_watcher\";\n\tresizeWatcher.tabIndex = -1;\n\tif(gantt.config.wai_aria_attributes){\n\t\tresizeWatcher.setAttribute(\"role\", \"none\");\n\t\tresizeWatcher.setAttribute(\"aria-hidden\", true);\n\t}\n\n\tif (gantt.env.isSalesforce){\n\t\tgantt.config.container_resize_method = \"timeout\";\n\t}\n\n\t// in some environments (namely, in SalesForce) iframe.contentWindow is not available\n\tgantt.$root.appendChild(resizeWatcher);\n\tif (resizeWatcher.contentWindow) {\n\t\tlistenWindowResize(gantt, resizeWatcher.contentWindow);\n\t} else {\n\t\t// if so - ditch the iframe and fallback to listening the main window resize\n\t\tgantt.$root.removeChild(resizeWatcher);\n\t\tlistenWindowResize(gantt, window);\n\t}\n}\n\nfunction listenWindowResize(gantt, window){\n\tvar resizeTimeout = gantt.config.container_resize_timeout || 20;\n\tvar resizeDelay;\n\tlet previousSize = getContainerSize(gantt);\n\n\tif (gantt.config.container_resize_method == \"timeout\"){\n\t\tlowlevelResizeWatcher();\n\t}\n\telse {\n\t\ttry {\n\t\t\tgantt.event(window, \"resize\", function () {\n\t\t\t\tif (gantt.$scrollbarRepaint) {\n\t\t\t\t\tgantt.$scrollbarRepaint = null;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// GS-2140. Don't repaint Gantt if it has the same sizes\n\t\t\t\t\tlet currentSize = getContainerSize(gantt);\n\t\t\t\t\tif (previousSize.x == currentSize.x && previousSize.y == currentSize.y){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tpreviousSize = currentSize;\n\t\t\t\t\trepaintGantt();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tcatch (e) {\n\t\t\tlowlevelResizeWatcher();\n\t\t}\n\t}\n\n\tfunction repaintGantt(){\n\t\tclearTimeout(resizeDelay);\n\t\tresizeDelay = setTimeout(function(){\n\t\t\tif(!gantt.$destroyed){\n\t\t\t\tgantt.render();\n\t\t\t}\n\t\t}, resizeTimeout);\n\t}\n\n\tvar previousHeight = gantt.$root.offsetHeight;\n\tvar previousWidth = gantt.$root.offsetWidth;\t\n\n\tfunction lowlevelResizeWatcher(){\n\t\tif (gantt.$root.offsetHeight != previousHeight ||\n\t\t\t\tgantt.$root.offsetWidth != previousWidth){\n\t\t\t\trepaintGantt();\n\t\t}\n\n\t\tpreviousHeight = gantt.$root.offsetHeight;\n\t\tpreviousWidth = gantt.$root.offsetWidth;\n\n\t\tsetTimeout(lowlevelResizeWatcher, resizeTimeout);\n\t}\n}\n\nfunction getContainerSize(gantt){\n\treturn {\n\t\tx: gantt.$root.offsetWidth,\n\t\ty: gantt.$root.offsetHeight\n\t};\n}\n\nexport default addResizeListener;","import * as domHelpers from \"./ui/utils/dom_helpers\";\nimport * as helpers from \"../utils/helpers\";\nimport isHeadless from \"../utils/is_headless\";\nimport addResizeListener from \"./ui/resize_listener\";\nimport calculateScaleRange from \"./gantt_data_range\";\nimport assert from \"./common/assert\";\n\nexport default function(gantt){\n\t\n\n\tgantt.assert = assert(gantt);\n\n\tfunction isHTMLElement(node){\n\t\ttry {\n\t\t\tnode.cloneNode(false);\n\t\t}\n\t\tcatch (e){\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tvar invalidContainerMessage = \"Invalid value of the first argument of `gantt.init`. Supported values: HTMLElement, String (element id).\" +\n\t\"This error means that either invalid object is passed into `gantt.init` or that the element with the specified ID doesn't exist on the page when `gantt.init` is called.\";\n\n\tfunction validateNode(node){\n\t\tif (!node || (typeof node == 'string' && document.getElementById(node))) return true;\n\t\tif (isHTMLElement(node)) return true;\n\n\t\tgantt.assert(false, invalidContainerMessage);\n\t\tthrow new Error(invalidContainerMessage);\n\t}\n\n//initial initialization\n\tgantt.init = function(node, from, to){\n\t\tif (gantt.env.isNode) { \n\t\t\tnode = null; // for the nodejs version\n\t\t} else {\n\t\t\tvalidateNode(node); // for the web version\n\t\t}\n\n\t\tif(from && to){\n\t\t\tthis.config.start_date = this._min_date = new Date(from);\n\t\t\tthis.config.end_date = this._max_date = new Date(to);\n\t\t}\n\t\tthis.date.init();\n\n\t\t//can be called only once\n\t\tthis.init = function(node){\n\t\t\tif (gantt.env.isNode) { \n\t\t\t\tnode = null; // for the nodejs version\n\t\t\t} else {\n\t\t\t\tvalidateNode(node); // for the web version\n\t\t\t}\n\n\t\t\tif (this.$container && this.$container.parentNode){\n\t\t\t\tthis.$container.parentNode.removeChild(this.$container);\n\t\t\t\tthis.$container = null;\n\t\t\t}\n\n\t\t\tif(this.$layout){\n\t\t\t\tthis.$layout.clear();\n\t\t\t}\n\t\t\tthis._reinit(node);\n\t\t};\n\t\tthis._reinit(node);\n\t};\n\n\tgantt._quickRefresh = function(code){\n\t\tvar stores = this._getDatastores.call(this);\n\t\tfor(var i = 0; i < stores.length; i++){\n\t\t\tstores[i]._quick_refresh = true;\n\t\t}\n\n\t\tcode();\n\n\t\tfor(var i = 0; i < stores.length; i++){\n\t\t\tstores[i]._quick_refresh = false;\n\t\t}\n\t};\n\n\tvar dropLayout = (function dropLayout(){\n\t\tif(this._clearTaskLayers){\n\t\t\tthis._clearTaskLayers();\n\t\t}\n\n\t\tif(this._clearLinkLayers){\n\t\t\tthis._clearLinkLayers();\n\t\t}\n\n\t\tif(this.$layout){\n\t\t\tthis.$layout.destructor();\n\t\t\tthis.$layout = null;\n\t\t\tthis.$ui.reset();\n\t\t}\n\t}).bind(gantt);\n\n\tvar rebuildLayout = (function rebuildLayout(){\n\t\tif(isHeadless(gantt)){\n\t\t\treturn;\n\t\t}\n\n\t\tthis.$root.innerHTML = \"\";\n\n\t\tthis.$root.gantt = this;\n\t\tcalculateScaleRange(this);\n\t\tthis.config.layout.id = \"main\";\n\t\tthis.$layout = this.$ui.createView(\"layout\", this.$root, this.config.layout);\n\n\t\tthis.$layout.attachEvent(\"onBeforeResize\", function(){\n\t\t\tvar storeNames = gantt.$services.getService(\"datastores\");\n\t\t\tfor(var i = 0; i < storeNames.length; i++){\n\t\t\t\tgantt.getDatastore(storeNames[i]).filter();\n\t\t\t\tif (gantt.$data.tasksStore._skipTaskRecalculation){\n\t\t\t\t\t// do not repaint items, they will be repainted later in the onStoreUpdate event\n\t\t\t\t\tif (gantt.$data.tasksStore._skipTaskRecalculation != \"lightbox\"){\n\t\t\t\t\t\tgantt.$data.tasksStore._skipTaskRecalculation = false;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t} else {\n\t\t\t\t\tgantt.getDatastore(storeNames[i]).callEvent(\"onBeforeRefreshAll\", []);\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.$layout.attachEvent(\"onResize\", function(){\n\t\t\tgantt._quickRefresh(function(){\n\t\t\t\tgantt.refreshData();\n\t\t\t});\n\t\t});\n\n\t\tthis.callEvent(\"onGanttLayoutReady\", []);\n\t\tthis.$layout.render();\n\n\t\tthis.$container = this.$layout.$container.firstChild;\n\n\t\taddResizeListener(this);\n\t}).bind(gantt);\n\n\tgantt.resetLayout = function(){\n\t\tdropLayout();\n\t\trebuildLayout();\n\t\tthis.render();\n\t};\n\n\tgantt._reinit = function(node){\n\t\tthis.callEvent(\"onBeforeGanttReady\", []);\n\t\tthis._update_flags();\n\n\t\tvar config = this.$services.getService(\"templateLoader\");\n\t\tconfig.initTemplates(this);\n\n\t\tdropLayout();\n\n\t\tthis.$root = null;\n\t\tif(node){\n\t\t\tthis.$root = domHelpers.toNode(node);\n\t\t\trebuildLayout();\n\t\t\tthis.$mouseEvents.reset(this.$root);\n\t\t\taddMinimalSizes(gantt);\n\t\t}\n\n\t\tthis.callEvent(\"onTemplatesReady\",[]);\n\n\t\tthis.callEvent(\"onGanttReady\", []);\n\n\t\tthis.render();\n\t};\n\n\tfunction addMinimalSizes(gantt) {\n\t\tif (gantt.$container && !gantt.config.autosize) {\n\t\t\tif (gantt.$root.offsetHeight < 50) {\n\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\tconsole.warn(`The Gantt container has a small height, so you cannot see its content. If it is not intended, you need to set the 'height' style rule to the container:\nhttps://docs.dhtmlx.com/gantt/faq.html#theganttchartisntrenderedcorrectly`);\n\t\t\t}\n\t\t}\n\t}\n\n\tgantt.$click={\n\t\tbuttons:{\n\t\t\t\"edit\": function(id) {\n\t\t\t\tif (gantt.isReadonly(gantt.getTask(id))) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tgantt.showLightbox(id);\n\t\t\t},\n\t\t\t\"delete\": function(id) {\n\t\t\t\tvar task = gantt.getTask(id);\n\t\t\t\tif (gantt.isReadonly(task)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar question = gantt.locale.labels.confirm_deleting;\n\t\t\t\tvar title = gantt.locale.labels.confirm_deleting_title;\n\n\t\t\t\tgantt._delete_task_confirm({\n\t\t\t\t\ttask: task,\n\t\t\t\t\tmessage: question,\n\t\t\t\t\ttitle: title,\n\t\t\t\t\tcallback: function(){\n\t\t\t\t\t\tif(!gantt.isTaskExists(id)){\n\t\t\t\t\t\t\tgantt.hideLightbox();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif(task.$new){\n\t\t\t\t\t\t\t// GS-2170. Do not recalculate the indexes and dates of other tasks\n\t\t\t\t\t\t\t// as they will be recalculated in the `refreshData`\n\t\t\t\t\t\t\tgantt.$data.tasksStore._skipTaskRecalculation = \"lightbox\";\n\t\t\t\t\t\t\tgantt.silent(function(){\n\t\t\t\t\t\t\t\tgantt.deleteTask(id, true);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tgantt.$data.tasksStore._skipTaskRecalculation = false;\n\t\t\t\t\t\t\tgantt.refreshData();\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tgantt.$data.tasksStore._skipTaskRecalculation = true;\n\t\t\t\t\t\t\tgantt.deleteTask(id);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tgantt.hideLightbox();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t};\n\n//renders self\n\tgantt.render = function(){\n\t\tthis.callEvent(\"onBeforeGanttRender\", []);\n\n\t\tvar visibleDate;\n\t\tif(!isHeadless(gantt)){\n\t\t\tif (!this.config.sort && this._sort) {\n\t\t\t\tthis._sort = undefined;\n\t\t\t}\n\n\t\t\tif(this.$root){\n\t\t\t\tif(this.config.rtl){\n\t\t\t\t\tthis.$root.classList.add(\"gantt_rtl\");\n\t\t\t\t\tthis.$root.firstChild.classList.add(\"gantt_rtl\"); // GS-1499\n\t\t\t\t}else{\n\t\t\t\t\tthis.$root.classList.remove(\"gantt_rtl\");\n\t\t\t\t\tthis.$root.firstChild.classList.remove(\"gantt_rtl\"); // GS-1499\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar pos = this.getScrollState();\n\t\t\tvar posX = pos ? pos.x : 0;\n\t\t\tif(this._getHorizontalScrollbar()){\n\t\t\t\tvar scrollbar = this._getHorizontalScrollbar();\n\t\t\t\tposX = scrollbar.$config.codeScrollLeft || posX || 0;\n\t\t\t}\n\n\n\t\t\tvisibleDate = null;\n\t\t\tif(posX){\n\t\t\t\tvisibleDate = gantt.dateFromPos(posX + this.config.task_scroll_offset);\n\t\t\t}\n\t\t}\n\n\t\tcalculateScaleRange(this);\n\n\t\tif(!isHeadless(gantt)){\n\t\t\tthis.$layout.$config.autosize = this.config.autosize;\n\t\t\tvar preserveScroll = this.config.preserve_scroll;\n\t\t\tthis.config.preserve_scroll = false; // prevent scrolling from layout resize, scroll will be called here later on\n\t\t\tthis.$layout.resize();\n\t\t\tthis.config.preserve_scroll = preserveScroll;\n\n\t\t\tif(this.config.preserve_scroll && pos){\n\t\t\t\t// GS-1640: We need pos.y, otherwise part of the timeline won't be rendered if the scrollbar disappeared\n\t\t\t\t// GS-2945: don't need to scroll if the zoom ext was initialized cause it will be scrolled in zoom\n\t\t\t\tconst zoom = gantt.ext.zoom._initialized;  \n\t\t\t\tif ((posX || pos.y) && !zoom) {\n\t\t\t\t\tvar new_pos = gantt.getScrollState();\n\t\t\t\t\tvar new_date = gantt.dateFromPos(new_pos.x);\n\t\t\t\t\tif(!(+visibleDate == +new_date && new_pos.y == pos.y)){\n\t\t\t\t\t\tvar posX = null;\n\t\t\t\t\t\tvar posY = null;\n\t\t\t\t\t\tif(visibleDate){\n\t\t\t\t\t\t\tvar posX = Math.max(gantt.posFromDate(visibleDate) - gantt.config.task_scroll_offset, 0);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(pos.y){\n\t\t\t\t\t\t\tposY = pos.y;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tgantt.scrollTo(posX, posY);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// GS-1640: We need to reset the scroll position for the grid if the scrollbar disappeared and\n\t\t\t\t// the grid and timeline have different scrollbars\n\t\t\t\t// GS-2718: if we have resources and two verticall scrollbars for tasks timeline and resource timeline\n\t\t\t\t// we don't get the scroll state of the resource timeline\n\t\t\t\tconst scrollbarsInfo = this.$layout.getScrollbarsInfo();\n\t\t\t\tscrollbarsInfo.forEach((scroll_info) => {\n\t\t\t\t\tconst scroll = gantt.$ui.getView(scroll_info.id);\n\t\t\t\t\tconst scrollbarNodeVisible = gantt.utils.dom.isChildOf(scroll.$view, gantt.$container);\n\t\t\t\t\tscroll_info.boundViews.forEach((viewName) => {\n\t\t\t\t\t\tconst view = gantt.$ui.getView(viewName);\n\t\t\t\t\t\tif(scroll_info.y && scroll_info.y != pos.y){\n\t\t\t\t\t\t\tif(view && !scrollbarNodeVisible){\n\t\t\t\t\t\t\t\tview.scrollTo(undefined, 0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//GS-2586: take into account the horizontal scroll of the resource timeline\n\t\t\t\t\t\tif(scroll_info.x_pos && scroll_info.x_pos != pos.x){\n\t\t\t\t\t\t\tif(view && scrollbarNodeVisible){\n\t\t\t\t\t\t\t\tview.scrollTo(scroll_info.x_pos, undefined);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\n\t\t}else{\n\t\t\tgantt.refreshData();\n\t\t}\n\t\tthis.callEvent(\"onGanttRender\", []);\n\t};\n\n\t//TODO: add layout.resize method that wouldn't trigger data repaint\n\tgantt.setSizes = gantt.render;\n\n\n\tgantt.getTaskRowNode = function(id) {\n\t\tvar els = this.$grid_data.childNodes;\n\t\tvar attribute = this.config.task_attribute;\n\t\tfor (var i = 0; i < els.length; i++) {\n\t\t\tif (els[i].getAttribute) {\n\t\t\t\tvar value = els[i].getAttribute(attribute);\n\t\t\t\tif (value == id) return els[i];\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t};\n\n\tgantt.changeLightboxType = function(type){\n\t\tif(this.getLightboxType() == type)\n\t\t\treturn true;\n\t\tgantt._silent_redraw_lightbox(type);\n\t};\n\n\tgantt._get_link_type = function (from_start, to_start) {\n\t\tvar type = null;\n\t\tif (from_start && to_start) {\n\t\t\ttype = gantt.config.links.start_to_start;\n\t\t} else if (!from_start && to_start) {\n\t\t\ttype = gantt.config.links.finish_to_start;\n\t\t} else if (!from_start && !to_start) {\n\t\t\ttype = gantt.config.links.finish_to_finish;\n\t\t} else if (from_start && !to_start) {\n\t\t\ttype = gantt.config.links.start_to_finish;\n\t\t}\n\t\treturn type;\n\t};\n\n\tgantt.isLinkAllowed = function (from, to, from_start, to_start) {\n\t\tvar link = null;\n\t\tif (typeof(from) == \"object\") {\n\t\t\tlink = from;\n\t\t} else {\n\t\t\tlink = {source: from, target: to, type: this._get_link_type(from_start, to_start)};\n\t\t}\n\n\t\tif (!link) return false;\n\t\tif (!(link.source && link.target && link.type)) return false;\n\t\tif (link.source == link.target) return false;\n\n\t\tvar res = true;\n\t\t//any custom rules\n\t\tif (this.checkEvent(\"onLinkValidation\"))\n\t\t\tres = this.callEvent(\"onLinkValidation\", [link]);\n\n\t\treturn res;\n\t};\n\n\n\tgantt._correct_dst_change = function(date, prevOffset, step, unit){\n\t\tvar time_unit = helpers.getSecondsInUnit(unit) * step;\n\t\tif(time_unit > 60*60 && time_unit < 60*60*24){\n\t\t\t//correct dst change only if current unit is more than one hour and less than day (days have own checking), e.g. 12h\n\t\t\tvar offsetChanged = date.getTimezoneOffset() - prevOffset;\n\t\t\tif(offsetChanged){\n\t\t\t\tdate = gantt.date.add(date, offsetChanged, \"minute\");\n\t\t\t}\n\t\t}\n\t\treturn date;\n\t};\n\n\tgantt.isSplitTask = function(task){\n\t\tgantt.assert(task && task instanceof Object, \"Invalid argument <b>task</b>=\"+task+\" of gantt.isSplitTask. Task object was expected\");\n\t\treturn this.$data.tasksStore._isSplitItem(task);\n\t};\n\n\tgantt._is_icon_open_click = function(e) {\n\t\tif (!e)\n\t\t\treturn false;\n\t\tvar target = e.target || e.srcElement;\n\t\tif (!(target && target.className))\n\t\t\treturn false;\n\t\tvar className = domHelpers.getClassName(target);\n\t\tif (className.indexOf(\"gantt_tree_icon\") !== -1 && (className.indexOf(\"gantt_close\") !== -1 || className.indexOf(\"gantt_open\") !== -1))\n\t\t\treturn true;\n\t\treturn false;\n\t};\n\n};","/*\n \tasserts will be removed in final code, so you can place them anythere\n\twithout caring about performance impacts\n*/\n\nexport default function(gantt){\n\treturn function assert(check, message){\n\t\tif (!check){\n\t\t\tif(gantt.config.show_errors && gantt.callEvent(\"onError\",[message]) !== false) {\n\t\t\t\tif (gantt.message) {\n\t\t\t\t\tgantt.message({type: \"error\", text: message, expire: -1});\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// eslint-disable-next-line\n\t\t\t\t\tconsole.log(message);\n\t\t\t\t}\n\n\t\t\t\t// eslint-disable-next-line no-debugger\n\t\t\t\tdebugger;\n\t\t\t}\n\t\t}\n\t};\n};","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\" \", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \" \", \" \", \" \"],\n\t\tmonth_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t},\n\tlabels: {\n\t\tnew_task: \" \",\n\t\ticon_save: \"\",\n\t\ticon_cancel: \"\",\n\t\ticon_details: \"\",\n\t\ticon_edit: \"\",\n\t\ticon_delete: \"\",\n\t\tconfirm_closing: \"  ,   \", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"       \",\n\t\tsection_description: \"\",\n\t\tsection_time: \" \",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"\", \"\", \"\", \"\", \"Ma\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tmonth_short: [\"\", \"\", \"\", \"\", \"Ma\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t},\n\tlabels: {\n\t\tnew_task: \" \",\n\t\ticon_save: \"\",\n\t\ticon_cancel: \"\",\n\t\ticon_details: \"\",\n\t\ticon_edit: \"\",\n\t\ticon_delete: \"\",\n\t\tconfirm_closing: \"\", //    , ?\n\t\tconfirm_deleting: \"   , ?\",\n\t\tsection_description: \"\",\n\t\tsection_time: \" \",\n\t\tsection_type: \"\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"\",\n\t\tcolumn_text: \"\",\n\t\tcolumn_start_date: \"\",\n\t\tcolumn_duration: \"\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"\",\n\t\tconfirm_link_deleting: \" \",\n\t\tlink_start: \"()\",\n\t\tlink_end: \"()\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"ii\",\n\t\thours: \"i\",\n\t\tdays: \"\",\n\t\tweeks: \"\",\n\t\tmonths: \"\",\n\t\tyears: \"\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n @Traducido por Vicente Adria Bohigues - vicenteadria@hotmail.com\n */\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Gener\", \"Febrer\", \"Mar\", \"Abril\", \"Maig\", \"Juny\", \"Juliol\", \"Agost\", \"Setembre\", \"Octubre\", \"Novembre\", \"Desembre\"],\n\t\tmonth_short: [\"Gen\", \"Feb\", \"Mar\", \"Abr\", \"Mai\", \"Jun\", \"Jul\", \"Ago\", \"Set\", \"Oct\", \"Nov\", \"Des\"],\n\t\tday_full: [\"Diumenge\", \"Dilluns\", \"Dimarts\", \"Dimecres\", \"Dijous\", \"Divendres\", \"Dissabte\"],\n\t\tday_short: [\"Dg\", \"Dl\", \"Dm\", \"Dc\", \"Dj\", \"Dv\", \"Ds\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nova tasca\",\n\t\ticon_save: \"Guardar\",\n\t\ticon_cancel: \"Cancellar\",\n\t\ticon_details: \"Detalls\",\n\t\ticon_edit: \"Editar\",\n\t\ticon_delete: \"Esborrar\",\n\t\tconfirm_closing: \"\", // \"Els seus canvis es perdrn, continuar ?\"\n\t\tconfirm_deleting: \"L'esdeveniment s'esborrar definitivament, continuar ?\",\n\t\tsection_description: \"Descripci\",\n\t\tsection_time: \"Periode de temps\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Cancellar\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\nTranslation by FreezeSoul\n\nUpdate 26/10/2015:\nTranslation of new labels by zwh8800\n https://github.com/DHTMLX/gantt/pull/7\n\n*/\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tmonth_short: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"\",\n\t\ticon_save: \"\",\n\t\ticon_cancel: \"\",\n\t\ticon_details: \"\",\n\t\ticon_edit: \"\",\n\t\ticon_delete: \"\",\n\t\tconfirm_closing: \"!\", // Your changes will be lost, are your sure?\n\t\tconfirm_deleting: \"?\",\n\t\tsection_description: \"\",\n\t\tsection_time: \"\",\n\t\tsection_type: \"\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"\",\n\t\tcolumn_text: \"\",\n\t\tcolumn_start_date: \"\",\n\t\tcolumn_duration: \"\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\n\t\tlink: \"\",\n\t\tconfirm_link_deleting: \"\",\n\t\tlink_start: \" ()\",\n\t\tlink_end: \" ()\",\n\n\t\ttype_task: \"\",\n\t\ttype_project: \"\",\n\t\ttype_milestone: \"\",\n\n\t\tminutes: \"\",\n\t\thours: \"\",\n\t\tdays: \"\",\n\t\tweeks: \"\",\n\t\tmonths: \"\",\n\t\tyears: \"\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Leden\", \"nor\", \"Bezen\", \"Duben\", \"Kvten\", \"erven\", \"ervenec\", \"Srpen\", \"Z\", \"jen\", \"Listopad\", \"Prosinec\"],\n\t\tmonth_short: [\"Led\", \"n\", \"Be\", \"Dub\", \"Kv\", \"er\", \"ec\", \"Srp\", \"Z\", \"j\", \"List\", \"Pro\"],\n\t\tday_full: [\"Nedle\", \"Pondl\", \"ter\", \"Steda\", \"tvrtek\", \"Ptek\", \"Sobota\"],\n\t\tday_short: [\"Ne\", \"Po\", \"t\", \"St\", \"t\", \"P\", \"So\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nov prce\",\n\t\ticon_save: \"Uloit\",\n\t\ticon_cancel: \"Zpt\",\n\t\ticon_details: \"Detail\",\n\t\ticon_edit: \"Edituj\",\n\t\ticon_delete: \"Smazat\",\n\t\tconfirm_closing: \"\", // Vae zmny budou ztraceny, opravdu ?\n\t\tconfirm_deleting: \"Udlost bude trvale smazna, opravdu?\",\n\t\tsection_description: \"Poznmky\",\n\t\tsection_time: \"Doba platnosti\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Zpt\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Januar\", \"Februar\", \"Marts\", \"April\", \"Maj\", \"Juni\", \"Juli\", \"August\", \"September\", \"Oktober\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Maj\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Sndag\", \"Mandag\", \"Tirsdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lrdag\"],\n\t\tday_short: [\"Sn\", \"Man\", \"Tir\", \"Ons\", \"Tor\", \"Fre\", \"Lr\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Ny opgave\",\n\t\ticon_save: \"Gem\",\n\t\ticon_cancel: \"Fortryd\",\n\t\ticon_details: \"Detaljer\",\n\t\ticon_edit: \"Tilret\",\n\t\ticon_delete: \"Slet\",\n\t\tconfirm_closing: \"Dine rettelser vil g tabt.. Er dy sikker?\", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Bigivenheden vil blive slettet permanent. Er du sikker?\",\n\t\tsection_description: \"Beskrivelse\",\n\t\tsection_time: \"Tidsperiode\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Fortryd\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\" Januar\", \" Februar\", \" Mrz \", \" April\", \" Mai\", \" Juni\", \" Juli\", \" August\", \" September \", \" Oktober\", \" November \", \" Dezember\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mr\", \"Apr\", \"Mai\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dez\"],\n\t\tday_full: [\"Sonntag\", \"Montag\", \"Dienstag\", \" Mittwoch\", \" Donnerstag\", \"Freitag\", \"Samstag\"],\n\t\tday_short: [\"So\", \"Mo\", \"Di\", \"Mi\", \"Do\", \"Fr\", \"Sa\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Neue Aufgabe\",\n\t\ticon_save: \"Speichern\",\n\t\ticon_cancel: \"Abbrechen\",\n\t\ticon_details: \"Details\",\n\t\ticon_edit: \"ndern\",\n\t\ticon_delete: \"Lschen\",\n\t\tconfirm_closing: \"\", // \"Ihre Vernderungen werden verloren sein, wollen Sie ergnzen? \"\n\t\tconfirm_deleting: \"Der Eintrag wird gelscht\",\n\t\tsection_description: \"Beschreibung\",\n\t\tsection_time: \"Zeitspanne\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"PSP\",\n\t\tcolumn_text: \"Task-Namen\",\n\t\tcolumn_start_date: \"Startzeit\",\n\t\tcolumn_duration: \"Dauer\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"werden gelscht\",\n\t\tlink_start: \"(starten)\",\n\t\tlink_end: \"(ende)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minuten\",\n\t\thours: \"Stunden\",\n\t\tdays: \"Tage\",\n\t\tweeks: \"Wochen\",\n\t\tmonths: \"Monate\",\n\t\tyears: \"Jahre\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Abbrechen\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Regel\",\n\t\tconstraint_type: \"Regel\",\n\t\tconstraint_date: \"Regel - Datum\",\n\t\tasap: \"So bald wie mglich\",\n\t\talap: \"So spt wie mglich\",\n\t\tsnet: \"Beginn nicht vor\",\n\t\tsnlt: \"Beginn nicht spter als\",\n\t\tfnet: \"Fertigstellung nicht vor\",\n\t\tfnlt: \"Fertigstellung nicht spter als\",\n\t\tmso: \"Muss beginnen am\",\n\t\tmfo: \"Muss fertig sein am\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tmonth_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t},\n\tlabels: {\n\t\tnew_task: \" \",\n\t\ticon_save: \"\",\n\t\ticon_cancel: \"\",\n\t\ticon_details: \"\",\n\t\ticon_edit: \"\",\n\t\ticon_delete: \"\",\n\t\tconfirm_closing: \"\", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"    .   ;\",\n\t\tsection_description: \"\",\n\t\tsection_time: \" \",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"],\n\t\tday_short: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"New task\",\n\t\ticon_save: \"Save\",\n\t\ticon_cancel: \"Cancel\",\n\t\ticon_details: \"Details\",\n\t\ticon_edit: \"Edit\",\n\t\ticon_delete: \"Delete\",\n\t\tconfirm_closing: \"\",// Your changes will be lost, are you sure?\n\t\tconfirm_deleting: \"Task will be deleted permanently, are you sure?\",\n\t\tsection_description: \"Description\",\n\t\tsection_time: \"Time period\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\n\t\t/* grid columns */\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Cancel\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\t\t\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;","/*\n @Autor Manuel Fernandez Panzuela - www.mfernandez.es\n\n Update 30/10/2015:\n Translation of new labels by Jorge Macias\n https://disqus.com/by/disqus_bTuZk1voC7/\n */\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Enero\", \"Febrero\", \"Marzo\", \"Abril\", \"Mayo\", \"Junio\", \"Julio\", \"Agosto\", \"Septiembre\", \"Octubre\", \"Noviembre\", \"Diciembre\"],\n\t\tmonth_short: [\"Ene\", \"Feb\", \"Mar\", \"Abr\", \"May\", \"Jun\", \"Jul\", \"Ago\", \"Sep\", \"Oct\", \"Nov\", \"Dic\"],\n\t\tday_full: [\"Domingo\", \"Lunes\", \"Martes\", \"Mircoles\", \"Jueves\", \"Viernes\", \"Sbado\"],\n\t\tday_short: [\"Dom\", \"Lun\", \"Mar\", \"Mi\", \"Jue\", \"Vie\", \"Sb\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nueva tarea\",\n\t\ticon_save: \"Guardar\",\n\t\ticon_cancel: \"Cancelar\",\n\t\ticon_details: \"Detalles\",\n\t\ticon_edit: \"Editar\",\n\t\ticon_delete: \"Eliminar\",\n\t\tconfirm_closing: \"\", // \"Sus cambios se perdern, continuar ?\"\n\t\tconfirm_deleting: \"El evento se borrar definitivamente, continuar?\",\n\t\tsection_description: \"Descripcin\",\n\t\tsection_time: \"Perodo\",\n\t\tsection_type: \"Tipo\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"EDT\",\n\t\tcolumn_text: \"Tarea\",\n\t\tcolumn_start_date: \"Inicio\",\n\t\tcolumn_duration: \"Duracin\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Enlace\",\n\t\tconfirm_link_deleting: \"ser borrada\",\n\t\tlink_start: \" (inicio)\",\n\t\tlink_end: \" (fin)\",\n\n\t\ttype_task: \"Tarea\",\n\t\ttype_project: \"Proyecto\",\n\t\ttype_milestone: \"Hito\",\n\n\n\t\tminutes: \"Minutos\",\n\t\thours: \"Horas\",\n\t\tdays: \"Das\",\n\t\tweeks: \"Semanas\",\n\t\tmonths: \"Meses\",\n\t\tyears: \"Aos\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Cancelar\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n dhtmlxGantt Persian (Farsi, fa_IR) locale by Mohammad Shokri http://slashsbin.com/\n */\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\"\n\t\t],\n\t\tmonth_short: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\n\t\tday_full: [\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\"\n\t\t],\n\t\tday_short: [\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\"\n\t\t]\n\t},\n\tlabels: {\n\t\tnew_task: \" \",\n\t\ticon_save: \"\",\n\t\ticon_cancel: \"\",\n\t\ticon_details: \"\",\n\t\ticon_edit: \"\",\n\t\ticon_delete: \"\",\n\t\tconfirm_closing: \"       \",\n\t\tconfirm_deleting: \"         \",\n\t\tsection_description: \"\",\n\t\tsection_time: \" \",\n\t\tsection_type: \"\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"\",\n\t\tcolumn_start_date: \" \",\n\t\tcolumn_duration: \"\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"\",\n\t\tconfirm_link_deleting: \"  \",\n\t\tlink_start: \" ()\",\n\t\tlink_end: \" ()\",\n\n\t\ttype_task: \"\",\n\t\ttype_project: \"\",\n\t\ttype_milestone: \"\",\n\n\t\tminutes: \"\",\n\t\thours: \"\",\n\t\tdays: \"\",\n\t\tweeks: \"\",\n\t\tmonths: \"\",\n\t\tyears: \"\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"\",\n\t\tmessage_cancel: \"\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Tammikuu\", \"Helmikuu\", \"Maaliskuu\", \"Huhtikuu\", \"Toukokuu\", \"Kes&auml;kuu\", \"Hein&auml;kuu\", \"Elokuu\", \"Syyskuu\", \"Lokakuu\", \"Marraskuu\", \"Joulukuu\"],\n\t\tmonth_short: [\"Tam\", \"Hel\", \"Maa\", \"Huh\", \"Tou\", \"Kes\", \"Hei\", \"Elo\", \"Syy\", \"Lok\", \"Mar\", \"Jou\"],\n\t\tday_full: [\"Sunnuntai\", \"Maanantai\", \"Tiistai\", \"Keskiviikko\", \"Torstai\", \"Perjantai\", \"Lauantai\"],\n\t\tday_short: [\"Su\", \"Ma\", \"Ti\", \"Ke\", \"To\", \"Pe\", \"La\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Uusi tehtv\",\n\t\ticon_save: \"Tallenna\",\n\t\ticon_cancel: \"Peru\",\n\t\ticon_details: \"Tiedot\",\n\t\ticon_edit: \"Muokkaa\",\n\t\ticon_delete: \"Poista\",\n\t\tconfirm_closing: \"\", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Haluatko varmasti poistaa tapahtuman?\",\n\t\tsection_description: \"Kuvaus\",\n\t\tsection_time: \"Aikajakso\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Peru\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Janvier\", \"Fvrier\", \"Mars\", \"Avril\", \"Mai\", \"Juin\", \"Juillet\", \"Aot\", \"Septembre\", \"Octobre\", \"Novembre\", \"Dcembre\"],\n\t\tmonth_short: [\"Jan\", \"Fv\", \"Mar\", \"Avr\", \"Mai\", \"Juin\", \"Juil\", \"Ao\", \"Sep\", \"Oct\", \"Nov\", \"Dc\"],\n\t\tday_full: [\"Dimanche\", \"Lundi\", \"Mardi\", \"Mercredi\", \"Jeudi\", \"Vendredi\", \"Samedi\"],\n\t\tday_short: [\"Dim\", \"Lun\", \"Mar\", \"Mer\", \"Jeu\", \"Ven\", \"Sam\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nouvelle tche\",\n\t\ticon_save: \"Enregistrer\",\n\t\ticon_cancel: \"Annuler\",\n\t\ticon_details: \"Dtails\",\n\t\ticon_edit: \"Modifier\",\n\t\ticon_delete: \"Effacer\",\n\t\tconfirm_closing: \"\",// Vos modifications seront perdus, tes-vous sr ?\n\t\tconfirm_deleting: \"L'vnement sera effac sans appel, tes-vous sr ?\",\n\n\t\tsection_description: \"Description\",\n\t\tsection_time: \"Priode\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"OTP\",\n\t\tcolumn_text: \"Nom de la tche\",\n\t\tcolumn_start_date: \"Date initiale\",\n\t\tcolumn_duration: \"Dure\",\n\t\tcolumn_add: \"\",\n\n\n\t\t/* link confirmation */\n\t\tlink: \"Le lien\",\n\t\tconfirm_link_deleting: \"sera supprim\",\n\t\tlink_start: \"(dbut)\",\n\t\tlink_end: \"(fin)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Heures\",\n\t\tdays: \"Jours\",\n\t\tweeks: \"Semaines\",\n\t\tmonths: \"Mois\",\n\t\tyears: \"Annes\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Annuler\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tmonth_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t},\n\tlabels: {\n\t\tnew_task: \" \",\n\t\ticon_save: \"\",\n\t\ticon_cancel: \"\",\n\t\ticon_details: \"\",\n\t\ticon_edit: \"\",\n\t\ticon_delete: \"\",\n\t\tconfirm_closing: \"\", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"  .?\",\n\t\tsection_description: \"\",\n\t\tsection_time: \"\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n  Translation by Davor\n http://docs.dhtmlx.com/gantt/desktop__localization.html#comment-2569116291\n */\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Sijeanj\", \"Veljaa\", \"Oujak\", \"Travanj\", \"Svibanj\", \"Lipanj\", \"Srpanj\", \"Kolovoz\", \"Rujan\", \"Listopad\", \"Studeni\", \"Prosinac\"],\n\t\tmonth_short: [\"Sij\", \"Velj\", \"Ou\", \"Tra\", \"Svi\", \"Lip\", \"Srp\", \"Kol\", \"Ruj\", \"Lis\", \"Stu\", \"Pro\"],\n\t\tday_full: [\"Nedjelja\", \"Ponedjeljak\", \"Utorak\", \"Srijeda\", \"etvrtak\", \"Petak\", \"Subota\"],\n\t\tday_short: [\"Ned\", \"Pon\", \"Uto\", \"Sri\", \"et\", \"Pet\", \"Sub\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Novi Zadatak\",\n\t\ticon_save: \"Spremi\",\n\t\ticon_cancel: \"Odustani\",\n\t\ticon_details: \"Detalji\",\n\t\ticon_edit: \"Izmjeni\",\n\t\ticon_delete: \"Obrii\",\n\t\tconfirm_closing: \"\",\n\t\tconfirm_deleting: \"Zadatak e biti trajno izbrisan, jeste li sigurni?\",\n\t\tsection_description: \"Opis\",\n\t\tsection_time: \"Vremenski Period\",\n\t\tsection_type: \"Tip\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\n\t\t/* grid columns */\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Naziv Zadatka\",\n\t\tcolumn_start_date: \"Poetno Vrijeme\",\n\t\tcolumn_duration: \"Trajanje\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Poveznica\",\n\t\tconfirm_link_deleting: \"e biti izbrisan\",\n\t\tlink_start: \" (poetak)\",\n\t\tlink_end: \" (kraj)\",\n\n\t\ttype_task: \"Zadatak\",\n\t\ttype_project: \"Projekt\",\n\t\ttype_milestone: \"Milestone\",\n\n\t\tminutes: \"Minute\",\n\t\thours: \"Sati\",\n\t\tdays: \"Dani\",\n\t\tweeks: \"Tjedni\",\n\t\tmonths: \"Mjeseci\",\n\t\tyears: \"Godine\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Odustani\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Janur\", \"Februr\", \"Mrcius\", \"prilis\", \"Mjus\", \"Jnius\", \"Jlius\", \"Augusztus\", \"Szeptember\", \"Oktber\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mr\", \"pr\", \"Mj\", \"Jn\", \"Jl\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Vasrnap\", \"Htf\", \"Kedd\", \"Szerda\", \"Cstrtk\", \"Pntek\", \"szombat\"],\n\t\tday_short: [\"Va\", \"H\", \"Ke\", \"Sze\", \"Cs\", \"P\", \"Szo\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"j feladat\",\n\t\ticon_save: \"Ments\",\n\t\ticon_cancel: \"Mgse\",\n\t\ticon_details: \"Rszletek\",\n\t\ticon_edit: \"Szerkeszts\",\n\t\ticon_delete: \"Trls\",\n\t\tconfirm_closing: \"\", // A vltozsok elvesznek, biztosan folytatja? \"\n\t\tconfirm_deleting: \"Az esemny trlve lesz, biztosan folytatja?\",\n\t\tsection_description: \"Lers\",\n\t\tsection_time: \"Idszak\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Mgse\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Januari\", \"Februari\", \"Maret\", \"April\", \"Mei\", \"Juni\", \"Juli\", \"Agustus\", \"September\", \"Oktober\", \"November\", \"Desember\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Mei\", \"Jun\", \"Jul\", \"Ags\", \"Sep\", \"Okt\", \"Nov\", \"Des\"],\n\t\tday_full: [\"Minggu\", \"Senin\", \"Selasa\", \"Rabu\", \"Kamis\", \"Jumat\", \"Sabtu\"],\n\t\tday_short: [\"Ming\", \"Sen\", \"Sel\", \"Rab\", \"Kam\", \"Jum\", \"Sab\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Tugas baru\",\n\t\ticon_save: \"Simpan\",\n\t\ticon_cancel: \"Batal\",\n\t\ticon_details: \"Detail\",\n\t\ticon_edit: \"Edit\",\n\t\ticon_delete: \"Hapus\",\n\t\tconfirm_closing: \"\", /* Perubahan tidak akan disimpan ? */\n\t\tconfirm_deleting: \"Acara akan dihapus\",\n\t\tsection_description: \"Keterangan\",\n\t\tsection_time: \"Periode\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Batal\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n Update 29/12/2015:\n New labels translation by ARCANGELI CLAUDIO\n\n */\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Gennaio\", \"Febbraio\", \"Marzo\", \"Aprile\", \"Maggio\", \"Giugno\", \"Luglio\", \"Agosto\", \"Settembre\", \"Ottobre\", \"Novembre\", \"Dicembre\"],\n\t\tmonth_short: [\"Gen\", \"Feb\", \"Mar\", \"Apr\", \"Mag\", \"Giu\", \"Lug\", \"Ago\", \"Set\", \"Ott\", \"Nov\", \"Dic\"],\n\t\tday_full: [\"Domenica\", \"Luned\", \"Marted\", \"Mercoled\", \"Gioved\", \"Venerd\", \"Sabato\"],\n\t\tday_short: [\"Dom\", \"Lun\", \"Mar\", \"Mer\", \"Gio\", \"Ven\", \"Sab\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nuovo compito\",\n\t\ticon_save: \"Salva\",\n\t\ticon_cancel: \"Chiudi\",\n\t\ticon_details: \"Dettagli\",\n\t\ticon_edit: \"Modifica\",\n\t\ticon_delete: \"Elimina\",\n\t\tconfirm_closing: \"\",// \"Sei sicuro di confermare la chiusura?\",\n\t\tconfirm_deleting: \"Sei sicuro di confermare l'eliminazione?\",\n\t\tsection_description: \"Descrizione\",\n\t\tsection_time: \"Periodo di tempo\",\n\t\tsection_type: \"Tipo\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Nome Attivit\",\n\t\tcolumn_start_date: \"Inizio\",\n\t\tcolumn_duration: \"Durata\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"sar eliminato\",\n\t\tlink_start: \" (inizio)\",\n\t\tlink_end: \" (fine)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minuti\",\n\t\thours: \"Ore\",\n\t\tdays: \"Giorni\",\n\t\tweeks: \"Settimane\",\n\t\tmonths: \"Mesi\",\n\t\tyears: \"Anni\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Chiudi\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n Translation by Genexus Japan Inc.\n */\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\n\t\tmonth_short: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"\",\n\t\ticon_save: \"\",\n\t\ticon_cancel: \"\",\n\t\ticon_details: \"\",\n\t\ticon_edit: \"\",\n\t\ticon_delete: \"\",\n\t\tconfirm_closing: \"\", // \n\t\tconfirm_deleting: \"\",\n\t\tsection_description: \"\",\n\t\tsection_time: \"\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n\tTranslated by cjkim@dbvalley.com\n*/\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\n\t\tmonth_short: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t},\n\tlabels: {\n\t\tnew_task: \" \",\n\t\ticon_save: \"\",\n\t\ticon_cancel: \"\",\n\t\ticon_details: \" \",\n\t\ticon_edit: \"\",\n\t\ticon_delete: \"\",\n\t\tconfirm_closing: \"\",\n\t\tconfirm_deleting: \" ?\",\n\t\tsection_description: \"\",\n\t\tsection_time: \"\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"\",\n\t\tcolumn_start_date: \"\",\n\t\tcolumn_duration: \"\",\n\t\tcolumn_add: \"\",\n\t\tlink: \"\",\n\t\tconfirm_link_deleting: \" ?\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\t\ttype_task: \"\",\n\t\ttype_project: \"\",\n\t\ttype_milestone: \"\",\n\t\tminutes: \"\",\n\t\thours: \"\",\n\t\tdays: \"\",\n\t\tweeks: \"\",\n\t\tmonths: \"\",\n\t\tyears: \"\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","export default class LocaleManager{\n\tprivate _locales:{[key:string]: IGanttLocale };\n\n\tconstructor(config: {[key:string]: IGanttLocale }){\n\t\tthis._locales = {};\n\t\tfor(const i in config){\n\t\t\tthis._locales[i] = config[i];\n\t\t}\n\t}\n\n\taddLocale = (name: string, locale: IGanttLocale) => {\n\t\tthis._locales[name] = locale;\n\t};\n\n\tgetLocale = (name: string): IGanttLocale => {\n\t\treturn this._locales[name];\n\t};\n}","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Januar\", \"Februar\", \"Mars\", \"April\", \"Mai\", \"Juni\", \"Juli\", \"August\", \"September\", \"Oktober\", \"November\", \"Desember\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Mai\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Des\"],\n\t\tday_full: [\"Sndag\", \"Mandag\", \"Tirsdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lrdag\"],\n\t\tday_short: [\"Sn\", \"Mon\", \"Tir\", \"Ons\", \"Tor\", \"Fre\", \"Lr\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Ny oppgave\",\n\t\ticon_save: \"Lagre\",\n\t\ticon_cancel: \"Avbryt\",\n\t\ticon_details: \"Detaljer\",\n\t\ticon_edit: \"Rediger\",\n\t\ticon_delete: \"Slett\",\n\t\tconfirm_closing: \"\", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Hendelsen vil bli slettet permanent. Er du sikker?\",\n\t\tsection_description: \"Beskrivelse\",\n\t\tsection_time: \"Tidsperiode\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Avbryt\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Januari\", \"Februari\", \"Maart\", \"April\", \"Mei\", \"Juni\", \"Juli\", \"Augustus\", \"September\", \"Oktober\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"mrt\", \"Apr\", \"Mei\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Zondag\", \"Maandag\", \"Dinsdag\", \"Woensdag\", \"Donderdag\", \"Vrijdag\", \"Zaterdag\"],\n\t\tday_short: [\"Zo\", \"Ma\", \"Di\", \"Wo\", \"Do\", \"Vr\", \"Za\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nieuwe taak\",\n\t\ticon_save: \"Opslaan\",\n\t\ticon_cancel: \"Annuleren\",\n\t\ticon_details: \"Details\",\n\t\ticon_edit: \"Bewerken\",\n\t\ticon_delete: \"Verwijderen\",\n\t\tconfirm_closing: \"\", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Item zal permanent worden verwijderd, doorgaan?\",\n\t\tsection_description: \"Beschrijving\",\n\t\tsection_time: \"Tijd periode\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Taak omschrijving\",\n\t\tcolumn_start_date: \"Startdatum\",\n\t\tcolumn_duration: \"Duur\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Koppeling\",\n\t\tconfirm_link_deleting: \"zal worden verwijderd\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (eind)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"minuten\",\n\t\thours: \"uren\",\n\t\tdays: \"dagen\",\n\t\tweeks: \"weken\",\n\t\tmonths: \"maanden\",\n\t\tyears: \"jaren\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Annuleren\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Januar\", \"Februar\", \"Mars\", \"April\", \"Mai\", \"Juni\", \"Juli\", \"August\", \"September\", \"Oktober\", \"November\", \"Desember\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Mai\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Des\"],\n\t\tday_full: [\"Sndag\", \"Mandag\", \"Tirsdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lrdag\"],\n\t\tday_short: [\"Sn\", \"Man\", \"Tir\", \"Ons\", \"Tor\", \"Fre\", \"Lr\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Ny oppgave\",\n\t\ticon_save: \"Lagre\",\n\t\ticon_cancel: \"Avbryt\",\n\t\ticon_details: \"Detaljer\",\n\t\ticon_edit: \"Endre\",\n\t\ticon_delete: \"Slett\",\n\t\tconfirm_closing: \"Endringer blir ikke lagret, er du sikker?\", // Endringer blir ikke lagret, er du sikker?\n\t\tconfirm_deleting: \"Oppfringen vil bli slettet, er du sikker?\",\n\t\tsection_description: \"Beskrivelse\",\n\t\tsection_time: \"Tidsperiode\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Avbryt\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Stycze\", \"Luty\", \"Marzec\", \"Kwiecie\", \"Maj\", \"Czerwiec\", \"Lipiec\", \"Sierpie\", \"Wrzesie\", \"Padziernik\", \"Listopad\", \"Grudzie\"],\n\t\tmonth_short: [\"Sty\", \"Lut\", \"Mar\", \"Kwi\", \"Maj\", \"Cze\", \"Lip\", \"Sie\", \"Wrz\", \"Pa\", \"Lis\", \"Gru\"],\n\t\tday_full: [\"Niedziela\", \"Poniedziaek\", \"Wtorek\", \"roda\", \"Czwartek\", \"Pitek\", \"Sobota\"],\n\t\tday_short: [\"Nie\", \"Pon\", \"Wto\", \"ro\", \"Czw\", \"Pi\", \"Sob\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nowe zadanie\",\n\t\ticon_save: \"Zapisz\",\n\t\ticon_cancel: \"Anuluj\",\n\t\ticon_details: \"Szczegy\",\n\t\ticon_edit: \"Edytuj\",\n\t\ticon_delete: \"Usu\",\n\t\tconfirm_closing: \"\", // Zmiany zostan usunite, jeste pewien?\n\t\tconfirm_deleting: \"Zdarzenie zostanie usunite na zawsze, kontynuowa?\",\n\t\tsection_description: \"Opis\",\n\t\tsection_time: \"Okres czasu\",\n\t\tsection_type: \"Typ\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Nazwa zadania\",\n\t\tcolumn_start_date: \"Pocztek\",\n\t\tcolumn_duration: \"Czas trwania\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"zostanie usunity\",\n\t\tlink_start: \" (pocztek)\",\n\t\tlink_end: \" (koniec)\",\n\n\t\ttype_task: \"Zadanie\",\n\t\ttype_project: \"Projekt\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minuty\",\n\t\thours: \"Godziny\",\n\t\tdays: \"Dni\",\n\t\tweeks: \"Tydzie\",\n\t\tmonths: \"Miesice\",\n\t\tyears: \"Lata\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Anuluj\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n\n TRANSLATION BY MATTHEUS PIROVANI RORIZ GONALVES\n\n mattheusroriz@hotmail.com / mattheus.pirovani@gmail.com /\n\n www.atrixian.com.br\n\n\n Updated by Jorge Albernaz Martins\n\n jorgefox@hotmail.com\n\n www.redfox.inf.br\n\n JorgeFox\n\n*/\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Janeiro\", \"Fevereiro\", \"Maro\", \"Abril\", \"Maio\", \"Junho\", \"Julho\", \"Agosto\", \"Setembro\", \"Outubro\", \"Novembro\", \"Dezembro\"],\n\t\tmonth_short: [\"Jan\", \"Fev\", \"Mar\", \"Abr\", \"Mai\", \"Jun\", \"Jul\", \"Ago\", \"Set\", \"Out\", \"Nov\", \"Dez\"],\n\t\tday_full: [\"Domingo\", \"Segunda\", \"Tera\", \"Quarta\", \"Quinta\", \"Sexta\", \"Sbado\"],\n\t\tday_short: [\"Dom\", \"Seg\", \"Ter\", \"Qua\", \"Qui\", \"Sex\", \"Sab\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nova tarefa\",\n\t\ticon_save: \"Salvar\",\n\t\ticon_cancel: \"Cancelar\",\n\t\ticon_details: \"Detalhes\",\n\t\ticon_edit: \"Editar\",\n\t\ticon_delete: \"Excluir\",\n\t\tconfirm_closing: \"\",// Suas alteraes sero perdidas, confirme?\n\t\tconfirm_deleting: \"As tarefas sero excluidas permanentemente, confirme?\",\n\t\tsection_description: \"Descrio\",\n\t\tsection_time: \"Perodo\",\n\t\tsection_type: \"Tipo\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"EAP\",\n\t\tcolumn_text: \"Nome tarefa\",\n\t\tcolumn_start_date: \"Data incio\",\n\t\tcolumn_duration: \"Durao\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"Ser excludo!\",\n\t\tlink_start: \" (incio)\",\n\t\tlink_end: \" (fim)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Projeto\",\n\t\ttype_milestone: \"Marco\",\n\n\n\t\tminutes: \"Minutos\",\n\t\thours: \"Horas\",\n\t\tdays: \"Dias\",\n\t\tweeks: \"Semanas\",\n\t\tmonths: \"Meses\",\n\t\tyears: \"Anos\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Cancelar\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Restrio\",\n\t\tconstraint_type: \"Tipo Restrio\",\n\t\tconstraint_date: \"Data restrio\",\n\t\tasap: \"Mais breve possvel\",\n\t\talap: \"Mais tarde possvel\",\n\t\tsnet: \"No comear antes de\",\n\t\tsnlt: \"No comear depois de\",\n\t\tfnet: \"No terminar antes de\",\n\t\tfnlt: \"No terminar depois de\",\n\t\tmso: \"Precisa comear em\",\n\t\tmfo: \"Precisa terminar em\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n\tTraducere de Ovidiu Lixandru: http://www.madball.ro\n */\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Ianuarie\", \"Februarie\", \"Martie\", \"Aprilie\", \"Mai\", \"Iunie\", \"Iulie\", \"August\", \"Septembrie\", \"Octombrie\", \"November\", \"December\"],\n\t\tmonth_short: [\"Ian\", \"Feb\", \"Mar\", \"Apr\", \"Mai\", \"Iun\", \"Iul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Duminica\", \"Luni\", \"Marti\", \"Miercuri\", \"Joi\", \"Vineri\", \"Sambata\"],\n\t\tday_short: [\"Du\", \"Lu\", \"Ma\", \"Mi\", \"Jo\", \"Vi\", \"Sa\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Sarcina noua\",\n\t\ticon_save: \"Salveaza\",\n\t\ticon_cancel: \"Anuleaza\",\n\t\ticon_details: \"Detalii\",\n\t\ticon_edit: \"Editeaza\",\n\t\ticon_delete: \"Sterge\",\n\t\tconfirm_closing: \"Schimbarile nu vor fi salvate, esti sigur?\",// Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Evenimentul va fi sters permanent, esti sigur?\",\n\t\tsection_description: \"Descriere\",\n\t\tsection_time: \"Interval\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Anuleaza\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"\", \"\", \"\", \"\", \"Ma\", \"\", \"\", \"\", \"\", \"O\", \"\", \"\"],\n\t\tmonth_short: [\"\", \"\", \"Ma\", \"A\", \"Ma\", \"\", \"\", \"A\", \"\", \"\", \"\", \"\"],\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t},\n\tlabels: {\n\t\tnew_task: \" \",\n\t\ticon_save: \"\",\n\t\ticon_cancel: \"\",\n\t\ticon_details: \"\",\n\t\ticon_edit: \"\",\n\t\ticon_delete: \"\",\n\t\tconfirm_closing: \"\", //    , ?\n\t\tconfirm_deleting: \"   , ?\",\n\t\tsection_description: \"\",\n\t\tsection_time: \" \",\n\t\tsection_type: \"\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"\",\n\t\tcolumn_text: \"\",\n\t\tcolumn_start_date: \"\",\n\t\tcolumn_duration: \"\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"\",\n\t\tconfirm_link_deleting: \" \",\n\t\tlink_start: \" ()\",\n\t\tlink_end: \" ()\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"\",\n\t\thours: \"\",\n\t\tdays: \"\",\n\t\tweeks: \"\",\n\t\tmonths: \"\",\n\t\tyears: \"\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Januar\", \"Februar\", \"Marec\", \"April\", \"Maj\", \"Junij\", \"Julij\", \"Avgust\", \"September\", \"Oktober\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Maj\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Nedelja\", \"Ponedeljek\", \"Torek\", \"Sreda\", \"etrtek\", \"Petek\", \"Sobota\"],\n\t\tday_short: [\"Ned\", \"Pon\", \"Tor\", \"Sre\", \"et\", \"Pet\", \"Sob\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nova naloga\",\n\t\ticon_save: \"Shrani\",\n\t\ticon_cancel: \"Preklii\",\n\t\ticon_details: \"Podrobnosti\",\n\t\ticon_edit: \"Uredi\",\n\t\ticon_delete: \"Izbrii\",\n\t\tconfirm_closing: \"\", // Spremembe ne bodo shranjene. elite nadaljevati ?\n\t\tconfirm_deleting: \"Dogodek bo izbrisan. elite nadaljevati?\",\n\t\tsection_description: \"Opis\",\n\t\tsection_time: \"asovni okvir\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Preklii\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Janur\", \"Februr\", \"Marec\", \"Aprl\", \"Mj\", \"Jn\", \"Jl\", \"August\", \"September\", \"Oktber\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Mj\", \"Jn\", \"Jl\", \"Aug\", \"Sept\", \"Okt\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Nedea\", \"Pondelok\", \"Utorok\", \"Streda\", \"tvrtok\", \"Piatok\", \"Sobota\"],\n\t\tday_short: [\"Ne\", \"Po\", \"Ut\", \"St\", \"t\", \"Pi\", \"So\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nov loha\",\n\t\ticon_save: \"Uloi\",\n\t\ticon_cancel: \"Sp\",\n\t\ticon_details: \"Detail\",\n\t\ticon_edit: \"Edituj\",\n\t\ticon_delete: \"Zmaza\",\n\t\tconfirm_closing: \"Vae zmeny nebud uloen. Skutone?\", // Vae zmny budou ztraceny, opravdu ?\n\t\tconfirm_deleting: \"Udalos bude natrvalo vymazan. Skutone?\",\n\t\tsection_description: \"Poznmky\",\n\t\tsection_time: \"Doba platnosti\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Sp\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n\tTranslation by Peter Eriksson\n */\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Januari\", \"Februari\", \"Mars\", \"April\", \"Maj\", \"Juni\", \"Juli\", \"Augusti\", \"September\", \"Oktober\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Maj\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Sndag\", \"Mndag\", \"Tisdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lrdag\"],\n\t\tday_short: [\"Sn\", \"Mn\", \"Tis\", \"Ons\", \"Tor\", \"Fre\", \"Lr\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Ny uppgift\",\n\t\ticon_save: \"Spara\",\n\t\ticon_cancel: \"Avbryt\",\n\t\ticon_details: \"Detajer\",\n\t\ticon_edit: \"ndra\",\n\t\ticon_delete: \"Ta bort\",\n\t\tconfirm_closing: \"\",\n\t\tconfirm_deleting: \"r du sker p att du vill ta bort hndelsen permanent?\",\n\t\tsection_description: \"Beskrivning\",\n\t\tsection_time: \"Tid\",\n\t\tsection_type: \"Typ\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Uppgiftsnamn\",\n\t\tcolumn_start_date: \"Starttid\",\n\t\tcolumn_duration: \"Varaktighet\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\n\t\tlink: \"Lnk\",\n\t\tconfirm_link_deleting: \"kommer tas bort\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (slut)\",\n\t\ttype_task: \"Uppgift\",\n\t\ttype_project: \"Projekt\",\n\t\ttype_milestone: \"Milstolpe\",\n\n\t\tminutes: \"Minuter\",\n\t\thours: \"Timmar\",\n\t\tdays: \"Dagar\",\n\t\tweeks: \"Veckor\",\n\t\tmonths: \"Mnader\",\n\t\tyears: \"r\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Avbryt\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n * updated by @levkar at https://github.com/DHTMLX/gantt/pull/10\n */\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Ocak\", \"ubat\", \"Mart\", \"Nisan\", \"Mays\", \"Haziran\", \"Temmuz\", \"Austos\", \"Eyll\", \"Ekim\", \"Kasm\", \"Aralk\"],\n\t\tmonth_short: [\"Oca\", \"ub\", \"Mar\", \"Nis\", \"May\", \"Haz\", \"Tem\", \"Au\", \"Eyl\", \"Eki\", \"Kas\", \"Ara\"],\n\t\tday_full: [\"Pazar\", \"Pazartesi\", \"Sal\", \"aramba\", \"Perembe\", \"Cuma\", \"Cumartesi\"],\n\t\tday_short: [\"Paz\", \"Pzt\", \"Sal\", \"ar\", \"Per\", \"Cum\", \"Cmt\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Yeni grev\",\n\t\ticon_save: \"Kaydet\",\n\t\ticon_cancel: \"ptal\",\n\t\ticon_details: \"Detaylar\",\n\t\ticon_edit: \"Dzenle\",\n\t\ticon_delete: \"Sil\",\n\t\tconfirm_closing: \"\", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Grev silinecek, emin misiniz?\",\n\t\tsection_description: \"Aklama\",\n\t\tsection_time: \"Zaman Aral\",\n\t\tsection_type: \"Tip\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Grev Ad\",\n\t\tcolumn_start_date: \"Balang\",\n\t\tcolumn_duration: \"Sre\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Balant\",\n\t\tconfirm_link_deleting: \"silinecek\",\n\t\tlink_start: \" (balang)\",\n\t\tlink_end: \" (biti)\",\n\n\t\ttype_task: \"Grev\",\n\t\ttype_project: \"Proje\",\n\t\ttype_milestone: \"Kilometreta\",\n\n\n\t\tminutes: \"Dakika\",\n\t\thours: \"Saat\",\n\t\tdays: \"Gn\",\n\t\tweeks: \"Hafta\",\n\t\tmonths: \"Ay\",\n\t\tyears: \"Yl\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"ptal\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tmonth_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"'\", \"\"],\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t},\n\tlabels: {\n\t\tnew_task: \" \",\n\t\ticon_save: \"\",\n\t\ticon_cancel: \"\",\n\t\ticon_details: \"\",\n\t\ticon_edit: \"\",\n\t\ticon_delete: \"\",\n\t\tconfirm_closing: \"\", //   .   ?\n\t\tconfirm_deleting: \"  .  ?\",\n\t\tsection_description: \"\",\n\t\tsection_time: \" \",\n\t\tsection_type: \"\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","import * as utils from \"../utils/utils\";\nimport constants from \"../constants\";\nimport ExtensionManager from \"../ext/extension_manager\";\n\nimport services from \"../core/common/services\";\nimport config from \"../core/common/config\";\nimport ajax from \"../core/common/ajax\";\nimport date from \"../core/common/date\";\nimport {remoteEvents} from \"../core/remote/remote_events\";\n\nimport DnD from \"../core/common/dnd\";\nimport templates from \"../core/common/templates\";\nimport eventable from \"../utils/eventable\";\n\nimport StateService from \"../core/common/state\";\n\nimport Promise from \"../utils/promise\";\nimport env from \"../utils/env\";\nimport datastoreHooks from \"../core/datastore/datastore_hooks\";\nimport DataProcessor from \"../core/dataprocessor\";\n\nimport plugins from \"../core/plugins\";\n\nimport grid_column_api from \"../core/grid_column_api\";\nimport tasks from \"../core/tasks\";\nimport parsing from \"../core/loading/parsing\";\nimport work_time from \"../core/worktime/work_time\";\nimport data from \"../core/data\";\n\nimport void_script_second from \"../publish_helpers/void_script_second\";\n\nimport data_task_types from \"../core/data_task_types\";\nimport cached_functions from \"../core/cached_functions\";\n\nimport gantt_core from \"../core/gantt_core\";\nimport destructor from \"../core/destructor\";\nimport void_script_third from \"../publish_helpers/void_script_third\";\n\nimport i18nFactory from \"../locale\";\n\nfunction DHXGantt(){\n\tthis.constants = constants;\n\tthis.version = VERSION;\n\tthis.license = LICENSE;\n\tthis.templates = {};\n\tthis.ext = {};\n\tthis.keys = {\n\t\tedit_save: this.constants.KEY_CODES.ENTER,\n\t\tedit_cancel: this.constants.KEY_CODES.ESC\n\t};\n}\n\nexport default function(supportedExtensions) {\n\t// use a named constructor to make gantt instance discoverable in heap snapshots\n\tvar gantt = new DHXGantt();\n\n\tvar extensionManager = new ExtensionManager(supportedExtensions);\n\tvar activePlugins = {};\n\tgantt.plugins = function(config){\n\t\tfor(var i in config){\n\t\t\tif(config[i] && !activePlugins[i]){\n\t\t\t\tvar plugin = extensionManager.getExtension(i);\n\t\t\t\tif(plugin){\n\t\t\t\t\tplugin(gantt);\n\t\t\t\t\tactivePlugins[i] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn activePlugins;\n\t};\n\n\tgantt.$services = services();\n\tgantt.config = config();\n\tgantt.ajax =  ajax(gantt);\n\tgantt.date = date(gantt);\n\tgantt.RemoteEvents = remoteEvents;\n\n\tvar dnd = DnD(gantt);\n\tgantt.$services.setService(\"dnd\", function(){return dnd;});\n\n\tvar templatesLoader = templates(gantt);\n\tgantt.$services.setService(\"templateLoader\", function () {\n\t\treturn templatesLoader;\n\t});\n\n\teventable(gantt);\n\n\t\n\tvar stateService = new StateService();\n\n\tstateService.registerProvider(\"global\", function () {\n\t\tvar res = {\n\t\t\tmin_date: gantt._min_date,\n\t\t\tmax_date: gantt._max_date,\n\t\t\tselected_task: null\n\t\t};\n\n\t\t// do not throw error if getState called from non-initialized gantt\n\t\tif(gantt.$data && gantt.$data.tasksStore){\n\t\t\tres.selected_task = gantt.$data.tasksStore.getSelectedId();\n\t\t}\n\t\treturn res;\n\t});\n\tgantt.getState = stateService.getState;\n\tgantt.$services.setService(\"state\", function () {\n\t\treturn stateService;\n\t});\n\n\tutils.mixin(gantt, utils);\n\n\tgantt.Promise = Promise;\n\tgantt.env = env;\n\n\tdatastoreHooks(gantt);\n\n\tgantt.dataProcessor = DataProcessor.DEPRECATED_api;\n\tgantt.createDataProcessor = DataProcessor.createDataProcessor;\n\n\tplugins(gantt);\n\n\tgrid_column_api(gantt);\n\ttasks(gantt);\n\tparsing(gantt);\n\twork_time(gantt);\n\tdata(gantt);\n\n\tvoid_script_second(gantt);\n\n\tdata_task_types(gantt);\n\tcached_functions(gantt);\n\n\tgantt_core(gantt);\n\tdestructor(gantt);\n\tvoid_script_third(gantt);\n\n\tvar i18n = i18nFactory();\n\tgantt.i18n = {\n\t\taddLocale: i18n.addLocale,\n\t\tsetLocale: function(locale){\n\t\t\tif(typeof locale === \"string\"){\n\t\t\t\tvar localeObject = i18n.getLocale(locale);\n\t\t\t\tif(!localeObject){\n\t\t\t\t\tlocaleObject = i18n.getLocale(\"en\");\n\t\t\t\t}\n\n\t\t\t\tgantt.locale = localeObject;\n\t\t\t}else if(locale){\n\t\t\t\tif(!gantt.locale){\n\t\t\t\t\tgantt.locale = locale;\n\t\t\t\t}else{\n\t\t\t\t\tfor(var i in locale){\n\t\t\t\t\t\tif(locale[i] && typeof locale[i] === \"object\"){\n\t\t\t\t\t\t\tif(!gantt.locale[i]){\n\t\t\t\t\t\t\t\tgantt.locale[i] = {};\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tgantt.mixin(gantt.locale[i], locale[i], true);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tgantt.locale[i] = locale[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst labels = gantt.locale.labels;\n\t\t\tlabels.gantt_save_btn = labels.gantt_save_btn || labels.icon_save;\n\t\t\tlabels.gantt_cancel_btn = labels.gantt_cancel_btn || labels.icon_cancel;\n\t\t\tlabels.gantt_delete_btn = labels.gantt_delete_btn || labels.icon_delete;\n\t\t},\n\t\tgetLocale: i18n.getLocale\n\t};\n\tgantt.i18n.setLocale(\"en\");\n\treturn gantt;\n};","export default function(){\n\tvar services = {};\n\tfunction register (name, getter){\n\t\tservices[name] = getter;\n\t}\n\n\tfunction getService(name){\n\t\tif(!services[name]){\n\t\t\treturn null;\n\t\t}\n\t\treturn services[name]();\n\t}\n\n\tfunction dropService(name) {\n\t\tif (services[name]) {\n\t\t\tdelete services[name];\n\t\t}\n\t}\n\n\tvar servicesEnum = {};\n\n\treturn {\n\t\tservices: servicesEnum,\n\t\tsetService: register,\n\t\tgetService: getService,\n\t\tdropService: dropService,\n\t\tdestructor: function(){\n\t\t\tfor(var i in services){\n\t\t\t\tif(services[i]){\n\t\t\t\t\tvar service = services[i];\n\t\t\t\t\tif(service && service.destructor){\n\t\t\t\t\t\tservice.destructor();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tservices = null;\n\t\t}\n\t};\n};\n","type DurationUnits = \"minute\" | \"hour\" | \"day\" | \"week\" | \"month\" | \"year\";\ntype Align = \"left\" | \"center\" | \"right\";\ntype SectionType = \"textarea\"\n\t\t\t\t\t| \"time\"\n\t\t\t\t\t| \"duration\"\n\t\t\t\t\t| \"select\"\n\t\t\t\t\t| \"typeselect\"\n\t\t\t\t\t| \"parent\"\n\t\t\t\t\t| \"template\"\n\t\t\t\t\t| \"checkbox\"\n\t\t\t\t\t| \"radio\"\n\t\t\t\t\t| \"resources\"\n\t\t\t\t\t| \"constraint\";\n\ntype LightboxSection = Array<ILightboxSection\n\t| ILightboxTimeAndDurationSection\n\t| ILightboxInputControl\n\t| ILightboxSelectControl\n\t| ILightboxParentControl\n\t| ILightboxTypeselectControl>;\n\ntype LayoutView = \"grid\"\n\t| \"timeline\"\n\t| \"resizer\"\n\t| \"scrollbar\"\n\t| \"resourceGrid\"\n\t| \"resourceTimeline\";\n\ninterface IColumnItem {\n\tname: string;\n\tlabel?: string;\n\ttree?: boolean;\n\talign?: Align;\n\thide?: boolean;\n\tmax_width?: number;\n\tmin_width?: number;\n\tresize?: boolean;\n\ttemplate?: (obj: any) => string;\n\twidth?: number | \"*\";\n}\n\nexport type TModifierKeys = \"metaKey\" | \"ctrlKey\" | \"altKey\" | \"shiftKey\" | false | undefined;\n\nexport interface IScale {\n\tcss?: () => string;\n\tdate?: string;\n\tstep: number;\n\ttemplate?: (date: Date) => string;\n\tunit: DurationUnits;\n}\n\ninterface ILightboxSection {\n\tname: string;\n\tmap_to: string;\n\ttype: SectionType;\n\theight?: number;\n\tfocus?: boolean;\n}\n\ninterface ILightboxTimeAndDurationSection extends ILightboxSection {\n\treadonly: boolean;\n\tyear_range: number[] | number;\n\tsingle_date: boolean;\n\ttime_format: string;\n}\n\ninterface ILightboxInputControl extends ILightboxSection {\n\tdefault_value?: any;\n\toptions?: Array<{key: string, label: string}>;\n}\n\ninterface ILightboxSelectControl extends ILightboxInputControl {\n\tonchange: () => boolean | undefined;\n}\n\ninterface ILightboxParentControl extends ILightboxSection {\n\tallow_root: boolean;\n\troot_label: string;\n\tsort?: (a: any, b: any) => -1 | 0 | 1;\n\tfilter?: (task: string | number | object) => boolean;\n\ttemplate?: (start: Date, end: Date, ev: object) => string;\n}\n\ninterface ILightboxTypeselectControl extends ILightboxSection {\n\tfilter?: (typeName: string) => boolean;\n}\n\n\ninterface ILayoutScrollbar {\n\tview: \"scrollbar\";\n\tscroll?: \"x\" | \"y\";\n\tid: string;\n\theight?: number;\n\twidth?: number;\n}\n\ninterface ILayoutView {\n\tview: LayoutView;\n\tid?: string;\n\tscrollX?: string;\n\tscrollY?: string;\n\tconfig?: object;\n}\n\ninterface ILayoutGrid extends ILayoutView {\n\tview: \"grid\";\n\tbind?: string;\n}\n\ninterface ILayoutTimeline extends ILayoutView {\n\tview: \"timeline\";\n\tbindLinks?: string;\n\tlayers?: any[];\n}\n\ninterface ILayoutResizer {\n\tview?: undefined;\n\tresizer: boolean;\n\twidth: number;\n}\n\ninterface ILayoutResourceGrid extends ILayoutView {\n\tview: \"resourceGrid\";\n\twidth: number;\n\tgroup: \"string\";\n}\n\ninterface ILayoutResourceTimeline extends ILayoutView {\n\tview: \"resourceTimeline\";\n\twidth: number;\n\tgroup: \"string\";\n}\n\ninterface ILayoutHtml {\n\thtml: string;\n\tcss: string;\n\twidth: number;\n}\n\ntype LayoutRow = ILayoutGrid\n\t| ILayoutTimeline\n\t| ILayoutResizer\n\t| ILayoutResourceGrid\n\t| ILayoutResourceTimeline\n\t| ILayoutHtml\n\t| ILayoutScrollbar\n\t| { cols: LayoutCol[] };\n\ntype LayoutCol = ILayoutGrid\n\t| ILayoutTimeline\n\t| ILayoutResizer\n\t| ILayoutResourceGrid\n\t| ILayoutResourceTimeline\n\t| ILayoutHtml\n\t| ILayoutScrollbar\n\t| { rows: LayoutRow[] };\n\ninterface ILayout {\n\tcss: string;\n\trows?: LayoutRow[];\n\tcols?: LayoutCol[];\n}\n\ntype TCsp = boolean | \"auto\";\n\ninterface IResourceConfig {\n\tdataprocessor_assignments?: boolean;\n\tdataprocessor_resources?: boolean;\n\teditable_resource_diagram?: boolean;\n\tresource_store?: {\n\t\ttype?: \"treeDataStore\"|\"dataStore\"|string;\n\t\tfetchTasks?: boolean;\n\t\tinitItem?: (item: any) => any;\n\t};\n\tlightbox_resources?: (resources: any[]) => any[];\n\n}\n\ninterface IGanttConfig {\n\tlayout: ILayout;\n\tlinks: {\n\t\tfinish_to_start: \"0\";\n\t\tstart_to_start: \"1\";\n\t\tfinish_to_finish: \"2\";\n\t\tstart_to_finish: \"3\";\n\t};\n\ttypes: {\n\t\ttask: string;\n\t\tproject: string;\n\t\tmilestone: string;\n\t};\n\tauto_types: boolean;\n\tduration_unit: DurationUnits;\n\twork_time: boolean;\n\tcorrect_work_time: boolean;\n\tdeadlines: boolean;\n\tskip_off_time: boolean;\n\tcascade_delete: boolean;\n\tautosize: boolean | string;\n\tautoscroll: boolean;\n\tshow_links: boolean;\n\tshow_task_cells: boolean;\n\tautosize_min_width: number;\n\tautoscroll_speed: number;\n\tdeepcopy_on_parse: boolean;\n\tstatic_background: boolean;\n\tstatic_background_cells: boolean;\n\tbranch_loading: boolean;\n\tbranch_loading_property: string;\n\tshow_loading: boolean;\n\tshow_chart: boolean;\n\tshow_grid: boolean;\n\tmin_duration: number;\n\tdate_format: string; // use instead xml_date\n\txml_date?: string; // deprecated\n\tstart_on_monday: boolean;\n\tserver_utc: boolean;\n\tshow_progress: boolean;\n\tfit_tasks: boolean;\n\tselect_task: boolean;\n\tscroll_on_click: boolean;\n\tsmart_rendering: boolean;\n\tpreserve_scroll: boolean;\n\treadonly: boolean;\n\tcontainer_resize_timeout: number;\n\n\t/*grid */\n\tdate_grid: string;\n\n\tdrag_links: boolean;\n\tdrag_progress: boolean;\n\tdrag_resize: boolean;\n\tdrag_project: boolean;\n\tdrag_move: boolean;\n\tdrag_mode: {\n\t\tresize: \"resize\",\n\t\tprogress: \"progress\",\n\t\tmove: \"move\",\n\t\tignore: \"ignore\"\n\t};\n\tround_dnd_dates: boolean;\n\tlink_wrapper_width: number;\n\troot_id: string | number;\n\n\tlink_arrow_size:number;\n\n\tautofit: boolean;\n\tcolumns: IColumnItem[];\n\n\t/* scale*/\n\tscales: IScale[];\n\n\tscale_offset_minimal: boolean;\n\n\tinherit_scale_class: boolean;\n\n\n\ttime_step: number;\n\tduration_step: number;\n\n\n\ttask_date: string;\n\ttime_picker: string;\n\ttask_attribute: string;\n\tlink_attribute: string;\n\tlayer_attribute: string;\n\tbuttons_left: string[];\n\t_migrate_buttons: {\n\t\tdhx_save_btn: \"gantt_save_btn\",\n\t\tdhx_cancel_btn: \"gantt_cancel_btn\",\n\t\tdhx_delete_btn: \"gantt_delete_btn\"\n\t};\n\n\tbuttons_right: string[];\n\n\n\tlightbox: {\n\t\tsections?: LightboxSection,\n\t\tproject_sections?: LightboxSection,\n\t\tmilestone_sections?: LightboxSection\n\t};\n\tdrag_lightbox: boolean;\n\tsort: boolean;\n\tdetails_on_create: boolean;\n\tdetails_on_dblclick: boolean;\n\tinitial_scroll: boolean;\n\ttask_scroll_offset: number;\n\n\torder_branch: boolean;\n\torder_branch_free: boolean;\n\n\t// task_height is deprecated, use 'bar_height` instead\n\ttask_height: number | \"full\" | undefined;\n\tbar_height: number | \"full\";\n\tmin_column_width: number;\n\tbar_height_padding: number,\n\trow_height: number,\n\n\t// min width for grid column (when resizing)\n\tmin_grid_column_width: number;\n\t// name of the attribute with column index for resize element\n\tgrid_resizer_column_attribute: string;\n\t// name of the attribute with column index for resize element\n\t// grid_resizer_attribute: string; // usage of this parameter is not found\n\n\t// grid width can be increased after the column has been resized\n\tkeep_grid_width: boolean;\n\n\t// grid width can be adjusted\n\tgrid_resize: boolean;\n\tgrid_elastic_columns: boolean;\n\tshow_tasks_outside_timescale: boolean;\n\tshow_unscheduled: boolean;\n\treadonly_property: string;\n\teditable_property: string;\n\tcalendar_property: string;\n\tresource_calendars: object;\n\tdynamic_resource_calendars: boolean;\n\tinherit_calendar: boolean;\n\ttype_renderers: object;\n\n\tresize_rows: boolean;\n\t// name of the attribute with row index for resize element\n\ttask_grid_row_resizer_attribute: string;\n\t// min height for row (when resizing)\n\tmin_task_grid_row_height: number;\n\n\topen_tree_initially: boolean;\n\toptimize_render: boolean;\n\tprevent_default_scroll: boolean;\n\tshow_errors: boolean;\n\twai_aria_attributes: boolean;\n\tsmart_scales: boolean;\n\trtl: boolean;\n\tplaceholder_task: boolean | object;\n\thorizontal_scroll_key: TModifierKeys;\n\tdrag_timeline: {\n\t\tuseKey: TModifierKeys;\n\t\tignore: string;\n\t\trender?: boolean;\n\t};\n\tdrag_multiple: boolean;\n\tcsp: TCsp;\n\n\tresources?: IResourceConfig;\n\n\tauto_scheduling: object;\n}\n\nexport default () => {\n\tconst result: IGanttConfig = {\n\t\tlayout: {\n\t\t\tcss: \"gantt_container\",\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{view: \"grid\", scrollX: \"scrollHor\", scrollY: \"scrollVer\"},\n\t\t\t\t\t\t{resizer: true, width: 1},\n\t\t\t\t\t\t{view: \"timeline\", scrollX: \"scrollHor\", scrollY: \"scrollVer\"},\n\t\t\t\t\t\t{view: \"scrollbar\", id: \"scrollVer\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{view: \"scrollbar\", id: \"scrollHor\", height: 20}\n\t\t\t]\n\t\t},\n\t\tlinks: {\n\t\t\tfinish_to_start: \"0\",\n\t\t\tstart_to_start: \"1\",\n\t\t\tfinish_to_finish: \"2\",\n\t\t\tstart_to_finish: \"3\"\n\t\t},\n\t\ttypes: {\n\t\t\ttask: \"task\",\n\t\t\tproject: \"project\",\n\t\t\tmilestone: \"milestone\"\n\t\t},\n\t\tauto_types: false,\n\t\tduration_unit: \"day\",\n\t\twork_time: false,\n\t\tcorrect_work_time: false,\n\t\tskip_off_time: false,\n\n\t\tcascade_delete: true,\n\n\t\tautosize: false,\n\t\tautosize_min_width: 0,\n\t\tautoscroll: true,\n\t\tautoscroll_speed: 30,\n\t\tdeepcopy_on_parse: false,\n\t\tshow_links: true,\n\t\tshow_task_cells: true,\n\t\t// replace backgroung of the task area with a canvas img\n\t\tstatic_background: false,\n\t\tstatic_background_cells: true,\n\t\tbranch_loading: false,\n\t\tbranch_loading_property: \"$has_child\",\n\t\tshow_loading: false,\n\t\tshow_chart: true,\n\t\tshow_grid: true,\n\t\tmin_duration: 60 * 60 * 1000,\n\t\tdate_format: \"%d-%m-%Y %H:%i\", // use instead xml_date\n\t\txml_date: undefined, // \"%d-%m-%Y %H:%i\", // deprecated\n\t\tstart_on_monday: true,\n\t\tserver_utc: false,\n\t\tshow_progress: true,\n\t\tfit_tasks: false,\n\t\tselect_task: true,\n\t\tscroll_on_click: true,\n\t\tsmart_rendering: true,\n\t\tpreserve_scroll: true,\n\t\treadonly: false,\n\t\tcontainer_resize_timeout: 20,\n\t\tdeadlines: true,\n\n\t\t/*grid */\n\t\tdate_grid: \"%Y-%m-%d\",\n\n\t\tdrag_links: true,\n\t\tdrag_progress: true,\n\t\tdrag_resize: true,\n\t\tdrag_project: false,\n\t\tdrag_move: true,\n\t\tdrag_mode: {\n\t\t\tresize: \"resize\",\n\t\t\tprogress: \"progress\",\n\t\t\tmove: \"move\",\n\t\t\tignore: \"ignore\"\n\t\t},\n\t\tround_dnd_dates: true,\n\t\tlink_wrapper_width: 20,\n\t\tlink_arrow_size:12,\n\t\troot_id: 0,\n\n\t\tautofit: false, // grid column automatic fit grid_width config\n\t\tcolumns: [\n\t\t\t{name: \"text\", tree: true, width: \"*\", resize: true},\n\t\t\t{name: \"start_date\", align: \"center\", resize: true},\n\t\t\t{name: \"duration\", align: \"center\"},\n\t\t\t{name: \"add\", width: 44}\n\t\t],\n\n\t\t/*scale*/\n\n\t\tscale_offset_minimal: true,\n\t\tinherit_scale_class: false,\n\n\t\tscales: [\n\t\t\t{\n\t\t\t\tunit: \"day\",\n\t\t\t\tstep: 1,\n\t\t\t\tdate: \"%d %M\"\n\t\t\t}\n\t\t],\n\n\t\ttime_step: 60,\n\t\tduration_step: 1,\n\t\ttask_date: \"%d %F %Y\",\n\t\ttime_picker: \"%H:%i\",\n\t\ttask_attribute: \"data-task-id\",\n\t\tlink_attribute: \"data-link-id\",\n\t\tlayer_attribute: \"data-layer\",\n\t\tbuttons_left: [\n\t\t\t\"gantt_save_btn\",\n\t\t\t\"gantt_cancel_btn\"\n\t\t],\n\t\t_migrate_buttons: {\n\t\t\tdhx_save_btn: \"gantt_save_btn\",\n\t\t\tdhx_cancel_btn: \"gantt_cancel_btn\",\n\t\t\tdhx_delete_btn: \"gantt_delete_btn\"\n\t\t},\n\t\tbuttons_right: [\n\t\t\t\"gantt_delete_btn\"\n\t\t],\n\t\tlightbox: {\n\t\t\tsections: [\n\t\t\t\t{name: \"description\", height: 70, map_to: \"text\", type: \"textarea\", focus: true},\n\t\t\t\t{name: \"time\", type: \"duration\", map_to: \"auto\"}\n\t\t\t],\n\t\t\tproject_sections: [\n\t\t\t\t{name: \"description\", height: 70, map_to: \"text\", type: \"textarea\", focus: true},\n\t\t\t\t{name: \"type\", type: \"typeselect\", map_to: \"type\"},\n\t\t\t\t{name: \"time\", type: \"duration\", readonly: true, map_to: \"auto\"}\n\t\t\t],\n\t\t\tmilestone_sections: [\n\t\t\t\t{name: \"description\", height: 70, map_to: \"text\", type: \"textarea\", focus: true},\n\t\t\t\t{name: \"type\", type: \"typeselect\", map_to: \"type\"},\n\t\t\t\t{name: \"time\", type: \"duration\", single_date: true, map_to: \"auto\"}\n\t\t\t]\n\t\t},\n\t\tdrag_lightbox: true,\n\t\tsort: false,\n\t\tdetails_on_create: true,\n\t\tdetails_on_dblclick: true,\n\t\tinitial_scroll: true,\n\t\ttask_scroll_offset: 100,\n\n\t\torder_branch: false,\n\t\torder_branch_free: false,\n\n\t\t// task height is deprecated, use 'bar_height' instead\n\t\ttask_height: undefined,// number px of 'full' for row height\n\t\tbar_height: \"full\",\n\t\tbar_height_padding:9,\n\t\tmin_column_width: 70,\n\n\t\t// min width for grid column (when resizing)\n\t\tmin_grid_column_width: 70,\n\t\t// name of the attribute with column index for resize element\n\t\tgrid_resizer_column_attribute: \"data-column-index\",\n\t\t// name of the attribute with column index for resize element\n\t\t// grid_resizer_attribute: \"grid_resizer\", // - usage of this parameter is not found in code\n\n\t\t// grid width can be increased after the column has been resized\n\t\tkeep_grid_width: false,\n\n\t\t// grid width can be adjusted\n\t\tgrid_resize: false,\n\t\tgrid_elastic_columns: false,\n\t\tshow_tasks_outside_timescale: false,\n\t\tshow_unscheduled: true,\n\n\t\tresize_rows: false,\n\t\t// name of the attribute with row index for resize element\n\t\ttask_grid_row_resizer_attribute: \"data-row-index\",\n\t\t// min height for row (when resizing)\n\t\tmin_task_grid_row_height: 30,\n\t\trow_height: 36,\n\n\t\t//\n\t\treadonly_property: \"readonly\",\n\t\teditable_property: \"editable\",\n\t\tcalendar_property: \"calendar_id\",\n\t\tresource_calendars: {},\n\t\tdynamic_resource_calendars: false,\n\t\tinherit_calendar: false,\n\t\ttype_renderers: {},\n\n\t\topen_tree_initially: false,\n\t\toptimize_render: true,\n\t\tprevent_default_scroll: false,\n\t\tshow_errors: true,\n\t\twai_aria_attributes: true,\n\t\tsmart_scales: true,\n\t\trtl:false,\n\t\tplaceholder_task: false,\n\t\thorizontal_scroll_key: \"shiftKey\",\n\t\tdrag_timeline: {\n\t\t\tuseKey: undefined,\n\t\t\tignore: \".gantt_task_line, .gantt_task_link\",\n\t\t\trender: false\n\t\t},\n\t\tdrag_multiple: true,\n\t\tcsp: \"auto\",\n\t\tauto_scheduling: {}\n\t};\n\treturn result;\n};\n","import eventable from \"../../utils/eventable\";\nimport * as utils from \"../../utils/utils\";\nimport timeout from \"../../utils/timeout\";\nimport global from \"../../utils/global\";\nimport * as domHelpers from \"../ui/utils/dom_helpers\";\n\nexport default function(gantt){\n\n\tfunction copyDomEvent(e){\n\t\treturn {\n\t\t\ttarget: e.target || e.srcElement,\n\t\t\tpageX: e.pageX,\n\t\t\tpageY: e.pageY,\n\t\t\tclientX: e.clientX,\n\t\t\tclientY: e.clientY,\n\t\t\tmetaKey: e.metaKey,\n\t\t\tshiftKey: e.shiftKey,\n\t\t\tctrlKey: e.ctrlKey,\n\t\t\taltKey: e.altKey\n\t\t};\n\t}\n\n\tfunction DnD(obj, config) {\n\t\tthis._obj = obj;\n\t\tthis._settings = config || {};\n\t\teventable(this);\n\n\t\tvar inputMethods = this.getInputMethods();\n\n\t\tthis._drag_start_timer = null;\n\t\tgantt.attachEvent(\"onGanttScroll\", utils.bind(function (left, top) {\n\t\t\tthis.clearDragTimer();\n\t\t}, this));\n\n\t\tvar lastDown = 0;\n\t\tvar eventParams = {passive: false};\n\t\tfor(var i = 0; i < inputMethods.length; i++){\n\t\t\t(utils.bind(function(input){\n\n\t\t\t\tgantt.event(obj, input.down, utils.bind(function (e) {\n\t\t\t\t\tif(!input.accessor(e)){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (typeof e.button !== 'undefined' && e.button !== 0) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(config.preventDefault && config.selector && domHelpers.closest(e.target, config.selector)){\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (gantt.config.touch && e.timeStamp && e.timeStamp - lastDown < 300) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis._settings.original_target = copyDomEvent(e);\n\n\t\t\t\t\tthis._settings.original_element_sizes = {\n\t\t\t\t\t\t...domHelpers.getRelativeEventPosition(e, domHelpers.getClosestSizedElement(obj)), \n\t\t\t\t\t\twidth: e.target.offsetWidth,\n\t\t\t\t\t\theight: e.target.offsetHeight\n\t\t\t\t\t};\n\n\t\t\t\t\tif (gantt.config.touch) {\n\t\t\t\t\t\tthis.clearDragTimer();\n\t\t\t\t\t\tthis._drag_start_timer = setTimeout(utils.bind(function () {\n\t\t\t\t\t\t\tif(gantt.getState().lightbox){\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.dragStart(obj, e, input);\n\t\t\t\t\t\t}, this), gantt.config.touch_drag);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis.dragStart(obj, e, input);\n\t\t\t\t\t}\n\t\t\t\t}, this), eventParams);\n\t\t\t\tvar eventElement = document.body;\n\t\t\t\tgantt.event(eventElement, input.up, utils.bind(function (e) {\n\t\t\t\t\tif(!input.accessor(e)){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis.clearDragTimer();\n\t\t\t\t}, this), eventParams);\n\n\t\t\t}, this))(inputMethods[i]);\n\t\t}\n\t}\n\n\tDnD.prototype = {\n\t\ttraceDragEvents: function (domElement, inputMethod) {\n\t\t\tvar mousemove = utils.bind(function (e) {\n\t\t\t\treturn this.dragMove(domElement, e, inputMethod.accessor);\n\t\t\t}, this);\n\t\t\tutils.bind(function (e) {\n\t\t\t\treturn this.dragScroll(domElement, e);\n\t\t\t}, this);\n\n\t\t\tvar limited_mousemove = utils.bind(function (e) {\n\t\t\t\tif (this.config.started && utils.defined(this.config.updates_per_second)) {\n\t\t\t\t\tif (!timeout(this, this.config.updates_per_second))\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar dndActive = mousemove(e);\n\n\t\t\t\tif (dndActive) {\n\t\t\t\t\ttry{\n\t\t\t\t\t\tif (e && e.preventDefault && e.cancelable){//e.cancelable condition - because navigator.vibrate is blocked by Chrome\n\t\t\t\t\t\t\te.preventDefault();//Cancel default action on DND\n\t\t\t\t\t\t} //Cancel default action on DND\n\t\t\t\t\t}catch (e){\n\t\t\t\t\t\t// just suppress the exception, nothing needed to be done here\n\t\t\t\t\t}\n\n\t\t\t\t\t//e.cancelBubble = true;\n\t\t\t\t}\n\n\t\t\t\treturn dndActive;\n\t\t\t}, this);\n\t\t\tvar eventElement = domHelpers.getRootNode(gantt.$root);\n\t\t\tvar mousemoveContainer = this.config.mousemoveContainer || domHelpers.getRootNode(gantt.$root);\n\n\t\t\tvar eventParams = {passive: false};\n\t\t\tvar mouseup = utils.bind(function (e) {\n\t\t\t\tgantt.eventRemove(mousemoveContainer, inputMethod.move, limited_mousemove);\n\t\t\t\tgantt.eventRemove(eventElement, inputMethod.up, mouseup, eventParams);\n\t\t\t\treturn this.dragEnd(domElement);\n\t\t\t}, this);\n\n\t\t\tgantt.event(mousemoveContainer, inputMethod.move, limited_mousemove, eventParams);\n\t\t\tgantt.event(eventElement, inputMethod.up, mouseup, eventParams);\n\t\t},\n\t\tcheckPositionChange: function (pos) {\n\t\t\tvar diff_x = pos.x - this.config.pos.x;\n\t\t\tvar diff_y = pos.y - this.config.pos.y;\n\t\t\tvar distance = Math.sqrt(Math.pow(Math.abs(diff_x), 2) + Math.pow(Math.abs(diff_y), 2));\n\n\t\t\tif (distance > this.config.sensitivity) {\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tinitDnDMarker: function () {\n\t\t\t// create dnd placeholder and put it in dom\n\t\t\tvar marker = this.config.marker = document.createElement(\"div\");\n\t\t\tmarker.className = \"gantt_drag_marker\";\n\t\t\t// GS-1333: don't show any message when we resize grid columns\n\t\t\tmarker.innerHTML = \"\";\n\t\t\tdocument.body.appendChild(marker);\n\t\t},\n\t\tbackupEventTarget: function (domEvent, getEvent) {\n\t\t\tif (!gantt.config.touch) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// keep original event target in DOM in order to keep dnd on touchmove event\n\t\t\tvar e = getEvent(domEvent);\n\n\t\t\tvar el = e.target || e.srcElement;\n\t\t\tvar copy = el.cloneNode(true);\n\t\t\t//this.config.target.target = copy;\n\t\t\tthis.config.original_target = copyDomEvent(e);\n\t\t\tthis.config.original_target.target = copy;\n\t\t\tthis.config.backup_element = el;\n\t\t\tel.parentNode.appendChild(copy);\n\n\t\t\tel.style.display = \"none\";\n\t\t\tvar mousemoveContainer = this.config.mousemoveContainer || document.body;\n\t\t\tmousemoveContainer.appendChild(el);\n\t\t},\n\t\tgetInputMethods: function () {\n\t\t\t// bind actions to browser events\n\t\t\tvar inputMethods = [];\n\n\t\t\tinputMethods.push({\n\t\t\t\t\"move\": \"mousemove\",\n\t\t\t\t\"down\": \"mousedown\",\n\t\t\t\t\"up\": \"mouseup\",\n\t\t\t\t\"accessor\": function (e) {\n\t\t\t\t\treturn e;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (gantt.config.touch) {\n\t\t\t\tconst touchEventsSupported = !gantt.env.isIE || !!global.maxTouchPoints;\n\n\t\t\t\tif(touchEventsSupported){\n\t\t\t\t\tinputMethods.push({\n\t\t\t\t\t\t\"move\": \"touchmove\",\n\t\t\t\t\t\t\"down\": \"touchstart\",\n\t\t\t\t\t\t\"up\": \"touchend\",\n\t\t\t\t\t\t\"accessor\": function (ev) {\n\t\t\t\t\t\t\tif (ev.touches && ev.touches.length > 1) return null;\n\t\t\t\t\t\t\tif (ev.touches[0])\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\ttarget: document.elementFromPoint(ev.touches[0].clientX, ev.touches[0].clientY),\n\t\t\t\t\t\t\t\t\tpageX: ev.touches[0].pageX,\n\t\t\t\t\t\t\t\t\tpageY: ev.touches[0].pageY,\n\t\t\t\t\t\t\t\t\tclientX: ev.touches[0].clientX,\n\t\t\t\t\t\t\t\t\tclientY: ev.touches[0].clientY\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\treturn ev;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}else if(global.PointerEvent){\n\t\t\t\t\tinputMethods.push({\n\t\t\t\t\t\t\"move\": \"pointermove\",\n\t\t\t\t\t\t\"down\": \"pointerdown\",\n\t\t\t\t\t\t\"up\": \"pointerup\",\n\t\t\t\t\t\t\"accessor\": function (ev) {\n\t\t\t\t\t\t\tif (ev.pointerType == \"mouse\") return null;\n\t\t\t\t\t\t\treturn ev;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn inputMethods;\n\t\t},\n\t\tclearDragTimer: function () {\n\t\t\tif (this._drag_start_timer) {\n\t\t\t\tclearTimeout(this._drag_start_timer);\n\t\t\t\tthis._drag_start_timer = null;\n\t\t\t}\n\t\t},\n\t\tdragStart: function (obj, e, inputMethod) {\n\t\t\tif (this.config && this.config.started) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.config = {\n\t\t\t\tobj: obj,\n\t\t\t\tmarker: null,\n\t\t\t\tstarted: false,\n\t\t\t\tpos: this.getPosition(e),\n\t\t\t\tsensitivity: 4\n\t\t\t};\n\t\t\tif (this._settings)\n\t\t\t\tutils.mixin(this.config, this._settings, true);\n\n\n\t\t\tthis.traceDragEvents(obj, inputMethod);\n\n\t\t\tgantt._prevent_touch_scroll = true;\n\t\t\t// GS-2664. Prevent grid scroll only if we can reorder rows\n\t\t\tif (e.target.closest(\".gantt_row\") && !gantt.config.order_branch){\n\t\t\t\tgantt._prevent_touch_scroll = false;\n\t\t\t}\n\t\t\tdocument.body.classList.add(\"gantt_noselect\");\n\n\t\t\tif (gantt.config.touch) {\n\t\t\t\tthis.dragMove(obj, e, inputMethod.accessor);\n\t\t\t}\n\n\t\t},\n\t\tdragMove: function (obj, e, getEvent) {\n\t\t\tvar source = getEvent(e);\n\t\t\tif (!source) return false;\n\n\t\t\tif (!this.config.marker && !this.config.started) {\n\t\t\t\tvar pos = this.getPosition(source);\n\n\t\t\t\tif (gantt.config.touch || this.checkPositionChange(pos)) {\n\t\t\t\t\t// real drag starts here,\n\t\t\t\t\t// when user moves mouse at first time after onmousedown\n\t\t\t\t\tthis.config.started = true;\n\t\t\t\t\tthis.config.ignore = false;\n\t\t\t\t\tgantt._touch_drag = true;\n\t\t\t\t\tif (this.callEvent(\"onBeforeDragStart\", [obj, this.config.original_target]) === false) {\n\t\t\t\t\t\tthis.config.ignore = true;\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tthis.backupEventTarget(e, getEvent);\n\t\t\t\t\tthis.initDnDMarker();\n\t\t\t\t\tgantt._touch_feedback();\n\t\t\t\t\tthis.callEvent(\"onAfterDragStart\", [obj, this.config.original_target]);\n\t\t\t\t} else {\n\t\t\t\t\tthis.config.ignore = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!this.config.ignore) {\n\t\t\t\t// GS-1279 Gantt crashes on Mobile Firefox after starting to create a link and moving finger outisde the page.\n\t\t\t\tif (e.targetTouches && !source.target) return;\n\t\t\t\t\n\t\t\t\tsource.pos = this.getPosition(source);\n\t\t\t\tthis.config.marker.style.left = source.pos.x + \"px\";\n\t\t\t\tthis.config.marker.style.top = source.pos.y + \"px\";\n\t\t\t\tthis.callEvent(\"onDragMove\", [obj, source]);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\n\t\tdragEnd: function (obj) {\n\t\t\tvar target = this.config.backup_element;\n\t\t\tif (target && target.parentNode) {\n\t\t\t\ttarget.parentNode.removeChild(target);\n\t\t\t}\n\t\t\tgantt._prevent_touch_scroll = false;\n\t\t\tif (this.config.marker) {\n\t\t\t\tthis.config.marker.parentNode.removeChild(this.config.marker);\n\t\t\t\tthis.config.marker = null;\n\n\t\t\t\tthis.callEvent(\"onDragEnd\", []);\n\t\t\t}\n\t\t\tthis.config.started = false;\n\t\t\tgantt._touch_drag = false;\n\t\t\tdocument.body.classList.remove(\"gantt_noselect\");\n\t\t},\n\n\t\tgetPosition: function (e) {\n\t\t\tvar x = 0, y = 0;\n\t\t\tif (e.pageX || e.pageY) {\n\t\t\t\tx = e.pageX;\n\t\t\t\ty = e.pageY;\n\t\t\t} else if (e.clientX || e.clientY) {\n\t\t\t\tx = e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft;\n\t\t\t\ty = e.clientY + document.body.scrollTop + document.documentElement.scrollTop;\n\t\t\t}\n\t\t\treturn {x: x, y: y};\n\t\t}\n\t};\n\n\treturn DnD;\n};\n","export default function(gantt) {\n\n\tvar regTemplates = {};\n\n\tfunction initTemplate(name, initial, template_name) {\n\t\ttemplate_name = template_name || name;\n\t\tvar config = gantt.config,\n\t\t\ttemplates = gantt.templates;\n\n\t\tif (gantt.config[name] && regTemplates[template_name] != config[name]) {\n\t\t\tif (!(initial && templates[template_name])) {\n\t\t\t\ttemplates[template_name] = gantt.date.date_to_str(config[name]);\n\t\t\t\tregTemplates[template_name] = config[name];\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction initTemplates() {\n\t\tvar date = gantt.date;\n\n\t\t//build configuration based templates\n\t\tvar d = date.date_to_str;\n\t\tvar c = gantt.config;\n\t\tvar format_date = d(c.xml_date || c.date_format, c.server_utc);\n\t\tvar parse_date = date.str_to_date(c.xml_date || c.date_format, c.server_utc);\n\n\t\tinitTemplate(\"date_scale\", true, undefined, gantt.config, gantt.templates);\n\t\tinitTemplate(\"date_grid\", true, \"grid_date_format\", gantt.config, gantt.templates);\n\t\tinitTemplate(\"task_date\", true, undefined, gantt.config, gantt.templates);\n\n\t\tgantt.mixin(gantt.templates, {\n\t\t\txml_format: undefined, // deprecated\n\t\t\tformat_date: format_date,\n\n\t\t\txml_date: undefined, // deprecated\n\t\t\tparse_date: parse_date,\n\n\t\t\tprogress_text: function (start, end, task) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\tgrid_header_class: function (column, config) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\n\t\t\ttask_text: function (start, end, task) {\n\t\t\t\treturn task.text;\n\t\t\t},\n\t\t\ttask_class: function (start, end, task) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\ttask_end_date: function (date) {\n\t\t\t\treturn gantt.templates.task_date(date);\n\t\t\t},\n\t\t\tgrid_row_class: function (start, end, task) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\ttask_row_class: function (start, end, task) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\ttimeline_cell_class: function (item, date) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\ttimeline_cell_content: function (item, date) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\tscale_cell_class: function (date) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\tscale_row_class: function (date) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\n\t\t\tgrid_indent: function (item) {\n\t\t\t\treturn \"<div class='gantt_tree_indent'></div>\";\n\t\t\t},\n\t\t\tgrid_folder: function (item) {\n\t\t\t\treturn \"<div class='gantt_tree_icon gantt_folder_\" + (item.$open ? \"open\" : \"closed\") + \"'></div>\";\n\t\t\t},\n\t\t\tgrid_file: function (item) {\n\t\t\t\treturn \"<div class='gantt_tree_icon gantt_file'></div>\";\n\t\t\t},\n\t\t\tgrid_open: function (item) {\n\t\t\t\treturn \"<div class='gantt_tree_icon gantt_\" + (item.$open ? \"close\" : \"open\") + \"'></div>\";\n\t\t\t},\n\t\t\tgrid_blank: function (item) {\n\t\t\t\treturn \"<div class='gantt_tree_icon gantt_blank'></div>\";\n\t\t\t},\n\t\t\tdate_grid: function (date, item, column) {\n\t\t\t\tif (item && gantt.isUnscheduledTask(item) && gantt.config.show_unscheduled) {\n\t\t\t\t\treturn gantt.templates.task_unscheduled_time(item);\n\t\t\t\t} else {\n\t\t\t\t\treturn gantt.templates.grid_date_format(date, column);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\ttask_time: function (start, end, ev) {\n\t\t\t\tif (gantt.isUnscheduledTask(ev) && gantt.config.show_unscheduled) {\n\t\t\t\t\treturn gantt.templates.task_unscheduled_time(ev);\n\t\t\t\t} else {\n\t\t\t\t\treturn gantt.templates.task_date(start) + \" - \" + gantt.templates.task_end_date(end);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\ttask_unscheduled_time: function (task) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\n\t\t\ttime_picker: d(c.time_picker),\n\t\t\tlink_class: function (link) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\tlink_description: function (link) {\n\t\t\t\tvar from = gantt.getTask(link.source),\n\t\t\t\t\tto = gantt.getTask(link.target);\n\n\t\t\t\treturn \"<b>\" + from.text + \"</b> &ndash;  <b>\" + to.text + \"</b>\";\n\t\t\t},\n\n\t\t\tdrag_link: function (from, from_start, to, to_start) {\n\t\t\t\tfrom = gantt.getTask(from);\n\t\t\t\tvar labels = gantt.locale.labels;\n\n\t\t\t\tvar text = \"<b>\" + from.text + \"</b> \" + (from_start ? labels.link_start : labels.link_end) + \"<br/>\";\n\t\t\t\tif (to) {\n\t\t\t\t\tto = gantt.getTask(to);\n\t\t\t\t\ttext += \"<b> \" + to.text + \"</b> \" + (to_start ? labels.link_start : labels.link_end) + \"<br/>\";\n\t\t\t\t}\n\t\t\t\treturn text;\n\t\t\t},\n\t\t\tdrag_link_class: function (from, from_start, to, to_start) {\n\t\t\t\tvar add = \"\";\n\n\t\t\t\tif (from && to) {\n\t\t\t\t\tvar allowed = gantt.isLinkAllowed(from, to, from_start, to_start);\n\t\t\t\t\tadd = \" \" + (allowed ? \"gantt_link_allow\" : \"gantt_link_deny\");\n\t\t\t\t}\n\n\t\t\t\treturn \"gantt_link_tooltip\" + add;\n\t\t\t},\n\n\t\t\t/* used for aria-labels of bar elements and for tooltip.js */\n\t\t\ttooltip_date_format: date.date_to_str(\"%Y-%m-%d\"),\n\t\t\ttooltip_text: function (start, end, event) {\n\t\t\t\treturn `<div>Task: ${event.text}</div>\n\t\t\t\t<div>Start date: ${gantt.templates.tooltip_date_format(start)}</div>\n\t\t\t\t<div>End date: ${gantt.templates.tooltip_date_format(end)}</div>`;\n\t\t\t},\n\t\t\tbaseline_text: function (task, baseline, index) {\n\t\t\t\treturn \"\";\n\t\t\t}\n\t\t});\n\t}\n\n\treturn {\n\t\tinitTemplates: initTemplates,\n\t\tinitTemplate: initTemplate\n\t};\n\n};","import * as utils from \"../../utils/utils\";\nimport facadeFactory from \"./../facades/datastore\";\nimport calculateScaleRange from \"../gantt_data_range\";\nimport isPlaceholderTask from \"../../utils/placeholder_task\";\n\nimport treeHelper from \"../../utils/task_tree_helpers\";\n\nfunction initDataStores(gantt){\n\n\tvar facade = facadeFactory.create();\n\tutils.mixin(gantt, facade);\n\tvar tasksStore = gantt.createDatastore({\n\t\tname: \"task\",\n\t\ttype: \"treeDatastore\",\n\t\trootId: function() { return gantt.config.root_id; },\n\t\tinitItem: utils.bind(_init_task, gantt),\n\t\tgetConfig: function() { return gantt.config; }\n\t});\n\n\tvar linksStore = gantt.createDatastore({\n\t\tname: \"link\",\n\t\tinitItem: utils.bind(_init_link, gantt)\n\t});\n\n\tgantt.attachEvent(\"onDestroy\", function(){\n\t\ttasksStore.destructor();\n\t\tlinksStore.destructor();\n\t});\n\n\tgantt.attachEvent(\"onLinkValidation\", function(link){\n\t\tif(gantt.isLinkExists(link.id) || link.id === \"predecessor_generated\"){\n\t\t\t// link was already added into gantt\n\t\t\treturn true;\n\t\t}\n\t\tvar source = gantt.getTask(link.source);\n\t\tvar taskLinks = source.$source;\n\t\tfor (var i = 0; i < taskLinks.length; i++) {\n\t\t\tvar existingLink = gantt.getLink(taskLinks[i]);\n\n\t\t\tvar sourceMatch = link.source == existingLink.source;\n\t\t\tvar targetMatch = link.target == existingLink.target;\n\t\t\tvar typeMatch = link.type == existingLink.type;\n\n\t\t\t// prevent creating duplicated links from the UI\n\t\t\tif (sourceMatch && targetMatch && typeMatch) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t});\n\n\ttasksStore.attachEvent(\"onBeforeRefreshAll\", function(){\n\n\t\t// GS-2170 do not recalculate indexes and dates as the event will be called later in the onStoreUpdate event\n\t\tif (tasksStore._skipTaskRecalculation){\n\t\t\treturn;\n\t\t}\n\n\t\tvar order = tasksStore.getVisibleItems();\n\n\t\tfor(var i=0; i < order.length; i++){\n\t\t\tvar item = order[i];\n\t\t\titem.$index = i;\n\t\t\titem.$local_index = gantt.getTaskIndex(item.id);\n\t\t\tgantt.resetProjectDates(item);\n\t\t}\n\n\t});\n\n\ttasksStore.attachEvent(\"onFilterItem\", function(id, task) {\n\t\tif (gantt.config.show_tasks_outside_timescale) {\n\t\t\treturn true;\n\t\t}\n\t\tvar min = null, max = null;\n\t\tif (gantt.config.start_date && gantt.config.end_date) {\n\t\t\tif (gantt._isAllowedUnscheduledTask(task)) return true;\n\t\t\tmin = gantt.config.start_date.valueOf();\n\t\t\tmax = gantt.config.end_date.valueOf();\n\n\t\t\tif (+task.start_date > max || +task.end_date < +min)\n\t\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t});\n\n\ttasksStore.attachEvent(\"onIdChange\", function(oldId, newId){\n\t\tgantt._update_flags(oldId, newId);\n\n\t\tvar changedTask = gantt.getTask(newId);\n\t\tif(!tasksStore.isSilent()){\n\t\t\tif(changedTask.$split_subtask || changedTask.rollup){\n\t\t\t\tgantt.eachParent(function(parent){\n\t\t\t\t\tgantt.refreshTask(parent.id);\n\t\t\t\t}, newId);\n\t\t\t}\n\t\t}\n\t});\n\n\ttasksStore.attachEvent(\"onAfterUpdate\", function(id){\n\t\tgantt._update_parents(id);\n\t\tif(gantt.getState(\"batchUpdate\").batch_update){\n\t\t\treturn true;\n\t\t}\n\n\t\tvar task = tasksStore.getItem(id);\n\t\tif (!task.$source) task.$source = [];\n\t\tfor (var i = 0; i < task.$source.length; i++) {\n\t\t\tlinksStore.refresh(task.$source[i]);\n\t\t}\n\t\tif (!task.$target) task.$target = [];\n\t\tfor (var i = 0; i < task.$target.length; i++) {\n\t\t\tlinksStore.refresh(task.$target[i]);\n\t\t}\n\t});\n\n\ttasksStore.attachEvent(\"onBeforeItemMove\", function(sid, parent, tindex){\n\t\t// GS-125. Don't allow users to move the placeholder task\n\t\tif (isPlaceholderTask(sid, gantt, tasksStore)){\n\t\t\t//eslint-disable-next-line\n\t\t\tconsole.log(\"The placeholder task cannot be moved to another position.\");\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t});\n\n\ttasksStore.attachEvent(\"onAfterItemMove\", function(sid, parent, tindex){\n\t\tvar source = gantt.getTask(sid);\n\n\t\tif(this.getNextSibling(sid) !== null){\n\t\t\tsource.$drop_target = this.getNextSibling(sid);\n\t\t} else if(this.getPrevSibling(sid) !== null){\n\t\t\tsource.$drop_target = \"next:\" + this.getPrevSibling(sid);\n\t\t}else{\n\t\t\tsource.$drop_target = \"next:null\";\n\t\t}\n\n\t});\n\n\ttasksStore.attachEvent(\"onStoreUpdated\", function(id, item, action){\n\t\tif(action == \"delete\"){\n\t\t\tgantt._update_flags(id, null);\n\t\t}\n\n\t\tvar state = gantt.$services.getService(\"state\");\n\t\tif(state.getState(\"batchUpdate\").batch_update){\n\t\t\treturn;\n\t\t}\n\n\t\tif(gantt.config.fit_tasks && action !== \"paint\"){\n\t\t\tvar oldState = gantt.getState();\n\t\t\tcalculateScaleRange(gantt);\n\t\t\tvar newState = gantt.getState();\n\n\t\t\t//this._init_tasks_range();\n\t\t\tif (+oldState.min_date != +newState.min_date || +oldState.max_date != +newState.max_date) {\n\t\t\t\tgantt.render();\n\n\t\t\t\tgantt.callEvent(\"onScaleAdjusted\", []);\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t}\n\n\t\tif(action == \"add\" || action == \"move\" || action == \"delete\"){\n\t\t\tif(gantt.$layout){\n\t\t\t\t// GS-2170. Do not recalculate the indexes and dates of other tasks in the\n\t\t\t\t// onBeforeResize layout event, but do it later. If lightbox is opened, it will\n\t\t\t\t// trigger the refreshData, so the indexes and dates will be recalculated there\n\t\t\t\tif (this.$config.name == \"task\" && (action == \"add\" || action == \"delete\")){\n\t\t\t\t\tif (this._skipTaskRecalculation != \"lightbox\"){\n\t\t\t\t\t\tthis._skipTaskRecalculation = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tgantt.$layout.resize();\n\t\t\t}\n\n\t\t}else if(!id){\n\t\t\tlinksStore.refresh();\n\t\t}\n\n\t});\n\n\tlinksStore.attachEvent(\"onAfterAdd\", function(id, link){\n\t\tlinksStore.sync_link(link);\n\t});\n\tlinksStore.attachEvent(\"onAfterUpdate\", function(id, link){\n\t\tsync_links();\n\t});\n\tlinksStore.attachEvent(\"onAfterDelete\", function(id, link){\n\t\tsync_link_delete(link);\n\t});\n\tlinksStore.attachEvent(\"onAfterSilentDelete\", function(id, link){\n\t\tsync_link_delete(link);\n\t});\n\tlinksStore.attachEvent(\"onBeforeIdChange\", function(oldId, newId){\n\t\tsync_link_delete(gantt.mixin({id:oldId}, gantt.$data.linksStore.getItem(newId)));\n\t\tlinksStore.sync_link(gantt.$data.linksStore.getItem(newId));\n\t});\n\n\tfunction checkLinkedTaskVisibility(taskId){\n\t\tvar isVisible = gantt.isTaskVisible(taskId);\n\t\tif(!isVisible && gantt.isTaskExists(taskId)){\n\t\t\tvar parent = gantt.getParent(taskId);\n\t\t\tif(gantt.isTaskExists(parent) && gantt.isTaskVisible(parent)){\n\t\t\t\tparent = gantt.getTask(parent);\n\t\t\t\tif(gantt.isSplitTask(parent)){\n\t\t\t\t\tisVisible = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn isVisible;\n\t}\n\n\tlinksStore.attachEvent(\"onFilterItem\", function(id, link){\n\t\tif (!gantt.config.show_links) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar sourceVisible = checkLinkedTaskVisibility(link.source);\n\t\tvar targetVisible = checkLinkedTaskVisibility(link.target);\n\n\t\tif (!(sourceVisible && targetVisible) ||\n\t\t\tgantt._isAllowedUnscheduledTask(gantt.getTask(link.source)) || gantt._isAllowedUnscheduledTask(gantt.getTask(link.target)))\n\t\t\treturn false;\n\n\t\treturn gantt.callEvent(\"onBeforeLinkDisplay\", [id, link]);\n\t});\n\n\n\t(function(){\n\t\t// delete all connected links after task is deleted\n\t\tvar deletedLinks = {};\n\n\t\tgantt.attachEvent(\"onBeforeTaskDelete\", function(id, item){\n\t\t\tdeletedLinks[id] = treeHelper.getSubtreeLinks(gantt, id);\n\t\t\treturn true;\n\t\t});\n\n\t\tgantt.attachEvent(\"onAfterTaskDelete\", function(id, item) {\n\t\t\tif(deletedLinks[id]){\n\t\t\t\tgantt.$data.linksStore.silent(function(){\n\t\t\t\t\tfor(var i in deletedLinks[id]){\n\t\t\t\t\t\tif (gantt.isLinkExists(i)){\n\t\t\t\t\t\t\tgantt.$data.linksStore.removeItem(i);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsync_link_delete(deletedLinks[id][i]);\n\t\t\t\t\t}\n\n\t\t\t\t\tdeletedLinks[id] = null;\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t})();\n\n\tgantt.attachEvent(\"onAfterLinkDelete\", function(id, link) {\n\t\t// GS-1786. Repaint tasks only if they are loaded\n\t\tif(gantt.isTaskExists(link.source)){\n\t\t\tgantt.refreshTask(link.source);\n\t\t}\n\t\tif(gantt.isTaskExists(link.target)){\n\t\t\tgantt.refreshTask(link.target);\n\t\t}\n\t});\n\n\tgantt.attachEvent(\"onParse\", sync_links);\n\n\tmapEvents({\n\t\tsource: linksStore,\n\t\ttarget: gantt,\n\t\tevents:{\n\t\t\t\"onItemLoading\":\"onLinkLoading\",\n\t\t\t\"onBeforeAdd\":\"onBeforeLinkAdd\",\n\t\t\t\"onAfterAdd\":\"onAfterLinkAdd\",\n\t\t\t\"onBeforeUpdate\":\"onBeforeLinkUpdate\",\n\t\t\t\"onAfterUpdate\":\"onAfterLinkUpdate\",\n\t\t\t\"onBeforeDelete\":\"onBeforeLinkDelete\",\n\t\t\t\"onAfterDelete\":\"onAfterLinkDelete\",\n\t\t\t\"onIdChange\":\"onLinkIdChange\"\n\t\t}\n\t});\n\n\tmapEvents({\n\t\tsource: tasksStore,\n\t\ttarget: gantt,\n\t\tevents:{\n\t\t\t\"onItemLoading\":\"onTaskLoading\",\n\t\t\t\"onBeforeAdd\":\"onBeforeTaskAdd\",\n\t\t\t\"onAfterAdd\":\"onAfterTaskAdd\",\n\t\t\t\"onBeforeUpdate\":\"onBeforeTaskUpdate\",\n\t\t\t\"onAfterUpdate\":\"onAfterTaskUpdate\",\n\t\t\t\"onBeforeDelete\":\"onBeforeTaskDelete\",\n\t\t\t\"onAfterDelete\":\"onAfterTaskDelete\",\n\t\t\t\"onIdChange\":\"onTaskIdChange\",\n\t\t\t\"onBeforeItemMove\":\"onBeforeTaskMove\",\n\t\t\t\"onAfterItemMove\":\"onAfterTaskMove\",\n\t\t\t\"onFilterItem\":\"onBeforeTaskDisplay\",\n\t\t\t\"onItemOpen\":\"onTaskOpened\",\n\t\t\t\"onItemClose\":\"onTaskClosed\",\n\t\t\t\"onBeforeSelect\":\"onBeforeTaskSelected\",\n\t\t\t\"onAfterSelect\":\"onTaskSelected\",\n\t\t\t\"onAfterUnselect\":\"onTaskUnselected\"\n\t\t}\n\t});\n\n\tgantt.$data = {\n\t\ttasksStore: tasksStore,\n\t\tlinksStore: linksStore\n\t};\n\n\tlinksStore.sync_link = function(link) {\n\t\tif(gantt.isTaskExists(link.source)){\n\t\t\tvar sourceTask = gantt.getTask(link.source);\n\t\t\tsourceTask.$source = sourceTask.$source || [];\n\t\t\tif (noDuplicateIds(link.id, sourceTask.$source)){\n\t\t\t\tsourceTask.$source.push(link.id);\n\t\t\t}\n\t\t}\n\t\tif(gantt.isTaskExists(link.target)){\n\t\t\tvar targetTask = gantt.getTask(link.target);\n\t\t\ttargetTask.$target = targetTask.$target || [];\n\t\t\tif (noDuplicateIds(link.id, targetTask.$target)){\n\t\t\t\ttargetTask.$target.push(link.id);\n\t\t\t}\n\t\t}\n\t};\n\t// GS-2085. Don't add duplicate link IDs\n\tfunction noDuplicateIds(id, array){\n\t\treturn array.indexOf(String(id)) === -1 && array.indexOf(Number(id)) === -1;\n\t}\n\n\tfunction sync_link_delete(link){\n\t\tif(gantt.isTaskExists(link.source)){\n\t\t\tvar sourceTask = gantt.getTask(link.source);\n\t\t\tfor(var i = 0; i < sourceTask.$source.length; i++){\n\t\t\t\tif(sourceTask.$source[i] == link.id){\n\t\t\t\t\tsourceTask.$source.splice(i, 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(gantt.isTaskExists(link.target)){\n\t\t\tvar targetTask = gantt.getTask(link.target);\n\t\t\tfor(var i = 0; i < targetTask.$target.length; i++){\n\t\t\t\tif(targetTask.$target[i] == link.id){\n\t\t\t\t\ttargetTask.$target.splice(i, 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction sync_links() {\n\t\tvar task = null;\n\t\tvar tasks = gantt.$data.tasksStore.getItems();\n\n\t\tfor(var i = 0, len = tasks.length; i < len; i++){\n\t\t\ttask = tasks[i];\n\t\t\ttask.$source = [];\n\t\t\ttask.$target = [];\n\t\t}\n\n\t\tvar links = gantt.$data.linksStore.getItems();\n\t\tfor (var i = 0, len = links.length; i < len; i++) {\n\n\t\t\tvar link = links[i];\n\t\t\tlinksStore.sync_link(link);\n\t\t}\n\t}\n\n\tfunction mapEvents(conf){\n\t\tvar mapFrom = conf.source;\n\t\tvar mapTo = conf.target;\n\t\tfor(var i in conf.events){\n\t\t\t(function(sourceEvent, targetEvent){\n\t\t\t\tmapFrom.attachEvent(sourceEvent, function(){\n\t\t\t\t\treturn mapTo.callEvent(targetEvent, Array.prototype.slice.call(arguments));\n\t\t\t\t}, targetEvent);\n\t\t\t})(i, conf.events[i]);\n\t\t}\n\t}\n\n\tfunction _init_task(task) {\n\t\tif (!this.defined(task.id))\n\t\t\ttask.id = this.uid();\n\n\t\tif (task.start_date)\n\t\t\ttask.start_date = gantt.date.parseDate(task.start_date, \"parse_date\");\n\t\tif (task.end_date)\n\t\t\ttask.end_date = gantt.date.parseDate(task.end_date, \"parse_date\");\n\n\n\t\tvar duration = null;\n\t\tif (task.duration || task.duration === 0) {\n\t\t\ttask.duration = duration = task.duration * 1;\n\t\t}\n\n\t\tif (duration) {\n\t\t\tif (task.start_date && !task.end_date) {\n\t\t\t\ttask.end_date = this.calculateEndDate(task);\n\t\t\t} else if (!task.start_date && task.end_date) {\n\t\t\t\ttask.start_date = this.calculateEndDate({\n\t\t\t\t\tstart_date: task.end_date,\n\t\t\t\t\tduration: -task.duration,\n\t\t\t\t\ttask: task\n\t\t\t\t});\n\t\t\t}\n\t\t\t//task.$calculate_duration = false;\n\t\t}\n\n\t\tif (gantt.config.deadlines !== false && task.deadline){\n\t\t\ttask.deadline = gantt.date.parseDate(task.deadline, \"parse_date\");\n\t\t}\n\n\t\ttask.progress = Number(task.progress) || 0;\n\n\t\tif (this._isAllowedUnscheduledTask(task)) {\n\t\t\tthis._set_default_task_timing(task);\n\t\t}\n\t\tthis._init_task_timing(task);\n\t\tif (task.start_date && task.end_date)\n\t\t\tthis.correctTaskWorkTime(task);\n\n\t\ttask.$source = [];\n\t\ttask.$target = [];\n\n\t\tvar originalTask = this.$data.tasksStore.getItem(task.id);\n\t\tif (originalTask && !utils.defined(task.open)) {\n\t\t\t// if a task with the same id is already in the gantt and the new object doesn't specify the `open` state -\n\t\t\t// restore the `open` state we already have in the chart\n\t\t\ttask.$open = originalTask.$open;\n\t\t}\n\n\t\tif (task.parent === undefined) {\n\t\t\ttask.parent = this.config.root_id;\n\t\t}\n\t\tif(task.open){\n\t\t\ttask.$open = true;\n\t\t}\n\t\treturn task;\n\t}\n\n\tfunction _init_link(link) {\n\t\tif (!this.defined(link.id))\n\t\t\tlink.id = this.uid();\n\t\treturn link;\n\t}\n}\n\n\nexport default initDataStores;\n","import batch_update from \"./batch_update\";\nimport wbs from \"./wbs\";\nimport resources from \"./resources\";\nimport resource_assignments from \"./resource_assignments\";\nimport new_task_placeholder from \"./new_task_placeholder\";\nimport auto_task_types from \"./auto_task_types\";\nimport formatters from \"./formatters\";\nimport empty_state_screen from \"./empty_state_screen\";\nimport baselines from \"./baselines\";\nimport remote_events from \"./remote_events/index\";\nimport auto_scheduling_config from \"./auto_scheduling_config\";\n\nexport default function(gantt){\n\tif(!gantt.ext){\n\t\tgantt.ext = {};\n\t}\n\n\tvar modules = [\n\t\tbatch_update,\n\t\twbs,\n\t\tresources,\n\t\tresource_assignments,\n\t\tnew_task_placeholder,\n\t\tauto_task_types,\n\t\tformatters,\n\t\tempty_state_screen,\n\t\tbaselines,\n\t\tremote_events\n\t];\n\n\tfor(var i = 0; i < modules.length; i++){\n\t\tif(modules[i])\n\t\t\tmodules[i](gantt);\n\t}\n\n\tconst { getAutoSchedulingConfig} = auto_scheduling_config(gantt);\n\tgantt._getAutoSchedulingConfig = getAutoSchedulingConfig;\n};","import Grid from \"./ui/grid/grid\";\nimport gridColumnApiGPL from \"./grid_column_api.gpl\";\n\nexport default function(gantt) {\n\tgridColumnApiGPL(gantt);\n\tGrid.prototype.getGridColumns = function () {\n\t\tvar config = this.$getConfig();\n\t\tvar columns = config.columns,\n\t\t\tvisibleColumns = [];\n\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tif (!columns[i].hide)\n\t\t\t\tvisibleColumns.push(columns[i]);\n\t\t}\n\n\t\treturn visibleColumns;\n\t};\n};","export default function(gantt) {\n\tgantt.getGridColumn = function(name) {\n\t\tvar columns = gantt.config.columns;\n\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tif (columns[i].name == name)\n\t\t\t\treturn columns[i];\n\t\t}\n\n\t\treturn null;\n\t};\n\n\tgantt.getGridColumns = function() {\n\t\treturn gantt.config.columns.slice();\n\t};\n};","export default function(gantt) {\n\tgantt.isReadonly = function (item) {\n\n\t\tif((typeof item == \"number\" || typeof item == \"string\") && gantt.isTaskExists(item)){\n\t\t\titem = gantt.getTask(item);\n\t\t}\n\t\tif (item && item[this.config.editable_property]) {\n\t\t\treturn false;\n\t\t} else {\n\t\t\treturn (item && item[this.config.readonly_property]) || this.config.readonly;\n\t\t}\n\t};\n};","import CalendarManager from \"./calendar_manager\";\nimport TimeCalculator from \"./time_calculator\";\nimport worktimeFacadeFactory from \"../facades/worktime_calendars\";\nimport * as utils from \"../../utils/utils\";\n\nexport default function (gantt) {\n\tvar manager = new CalendarManager(gantt),\n\ttimeCalculator = new TimeCalculator(manager);\n\tvar facade = worktimeFacadeFactory.create(manager, timeCalculator);\n\tutils.mixin(gantt, facade);\n};\n","export default function(gantt) {\n\tgantt.getTaskType = function (type) {\n\t\tvar checkType = type;\n\t\tif(type && typeof type == \"object\"){\n\t\t\tcheckType = type.type;\n\t\t}\n\n\t\tfor (var i in this.config.types) {\n\t\t\tif (this.config.types[i] == checkType) {\n\t\t\t\treturn checkType;\n\t\t\t}\n\t\t}\n\t\treturn gantt.config.types.task;\n\t};\n};","/*\n reuse results of functions that can be recalculated during rendering\n greatly increases the rendering speed when critical path enabled\n Sample - 94_dev/critical_path.html\n\n */\nexport default function(gantt){\n\ngantt._cached_functions = {\n\tcache: {},\n\tmode: false,\n\tcritical_path_mode: false,\n\twrap_methods : function(methods, object){\n\t\tif(object._prefetch_originals){\n\t\t\tfor(var i in object._prefetch_originals){\n\t\t\t\tobject[i] = object._prefetch_originals[i];\n\t\t\t}\n\t\t}\n\t\tobject._prefetch_originals = {};\n\t\tfor(var i = 0; i < methods.length; i++)\n\t\t\tthis.prefetch(methods[i], object);\n\n\t},\n\tprefetch : function(methodname, host){\n\t\tvar original = host[methodname];\n\t\tif(original){\n\t\t\tvar optimizer = this;\n\n\t\t\thost._prefetch_originals[methodname] = original;\n\t\t\thost[methodname] = function get_prefetched_value(){\n\n\t\t\t\tvar argumentsArray = new Array(arguments.length);\n\t\t\t\tfor (var i = 0, l = arguments.length; i < l; i++) {\n\t\t\t\t\targumentsArray[i] = arguments[i];\n\t\t\t\t}\n\n\t\t\t\tif(optimizer.active){\n\t\t\t\t\tvar args = optimizer.get_arguments_hash(Array.prototype.slice.call(argumentsArray));\n\t\t\t\t\tif(!optimizer.cache[methodname]){\n\t\t\t\t\t\toptimizer.cache[methodname] = {};\n\t\t\t\t\t}\n\n\t\t\t\t\tvar cached_values = optimizer.cache[methodname];\n\n\t\t\t\t\tif(optimizer.has_cached_value(cached_values, args)){\n\t\t\t\t\t\treturn optimizer.get_cached_value(cached_values, args);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tvar value = original.apply(this, argumentsArray);\n\t\t\t\t\t\toptimizer.cache_value(cached_values, args, value);\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn original.apply(this, argumentsArray);\n\t\t\t};\n\t\t}\n\t\treturn original;\n\t},\n\tcache_value: function(cache, arguments_hash, value){\n\t\tif(this.is_date(value))\n\t\t\tvalue = new Date(value);\n\t\tcache[arguments_hash] = value;\n\t},\n\thas_cached_value: function(cache, arguments_hash){\n\t\treturn cache.hasOwnProperty(arguments_hash);\n\t},\n\tget_cached_value: function(cache, arguments_hash){\n\t\tvar data = cache[arguments_hash];\n\n\t\t//for cached dates - return copy\n\t\tif(this.is_date(data)){\n\t\t\tdata = new Date(data);\n\t\t}\n\t\treturn data;\n\t},\n\tis_date: function(value){\n\t\treturn (value && value.getUTCDate);\n\t},\n\tget_arguments_hash:function(args){\n\t\tvar values = [];\n\t\tfor(var i = 0; i < args.length; i++){\n\t\t\tvalues.push(this.stringify_argument(args[i]));\n\t\t}\n\t\treturn \"(\" + values.join(\";\") + \")\";\n\t},\n\tstringify_argument: function(value){\n\t\t//expecting task or link, or any other data entries, dates and primitive values\n\t\tvar ret = \"\";\n\t\tif(value.id){\n\t\t\tret = value.id;\n\t\t}else if(this.is_date(value)){\n\t\t\tret = value.valueOf();\n\t\t}else{\n\t\t\tret = value;\n\t\t}\n\t\treturn ret + \"\";\n\t},\n\tactivate: function(){\n\t\tthis.clear();\n\t\tthis.active = true;\n\t},\n\tdeactivate: function(){\n\t\tthis.clear();\n\t\tthis.active = false;\n\t},\n\tclear: function(){\n\t\tthis.cache = {};\n\t},\n\n\tsetup: function(gantt){\n\t\tvar override_gantt = [];\n\n\t\tvar gantt_methods  = [\n\t\t\t'_isProjectEnd',\n\t\t\t'_getProjectEnd',\n\t\t\t'_getSlack'\n\t\t];\n\n\n\n\t\tif(this.mode == 'auto'){\n\t\t\tif(gantt.config.highlight_critical_path){\n\t\t\t\toverride_gantt = gantt_methods;\n\t\t\t}\n\t\t}else if(this.mode === true){\n\t\t\toverride_gantt = gantt_methods;\n\t\t}\n\n\t\tthis.wrap_methods(override_gantt, gantt);\n\n\t},\n\tupdate_if_changed: function(gantt){\n\t\tvar changed = (this.critical_path_mode != gantt.config.highlight_critical_path ||\n\t\t\t\t\t\tthis.mode !== gantt.config.optimize_render);\n\t\tif(changed){\n\t\t\tthis.critical_path_mode = gantt.config.highlight_critical_path;\n\t\t\tthis.mode = gantt.config.optimize_render;\n\t\t\tthis.setup(gantt);\n\t\t}\n\t}\n};\n\nfunction activate(){\n\tgantt._cached_functions.update_if_changed(gantt);\n\tif(!gantt._cached_functions.active){\n\t\tgantt._cached_functions.activate();\n\t}\n\treturn true;\n}\ngantt.attachEvent(\"onBeforeGanttRender\", activate);\ngantt.attachEvent(\"onBeforeDataRender\", activate);\ngantt.attachEvent(\"onBeforeSmartRender\",  function(){\n\tactivate();\n});\ngantt.attachEvent(\"onBeforeParse\", activate);\ngantt.attachEvent(\"onDataRender\", function(){\n\tgantt._cached_functions.deactivate();\n});\nvar deactivTimeout = null;\ngantt.attachEvent(\"onSmartRender\", function(){\n\tif(deactivTimeout)\n\t\tclearTimeout(deactivTimeout);\n\tdeactivTimeout = setTimeout(function(){\n\t\tgantt._cached_functions.deactivate();\n\t}, 1000);\n});\n\ngantt.attachEvent(\"onBeforeGanttReady\", function(){\n\tgantt._cached_functions.update_if_changed(gantt);\n\treturn true;\n});\n\n};","function extend(gantt){\n\n\tgantt.destructor = function(){\n\t\tthis.clearAll();\n\t\tthis.callEvent(\"onDestroy\", []);\n\n\t\tthis._getDatastores().forEach(function(store){\n\t\t\tstore.destructor();\n\t\t});\n\n\t\tif(this.$root){\n\t\t\tdelete this.$root.gantt;\n\t\t}\n\n\t\tif(this._eventRemoveAll){\n\t\t\tthis._eventRemoveAll();\n\t\t}\n\n\t\tif(this.$layout){\n\t\t\tthis.$layout.destructor();\n\t\t}\n\n\t\tif(this.resetLightbox){\n\t\t\tthis.resetLightbox();\n\t\t}\n\n\t\t// GS-99. Call this here to detach the events\n\t\tif (this.ext.inlineEditors && this.ext.inlineEditors.destructor) {\n\t\t\tthis.ext.inlineEditors.destructor();\n\t\t}\n\n\t\tif(this._dp && this._dp.destructor){\n\t\t\tthis._dp.destructor();\n\t\t}\n\t\tthis.$services.destructor();\n\n\t\t// detachAllEvents should be called last, because in components may be attached events\n\t\tthis.detachAllEvents();\n\n\t\tfor(var i in this){\n\t\t\tif(i.indexOf(\"$\") === 0){\n\t\t\t\tdelete this[i];\n\t\t\t}\n\t\t}\n\t\tthis.$destroyed = true;\n\t};\n}\n\nexport default extend;\n","import ar from \"./locale_ar\";\nimport be from \"./locale_be\";\nimport ca from \"./locale_ca\";\nimport cn from \"./locale_cn\";\nimport cs from \"./locale_cs\";\nimport da from \"./locale_da\";\nimport de from \"./locale_de\";\nimport el from \"./locale_el\";\nimport en from \"./locale_en\";\nimport es from \"./locale_es\";\nimport fa from \"./locale_fa\";\nimport fi from \"./locale_fi\";\nimport fr from \"./locale_fr\";\nimport he from \"./locale_he\";\nimport hr from \"./locale_hr\";\nimport hu from \"./locale_hu\";\nimport id from \"./locale_id\";\nimport it from \"./locale_it\";\nimport jp from \"./locale_jp\";\nimport kr from \"./locale_kr\";\n\nimport LocaleManager from \"./locale_manager\";\n\nimport nb from \"./locale_nb\";\nimport nl from \"./locale_nl\";\nimport no from \"./locale_no\";\nimport pl from \"./locale_pl\";\nimport pt from \"./locale_pt\";\nimport ro from \"./locale_ro\";\nimport ru from \"./locale_ru\";\nimport si from \"./locale_si\";\nimport sk from \"./locale_sk\";\nimport sv from \"./locale_sv\";\nimport tr from \"./locale_tr\";\nimport ua from \"./locale_ua\";\n\nexport default function(){\n\treturn new LocaleManager({\n\t\ten,\n\t\tar,\n\t\tbe,\n\t\tca,\n\t\tcn,\n\t\tcs,\n\t\tda,\n\t\tde,\n\t\tel,\n\t\tes,\n\t\tfa,\n\t\tfi,\n\t\tfr,\n\t\the,\n\t\thr,\n\t\thu,\n\t\tid,\n\t\tit,\n\t\tjp,\n\t\tkr,\n\t\tnb,\n\t\tnl,\n\t\tno,\n\t\tpl,\n\t\tpt,\n\t\tro,\n\t\tru,\n\t\tsi,\n\t\tsk,\n\t\tsv,\n\t\ttr,\n\t\tua\n\t});\n}","import * as utils from \"../../utils/utils\";\nimport * as domHelpers from \"./utils/dom_helpers\";\n\nexport default function(gantt) {\n\n\tvar boxAttribute = \"data-dhxbox\";\n\n\tvar _dhx_msg_cfg = null;\n\n\tfunction callback(config, result) {\n\t\tvar usercall = config.callback;\n\t\tmodalBox.hide(config.box);\n\n\t\t_dhx_msg_cfg = config.box = null;\n\t\tif (usercall)\n\t\t\tusercall(result);\n\t}\n\n\tfunction modal_key(event) {\n\t\tif (_dhx_msg_cfg) {\n\n\t\t\tvar code = event.which || event.keyCode;\n\t\t\tvar preventDefault = false;\n\n\t\t\tif (messageBox.keyboard) {\n\t\t\t\tif (code == 13 || code == 32) {\n\t\t\t\t\t// default behavior is to confirm/submit popup on space/enter\n\t\t\t\t\t// if browser focus is set on button element - do button click instead of default behavior\n\t\t\t\t\tvar target = event.target || event.srcElement;\n\t\t\t\t\tif (domHelpers.getClassName(target).indexOf(\"gantt_popup_button\") > -1 && target.click) {\n\t\t\t\t\t\ttarget.click();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcallback(_dhx_msg_cfg, true);\n\t\t\t\t\t\tpreventDefault = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (code == 27) {\n\t\t\t\t\tcallback(_dhx_msg_cfg, false);\n\t\t\t\t\tpreventDefault = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (preventDefault) {\n\t\t\t\tif (event.preventDefault){\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\treturn !(event.cancelBubble = true);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t}\n\tvar eventElement = domHelpers.getRootNode(gantt.$root) || document;\n\tgantt.event(eventElement, \"keydown\", modal_key, true);\n\n\tfunction modality(mode) {\n\t\tif (!modality.cover) {\n\t\t\tmodality.cover = document.createElement(\"div\");\n\t\t\t//necessary for IE only\n\t\t\tmodality.cover.onkeydown = modal_key;\n\t\t\tmodality.cover.className = \"dhx_modal_cover\";\n\t\t\tdocument.body.appendChild(modality.cover);\n\t\t}\n\n\t\tmodality.cover.style.display = mode ? \"inline-block\" : \"none\";\n\t}\n\n\tfunction button(text, className, result) {\n\t\tvar buttonAriaAttrs = gantt._waiAria.messageButtonAttrString(text);\n\t\tvar name = className.toLowerCase().replace(/ /g, \"_\");\n\t\tvar button_css = \"gantt_\" + name + \"_button\";\n\t\treturn \"<div \" + buttonAriaAttrs + \" class='gantt_popup_button \" + button_css + \"' data-result='\" + result + \"' result='\" + result + \"' ><div>\" + text + \"</div></div>\";\n\t}\n\n\tfunction info(text) {\n\t\tif (!messageBox.area) {\n\t\t\tmessageBox.area = document.createElement(\"div\");\n\t\t\tmessageBox.area.className = \"gantt_message_area\";\n\t\t\tmessageBox.area.style[messageBox.position] = \"5px\";\n\t\t}\n\t\tif (!domHelpers.isChildOf(messageBox.area, document.body)){\n\t\t\tdocument.body.appendChild(messageBox.area);\n\t\t}\n\n\t\tmessageBox.hide(text.id);\n\t\tvar message = document.createElement(\"div\");\n\t\tmessage.innerHTML = \"<div>\" + text.text + \"</div>\";\n\t\tmessage.className = \"gantt-info gantt-\" + text.type;\n\t\tmessage.onclick = function () {\n\t\t\tmessageBox.hide(text.id);\n\t\t\ttext = null;\n\t\t};\n\n\t\tgantt._waiAria.messageInfoAttr(message);\n\n\t\tif (messageBox.position == \"bottom\" && messageBox.area.firstChild)\n\t\t\tmessageBox.area.insertBefore(message, messageBox.area.firstChild);\n\t\telse\n\t\t\tmessageBox.area.appendChild(message);\n\n\t\tif (text.expire > 0)\n\t\t\tmessageBox.timers[text.id] = window.setTimeout(function () {\n\t\t\t\t// GS-1213: We need that when Gantt is destroyed\n\t\t\t\tif (messageBox) messageBox.hide(text.id);\n\t\t\t}, text.expire);\n\n\t\tmessageBox.pull[text.id] = message;\n\t\tmessage = null;\n\n\t\treturn text.id;\n\t}\n\n\tfunction getFirstDefined() {\n\t\tvar values = [].slice.apply(arguments, [0]);\n\n\t\tfor (var i = 0; i < values.length; i++) {\n\t\t\tif (values[i]) {\n\t\t\t\treturn values[i];\n\t\t\t}\n\t\t}\n\n\t}\n\n\tfunction _boxStructure(config, ok, cancel) {\n\t\tvar box = document.createElement(\"div\");\n\n\t\tvar contentId = utils.uid();\n\t\tgantt._waiAria.messageModalAttr(box, contentId);\n\n\n\t\tbox.className = \" gantt_modal_box gantt-\" + config.type;\n\t\tbox.setAttribute(boxAttribute, 1);\n\n\t\tvar inner = '';\n\n\t\tif (config.width)\n\t\t\tbox.style.width = config.width;\n\t\tif (config.height)\n\t\t\tbox.style.height = config.height;\n\t\tif (config.title)\n\t\t\tinner += '<div class=\"gantt_popup_title\">' + config.title + '</div>';\n\t\tinner += '<div class=\"gantt_popup_text\" id=\"' + contentId + '\"><span>' + (config.content ? '' : config.text) + '</span></div><div  class=\"gantt_popup_controls\">';\n\t\tif (ok)\n\t\t\tinner += button(getFirstDefined(config.ok, gantt.locale.labels.message_ok, \"OK\"), \"ok\", true);\n\t\tif (cancel)\n\t\t\tinner += button(getFirstDefined(config.cancel, gantt.locale.labels.message_cancel, \"Cancel\"), \"cancel\", false);\n\n\t\tif (config.buttons) {\n\t\t\tfor (var i = 0; i < config.buttons.length; i++) {\n\t\t\t\tvar btn = config.buttons[i];\n\t\t\t\tif (typeof btn == \"object\") {\n\t\t\t\t\t// Support { label:\"Save\", css:\"main_button\", value:\"save\" }\n\t\t\t\t\tvar label = btn.label;\n\t\t\t\t\tvar css = btn.css || (\"gantt_\" + btn.label.toLowerCase() + \"_button\");\n\t\t\t\t\tvar value = btn.value || i;\n\t\t\t\t\tinner += button(label, css, value);\n\t\t\t\t} else {\n\t\t\t\t\tinner += button(btn, btn, i);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tinner += '</div>';\n\t\tbox.innerHTML = inner;\n\n\t\tif (config.content) {\n\t\t\tvar node = config.content;\n\t\t\tif (typeof node == \"string\")\n\t\t\t\tnode = document.getElementById(node);\n\t\t\tif (node.style.display == 'none')\n\t\t\t\tnode.style.display = \"\";\n\t\t\tbox.childNodes[config.title ? 1 : 0].appendChild(node);\n\t\t}\n\n\t\tbox.onclick = function (event) {\n\t\t\tvar source = event.target || event.srcElement;\n\t\t\tif (!source.className) source = source.parentNode;\n\t\t\tif (domHelpers.closest(source, \".gantt_popup_button\")) {\n\t\t\t\tvar result = source.getAttribute(\"data-result\");\n\t\t\t\tresult = (result == \"true\") || (result == \"false\" ? false : result);\n\t\t\t\tcallback(config, result);\n\t\t\t}\n\t\t};\n\t\tconfig.box = box;\n\t\tif (ok || cancel)\n\t\t\t_dhx_msg_cfg = config;\n\n\t\treturn box;\n\t}\n\n\tfunction _createBox(config, ok, cancel) {\n\t\tvar box = config.tagName ? config : _boxStructure(config, ok, cancel);\n\n\t\tif (!config.hidden)\n\t\t\tmodality(true);\n\t\tdocument.body.appendChild(box);\n\t\tvar x = Math.abs(Math.floor(((window.innerWidth || document.documentElement.offsetWidth) - box.offsetWidth) / 2));\n\t\tvar y = Math.abs(Math.floor(((window.innerHeight || document.documentElement.offsetHeight) - box.offsetHeight) / 2));\n\t\tif (config.position == \"top\")\n\t\t\tbox.style.top = \"-3px\";\n\t\telse\n\t\t\tbox.style.top = y + 'px';\n\t\tbox.style.left = x + 'px';\n\t\t//necessary for IE only\n\t\tbox.onkeydown = modal_key;\n\n\t\tmodalBox.focus(box);\n\n\t\tif (config.hidden)\n\t\t\tmodalBox.hide(box);\n\n\t\tgantt.callEvent(\"onMessagePopup\", [box]);\n\t\treturn box;\n\t}\n\n\tfunction alertPopup(config) {\n\t\treturn _createBox(config, true, false);\n\t}\n\n\tfunction confirmPopup(config) {\n\t\treturn _createBox(config, true, true);\n\t}\n\n\tfunction boxPopup(config) {\n\t\treturn _createBox(config);\n\t}\n\n\tfunction box_params(text, type, callback) {\n\t\tif (typeof text != \"object\") {\n\t\t\tif (typeof type == \"function\") {\n\t\t\t\tcallback = type;\n\t\t\t\ttype = \"\";\n\t\t\t}\n\t\t\ttext = {text: text, type: type, callback: callback};\n\t\t}\n\t\treturn text;\n\t}\n\n\tfunction params(text, type, expire, id) {\n\t\tif (typeof text != \"object\")\n\t\t\ttext = {text: text, type: type, expire: expire, id: id};\n\t\ttext.id = text.id || utils.uid();\n\t\ttext.expire = text.expire || messageBox.expire;\n\t\treturn text;\n\t}\n\n\tvar alertBox = function () {\n\t\tvar text = box_params.apply(this, arguments);\n\t\ttext.type = text.type || \"confirm\";\n\t\treturn alertPopup(text);\n\t};\n\tvar confirmBox = function () {\n\t\tvar text = box_params.apply(this, arguments);\n\t\ttext.type = text.type || \"alert\";\n\t\treturn confirmPopup(text);\n\t};\n\tvar modalBox = function () {\n\t\tvar text = box_params.apply(this, arguments);\n\t\ttext.type = text.type || \"alert\";\n\t\treturn boxPopup(text);\n\t};\n\tmodalBox.hide = function (node) {\n\t\twhile (node && node.getAttribute && !node.getAttribute(boxAttribute))\n\t\t\tnode = node.parentNode;\n\t\tif (node) {\n\t\t\tnode.parentNode.removeChild(node);\n\t\t\tmodality(false);\n\n\t\t\tgantt.callEvent(\"onAfterMessagePopup\", [node]);\n\t\t}\n\t};\n\n\tmodalBox.focus = function (node) {\n\t\tsetTimeout(function () {\n\t\t\tvar focusable = domHelpers.getFocusableNodes(node);\n\t\t\tif (focusable.length) {\n\t\t\t\tif (focusable[0].focus) focusable[0].focus();\n\t\t\t}\n\t\t}, 1);\n\t};\n\n\tvar messageBox = function (text, type, expire, id) {\n\t\ttext = params.apply(this, arguments);\n\t\ttext.type = text.type || \"info\";\n\n\t\tvar subtype = text.type.split(\"-\")[0];\n\t\tswitch (subtype) {\n\t\t\tcase \"alert\":\n\t\t\t\treturn alertPopup(text);\n\t\t\tcase \"confirm\":\n\t\t\t\treturn confirmPopup(text);\n\t\t\tcase \"modalbox\":\n\t\t\t\treturn boxPopup(text);\n\t\t\tdefault:\n\t\t\t\treturn info(text);\n\t\t}\n\t};\n\n\tmessageBox.seed = (new Date()).valueOf();\n\tmessageBox.uid = utils.uid;\n\tmessageBox.expire = 4000;\n\tmessageBox.keyboard = true;\n\tmessageBox.position = \"top\";\n\tmessageBox.pull = {};\n\tmessageBox.timers = {};\n\n\tmessageBox.hideAll = function () {\n\t\tfor (var key in messageBox.pull)\n\t\t\tmessageBox.hide(key);\n\t};\n\tmessageBox.hide = function (id) {\n\t\tvar obj = messageBox.pull[id];\n\t\tif (obj && obj.parentNode) {\n\t\t\twindow.setTimeout(function () {\n\t\t\t\tobj.parentNode.removeChild(obj);\n\t\t\t\tobj = null;\n\t\t\t}, 2000);\n\t\t\tobj.className += \" hidden\";\n\n\t\t\tif (messageBox.timers[id])\n\t\t\t\twindow.clearTimeout(messageBox.timers[id]);\n\t\t\tdelete messageBox.pull[id];\n\t\t}\n\t};\n\n\tvar popups = [];\n\tgantt.attachEvent(\"onMessagePopup\", function(box){\n\t\tpopups.push(box);\n\t});\n\tgantt.attachEvent(\"onAfterMessagePopup\", function(box){\n\t\tfor(var i = 0; i < popups.length; i++){\n\t\t\tif(popups[i] === box){\n\t\t\t\tpopups.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t});\n\n\tgantt.attachEvent(\"onDestroy\", function(){\n\t\tif(modality.cover && modality.cover.parentNode){\n\t\t\tmodality.cover.parentNode.removeChild(modality.cover);\n\t\t}\n\n\t\tfor(var i = 0; i < popups.length; i++){\n\t\t\tif(popups[i].parentNode){\n\t\t\t\tpopups[i].parentNode.removeChild(popups[i]);\n\t\t\t}\n\t\t}\n\t\tpopups = null;\n\n\t\tif(messageBox.area && messageBox.area.parentNode){\n\t\t\tmessageBox.area.parentNode.removeChild(messageBox.area);\n\t\t}\n\t\tmessageBox = null;\n\t});\n\n\treturn {\n\t\talert: alertBox,\n\t\tconfirm: confirmBox,\n\t\tmessage: messageBox,\n\t\tmodalbox: modalBox\n\t};\n};","import * as utils from \"../../utils/utils\";\n\nfunction extendSettings (store, parentSettings){\n\tvar own = this.$config[store];\n\n\tif(own){\n\t\tif(!own.$extendedConfig){\n\t\t\town.$extendedConfig = true;\n\t\t\tObject.setPrototypeOf(own, parentSettings);\n\t\t}\n\t\treturn own;\n\t}else{\n\t\treturn parentSettings;\n\t}\n}\n\nvar configurable = function(parentView){\n\tvar parentConfig,\n\t\tparentTemplates;\n\n\treturn {\n\t\t$getConfig: function(){\n\t\t\tif(!parentConfig){\n\t\t\t\tparentConfig = parentView ? parentView.$getConfig() : this.$gantt.config;\n\t\t\t}\n\t\t\tif(!this.$config.config){\n\t\t\t\treturn parentConfig;\n\t\t\t}else{\n\t\t\t\treturn extendSettings.call(this, \"config\", parentConfig);\n\t\t\t}\n\t\t},\n\t\t$getTemplates: function(){\n\t\t\tif(!parentTemplates){\n\t\t\t\tparentTemplates = parentView ? parentView.$getTemplates() : this.$gantt.templates;\n\t\t\t}\n\t\t\tif(!this.$config.templates){\n\t\t\t\treturn parentTemplates;\n\t\t\t}else{\n\t\t\t\treturn extendSettings.call(this, \"templates\", parentTemplates);\n\t\t\t}\n\t\t}\n\t};\n};\n\nexport default function(obj, parent){\n\tutils.mixin(obj, configurable(parent));\n};","import * as utils from \"../../utils/utils\";\nimport configurable from \"./configurable\";\n\nvar uiFactory = function createFactory(gantt){\n\tvar views = {};\n\n\tfunction ui(cell, parentView) {\n\t\tvar content;\n\t\tvar view = \"cell\";\n\t\tif (cell.view){\n\t\t\tview = \"viewcell\";\n\t\t}else if (cell.resizer) {\n\t\t\tview = \"resizer\";\n\t\t}\n\t\telse if (cell.rows || cell.cols) {\n\t\t\tview = \"layout\";\n\t\t}\n\t\telse if (cell.views) {\n\t\t\tview = \"multiview\";\n\t\t}\n\n\t\tcontent = createView.call(this, view, null, cell, parentView);\n\t\treturn content;\n\t}\n\t\n\tvar createdViews = {};\n\n\tfunction createView(name, parent, config, parentView) {\n\t\tvar creator = views[name];\n\n\t\tif(!creator || !creator.create)\n\t\t\treturn false;\n\n\t\tif(name == \"resizer\" && !config.mode){\n\t\t\tif(parentView.$config.cols){\n\t\t\t\tconfig.mode = \"x\";\n\t\t\t}else{\n\t\t\t\tconfig.mode = \"y\";\n\t\t\t}\n\t\t}\n\n\t\tif(name == \"viewcell\" && config.view == \"scrollbar\" && !config.scroll){\n\t\t\tif(parentView.$config.cols){\n\t\t\t\tconfig.scroll = \"y\";\n\t\t\t}else{\n\t\t\t\tconfig.scroll = \"x\";\n\t\t\t}\n\t\t}\n\n\t\tvar config = utils.copy(config);\n\n\t\tif(!config.id && !createdViews[config.view]){\n\t\t\tconfig.id = config.view;\n\t\t}\n\n\t\tif(config.id && !config.css){\n\t\t\tconfig.css = config.id+\"_cell\";\n\t\t}\n\n\t\tvar view = new creator.create(parent, config, this, gantt);\n\n\t\tif(creator.configure){\n\t\t\tcreator.configure(view);\n\t\t}\n\n\t\tconfigurable(view, parentView);\n\t\tif(!view.$id){\n\t\t\tview.$id = config.id || gantt.uid();\n\t\t}\n\n\t\tif(!view.$parent && typeof parent == \"object\"){\n\t\t\tview.$parent = parent;\n\t\t}\n\t\tif(!view.$config){\n\t\t\tview.$config = config;\n\t\t}\n\n\t\tif(createdViews[view.$id]){\n\t\t\tview.$id = gantt.uid();\n\t\t}\n\n\t\tcreatedViews[view.$id] = view;\n\n\t\treturn view;\n\t}\n\n\tfunction reset(){\n\t\tcreatedViews = {};\n\t}\n\n\tfunction register(name, viewConstructor, configure){\n\t\tviews[name] = {create: viewConstructor, configure: configure};\n\t}\n\n\tfunction getView(id){\n\t\treturn createdViews[id];\n\t}\n\n\tvar factory = {\n\t\tinitUI:ui,\n\t\treset: reset,\n\t\tregisterView: register,\n\t\tcreateView: createView,\n\t\tgetView: getView\n\t};\n\n\treturn factory;\n};\n\nexport default {\n\tcreateFactory: uiFactory\n};\n\n","import * as domHelpers from \"./utils/dom_helpers\";\n\nvar createMouseHandler = (function(domHelpers) {\n\treturn function (gantt) {\n\t\tvar eventHandlers = {\n\t\t\t\"click\": {},\n\t\t\t\"doubleclick\": {},\n\t\t\t\"contextMenu\": {}\n\t\t};\n\n\t\tfunction addEventTarget(event, className, handler, root) {\n\t\t\tif(!eventHandlers[event][className]){\n\t\t\t\teventHandlers[event][className] = [];\n\t\t\t}\n\n\t\t\teventHandlers[event][className].push({\n\t\t\t\thandler: handler,\n\t\t\t\troot: root\n\t\t\t});\n\t\t}\n\n\t\tfunction callHandler(eventName, className, root, args) {\n\t\t\tvar handlers = eventHandlers[eventName][className];\n\t\t\tif(handlers){\n\t\t\t\tfor(var i = 0; i < handlers.length; i++){\n\t\t\t\t\tif(!(root || handlers[i].root) || handlers[i].root === root){\n\t\t\t\t\t\thandlers[i].handler.apply(this, args);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction onClick(e) {\n\t\t\te = e || window.event;\n\t\t\tvar id = gantt.locate(e);\n\n\t\t\tvar handlers = findEventHandlers(e, eventHandlers.click);\n\t\t\tvar res = true;\n\t\t\tif (id !== null) {\n\t\t\t\tres = !gantt.checkEvent(\"onTaskClick\") || gantt.callEvent(\"onTaskClick\", [id, e]);\n\t\t\t} else {\n\t\t\t\tgantt.callEvent(\"onEmptyClick\", [e]);\n\t\t\t}\n\n\t\t\tif (res) {\n\t\t\t\tvar default_action = callEventHandlers(handlers, e, id);\n\t\t\t\tif (!default_action)\n\t\t\t\t\treturn;\n\n\t\t\t\t// GS-1025: if we don't do that, the dropdown or date select will be closed for unselected tasks\n\t\t\t\t// GS-1078: or for the built-in select inline editor\n\t\t\t\tswitch(e.target.nodeName) {\n\t\t\t\t\tcase \"SELECT\":\n\t\t\t\t\tcase 'INPUT':\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t//allow task selection when the multiselect plugin is not enabled\n\t\t\t\tif (id && gantt.getTask(id) && !gantt._multiselect && gantt.config.select_task) {\n\t\t\t\t\tgantt.selectTask(id);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction onContextMenu(e) {\n\t\t\te = e || window.event;\n\t\t\tvar src = e.target || e.srcElement,\n\t\t\t\ttaskId = gantt.locate(src),\n\t\t\t\tlinkId = gantt.locate(src, gantt.config.link_attribute);\n\n\t\t\tvar res = !gantt.checkEvent(\"onContextMenu\") || gantt.callEvent(\"onContextMenu\", [taskId, linkId, e]);\n\t\t\tif (!res) {\n\t\t\t\tif (e.preventDefault)\n\t\t\t\t\te.preventDefault();\n\t\t\t\telse\n\t\t\t\t\te.returnValue = false;\n\t\t\t}\n\t\t\treturn res;\n\t\t}\n\n\t\tfunction findEventHandlers(e, hash){\n\t\t\tvar trg = e.target || e.srcElement;\n\t\t\tvar handlers = [];\n\t\t\twhile (trg) {\n\t\t\t\tvar css = domHelpers.getClassName(trg);\n\t\t\t\tif (css) {\n\t\t\t\t\tcss = css.split(\" \");\n\t\t\t\t\tfor (var i = 0; i < css.length; i++) {\n\t\t\t\t\t\tif (!css[i]) continue;\n\t\t\t\t\t\tif (hash[css[i]]) {\n\t\t\t\t\t\t\tvar delegateHandlers = hash[css[i]];\n\n\t\t\t\t\t\t\tfor(var h = 0; h < delegateHandlers.length; h++){\n\t\t\t\t\t\t\t\tif(delegateHandlers[h].root){\n\t\t\t\t\t\t\t\t\tif(!domHelpers.isChildOf(trg, delegateHandlers[h].root)){\n\t\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\thandlers.push(delegateHandlers[h].handler);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttrg = trg.parentNode;\n\t\t\t}\n\t\t\treturn handlers;\n\t\t}\n\n\t\tfunction callEventHandlers(handlers, e, id){\n\t\t\tvar res = true;\n\n\t\t\tfor(var i = 0; i < handlers.length; i++){\n\t\t\t\tvar handlerResult =  handlers[i].call(gantt, e, id, e.target || e.srcElement);\n\t\t\t\tres = res && !(typeof handlerResult != \"undefined\" && handlerResult !== true);\n\t\t\t}\n\n\t\t\treturn res;\n\t\t}\n\n\n\t\tfunction onDoubleClick(e) {\n\t\t\te = e || window.event;\n\t\t\tvar id = gantt.locate(e);\n\n\t\t\tvar handlers = findEventHandlers(e, eventHandlers.doubleclick);\n\t\t\t// when doubleclick fired not on task, id === null\n\t\t\tvar res = !gantt.checkEvent(\"onTaskDblClick\") || id === null || gantt.callEvent(\"onTaskDblClick\", [id, e]);\n\t\t\tif (res) {\n\t\t\t\tvar default_action = callEventHandlers(handlers, e, id);\n\t\t\t\tif (!default_action)\n\t\t\t\t\treturn;\n\n\t\t\t\tif (id !== null && gantt.getTask(id)) {\n\t\t\t\t\tif (res && gantt.config.details_on_dblclick && !gantt.isReadonly(id)) {\n\t\t\t\t\t\tgantt.showLightbox(id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction onMouseMove(e) {\n\t\t\tif (gantt.checkEvent(\"onMouseMove\")) {\n\t\t\t\tvar id = gantt.locate(e);\n\t\t\t\tgantt._last_move_event = e;\n\t\t\t\tgantt.callEvent(\"onMouseMove\", [id, e]);\n\t\t\t}\n\t\t}\n\n\t\tfunction detach(eventName, className, handler, root) {\n\t\t\tif (eventHandlers[eventName] && eventHandlers[eventName][className]) {\n\t\t\t\tvar handlers = eventHandlers[eventName];\n\t\t\t\tvar elementHandlers = handlers[className];\n\t\t\t\tfor(var i = 0; i < elementHandlers.length; i++){\n\t\t\t\t\tif(elementHandlers[i].root == root){\n\t\t\t\t\t\telementHandlers.splice(i, 1);\n\t\t\t\t\t\ti--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!elementHandlers.length){\n\t\t\t\t\tdelete handlers[className];\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tvar domEvents = gantt._createDomEventScope();\n\n\t\tfunction reset(node){\n\n\t\t\tdomEvents.detachAll();\n\n\t\t\tif(node){\n\t\t\t\tdomEvents.attach(node, \"click\", onClick);\n\t\t\t\tdomEvents.attach(node, \"dblclick\", onDoubleClick);\n\t\t\t\tdomEvents.attach(node, \"mousemove\", onMouseMove);\n\t\t\t\tdomEvents.attach(node, \"contextmenu\", onContextMenu);\n\t\t\t}\n\t\t}\n\n\n\n\t\treturn {\n\t\t\treset: reset,\n\t\t\tglobal: function(event, classname, handler){\n\t\t\t\taddEventTarget(event, classname, handler, null);\n\t\t\t},\n\t\t\tdelegate: addEventTarget,\n\t\t\tdetach: detach,\n\t\t\tcallHandler: callHandler,\n\t\t\tonDoubleClick: onDoubleClick,\n\t\t\tonMouseMove: onMouseMove,\n\t\t\tonContextMenu: onContextMenu,\n\t\t\tonClick: onClick,\n\t\t\tdestructor: function(){\n\t\t\t\treset();\n\t\t\t\teventHandlers = null;\n\t\t\t\tdomEvents = null;\n\t\t\t}\n\n\t\t};\n\t};\n\n})(domHelpers);\n\n\nexport default {\n\tinit:createMouseHandler\n};","export default function(viewport, box, gantt){\n\tif(!box){\n\t\treturn false;\n\t}\n\n\tif(box.left > viewport.x_end || box.left + box.width < viewport.x){\n\t\treturn false;\n\t}\n\n\tif(box.top > viewport.y_end || box.top + box.height < viewport.y){\n\t\treturn false;\n\t}\n\t\n\treturn true;\n};","export default function(gantt){\n\treturn gantt.config.smart_rendering && gantt._smart_render;\n};","export default function(item, view, config){\n\treturn {\n\t\ttop: view.getItemTop(item.id),\n\t\theight: view.getItemHeight(item.id),\n\t\tleft: 0,\n\t\tright: Infinity\n\t};\n};","export default function getVisibleTasksRange(gantt, view, config, datastore, viewport){\n\tvar buffer = 1;\n\tvar start = view.getItemIndexByTopPosition(viewport.y) || 0;\n\tvar end = view.getItemIndexByTopPosition(viewport.y_end) || datastore.count();\n\tvar indexStart = Math.max(0, start - buffer);\n\tvar indexEnd =  Math.min(datastore.count(), end + buffer);\n\t// GS-2481 and GS-1715, need to take into account selected task when using keyboard shortcuts and when the inline editor is opened \n\tconst extraTasksIds= [];\n\tif (gantt.config.keyboard_navigation && gantt.getSelectedId()) {\n\t\tlet task = gantt.getTask(gantt.getSelectedId());\n\t\t// GS-2661 and GS-2835: The selected task shouldn't be a split child \n\t\t// and its parent shouldn't be collapsed\n\t\tif(task.$expanded_branch && !task.$split_subtask) {\n\t\t\textraTasksIds.push(gantt.getSelectedId());\n\t\t}\n\t}\n\tif (gantt.$ui.getView(\"grid\") && gantt.ext.inlineEditors && gantt.ext.inlineEditors.getState().id) {\n\t\tlet inlineEditorId = gantt.ext.inlineEditors.getState().id;\n\t\tif (datastore.exists(inlineEditorId)){\n\t\t\textraTasksIds.push(inlineEditorId);\n\t\t}\n\t}\n\treturn {\n\t\tstart: indexStart,\n\t\tend: indexEnd,\n\t\tids: extraTasksIds \n\t};\n};","import genericViewPortChecker from \"./viewport/is_in_viewport\";\nimport isLegacyRender from \"./is_legacy_smart_render\";\nimport basicGetRectangle from \"./viewport/get_grid_row_rectangle\";\nimport basicGetRange from \"./viewport/get_visible_bars_range\";\nvar rendererFactory = function(gantt){\n\n\t//hash of dom elements is needed to redraw single bar/link\n\tvar task_area_pulls = {},\n\t\ttask_area_renderers = {};\n\n\tfunction getView(layer){\n\t\tvar view = null;\n\t\tif (typeof layer.view === \"string\") {\n\t\t\tview = gantt.$ui.getView(layer.view);\n\t\t} else if (layer.view) {\n\t\t\tview = layer.view;\n\t\t}\n\t\treturn view;\n\t}\n\n\tfunction getRenderer(id, layer, node) {\n\t\t\n\t\tif (task_area_renderers[id])\n\t\t\treturn task_area_renderers[id];\n\n\t\tif (!layer.renderer)\n\t\t\tgantt.assert(false, \"Invalid renderer call\");\n\n\t\tvar renderMethod = null;\n\t\tvar updateMethod = null;\n\t\tvar getRectangle = null;\n\t\tvar renderCallbackMethod = null;\n\t\tvar specializedViewPortChecker = null;\n\n\t\tif(typeof layer.renderer === \"function\"){\n\t\t\trenderMethod = layer.renderer;\n\t\t\tgetRectangle = basicGetRectangle;\n\t\t}else{\n\t\t\trenderMethod = layer.renderer.render;\n\t\t\tupdateMethod = layer.renderer.update;\n\t\t\trenderCallbackMethod = layer.renderer.onrender;\n\t\t\t\n\t\t\tif(layer.renderer.isInViewPort){\n\t\t\t\tspecializedViewPortChecker = layer.renderer.isInViewPort;\n\t\t\t}else{\n\t\t\t\tgetRectangle = layer.renderer.getRectangle;\n\t\t\t}\n\n\t\t\tif (!getRectangle && getRectangle !== null) {\n\t\t\t\tgetRectangle = basicGetRectangle;\n\t\t\t}\n\t\t}\n\n\t\tvar filter = layer.filter;\n\n\t\tif (node)\n\t\t\tnode.setAttribute(gantt.config.layer_attribute, true);\n\n\t\ttask_area_renderers[id] = {\n\t\t\trender_item: function (item, container, viewPort, layerView, viewConfig) {\n\t\t\t\tcontainer = container || node;\n\t\t\t\tif (filter) {\n\t\t\t\t\tif (!filter(item)) {\n\t\t\t\t\t\tthis.remove_item(item.id);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar view = layerView || getView(layer);\n\t\t\t\tvar config = viewConfig || (view ? view.$getConfig() : null);\n\t\t\t\tvar rendererViewPort = viewPort;\n\t\t\t\tif(!rendererViewPort && config && config.smart_rendering){\n\t\t\t\t\trendererViewPort = view.getViewPort();\n\t\t\t\t}\n\n\t\t\t\tvar dom = null;\n\t\t\t\tif(!isLegacyRender(gantt) && (getRectangle || specializedViewPortChecker) && rendererViewPort){\n\t\t\t\t\tvar isVisible = false;\n\t\t\t\t\tif(specializedViewPortChecker){\n\t\t\t\t\t\tisVisible = specializedViewPortChecker(item, rendererViewPort, view, config, gantt);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tisVisible = genericViewPortChecker(rendererViewPort, getRectangle(item, view, config, gantt), gantt);\n\t\t\t\t\t}\n\t\t\t\t\tif(isVisible){\n\t\t\t\t\t\tdom = renderMethod.call(gantt, item, view, config, rendererViewPort);\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tdom = renderMethod.call(gantt, item, view, config, rendererViewPort);\n\t\t\t\t}\n\t\t\t\tthis.append(item, dom, container);\n\n\t\t\t\tvar useBuffer = container.nodeType == 11;//DocumentFragment\n\t\t\t\tif(renderCallbackMethod && !useBuffer && dom) {\n\t\t\t\t\trenderCallbackMethod.call(gantt, item, dom, view);\n\t\t\t\t} \n\t\t\t},\n\n\t\t\tclear: function (container) {\n\n\t\t\t\tthis.rendered = task_area_pulls[id] = {};\n\t\t\t\tif(!layer.append)\n\t\t\t\t\tthis.clear_container(container);\n\t\t\t},\n\t\t\tclear_container: function (container) {\n\t\t\t\tcontainer = container || node;\n\t\t\t\tif (container){\n\t\t\t\t\tcontainer.innerHTML = \"\";\n\t\t\t\t}\n\t\t\t},\n\t\t\tget_visible_range: function(datastore){\n\t\t\t\tvar view = getView(layer);\n\t\t\t\tvar viewport;\n\t\t\t\tvar viewConfig = view ? view.$getConfig() : null;\n\t\t\t\tif(viewConfig && viewConfig.smart_rendering){\n\t\t\t\t\tviewport = view.getViewPort();\n\t\t\t\t}\n\n\t\t\t\tvar range;\n\t\t\t\tif(view && viewport){\n\t\t\t\t\tif(typeof layer.renderer === \"function\"){\n\t\t\t\t\t\trange = basicGetRange(gantt, view, viewConfig, datastore, viewport);\n\t\t\t\t\t}else if(layer.renderer && layer.renderer.getVisibleRange){\n\t\t\t\t\t\trange = layer.renderer.getVisibleRange(gantt, view, viewConfig, datastore, viewport);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!range){\n\t\t\t\t\trange = {\n\t\t\t\t\t\tstart: 0,\n\t\t\t\t\t\tend: datastore.count()\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\treturn range;\n\t\t\t},\n\t\t\tprepare_data: function(items){\n\t\t\t\tif(layer.renderer && layer.renderer.prepareData){\n\t\t\t\t\treturn layer.renderer.prepareData(items, gantt, layer);\n\t\t\t\t}\n\t\t\t},\n\t\t\trender_items: function (items, container) {\n\t\t\t\tcontainer = container || node;\n\n\t\t\t\tvar buffer = document.createDocumentFragment();\n\t\t\t\tthis.clear(container);\n\n\t\t\t\tvar viewPort = null;\n\t\t\t\tvar view = getView(layer);\n\t\t\t\tvar viewConfig = view ? view.$getConfig() : null;\n\t\t\t\tif(viewConfig && viewConfig.smart_rendering){\n\t\t\t\t\tviewPort = view.getViewPort();\n\t\t\t\t}\n\n\t\t\t\tfor (var i = 0, vis = items.length; i < vis; i++) {\n\t\t\t\t\tthis.render_item(items[i], buffer, viewPort, view, viewConfig);\n\t\t\t\t}\n\n\t\t\t\tcontainer.appendChild(buffer, container);\n\n\t\t\t\tvar itemsSearch = {};\n\t\t\t\titems.forEach(function(item){\n\t\t\t\t\titemsSearch[item.id] = item;\n\t\t\t\t});\n\t\t\t\tvar renderedItems = {};\n\t\t\t\tif (renderCallbackMethod) {\n\t\t\t\t\tvar newElements = {};\n\t\t\t\t\tfor(var i in this.rendered) {\n\t\t\t\t\t\tif(!renderedItems[i]){\n\t\t\t\t\t\t\tnewElements[i] = this.rendered[i];\n\t\t\t\t\t\t\trenderCallbackMethod.call(gantt, itemsSearch[i], this.rendered[i], view);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdate_items: function (items, container) {\n\t\t\t\tvar view = getView(layer);\n\t\t\t\tvar viewConfig = view ? view.$getConfig() : null;\n\t\t\t\tif(!view || !view.$getConfig().smart_rendering || isLegacyRender(gantt)){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif(!this.rendered){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif(!(getRectangle || specializedViewPortChecker)){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tcontainer = container || node;\n\n\t\t\t\tvar buffer = document.createDocumentFragment();\n\n\t\t\t\tvar viewPort = null;\n\t\t\t\tif(view){\n\t\t\t\t\tviewPort = view.getViewPort();\n\t\t\t\t}\n\n\t\t\t\tvar itemsSearch = {};\n\t\t\t\titems.forEach(function(item){\n\t\t\t\t\titemsSearch[item.id] = item;\n\t\t\t\t});\n\t\t\t\tvar renderedItems = {};\n\n\t\t\t\tvar nodesToRemove = {};\n\t\t\t\tfor(var i in this.rendered){\n\t\t\t\t\tnodesToRemove[i] = true;\n\t\t\t\t\trenderedItems[i] = true;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar renderCalledFor = {};\n\t\t\t\tfor (var i = 0, vis = items.length; i < vis; i++) {\n\t\t\t\t\tvar item = items[i];\n\t\t\t\t\tvar itemNode = this.rendered[item.id];\n\t\t\t\t\tnodesToRemove[item.id] = false;\n\t\t\t\t\tif (itemNode && itemNode.parentNode) {\n\t\t\t\t\t\tvar isVisible = false;\n\t\t\t\t\t\tif(specializedViewPortChecker){\n\t\t\t\t\t\t\tisVisible = specializedViewPortChecker(item, viewPort, view, viewConfig, gantt);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tisVisible = genericViewPortChecker(viewPort, getRectangle(item, view, viewConfig, gantt), gantt);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!isVisible) {\n\t\t\t\t\t\t\tnodesToRemove[item.id] = true;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif(updateMethod){\n\t\t\t\t\t\t\t\tupdateMethod.call(gantt, item, itemNode, view, viewConfig, viewPort);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.restore(item, buffer);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\trenderCalledFor[items[i].id] = true;\n\t\t\t\t\t\tthis.render_item(items[i], buffer, viewPort, view, viewConfig);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor(var i in nodesToRemove){\n\t\t\t\t\tif(nodesToRemove[i]){\n\t\t\t\t\t\tthis.hide(i);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(buffer.childNodes.length){\n\t\t\t\t\tcontainer.appendChild(buffer, container);\n\t\t\t\t}\n\n\t\t\t\tif (renderCallbackMethod) {\n\t\t\t\t\tvar newElements = {};\n\t\t\t\t\tfor(var i in this.rendered) {\n\t\t\t\t\t\tif(!renderedItems[i] || renderCalledFor[i]){\n\t\t\t\t\t\t\tnewElements[i] = this.rendered[i];\n\t\t\t\t\t\t\trenderCallbackMethod.call(gantt, itemsSearch[i], this.rendered[i], view);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t},\n\t\t\tappend: function (item, node, container) {\n\t\t\t\tif(!this.rendered){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!node) {\n\t\t\t\t\tif (this.rendered[item.id]) {\n\t\t\t\t\t\tthis.remove_item(item.id);\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (this.rendered[item.id] && this.rendered[item.id].parentNode) {\n\t\t\t\t\tthis.replace_item(item.id, node);\n\t\t\t\t} else {\n\t\t\t\t\tcontainer.appendChild(node);\n\t\t\t\t}\n\t\t\t\tthis.rendered[item.id] = node;\n\t\t\t},\n\t\t\treplace_item: function (item_id, newNode) {\n\t\t\t\tvar item = this.rendered[item_id];\n\t\t\t\tif (item && item.parentNode) {\n\t\t\t\t\titem.parentNode.replaceChild(newNode, item);\n\n\t\t\t\t}\n\t\t\t\tthis.rendered[item_id] = newNode;\n\t\t\t},\n\t\t\tremove_item: function (item_id) {\n\t\t\t\tthis.hide(item_id);\n\t\t\t\tdelete this.rendered[item_id];\n\t\t\t},\n\t\t\thide: function (item_id) {\n\t\t\t\tvar item = this.rendered[item_id];\n\t\t\t\tif (item && item.parentNode) {\n\t\t\t\t\titem.parentNode.removeChild(item);\n\t\t\t\t}\n\t\t\t\tdelete this.rendered[item_id];\n\t\t\t},\n\t\t\trestore: function (item, container) {\n\t\t\t\tvar dom = this.rendered[item.id];\n\t\t\t\tif (dom) {\n\t\t\t\t\tif (!dom.parentNode) {\n\t\t\t\t\t\tthis.append(item, dom, container || node);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.render_item(item, container || node);\n\t\t\t\t}\n\t\t\t},\n\t\t\tchange_id: function (oldid, newid) {\n\t\t\t\tthis.rendered[newid] = this.rendered[oldid];\n\t\t\t\tdelete this.rendered[oldid];\n\t\t\t},\n\t\t\trendered: task_area_pulls[id],\n\t\t\tnode: node,\n\t\t\tdestructor: function () {\n\t\t\t\tthis.clear();\n\t\t\t\tdelete task_area_renderers[id];\n\t\t\t\tdelete task_area_pulls[id];\n\t\t\t}\n\t\t};\n\n\t\treturn task_area_renderers[id];\n\t}\n\n\n\tfunction clearRenderers() {\n\t\tfor (var i in task_area_renderers) {\n\t\t\tgetRenderer(i).destructor();\n\t\t}\n\t}\n\n\treturn {\n\t\tgetRenderer: getRenderer,\n\t\tclearRenderers: clearRenderers\n\t};\n\n};\n\nexport default rendererFactory;","import renderFactoryProvider from \"./render_factory\";\nimport * as utils from \"../../../utils/utils\";\nimport * as domHelpers from \"../utils/dom_helpers\";\nimport isLegacyRender from \"./is_legacy_smart_render\";\n\nvar layerFactory = function(gantt){\n\n\tvar renderFactory = renderFactoryProvider(gantt);\n\treturn {\n\tcreateGroup: function (getContainer, relativeRoot, defaultFilters, initLayer) {\n\n\t\tvar renderGroup = {\n\t\t\ttempCollection: [],\n\t\t\trenderers: {},\n\t\t\tcontainer: getContainer,\n\t\t\tfilters: [],\n\t\t\tgetLayers: function () {\n\t\t\t\tthis._add();// add pending layers\n\n\t\t\t\tvar res = [];\n\t\t\t\tfor (var i in this.renderers) {\n\t\t\t\t\tres.push(this.renderers[i]);\n\t\t\t\t}\n\t\t\t\treturn res;\n\t\t\t},\n\t\t\tgetLayer: function (id) {\n\t\t\t\treturn this.renderers[id];\n\t\t\t},\n\t\t\t_add: function (layer) {\n\t\t\t\tif (layer) {\n\t\t\t\t\tlayer.id = layer.id || utils.uid();\n\t\t\t\t\tthis.tempCollection.push(layer);\n\t\t\t\t}\n\n\t\t\t\tconst container = this.container();\n\t\t\t\tconst pending = this.tempCollection;\n\t\t\t\tfor (let i = 0; i < pending.length; i++) {\n\t\t\t\t\tlayer = pending[i];\n\t\t\t\t\t// GS-2803: in case of Salesforce domHelpers.isChildOf check with document.body doesn't work\n\t\t\t\t\t// instead we check it with isConnected property\n\t\t\t\t\tif (!this.container() && !(layer && layer.container && layer.container.isConnected)) continue;\n\n\t\t\t\t\tlet node = layer.container,\n\t\t\t\t\t\tid = layer.id,\n\t\t\t\t\t\ttopmost = layer.topmost;\n\t\t\t\t\tif (!node.parentNode) {\n\t\t\t\t\t\t//insert on top or below the tasks\n\t\t\t\t\t\tif (topmost) {\n\t\t\t\t\t\t\tcontainer.appendChild(node);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tlet rel = relativeRoot ? relativeRoot() : container.firstChild;\n\t\t\t\t\t\t\t// GS-1274: if we don't add the second check, Gantt stops working if\n\t\t\t\t\t\t\t// we add the task layer without the timeline and switch to a layout with the timeline\n\t\t\t\t\t\t\tif (rel && rel.parentNode == container)\n\t\t\t\t\t\t\t\tcontainer.insertBefore(node, rel);\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tcontainer.appendChild(node);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.renderers[id] = renderFactory.getRenderer(\n\t\t\t\t\t\tid,\n\t\t\t\t\t\tlayer,\n\t\t\t\t\t\tnode\n\t\t\t\t\t);\n\n\t\t\t\t\tif (initLayer) {\n\t\t\t\t\t\tinitLayer(layer, gantt);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.tempCollection.splice(i, 1);\n\t\t\t\t\ti--;\n\t\t\t\t}\n\t\t\t},\n\t\t\taddLayer: function (config) {\n\t\t\t\tif(config){\n\t\t\t\t\tif(typeof config == \"function\"){\n\t\t\t\t\t\tconfig = {renderer: config};\n\t\t\t\t\t}\n\n\t\t\t\t\tif(config.filter === undefined){\n\t\t\t\t\t\tconfig.filter = mergeFilters(defaultFilters || []);\n\t\t\t\t\t}else if(config.filter instanceof Array){\n\t\t\t\t\t\tconfig.filter.push(defaultFilters);\n\t\t\t\t\t\tconfig.filter = mergeFilters(config.filter);\n\t\t\t\t\t}\n\n\t\t\t\t\tif(!config.container){\n\t\t\t\t\t\tconfig.container = document.createElement(\"div\");\n\t\t\t\t\t}\n\t\t\t\t\tvar self = this;\n\t\t\t\t\tconfig.requestUpdate = function(){\n\t\t\t\t\t\tif(gantt.config.smart_rendering && !isLegacyRender(gantt)){\n\t\t\t\t\t\t\tif(self.renderers[config.id]){\n\t\t\t\t\t\t\t\tself.onUpdateRequest(self.renderers[config.id]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tthis._add(config);\n\t\t\t\treturn (config ? config.id : undefined);\n\t\t\t},\n\t\t\tonUpdateRequest: function(layer){\n\n\t\t\t},\n\n\t\t\teachLayer: function(code){\n\t\t\t\tfor (var i in this.renderers) {\n\t\t\t\t\tcode(this.renderers[i]);\n\t\t\t\t}\n\t\t\t},\n\t\t\tremoveLayer: function (id) {\n\t\t\t\tif(!this.renderers[id])\n\t\t\t\t\treturn;\n\t\t\t\tthis.renderers[id].destructor();\n\t\t\t\tdelete this.renderers[id];\n\t\t\t},\n\t\t\tclear: function () {\n\t\t\t\tfor (var i in this.renderers) {\n\t\t\t\t\tthis.renderers[i].destructor();\n\t\t\t\t}\n\t\t\t\tthis.renderers = {};\n\t\t\t}//,\n\t\t\t//prepareConfig: prepareConfig\n\t\t};\n\n\t\tgantt.attachEvent(\"onDestroy\", function(){\n\t\t\trenderGroup.clear();\n\t\t\trenderGroup = null;\n\t\t});\n\n\t\treturn renderGroup;\n\t}\n};};\n\n\nfunction mergeFilters(filter_methods){\n\tif(!(filter_methods instanceof Array)){\n\t\tfilter_methods = Array.prototype.slice.call(arguments, 0);\n\t}\n\n\treturn function(obj){\n\t\tvar res = true;\n\t\tfor(var i = 0, len = filter_methods.length; i < len; i++){\n\t\t\tvar filter_method = filter_methods[i];\n\t\t\tif(filter_method){\n\t\t\t\tres = res && (filter_method(obj.id, obj) !== false);\n\t\t\t}\n\t\t}\n\n\t\treturn res;\n\t};\n}\n\n\nexport default layerFactory;\n","export default function(item, view, config){\n\tif(!item.start_date || !item.end_date){\n\t\treturn null;\n\t}\n\tvar padding = 200;\n\tvar startCoord = view.posFromDate(item.start_date, view._getPositioningContext ? view._getPositioningContext(item) : null);\n\tvar endCoord = view.posFromDate(item.end_date, view._getPositioningContext ? view._getPositioningContext(item) : null);\n\tvar left = Math.min(startCoord, endCoord) - padding;\n\tvar right = Math.max(startCoord, endCoord) + padding;\n\treturn {\n\t\ttop: view.getItemTop(item.id),\n\t\theight: view.getItemHeight(item.id),\n\t\tleft: left,\n\t\twidth: right - left\n\t};\n};","import getLinkRectangle from \"../get_link_rectangle\";\n\nexport default function(){\n\tvar coordinates = [];\n\tvar calculated = false;\n\n\tfunction clearCache(){\n\t\tcoordinates = [];\n\t\tcalculated = false;\n\t}\n\n\tfunction buildCache(datastore, view, gantt){\n\t\tvar config = view.$getConfig();\n\t\tvar visibleItems = datastore.getVisibleItems();\n\t\t//datastore.eachItem(function(link){\n\t\tvisibleItems.forEach(function(link){\n\t\t\tvar rec = getLinkRectangle(link, view, config, gantt);\n\t\t\tif(!rec){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcoordinates.push({id: link.id, rec: rec});\n\t\t});\n\n\t\tcoordinates.sort(function(a, b){\n\t\t\tif(a.rec.right < b.rec.right){\n\t\t\t\treturn -1;\n\t\t\t}else {\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t});\n\n\t\tcalculated = true;\n\t}\n\n\tvar initialized = false;\n\tfunction init(datastore){\n\t\tif(initialized){\n\t\t\treturn;\n\t\t}\n\t\tinitialized = true;\n\t\tdatastore.attachEvent(\"onPreFilter\", clearCache);\n\t\tdatastore.attachEvent(\"onStoreUpdated\", clearCache);\n\t\tdatastore.attachEvent(\"onClearAll\", clearCache);\n\t\tdatastore.attachEvent(\"onBeforeStoreUpdate\", clearCache);\n\t}\n\n\treturn function getVisibleLinksRange(gantt, view, config, datastore, viewport){\n\t\tinit(datastore);\n\t\tif(!calculated){\n\t\t\tbuildCache(datastore, view, gantt);\n\t\t}\n\n\t\tvar visibleBoxes = [];\n\t\tfor(var i = 0; i < coordinates.length; i++){\n\t\t\tvar item = coordinates[i];\n\t\t\tvar box = item.rec;\n\t\t\tif(box.right < viewport.x){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(box.left < viewport.x_end && box.right > viewport.x && box.top < viewport.y_end && box.bottom > viewport.y){\n\t\t\t\tvisibleBoxes.push(item.id);\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn {\n\t\t\tids: visibleBoxes\n\t\t};\n\t};\n};","\n\nimport barRectangle from \"./get_bar_rectangle\";\n\nexport default function getLinkBox(item, view, config, gantt){\n\tif(!gantt.isTaskExists(item.source)){\n\t\treturn null;\n\t}\n\n\tif(!gantt.isTaskExists(item.target)){\n\t\treturn null;\n\t}\n\tvar sourceBox = barRectangle(gantt.getTask(item.source), view, gantt);\n\tvar targetBox = barRectangle(gantt.getTask(item.target), view, gantt);\n\n\tif(!sourceBox || !targetBox){\n\t\treturn null;\n\t}\n\n\tvar padding = 100;\n\tvar left = Math.min(sourceBox.left, targetBox.left) - padding;\n\tvar right = Math.max(sourceBox.left + sourceBox.width, targetBox.left + targetBox.width) + padding;\n\tvar top = Math.min(sourceBox.top, targetBox.top) - padding;\n\tvar bottom = Math.max(sourceBox.top + sourceBox.height, targetBox.top + targetBox.height) + padding;\n\n\treturn {\n\t\ttop: top,\n\t\theight: bottom - top,\n\t\tbottom,\n\t\tleft: left,\n\t\twidth: right - left,\n\t\tright\n\t};\n};\n","\n// optimized checker for links smart rendering\n\n// first check the vertical position since it's easier to calculate\n\nexport default function isLinkInViewPort(item, viewport, view, config, gantt){\n\tvar source = view.$gantt.getTask(item.source);\n\tvar target = view.$gantt.getTask(item.target);\n\t// check vertical visibility first since it's a lighter check\n\tvar sourceTop = view.getItemTop(source.id);\n\tvar sourceHeight = view.getItemHeight(source.id);\n\n\tvar targetTop = view.getItemTop(target.id);\n\tvar targetHeight = view.getItemHeight(target.id);\n\n\tif(viewport.y > sourceTop + sourceHeight &&\n\t\tviewport.y > targetTop + targetHeight){\n\t\treturn false;\n\t}\n\n\tif(viewport.y_end < targetTop &&\n\t\tviewport.y_end < sourceTop){\n\t\treturn false;\n\t}\n\n\tvar padding = 100;\n\tvar sourceLeft = view.posFromDate(source.start_date, view._getPositioningContext ? view._getPositioningContext(item) : null);\n\tvar sourceRight = view.posFromDate(source.end_date, view._getPositioningContext ? view._getPositioningContext(item) : null);\n\tvar targetLeft = view.posFromDate(target.start_date, view._getPositioningContext ? view._getPositioningContext(item) : null);\n\tvar targetRight = view.posFromDate(target.end_date, view._getPositioningContext ? view._getPositioningContext(item) : null);\n\n\tif(sourceLeft > sourceRight){\n\t\t// rtl\n\t\tvar tmp = sourceRight;\n\t\tsourceRight = sourceLeft;\n\t\tsourceLeft = tmp;\n\t}\n\tif(targetLeft > targetRight){\n\t\t// rtl\n\t\tvar tmp = targetRight;\n\t\ttargetRight = targetLeft;\n\t\ttargetLeft = tmp;\n\t}\n\tsourceLeft += -padding; // add buffer for custom elements\n\tsourceRight += padding;\n\ttargetLeft += -padding; // add buffer for custom elements\n\ttargetRight += padding;\n\n\tif(viewport.x > sourceRight &&\n\t\tviewport.x > targetRight){\n\t\treturn false;\n\t}\n\n\tif(viewport.x_end < sourceLeft &&\n\t\tviewport.x_end < targetLeft){\n\t\treturn false;\n\t}\n\treturn true;\n};\n","import createLayerFactory from \"./render/layer_engine\";\n\nimport getVisibleTaskRange from \"./render/viewport/get_visible_bars_range\";\nimport getVisibleLinksRangeFactory from \"./render/viewport/factory/get_visible_link_range\";\n\nimport isLinkInViewport from \"./render/viewport/is_link_in_viewport\";\n\nfunction initLayer(layer, gantt){\n\tif(!layer.view){\n\t\treturn;\n\t}\n\n\tvar view = layer.view;\n\tif(typeof view === \"string\"){\n\t\tview = gantt.$ui.getView(view);\n\t}\n\n\tif(view && view.attachEvent){\n\t\tview.attachEvent(\"onScroll\", function(){\n\t\t\tvar state = gantt.$services.getService(\"state\");\n\t\t\t// don't repaint if we're inside batchUpdate, a complete repaint will be called afterwards\n\t\t\tif(!state.getState(\"batchUpdate\").batch_update && !view.$config.$skipSmartRenderOnScroll){\n\t\t\t\tif(layer.requestUpdate){\n\t\t\t\t\tlayer.requestUpdate();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\nvar createLayerEngine = function(gantt){\n\tvar factory = createLayerFactory(gantt);\n\treturn {\n\t\tgetDataRender: function(name){\n\t\t\treturn gantt.$services.getService(\"layer:\" + name) || null;\n\t\t},\n\t\tcreateDataRender: function(config){\n\t\t\tvar name = config.name,\n\t\t\t\tdefaultContainer = config.defaultContainer,\n\t\t\t\tpreviusSiblingContainer = config.defaultContainerSibling;\n\n\t\t\tvar layers = factory.createGroup(\n\t\t\t\tdefaultContainer,\n\t\t\t\tpreviusSiblingContainer,\n\t\t\t\tfunction(itemId, item){\n\t\t\t\t\tif(layers.filters){\n\t\t\t\t\t\tfor(var i = 0; i < layers.filters.length; i++){\n\t\t\t\t\t\t\tif(layers.filters[i](itemId, item) === false){\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tinitLayer\n\t\t\t);\n\n\t\t\tgantt.$services.setService(\"layer:\" + name, function(){\n\t\t\t\treturn layers;\n\t\t\t});\n\n\t\t\tgantt.attachEvent(\"onGanttReady\", function () {\n\t\t\t\tlayers.addLayer();// init layers on start\n\t\t\t});\n\n\t\t\treturn layers;\n\t\t},\n\t\tinit: function(){\n\t\t\tvar taskLayers = this.createDataRender({\n\t\t\t\tname: \"task\",\n\t\t\t\tdefaultContainer: function(){\n\t\t\t\t\tif(gantt.$task_data){\n\t\t\t\t\t\treturn gantt.$task_data;\n\t\t\t\t\t}else if(gantt.$ui.getView(\"timeline\")){\n\t\t\t\t\t\treturn gantt.$ui.getView(\"timeline\").$task_data;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tdefaultContainerSibling: function(){\n\t\t\t\t\tif(gantt.$task_links){\n\t\t\t\t\t\treturn gantt.$task_links;\n\t\t\t\t\t}else if(gantt.$ui.getView(\"timeline\")){\n\t\t\t\t\t\treturn gantt.$ui.getView(\"timeline\").$task_links;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tfilter: function(item){\n\n\t\t\t\t}\n\t\t\t}, gantt);\n\n\t\t\tvar linkLayers = this.createDataRender({\n\t\t\t\tname: \"link\",\n\t\t\t\tdefaultContainer: function(){\n\t\t\t\t\tif(gantt.$task_data){\n\t\t\t\t\t\treturn gantt.$task_data;\n\t\t\t\t\t}else if(gantt.$ui.getView(\"timeline\")){\n\t\t\t\t\t\treturn gantt.$ui.getView(\"timeline\").$task_data;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, gantt);\n\n\t\t\treturn {\n\t\t\t\taddTaskLayer: function(config){\n\t\t\t\t\tconst rangeFunction = getVisibleTaskRange;\n\t\t\t\t\tif(typeof config === \"function\"){\n\t\t\t\t\t\tconfig = {\n\t\t\t\t\t\t\trenderer: {\n\t\t\t\t\t\t\t\trender: config,\n\t\t\t\t\t\t\t\tgetVisibleRange: rangeFunction\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(config.renderer && !config.renderer.getVisibleRange){\n\t\t\t\t\t\t\tconfig.renderer.getVisibleRange = rangeFunction;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tconfig.view = \"timeline\";\n\n\t\t\t\t\treturn taskLayers.addLayer(config);\n\t\t\t\t},\n\n\t\t\t\t_getTaskLayers: function(){\n\t\t\t\t\treturn taskLayers.getLayers();\n\t\t\t\t},\n\t\t\t\tremoveTaskLayer: function(id){\n\t\t\t\t\ttaskLayers.removeLayer(id);\n\t\t\t\t},\n\n\t\t\t\t_clearTaskLayers: function(){\n\t\t\t\t\ttaskLayers.clear();\n\t\t\t\t},\n\t\t\t\taddLinkLayer: function(config){\n\t\t\t\t\tconst rangeFunction = getVisibleLinksRangeFactory();\n\t\t\t\t\tif(typeof config === \"function\"){\n\t\t\t\t\t\tconfig = {\n\t\t\t\t\t\t\trenderer: {\n\t\t\t\t\t\t\t\trender: config,\n\t\t\t\t\t\t\t\tgetVisibleRange: rangeFunction\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(config.renderer && !config.renderer.getVisibleRange){\n\t\t\t\t\t\t\tconfig.renderer.getVisibleRange = rangeFunction;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tconfig.view = \"timeline\";\n\t\t\t\t\tif(config && config.renderer){\n\t\t\t\t\t\tif(!config.renderer.getRectangle && !config.renderer.isInViewPort){\n\t\t\t\t\t\t\tconfig.renderer.isInViewPort = isLinkInViewport;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn linkLayers.addLayer(config);\n\t\t\t\t},\n\n\t\t\t\t_getLinkLayers: function(){\n\t\t\t\t\treturn linkLayers.getLayers();\n\t\t\t\t},\n\t\t\t\tremoveLinkLayer: function(id){\n\t\t\t\t\tlinkLayers.removeLayer(id);\n\t\t\t\t},\n\n\t\t\t\t_clearLinkLayers: function(){\n\t\t\t\t\tlinkLayers.clear();\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t};\n};\n\nexport default createLayerEngine;","import * as utils from \"../../../utils/utils\";\nimport eventable from \"../../../utils/eventable\";\nimport * as domHelpers from \"../utils/dom_helpers\";\n\nvar Cell = (function () {\n\t\"use strict\";\n\n\tfunction Cell(parent, config, factory, gantt) {\n\t\tif (parent) {\n\t\t\tthis.$container = domHelpers.toNode(parent);\n\t\t\tthis.$parent = parent;\n\t\t}\n\t\t// save config\n\t\tthis.$config = utils.mixin(config, {\n\t\t\theaderHeight: 33\n\t\t});\n\t\tthis.$gantt = gantt;\n\t\tthis.$domEvents = gantt._createDomEventScope();\n\t\t// set id\n\t\tthis.$id = config.id || \"c\" + utils.uid();\n\n\t\tthis.$name = \"cell\";\n\t\tthis.$factory = factory;\n\t\tthis.$externalComponent = null;\n\n\t\teventable(this);\n\n\t}\n\n\tCell.prototype.destructor = function () {\n\t\tthis.$parent = this.$container = this.$view = null;\n\t\tvar mouse = this.$gantt.$services.getService(\"mouseEvents\");\n\t\tmouse.detach(\"click\", \"gantt_header_arrow\", this._headerClickHandler);\n\t\tthis.$domEvents.detachAll();\n\t\tthis.callEvent(\"onDestroy\", []);\n\t\tthis.detachAllEvents();\n\t};\n\tCell.prototype.cell = function (id) {\n\t\treturn null;\n\t};\n\n\tCell.prototype.scrollTo = function(left, top){\n\n\t\t//GS-333 Add a way to scroll the HTML views:\n\t\tvar cell = this.$view;\n\t\tif (this.$config.html) cell = this.$view.firstChild;\n\n\t\tif (left*1 == left){\n\t\t\tcell.scrollLeft = left;\n\t\t}\n\t\tif(top*1 == top){\n\t\t\tcell.scrollTop = top;\n\t\t}\n\t};\n\n\tCell.prototype.clear = function(){\n\t\tthis.getNode().innerHTML = \"\";\n\t\tthis.getNode().className = \"gantt_layout_content\";\n\t\tthis.getNode().style.padding = \"0\";\n\t};\n\n\tCell.prototype.resize = function (final) {\n\t\tif (this.$parent) {\n\t\t\treturn this.$parent.resize(final);\n\t\t}\n\n\t\tif(final === false){\n\t\t\tthis.$preResize = true;\n\t\t}\n\n\t\tvar topCont = this.$container;\n\t\tvar x = topCont.offsetWidth;\n\t\tvar y = topCont.offsetHeight;\n\t\tvar topSize = this.getSize();\n\t\tif (topCont === document.body) {\n\t\t\tx = document.body.offsetWidth;\n\t\t\ty = document.body.offsetHeight;\n\t\t}\n\t\tif (x < topSize.minWidth) {\n\t\t\tx = topSize.minWidth;\n\t\t}\n\t\tif (x > topSize.maxWidth) {\n\t\t\tx = topSize.maxWidth;\n\t\t}\n\t\tif (y < topSize.minHeight) {\n\t\t\ty = topSize.minHeight;\n\t\t}\n\t\tif (y > topSize.maxHeight) {\n\t\t\ty = topSize.maxHeight;\n\t\t}\n\t\tthis.setSize(x, y);\n\n\t\tif(!this.$preResize){\n\t\t//\tself.callEvent(\"onResize\", [x, y]);\n\t\t}\n\t\tthis.$preResize = false;\n\t};\n\n\tCell.prototype.hide = function () {\n\t\tthis._hide(true);\n\t\tthis.resize();\n\t};\n\tCell.prototype.show = function (force) {\n\t\tthis._hide(false);\n\t\tif (force && this.$parent) {\n\t\t\tthis.$parent.show();\n\t\t}\n\t\tthis.resize();\n\t};\n\tCell.prototype._hide = function (mode) {\n\t\tif (mode === true && this.$view.parentNode) {\n\t\t\tthis.$view.parentNode.removeChild(this.$view);\n\t\t}\n\t\telse if (mode === false && !this.$view.parentNode) {\n\t\t\tvar index = this.$parent.cellIndex(this.$id);\n\t\t\tthis.$parent.moveView(this, index);\n\t\t}\n\t\tthis.$config.hidden = mode;\n\t};\n\tCell.prototype.$toHTML = function (content, css) {\n\t\tif (content === void 0) { content = \"\"; }\n\t\tcss = [(css || \"\"), (this.$config.css || \"\")].join(\" \");\n\t\tvar obj = this.$config;\n\t\tvar header = \"\";\n\t\tif (obj.raw) {\n\t\t\tcontent = typeof obj.raw === \"string\" ? obj.raw : \"\";\n\t\t}\n\t\telse {\n\t\t\tif (!content) {\n\t\t\t\tlet renderedElement = null;\n\t\t\t\tif(typeof obj.html === \"function\"){\n\t\t\t\t\trenderedElement = obj.html();\n\t\t\t\t}else{\n\t\t\t\t\trenderedElement = obj.html;\n\t\t\t\t}\n\n\t\t\t\tif(this.$gantt.config.external_render && this.$gantt.config.external_render.isElement(renderedElement)){\n\t\t\t\t\tthis.$externalComponent = renderedElement;\n\t\t\t\t\trenderedElement = null;\n\t\t\t\t}\n\n\t\t\t\tcontent = \"<div class='gantt_layout_content' \"+(css ? \" class='\"+css+\"' \" : \"\")+\" >\" + (renderedElement || \"\") + \"</div>\";\n\t\t\t}\n\t\t\tif (obj.header) {\n\t\t\t\tvar collapseIcon = obj.canCollapse ? \"<div class='gantt_layout_header_arrow'></div>\" : \"\";\n\t\t\t\theader = \"<div class='gantt_layout_header'>\" + collapseIcon + \"<div class='gantt_layout_header_content'>\" + obj.header + \"</div></div>\";\n\t\t\t}\n\t\t}\n\t\treturn \"<div class='gantt_layout_cell \" + css + \"' data-cell-id='\" + this.$id + \"'>\" + header + content + \"</div>\";\n\t};\n\tCell.prototype.$fill = function (node, parent) {\n\t\tthis.$view = node;\n\t\tthis.$parent = parent;\n\t\tthis.init();\n\t};\n\tCell.prototype.getNode = function () {\n\t\treturn (this.$view.querySelector(\"gantt_layout_cell\") || this.$view);\n\t};\n\tCell.prototype.init = function () {\n\t\t// [NOT-GOOD] code is executed for each component, while it still has only one handler, it is no good\n\n\t\tvar self = this;\n\n\t\tthis._headerClickHandler = function(e){\n\t\t\tvar cellId = domHelpers.locateAttribute(e, \"data-cell-id\");\n\t\t\tif(cellId == self.$id){\n\t\t\t\tself.toggle();\n\t\t\t}\n\t\t};\n\n\t\tvar mouse = this.$gantt.$services.getService(\"mouseEvents\");\n\t\tmouse.delegate(\"click\", \"gantt_header_arrow\", this._headerClickHandler);\n\n\t\tthis.callEvent(\"onReady\", []);\n\t};\n\tCell.prototype.toggle = function () {\n\t\tthis.$config.collapsed = !this.$config.collapsed;\n\t\tthis.resize();\n\t};\n\tCell.prototype.getSize = function () {\n\t\tvar size = {\n\t\t\theight: this.$config.height || 0,\n\t\t\twidth: this.$config.width || 0,\n\t\t\tgravity: this.$config.gravity || 1,\n\t\t\tminHeight: this.$config.minHeight || 0,\n\t\t\tminWidth: this.$config.minWidth || 0,\n\t\t\tmaxHeight: this.$config.maxHeight || 100000000000,\n\t\t\tmaxWidth: this.$config.maxWidth || 100000000000\n\t\t};\n\t\tif (this.$config.collapsed) {\n\t\t\tvar mode = this.$config.mode === \"x\";\n\t\t\tsize[mode ? \"width\" : \"height\"] = size[mode ? \"maxWidth\" : \"maxHeight\"] = this.$config.headerHeight;\n\t\t}\n\t\treturn size;\n\t};\n\n\tCell.prototype.getContentSize = function(){\n\n\t\tvar width = this.$lastSize.contentX;\n\t\tif(width !== width*1){\n\t\t\twidth = this.$lastSize.width;\n\t\t}\n\n\t\tvar height = this.$lastSize.contentY;\n\t\tif(height !== height*1){\n\t\t\theight = this.$lastSize.height;\n\t\t}\n\n\t\treturn {\n\t\t\twidth: width,\n\t\t\theight: height\n\t\t};\n\t};\n\n\tCell.prototype._getBorderSizes = function(){\n\t\tvar borders = {\n\t\t\ttop: 0,\n\t\t\tright: 0,\n\t\t\tbottom: 0,\n\t\t\tleft: 0,\n\t\t\thorizontal: 0,\n\t\t\tvertical: 0\n\t\t};\n\t\tif(this._currentBorders){\n\t\t\tif(this._currentBorders[this._borders.left]){\n\t\t\t\tborders.left = 1;\n\t\t\t\tborders.horizontal++;\n\t\t\t}\n\n\t\t\tif(this._currentBorders[this._borders.right]){\n\t\t\t\tborders.right = 1;\n\t\t\t\tborders.horizontal++;\n\t\t\t}\n\n\t\t\tif(this._currentBorders[this._borders.top]){\n\t\t\t\tborders.top = 1;\n\t\t\t\tborders.vertical++;\n\t\t\t}\n\n\t\t\tif(this._currentBorders[this._borders.bottom]){\n\t\t\t\tborders.bottom = 1;\n\t\t\t\tborders.vertical++;\n\t\t\t}\n\t\t}\n\n\t\treturn borders;\n\n\t};\n\n\tCell.prototype.setSize = function (x, y) {\n\t\tthis.$view.style.width = x + \"px\";\n\t\tthis.$view.style.height = y + \"px\";\n\n\t\tvar borders = this._getBorderSizes();\n\t\tvar contentY = y - borders.vertical;\n\t\tvar contentX = x - borders.horizontal;\n\n\t\tthis.$lastSize = { x: x, y: y, contentX: contentX, contentY: contentY };\n\t\tif (this.$config.header) {\n\t\t\tthis._sizeHeader();\n\t\t}else{\n\t\t\tthis._sizeContent();\n\t\t}\n\t};\n\n\tCell.prototype._borders = {\n\t\t\"left\":\"gantt_layout_cell_border_left\",\n\t\t\"right\":\"gantt_layout_cell_border_right\",\n\t\t\"top\":\"gantt_layout_cell_border_top\",\n\t\t\"bottom\":\"gantt_layout_cell_border_bottom\"\n\t};\n\n\tCell.prototype._setBorders = function(css, view){\n\t\tif(!view) {\n\t\t\tview = this;\n\t\t}\n\t\tvar node = view.$view;\n\n\t\tfor( var i in this._borders){\n\t\t\tdomHelpers.removeClassName(node, this._borders[i]);\n\t\t}\n\n\t\tif(typeof css == \"string\"){\n\t\t\tcss = [css];\n\t\t}\n\n\t\tvar cssHash = {};\n\n\t\tfor(var i = 0; i < css.length; i++){\n\t\t\tdomHelpers.addClassName(node, css[i]);\n\t\t\tcssHash[css[i]] = true;\n\t\t}\n\n\t\tview._currentBorders = cssHash;\n\t};\n\n\n\tCell.prototype._sizeContent = function(){\n\t\tvar content = this.$view.childNodes[0];\n\t\tif(content && content.className == \"gantt_layout_content\"){\n\t\t\tcontent.style.height = this.$lastSize.contentY + \"px\";\n\t\t}\n\t};\n\n\tCell.prototype._sizeHeader = function () {\n\t\tvar size = this.$lastSize;\n\t\tsize.contentY -= this.$config.headerHeight;\n\t\tvar header = this.$view.childNodes[0];\n\t\tvar content = this.$view.childNodes[1];\n\t\tvar xLayout = this.$config.mode === \"x\";\n\t\tif (this.$config.collapsed) {\n\t\t\tcontent.style.display = \"none\";\n\t\t\tif (xLayout) {\n\t\t\t\theader.className = \"gantt_layout_header collapsed_x\";\n\t\t\t\theader.style.width = size.y + \"px\";\n\t\t\t\tvar d = Math.floor(size.y / 2 - size.x / 2);\n\t\t\t\theader.style.transform = \"rotate(90deg) translate(\" + d + \"px, \" + d + \"px)\";\n\t\t\t\tcontent.style.display = \"none\";\n\t\t\t}\n\t\t\telse {\n\t\t\t\theader.className = \"gantt_layout_header collapsed_y\";\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif (xLayout) {\n\t\t\t\theader.className = \"gantt_layout_header\";\n\t\t\t}\n\t\t\telse {\n\t\t\t\theader.className = \"gantt_layout_header vertical\";\n\t\t\t}\n\t\t\theader.style.width = 'auto';\n\t\t\theader.style.transform = '';\n\t\t\tcontent.style.display = \"\";\n\t\t\tcontent.style.height = size.contentY + \"px\";\n\t\t}\n\t\theader.style.height = this.$config.headerHeight + \"px\";\n\t};\n\treturn Cell;\n}());\n\nexport default Cell;\n","export default function (d, b) {\n\tfor (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n\tfunction __() { this.constructor = d; }\n\td.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};","import __extends from \"../../../utils/extends\";\nimport * as domHelpers from \"../utils/dom_helpers\";\nimport Cell from \"./cell\";\n\nvar Layout = (function (_super) {\n\t\"use strict\";\n\n\t__extends(Layout, _super);\n\tfunction Layout(parent, config, factory) {\n\t\tvar _this = _super.apply(this, arguments) || this;\n\n\t\tif(parent)\n\t\t\t_this.$root = true;\n\n\t\t_this._parseConfig(config);\n\t\t_this.$name = \"layout\";\n\t\treturn _this;\n\t}\n\n\tLayout.prototype.destructor = function () {\n\t\tif (this.$container && this.$view) {\n\t\t\tdomHelpers.removeNode(this.$view);\n\t\t}\n\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\t\t\tvar child = this.$cells[i];\n\t\t\tchild.destructor();\n\t\t}\n\t\tthis.$cells = [];\n\n\t\t_super.prototype.destructor.call(this);\n\t};\n\n\tLayout.prototype._resizeScrollbars = function(autosize, scrollbars){\n\t\tvar scrollChanged = false;\n\t\tvar visibleScrollbars = [],\n\t\t\thiddenScrollbars = [];\n\n\t\tconst scrollbarsToHide = [];\n\n\t\tfunction showScrollbar(scrollbar){\n\t\t\tscrollbar.$parent.show();\n\t\t\tscrollChanged = true;\n\t\t\tvisibleScrollbars.push(scrollbar);\n\t\t}\n\t\tfunction hideScrollbar(scrollbar){\n\t\t\tscrollbar.$parent.hide();\n\t\t\tscrollChanged = true;\n\t\t\thiddenScrollbars.push(scrollbar);\n\t\t}\n\n\t\tvar scrollbar;\n\t\tfor(var i = 0; i < scrollbars.length; i++){\n\t\t\tscrollbar = scrollbars[i];\n\n\t\t\tif(autosize[scrollbar.$config.scroll]) {\n\t\t\t\thideScrollbar(scrollbar);\n\t\t\t}else if(scrollbar.shouldHide()){\n\t\t\t\t//hideScrollbar(scrollbar);\n\t\t\t\tscrollbarsToHide.push(scrollbar);\n\t\t\t}else if(scrollbar.shouldShow()){\n\t\t\t\tshowScrollbar(scrollbar);\n\t\t\t}else{\n\t\t\t\tif(scrollbar.isVisible()){\n\t\t\t\t\tvisibleScrollbars.push(scrollbar);\n\t\t\t\t}else{\n\t\t\t\t\thiddenScrollbars.push(scrollbar);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tvar visibleGroups = {};\n\t\tfor(var i = 0; i < visibleScrollbars.length; i++){\n\t\t\tif(visibleScrollbars[i].$config.group){\n\t\t\t\tvisibleGroups[visibleScrollbars[i].$config.group] = true;\n\t\t\t}\n\t\t}\n\n\t\t// GS-2220\n\t\tscrollbarsToHide.forEach(function(scrollbar){\n\t\t\tif(!(scrollbar.$config.group && visibleGroups[scrollbar.$config.group])){\n\t\t\t\thideScrollbar(scrollbar);\n\t\t\t}\n\t\t});\n\n\t\tfor(var i = 0; i < hiddenScrollbars.length; i++){\n\t\t\tscrollbar = hiddenScrollbars[i];\n\n\t\t\tif(scrollbar.$config.group && visibleGroups[scrollbar.$config.group]){\n\t\t\t\tshowScrollbar(scrollbar);\n\t\t\t\t// GS-707 If the scrollbar was hidden then showed, the container resize shouldn't happen because of that\n\t\t\t\tfor(var j = 0; j < visibleScrollbars.length; j++){\n\t\t\t\t\tif(visibleScrollbars[j] == scrollbar){\n\t\t\t\t\t\tthis.$gantt.$scrollbarRepaint = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn scrollChanged;\n\t};\n\n\tLayout.prototype.getScrollbarsInfo = function(){\n\t\tconst scrollbars = this.getCellsByType(\"scroller\");\n\t\tconst scrollbarsInfo = [];\n\t\tscrollbars.forEach(scrollbar => {\n\t\t\tlet obj = {};\n\t\t\tconst {visible, direction, size, scrollSize, position} = scrollbar.getScrollState();\n\t\t\tlet linkedViews = scrollbar._getLinkedViews();\n\t\t\tlet boundViews = linkedViews.map(view => view.$config.id);\n\n\t\t\tobj.id = scrollbar.$id;\n\t\t\tobj.visible = visible;\n\t\t\tobj.boundViews = boundViews;\n\t\t\tif(direction === \"x\"){\n\t\t\t\tobj.x = size;\n\t\t\t\tobj.x_inner = scrollSize;\n\t\t\t\tobj.x_pos = position || 0;\n\t\t\t} else {\n\t\t\t\tobj.y = size;\n\t\t\t\tobj.y_inner = scrollSize;\n\t\t\t\tobj.y_pos = position || 0;\n\t\t\t}\n\t\t\tscrollbarsInfo.push(obj);\n\t\t});\n\t\treturn scrollbarsInfo;\n\t};\n\n\tLayout.prototype._syncCellSizes = function(groupName, newSize){\n\t\tif(!groupName)\n\t\t\treturn;\n\n\t\tvar groups = {};\n\n\t\tthis._eachChild(function(cell){\n\t\t\tif(cell.$config.group && cell.$name != \"scrollbar\" && cell.$name != \"resizer\"){\n\t\t\t\tif(!groups[cell.$config.group]){\n\t\t\t\t\tgroups[cell.$config.group] = [];\n\t\t\t\t}\n\t\t\t\tgroups[cell.$config.group].push(cell);\n\t\t\t}\n\t\t});\n\n\t\tif(groups[groupName]){\n\t\t\tthis._syncGroupSize(groups[groupName], newSize);\n\t\t}\n\t\treturn groups[groupName];\n\t};\n\n\tLayout.prototype._syncGroupSize = function(cells, newSize){\n\t\tif(!cells.length) return;\n\n\t\tvar property = cells[0].$parent._xLayout ? \"width\" : \"height\";\n\t\tvar direction = cells[0].$parent.getNextSibling(cells[0].$id) ? 1 : -1;\n\n\t\tvar newSizeValue = newSize.value;\n\t\tvar isGravity = newSize.isGravity;\n\t\tfor(var i = 0; i < cells.length; i++){\n\t\t\tvar ownSize = cells[i].getSize();\n\n\t\t\tvar resizeSibling = direction > 0 ? cells[i].$parent.getNextSibling(cells[i].$id) : cells[i].$parent.getPrevSibling(cells[i].$id);\n\t\t\tif(resizeSibling.$name == \"resizer\"){\n\t\t\t\tresizeSibling = direction > 0 ? resizeSibling.$parent.getNextSibling(resizeSibling.$id) : resizeSibling.$parent.getPrevSibling(resizeSibling.$id);\n\t\t\t}\n\t\t\tvar siblingSize = resizeSibling.getSize();\n\n\t\t\tif(!isGravity) {\n\t\t\t\tif(resizeSibling[property]){\n\t\t\t\t\tvar totalGravity = ownSize.gravity + siblingSize.gravity;\n\t\t\t\t\tvar totalSize = ownSize[property] + siblingSize[property];\n\t\t\t\t\tvar k = totalGravity / totalSize;\n\t\t\t\t\tcells[i].$config.gravity = k * newSizeValue;\n\n\t\t\t\t\tresizeSibling.$config[property] = totalSize - newSizeValue;\n\t\t\t\t\tresizeSibling.$config.gravity = totalGravity - k * newSizeValue;\n\t\t\t\t}else{\n\t\t\t\t\tcells[i].$config[property] = newSizeValue;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tcells[i].$config.gravity = newSizeValue;\n\t\t\t}\n\n\t\t\tvar mainGrid = this.$gantt.$ui.getView(\"grid\");\n\t\t\tif(mainGrid && cells[i].$content === mainGrid && !mainGrid.$config.scrollable && !isGravity){\n\t\t\t\tthis.$gantt.config.grid_width = newSizeValue;\n\t\t\t}\n\t\t}\n\t};\n\n\tLayout.prototype.resize = function(startStage){\n\t\tvar mainCall = false;\n\t\tif(this.$root && !this._resizeInProgress){\n\t\t\tthis.callEvent(\"onBeforeResize\", []);\n\t\t\tmainCall = true;\n\t\t\tthis._resizeInProgress = true;\n\t\t}\n\n\t\t_super.prototype.resize.call(this, true);\n\t\t_super.prototype.resize.call(this, false);\n\n\t\tif(mainCall){\n\n\t\t\tvar contentViews = [];\n\t\t\tcontentViews = contentViews.concat(this.getCellsByType(\"viewCell\"));\n\t\t\tcontentViews = contentViews.concat(this.getCellsByType(\"viewLayout\"));\n\t\t\tcontentViews = contentViews.concat(this.getCellsByType(\"hostCell\"));\n\n\t\t\tvar scrollbars = this.getCellsByType(\"scroller\");\n\n\t\t\tfor(var i = 0; i < contentViews.length; i++){\n\t\t\t\tif(!contentViews[i].$config.hidden)\n\t\t\t\t\tcontentViews[i].setContentSize();\n\t\t\t}\n\n\t\t\tvar autosize = this._getAutosizeMode(this.$config.autosize);\n\n\t/* // possible to rollback set content size when autisize is disabled, not sure if need to\n\t\t\tcontentViews.forEach(function(view){\n\t\t\t\tconst parent = view.$parent;\n\t\t\t\tif(!autosize.x){\n\t\t\t\t\tif(parent.$config.$originalWidthStored){\n\t\t\t\t\t\tparent.$config.$originalWidthStored = false;\n\t\t\t\t\t\tparent.$config.width = parent.$config.$originalWidth;\n\t\t\t\t\t\tparent.$config.$originalWidth = undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif(!autosize.y){\n\t\t\t\t\tif(parent.$config.$originalHeightStored){\n\t\t\t\t\t\tparent.$config.$originalHeightStored = false;\n\t\t\t\t\t\tparent.$config.height = parent.$config.$originalHeight;\n\t\t\t\t\t\tparent.$config.$originalHeight = undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});*/\n\t\t\t\n\t\t\tvar scrollChanged = this._resizeScrollbars(autosize, scrollbars);\n\n\t\t\tif(this.$config.autosize){\n\t\t\t\tthis.autosize(this.$config.autosize);\n\t\t\t\tcontentViews.forEach(function(view){\n\t\t\t\t\tconst parent = view.$parent;\n\t\t\t\t\tconst sizes = parent.getContentSize(autosize);\n\t\t\t\t\tif(autosize.x){\n\t\t\t\t\t\tif(!parent.$config.$originalWidthStored){\n\t\t\t\t\t\t\tparent.$config.$originalWidthStored = true;\n\t\t\t\t\t\t\tparent.$config.$originalWidth = parent.$config.width;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tparent.$config.width = sizes.width;\n\t\t\t\t\t}\n\t\t\t\t\tif(autosize.y){\n\t\t\t\t\t\tif(!parent.$config.$originalHeightStored){\n\t\t\t\t\t\t\tparent.$config.$originalHeightStored = true;\n\t\t\t\t\t\t\tparent.$config.$originalHeight = parent.$config.height;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tparent.$config.height = sizes.height;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tscrollChanged = true;\n\t\t\t}\n\n\t\t\tif(scrollChanged){\n\t\t\t\tthis.resize();\n\t\t\t\tfor(var i = 0; i < contentViews.length; i++){\n\t\t\t\t\tif(!contentViews[i].$config.hidden)\n\t\t\t\t\t\tcontentViews[i].setContentSize();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.callEvent(\"onResize\", []);\n\t\t}\n\t\tif(mainCall){\n\t\t\tthis._resizeInProgress = false;\n\t\t}\n\t};\n\n\tLayout.prototype._eachChild = function(code, cell){\n\t\tcell = cell || this;\n\t\tcode(cell);\n\t\tif(cell.$cells){\n\t\t\tfor(var i = 0; i < cell.$cells.length; i++){\n\t\t\t\tthis._eachChild(code, cell.$cells[i]);\n\t\t\t}\n\t\t}\n\t};\n\n\tLayout.prototype.isChild = function(view){\n\t\tvar res = false;\n\t\tthis._eachChild(function(child){\n\t\t\tif(child === view || child.$content === view){\n\t\t\t\tres = true;\n\t\t\t}\n\t\t});\n\t\treturn res;\n\t};\n\n\tLayout.prototype.getCellsByType = function(type){\n\t\tvar res = [];\n\t\tif(type === this.$name){\n\t\t\tres.push(this);\n\t\t}\n\n\t\tif(this.$content && this.$content.$name == type){\n\t\t\tres.push(this.$content);\n\t\t}\n\n\t\tif(this.$cells){\n\t\t\tfor(var i = 0; i < this.$cells.length; i++){\n\t\t\t\tvar children = Layout.prototype.getCellsByType.call(this.$cells[i], type);\n\t\t\t\tif(children.length){\n\t\t\t\t\tres.push.apply(res, children);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t};\n\n\tLayout.prototype.getNextSibling = function(cellId){\n\t\tvar index = this.cellIndex(cellId);\n\t\tif(index >= 0 && this.$cells[index + 1]){\n\t\t\treturn this.$cells[index + 1];\n\t\t}else{\n\t\t\treturn null;\n\t\t}\n\t};\n\n\tLayout.prototype.getPrevSibling = function(cellId){\n\t\tvar index = this.cellIndex(cellId);\n\t\tif(index >= 0 && this.$cells[index - 1]){\n\t\t\treturn this.$cells[index - 1];\n\t\t}else{\n\t\t\treturn null;\n\t\t}\n\t};\n\n\n\tLayout.prototype.cell = function (id) {\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\t\t\tvar child = this.$cells[i];\n\t\t\tif (child.$id === id) {\n\t\t\t\treturn child;\n\t\t\t}\n\t\t\tvar sub = child.cell(id);\n\t\t\tif (sub) {\n\t\t\t\treturn sub;\n\t\t\t}\n\t\t}\n\t};\n\tLayout.prototype.cellIndex = function (id) {\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\t\t\tif (this.$cells[i].$id === id) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t};\n\tLayout.prototype.moveView = function (view, ind) {\n\t\tif (this.$cells[ind] !== view) {\n\t\t\treturn window.alert(\"Not implemented\");\n\t\t}\n\t\telse {\n\t\t\tind += this.$config.header ? 1 : 0;\n\t\t\tvar node = this.$view;\n\t\t\tif (ind >= node.childNodes.length) {\n\t\t\t\tnode.appendChild(view.$view);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tnode.insertBefore(view.$view, node.childNodes[ind]);\n\t\t\t}\n\t\t}\n\t};\n\tLayout.prototype._parseConfig = function (config) {\n\t\tthis.$cells = [];\n\t\tthis._xLayout = !config.rows;\n\t\tvar cells = config.rows || config.cols || config.views;\n\t\tfor (var i = 0; i < cells.length; i++) {\n\t\t\tvar cell = cells[i];\n\t\t\tcell.mode = this._xLayout ? \"x\" : \"y\";\n\t\t\tvar $content = this.$factory.initUI(cell, this);\n\t\t\tif(!$content){\n\t\t\t\tcells.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}else{\n\t\t\t\t$content.$parent = this;\n\t\t\t\tthis.$cells.push($content);\n\t\t\t}\n\t\t}\n\t};\n\tLayout.prototype.getCells = function () {\n\t\treturn this.$cells;\n\t};\n\tLayout.prototype.render = function () {\n\t\tvar view = domHelpers.insertNode(this.$container, this.$toHTML());\n\n\t\tthis.$fill(view, null);\n\n\t\tconst gantt = this.$gantt;\n\t\tthis._eachChild((cell) => {\n\t\t\tif(cell.$externalComponent){\n\t\t\t\tgantt.config.external_render.renderElement(\n\t\t\t\t\tcell.$externalComponent, \n\t\t\t\t\tcell.$view.querySelector(\".gantt_layout_content\")\n\t\t\t\t);\n\t\t\t\tcell.$externalComponent = null;\n\t\t\t}\n\t\t});\n\t\tthis.callEvent(\"onReady\", []);\n\t\tthis.resize();\n\n\t\t// do simple repaint after the first call\n\t\tthis.render = this.resize;\n\t};\n\tLayout.prototype.$fill = function (node, parent) {\n\t\tthis.$view = node;\n\t\tthis.$parent = parent;\n\t\tvar cells = domHelpers.getChildNodes(node, \"gantt_layout_cell\");\n\t\tfor (var i = cells.length - 1; i >= 0; i--) {\n\t\t\tvar sub = this.$cells[i];\n\t\t\tsub.$fill(cells[i], this);\n\t\t\t// initially hidden cell\n\t\t\tif (sub.$config.hidden) {\n\t\t\t\tsub.$view.parentNode.removeChild(sub.$view);\n\t\t\t}\n\t\t}\n\t};\n\tLayout.prototype.$toHTML = function () {\n\t\tvar mode = this._xLayout ? \"x\" : \"y\";\n\t\tvar html = [];\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\t\t\thtml.push(this.$cells[i].$toHTML());\n\t\t}\n\t\treturn _super.prototype.$toHTML.call(this, html.join(\"\"), (this.$root ? \"gantt_layout_root \" : \"\") + \"gantt_layout gantt_layout_\" + mode);\n\t};\n\n\tLayout.prototype.getContentSize = function(mode){\n\t\tvar contentWidth = 0,\n\t\t\tcontentHeight = 0;\n\n\t\tvar cellSize, cell, borders;\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\t\t\tcell = this.$cells[i];\n\t\t\tif(cell.$config.hidden)\n\t\t\t\tcontinue;\n\n\t\t\tcellSize = cell.getContentSize(mode);\n\n\t\t\tif(cell.$config.view === \"scrollbar\" && mode[cell.$config.scroll]){\n\t\t\t\tcellSize.height = 0;\n\t\t\t\tcellSize.width = 0;\n\t\t\t}\n\n\t\t\tif(cell.$config.resizer){\n\t\t\t\tif(this._xLayout){\n\t\t\t\t\tcellSize.height = 0;\n\t\t\t\t}else{\n\t\t\t\t\tcellSize.width = 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tborders = cell._getBorderSizes();\n\n\t\t\tif(this._xLayout){\n\t\t\t\tcontentWidth += (cellSize.width + borders.horizontal);\n\t\t\t\tcontentHeight = Math.max(contentHeight, (cellSize.height + borders.vertical));\n\t\t\t}else{\n\t\t\t\tcontentWidth = Math.max(contentWidth, cellSize.width + borders.horizontal);\n\t\t\t\tcontentHeight += cellSize.height + borders.vertical;\n\t\t\t}\n\t\t}\n\n\t\tborders = this._getBorderSizes();\n\t\tcontentWidth += borders.horizontal;\n\t\tcontentHeight += borders.vertical;\n\n\t\t// GS-149 & GS-150: By default this code only increases the container sizes, because of that, the cell sizes\n\t\t// are also increased. Keep this code here in the case if something goes wrong\n\t\t/*\n\t\tif(this.$root){\n\t\t\tcontentWidth += 1;\n\t\t\tcontentHeight += 1;\n\t\t}\n\t\t*/\n\t\treturn {\n\t\t\twidth: contentWidth,\n\t\t\theight: contentHeight\n\t\t};\n\t};\n\n\tLayout.prototype._cleanElSize = function(value){\n\t\treturn ((value || \"\").toString().replace(\"px\", \"\") * 1 || 0);\n\t};\n\tLayout.prototype._getBoxStyles = function(div){\n\t\tvar computed = null;\n\t\tif(window.getComputedStyle){\n\t\t\tcomputed = window.getComputedStyle(div, null);\n\t\t}else{\n\t\t\t//IE with elem.currentStyle does not calculate sizes from %, so will use the default approach\n\t\t\tcomputed = {\n\t\t\t\t\"width\":div.clientWidth,\n\t\t\t\t\"height\":div.clientHeight\n\t\t\t};\n\t\t}\n\t\tvar properties = [\n\t\t\t\"width\",\n\t\t\t\"height\",\n\n\t\t\t\"paddingTop\",\n\t\t\t\"paddingBottom\",\n\t\t\t\"paddingLeft\",\n\t\t\t\"paddingRight\",\n\n\t\t\t\"borderLeftWidth\",\n\t\t\t\"borderRightWidth\",\n\t\t\t\"borderTopWidth\",\n\t\t\t\"borderBottomWidth\"\n\t\t];\n\t\tvar styles = {\n\t\t\tboxSizing:(computed.boxSizing == \"border-box\")\n\t\t};\n\n\t\tif(computed.MozBoxSizing){\n\t\t\tstyles.boxSizing = (computed.MozBoxSizing == \"border-box\");\n\t\t}\n\t\tfor(var i =0; i < properties.length; i++){\n\t\t\tstyles[properties[i]] = computed[properties[i]] ? this._cleanElSize(computed[properties[i]]) : 0;\n\t\t}\n\n\n\t\tvar box = {\n\t\t\thorPaddings : (styles.paddingLeft + styles.paddingRight + styles.borderLeftWidth + styles.borderRightWidth),\n\t\t\tvertPaddings : (styles.paddingTop + styles.paddingBottom + styles.borderTopWidth + styles.borderBottomWidth),\n\t\t\tborderBox: styles.boxSizing,\n\t\t\tinnerWidth : styles.width,\n\t\t\tinnerHeight : styles.height,\n\t\t\touterWidth : styles.width,\n\t\t\touterHeight : styles.height\n\t\t};\n\n\n\t\tif(box.borderBox){\n\t\t\tbox.innerWidth -= box.horPaddings;\n\t\t\tbox.innerHeight -= box.vertPaddings;\n\t\t}else{\n\t\t\tbox.outerWidth += box.horPaddings;\n\t\t\tbox.outerHeight += box.vertPaddings;\n\t\t}\n\n\t\treturn box;\n\t};\n\n\tLayout.prototype._getAutosizeMode = function(config){\n\t\tvar res = {x:false, y:false};\n\t\tif(config === \"xy\"){\n\t\t\tres.x = res.y = true;\n\t\t}else if(config === \"y\" || config === true){\n\t\t\tres.y = true;\n\t\t}else if(config === \"x\"){\n\t\t\tres.x = true;\n\t\t}\n\t\treturn res;\n\t};\n\n\tLayout.prototype.autosize = function(mode) {\n\t\tvar res = this._getAutosizeMode(mode);\n\t\tvar boxSizes = this._getBoxStyles(this.$container);\n\t\tvar contentSizes = this.getContentSize(mode);\n\n\t\tvar node = this.$container;\n\t\tif(res.x){\n\t\t\tif(boxSizes.borderBox){\n\t\t\t\tcontentSizes.width += boxSizes.horPaddings;\n\t\t\t}\n\t\t\tnode.style.width = contentSizes.width + \"px\";\n\t\t}\n\t\tif(res.y){\n\t\t\tif(boxSizes.borderBox){\n\t\t\t\tcontentSizes.height += boxSizes.vertPaddings;\n\t\t\t}\n\t\t\tnode.style.height = contentSizes.height + \"px\";\n\t\t}\n\t};\n\n\tLayout.prototype.getSize = function () {\n\t\tthis._sizes = [];\n\t\tvar width = 0;\n\t\tvar minWidth = 0;\n\t\tvar maxWidth = 100000000000;\n\t\tvar height = 0;\n\t\tvar maxHeight = 100000000000;\n\t\tvar minHeight = 0;\n\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\n\t\t\tvar size = this._sizes[i] = this.$cells[i].getSize();\n\t\t\tif (this.$cells[i].$config.hidden) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (this._xLayout) {\n\t\t\t\tif (!size.width && size.minWidth) {\n\t\t\t\t\twidth += size.minWidth;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\twidth += size.width;\n\t\t\t\t}\n\t\t\t\tmaxWidth += size.maxWidth;\n\t\t\t\tminWidth += size.minWidth;\n\t\t\t\theight = Math.max(height, size.height);\n\t\t\t\tmaxHeight = Math.min(maxHeight, size.maxHeight); // min of maxHeight\n\t\t\t\tminHeight = Math.max(minHeight, size.minHeight); // max of minHeight\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (!size.height && size.minHeight) {\n\t\t\t\t\theight += size.minHeight;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\theight += size.height;\n\t\t\t\t}\n\t\t\t\tmaxHeight += size.maxHeight;\n\t\t\t\tminHeight += size.minHeight;\n\t\t\t\twidth = Math.max(width, size.width);\n\t\t\t\tmaxWidth = Math.min(maxWidth, size.maxWidth); // min of maxWidth\n\t\t\t\tminWidth = Math.max(minWidth, size.minWidth); // max of minWidth\n\t\t\t}\n\t\t}\n\t\tvar self = _super.prototype.getSize.call(this);\n\t\t// maxWidth\n\t\tif (self.maxWidth >= 100000) {\n\t\t\tself.maxWidth = maxWidth;\n\t\t}\n\t\t// maxHeight\n\t\tif (self.maxHeight >= 100000) {\n\t\t\tself.maxHeight = maxHeight;\n\t\t}\n\t\t// minWidth\n\t\tself.minWidth = self.minWidth !== self.minWidth ? 0 : self.minWidth;// || self.width || Math.max(minWidth, width);\n\t\t// minHeight\n\t\tself.minHeight = self.minHeight !== self.minHeight ? 0 : self.minHeight;//self.minHeight || self.height || Math.max(minHeight, height);\n\t\t// sizes with paddings and margins\n\t\tif (this._xLayout) {\n\t\t\tself.minWidth += this.$config.margin * (this.$cells.length) || 0;\n\t\t\tself.minWidth += this.$config.padding * 2 || 0;\n\t\t\tself.minHeight += (this.$config.padding * 2) || 0;\n\t\t}\n\t\telse {\n\t\t\tself.minHeight += this.$config.margin * (this.$cells.length) || 0;\n\t\t\tself.minHeight += (this.$config.padding * 2) || 0;\n\t\t}\n\t\t\n\t\treturn self;\n\t};\n\t// calc total gravity and free space\n\tLayout.prototype._calcFreeSpace = function (s, cell, xLayout) {\n\t\tvar min = xLayout ? cell.minWidth : cell.minHeight;\n\t\tvar max = xLayout ? cell.maxWidth : cell.maxWidth;\n\t\tvar side = s;\n\t\tif (!side) {\n\t\t\tside = Math.floor(this._free / this._gravity * cell.gravity);\n\t\t\tif (side > max) {\n\t\t\t\tside = max;\n\t\t\t\tthis._free -= side;\n\t\t\t\tthis._gravity -= cell.gravity;\n\t\t\t}\n\t\t\tif (side < min) {\n\t\t\t\tside = min;\n\t\t\t\tthis._free -= side;\n\t\t\t\tthis._gravity -= cell.gravity;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif (side > max) {\n\t\t\t\tside = max;\n\t\t\t}\n\t\t\tif (side < min) {\n\t\t\t\tside = min;\n\t\t\t}\n\t\t\tthis._free -= side;\n\t\t}\n\t\treturn side;\n\t};\n\tLayout.prototype._calcSize = function (s, size, xLayout) {\n\t\tvar side = s;\n\t\tvar min = xLayout ? size.minWidth : size.minHeight;\n\t\tvar max = xLayout ? size.maxWidth : size.maxHeight;\n\t\tif (!side) {\n\t\t\tside = Math.floor(this._free / this._gravity * size.gravity);\n\t\t}\n\t\tif (side > max) {\n\t\t\tside = max;\n\t\t}\n\t\tif (side < min) {\n\t\t\tside = min;\n\t\t}\n\t\treturn side;\n\t};\n\n\tLayout.prototype._configureBorders = function(){\n\t\tif(this.$root){\n\t\t\tthis._setBorders([\n\t\t\t\tthis._borders.left,\n\t\t\t\tthis._borders.top,\n\t\t\t\tthis._borders.right,\n\t\t\t\tthis._borders.bottom\n\t\t\t],\n\t\t\tthis);\n\t\t}\n\n\t\tvar borderClass = this._xLayout ? this._borders.right : this._borders.bottom;\n\n\t\tvar cells = this.$cells;\n\n\t\tvar lastVisibleIndex = cells.length - 1;\n\t\tfor(var i = lastVisibleIndex; i >= 0; i--){\n\t\t\tif (!cells[i].$config.hidden) {\n\t\t\t\tlastVisibleIndex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tfor (var i = 0; i < cells.length; i++) {\n\t\t\tif (cells[i].$config.hidden) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar lastCell = i >= lastVisibleIndex;\n\t\t\tvar borderColorClass = \"\";\n\t\t\tif(!lastCell && cells[i + 1]){\n\t\t\t\tif(cells[i + 1].$config.view == \"scrollbar\"){\n\t\t\t\t\tif(this._xLayout){\n\t\t\t\t\t\tlastCell = true;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tborderColorClass = \"gantt_layout_cell_border_transparent\";\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\tthis._setBorders(lastCell ? [] : [borderClass, borderColorClass], cells[i]);\n\t\t}\n\t};\n\n\tLayout.prototype._updateCellVisibility = function(){\n\t\tvar oldVisibleCells = this._visibleCells || {};\n\t\tvar firstCall = !this._visibleCells;\n\t\tvar visibleCells = {};\n\t\tvar cell = null;\n\t\tvar parentVisibility = [];\n\t\tfor (var i = 0; i < this._sizes.length; i++) {\n\t\t\tcell = this.$cells[i];\n\t\t\tif (cell.$config.hide_empty){\n\t\t\t\tparentVisibility.push(cell);\n\t\t\t}\n\n\t\t\tif (!firstCall && cell.$config.hidden && oldVisibleCells[cell.$id]) {\n\t\t\t\tcell._hide(true);\n\t\t\t}else if(!cell.$config.hidden && !oldVisibleCells[cell.$id]){\n\t\t\t\tcell._hide(false);\n\t\t\t}\n\n\t\t\tif(!cell.$config.hidden){\n\t\t\t\tvisibleCells[cell.$id] = true;\n\t\t\t}\n\t\t}\n\t\tthis._visibleCells = visibleCells;\n\n\t\t// GS-27. A way to hide the whole cell if all its children are hidden\n\t\tfor (var i = 0; i < parentVisibility.length; i++) {\n\t\t\tvar cell = parentVisibility[i];\n\t\t\tvar children = cell.$cells;\n\t\t\tvar hideCell = true;\n\t\t\tchildren.forEach(function(child){\n\t\t\t\tif (!child.$config.hidden && !child.$config.resizer){\n\t\t\t\t\thideCell = false;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tcell.$config.hidden = hideCell;\n\t\t}\n\t};\n\n\tLayout.prototype.setSize = function (x, y) {\n\t\tthis._configureBorders();\n\t\t_super.prototype.setSize.call(this, x, y);\n\t\ty = this.$lastSize.contentY;\n\t\tx = this.$lastSize.contentX;\n\n\t\tvar padding = (this.$config.padding || 0);\n\t\tthis.$view.style.padding = padding + \"px\";\n\t\tthis._gravity = 0;\n\t\tthis._free = this._xLayout ? x : y;\n\t\tthis._free -= padding * 2;\n\t\t// calc all gravity\n\n\t\tvar cell,\n\t\t\tsize;\n\n\t\tthis._updateCellVisibility();\n\n\t\tfor (var i = 0; i < this._sizes.length; i++) {\n\t\t\tcell = this.$cells[i];\n\n\t\t\tif (cell.$config.hidden) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tvar margin = (this.$config.margin || 0);\n\t\t\tif(cell.$name == \"resizer\" && !margin){\n\t\t\t\tmargin = -1;\n\t\t\t}\n\n\t\t\t// set margins to child cell\n\t\t\tvar cellView = cell.$view;\n\n\t\t\tvar marginSide = this._xLayout ? \"marginRight\" : \"marginBottom\";\n\t\t\tif (i !== this.$cells.length - 1) {\n\t\t\t\tcellView.style[marginSide] = margin + \"px\";\n\t\t\t\tthis._free -= margin; // calc free space without margin\n\t\t\t}\n\t\t\tsize = this._sizes[i];\n\t\t\tif (this._xLayout) {\n\t\t\t\tif (!size.width) {\n\t\t\t\t\tthis._gravity += size.gravity;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (!size.height) {\n\t\t\t\t\tthis._gravity += size.gravity;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (var i = 0; i < this._sizes.length; i++) {\n\t\t\tcell = this.$cells[i];\n\n\t\t\tif (cell.$config.hidden) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tsize = this._sizes[i];\n\t\t\tvar width = size.width;\n\t\t\tvar height = size.height;\n\t\t\tif (this._xLayout) {\n\t\t\t\tthis._calcFreeSpace(width, size, true);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._calcFreeSpace(height, size, false);\n\t\t\t}\n\t\t}\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\t\t\tcell = this.$cells[i];\n\n\t\t\tif (cell.$config.hidden) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tsize = this._sizes[i];\n\t\t\tvar dx = void 0;\n\t\t\tvar dy = void 0;\n\t\t\tif (this._xLayout) {\n\t\t\t\tdx = this._calcSize(size.width, size, true);\n\t\t\t\tdy = y - padding * 2; // layout height without paddings\n\t\t\t}\n\t\t\telse {\n\t\t\t\tdx = x - padding * 2; // layout width without paddings\n\t\t\t\tdy = this._calcSize(size.height, size, false);\n\t\t\t}\n\n\t\t\tcell.setSize(dx, dy);\n\t\t}\n\n\t};\n\n\treturn Layout;\n}(Cell));\n\nexport default Layout;","import __extends from \"../../../utils/extends\";\nimport Layout from \"./layout\";\nimport Cell from \"./cell\";\n\nvar ViewLayout = (function (_super) {\n\t\"use strict\";\n\n\t__extends(ViewLayout, _super);\n\tfunction ViewLayout(parent, config, factory) {\n\t\tvar _this = _super.apply(this, arguments) || this;\n\t\tfor (var i = 0; i < _this.$cells.length; i++) {\n\t\t\t_this.$cells[i].$config.hidden = (i !== 0);\n\t\t}\n\t\t_this.$cell = _this.$cells[0];\n\t\t_this.$name = \"viewLayout\";\n\n\t\treturn _this;\n\t}\n\tViewLayout.prototype.cell = function (id) {\n\t\tvar cell = _super.prototype.cell.call(this, id);\n\t\tif (!cell.$view) {\n\t\t\tthis.$fill(null, this);\n\t\t}\n\t\treturn cell;\n\t};\n\tViewLayout.prototype.moveView = function (view) {\n\t\tvar body = this.$view;\n\t\tif (this.$cell) {\n\t\t\tthis.$cell.$config.hidden = true;\n\t\t\tbody.removeChild(this.$cell.$view);\n\t\t}\n\t\tthis.$cell = view;\n\t\tbody.appendChild(view.$view);\n\t};\n\tViewLayout.prototype.setSize = function (x, y) {\n\t\tCell.prototype.setSize.call(this, x, y);\n\t};\n\n\tViewLayout.prototype.setContentSize = function(){\n\t\tvar size = this.$lastSize;\n\t\tthis.$cell.setSize(size.contentX, size.contentY);\n\t};\n\n\tViewLayout.prototype.getSize = function () {\n\t\tvar sizes = _super.prototype.getSize.call(this);\n\t\tif (this.$cell) {\n\t\t\tvar cellSize = this.$cell.getSize();\n\t\t\tif (this.$config.byMaxSize) {\n\t\t\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\t\t\t\t\tvar otherCell = this.$cells[i].getSize();\n\t\t\t\t\tfor (var cell in cellSize) {\n\t\t\t\t\t\tcellSize[cell] = Math.max(cellSize[cell], otherCell[cell]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (var size in sizes) {\n\t\t\t\tsizes[size] = sizes[size] || cellSize[size];\n\t\t\t}\n\t\t\tsizes.gravity = Math.max(sizes.gravity, cellSize.gravity);\n\t\t}\n\t\treturn sizes;\n\t};\n\treturn ViewLayout;\n}(Layout));\n\nexport default ViewLayout;","import __extends from \"../../../utils/extends\";\nimport * as utils from \"../../../utils/utils\";\nimport Cell from \"./cell\";\n\nvar ViewCell = (function (_super) {\n\t\"use strict\";\n\n\t__extends(ViewCell, _super);\n\tfunction ViewCell(parent, config, factory) {\n\n\t\tvar _this = _super.apply(this, arguments) || this;\n\n\t\tif(config.view){\n\t\t\tif(config.id){\n\t\t\t\t// pass id to the nested view\n\t\t\t\tthis.$id = utils.uid();\n\t\t\t}\n\t\t\tvar childConfig = utils.copy(config);\n\t\t\tdelete childConfig.config;\n\t\t\tdelete childConfig.templates;\n\n\t\t\tthis.$content = this.$factory.createView(config.view, this, childConfig, this);\n\t\t\tif(!this.$content)\n\t\t\t\treturn false;\n\t\t}\n\n\t\t_this.$name = \"viewCell\";\n\t\treturn _this;\n\t}\n\n\tViewCell.prototype.destructor = function(){\n\t\tthis.clear();\n\t\t_super.prototype.destructor.call(this);\n\t};\n\n\tViewCell.prototype.clear = function(){\n\n\t\tthis.$initialized = false;\n\n\t\t// call destructor\n\t\tif (this.$content){\n\t\t\tvar method = this.$content.unload || this.$content.destructor;\n\t\t\tif (method){\n\t\t\t\tmethod.call(this.$content);\n\t\t\t}\n\t\t}\n\n\t\t_super.prototype.clear.call(this);\n\n\t};\n\n\tViewCell.prototype.scrollTo = function(left, top){\n\n\t\tif(this.$content && this.$content.scrollTo){\n\t\t\tthis.$content.scrollTo(left, top);\n\t\t}else{\n\t\t\t_super.prototype.scrollTo.call(this, left, top);\n\t\t}\n\t};\n\n\tViewCell.prototype._setContentSize = function(x, y){\n\t\tvar borders = this._getBorderSizes();\n\t\tif(typeof x === \"number\"){\n\t\t\tvar outerX = x + borders.horizontal;\n\t\t\tthis.$config.width = outerX;\n\t\t}\n\t\tif(typeof y === \"number\"){\n\t\t\tvar outerY = y + borders.vertical;\n\t\t\tthis.$config.height = outerY;\n\t\t}\n\t};\n\n\tViewCell.prototype.setSize = function(x, y){\n\t\t_super.prototype.setSize.call(this, x, y);\n\n\t\tif(!this.$preResize && this.$content) {\n\t\t\tif (!this.$initialized) {\n\t\t\t\tthis.$initialized = true;\n\t\t\t\tvar header = this.$view.childNodes[0];\n\t\t\t\tvar content = this.$view.childNodes[1];\n\t\t\t\tif(!content) content = header;\n\n\t\t\t\t/*if(this.$content.$config){\n\t\t\t\t\tthis.$content.$config.width = this.$lastSize.contentX;\n\t\t\t\t\tthis.$content.$config.height = this.$lastSize.contentY;\n\t\t\t\t}*/\n\t\t\t\tthis.$content.init(content);\n\t\t\t}\n\t\t}\n\t};\n\n\tViewCell.prototype.setContentSize = function(){\n\t\tif(!this.$preResize && this.$content) {\n\t\t\tif (this.$initialized) {\n\t\t\t\tthis.$content.setSize(this.$lastSize.contentX, this.$lastSize.contentY);\n\t\t\t}\n\t\t}\n\t};\n\n\n\tViewCell.prototype.getContentSize = function(){\n\t\tvar size = _super.prototype.getContentSize.call(this);\n\n\t\tif(this.$content && this.$initialized){\n\t\t\tvar childSize = this.$content.getSize();\n\t\t\tsize.width = childSize.contentX === undefined ? childSize.width : childSize.contentX;\n\t\t\tsize.height = childSize.contentY === undefined ? childSize.height : childSize.contentY;\n\t\t}\n\n\t\tvar borders = this._getBorderSizes();\n\t\tsize.width += borders.horizontal;\n\t\tsize.height += borders.vertical;\n\n\t\treturn size;\n\t};\n\n\treturn ViewCell;\n}(Cell));\n\nexport default ViewCell;","import __extends from \"../../../utils/extends\";\nimport * as domHelpers from \"../utils/dom_helpers\";\nimport * as utils from \"../../../utils/utils\";\nimport Cell from \"./cell\";\n\nvar ResizerCell = (function (_super) {\n\t\"use strict\";\n\n\t__extends(ResizerCell, _super);\n\tfunction ResizerCell(parent, config, factory) {\n\t\tvar _this = _super.apply(this, arguments) || this;\n\n\t\tvar startBackSize, startFrontSize;\n\n\t\tfunction getPageCoordinates(e){\n\t\t\tvar x = e.pageX;\n\t\t\tvar y = e.pageY;\n\n\t\t\tif (e.touches){\n\t\t\t\tx =  e.touches[0].pageX;\n\t\t\t\ty =  e.touches[0].pageY;\n\t\t\t}\n\n\t\t\treturn {x:x,y:y};\n\t\t}\n\n\t\t_this._moveHandler = function (e) {\n\t\t\t_this._moveResizer(_this._resizer, getPageCoordinates(e).x, getPageCoordinates(e).y);\n\t\t};\n\t\t_this._upHandler = function (e) {\n\t\t\tvar newSizes = _this._getNewSizes();\n\t\t\tif(_this.callEvent(\"onResizeEnd\", [startBackSize, startFrontSize, newSizes ? newSizes.back : 0, newSizes ? newSizes.front : 0]) !== false){\n\t\t\t\t_this._setSizes();\n\t\t\t}\n\n\t\t\t_this._setBackground(false);\n\t\t\t_this._clearResizer();\n\t\t\t_this._clearListeneres();\n\n\t\t\tif (e.touches) _this.$gantt._prevent_touch_scroll = false;\n\t\t};\n\n\t\t_this._clearListeneres = function(){\n\t\t\tthis.$domEvents.detach(document, \"mouseup\", _this._upHandler);\n\t\t\tthis.$domEvents.detach(document, \"mousemove\", _this._moveHandler);\n\t\t\tthis.$domEvents.detach(document, \"mousemove\", _this._startOnMove);\n\t\t\tthis.$domEvents.detach(document, \"mouseup\", _this._cancelDND);\n\n\t\t\tthis.$domEvents.detach(document, \"touchend\", _this._upHandler);\n\t\t\tthis.$domEvents.detach(document, \"touchmove\", _this._startOnMove);\n\t\t\tthis.$domEvents.detach(document, \"touchstart\", _this._downHandler);\n\t\t};\n\n\t\t_this._callStartDNDEvent = function(){\n\t\t\tif (this._xMode) {\n\t\t\t\tstartBackSize = this._behind.$config.width || this._behind.$view.offsetWidth;\n\t\t\t\tstartFrontSize = this._front.$config.width || this._front.$view.offsetWidth;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tstartBackSize = this._behind.$config.height || this._behind.$view.offsetHeight;\n\t\t\t\tstartFrontSize = this._front.$config.height || this._front.$view.offsetHeight;\n\t\t\t}\n\n\t\t\tif(_this.callEvent(\"onResizeStart\", [startBackSize, startFrontSize]) === false){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t};\n\n\t\t_this._startDND = function(e){\n\t\t\tvar res = this._callStartDNDEvent();\n\t\t\tif(res === false){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar stop = false;\n\t\t\tthis._eachGroupItem(function(resizer){\n\t\t\t\tresizer._getSiblings();\n\t\t\t\tif(resizer._callStartDNDEvent() === false){\n\t\t\t\t\tstop = true;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif(stop){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t_this._moveHandler(e);\n\n\t\t\t_this.$domEvents.attach(document, \"mousemove\", _this._moveHandler);\n\t\t\t_this.$domEvents.attach(document, \"mouseup\", _this._upHandler);\n\t\t};\n\n\t\t_this._cancelDND = function(){\n\t\t\t_this._setBackground(false);\n\t\t\t_this._clearResizer();\n\t\t\t_this._clearListeneres();\n\t\t};\n\n\t\t_this._startOnMove = function(e){\n\t\t\t// don't scroll the timeline on touch devices\n\t\t\tif (e.touches){\n\t\t\t\t_this.$gantt._touch_drag = true;\n\t\t\t\t// GS-45. Don't scroll the timeline while dragging something on touch devices (e.g. resizer)\n\t\t\t\t_this.$gantt._prevent_touch_scroll = true;\n\t\t\t}\n\n\t\t\tif(_this._isPosChanged(e)){\n\t\t\t\t_this._clearListeneres();\n\t\t\t\t_this._startDND(e);\n\t\t\t}\n\t\t};\n\n\t\t_this._downHandler = function (e) {\n\t\t\t_this._getSiblings();\n\n\t\t\tif (_this._behind.$config.collapsed || _this._front.$config.collapsed) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t_this._setBackground(true);\n\t\t\t_this._resizer = _this._setResizer();\n\n\t\t\t_this._positions = {\n\t\t\t\tx: getPageCoordinates(e).x,\n\t\t\t\ty: getPageCoordinates(e).y,\n\t\t\t\ttimestamp: Date.now()\n\t\t\t};\n\n\t\t\t_this.$domEvents.attach(document, \"mousemove\", _this._startOnMove);\n\t\t\t_this.$domEvents.attach(document, \"mouseup\", _this._cancelDND);\n\t\t};\n\t\t_this.$name = \"resizer\";\n\t\treturn _this;\n\t}\n\tResizerCell.prototype.init = function () {\n\t\tvar _this = this;\n\t\t_super.prototype.init.call(this);\n\t\tthis._xMode = this.$config.mode === \"x\";\n\t\tif (this._xMode && !this.$config.width) {\n\t\t\tthis.$config.width = this.$config.minWidth = 1;\n\t\t}\n\t\telse if (!this._xMode && !this.$config.height) {\n\t\t\tthis.$config.height = this.$config.minHeight = 1;\n\t\t}\n\n\t\tthis.$config.margin = -1;\n\n\t\tthis.$domEvents.attach(this.$view, \"mousedown\", _this._downHandler);\n\n\t\tthis.$domEvents.attach(this.$view, \"touchstart\", _this._downHandler);\n\t\tthis.$domEvents.attach(this.$view, \"touchmove\",  _this._startOnMove);\n\t\tthis.$domEvents.attach(this.$view, \"touchend\",  _this._upHandler);\n\t};\n\tResizerCell.prototype.$toHTML = function () {\n\t\tvar mode = this.$config.mode;\n\t\tvar css = this.$config.css || \"\";\n\t\treturn \"<div class='gantt_layout_cell gantt_resizer gantt_resizer_\"+mode+\"'><div class='gantt_layout_content gantt_resizer_\" + mode + (css ? (\" \" + css) : \"\") + \"'></div></div>\";\n\t};\n\n\tResizerCell.prototype._clearResizer = function(){\n\t\tif(this._resizer){\n\t\t\tif(this._resizer.parentNode){\n\t\t\t\tthis._resizer.parentNode.removeChild(this._resizer);\n\t\t\t}\n\t\t\tthis._resizer = null;\n\t\t}\n\t};\n\n\tResizerCell.prototype._isPosChanged = function(e){\n\t\tif(!this._positions){\n\t\t\treturn false;\n\t\t}\n\n\t\tif(Math.abs(this._positions.x - e.pageX) > 3 || Math.abs(this._positions.y - e.pageY) > 3){\n\t\t\treturn true;\n\t\t}\n\n\t\tif(Date.now() - this._positions.timestamp > 300){\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t};\n\n\tResizerCell.prototype._getSiblings = function () {\n\t\tvar cells = this.$parent.getCells();\n\n\t\tif(this.$config.prev){\n\t\t\tthis._behind = this.$factory.getView(this.$config.prev);\n\t\t\tif(!(this._behind instanceof Cell)){\n\t\t\t\tthis._behind = this._behind.$parent;\n\t\t\t}\n\t\t}\n\t\tif(this.$config.next){\n\t\t\tthis._front = this.$factory.getView(this.$config.next);\n\t\t\tif(!(this._front instanceof Cell)){\n\t\t\t\tthis._front = this._behind.$parent;\n\t\t\t}\n\t\t}\n\n\t\tfor (var i = 0; i < cells.length; i++) {\n\t\t\tif (this === cells[i]) {\n\t\t\t\tif(!this._behind)\n\t\t\t\t\tthis._behind = cells[i - 1];\n\t\t\t\tif(!this._front)\n\t\t\t\t\tthis._front = cells[i + 1];\n\t\t\t}\n\t\t}\n\t};\n\tResizerCell.prototype._setBackground = function (state) {\n\t\tvar classes = \"gantt_resizing\";\n\t\tif (!state) {\n\t\t\tdomHelpers.removeClassName(this._behind.$view, classes);\n\t\t\tdomHelpers.removeClassName(this._front.$view, classes);\n\t\t\tdocument.body.classList.remove(\"gantt_noselect\");\n\t\t\treturn;\n\t\t}\n\t\tdomHelpers.addClassName(this._behind.$view, classes, true);\n\t\tdomHelpers.addClassName(this._front.$view, classes, true);\n\t\tdocument.body.classList.add(\"gantt_noselect\");\n\t};\n\tResizerCell.prototype._setResizer = function () {\n\t\tvar resizer = document.createElement(\"div\");\n\t\tresizer.className = \"gantt_resizer_stick\";\n\t\tthis.$view.appendChild(resizer);\n\t\tthis.$view.style.overflow = \"visible\";\n\t\tresizer.style.height = this.$view.style.height;\n\t\treturn resizer;\n\t};\n\n\tResizerCell.prototype._getDirection = function(x, y){\n\t\tvar shift;\n\t\tif (this._xMode) {\n\t\t\tshift = x - this._positions.x;\n\t\t}else{\n\t\t\tshift = y - this._positions.y;\n\t\t}\n\t\treturn shift ? shift < 0 ? -1 : 1 : 0;\n\t};\n\n\tResizerCell.prototype._getResizePosition = function(x, y){\n\t\tvar size;\n\t\tvar behindSide;\n\t\tvar behindMin;\n\t\tvar frontSide;\n\t\tvar frontMin;\n\t\tif (this._xMode) {\n\t\t\tsize = x - this._positions.x;\n\t\t\tbehindSide = this._behind.$config.width || this._behind.$view.offsetWidth;\n\t\t\tfrontSide = this._front.$config.width || this._front.$view.offsetWidth;\n\t\t\tbehindMin = this._behind.$config.minWidth;\n\t\t\tfrontMin = this._front.$config.minWidth;\n\t\t}\n\t\telse {\n\t\t\tsize = y - this._positions.y;\n\t\t\tbehindSide = this._behind.$config.height || this._behind.$view.offsetHeight;\n\t\t\tfrontSide = this._front.$config.height || this._front.$view.offsetHeight;\n\t\t\tbehindMin = this._front.$config.minHeight;\n\t\t\tfrontMin = this._front.$config.minHeight;\n\t\t}\n\t\tvar direction = this._getDirection(x, y);\n\t\tvar newBehindSide,\n\t\t\tnewFrontSide;\n\n\t\tif (direction === -1) {\n\t\t\tnewFrontSide = frontSide - size;\n\t\t\tnewBehindSide = behindSide - Math.abs(size);\n\n\t\t\tif (frontSide - size > this._front.$config.maxWidth) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (Math.abs(size) >= behindSide) {\n\t\t\t\tsize = -Math.abs(behindSide - 2);\n\t\t\t}\n\t\t\t// if min width\n\t\t\tif (behindSide - Math.abs(size) <= behindMin) {\n\t\t\t\t//this._resizer.style.background = \"red\";\n\t\t\t\tsize = -Math.abs(behindSide - behindMin);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tnewFrontSide = frontSide - Math.abs(size);\n\t\t\tnewBehindSide = behindSide + size;\n\n\t\t\tif (behindSide + size > this._behind.$config.maxWidth) {\n\t\t\t\tsize = this._behind.$config.maxWidth - behindSide;\n\t\t\t\t// return;\n\t\t\t}\n\t\t\tif (Math.abs(size) >= frontSide) {\n\t\t\t\tsize = frontSide - 2;\n\t\t\t}\n\t\t\t// if min width\n\t\t\tif (frontSide - Math.abs(size) <= frontMin) {\n\t\t\t\tsize = Math.abs(frontSide - frontMin);\n\t\t\t}\n\t\t}\n\n\t\tif (direction === -1) {\n\t\t\tnewFrontSide = frontSide - size;\n\t\t\tnewBehindSide = behindSide - Math.abs(size);\n\t\t} else {\n\t\t\tnewFrontSide = frontSide - Math.abs(size);\n\t\t\tnewBehindSide = behindSide + size;\n\t\t}\n\n\t\treturn {\n\t\t\tsize: size,\n\t\t\tnewFrontSide: newFrontSide,\n\t\t\tnewBehindSide: newBehindSide\n\t\t};\n\t};\n\n\tResizerCell.prototype._getGroupName = function(){\n\t\tthis._getSiblings();\n\t\treturn this._front.$config.group || this._behind.$config.group;\n\t};\n\n\tResizerCell.prototype._eachGroupItem = function(callback, master){\n\t\tvar layout = this.$factory.getView(\"main\");\n\n\t\tvar group = this._getGroupName();\n\n\t\tvar resizers = layout.getCellsByType(\"resizer\");\n\t\tfor(var i = 0; i < resizers.length; i++) {\n\t\t\tif (resizers[i]._getGroupName() == group && resizers[i] != this) {\n\t\t\t\tcallback.call(master || this, resizers[i]);\n\t\t\t}\n\t\t}\n\t};\n\n\tResizerCell.prototype._getGroupResizePosition = function(x, y){\n\t\tvar sizes = this._getResizePosition(x, y);\n\n\t\tif(!this._getGroupName()){\n\t\t\treturn sizes;\n\t\t}\n\n\t\tvar positions = [sizes];\n\n\t\tthis._eachGroupItem(function(resizer){\n\t\t\tresizer._getSiblings();\n\t\t\tvar pos = utils.copy(this._positions);\n\t\t\tif(this._xMode){\n\t\t\t\tpos.x += (resizer._behind.$config.width - this._behind.$config.width);\n\t\t\t}else{\n\t\t\t\tpos.y += (resizer._behind.$config.height - this._behind.$config.height);\n\t\t\t}\n\t\t\tresizer._positions = pos;\n\t\t\tpositions.push(resizer._getResizePosition(x, y));\n\t\t});\n\n\t\tvar minMax;\n\t\tfor(var i =0; i < positions.length; i++){\n\t\t\tif(!positions[i]) return;\n\t\t\tif(minMax === undefined){\n\t\t\t\tminMax = positions[i];\n\t\t\t}else if(positions[i].newBehindSide > minMax.newBehindSide){\n\t\t\t\tminMax = positions[i];\n\t\t\t}\n\t\t}\n\n\t/*\tif(minMax != sizes){\n\t\t\tminMax.size = minMax.size;\n\t\t}*/\n\n\t\treturn minMax;\n\t};\n\n\tResizerCell.prototype._moveResizer = function (av, x, y) {\n\t\tif (x === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar sizes = this._getGroupResizePosition(x, y);\n\t\tif(!sizes)\n\t\t\treturn;\n\n\t\tif (Math.abs(sizes.size) === 1) {\n\t\t\treturn;\n\t\t}\n\t\tif (this._xMode) {\n\t\t\tav.style.left = sizes.size + 'px';\n\t\t\tthis._positions.nextX = sizes.size || 0;\n\t\t}\n\t\telse {\n\t\t\tav.style.top = sizes.size + 'px';\n\t\t\tthis._positions.nextY = sizes.size || 0;\n\t\t}\n\n\t\tthis.callEvent(\"onResize\", [sizes.newBehindSide, sizes.newFrontSide]);\n\t};\n\tResizerCell.prototype._setGravity = function (cell) {\n\t\tvar size = this._xMode ? \"offsetWidth\" : \"offsetHeight\";\n\t\tvar position = this._xMode ? this._positions.nextX : this._positions.nextY;\n\t\tvar frontSize = this._front.$view[size];\n\t\tvar behindSize = this._behind.$view[size];\n\t\tvar frontG = this._front.getSize().gravity;\n\t\tvar behindG = this._behind.getSize().gravity;\n\t\tvar newFrontG = (frontSize - position) / frontSize * frontG;\n\t\tvar newBehindG = (behindSize + position) / behindSize * behindG;\n\t\tif (cell !== \"front\") {\n\t\t\tthis._front.$config.gravity = newFrontG;\n\t\t}\n\t\tif (cell !== \"behind\") {\n\t\t\tthis._behind.$config.gravity = newBehindG;\n\t\t}\n\t};\n\n/*\tResizerCell.prototype.setSize = function(){\n\t\t_super.apply(this, arguments)\n\t};*/\n\n\tResizerCell.prototype._getNewSizes = function(){\n\t\tvar behindSize, frontSize, position;\n\n\t\tif(this._xMode){\n\t\t\tbehindSize = this._behind.$config.width;\n\t\t\tfrontSize = this._front.$config.width;\n\t\t\tposition = this._positions.nextX;\n\t\t}else{\n\t\t\tbehindSize = this._behind.$config.height;\n\t\t\tfrontSize = this._front.$config.height;\n\t\t\tposition = this._positions.nextY;\n\t\t}\n\n\t\tif(!frontSize && !behindSize){\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\tfront: frontSize ? ((frontSize - position) || 1) : 0,\n\t\t\tback: behindSize ? ((behindSize + position) || 1) : 0\n\t\t};\n\t};\n\n\tResizerCell.prototype._assignNewSizes = function(newSizes){\n\t\tthis._getSiblings();\n\t\tvar side = this._xMode ? 'width' : 'height';\n\n\t\t// if only gravity cells\n\t\tif (!newSizes) {\n\t\t\tthis._setGravity();\n\t\t}\n\t\telse {\n\t\t\tif (!newSizes.front) {\n\t\t\t\tthis._setGravity(\"behind\");\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._front.$config[side] = newSizes.front;\n\t\t\t}\n\t\t\tif (!newSizes.back) {\n\t\t\t\tthis._setGravity(\"front\");\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._behind.$config[side] = newSizes.back;\n\t\t\t}\n\t\t}\n\n\t};\n\n\tResizerCell.prototype._setSizes = function () {\n\t\tif (this._resizer) {\n\t\t\tthis.$view.removeChild(this._resizer);\n\t\t}\n\t\tvar newSizes = this._getNewSizes();\n\n\t\tif (this._positions.nextX || this._positions.nextY) {\n\t\t\tthis._assignNewSizes(newSizes);\n\n\t\t\tvar side = this._xMode ? 'width' : 'height';\n\t\t\tvar resizeValue;\n\t\t\tif(!newSizes || !newSizes.front){\n\t\t\t\tif(this._front.$config.group){\n\t\t\t\t\tresizeValue = {\n\t\t\t\t\t\tvalue: this._front.$config.gravity,\n\t\t\t\t\t\tisGravity: true\n\t\t\t\t\t};\n\t\t\t\t\tthis.$gantt.$layout._syncCellSizes(this._front.$config.group, resizeValue);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!newSizes || !newSizes.back){\n\t\t\t\tif(this._behind.$config.group){\n\t\t\t\t\tresizeValue = {\n\t\t\t\t\t\tvalue: this._behind.$config.gravity,\n\t\t\t\t\t\tisGravity: true\n\t\t\t\t\t};\n\t\t\t\t\tthis.$gantt.$layout._syncCellSizes(this._behind.$config.group, resizeValue);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(newSizes){\n\t\t\t\tif(newSizes.front){\n\t\t\t\t\tif(this._front.$config.group){\n\t\t\t\t\t\tresizeValue = {\n\t\t\t\t\t\t\tvalue: this._front.$config[side],\n\t\t\t\t\t\t\tisGravity: false\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis.$gantt.$layout._syncCellSizes(this._front.$config.group, resizeValue);\n\t\t\t\t\t}\n\t\t\t\t} else if(newSizes.back){\n\t\t\t\t\tif(this._behind.$config.group){\n\t\t\t\t\t\tresizeValue = {\n\t\t\t\t\t\t\tvalue: this._behind.$config[side],\n\t\t\t\t\t\t\tisGravity: false\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis.$gantt.$layout._syncCellSizes(this._behind.$config.group, resizeValue);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(this._getGroupName()){\n\t\t\t\tthis.$factory.getView(\"main\").resize();\n\t\t\t}else{\n\t\t\t\tthis.$parent.resize();\n\t\t\t}\n\n\t\t}\n\t};\n\treturn ResizerCell;\n}(Cell));\n\nexport default ResizerCell;","import __extends from \"../../../utils/extends\";\nimport * as domHelpers from \"../utils/dom_helpers\";\nimport * as utils from \"../../../utils/utils\";\nimport env from \"../../../utils/env\";\nimport Cell from \"./cell\";\n\nvar ScrollbarCell = (function (_super) {\n\t\"use strict\";\n\n\tvar SCROLL_MODIFIER_KEYS = [\"altKey\", \"shiftKey\", \"metaKey\"]; // it's no way to disable ctrl+wheel\n\t__extends(ScrollbarCell, _super);\n\tfunction ScrollbarCell(parent, config, factory, gantt) {\n\n\t\tvar _this = _super.apply(this, arguments) || this;\n\t\tthis.$config = utils.mixin(config, {scroll: \"x\"});\n\t\t_this._scrollHorizontalHandler = utils.bind(_this._scrollHorizontalHandler, _this);\n\t\t_this._scrollVerticalHandler = utils.bind(_this._scrollVerticalHandler, _this);\n\t\t_this._outerScrollVerticalHandler = utils.bind(_this._outerScrollVerticalHandler, _this);\n\t\t_this._outerScrollHorizontalHandler = utils.bind(_this._outerScrollHorizontalHandler, _this);\n\t\t_this._mouseWheelHandler = utils.bind(_this._mouseWheelHandler, _this);\n\n\t\tthis.$config.hidden = true;\n\t\tvar size = gantt.config.scroll_size;\n\n\t\tif(gantt.env.isIE){\n\t\t\t// full element height/width must be bigger than just a browser scrollbar,\n\t\t\t// otherwise the scrollbar element won't be scrolled on click\n\t\t\tsize += 1;\n\t\t}\n\n\t\tif(this._isHorizontal()){\n\t\t\t_this.$config.height = size;\n\t\t\t_this.$parent.$config.height = size;\n\t\t}else{\n\t\t\t_this.$config.width = size;\n\t\t\t_this.$parent.$config.width = size;\n\t\t}\n\n\t\tthis.$config.scrollPosition = 0;\n\n\t\t_this.$name = \"scroller\";\n\t\treturn _this;\n\t}\n\n\tScrollbarCell.prototype.init = function(container){\n\t\tcontainer.innerHTML = this.$toHTML();\n\t\tthis.$view = container.firstChild;\n\n\t\tif(!this.$view){\n\t\t\tthis.init();\n\t\t}\n\t\tif(this._isVertical()){\n\t\t\tthis._initVertical();\n\t\t}else{\n\t\t\tthis._initHorizontal();\n\t\t}\n\t\tthis._initMouseWheel();\n\t\tthis._initLinkedViews();\n\t};\n\n\tScrollbarCell.prototype.$toHTML = function () {\n\t\tvar className = this._isHorizontal() ? \"gantt_hor_scroll\" : \"gantt_ver_scroll\";\n\t\treturn \"<div class='gantt_layout_cell \"+className+\"'><div style='\"+(this._isHorizontal() ? \"width:2000px\" : \"height:2000px\")+\"'></div></div>\";\n\t};\n\n\tScrollbarCell.prototype._getRootParent = function(){\n\t\tvar parent = this.$parent;\n\t\twhile(parent && parent.$parent){\n\t\t\tparent = parent.$parent;\n\t\t}\n\t\tif(parent){\n\t\t\treturn parent;\n\t\t}\n\t};\n\n\n\tfunction eachCell(root, res){\n\t\tres.push(root);\n\t\tif(root.$cells){\n\t\t\tfor(var i = 0; i < root.$cells.length; i++){\n\t\t\t\teachCell(root.$cells[i], res);\n\t\t\t}\n\t\t}\n\t}\n\tScrollbarCell.prototype._eachView = function(){\n\t\tvar res = [];\n\t\teachCell(this._getRootParent(), res);\n\t\treturn res;\n\t};\n\n\tScrollbarCell.prototype._getLinkedViews = function(){\n\t\tvar views = this._eachView();\n\t\tvar res = [];\n\t\tfor(var i = 0; i < views.length; i++){\n\t\t\tif(views[i].$config && ((this._isVertical() && views[i].$config.scrollY == this.$id) || (this._isHorizontal() && views[i].$config.scrollX == this.$id)) ){\n\t\t\t\tres.push(views[i]);\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t};\n\n\n\tScrollbarCell.prototype._initHorizontal = function(){\n\t\tthis.$scroll_hor = this.$view;\n\t\tthis.$domEvents.attach(this.$view, \"scroll\", this._scrollHorizontalHandler);\n\n\t};\n\n\tScrollbarCell.prototype._initLinkedViews = function(){\n\t\tvar views = this._getLinkedViews();\n\t\tvar css = this._isVertical() ?\"gantt_layout_outer_scroll gantt_layout_outer_scroll_vertical\" : \"gantt_layout_outer_scroll gantt_layout_outer_scroll_horizontal\";\n\t\tfor(var i = 0; i < views.length; i++){\n\t\t\t//views[i].$config.css = [views[i].$config.css || \"\", css].join(\" \");\n\t\t\tdomHelpers.addClassName(views[i].$view || views[i].getNode(), css);\n\t\t}\n\t};\n\n\tScrollbarCell.prototype._initVertical = function(){\n\t\tthis.$scroll_ver = this.$view;\n\t\tthis.$domEvents.attach(this.$view, \"scroll\", this._scrollVerticalHandler);\n\t};\n\n\tScrollbarCell.prototype._updateLinkedViews = function(){\n\t};\n\n\tScrollbarCell.prototype._initMouseWheel = function(){\n\t\tvar ff = env.isFF;\n\t\tif (ff)\n\t\t\tthis.$domEvents.attach(this._getRootParent().$view, \"wheel\", this._mouseWheelHandler, {passive: false});\n\t\telse\n\t\t\tthis.$domEvents.attach(this._getRootParent().$view, \"mousewheel\", this._mouseWheelHandler, {passive: false});\n\t};\n\n\n\n\n\tScrollbarCell.prototype.scrollHorizontally = function(left){\n\t\tif(this._scrolling) return;\n\t\tthis._scrolling = true;\n\n\t\tthis.$scroll_hor.scrollLeft = left;\n\t\tthis.$config.codeScrollLeft = left;\n\t\tleft = this.$scroll_hor.scrollLeft;\n\n\t\tvar views = this._getLinkedViews();\n\t\tfor(var i = 0; i < views.length; i++){\n\t\t\tif(views[i].scrollTo){\n\t\t\t\tviews[i].scrollTo(left, undefined);\n\t\t\t}\n\t\t}\n\t\tvar oldSize = this.$config.scrollPosition;\n\t\tthis.$config.scrollPosition = left;\n\t\tthis.callEvent(\"onScroll\", [oldSize, left, this.$config.scroll]);\n\t\tthis._scrolling = false;\n\t};\n\tScrollbarCell.prototype.scrollVertically = function(top){\n\t\tif(this._scrolling) return;\n\t\tthis._scrolling = true;\n\n\t\tthis.$scroll_ver.scrollTop = top;\n\t\ttop = this.$scroll_ver.scrollTop;\n\n\t\tvar views = this._getLinkedViews();\n\n\t\tfor(var i = 0; i < views.length; i++){\n\t\t\tif(views[i].scrollTo){\n\t\t\t\tviews[i].scrollTo(undefined, top);\n\t\t\t}\n\t\t}\n\t\tvar oldSize = this.$config.scrollPosition;\n\t\tthis.$config.scrollPosition = top;\n\t\tthis.callEvent(\"onScroll\", [oldSize, top, this.$config.scroll]);\n\t\tthis._scrolling = false;\n\t};\n\n\tScrollbarCell.prototype._isVertical = function(){\n\t\treturn this.$config.scroll == \"y\";\n\t};\n\tScrollbarCell.prototype._isHorizontal = function(){\n\t\treturn this.$config.scroll == \"x\";\n\t};\n\tScrollbarCell.prototype._scrollHorizontalHandler = function (e) {\n\t\tif(this._isVertical() || this._scrolling){\n\t\t\treturn;\n\t\t}\n\n\t\t//in safari we can catch previous onscroll after setting new value from mouse-wheel event\n\t\t//set delay to prevent value drifiting\n\t\tif ((new Date()) - ( this._wheel_time || 0 ) < 100) return true;\n\t\t//if (this.$gantt._touch_scroll_active) return;\n\t\tvar left = this.$scroll_hor.scrollLeft;\n\n\t\tthis.scrollHorizontally(left);\n\n\t\tthis._oldLeft = this.$scroll_hor.scrollLeft;\n\t};\n\tScrollbarCell.prototype._outerScrollHorizontalHandler = function(e){\n\t\tif(this._isVertical()){\n\t\t\treturn;\n\t\t}\n\t};\n\n\tScrollbarCell.prototype.show = function(){\n\t\tthis.$parent.show();\n\t};\n\tScrollbarCell.prototype.hide = function(){\n\t\tthis.$parent.hide();\n\t};\n\n\tScrollbarCell.prototype._getScrollSize = function(){\n\t\tvar scrollSize = 0;\n\t\tvar outerSize = 0;\n\t\tvar isHorizontal = this._isHorizontal();\n\n\t\tvar linked = this._getLinkedViews();\n\t\tvar view;\n\t\tvar scrollProperty = isHorizontal ? \"scrollWidth\" : \"scrollHeight\",\n\t\t\tinnerSizeProperty = isHorizontal ? \"contentX\" : \"contentY\";\n\t\tvar outerProperty = isHorizontal ? \"x\" : \"y\";\n\t\tvar offset = this._getScrollOffset();\n\n\t\tfor(var i = 0; i < linked.length; i++){\n\t\t\tview = linked[i];\n\t\t\tif(!(view && view.$content && view.$content.getSize && !view.$config.hidden)) continue;\n\n\t\t\tvar sizes = view.$content.getSize();\n\t\t\tvar cellScrollSize;\n\t\t\tif(sizes.hasOwnProperty(scrollProperty)){\n\t\t\t\tcellScrollSize = sizes[scrollProperty];\n\t\t\t}else{\n\t\t\t\tcellScrollSize = sizes[innerSizeProperty];\n\t\t\t}\n\n\t\t\tif(offset){\n\t\t\t\t// precalculated vertical/horizontal offsets of scrollbar to emulate 4.x look\n\t\t\t\tif(sizes[innerSizeProperty] > sizes[outerProperty] && sizes[innerSizeProperty] > scrollSize && (cellScrollSize > (sizes[outerProperty] - offset + 2))){\n\t\t\t\t\tscrollSize = cellScrollSize + (isHorizontal ? 0 : 2);\n\t\t\t\t\touterSize = sizes[outerProperty];\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tvar nonScrollableSize = Math.max(sizes[innerSizeProperty] - cellScrollSize, 0);\n\t\t\t\tvar scrollableViewPortSize = Math.max(sizes[outerProperty] - nonScrollableSize, 0);\n\t\t\t\tcellScrollSize = cellScrollSize + nonScrollableSize;\n\n\t\t\t\tif(cellScrollSize > scrollableViewPortSize && (cellScrollSize > scrollSize) ){\n\t\t\t\t\t//|| (cellScrollSize === scrollSize && sizes[outerProperty] < outerSize) // same scroll width but smaller scrollable view port\n\n\t\t\t\t\tscrollSize = cellScrollSize;\n\t\t\t\t\touterSize = sizes[outerProperty];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\touterScroll: outerSize,\n\t\t\tinnerScroll: scrollSize\n\t\t};\n\t};\n\n\tScrollbarCell.prototype.scroll = function(position){\n\t\tif(this._isHorizontal()){\n\t\t\tthis.scrollHorizontally(position);\n\t\t}else{\n\t\t\tthis.scrollVertically(position);\n\t\t}\n\t};\n\n\tScrollbarCell.prototype.getScrollState = function(){\n\t\treturn {\n\t\t\tvisible: this.isVisible(),\n\t\t\tdirection: this.$config.scroll,\n\t\t\tsize: this.$config.outerSize,\n\t\t\tscrollSize: this.$config.scrollSize || 0,\n\t\t\tposition: this.$config.scrollPosition || 0\n\t\t};\n\t};\n\n\tScrollbarCell.prototype.setSize = function(width, height){\n\t\t_super.prototype.setSize.apply(this, arguments);\n\n\t\tvar scrollSizes = this._getScrollSize();\n\n\t\tvar ownSize = (this._isVertical() ? height : width) - this._getScrollOffset() + (this._isHorizontal() ? 1 : 0);\n\n\t\tif(scrollSizes.innerScroll && ownSize > scrollSizes.outerScroll){\n\t\t\tscrollSizes.innerScroll += (ownSize - scrollSizes.outerScroll);\n\t\t}\n\t\tthis.$config.scrollSize = scrollSizes.innerScroll;\n\n\t\tthis.$config.width = width;\n\t\tthis.$config.height = height;\n\t\tthis._setScrollSize(scrollSizes.innerScroll);\n\t};\n\n\tScrollbarCell.prototype.isVisible = function(){\n\t\treturn !!(this.$parent && this.$parent.$view.parentNode);\n\t};\n\n\tScrollbarCell.prototype.shouldShow = function(){\n\t\tvar scrollSizes = this._getScrollSize();\n\t\tif(!scrollSizes.innerScroll && (this.$parent && this.$parent.$view.parentNode)){\n\t\t\treturn false;\n\t\t}else if(scrollSizes.innerScroll && !(this.$parent && this.$parent.$view.parentNode)){\n\t\t\treturn true;\n\t\t}else{\n\t\t\treturn false;\n\t\t}\n\t};\n\n\tScrollbarCell.prototype.shouldHide = function(){\n\t\tvar scrollSizes = this._getScrollSize();\n\t\tif(!scrollSizes.innerScroll && (this.$parent && this.$parent.$view.parentNode)){\n\t\t\treturn true;\n\t\t}else{\n\t\t\treturn false;\n\t\t}\n\t};\n\n\n\tScrollbarCell.prototype.toggleVisibility = function(){\n\t\tif(this.shouldHide()){\n\t\t\tthis.hide();\n\t\t}else if(this.shouldShow()){\n\t\t\tthis.show();\n\t\t}\n\t};\n\n\tScrollbarCell.prototype._getScaleOffset = function(view){\n\t\tvar offset = 0;\n\t\tif(view && (view.$config.view == \"timeline\" || view.$config.view == \"grid\")){\n\t\t\toffset = view.$content.$getConfig().scale_height;\n\t\t}\n\t\treturn offset;\n\t};\n\n\tScrollbarCell.prototype._getScrollOffset = function(){\n\t\tvar offset = 0;\n\t\tif(this._isVertical()){\n\t\t\tvar parentLayout = this.$parent.$parent;\n\t\t\toffset = Math.max(\n\t\t\t\tthis._getScaleOffset(parentLayout.getPrevSibling(this.$parent.$id)),\n\t\t\t\tthis._getScaleOffset(parentLayout.getNextSibling(this.$parent.$id))\n\t\t\t\t);\n\t\t}else{\n\t\t\tvar linked = this._getLinkedViews();\n\n\t\t\tfor (var i = 0; i < linked.length; i++) {\n\t\t\t\tvar view = linked[i],\n\t\t\t\t\tvparent = view.$parent;\n\t\t\t\tvar cells = vparent.$cells;\n\n\t\t\t\tvar last = cells[cells.length - 1];\n\n\t\t\t\tif (last && last.$config.view == \"scrollbar\" && last.$config.hidden === false) {\n\t\t\t\t\toffset = last.$config.width;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t\treturn offset || 0;\n\t};\n\n\tScrollbarCell.prototype._setScrollSize = function(size){\n\t\tvar property = this._isHorizontal() ? \"width\" : \"height\";\n\t\tvar scrollbar = this._isHorizontal() ? this.$scroll_hor : this.$scroll_ver;\n\n\t\tvar offset = this._getScrollOffset();\n\n\t\tvar node = scrollbar.firstChild;\n\n\t\tif(offset){\n\t\t\tif(this._isVertical()){\n\n\t\t\t\tthis.$config.outerSize = (this.$config.height - offset + 3);\n\t\t\t\tscrollbar.style.height = this.$config.outerSize + \"px\";\n\t\t\t\tscrollbar.style.top = (offset-1) + \"px\";\n\t\t\t\tdomHelpers.addClassName(scrollbar, this.$parent._borders.top);\n\t\t\t\tdomHelpers.addClassName(scrollbar.parentNode, \"gantt_task_vscroll\");\n\t\t\t}else{\n\t\t\t\tthis.$config.outerSize = (this.$config.width - offset + 1);\n\t\t\t\tscrollbar.style.width = this.$config.outerSize + \"px\";\n\t\t\t\t//domHelpers.addClassName(scrollbar, this.$parent._borders.right);\n\t\t\t}\n\t\t}else{\n\t\t\tscrollbar.style.top = \"auto\";\n\t\t\tdomHelpers.removeClassName(scrollbar, this.$parent._borders.top);\n\t\t\tdomHelpers.removeClassName(scrollbar.parentNode, \"gantt_task_vscroll\");\n\t\t\tthis.$config.outerSize = this.$config.height;\n\t\t}\n\n\t\tnode.style[property] = size + \"px\";\n\t};\n\n\tScrollbarCell.prototype._scrollVerticalHandler = function (e) {\n\t\tif(this._scrollHorizontalHandler() || this._scrolling){\n\t\t\treturn;\n\t\t}\n\n\t\t//if (this.$gantt._touch_scroll_active) return;\n\t\tvar top = this.$scroll_ver.scrollTop;\n\t\tvar prev = this._oldTop;\n\t\tif(top == prev) return;\n\n\t\tthis.scrollVertically(top);\n\n\t\tthis._oldTop = this.$scroll_ver.scrollTop;\n\n\t};\n\tScrollbarCell.prototype._outerScrollVerticalHandler = function(e){\n\t\tif(this._scrollHorizontalHandler()){\n\t\t\treturn;\n\t\t}\n\t};\n\n\tScrollbarCell.prototype._checkWheelTarget = function(targetNode){\n\t\tvar connectedViews = this._getLinkedViews().concat(this);\n\n\t\tfor(var i = 0; i < connectedViews.length; i++){\n\t\t\tvar node = connectedViews[i].$view;\n\t\t\tif(domHelpers.isChildOf(targetNode, node)){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t};\n\n\tScrollbarCell.prototype._mouseWheelHandler = function(e){\n\t\tvar target = e.target || e.srcElement;\n\n\t\tif(!this._checkWheelTarget(target))\n\t\t\treturn;\n\n\t\tthis._wheel_time = new Date();\n\n\t\tvar res = {};\n\n\t\tvar wheelSpeed = {x: 1, y: 1};\n\t\tvar wheelSpeedConfig = this.$gantt.config.wheel_scroll_sensitivity;\n\n\t\tif (typeof wheelSpeedConfig == \"number\" && !!wheelSpeedConfig) {\n\t\t\twheelSpeed = {x: wheelSpeedConfig, y: wheelSpeedConfig};\n\t\t}\n\t\telse if (({}).toString.apply(wheelSpeedConfig) == \"[object Object]\") {\n\t\t\twheelSpeed = {x: wheelSpeedConfig.x, y: wheelSpeedConfig.y};\n\t\t}\n\n\t\tvar ff = env.isFF;\n\t\tvar deltaX = ff ? (e.deltaX) : e.wheelDeltaX;\n\t\tvar deltaY = ff ? (e.deltaY) : e.wheelDelta;\n\n\t\tvar multiplier = -20;\n\t\tif (ff) {\n\t\t\t// GS-1500. Firefox had many changes during the versions\n\t\t\tconst version = parseInt(navigator.userAgent.split(\"Firefox/\")[1]);\n\t\t\tif (version <= 87){\n\t\t\t\tif (e.deltaMode !== 0) {\n\t\t\t\t\tmultiplier = -40;\n\t\t\t\t} else {\n\t\t\t\t\tmultiplier = -10;\n\t\t\t\t}\n\t\t\t} else if (version <= 90){\n\t\t\t\tmultiplier = -3;\n\t\t\t} else if (version <= 96){\n\t\t\t\tmultiplier = -1.5;\n\t\t\t} else {\n\t\t\t\tmultiplier = -1;\n\t\t\t}\n\t\t}\n\n\t\tvar wx = ff ? (deltaX * multiplier * wheelSpeed.x) : deltaX * 2 * wheelSpeed.x;\n\t\tvar wy = ff ? (deltaY * multiplier * wheelSpeed.y) : deltaY * wheelSpeed.y;\n\n\t\tvar horizontalScrollModifier = this.$gantt.config.horizontal_scroll_key;\n\n\t\tif (horizontalScrollModifier !== false) {\n\t\t\tif (SCROLL_MODIFIER_KEYS.indexOf(horizontalScrollModifier) >= 0) {\n\t\t\t\tif(e[horizontalScrollModifier] && !(e.deltaX || e.wheelDeltaX)){\n\t\t\t\t\t// shift+mousewheel for horizontal scroll\n\t\t\t\t\twx = wy*2;\n\t\t\t\t\twy = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\n\t\tif (wx && Math.abs(wx) > Math.abs(wy)){\n\t\t\tif(this._isVertical()){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif(res.x) return true;//no horisontal scroll, must not block scrolling\n\t\t\tif(!this.$scroll_hor || !this.$scroll_hor.offsetWidth) return true;\n\n\t\t\tvar dir  = wx/-40;\n\t\t\tvar oldLeft = this._oldLeft;\n\t\t\tvar left = oldLeft+dir*30;\n\t\t\tthis.scrollHorizontally(left);\n\t\t\tthis.$scroll_hor.scrollLeft = left;\n\t\t\t// not block scroll if position hasn't changed\n\t\t\tif(oldLeft == this.$scroll_hor.scrollLeft){\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis._oldLeft = this.$scroll_hor.scrollLeft;\n\t\t} else {\n\t\t\tif(this._isHorizontal()){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif(res.y) return true;//no vertical scroll, must not block scrolling\n\t\t\tif(!this.$scroll_ver || !this.$scroll_ver.offsetHeight) return true;\n\n\t\t\tvar dir  = wy/-40;\n\t\t\tif (typeof wy == \"undefined\")\n\t\t\t\tdir = e.detail;\n\n\t\t\tvar oldTop = this._oldTop;\n\t\t\tvar top = this.$scroll_ver.scrollTop+dir*30;\n\n\t\t\t//if(!this.$gantt.config.prevent_default_scroll &&\n\t\t\t//\t(this.$gantt._cached_scroll_pos && ((this.$gantt._cached_scroll_pos.y == top) || (this.$gantt._cached_scroll_pos.y <= 0 && top <= 0)))) return true;\n\n\n\t\t\tthis.scrollVertically(top);\n\t\t\tthis.$scroll_ver.scrollTop = top;\n\n\t\t\t// not block scroll if position hasn't changed\n\t\t\tif(oldTop == this.$scroll_ver.scrollTop){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tthis._oldTop = this.$scroll_ver.scrollTop;\n\t\t}\n\n\t\tif (e.preventDefault)\n\t\t\te.preventDefault();\n\t\te.cancelBubble=true;\n\t\treturn false;\n\t};\n\n\treturn ScrollbarCell;\n})(Cell);\n\nexport default ScrollbarCell;","import * as utils from \"../../../utils/utils\";\nimport env from \"../../../utils/env\";\n\nvar createStaticBgHelper = function(utils, env){\n\n\tvar canvasBgCache = {};\n\tvar staticBgStyleId = \"gantt-static-bg-styles-\" + utils.uid();\n\n\tfunction renderBgCanvas(targetNode, config, scale, totalHeight, itemHeight) {\n\t\tif (!config.static_background && !config.timeline_placeholder) return;\n\n\t\tvar canvas = document.createElement(\"canvas\");\n\t\tif (!canvas.getContext) return; // if canvas is not supported (for IE8)\n\n\t\t// clear previous bg data\n\t\ttargetNode.innerHTML = \"\";\n\n\t\tvar styleParams = getCellStyles(targetNode);\n\t\tvar png = createBackgroundTiles(styleParams, config, scale, itemHeight);\n\t\tvar bgDivs = createBgDivs(png, config, scale, totalHeight);\n\n\t\tvar fragment = document.createDocumentFragment();\n\n\t\tbgDivs.forEach(function (div) {\n\t\t\tfragment.appendChild(div);\n\t\t});\n\n\t\ttargetNode.appendChild(fragment);\n\t}\n\n\tfunction getColumnWidths(scale) {\n\t\tvar widths = scale.width;\n\t\tvar differentWidths = {};\n\t\tfor (var i = 0; i < widths.length; i++) {\n\t\t\tif (widths[i] * 1)\n\t\t\t\tdifferentWidths[widths[i]] = true;\n\t\t}\n\t\treturn differentWidths;\n\t}\n\n\tfunction parseRgb(rgbCss) {\n\t\tvar result = /^rgba?\\(([\\d]{1,3}), *([\\d]{1,3}), *([\\d]{1,3}) *(,( *[\\d.]+ *))?\\)$/i.exec(rgbCss);\n\t\treturn result ? {\n\t\t\tr: result[1] * 1,\n\t\t\tg: result[2] * 1,\n\t\t\tb: result[3] * 1,\n\t\t\ta: (result[5] * 255) || 255\n\t\t} : null;\n\t}\n\n\tfunction getUrlFromCache(key) {\n\t\treturn canvasBgCache[key] || null;\n\t}\n\n\tfunction getHashKey(width, height, cellStyles) {\n\t\treturn (width + '' + height + cellStyles.bottomBorderColor + cellStyles.rightBorderColor).replace(/[^\\w\\d]/g, '');\n\t}\n\n\tfunction getStyleElement() {\n\t\tvar style = document.getElementById(staticBgStyleId);\n\n\t\tif (!style) {\n\t\t\tstyle = document.createElement(\"style\");\n\t\t\tstyle.id = staticBgStyleId;\n\t\t\tdocument.body.appendChild(style);\n\t\t}\n\t\treturn style;\n\t}\n\n\tfunction cleanup() {\n\t\tvar style = document.getElementById(staticBgStyleId);\n\t\tif (style && style.parentNode) {\n\t\t\tstyle.parentNode.removeChild(style);\n\t\t}\n\t}\n\n\tfunction cacheUrl(key, url) {\n\t\tcanvasBgCache[key] = url;\n\t}\n\n\tfunction generateBgUrl(width, height, cellStyles) {\n\t\t// use relatively big bg image about 500*500px in order to reduce misalignments due browser zoom\n\t\tvar cols = Math.floor(500 / width) || 1;\n\t\tvar rows = Math.floor(500 / height) || 1;\n\n\t\tvar canvas = document.createElement(\"canvas\");\n\t\tcanvas.height = height * rows;\n\t\tcanvas.width = width * cols;\n\n\t\tvar context = canvas.getContext(\"2d\");\n\n\t\tdrawGrid(height, width, rows, cols, context, cellStyles);\n\n\t\treturn canvas.toDataURL();\n\n\t\tfunction drawGrid(rowHeight, colWidth, rows, cols, context, styles) {\n\t\t\t// paint pixels manually instead of using lineTo in order to prevent canvas aliasing\n\t\t\tvar image = context.createImageData(colWidth * cols, rowHeight * rows);\n\t\t\timage.imageSmoothingEnabled = false;\n\n\t\t\tvar verticalLineWidth = styles.rightBorderWidth * 1;\n\t\t\tvar verticalLineColor = parseRgb(styles.rightBorderColor);\n\n\t\t\tvar x = 0,\n\t\t\t\ty = 0,\n\t\t\t\tw = 0;\n\n\t\t\tfor (var col = 1; col <= cols; col++) {\n\t\t\t\tx = col * colWidth - 1;\n\t\t\t\tfor (w = 0; w < verticalLineWidth; w++) {\n\t\t\t\t\tfor (y = 0; y < rowHeight * rows; y++) {\n\t\t\t\t\t\tdrawDot(x - w, y, verticalLineColor, image);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar horizontalLineWidth = styles.bottomBorderWidth * 1;\n\t\t\tvar horizontalLineColor = parseRgb(styles.bottomBorderColor);\n\n\t\t\ty = 0;\n\t\t\tfor (var row = 1; row <= rows; row++) {\n\t\t\t\ty = row * rowHeight - 1;\n\t\t\t\tfor (w = 0; w < horizontalLineWidth; w++) {\n\t\t\t\t\tfor (x = 0; x < colWidth * cols; x++) {\n\t\t\t\t\t\tdrawDot(x, y - w, horizontalLineColor, image);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tcontext.putImageData(image, 0, 0);\n\t\t}\n\n\t\tfunction drawDot(x, y, color, matrix) {\n\t\t\tvar rowLength = width * cols;\n\n\t\t\tvar index = (y * rowLength + x) * 4;\n\n\t\t\tmatrix.data[index] = color.r;\n\t\t\tmatrix.data[index + 1] = color.g;\n\t\t\tmatrix.data[index + 2] = color.b;\n\t\t\tmatrix.data[index + 3] = color.a;\n\t\t}\n\t}\n\n\tfunction getCssClass(key) {\n\t\treturn \"gantt-static-bg-\" + key;\n\t}\n\n\tfunction createBackgroundTiles(cellStyles, config, scale, itemHeight) {\n\t\tvar data = {};\n\t\tvar widths = getColumnWidths(scale),\n\t\t\theight = itemHeight;\n\n\t\tvar styleHTML = \"\";\n\t\tfor (var i in widths) {\n\n\t\t\tvar width = i * 1;\n\t\t\tvar key = getHashKey(width, height, cellStyles);\n\t\t\tvar cachedUrl = getUrlFromCache(key);\n\n\t\t\tif (!cachedUrl) {\n\t\t\t\tvar bgImage = generateBgUrl(width, height, cellStyles);\n\t\t\t\tcacheUrl(key, bgImage);\n\t\t\t\tstyleHTML += \".\" + getCssClass(key) + \"{ background-image: url('\" + bgImage + \"');}\";\n\t\t\t}\n\n\t\t\tdata[i] = getCssClass(key);\n\t\t}\n\n\t\tif (styleHTML) {\n\t\t\tvar style = getStyleElement();\n\t\t\tstyle.innerHTML += styleHTML;\n\t\t}\n\n\t\treturn data;\n\t}\n\n\tfunction createBgDivs(bgTiles, config, scale, dataHeight) {\n\t\tvar divs = [];\n\t\tvar tile,\n\t\t\tprevWidth = 0,\n\t\t\tprevCell;\n\n\t\tvar widths = scale.width.filter(function (i) {\n\t\t\treturn !!i;\n\t\t});\n\n\t\tvar leftPos = 0;\n\n\t\t//TODO: fixme\n\t\t// bg image misalignments on horizontal scroll on very large time scales, especially in IE/Edge browsers\n\t\t// limiting max tile width seems to solve the issue, but can increase rendering time\n\t\tvar maxTileSize = 100000;\n\t\tif (env.isIE) {\n\t\t\t// special case for IE11 on win7x and probably 8x\n\t\t\tvar appVersion = navigator.appVersion || \"\";\n\t\t\tif (appVersion.indexOf(\"Windows NT 6.2\") != -1 ||\n\t\t\t\tappVersion.indexOf(\"Windows NT 6.1\") != -1 ||\n\t\t\t\tappVersion.indexOf(\"Windows NT 6.0\") != -1) {\n\n\t\t\t\tmaxTileSize = 20000;\n\t\t\t}\n\t\t}\n\n\t\tfor (var i = 0; i < widths.length; i++) {\n\t\t\t//var currentWidth = cells[i].clientWidth;\n\t\t\tvar cell = widths[i];\n\n\t\t\tif ((cell != prevCell && prevCell !== undefined) || (i == widths.length - 1) || (prevWidth > maxTileSize)) {\n\n\t\t\t\tvar totalHeight = dataHeight,\n\t\t\t\t\tcurrentTop = 0,\n\t\t\t\t\trowHeight = Math.floor(maxTileSize / config.row_height) * config.row_height;\n\n\t\t\t\tvar tileWidth = prevWidth;\n\n\t\t\t\twhile (totalHeight > 0) {\n\t\t\t\t\tvar currentHeight = Math.min(totalHeight, rowHeight);\n\t\t\t\t\ttotalHeight -= rowHeight;\n\n\t\t\t\t\ttile = document.createElement(\"div\");\n\n\t\t\t\t\ttile.style.height = currentHeight + \"px\";\n\t\t\t\t\ttile.style.position = \"absolute\";\n\t\t\t\t\ttile.style.top = currentTop + \"px\";\n\t\t\t\t\ttile.style.left = leftPos + \"px\";\n\t\t\t\t\ttile.style.pointerEvents = \"none\";\n\n\t\t\t\t\ttile.style.whiteSpace = \"no-wrap\";\n\t\t\t\t\ttile.className = bgTiles[prevCell || cell];\n\n\t\t\t\t\t// if last - short by 1 px (bug fix)\n\t\t\t\t\tif (i == widths.length - 1) {\n\t\t\t\t\t\ttileWidth = cell + tileWidth - 1;\n\t\t\t\t\t}\n\t\t\t\t\ttile.style.width = tileWidth + \"px\";\n\n\t\t\t\t\tdivs.push(tile);\n\t\t\t\t\tcurrentTop += currentHeight;\n\t\t\t\t}\n\t\t\t\tprevWidth = 0;\n\t\t\t\tleftPos += tileWidth;\n\n\t\t\t\t//cell = 0;\n\t\t\t}\n\t\t\tif (cell) {\n\t\t\t\tprevWidth += cell;\n\t\t\t\tprevCell = cell;\n\t\t\t}\n\n\t\t}\n\n\t\treturn divs;\n\t}\n\n\n\tfunction createProbeElement(){\n\t\tvar cell = document.createElement(\"div\");\n\t\tcell.className = \"gantt_task_cell\";\n\t\tvar row = document.createElement(\"div\");\n\t\trow.className = \"gantt_task_row\";\n\t\trow.appendChild(cell);\n\t\treturn row;\n\t}\n\tfunction getCellStyles(targetNode) {\n\t\t// creating temp DOM structure for resolving style parameters. Will be removed after calculating.\n\t\t// Add two rows and read styles from the first one. \n\t\t// Some skins (e.g. material) define special styles for the last row, so we add a couple and read styles from one which is not the :last-child;\n\t\tvar firstRow = createProbeElement();\n\t\tvar secondRow = createProbeElement();\n\n\t\ttargetNode.appendChild(firstRow);\n\t\ttargetNode.appendChild(secondRow);\n\n\t\tvar firstRowCell = firstRow.firstChild;\n\n\t\tvar rowStyles = getComputedStyle(firstRow),\n\t\t\tcellStyles = getComputedStyle(firstRowCell);\n\n\t\tvar params = {\n\t\t\tbottomBorderWidth: rowStyles.getPropertyValue(\"border-bottom-width\").replace(\"px\", \"\"),\n\t\t\trightBorderWidth: cellStyles.getPropertyValue(\"border-right-width\").replace(\"px\", \"\"),\n\t\t\tbottomBorderColor: rowStyles.getPropertyValue(\"border-bottom-color\"),\n\t\t\trightBorderColor: cellStyles.getPropertyValue(\"border-right-color\")\n\t\t};\n\n\t\ttargetNode.removeChild(firstRow);\n\t\ttargetNode.removeChild(secondRow);\n\n\t\treturn params;\n\t}\n\n\treturn {\n\t\trender: renderBgCanvas,\n\t\tdestroy: cleanup\n\t};\n};\n\nexport default {\n\tcreate: function(){\n\t\treturn createStaticBgHelper(utils, env);\n\t}\n};\n\n","import ScaleHelper from \"./scales_ignore\";\nimport eventable from \"../../../utils/eventable\";\nimport * as utils from \"../../../utils/utils\";\nimport * as helpers from \"../../../utils/helpers\";\nimport topPositionMixin from \"../row_position_mixin\";\nimport canvasRender from \"./tasks_canvas_render\";\nimport createLayerConfig from \"./timeline_layers\";\n\nvar Timeline = function(parent, config, factory, gantt){\n\tthis.$config = utils.mixin({}, config || {});\n\tthis.$scaleHelper = new ScaleHelper(gantt);\n\tthis.$gantt = gantt;\n\tthis._posFromDateCache = {};\n\tthis._posFromWorkTimeCache = {};\n\tthis._timelineDragScroll = null;\n\tutils.mixin(this, topPositionMixin(this));\n\teventable(this);\n};\n\nTimeline.prototype = {\n\tinit: function(container) {\n\t\tcontainer.innerHTML += \"<div class='gantt_task' style='width:inherit;height:inherit;'></div>\";\n\t\tthis.$task = container.childNodes[0];\n\n\t\tthis.$task.innerHTML = \"<div class='gantt_task_scale'></div><div class='gantt_data_area'></div>\";\n\t\tthis.$task_scale = this.$task.childNodes[0];\n\n\t\tthis.$task_data = this.$task.childNodes[1];\n\t\tconst taskBg = \"<div class='gantt_task_bg'></div>\";\n\t\tconst links = \"<div class='gantt_links_area'></div>\";\n\t\tconst taskBars = \"<div class='gantt_bars_area'></div>\";\n\n\t\tconst taskConstraints = \"<div class='gantt_task_constraints'></div>\";\n\t\tconst taskDeadlines = \"<div class='gantt_task_deadlines'></div>\";\n\t\tconst taskBaselines = \"<div class='gantt_task_baselines'></div>\";\n\n\t\tthis.$task_data.innerHTML = taskBg + taskBaselines + links + taskBars + taskConstraints + taskDeadlines;\n\n\t\tthis.$task_bg = this.$task_data.childNodes[0];\n\t\tthis.$task_baselines = this.$task_data.childNodes[1];\n\t\tthis.$task_links = this.$task_data.childNodes[2];\n\t\tthis.$task_bars = this.$task_data.childNodes[3];\n\t\tthis.$task_constraints = this.$task_data.childNodes[4];\n\t\tthis.$task_deadlines = this.$task_data.childNodes[5];\n\n\t\tthis._tasks = {\n\t\t\tcol_width: 0,\n\t\t\twidth: [], // width of each column\n\t\t\tfull_width: 0, // width of all columns\n\t\t\ttrace_x: [],\n\t\t\trendered: {}\n\t\t};\n\n\t\tvar config = this.$getConfig();\n\t\tvar attr = config[this.$config.bind + \"_attribute\"];\n\t\tvar linksAttr = config[this.$config.bindLinks + \"_attribute\"];\n\t\tif(!attr && this.$config.bind){\n\t\t\tattr = \"data-\" + this.$config.bind + \"-id\";\n\t\t}\n\t\tif(!linksAttr && this.$config.bindLinks){\n\t\t\tlinksAttr = \"data-\" + this.$config.bindLinks + \"-id\";\n\t\t}\n\t\tthis.$config.item_attribute = attr || null;\n\t\tthis.$config.link_attribute = linksAttr || null;\n\n\t\tvar layers = this._createLayerConfig();\n\t\tif(!this.$config.layers){\n\t\t\tthis.$config.layers = layers.tasks;\n\t\t}\n\t\tif(!this.$config.linkLayers){\n\t\t\tthis.$config.linkLayers = layers.links;\n\t\t}\n\n\t\tthis._attachLayers(this.$gantt);\n\n\t\tthis.callEvent(\"onReady\", []);\n\t\t//this.refresh();\n\t\tif (this.$gantt.ext.dragTimeline) {\n\t\t\tthis._timelineDragScroll = this.$gantt.ext.dragTimeline.create();\n\t\t\tthis._timelineDragScroll.attach(this);\n\t\t}\n\t},\n\n\tsetSize: function(width, height){\n\t\tvar config = this.$getConfig();\n\n\t\tif(width*1 === width){\n\t\t\tthis.$config.width = width;\n\t\t}\n\t\tif(height*1 === height){\n\n\t\t\tthis.$config.height = height;\n\t\t\tvar dataHeight = Math.max(this.$config.height - config.scale_height);\n\t\t\tthis.$task_data.style.height = dataHeight + 'px';\n\t\t}\n\n\t\tthis.refresh();\n\t\tthis.$task_bg.style.backgroundImage = \"\";\n\n\t\tif(config.smart_rendering && this.$config.rowStore){\n\t\t\tthis.$task_bg.style.height = this.getTotalHeight() +\"px\";\n\t\t}else{\n\t\t\tthis.$task_bg.style.height = \"\";\n\t\t}\n\n\t\tvar scale = this._tasks;\n\t\t//timeline area layers\n\t\tvar data_els = this.$task_data.childNodes;\n\t\tfor(var i= 0, len = data_els.length; i < len; i++){\n\t\t\tvar el = data_els[i];\n\t\t\tif(el.hasAttribute(\"data-layer\") && el.style)\n\t\t\t\tel.style.width = scale.full_width + \"px\";\n\t\t}\n\t},\n\n\tisVisible: function(){\n\t\tif(this.$parent && this.$parent.$config){\n\t\t\treturn !this.$parent.$config.hidden;\n\t\t}else{\n\t\t\treturn this.$task.offsetWidth;\n\t\t}\n\t},\n\n\tgetSize: function(){\n\t\tvar config = this.$getConfig();\n\t\tvar store = this.$config.rowStore;\n\n\t\tvar contentHeight = store ? this.getTotalHeight() : 0,\n\t\t\tcontentWidth = this.isVisible() ? this._tasks.full_width : 0;\n\n\t\treturn {\n\t\t\tx: this.isVisible() ? this.$config.width : 0,\n\t\t\ty: this.isVisible() ? this.$config.height : 0,\n\t\t\tcontentX: this.isVisible() ? contentWidth : 0,\n\t\t\tcontentY: this.isVisible() ? (config.scale_height + contentHeight) : 0,\n\t\t\tscrollHeight: this.isVisible() ? contentHeight : 0,\n\t\t\tscrollWidth: this.isVisible() ? contentWidth : 0\n\t\t};\n\t},\n\n\tscrollTo: function(left, top){\n\t\tif(!this.isVisible())\n\t\t\treturn;\n\n\t\tvar scrolled = false;\n\n\t\tthis.$config.scrollTop = this.$config.scrollTop || 0;\n\t\tthis.$config.scrollLeft = this.$config.scrollLeft || 0;\n\t\tif(top*1 === top){\n\t\t\tthis.$config.scrollTop = top;\n\t\t\tthis.$task_data.scrollTop = this.$config.scrollTop;\n\t\t\tscrolled = true;\n\t\t}\n\t\tif (left*1 === left){\n\t\t\tthis.$task.scrollLeft = left;\n\t\t\tthis.$config.scrollLeft = this.$task.scrollLeft;\n\t\t\tthis._refreshScales();\n\t\t\tscrolled = true;\n\t\t}\n\n\t\tif(scrolled){\n\t\t\tthis.callEvent(\"onScroll\", [this.$config.scrollLeft, this.$config.scrollTop]);\n\t\t}\n\t},\n\n\t_refreshScales: function _refreshScales() {\n\t\tif(!this.isVisible())\n\t\t\treturn;\n\n\t\tvar config = this.$getConfig();\n\t\tif (!config.smart_scales) return;\n\n\t\tvar viewPort = this.getViewPort();\n\n\t\tvar scales = this._scales;\n\t\tthis.$task_scale.innerHTML = this._getScaleChunkHtml(scales, viewPort.x, viewPort.x_end);\n\t},\n\n\tgetViewPort: function(){\n\t\tvar scrollLeft = this.$config.scrollLeft || 0;\n\t\tvar scrollTop = this.$config.scrollTop || 0;\n\t\tvar height = this.$config.height || 0;\n\t\tvar width = this.$config.width || 0;\n\t\treturn {\n\t\t\ty: scrollTop,\n\t\t\ty_end: scrollTop + height,\n\t\t\tx: scrollLeft,\n\t\t\tx_end: scrollLeft + width,\n\t\t\theight: height,\n\t\t\twidth: width\n\t\t};\n\t},\n\n\t_createLayerConfig: createLayerConfig,\n\n\t_attachLayers: function(gantt){\n\t\tthis._taskLayers = [];\n\t\tthis._linkLayers = [];\n\n\t\tvar self = this;\n\n\t\tvar layers = this.$gantt.$services.getService(\"layers\");\n\n\t\tif(this.$config.bind){\n\n\t\t\tthis._bindStore();\n\t\t\tvar taskRenderer = layers.getDataRender(this.$config.bind);\n\n\t\t\tif(!taskRenderer){\n\t\t\t\ttaskRenderer = layers.createDataRender({\n\t\t\t\t\tname: this.$config.bind,\n\t\t\t\t\tdefaultContainer: function(){ return self.$task_data;}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\ttaskRenderer.container = function(){ return self.$task_data;};\n\n\t\t\tvar taskLayers = this.$config.layers;\n\t\t\tfor(var i = 0; taskLayers && i < taskLayers.length; i++){\n\t\t\t\tvar layer = taskLayers[i];\n\n\t\t\t\tif(typeof layer == \"string\"){\n\t\t\t\t\tlayer = this.$gantt.$ui.layers[layer]();\n\t\t\t\t}\n\n\t\t\t\tif(typeof layer == \"function\" || (layer && layer.render && layer.update)){\n\t\t\t\t\tlayer = {renderer: layer};\n\t\t\t\t}\n\n\t\t\t\tlayer.view = this;\n\n\t\t\t\tvar bar_layer = taskRenderer.addLayer(layer);\n\t\t\t\tthis._taskLayers.push(bar_layer);\n\t\t\t\tif(layer.expose){\n\t\t\t\t\tthis._taskRenderer = taskRenderer.getLayer(bar_layer);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._initStaticBackgroundRender();\n\t\t}\n\n\t\tif(this.$config.bindLinks){\n\t\t\tself.$config.linkStore = self.$gantt.getDatastore(self.$config.bindLinks);\n\n\t\t\tvar linkRenderer = layers.getDataRender(this.$config.bindLinks);\n\n\t\t\tif(!linkRenderer){\n\t\t\t\tlinkRenderer = layers.createDataRender({\n\t\t\t\t\tname: this.$config.bindLinks,\n\t\t\t\t\tdefaultContainer: function(){ return self.$task_data;}\n\t\t\t\t});\n\t\t\t}\n\t\t\tvar linkLayers = this.$config.linkLayers;\n\t\t\tfor(var i = 0; linkLayers && i < linkLayers.length; i++){\n\n\t\t\t\tif(typeof layer == \"string\"){\n\t\t\t\t\tlayer = this.$gantt.$ui.layers[layer]();\n\t\t\t\t}\n\n\t\t\t\tvar layer = linkLayers[i];\n\t\t\t\tlayer.view = this;\n\t\t\t//\tlayer.getViewPort = getViewPort;\n\t\t\t//\tsubscribeSmartRender(layer);\n\t\t\t\tvar linkLayer = linkRenderer.addLayer(layer);\n\t\t\t\tthis._taskLayers.push(linkLayer);\n\t\t\t\tif(linkLayers[i].expose){\n\t\t\t\t\tthis._linkRenderer = linkRenderer.getLayer(linkLayer);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t_initStaticBackgroundRender: function(){\n\t\tvar self = this;\n\t\tvar staticRender = canvasRender.create();\n\t\tvar store = self.$config.rowStore;\n\t\tif(!store) return;\n\n\t\tthis._staticBgHandler = store.attachEvent(\"onStoreUpdated\", function(id, item, mode){\n\t\t\tif(id !== null) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif(!self.isVisible())\n\t\t\t\treturn;\n\t\t\tvar config = self.$getConfig();\n\t\t\tif(config.static_background || config.timeline_placeholder) {\n\t\t\t\tvar store = self.$gantt.getDatastore(self.$config.bind);\n\t\t\t\tvar staticBgContainer = self.$task_bg_static;\n\t\t\t\tif(!staticBgContainer){\n\t\t\t\t\tstaticBgContainer = document.createElement(\"div\");\n\t\t\t\t\tstaticBgContainer.className = \"gantt_task_bg\";\n\t\t\t\t\tself.$task_bg_static = staticBgContainer;\n\t\t\t\t\tif(self.$task_bg.nextSibling){\n\t\t\t\t\t\tself.$task_data.insertBefore(staticBgContainer, self.$task_bg.nextSibling);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tself.$task_data.appendChild(staticBgContainer);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (store) {\n\t\t\t\t\tvar staticBackgroundHeight = self.getTotalHeight();\n\t\t\t\t\tif (config.timeline_placeholder){\n\t\t\t\t\t\tstaticBackgroundHeight = config.timeline_placeholder.height || self.$task_data.offsetHeight || 99999;\n\t\t\t\t\t}\n\t\t\t\t\tstaticRender.render(staticBgContainer, config, self.getScale(), staticBackgroundHeight, self.getItemHeight(item ? item.id : null));\n\t\t\t\t}\n\t\t\t}else if(config.static_background){\n\t\t\t\tif(self.$task_bg_static && self.$task_bg_static.parentNode){\n\t\t\t\t\tself.$task_bg_static.parentNode.removeChild(self.$task_bg_static);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tthis.attachEvent(\"onDestroy\", function () {\n\t\t\tstaticRender.destroy();\n\t\t});\n\t\tthis._initStaticBackgroundRender = function(){};//init once\n\t},\n\n\t_clearLayers: function(gantt){\n\t\tvar layers = this.$gantt.$services.getService(\"layers\");\n\t\tvar taskRenderer = layers.getDataRender(this.$config.bind);\n\t\tvar linkRenderer = layers.getDataRender(this.$config.bindLinks);\n\n\t\tif (this._taskLayers) {\n\t\t\tfor(var i = 0; i < this._taskLayers.length; i++){\n\t\t\t\ttaskRenderer.removeLayer(this._taskLayers[i]);\n\t\t\t}\n\t\t}\n\t\tif (this._linkLayers) {\n\t\t\tfor(var i = 0; i < this._linkLayers.length; i++){\n\t\t\t\tlinkRenderer.removeLayer(this._linkLayers[i]);\n\t\t\t}\n\t\t}\n\n\t\tthis._linkLayers = [];\n\t\tthis._taskLayers = [];\n\t},\n\n\t_render_tasks_scales: function _render_tasks_scales() {\n\t\tvar config = this.$getConfig();\n\n\t\tvar scales_html = \"\",\n\t\t\touter_width = 0,\n\t\t\tscale_height = 0;\n\n\t\tvar state = this.$gantt.getState();\n\n\t\tif (this.isVisible()) {\n\t\t\tvar helpers = this.$scaleHelper;\n\t\t\tvar scales = this._getScales();\n\t\t\tscale_height = config.scale_height;\n\n\t\t\tvar availWidth = this.$config.width;\n\t\t\tif(config.autosize == \"x\" || config.autosize == \"xy\"){\n\t\t\t\tavailWidth = Math.max(config.autosize_min_width, 0);\n\t\t\t}\n\n\t\t\tvar cfgs = helpers.prepareConfigs(scales, config.min_column_width, availWidth, scale_height - 1, state.min_date, state.max_date, config.rtl);\n\t\t\tvar cfg = this._tasks = cfgs[cfgs.length - 1];\n\t\t\tthis._scales = cfgs;\n\t\t\tthis._posFromDateCache = {};\n\t\t\tthis._posFromWorkTimeCache = {};\n\n\t\t\tif(this._tasks.projection && this._tasks.projection?.source === \"fixedHours\"){\n\t\t\t\tconst calendarId = \"timescale-projection-calendar\";\n\t\t\t\tif(gantt.getCalendar(calendarId)){\n\t\t\t\t\tgantt.deleteCalendar(calendarId);\n\t\t\t\t}\n\n\t\t\t\tlet {hours} = this._tasks.projection;\n\t\t\t\tgantt.addCalendar({\n\t\t\t\t\tid:calendarId, \n\t\t\t\t\tworktime: {\n\t\t\t\t\t\thours: hours || gantt.getCalendar(\"global\")._worktime.hours.slice(),\n\t\t\t\t\t\tdays: [ 1, 1, 1, 1, 1, 1 ,1]\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tscales_html = this._getScaleChunkHtml(cfgs, 0, this.$config.width);\n\n\t\t\touter_width = cfg.full_width + \"px\";//cfg.full_width + (this._scroll_sizes().y ? scrollSizes.scroll_size : 0) + \"px\";\n\t\t\tscale_height += \"px\";\n\t\t}\n\n\t\tthis.$task_scale.style.height = scale_height;\n\n\t\tthis.$task_data.style.width =\n\t\t\tthis.$task_scale.style.width = outer_width;\n\n\t\tthis.$task_scale.innerHTML = scales_html;\n\n\t},\n\n\t_getScaleChunkHtml: function _get_scale_chunk_html (scales, fromPos, toPos) {\n\t\tvar templates = this.$gantt.templates;\n\t\tvar html = [];\n\n\t\tvar css = templates.scale_row_class;\n\t\tfor (var i = 0; i < scales.length; i++) {\n\t\t\tvar cssClass = \"gantt_scale_line\";\n\t\t\tvar tplClass = css(scales[i]);\n\t\t\tif (tplClass) {\n\t\t\t\tcssClass += \" \" + tplClass;\n\t\t\t}\n\n\t\t\thtml.push(\"<div class=\\\"\" + cssClass + \"\\\" style=\\\"height:\" + (scales[i].height) +\n\t\t\t\t\"px;position:relative;line-height:\" + (scales[i].height) + \"px\\\">\" + this._prepareScaleHtml(scales[i], fromPos, toPos, i) + \"</div>\");\n\t\t}\n\n\t\treturn html.join(\"\");\n\t},\n\t_prepareScaleHtml: function _prepare_scale_html(config, fromPos, toPos, index) {\n\t\tvar globalConfig = this.$getConfig();\n\t\tvar globalTemplates = this.$gantt.templates;\n\n\t\tvar cells = [];\n\t\tvar date = null, css = null;\n\n\t\tvar content = config.format || config.template || config.date;\n\n\t\tif(typeof content === \"string\"){\n\t\t\tcontent = this.$gantt.date.date_to_str(content);\n\t\t}\n\n\t\tvar startIndex = 0,\n\t\t\tendIndex = config.count;\n\n\t\tif (globalConfig.smart_scales && (!isNaN(fromPos) && !isNaN(toPos))) {\n\t\t\tstartIndex = helpers.findBinary(config.left, fromPos);\n\t\t\tendIndex = helpers.findBinary(config.left, toPos) + 1;\n\t\t}\n\n\t\tcss = config.css || function () {\n\t\t\t};\n\t\tif (!config.css && globalConfig.inherit_scale_class) {\n\t\t\tcss = globalTemplates.scale_cell_class;\n\t\t}\n\n\t\tfor (var i = startIndex; i < endIndex; i++) {\n\t\t\tif (!config.trace_x[i]) break;\n\n\t\t\tdate = new Date(config.trace_x[i]);\n\t\t\tvar value = content.call(this, date),\n\t\t\t\twidth = config.width[i],\n\t\t\t\theight = config.height,\n\t\t\t\tleft = config.left[i],\n\t\t\t\tstyle = \"\",\n\t\t\t\ttemplate = \"\",\n\t\t\t\tcssclass = \"\";\n\n\t\t\tif (width) {\n\t\t\t\tvar position = globalConfig.smart_scales ? (\"position:absolute;left:\" + left + \"px\") : \"\";\n\n\t\t\t\tstyle = \"width:\" + (width) + \"px;\" + position;\n\t\t\t\t// GS-1188: Display the scale value in the viewport for long cells\n\t\t\t\tconst viewPort = this.getViewPort();\n\t\t\t\tconst floatConfig = (globalConfig.scales[index] || {}).sticky; // for old scale settings\n\n\t\t\t\tlet labelPosition = '';\n\t\t\t\tconst approxLabelWidth = 70;\n\t\t\t\t// if sticky config is not specified - sticky labels are enabled for long cells only\n\t\t\t\tif ((floatConfig !== false && width > approxLabelWidth) || floatConfig === true) {\n\t\t\t\t\t\n\t\t\t\t\tif (left < viewPort.x && left + width/2 - approxLabelWidth/2 < viewPort.x){\n\t\t\t\t\t\tlabelPosition = ` style='position:absolute;left: ${viewPort.x  - left + 10}px;' `;\n\t\t\t\t\t} else if(left + width/2 + approxLabelWidth/2 > viewPort.x_end && width > approxLabelWidth){\n\t\t\t\t\t\tlet labelPos = viewPort.x_end - left - 10;\n\t\t\t\t\t\tlet translateValue = \"-100%\";\n\t\t\t\t\t\tif(labelPos < approxLabelWidth) {\n\t\t\t\t\t\t\tlabelPos = approxLabelWidth;\n\t\t\t\t\t\t\ttranslateValue = `-${labelPos}px`;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlabelPosition = ` style='position:absolute;left: ${labelPos}px;transform: translate(${translateValue},0);' `;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcssclass = \"gantt_scale_cell\" + (i == config.count - 1 ? \" gantt_last_cell\" : \"\");\n\n\t\t\t\ttemplate = css.call(this, date);\n\t\t\t\tif (template) cssclass += \" \" + template;\n\n\t\t\t\tvar ariaAttr = this.$gantt._waiAria.getTimelineCellAttr(value);\n\t\t\t\tvar cell = `<div class='${cssclass}' ${ariaAttr} style='${style}'><span ${labelPosition}>${value}</span></div>`;\n\t\t\t\tcells.push(cell);\n\t\t\t} else {\n\t\t\t\t//do not render ignored cells\n\t\t\t}\n\n\t\t}\n\t\treturn cells.join(\"\");\n\t},\n\t_getPositioningContext: function(task) {\n\t\tif(this._tasks.unit === this.$gantt.config.duration_unit){\n\t\t\treturn null;\n\t\t}\n\n\t\tif(this._tasks.unit !== \"day\" && this._tasks.unit !== \"week\"){\n\t\t\treturn null;\n\t\t}\n\n\t\tif(!this._tasks.projection){\n\t\t\treturn null;\n\t\t}\n\n\t\tconst {source} = this._tasks.projection || {};\n\t\tif(source === \"taskCalendar\"){\n\n\t\t\tif(!task){\n\t\t\t\treturn {\n\t\t\t\t\tcalendar: gantt.getCalendar(\"global\")\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tcalendar: gantt.getTaskCalendar(task)\n\t\t\t};\n\t\t}\n\t\tif(source === \"fixedHours\"){\n\t\t\treturn {\n\t\t\t\tcalendar: gantt.getCalendar(\"timescale-projection-calendar\")\n\t\t\t};\n\t\t}\n\n\t\treturn null;\n\t},\n\n\tdateFromPos: function dateFromPos(x, context) {\n\t\tvar scale = this._tasks;\n\t\tif (x < 0 || x > scale.full_width || !scale.full_width) {\n\t\t\treturn null;\n\t\t}\n\n\t\tvar ind = helpers.findBinary(this._tasks.left, x);\n\t\tvar summ = this._tasks.left[ind];\n\n\t\tvar col_width = scale.width[ind] || scale.col_width;\n\t\tvar part = 0;\n\t\tif (col_width) {\n\t\t\tpart = (x - summ) / col_width;\n\t\t\tif(scale.rtl){\n\t\t\t\tpart = 1 - part;\n\t\t\t}\n\n\t\t}\n\n\t\tconst calendar = (context ? context.calendar : null) || null;\n\n\t\tvar unit = 0;\n\t\tif (part) {\n\t\t\tunit = this._getColumnDuration(scale, scale.trace_x[ind]);\n\t\t}\n\n\t\tconst cellStartDate = scale.trace_x[ind];\n\n\t\tconst absolutePositionDate = new Date(scale.trace_x[ind].valueOf() + Math.round(part * unit));\n\n\t\tif(!calendar){\n\n\t\t\treturn absolutePositionDate;\n\t\t}\n\n\t\tconst {start: trimStartSec, end: cellEnd, duration: cellDuration, intervals} = this._getWorkTrimForCell(cellStartDate, calendar);\n\n\t\tif(cellDuration <= 0){\n\t\t\treturn absolutePositionDate;\n\t\t}\n\n\t\tconst secondsInsideTrim = Math.round(part * cellDuration);\n\t\tconst mappedTimestampMs = cellStartDate.valueOf() + (trimStartSec + secondsInsideTrim) * 1000;\n\n\t\treturn new Date(mappedTimestampMs);\n\t},\n\n\tposFromDate: function posFromDate(date, context) {\n\t\tif (!this.isVisible())\n\t\t\treturn 0;\n\n\t\tif(!date){\n\t\t\treturn 0;\n\t\t}\n\n\t\tif(context && context.calendar){\n\t\t\treturn this.posFromWorkTime(date, context);\n\t\t}\n\n\t\tvar dateValue = String(date.valueOf());\n\n\t\tif(this._posFromDateCache[dateValue] !== undefined){\n\t\t\treturn this._posFromDateCache[dateValue];\n\t\t}\n\t\tvar ind = this.columnIndexByDate(date);\n\t\tthis.$gantt.assert(ind >= 0, \"Invalid day index\");\n\n\t\tvar wholeCells = Math.floor(ind);\n\t\tvar partCell = ind % 1;\n\n\t\tvar pos = this._tasks.left[Math.min(wholeCells, this._tasks.width.length - 1)];\n\t\tif (wholeCells == this._tasks.width.length)\n\t\t\tpos += this._tasks.width[this._tasks.width.length - 1];\n\t\t//for(var i=1; i <= wholeCells; i++)\n\t\t//\tpos += gantt._tasks.width[i-1];\n\n\t\tif (partCell) {\n\t\t\tif (wholeCells < this._tasks.width.length) {\n\t\t\t\tpos += this._tasks.width[wholeCells] * (partCell % 1);\n\t\t\t} else {\n\t\t\t\tpos += 1;\n\t\t\t}\n\n\t\t}\n\n\t\tvar roundPos = Math.round(pos);\n\t\tthis._posFromDateCache[dateValue] = roundPos;\n\t\treturn Math.round(roundPos);\n\t},\n\n\t_getWorkTrimForCell: function (cellStartDate, calendar) {\n\t\tconst cellDurationMs = this._getColumnDuration(this._tasks, cellStartDate);\n\t\tconst cellEndDate = new Date(cellStartDate.valueOf() + cellDurationMs);\n\n\t\tlet earliestWorkSecondInCell = null;\n\t\tlet latestWorkSecondInCell = null;\n\t\tconst intervalsSinceCellStart = [];\n\n\t\tfor (let dayDate = new Date(cellStartDate), dayIndex = 0;\n\t\t\tdayDate < cellEndDate;\n\t\t\tdayDate = this.$gantt.date.add(dayDate, 1, \"day\"), dayIndex++) {\n\n\t\t\tconst dayIntervals = calendar._getWorkHours(dayDate) || [];\n\n\t\t\tconst dayStartOffsetSeconds = Math.round((dayDate - cellStartDate) / 1000);\n\n\t\t\tfor (let i = 0; i < dayIntervals.length; i++) {\n\t\t\t\tconst absoluteStartSeconds = dayStartOffsetSeconds + dayIntervals[i].start;\n\t\t\t\tconst absoluteEndSeconds   = dayStartOffsetSeconds + dayIntervals[i].end;\n\n\t\t\t\tintervalsSinceCellStart.push({\n\t\t\t\t\tstart: absoluteStartSeconds,\n\t\t\t\t\tend: absoluteEndSeconds\n\t\t\t\t});\n\n\t\t\t\tif (earliestWorkSecondInCell === null || absoluteStartSeconds < earliestWorkSecondInCell) {\n\t\t\t\t\tearliestWorkSecondInCell = absoluteStartSeconds;\n\t\t\t\t}\n\t\t\t\tif (latestWorkSecondInCell === null || absoluteEndSeconds > latestWorkSecondInCell) {\n\t\t\t\t\tlatestWorkSecondInCell = absoluteEndSeconds;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\tearliestWorkSecondInCell === null ||\n\t\t\tlatestWorkSecondInCell === null ||\n\t\t\tlatestWorkSecondInCell <= earliestWorkSecondInCell\n\t\t) {\n\t\t\treturn { start: 0, end: 0, duration: 0, intervals: [] };\n\t\t}\n\n\t\treturn {\n\t\t\tstart: earliestWorkSecondInCell,\n\t\t\tend: latestWorkSecondInCell,\n\t\t\tduration: latestWorkSecondInCell - earliestWorkSecondInCell,\n\t\t\tintervals: intervalsSinceCellStart\n\t\t};\n\t},\n\n\tposFromWorkTime: function (date, {calendar}) {\n\t\tif (!this.isVisible())\n\t\t\treturn 0;\n\t\tif (!date) {\n\t\t\treturn 0;\n\t\t}\n\n\t\tif(!calendar){\n\t\t\treturn this.posFromDate(date);\n\t\t}\n\n\t\tconst cacheKey = (calendar ? calendar.id : \"\") + String(date.valueOf());\n\t\tif (this._posFromWorkTimeCache[cacheKey] !== undefined) {\n\t\t\treturn this._posFromWorkTimeCache[cacheKey];\n\t\t}\n\n\t\tconst index = this.columnIndexByDate(date);\n\t\tthis.$gantt.assert(index >= 0, \"Invalid day index\");\n\n\t\tconst dayIndex = Math.floor(index);\t\n\t\tconst wholeCells = dayIndex;\n\n\t\tconst cellStartDate = this._tasks.trace_x[dayIndex];\n\t\tconst cellEndDate = new Date(cellStartDate.valueOf() + this._getColumnDuration(this._tasks, cellStartDate));\n\n\t\tconst {start: workintervalStart, end: workintervalEnd, duration: cellDuration} = this._getWorkTrimForCell(date, calendar);\n\n\t\tif(cellDuration === 0){\n\t\t\tconst result = this.posFromDate(date);\n\t\t//\tthis._posFromWorkTimeCache[cacheKey] = result;\n\t\t\treturn result;\n\t\t}\n\n\t\tconst cellStart = this._tasks.trace_x[dayIndex];\n\t\tconst dateOffset = (date - cellStart) / 1000; // in seconds\n\n\t\tlet fraction = 0;\n\t\tif(dateOffset <= workintervalStart){\n\t\t\tfraction = 0;\n\t\t} else if(dateOffset >= workintervalEnd){\n\t\t\tfraction = 1;\n\t\t} else {\n\t\t\tfraction = (dateOffset - workintervalStart) / cellDuration;\n\t\t}\n\n\t\tif(this._tasks.rtl){\n\t\t\tfraction = 1 - fraction;\n\t\t}\n\n\t\tconst posLeft = this._tasks.left[Math.min(wholeCells, this._tasks.width.length - 1)];\n\n\t\tconst cellWidth = (wholeCells < this._tasks.width.length)\n\t\t\t? this._tasks.width[wholeCells]\n\t\t\t: this._tasks.width[this._tasks.width.length - 1];\n\t\n\t\tconst pos = Math.round(posLeft + cellWidth * fraction);\n\t//\tthis._posFromWorkTimeCache[cacheKey] = pos;\n\n\t\treturn pos;\n\t},\n\n\n\t_getNextVisibleColumn: function (startIndex, columns, ignores) {\n\t\t// iterate columns to the right\n\t\tvar date = +columns[startIndex];\n\t\tvar visibleDateIndex = startIndex;\n\t\twhile (ignores[date]) {\n\t\t\tvisibleDateIndex++;\n\t\t\tdate = +columns[visibleDateIndex];\n\t\t}\n\n\t\treturn visibleDateIndex;\n\t},\n\t_getPrevVisibleColumn: function (startIndex, columns, ignores) {\n\t\t// iterate columns to the left\n\t\tvar date = +columns[startIndex];\n\t\tvar visibleDateIndex = startIndex;\n\t\twhile (ignores[date]) {\n\t\t\tvisibleDateIndex--;\n\t\t\tdate = +columns[visibleDateIndex];\n\t\t}\n\t\treturn visibleDateIndex;\n\t},\n\t_getClosestVisibleColumn: function (startIndex, columns, ignores) {\n\t\tvar visibleDateIndex = this._getNextVisibleColumn(startIndex, columns, ignores);\n\t\tif (!columns[visibleDateIndex]) {\n\t\t\tvisibleDateIndex =  this._getPrevVisibleColumn(startIndex, columns, ignores);\n\t\t}\n\t\treturn visibleDateIndex;\n\t},\n\tcolumnIndexByDate: function columnIndexByDate(date) {\n\t\tvar pos = new Date(date).valueOf();\n\t\tvar days = this._tasks.trace_x_ascending,\n\t\t\tignores = this._tasks.ignore_x;\n\n\t\tvar state = this.$gantt.getState();\n\n\t\tif (pos <= state.min_date) {\n\t\t\tif(this._tasks.rtl){\n\t\t\t\treturn days.length;\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t}\n\n\t\tif (pos >= state.max_date) {\n\t\t\tif(this._tasks.rtl){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn days.length;\n\t\t\t}\n\t\t}\n\n\t\tvar dateIndex = helpers.findBinary(days, pos);\n\n\t\tvar visibleIndex = this._getClosestVisibleColumn(dateIndex, days, ignores);\n\t\tvar visibleDate = days[visibleIndex];\n\t\tvar transition = this._tasks.trace_index_transition;\n\n\t\tif(!visibleDate){\n\t\t\tif(transition){\n\t\t\t\treturn transition[0];\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\n\t\tvar part = ((date - days[visibleIndex]) / this._getColumnDuration(this._tasks, days[visibleIndex]));\n\t\tif(transition){\n\t\t\treturn transition[visibleIndex] + (1 - part);\n\t\t}else{\n\t\t\treturn visibleIndex + part;\n\t\t}\n\t},\n\tgetItemPosition:function (task, start_date, end_date) {\n\t\tvar xLeft, xRight, width;\n\n\t\tlet displayStart = start_date || task.start_date || task.$auto_start_date;\n\t\tlet displayEnd = end_date || task.end_date || task.$auto_end_date;\n\n\t\tconst context = this._getPositioningContext(task);\n\t\tif(context && context.calendar) {\n\n\t\t\tif(this._tasks.rtl){\n\t\t\t\txRight = this.posFromWorkTime(displayStart, context);\n\t\t\t\txLeft = this.posFromWorkTime(displayEnd, context);\n\t\t\t}else{\n\t\t\t\txLeft = this.posFromWorkTime(displayStart, context);\n\t\t\t\txRight = this.posFromWorkTime(displayEnd, context);\n\t\t\t}\n\t\t}else{\n\t\t\tif(this._tasks.rtl){\n\t\t\t\txRight = this.posFromDate(displayStart);\n\t\t\t\txLeft = this.posFromDate(displayEnd);\n\t\t\t}else{\n\t\t\t\txLeft = this.posFromDate(displayStart);\n\t\t\t\txRight = this.posFromDate(displayEnd);\n\t\t\t}\n\t\t}\n\n\t\twidth =  Math.max((xRight - xLeft), 0);\n\n\t\tvar y = this.getItemTop(task.id);\n\n\t\tvar height = this.getBarHeight(task.id);\n\t\tvar rowHeight = this.getItemHeight(task.id);\n\t\treturn {\n\t\t\tleft: xLeft,\n\t\t\ttop: y,\n\t\t\theight: height,\n\t\t\twidth: width,\n\t\t\trowHeight: rowHeight\n\t\t};\n\t},\n\n\tgetBarHeight: function(taskId, isMilestoneRender){\n\t\tvar config = this.$getConfig();\n\n\t\tvar task = this.$config.rowStore.getItem(taskId);\n\t\t// height of the bar item\n\t\tvar height = task.task_height || task.bar_height || config.bar_height || config.task_height;\n\t\tvar rowHeight = this.getItemHeight(taskId);\n\n\t\tif (height == \"full\") {\n\t\t\tvar offset = config.bar_height_padding || 3;\n\t\t\theight = rowHeight - offset;\n\t\t}\n\t\t//item height cannot be bigger than row height\n\t\theight = Math.min(height, rowHeight);\n\t\tif (isMilestoneRender) { // to get correct height for addapting Milestone to the row\n\t\t\theight = Math.round(height / Math.sqrt(2));\n\t\t}\n\t\treturn Math.max(height, 0);\n\t},\n\n\tgetScale: function(){\n\t\treturn this._tasks;\n\t},\n\n\t_getScales: function _get_scales() {\n\t\tvar config = this.$getConfig();\n\t\tvar helpers = this.$scaleHelper;\n\t\tvar scales = [helpers.primaryScale(config)].concat(helpers.getAdditionalScales(config));\n\n\t\thelpers.sortScales(scales);\n\t\treturn scales;\n\t},\n\n\t_getColumnDuration: function _get_coll_duration(scale, date) {\n\t\treturn this.$gantt.date.add(date, scale.step, scale.unit) - date;\n\t},\n\t_bindStore: function () {\n\t\tif (this.$config.bind){\n\t\t\tvar rowStore = this.$gantt.getDatastore(this.$config.bind);\n\t\t\tthis.$config.rowStore = rowStore;\n\t\t\tif(rowStore && !rowStore._timelineCacheAttached){\n\t\t\t\tvar self = this;\n\t\t\t\trowStore._timelineCacheAttached = rowStore.attachEvent(\"onBeforeFilter\", function(){\n\t\t\t\t\tself._resetTopPositionHeight();\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t},\n\t_unbindStore: function(){\n\t\tif (this.$config.bind){\n\t\t\tvar rowStore = this.$gantt.getDatastore(this.$config.bind);\n\t\t\tif(rowStore && rowStore._timelineCacheAttached){\n\t\t\t\trowStore.detachEvent(rowStore._timelineCacheAttached);\n\t\t\t\trowStore._timelineCacheAttached = false;\n\t\t\t}\n\t\t}\n\t},\n\trefresh: function(){\n\t\tthis._bindStore();\n\n\t\tif(this.$config.bindLinks) {\n\t\t\tthis.$config.linkStore = this.$gantt.getDatastore(this.$config.bindLinks);\n\t\t}\n\n\t\tthis._resetTopPositionHeight();\n\t\tthis._resetHeight();\n\t\tthis._initStaticBackgroundRender();\n\t\tthis._render_tasks_scales();\n\t},\n\n\tdestructor: function(){\n\t\tvar gantt = this.$gantt;\n\t\tthis._clearLayers(gantt);\n\t\tthis._unbindStore();\n\t\tthis.$task = null;\n\t\tthis.$task_scale = null;\n\t\tthis.$task_data = null;\n\t\tthis.$task_bg = null;\n\t\tthis.$task_links = null;\n\t\tthis.$task_bars = null;\n\n\t\tthis.$gantt = null;\n\n\t\tif(this.$config.rowStore){\n\t\t\tthis.$config.rowStore.detachEvent(this._staticBgHandler);\n\t\t\tthis.$config.rowStore = null;\n\t\t}\n\t\tif(this.$config.linkStore){\n\t\t\tthis.$config.linkStore = null;\n\t\t}\n\n\t\tif(this._timelineDragScroll) {\n\t\t\tthis._timelineDragScroll.destructor();\n\t\t\tthis._timelineDragScroll = null;\n\t\t}\n\n\t\tthis.callEvent(\"onDestroy\", []);\n\t\tthis.detachAllEvents();\n\n\t}\n};\n\nexport default Timeline;","import * as helpers from \"../../utils/helpers\";\n\nfunction clearTaskStoreHandler(self) {\n\tif (self._delayRender) {\n\t\tself._delayRender.$cancelTimeout();\n\t}\n\n\tif (!self.$gantt) {\n\t\treturn;\n\t}\n\n\tvar tasks = self.$gantt.$data.tasksStore;\n\tvar ownStore = self.$config.rowStore;\n\n\tvar handlerIdProperty = \"_attached_\" + ownStore.$config.name;\n\tif (self[handlerIdProperty]) {\n\t\ttasks.detachEvent(self[handlerIdProperty]);\n\t\tself[handlerIdProperty] = null;\n\t}\n\n\tif (ownStore.$attachedResourceViewHandler) {\n\t\townStore.detachEvent(ownStore.$attachedResourceViewHandler);\n\t\townStore.$attachedResourceViewHandler = null;\n\n\t\ttasks.detachEvent(ownStore.$attachedTaskStoreHandler);\n\t\townStore.$attachedTaskStoreHandler = null;\n\t}\n}\n\nfunction createMixin(_super){\n\n\tvar initGrid = _super.prototype.init,\n\t\tdestroyGrid = _super.prototype.destructor;\n\n\treturn {\n\t\tinit: function() {\n\t\t\tinitGrid.apply(this, arguments);\n\t\t\tthis._linkToTaskStore();\n\t\t},\n\n\t\tdestructor: function() {\n\t\t\tclearTaskStoreHandler(this);\n\t\t\tdestroyGrid.apply(this, arguments);\n\t\t},\n\n\t\tpreviousDragId: null,\n\t\trelevantResources: null,\n\n\t\t_linkToTaskStore: function () {\n\t\t\tif (this.$config.rowStore && this.$gantt.$data.tasksStore) {\n\t\t\t\tvar tasks = this.$gantt.$data.tasksStore;\n\t\t\t\tvar ownStore = this.$config.rowStore;\n\t\t\t\tclearTaskStoreHandler(this);\n\n\t\t\t\tvar self = this;\n\t\t\t\tvar delayRender = helpers.delay(function() {\n\t\t\t\t\tif (self.$gantt.getState().lightbox) {\n\t\t\t\t\t\tdelayRender();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst linkedStore = self.$config.rowStore;\n\n\t\t\t\t\t\t// Repaint only relevant resources for task drag\n\t\t\t\t\t\tconst repaintStack = self._getRelevantResources();\n\t\t\t\t\t\t// GS-2822: extra check for resource store\n\t\t\t\t\t\tif (repaintStack && linkedStore.$config.name === self.$gantt.config.resource_store){\n\t\t\t\t\t\t\tif (repaintStack == \"nothing_to_repaint\"){\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tlinkedStore._quick_refresh = true;\n\t\t\t\t\t\t\tself.relevantResources.forEach(function(id){\n\t\t\t\t\t\t\t\tlinkedStore.refresh(id);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tlinkedStore._quick_refresh = false;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// because rowstore could be changed during timeout\n\t\t\t\t\t\t\tlinkedStore.refresh();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, 300);\n\t\t\t\tthis._delayRender = delayRender;\n\t\t\t\tvar handlerIdProperty = \"_attached_\" + ownStore.$config.name;\n\n\t\t\t\tif (!self[handlerIdProperty]) {\n\t\t\t\t\tself[handlerIdProperty] = tasks.attachEvent(\"onStoreUpdated\", function(){\n\t\t\t\t\t\tif(!delayRender.$pending && !this._skipResourceRepaint){\n\t\t\t\t\t\t\t// don't repaint if we update progress\n\t\t\t\t\t\t\tconst state = self.$gantt.getState();\n\t\t\t\t\t\t\tif (state.drag_mode == \"progress\"){\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t} else if (state.drag_mode && state.drag_id){\n\t\t\t\t\t\t\t\t// we need it here because if you started dragging a task and quickly stopped the drag_id is removed \n\t\t\t\t\t\t\t\t// from the state before we record it, so we cannot repaint only the relevant resources\n\t\t\t\t\t\t\t\tself.previousDragId = state.drag_id;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdelayRender();\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tthis.$gantt.attachEvent(\"onDestroy\", function() {\n\t\t\t\t\t// detach events to don't call delayed tasks\n\t\t\t\t\tclearTaskStoreHandler(self);\n\t\t\t\t\treturn true;\n\t\t\t\t});\n\n\t\t\t\tif (!ownStore.$attachedResourceViewHandler) {\n\t\t\t\t\townStore.$attachedResourceViewHandler = ownStore.attachEvent(\"onBeforeFilter\", function() {\n\t\t\t\t\t\tif (self.$gantt.getState().lightbox) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (delayRender.$pending) {\n\t\t\t\t\t\t\tdelayRender.$cancelTimeout();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tself._updateNestedTasks();\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t});\n\n\t\t\t\t\townStore.$attachedTaskStoreHandler = tasks.attachEvent(\"onAfterDelete\", function(){\n\t\t\t\t\t\townStore._mark_recompute = true;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_getRelevantResources: function (){\n\t\t\t// GS-2199. process_resource_assignments is disabled,\n\t\t\t// so we cannot get only the relevant assignment resources\n\t\t\tif (!this.$gantt.getTaskAssignments){\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tconst state = this.$gantt.getState();\n\t\t\tconst linkedStore = this.$config.rowStore;\n\n\t\t\tlet resourceIds = [];\n\t\t\tif (state.drag_mode && state.drag_id && linkedStore.$config.name === this.$gantt.config.resource_store){\n\t\t\t\tif (this.previousDragId == state.drag_id){ // we continue dragging the task\n\t\t\t\t\tif (this.relevantResources) {\n\t\t\t\t\t\treturn this.relevantResources;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresourceIds = this._getIdsFromAssignments(this.previousDragId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse { // we started the task drag\n\t\t\t\t\tthis.previousDragId = state.drag_id;\n\t\t\t\t\tresourceIds = this._getIdsFromAssignments(this.previousDragId);\n\t\t\t\t}\n\t\t\t} else if (this.previousDragId){ // finished task drag, but the resources are still the same\n\t\t\t\tresourceIds = this._getIdsFromAssignments(this.previousDragId);\n\t\t\t\tthis.previousDragId = null;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tif (!resourceIds.length){\n\t\t\t\treturn this.relevantResources = \"nothing_to_repaint\";\n\t\t\t}\n\t\t\t\n\t\t\tresourceIds.forEach(function(resourceId){\n\t\t\t\t//GS-2598: linkedstore could be a temp assignment store\n\t\t\t\tif(linkedStore.eachParent){\n\t\t\t\t\tlinkedStore.eachParent(function(parent){\n\t\t\t\t\t\tresourceIds.push(parent.id);\n\t\t\t\t\t}, resourceId);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn this.relevantResources = [...new Set(resourceIds)];\n\t\t},\n\n\t\t_getIdsFromAssignments: function(id){\n\t\t\tconst gantt = this.$gantt;\n\t\t\tconst resourceIds = [];\n\n\t\t\tconst task = gantt.getTask(id);\n\t\t\tlet assignments = gantt.getTaskAssignments(id);\n\t\t\tassignments.forEach(function(assignment){\n\t\t\t\tresourceIds.push(assignment.resource_id);\n\t\t\t});\n\n\t\t\t// get child assignments when dragging project task\n\t\t\tif (gantt.isSummaryTask(task) && gantt.config.drag_project) {\n\t\t\t\tgantt.eachTask(function(child){\n\t\t\t\t\tconst childAssignments = gantt.getTaskAssignments(child.id);\n\t\t\t\t\tchildAssignments.forEach(function(assignment){\n\t\t\t\t\t\tresourceIds.push(assignment.resource_id);\n\t\t\t\t\t});\n\t\t\t\t}, id);\n\t\t\t}\n\n\t\t\t// get assignments of other selected tasks\n\t\t\tif (gantt.config.drag_multiple && gantt.getSelectedTasks){\n\t\t\t\tconst selectedIds = gantt.getSelectedTasks();\n\t\t\t\tselectedIds.forEach(function(selectedId){\n\t\t\t\t\tconst selectedAssignments = gantt.getTaskAssignments(selectedId);\n\t\t\t\t\tselectedAssignments.forEach(function(assignment){\n\t\t\t\t\t\tresourceIds.push(assignment.resource_id);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn resourceIds;\n\t\t},\n\n\t\t_updateNestedTasks: function(){\n\t\t\tvar gantt = this.$gantt;\n\t\t\tvar resourceStore = gantt.getDatastore(gantt.config.resource_store);\n\t\t\tif (!resourceStore.$config.fetchTasks) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tresourceStore.silent(function(){\n\t\t\t\tvar toAddArray = [];\n\t\t\t\tvar toAdd = {};\n\t\t\t\tvar toDelete = {};\n\n\t\t\t\tresourceStore.eachItem(function(resource){\n\t\t\t\t\tif (resource.$role == \"task\") {\n\t\t\t\t\t\ttoDelete[resource.id] = true;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar assignments = gantt.getResourceAssignments(resource.id);\n\t\t\t\t\tvar addedTasks = {};\n\n\t\t\t\t\t// GS-1505. We need to sort assignments before updating tasks. \n\t\t\t\t\t// Iterating them without that will affect the order of featched tasks in the resource store\n\t\t\t\t\tassignments.sort(function (a, b) {\n\t\t\t\t\t\tconst resourceData = resourceStore.pull;\n\t\t\t\t\t\tconst resource1 = resourceData[`${a.task_id}_${a.resource_id}`];\n\t\t\t\t\t\tconst resource2 = resourceData[`${b.task_id}_${b.resource_id}`];\n\t\t\t\t\t\tif (resource1 && resource2) {\n\t\t\t\t\t\t\treturn resource1.$local_index - resource2.$local_index;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tassignments.forEach(function(a) {\n\t\t\t\t\t\tif(addedTasks[a.task_id] || !gantt.isTaskExists(a.task_id)){\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\taddedTasks[a.task_id] = true;\n\n\t\t\t\t\t\tvar task = gantt.getTask(a.task_id);\n\t\t\t\t\t\tvar copy;\n\t\t\t\t\t\t//GS-2711: deep copy from task\n\t\t\t\t\t\tif(resourceStore.$config.copyOnParse){\n\t\t\t\t\t\t\tcopy = gantt.copy(task);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcopy = Object.create(task);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcopy.id = task.id + '_' + resource.id;\n\n\t\t\t\t\t\tcopy.$task_id = task.id;\n\t\t\t\t\t\tcopy.$resource_id = resource.id;\n\t\t\t\t\t\tcopy[resourceStore.$parentProperty] = resource.id;\n\t\t\t\t\t\tcopy.$role = \"task\";\n\t\t\t\t\t\ttoAddArray.push(copy);\n\t\t\t\t\t\ttoAdd[copy.id] = true;\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tfor (var id in toDelete) {\n\t\t\t\t\tif (!toAdd[id]) {\n\t\t\t\t\t\tresourceStore.removeItem(id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(toAddArray.length){\n\t\t\t\t\tresourceStore.parse(toAddArray);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n}\n\nexport default createMixin;","\nexport default function(){\n\tvar self = this;\n\tvar taskFilter = function(){\n\t\treturn self.isVisible();\n\t};\n\n\tvar barVisible = function(id, task){\n\t\treturn !task.hide_bar;\n\t};\n\n\tconst gantt = this.$gantt;\n\n\tconst isTimedProject = function(id, task){\n\t\treturn task.type === gantt.config.types.project && task.auto_scheduling === false;\n\t};\n\tconst isNotTimedProject = function(id, task){\n\t\treturn !isTimedProject(id, task);\n\t};\n\n\tvar taskLayers = [\n\t\t{\n\t\t\texpose: true,\n\t\t\trenderer: this.$gantt.$ui.layers.taskBar(),\n\t\t\tcontainer: this.$task_bars,\n\t\t\tfilter: [taskFilter, barVisible, isNotTimedProject]\n\t\t},\n\t\t{\n\t\t\trenderer: this.$gantt.$ui.layers.timedProjectBar(),\n\t\t\tfilter: [taskFilter, isTimedProject],\n\t\t\tcontainer: this.$task_bars,\n\t\t\tappend: true\n\t\t},\n\t\t{\n\t\t\trenderer: this.$gantt.$ui.layers.taskSplitBar(),\n\t\t\tfilter: [taskFilter],\n\t\t\tcontainer: this.$task_bars,\n\t\t\tappend: true\n\t\t},\n\t\t{\n\t\t\trenderer: this.$gantt.$ui.layers.taskRollupBar(),\n\t\t\tfilter: [taskFilter],\n\t\t\tcontainer: this.$task_bars,\n\t\t\tappend: true\n\t\t},\n\t\t{\n\t\t\trenderer: this.$gantt.$ui.layers.taskConstraints(),\n\t\t\tfilter: [taskFilter],\n\t\t\tcontainer: this.$task_constraints,\n\t\t\tappend: false\n\t\t}\n\t];\n\n\tif(gantt.config.deadlines){\n\t\ttaskLayers.push({\n\t\t\trenderer: this.$gantt.$ui.layers.taskDeadline(),\n\t\t\tfilter: [taskFilter],\n\t\t\tcontainer: this.$task_deadlines,\n\t\t\tappend: false\n\t\t});\n\t}\n\n\tif(gantt.config.baselines){\n\t\ttaskLayers.push({\n\t\t\trenderer: this.$gantt.$ui.layers.taskBaselines(),\n\t\t\tfilter: [taskFilter],\n\t\t\tcontainer: this.$task_baselines,\n\t\t\tappend: false\n\t\t});\n\t}\n\n\ttaskLayers.push({\n\t\trenderer: this.$gantt.$ui.layers.taskBg(),\n\t\tcontainer: this.$task_bg,\n\t\tfilter: [\n\t\t\t//function(){\n\t\t\t//\treturn !self.$getConfig().static_background;\n\t\t\t//},\n\t\t\ttaskFilter\n\t\t]\n\t});\n\n\tvar linkLayers = [\n\t\t{\n\t\t\texpose: true,\n\t\t\trenderer: this.$gantt.$ui.layers.link(),\n\t\t\tcontainer: this.$task_links,\n\t\t\tfilter: [taskFilter]\n\t\t}\n\t];\n\n\treturn {\n\t\ttasks: taskLayers,\n\t\tlinks: linkLayers\n\t};\n\n};","import * as domHelpers from \"../utils/dom_helpers\";\nimport * as utils from \"../../../utils/utils\";\nimport resourceStoreMixin from \"../resource_store_mixin\";\nimport Grid from \"./grid\";\nimport __extends from \"../../../utils/extends\";\n\nvar ResourceGrid = (function (_super) {\n\n\tfunction ResourceGrid(parent, config, factory, gantt) {\n\t\treturn _super.apply(this, arguments) || this;\n\t}\n\n\t__extends(ResourceGrid, _super);\n\n\tutils.mixin(ResourceGrid.prototype, {\n\t\tinit: function(){\n\t\t\tif(this.$config.bind === undefined){\n\t\t\t\tthis.$config.bind = this.$getConfig().resource_store;\n\t\t\t}\n\t\t\t_super.prototype.init.apply(this, arguments);\n\t\t},\n\n\t\t_initEvents: function(){\n\t\t\tvar gantt = this.$gantt;\n\t\t\t_super.prototype._initEvents.apply(this, arguments);\n\t\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_row\", gantt.bind(function (e, id, trg) {\n\t\t\t\tvar store = this.$config.rowStore;\n\t\t\t\tif(!store) return true;\n\n\t\t\t\tvar target = domHelpers.locateAttribute(e, this.$config.item_attribute);\n\t\t\t\tif(target){\n\t\t\t\t\tstore.select(target.getAttribute(this.$config.item_attribute));\n\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}, this), this.$grid);\n\n\t\t}\n\n\t}, true);\n\n\tutils.mixin(ResourceGrid.prototype, resourceStoreMixin(ResourceGrid), true);\n\n\treturn ResourceGrid;\n})(Grid);\n\nexport default ResourceGrid;","import domEventScope from \"../../ui/utils/dom_event_scope\";\nimport * as utils from \"../../../utils/utils\";\nimport resourceStoreMixin from \"../resource_store_mixin\";\nimport Grid from \"./grid\";\nimport __extends from \"../../../utils/extends\";\n\nconst GridRL = (function (_super) {\n\n\tfunction GridRL(parent, config, factory, gantt) {\n\t\treturn _super.apply(this, arguments) || this;\n\t}\n\n\t__extends(GridRL, _super);\n\n\tutils.mixin(GridRL.prototype, {\n\t\tinit: function(container) {\n\t\t\tconst gantt = this.$gantt;\n\t\t\tconst gridAriaAttr = gantt._waiAria.gridAttrString();\n\t\t\tconst gridDataAriaAttr = gantt._waiAria.gridDataAttrString();\n\t\t\tconst _ganttConfig = this.$getConfig();\n\t\t\t_ganttConfig.row_height = this._getResourceConfig().row_height ? this._getResourceConfig().row_height : gantt.resource_table.row_height ;\n\t\t\tlet reorderColumns = _ganttConfig.reorder_grid_columns || false;\n\t\t\tif (this.$config.reorder_grid_columns !== undefined) {\n\t\t\t\treorderColumns = this.$config.reorder_grid_columns;\n\t\t\t}\n\n\t\t\tif(this.$config.bind === undefined){\n\t\t\t\tthis.$config.bind = \"temp_resource_assignment_store\";\n\t\t\t\tthis.$config.name = \"resource_grid_lightbox\";\n\t\t\t\tthis.$config.$id = \"GridRL\";\n\t\t\t}\n\n\t\t\tcontainer.innerHTML = \"<div class='gantt_grid' style='width:100%;' \" + gridAriaAttr + \"></div>\";\n\t\t\tthis.$grid = container.childNodes[0];\n\n\t\t\tthis.$grid.innerHTML = \"<div class='gantt_grid_scale' \" +\n\t\t\t\tgantt._waiAria.gridScaleRowAttrString() + \"></div><div class='gantt_grid_data' \" + gridDataAriaAttr + \"></div>\";\n\n\t\t\tthis.$grid_scale = this.$grid.childNodes[0];\n\t\t\tthis.$grid_data = this.$grid.childNodes[1];\n\n\t\t\tlet attr = _ganttConfig[this.$config.bind + \"_attribute\"];\n\t\t\tif (!attr && this.$config.bind) {\n\t\t\t\tattr = \"data-\" + this.$config.bind + \"-id\";\n\t\t\t}\n\t\t\tthis.$config.item_attribute = attr || null;\n\n\t\t\tif (!this.$config.layers) {\n\t\t\t\tconst layers = this._createLayerConfig();\n\t\t\t\tthis.$config.layers = layers;\n\t\t\t}\n\n\t\t\tconst domEvents = domEventScope();\n\t\t\tthis.event = domEvents.attach;\n\t\t\tthis.eventRemove = domEvents.detach;\n\t\t\tthis._eventRemoveAll = domEvents.detachAll;\n\t\t\tthis._createDomEventScope = domEvents.extend;\n\n\t\t\tthis._addLayers(this.$gantt);\n\n\t\t\tthis._initEvents();\n\n\t\t\tthis.callEvent(\"onReady\", []);\n\n\t\t},\n\t\tgetColumn: function (name) {\n\t\t\tconst index = this.getColumnIndex(name);\n\t\t\tif (index === null) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tconst columns = this._getResourceColumns();\n\t\t\treturn columns[index] || null;\n\t\t},\n\t\tgetColumnIndex: function (name, excludeHidden) {\n\t\t\tconst columns = this._getResourceColumns();\n\t\t\tlet hiddenIndexShift = 0;\n\n\t\t\tfor (let i = 0; i < columns.length; i++) {\n\t\t\t\t// GS-1257. If the cell is hidden, the target column index should be correct\n\t\t\t\tif (excludeHidden && columns[i].hide){\n\t\t\t\t\thiddenIndexShift++;\n\t\t\t\t}\n\t\t\t\tif (columns[i].name == name) {\n\t\t\t\t\treturn i - hiddenIndexShift;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\tgetGridColumns: function(){\n\t\t\tconst columns = this._getResourceColumns();\n\t\t\tconst visibleColumns = [];\n\t\n\t\t\tfor (let i = 0; i < columns.length; i++) {\n\t\t\t\tif (!columns[i].hide)\n\t\t\t\t\tvisibleColumns.push(columns[i]);\n\t\t\t}\n\t\n\t\t\treturn visibleColumns;\n\t\t},\n\t\t_createLayerConfig: function () {\n\t\t\tconst gantt = this.$gantt;\n\t\t\tconst self = this;\n\t\t\tconst layers = [\n\t\t\t\t{\n\t\t\t\t\trenderer: gantt.$ui.layers.gridLine(),\n\t\t\t\t\tcontainer: this.$grid_data,\n\t\t\t\t\tfilter: [function () {\n\t\t\t\t\t\treturn self.isVisible();\n\t\t\t\t\t}]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\trenderer: gantt.$ui.layers.gridTaskRowResizer(),\n\t\t\t\t\tcontainer: this.$grid_data,\n\t\t\t\t\tappend: true,\n\t\t\t\t\tfilter: [function () {\n\t\t\t\t\t\treturn gantt.config.resize_rows;\n\t\t\t\t\t}]\n\t\t\t\t}\n\t\t\t];\n\t\t\treturn layers;\n\t\t},\n\t\t_renderGridHeader: function () {\n\t\t\tconst gantt = this.$gantt;\n\t\t\tconst config = this._getResourceConfig();\n\t\t\tconst locale = this.$gantt.locale;\n\t\t\tconst templates = this.$getTemplates();\n\t\n\t\t\tlet columns = this._getResourceColumns();\n\t\t\tif (config.rtl) {\n\t\t\t\tcolumns = columns.reverse();\n\t\t\t}\n\t\t\tif(!config.scale_height){\n\t\t\t\tconfig.scale_height = gantt.resource_table.scale_height;\n\t\t\t}\n\t\t\tlet cells = [];\n\t\t\tlet width = 0,\n\t\t\t\tlabels = locale.labels;\n\t\n\t\t\t\tlet lineHeigth = config.scale_height - 1;\n\t\n\t\t\tfor (let i = 0; i < columns.length; i++) {\n\t\t\t\tlet last = i == columns.length - 1;\n\t\t\t\tlet col = columns[i];\n\t\n\t\t\t\t// ensure columns have non-empty names\n\t\t\t\tif (!col.name) {\n\t\t\t\t\tcol.name = gantt.uid() + \"\";\n\t\t\t\t}\n\t\n\t\t\t\tlet colWidth = col.width * 1;\n\t\n\t\t\t\tlet gridWidth = this._getGridWidth();\n\t\t\t\tif (last && gridWidth > width + colWidth)\n\t\t\t\t\tcol.width = colWidth = gridWidth - width;\n\t\t\t\twidth += colWidth;\n\t\t\t\tlet sort = (gantt._sort && col.name == gantt._sort.name) ? (`<div data-column-id=\"${col.name}\" class=\"gantt_sort gantt_${gantt._sort.direction}\"></div>`) : \"\";\n\t\t\t\tlet cssClass = [\"gantt_grid_head_cell\",\n\t\t\t\t\t(\"gantt_grid_head_\" + col.name),\n\t\t\t\t\t(last ? \"gantt_last_cell\" : \"\"),\n\t\t\t\t\ttemplates.grid_header_class ? templates.grid_header_class(col.name, col) : \"\"].join(\" \");\n\t\n\t\t\t\tlet style = \"width:\" + (colWidth - (last ? 1 : 0)) + \"px;\";\n\t\t\t\tlet label = (col.label || labels[\"column_\" + col.name] || labels[col.name]);\n\t\t\t\tlabel = label || \"\";\n\t\n\t\t\t\tconst ariaAttrs = gantt._waiAria.gridScaleCellAttrString(col, label);\n\t\n\t\t\t\tconst cell = \"<div class='\" + cssClass + \"' style='\" + style + \"' \" + ariaAttrs + \n\t\t\t\t\t\" data-column-id='\" + col.name + \"' column_id='\" + col.name + \"'\" +\n\t\t\t\t\t\" data-column-name='\" + col.name + \"' data-column-index='\" + i + \"'\" +\n\t\t\t\t\t\">\" + label + sort + \"</div>\";\n\t\t\t\tcells.push(cell);\n\t\t\t}\n\t\t\tthis.$grid_scale.style.height = (config.scale_height) + \"px\";\n\t\t\tthis.$grid_scale.style.lineHeight = lineHeigth + \"px\";\n\t\t\tthis.$grid_scale.style.width = \"inherit\";\n\t\t\tthis.$grid_scale.innerHTML = cells.join(\"\");\n\t\t},\n\t\tisVisible: function () {\n\t\t\tif (this.$parent) {\n\t\t\t\treturn !this.$parent.hidden;\n\t\t\t} else {\n\t\t\t\treturn this.$grid.offsetWidth;\n\t\t\t}\n\t\t},\n\t\t_initEvents: function(){\n\t\t},\n\t\t_getResourceSection: function(){\n\t\t\treturn gantt.getLightboxSection(this.$config.sectionName).section;\n\t\t},\n\t\t$getTemplates: function() {\n\t\t\treturn this._getResourceSection().templates || {};\n\t\t},\n\t\t_getResourceConfig: function(){\n\t\t\treturn this._getResourceSection().config || gantt.resource_table;\n\t\t},\n\t\t_getResourceColumns: function() {\n\t\t\treturn this._getResourceSection().config?.columns || gantt.resource_table.columns;\n\t\t},\n\t\tdestructor: function () {\n\t\t\tif (this._mouseDelegates) {\n\t\t\t\tthis._mouseDelegates.destructor();\n\t\t\t\tthis._mouseDelegates = null;\n\t\t\t}\n\t\t\t\n\t\t\tthis._unbindStore();\n\t\t\tthis.$grid = null;\n\t\t\tthis.$grid_scale = null;\n\t\t\tthis.$grid_data = null;\n\t\t\tthis._eventRemoveAll();\n\t\t\tgantt.ext.inlineEditorsLightbox.destructor();\n\t\t\tthis.callEvent(\"onDestroy\", []);\n\t\t\tthis.detachAllEvents();\n\t\t}\n\t\t\n\t}, true);\n\n\tutils.mixin(GridRL.prototype, resourceStoreMixin(GridRL), true);\n\n\treturn GridRL;\n})(Grid);\n\nexport default GridRL;","import * as utils from \"../../../utils/utils\";\nimport Timeline from \"./timeline\";\nimport resourceStoreMixin from \"../resource_store_mixin\";\nimport __extends from \"../../../utils/extends\";\n\nvar ResourceTimeline = (function (_super) {\n\n\tfunction ResourceTimeline(parent, config, factory, gantt) {\n\t\tvar self = _super.apply(this, arguments) || this;\n\t\tself.$config.bindLinks = null;\n\t\treturn self;\n\t}\n\n\t__extends(ResourceTimeline, _super);\n\n\tutils.mixin(ResourceTimeline.prototype, {\n\t\tinit: function(){\n\t\t\t\n\t\t\tif(this.$config.bind === undefined){\n\t\t\t\tthis.$config.bind = this.$getConfig().resource_store;\n\t\t\t}\n\t\t\t_super.prototype.init.apply(this, arguments);\n\t\t},\n\t\t_createLayerConfig: function() {\n\t\t\tvar self = this;\n\t\t\tvar taskFilter = function() {\n\t\t\t\treturn self.isVisible();\n\t\t\t};\n\n\t\t\tvar taskLayers = [\n\t\t\t\t{\n\t\t\t\t\trenderer: this.$gantt.$ui.layers.resourceRow(),\n\t\t\t\t\tcontainer: this.$task_bars,\n\t\t\t\t\tfilter: [taskFilter]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\trenderer: this.$gantt.$ui.layers.taskBg(),\n\t\t\t\t\tcontainer: this.$task_bg,\n\t\t\t\t\tfilter: [taskFilter]\n\t\t\t\t}\n\t\t\t];\n\n\t\t\tvar linkLayers = [];\n\n\t\t\treturn {\n\t\t\t\ttasks: taskLayers,\n\t\t\t\tlinks: linkLayers\n\t\t\t};\n\t\t}\n\n\t}, true);\n\n\tutils.mixin(ResourceTimeline.prototype, resourceStoreMixin(ResourceTimeline), true);\n\n\treturn ResourceTimeline;\n})(Timeline);\n\n\nexport default ResourceTimeline;\n\n\n","import * as utils from \"../../../utils/utils\";\nimport ResourceTimeline from \"./resource_timeline\";\nimport resourceStoreMixin from \"../resource_store_mixin\";\nimport __extends from \"../../../utils/extends\";\n\nvar ResourceHistogram = (function (_super) {\n\n\tfunction ResourceHistogram(parent, config, factory, gantt) {\n\t\tvar self = _super.apply(this, arguments) || this;\n\t\tself.$config.bindLinks = null;\n\t\treturn self;\n\t}\n\n\t__extends(ResourceHistogram, _super);\n\n\tutils.mixin(ResourceHistogram.prototype, {\n\t\t_createLayerConfig: function(){\n\t\t\tvar self = this;\n\t\t\tvar taskFilter = function(){\n\t\t\t\treturn self.isVisible();\n\t\t\t};\n\n\t\t\tvar taskLayers = [\n\t\t\t\t{\n\t\t\t\t\trenderer: this.$gantt.$ui.layers.resourceHistogram(),\n\t\t\t\t\tcontainer: this.$task_bars,\n\t\t\t\t\tfilter: [taskFilter]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\trenderer: this.$gantt.$ui.layers.taskBg(),\n\t\t\t\t\tcontainer: this.$task_bg,\n\t\t\t\t\tfilter: [taskFilter]\n\t\t\t\t}\n\t\t\t];\n\n\t\t\tvar linkLayers = [];\n\n\t\t\treturn {\n\t\t\t\ttasks: taskLayers,\n\t\t\t\tlinks: linkLayers\n\t\t\t};\n\t\t}\n\n\t}, true);\n\n\tutils.mixin(ResourceHistogram.prototype, resourceStoreMixin(_super), true);\n\n\treturn ResourceHistogram;\n})(ResourceTimeline);\n\n\nexport default ResourceHistogram;\n\n\n","export default {\n\tinit: function (controller, grid) {\n\t\tvar gantt = grid.$gantt;\n\n\t\tgantt.attachEvent(\"onTaskClick\", function (id, e) {\n\t\t\tif (gantt._is_icon_open_click(e))\n\t\t\t\treturn true;\n\t\t\tvar state = controller.getState();\n\t\t\tvar cell = controller.locateCell(e.target);\n\n\t\t\tif (cell && controller.getEditorConfig(cell.columnName)) {\n\t\t\t\tif (controller.isVisible() && state.id == cell.id && state.columnName == cell.columnName) {\n\t\t\t\t\t// do nothing if editor is already active in this cell\n\t\t\t\t} else {\n\t\t\t\t\tcontroller.startEdit(cell.id, cell.columnName);\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\t\t//GS-2598: new resource control click handler\n\t\tif(grid.$config.id === \"GridRL\"){\n\t\t\tgantt.event(gantt.getLightbox(), \"click\", function (e) {\n\t\t\t\tconst domHelpers = gantt.utils.dom;\n\t\t\t\tconst state = controller.getState();\n\t\t\t\tconst cell = controller.locateCell(e.target);\n\t\t\t\t// click on the resource table\n\t\t\t\tif (cell && controller.getEditorConfig(cell.columnName)) {\n\t\t\t\t\t// validation for unassigned case\n\t\t\t\t\tif(cell.columnName == 'duration' || cell.columnName == 'end'){\n\t\t\t\t\t\tconst tempAssignmentStore = gantt.getDatastore(\"temp_resource_assignment_store\");\n\t\t\t\t\t\tconst assignment = tempAssignmentStore.getItem(cell.id);\n\t\t\t\t\t\tif(assignment){\n\t\t\t\t\t\t\tif(!assignment.start_date){\n\t\t\t\t\t\t\t\tgantt.message({\n\t\t\t\t\t\t\t\t\ttype:\"warning\",\n\t\t\t\t\t\t\t\t\ttext:\"Specify assignment start date\"\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tcontroller.hide();\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (controller.isVisible() && state.id == cell.id && state.columnName == cell.columnName) {\n\t\t\t\t\t// do nothing if editor is already active in this cell\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcontroller.startEdit(cell.id, cell.columnName);\n\t\t\t\t\t}\n\t\t\t\t\tif(controller.isChanged()){\n\t\t\t\t\t\tcontroller.save();\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t// do nothing if add resource button clicked\n\t\t\t\tif(domHelpers.closest(e.target, `.gantt_custom_button.gantt_add_resources`)){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// handle assignment deleting\n\t\t\t\tif(domHelpers.closest(e.target, `[data-assignment-delete]`)){\n\t\t\t\t\tconst assignmentId = e.target.getAttribute(\"data-assignment-delete\");\n\t\t\t\t\tgantt.confirm({\n\t\t\t\t\t\ttext: \"Resource assignment will be deleted permanently, are you sure?\",\n\t\t\t\t\t\tcancel:\"No\",\n\t\t\t\t\t\tok:\"Delete\", \n\t\t\t\t\t\tcallback: function(result){\n\t\t\t\t\t\t\tif(result){\n\t\t\t\t\t\t\t\tconst tempAssignmentStore = gantt.getDatastore(\"temp_resource_assignment_store\");\n\t\t\t\t\t\t\t\ttempAssignmentStore.removeItem(assignmentId);\n\t\t\t\t\t\t\t\t// handle deleting last grid row, \n\t\t\t\t\t\t\t\tif (tempAssignmentStore.getItems().length == 0){\n\t\t\t\t\t\t\t\t\tconst resourceSection = gantt.getLightboxSection(grid.$config.sectionName);\n\t\t\t\t\t\t\t\t\tconst block = gantt.form_blocks[\"resource_selector\"];\n\t\t\t\t\t\t\t\t\tconst node = gantt._lightbox_root.querySelector(\"#\" + resourceSection.section.id).nextSibling;\n\t\t\t\t\t\t\t\t\tblock.set_value.call(gantt, node, [], {}, resourceSection.section, true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tgantt.refreshData();\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t//click outside the resource table\n\t\t\t\tif(controller.isVisible()) {\n\t\t\t\t\tcontroller.save();\n\t\t\t\t\tcontroller.hide();\n\t\t\t\t} else {\n\t\t\t\t\tcontroller.hide();\n\t\t\t\t}\n\t\t\t});\n\t\t\t// before saving lightbox need to save controller value if its modified\n\t\t\t// covering date type inputs\n\t\t\tgantt.lightbox_events.gantt_save_btn = function () {\n\t\t\t\tcontroller.save();\n\t\t\t\tgantt._save_lightbox();\n\t\t\t};\n\t\t};\n\n\t\tgantt.attachEvent(\"onEmptyClick\", function () {\n\t\t\tif (controller.isVisible() && controller.isChanged()) {\n\t\t\t\tcontroller.save();\n\t\t\t} else {\n\t\t\t\tcontroller.hide();\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tgantt.attachEvent(\"onTaskDblClick\", function (id, e) {\n\t\t\tvar state = controller.getState();\n\t\t\tvar cell = controller.locateCell(e.target);\n\t\t\tif (cell && controller.isVisible() && cell.columnName == state.columnName) {\n\t\t\t\t//GS-933 probably, we don't need to hide the inline editor because the lightbox cannot be opened if you double-click on an inline editor\n\t\t\t\t//remove this code later if people don't complain\n\t\t\t\t//controller.hide();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\t},\n\n\tonShow: function (controller, placeholder, grid) {\n\t\tvar gantt = grid.$gantt;\n\t\t\n\n\t\tif(gantt.ext && gantt.ext.keyboardNavigation){\n\t\t\tvar keyNav = gantt.ext.keyboardNavigation;\n\t\t\tkeyNav.attachEvent(\"onKeyDown\", function(command, e){\n\t\t\t\tvar keyboard = gantt.constants.KEY_CODES;\n\t\t\t\tvar keyCode = e.keyCode;\n\t\t\t\tvar preventKeyNav = false;\n\n\t\t\t\tswitch (keyCode){\n\t\t\t\t\tcase keyboard.SPACE:\n\t\t\t\t\t\tif(controller.isVisible()){\n\t\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (preventKeyNav){\n\t\t\t\t\treturn false;\n\t\t\t\t} else{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t\n\t\tplaceholder.onkeydown = function (e) {\n\t\t\te = e || window.event;\n\n\t\t\tvar keyboard = gantt.constants.KEY_CODES;\n\t\t\tif (e.defaultPrevented || (e.shiftKey && e.keyCode != keyboard.TAB)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar shouldPrevent = true;\n\t\t\tswitch (e.keyCode) {\n\t\t\t\tcase gantt.keys.edit_save:\n\t\t\t\t\tcontroller.save();\n\t\t\t\t\tbreak;\n\t\t\t\tcase gantt.keys.edit_cancel:\n\t\t\t\t\tcontroller.hide();\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.UP:\n\t\t\t\tcase keyboard.DOWN:\n\t\t\t\t\tif (controller.isVisible()) {\n\t\t\t\t\t\tcontroller.hide();\n\t\t\t\t\t\tshouldPrevent = false;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.TAB:\n\t\t\t\t\tif (e.shiftKey) {\n\t\t\t\t\t\tcontroller.editPrevCell(true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcontroller.editNextCell(true);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tshouldPrevent = false;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (shouldPrevent) {\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t};\n\t\t// GS-2598: update inline editor in the lightbox\n\t\tif(grid.$config.id === \"GridRL\"){\n\t\t\tplaceholder.onkeyup = function (e) {\n\t\t\t\te = e || window.event;\n\n\t\t\t\tvar keyboard = gantt.constants.KEY_CODES;\n\t\t\t\tif (e.defaultPrevented || (e.shiftKey && e.keyCode != keyboard.TAB)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif(gantt._lightbox_id && controller.isChanged()){\n\t\t\t\t\tcontroller.save();\n\t\t\t\t}\n\t\t\t};\n\t\t\tlet timeout;\n\t\t\tplaceholder.onwheel = function (e) {\n\t\t\t\te = e || window.event;\n\t\t\t\tif(gantt._lightbox_id && controller.isChanged()){\n\t\t\t\t\tclearTimeout(timeout);\n\t\t\t\t\ttimeout=setTimeout(function(){\n\t\t\t\t\t\tcontroller.save();\n\t\t\t\t\t},100);\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t},\n\tonHide: function () {\n\n\t},\n\n\tdestroy: function () {\n\n\t}\n};\n\n","export default {\n\tinit: function(controller, grid){\n\t\tvar self = controller;\n\t\tvar gantt = grid.$gantt;\n\n\t\tvar onBlurDelay = null;\n\t\tvar keyNav = gantt.ext.keyboardNavigation;\n\t\tkeyNav.attachEvent(\"onBeforeFocus\", function (node) {\n\t\t\tvar activeCell = controller.locateCell(node);\n\t\t\tclearTimeout(onBlurDelay);\n\t\t\tif (activeCell) {\n\t\t\t\tvar columnName = activeCell.columnName;\n\t\t\t\tvar id = activeCell.id;\n\n\t\t\t\tvar editorState = self.getState();\n\t\t\t\tif(self.isVisible()){\n\t\t\t\t\tif(editorState.id == id && editorState.columnName === columnName) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tkeyNav.attachEvent(\"onFocus\", function (node) {\n\t\t\tvar activeCell = controller.locateCell(node);\n\t\t\tvar state = controller.getState();\n\t\t\tclearTimeout(onBlurDelay);\n\t\t\tif (activeCell && !(activeCell.id == state.id && activeCell.columnName == state.columnName)) {\n\t\t\t\tif(self.isVisible()){\n\t\t\t\t\tself.save();\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tcontroller.attachEvent(\"onHide\", function(){\n\t\t\tclearTimeout(onBlurDelay);\n\t\t});\n\n\t\tkeyNav.attachEvent(\"onBlur\", function () {\n\t\t\tonBlurDelay = setTimeout(function(){\n\t\t\t\tself.save();\n\t\t\t});\n\n\t\t\treturn true;\n\t\t});\n\n\t\tgantt.attachEvent(\"onTaskDblClick\", function(id,e){\n\t\t\t// block lightbox on double click inside editor\n\t\t\tvar state = controller.getState();\n\t\t\tvar cell = controller.locateCell(e.target);\n\t\t\tif(cell && controller.isVisible() && cell.columnName == state.columnName){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tgantt.attachEvent(\"onTaskClick\", function (id, e) {\n\t\t\tif(gantt._is_icon_open_click(e))\n\t\t\t\treturn true;\n\n\t\t\tvar state = controller.getState();\n\t\t\tvar cell = controller.locateCell(e.target);\n\n\t\t\tif (cell && controller.getEditorConfig(cell.columnName)) {\n\t\t\t\tif(controller.isVisible() && state.id == cell.id && state.columnName == cell.columnName){\n\t\t\t\t\t// do nothing if editor is already active in this cell\n\t\t\t\t}else{\n\t\t\t\t\tcontroller.startEdit(cell.id, cell.columnName);\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\t\tgantt.attachEvent(\"onEmptyClick\", function () {\n\t\t\tself.save();\n\t\t\treturn true;\n\t\t});\n\n\t\tkeyNav.attachEvent(\"onKeyDown\", function(command, e){\n\t\t\tvar activeCell = controller.locateCell(e.target);\n\t\t\tvar hasEditor = activeCell ? controller.getEditorConfig(activeCell.columnName) : false;\n\n\t\t\tvar state = controller.getState();\n\t\t\tvar keyboard = gantt.constants.KEY_CODES;\n\t\t\tvar keyCode = e.keyCode;\n\t\t\tvar preventKeyNav = false;\n\n\t\t\tswitch (keyCode){\n\t\t\t\tcase keyboard.ENTER:\n\t\t\t\t\tif(controller.isVisible()){\n\t\t\t\t\t\tcontroller.save();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}else if(hasEditor && !(e.ctrlKey || e.metaKey || e.shiftKey)){\n\t\t\t\t\t\tself.startEdit(activeCell.id, activeCell.columnName);\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.ESC:\n\t\t\t\t\tif(controller.isVisible()){\n\t\t\t\t\t\tcontroller.hide();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.UP:\n\t\t\t\tcase keyboard.DOWN:\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.LEFT:\n\t\t\t\tcase keyboard.RIGHT:\n\t\t\t\t\tif((hasEditor && controller.isVisible()) || state.editorType === \"date\"){\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.SPACE:\n\t\t\t\t\tif(controller.isVisible()){\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(hasEditor && !controller.isVisible()){\n\t\t\t\t\t\tself.startEdit(activeCell.id, activeCell.columnName);\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.DELETE:\n\t\t\t\t\tif(hasEditor && !controller.isVisible()){\n\t\t\t\t\t\tself.startEdit(activeCell.id, activeCell.columnName);\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t} else if(hasEditor && controller.isVisible()){\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.TAB:\n\t\t\t\t\tif(controller.isVisible()){\n\n\t\t\t\t\t\tif(e.shiftKey){\n\t\t\t\t\t\t\tcontroller.editPrevCell(true);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tcontroller.editNextCell(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar newState = controller.getState();\n\t\t\t\t\t\tif(newState.id){\n\t\t\t\t\t\t\tkeyNav.focus({type:\"taskCell\", id: newState.id, column:newState.columnName});\n\t\t\t\t\t\t}\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tif(controller.isVisible())\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\telse{\n\n\t\t\t\t\t\t// start editing on character key\n\t\t\t\t\t\tif((keyCode >= 48 && keyCode <= 57) || // [0-9]\n\t\t\t\t\t\t\t(keyCode > 95 && keyCode < 112) || // numpad\n\t\t\t\t\t\t\t(keyCode >= 64 && keyCode <= 91) || // [a-z]\n\t\t\t\t\t\t\t(keyCode > 185 && keyCode < 193) || //;=-,etc\n\t\t\t\t\t\t\t(keyCode > 218  && keyCode < 223)\n\t\t\t\t\t\t){\n\t\t\t\t\t\t\tvar modifiers = command.modifiers;\n\n\t\t\t\t\t\t\tvar anyModifier = modifiers.alt || modifiers.ctrl || modifiers.meta || modifiers.shift;\n\t\t\t\t\t\t\tif(modifiers.alt){\n\t\t\t\t\t\t\t\t// don't start editing on alt+key\n\t\t\t\t\t\t\t}else if (anyModifier && keyNav.getCommandHandler(command, \"taskCell\")){\n\t\t\t\t\t\t\t\t// don't start editing if command already have a keyboard shortcut\n\t\t\t\t\t\t\t}else if(hasEditor && !controller.isVisible()){\n\t\t\t\t\t\t\t\tself.startEdit(activeCell.id, activeCell.columnName);\n\t\t\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (preventKeyNav){\n\t\t\t\treturn false;\n\t\t\t} else{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t});\n\t},\n\tonShow: function(controller, placeholder, grid){},\n\tonHide: function(controller, placeholder, grid){\n\t\tconst gantt = grid.$gantt;\n\t\tif (gantt){\n\t\t\tgantt.focus();\n\t\t}\n\n\t},\n\tdestroy: function(){}\n};\n\n","export default function (gantt) {\n\n\tvar BaseEditor = function () {\n\t};\n\n\tBaseEditor.prototype = {\n\t\tshow: function (id, column, config, placeholder) {\n\t\t},\n\t\thide: function () {\n\t\t},\n\t\tset_value: function (value, id, column, node) {\n\t\t\tthis.get_input(node).value = value;\n\t\t},\n\t\tget_value: function (id, column, node) {\n\t\t\treturn this.get_input(node).value || \"\";\n\t\t},\n\t\tis_changed: function (value, id, column, node) {\n\t\t\tvar currentValue = this.get_value(id, column, node);\n\t\t\tif (currentValue && value && currentValue.valueOf && value.valueOf) {\n\t\t\t\treturn currentValue.valueOf() != value.valueOf();\n\t\t\t} else {\n\t\t\t\treturn currentValue != value;\n\t\t\t}\n\t\t},\n\t\tis_valid: function (value, id, column, node) {\n\t\t\treturn true;\n\t\t},\n\n\t\tsave: function (id, column, node) {\n\n\t\t},\n\t\tget_input: function (node) {\n\t\t\treturn node.querySelector(\"input\");\n\t\t},\n\t\tfocus: function (node) {\n\t\t\tvar input = this.get_input(node);\n\t\t\tif (!input) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (input.focus) {\n\t\t\t\tinput.focus();\n\t\t\t}\n\n\t\t\tif (input.select) {\n\t\t\t\tinput.select();\n\t\t\t}\n\t\t}\n\t};\n\treturn BaseEditor;\n};","import BaseFactory from \"./base\";\nimport * as utils from \"../../../../../utils/utils\";\nimport __extends from \"../../../../../utils/extends\";\n\n\nexport default function(gantt) {\n\n\tvar BaseEditor = BaseFactory(gantt);\n\n\tfunction TextEditor() {\n\t\tvar self = BaseEditor.apply(this, arguments) || this;\n\t\treturn self;\n\t}\n\n\t__extends(TextEditor, BaseEditor);\n\n\tutils.mixin(TextEditor.prototype, {\n\t\tshow: function (id, column, config, placeholder) {\n\t\t\tvar html = `<div role='cell'><input type='text' name='${column.name}' title='${column.name}'></div>`;\n\t\t\tplaceholder.innerHTML = html;\n\t\t}\n\t}, true);\n\n\treturn TextEditor;\n};","import BaseFactory from \"./base\";\nimport * as utils from \"../../../../../utils/utils\";\nimport __extends from \"../../../../../utils/extends\";\n\n\nexport default function(gantt) {\n\n\tvar BaseEditor = BaseFactory(gantt);\n\n\tfunction NumberEditor() {\n\t\tvar self = BaseEditor.apply(this, arguments) || this;\n\t\treturn self;\n\t}\n\n\t__extends(NumberEditor, BaseEditor);\n\n\tutils.mixin(NumberEditor.prototype, {\n\t\tshow: function (id, column, config, placeholder) {\n\t\t\tvar min = config.min || 0,\n\t\t\t\tmax = config.max || 100;\n\n\t\t\tvar html = `<div role='cell'><input type='number' min='${min}' max='${max}' name='${column.name}' title='${column.name}'></div>`;\n\t\t\tplaceholder.innerHTML = html;\n\n\t\t\t// GS-1914. Do not allow entering alues beyond min and max via keyboard\n\t\t\tplaceholder.oninput = function (e) {\n\t\t\t\tif (+e.target.value < min) {\n\t\t\t\t\te.target.value = min;\n\t\t\t\t}\n\t\t\t\tif (+e.target.value > max) {\n\t\t\t\t\te.target.value = max;\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tget_value: function (id, column, node) {\n\t\t\treturn this.get_input(node).value || \"\";\n\t\t},\n\t\tis_valid: function (value, id, column, node) {\n\t\t\treturn !isNaN(parseInt(value, 10));\n\t\t}\n\t}, true);\n\n\treturn NumberEditor;\n};","import BaseFactory from \"./base\";\nimport * as utils from \"../../../../../utils/utils\";\nimport __extends from \"../../../../../utils/extends\";\n\n\nexport default function(gantt) {\n\n\tvar BaseEditor = BaseFactory(gantt);\n\n\tfunction SelectEditor() {\n\t\tvar self = BaseEditor.apply(this, arguments) || this;\n\t\treturn self;\n\t}\n\n\t__extends(SelectEditor, BaseEditor);\n\n\tutils.mixin(SelectEditor.prototype, {\n\t\tshow: function (id, column, config, placeholder) {\n\t\t\tvar html = `<div role='cell'><select name='${column.name}' title='${column.name}'>`;\n\t\t\tvar optionsHtml = [],\n\t\t\t\toptions = config.options || [];\n\n\t\t\tfor (var i = 0; i < options.length; i++) {\n\t\t\t\toptionsHtml.push(\"<option value='\" + config.options[i].key + \"'>\" + options[i].label + \"</option>\");\n\t\t\t}\n\n\t\t\thtml += optionsHtml.join(\"\") + \"</select></div>\";\n\t\t\tplaceholder.innerHTML = html;\n\t\t},\n\t\tget_input: function (node) {\n\t\t\treturn node.querySelector(\"select\");\n\t\t}\n\t}, true);\n\n\treturn SelectEditor;\n};","import * as utils from \"../../../../../utils/utils\";\nimport __extends from \"../../../../../utils/extends\";\nimport BaseFactory from \"./base\";\n\nexport default function (gantt) {\n\tvar BaseEditor = BaseFactory(gantt);\n\t\n\t\n\n\tvar html5DateFormat = \"%Y-%m-%d\";\n\n\tvar dateToStr = null;\n\tvar strToDate = null;\n\n\tfunction init() {\n\t\tif (!dateToStr) {\n\t\t\tdateToStr = gantt.date.date_to_str(html5DateFormat);\n\t\t}\n\t\tif (!strToDate) {\n\t\t\tstrToDate = gantt.date.str_to_date(html5DateFormat);\n\t\t}\n\t}\n\n\tfunction DateEditor() {\n\t\tvar self = BaseEditor.apply(this, arguments) || this;\n\n\t\treturn self;\n\t}\n\n\t__extends(DateEditor, BaseEditor);\n\n\tutils.mixin(DateEditor.prototype, {\n\t\tshow: function (id, column, config, placeholder) {\n\t\t\tinit();\n\t\t\tvar minValue = null;\n\t\t\tvar maxValue = null;\n\n\t\t\tif(typeof config.min === \"function\"){\n\t\t\t\tminValue = config.min(id, column);\n\t\t\t}else{\n\t\t\t\tminValue = config.min;\n\t\t\t}\n\n\t\t\tif(typeof config.max === \"function\"){\n\t\t\t\tmaxValue = config.max(id, column);\n\t\t\t}else{\n\t\t\t\tmaxValue = config.max;\n\t\t\t}\n\n\t\t\tvar minAttr = minValue ? \" min='\" + dateToStr(minValue)+\"' \"  : \"\";\n\t\t\tvar maxAttr = maxValue ? \" max='\" + dateToStr(maxValue)+\"' \"  : \"\";\n\t\t\tvar html = `<div style='width:140px' role='cell'><input type='date' ${minAttr} ${maxAttr} name='${column.name}' title='${column.name}'></div>`;\n\t\t\tplaceholder.innerHTML = html;\n\n\t\t\t// GS-1914. Do not allow entering alues beyond min and max via keyboard\n\t\t\tplaceholder.oninput = function (e) {\n\t\t\t\tif (e.target.value && (minValue || maxValue)){\n\t\t\t\t\tif (+gantt.date.str_to_date(\"%Y-%m-%d\")(e.target.value) < +minValue) {\n\t\t\t\t\t\te.target.value = gantt.date.date_to_str(\"%Y-%m-%d\")(minValue);\n\t\t\t\t\t}\n\t\t\t\t\tif (+gantt.date.str_to_date(\"%Y-%m-%d\")(e.target.value) > +maxValue) {\n\t\t\t\t\t\te.target.value = gantt.date.date_to_str(\"%Y-%m-%d\")(maxValue);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tset_value: function (value, id, column, node) {\n\t\t\tif (value && value.getFullYear) {\n\t\t\t\tthis.get_input(node).value = dateToStr(value);\n\t\t\t} else {\n\t\t\t\tthis.get_input(node).value = value;\n\t\t\t}\n\t\t},\n\t\tis_valid: function (value, id, column, node) {\n\t\t\tif (!value || isNaN(value.getTime()))\n\t\t\t\treturn false;\n\t\t\treturn true;\n\t\t},\n\t\tget_value: function (id, column, node) {\n\t\t\tvar parsed;\n\t\t\ttry {\n\t\t\t\tparsed = strToDate(this.get_input(node).value || \"\");\n\t\t\t} catch (e) {\n\t\t\t\tparsed = null;// return null will cancel changes\n\t\t\t}\n\n\t\t\treturn parsed;\n\t\t}\n\t}, true);\n\n\treturn DateEditor;\n};\n","import BaseFactory from \"./base\";\nimport * as utils from \"../../../../../utils/utils\";\nimport __extends from \"../../../../../utils/extends\";\n\n\nexport default function(gantt) {\n\n\tvar BaseEditor = BaseFactory(gantt);\n\n\tfunction PredecessorEditor() {\n\t\tvar self = BaseEditor.apply(this, arguments) || this;\n\t\treturn self;\n\t}\n\n\t__extends(PredecessorEditor, BaseEditor);\n\n\tfunction getFormatter(config) {\n\t\treturn config.formatter || gantt.ext.formatters.linkFormatter();\n\t}\n\n\tfunction parseInputString(value, config) {\n\t\tvar predecessors = (value || \"\").split(config.delimiter || \",\");\n\t\tfor (var i = 0; i < predecessors.length; i++) {\n\t\t\tvar val = predecessors[i].trim();\n\t\t\tif (val) {\n\t\t\t\tpredecessors[i] = val;\n\t\t\t} else {\n\t\t\t\tpredecessors.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t\tpredecessors.sort();\n\t\treturn predecessors;\n\t}\n\n\tfunction formatPredecessors(task, config, gantt) {\n\t\tvar links = task.$target;\n\t\tvar labels = [];\n\t\tfor (var i = 0; i < links.length; i++) {\n\t\t\tvar link = gantt.getLink(links[i]);\n\t\t\tlabels.push(getFormatter(config).format(link));\n\t\t}\n\t\treturn labels.join((config.delimiter || \",\") + \" \");\n\t}\n\n\tfunction getSelectedLinks(taskId, predecessorCodes, config) {\n\t\tvar links = [];\n\t\t// select only unique codes GS-1439\n\t\t[...new Set(predecessorCodes)].forEach(function (code) {\n\t\t\tvar link = getFormatter(config).parse(code);\n\t\t\tif(link){\n\t\t\t\tlink.target = taskId;\n\t\t\t\t// GS-1290 A way to preserve the link. Otherwise validation will return false\n\t\t\t\t// because the existing link ID is not passed there\n\t\t\t\tlink.id = \"predecessor_generated\";\n\t\t\t\tif (gantt.isLinkAllowed(link)) {\n\t\t\t\t\tlink.id = undefined;\n\t\t\t\t\tlinks.push(link);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\treturn links;\n\t}\n\n\tfunction formatLinkKey(link){\n\t\treturn link.source + \"_\" + link.target + \"_\" + link.type + \"_\" + (link.lag||0);\n\t}\n\n\tfunction getLinksDiff(task, predecessorCodes, config) {\n\t\tvar selectedLinks = getSelectedLinks(task.id, predecessorCodes, config);\n\t\tvar existingLinksSearch = {};\n\t\ttask.$target.forEach(function (linkId) {\n\t\t\tvar link = gantt.getLink(linkId);\n\t\t\texistingLinksSearch[formatLinkKey(link)] = link.id;\n\t\t});\n\n\t\tvar linksToAdd = [];\n\t\tselectedLinks.forEach(function (link) {\n\t\t\tvar linkKey = formatLinkKey(link);\n\t\t\tif (!existingLinksSearch[linkKey]) {\n\t\t\t\tlinksToAdd.push(link);\n\t\t\t} else {\n\t\t\t\tdelete existingLinksSearch[linkKey];\n\t\t\t}\n\t\t});\n\n\t\tvar linksToDelete = [];\n\t\tfor (var i in existingLinksSearch) {\n\t\t\tlinksToDelete.push(existingLinksSearch[i]);\n\t\t}\n\n\t\treturn {\n\t\t\tadd: linksToAdd,\n\t\t\tremove: linksToDelete\n\t\t};\n\t}\n\n\tutils.mixin(PredecessorEditor.prototype, {\n\t\tshow: function (id, column, config, placeholder) {\n\t\t\tvar html = `<div role='cell'><input type='text' name='${column.name}' title='${column.name}'></div>`;\n\t\t\tplaceholder.innerHTML = html;\n\t\t},\n\t\thide: function () {\n\t\t},\n\t\tset_value: function (value, id, column, node) {\n\t\t\tthis.get_input(node).value = formatPredecessors(value, column.editor, gantt);\n\t\t},\n\t\tget_value: function (id, column, node) {\n\t\t\treturn parseInputString((this.get_input(node).value || \"\"), column.editor);\n\t\t},\n\t\tsave: function (id, column, node) {\n\t\t\tvar task = gantt.getTask(id);\n\n\t\t\tvar linksDiff = getLinksDiff(task, this.get_value(id, column, node), column.editor);\n\n\t\t\tif (linksDiff.add.length || linksDiff.remove.length) {\n\t\t\t\tgantt.batchUpdate(function () {\n\t\t\t\t\tlinksDiff.add.forEach(function (link) {\n\t\t\t\t\t\tgantt.addLink(link);\n\t\t\t\t\t});\n\t\t\t\t\tlinksDiff.remove.forEach(function (linkId) {\n\t\t\t\t\t\tgantt.deleteLink(linkId);\n\t\t\t\t\t});\n\n\t\t\t\t\tif (gantt.autoSchedule)\n\t\t\t\t\t\tgantt.autoSchedule();\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tis_changed: function (value, id, column, node) {\n\t\t\tvar inputPredecessors = this.get_value(id, column, node);\n\t\t\tvar taskPredecessors = parseInputString(formatPredecessors(value, column.editor, gantt), column.editor);\n\n\t\t\treturn inputPredecessors.join() !== taskPredecessors.join();\n\t\t}\n\t}, true);\n\n\treturn PredecessorEditor;\n};","import BaseFactory from \"./base\";\nimport * as utils from \"../../../../../utils/utils\";\nimport __extends from \"../../../../../utils/extends\";\n\n\nexport default function(gantt) {\n\n\tvar BaseEditor = BaseFactory(gantt);\n\n\tfunction TextEditor() {\n\t\tvar self = BaseEditor.apply(this, arguments) || this;\n\t\treturn self;\n\t}\n\n\t__extends(TextEditor, BaseEditor);\n\n\tfunction getFormatter(config) {\n\t\treturn config.formatter || gantt.ext.formatters.durationFormatter();\n\t}\n\tutils.mixin(TextEditor.prototype, {\n\t\tshow: function (id, column, config, placeholder) {\n\t\t\tvar html = `<div role='cell'><input type='text' name='${column.name}' title='${column.name}'></div>`;\n\t\t\tplaceholder.innerHTML = html;\n\t\t},\n\t\tset_value: function (value, id, column, node) {\n\t\t\tthis.get_input(node).value = getFormatter(column.editor).format(value);\n\t\t},\n\t\tget_value: function (id, column, node) {\n\t\t\treturn getFormatter(column.editor).parse(this.get_input(node).value || \"\");\n\t\t}\n\t}, true);\n\n\treturn TextEditor;\n};","export default function (gantt) {\n\treturn function processTaskDateProperties(item, mapTo, mode) {\n\t\tif (mode == \"keepDates\") {\n\t\t\tkeepDatesOnEdit(item, mapTo);\n\t\t} else if (mode == \"keepDuration\") {\n\t\t\tkeepDurationOnEdit(item, mapTo);\n\t\t} else {\n\t\t\tdefaultActionOnEdit(item, mapTo);\n\t\t}\n\t};\n\n\t// resize task\n\t// resize task when start/end/duration changes\n\tfunction keepDatesOnEdit(item, mapTo) {\n\t\tif (mapTo == \"duration\") {\n\t\t\titem.end_date = gantt.calculateEndDate(item);\n\t\t} else if (mapTo == \"end_date\" || mapTo == \"start_date\") {\n\t\t\titem.duration = gantt.calculateDuration(item);\n\t\t}\n\t}\n\n\t// move task(before 6.2)\n\t// move task when start/end dates changes\n\t// resize task when duration changes\n\tfunction keepDurationOnEdit(item, mapTo) {\n\t\tif (mapTo == \"end_date\") {\n\t\t\titem.start_date = decreaseStartDate(item);\n\t\t} else if (mapTo == \"start_date\" || mapTo == \"duration\") {\n\t\t\titem.end_date = gantt.calculateEndDate(item);\n\t\t}\n\t}\n\n\t// default behavior\n\t// move task when start date changes\n\t// resize task when end date/duration changes\n\tfunction defaultActionOnEdit(item, mapTo) {\n\t\tif (gantt._getAutoSchedulingConfig().schedule_from_end){\n\t\t\tif (mapTo == \"end_date\" || mapTo == \"duration\") {\n\t\t\t\titem.start_date = decreaseStartDate(item);\n\t\t\t} else if (mapTo == \"start_date\") {\n\t\t\t\titem.duration = gantt.calculateDuration(item);\n\t\t\t}\n\t\t} else {\n\t\t\tif (mapTo == \"start_date\" || mapTo == \"duration\") {\n\t\t\t\titem.end_date = gantt.calculateEndDate(item);\n\t\t\t} else if (mapTo == \"end_date\") {\n\t\t\t\titem.duration = gantt.calculateDuration(item);\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction decreaseStartDate(item){\n\t\treturn gantt.calculateEndDate({\n\t\t\tstart_date: item.end_date,\n\t\t\tduration: -item.duration,\n\t\t\ttask: item\n\t\t});\n\t}\n};","import getKeyboardMapping from \"./keyboard_mappings\";\nimport textEditorFactory from \"./editors/text\";\nimport numberEditorFactory from \"./editors/number\";\nimport selectEditorFactory from \"./editors/select\";\nimport dateEditorFactory from \"./editors/date\";\nimport predecessorEditorFactory from \"./editors/predecessor\";\nimport durationEditorFactory from \"./editors/duration\";\nimport * as utils from \"../../../../utils/utils\";\nimport * as domHelpers from \"../../utils/dom_helpers\";\nimport eventable from \"../../../../utils/eventable\";\nimport linkedPropertiesProcessor from \"./linked_properties\";\n\nfunction initConfigs(gantt){\n\tgantt.config.editor_types = {\n\t\ttext: new (textEditorFactory(gantt))(),\n\t\tnumber: new (numberEditorFactory(gantt))(),\n\t\tselect: new (selectEditorFactory(gantt))(),\n\t\tdate: new (dateEditorFactory(gantt))(),\n\t\tpredecessor: new (predecessorEditorFactory(gantt))(),\n\t\tduration: new (durationEditorFactory(gantt))()\n\t};\n}\n\nfunction create(gantt){\n\tvar keyboardMapping = getKeyboardMapping(gantt);\n\n\tvar eventBus = {};\n\teventable(eventBus);\n\n\tfunction createGridEditors(grid) {\n\n\t\tfunction _getGridCellFromNode(node){\n\t\t\tif(!domHelpers.isChildOf(node, grid.$grid)){\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tvar row = domHelpers.locateAttribute(node, grid.$config.item_attribute);\n\t\t\tvar cell = domHelpers.locateAttribute(node, \"data-column-name\");\n\t\t\tif(row && cell){\n\t\t\t\tvar columnName = cell.getAttribute(\"data-column-name\");\n\t\t\t\tvar id = row.getAttribute(grid.$config.item_attribute);\n\t\t\t\treturn {\n\t\t\t\t\tid: id,\n\t\t\t\t\tcolumnName: columnName\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn null;\n\n\t\t}\n\n\t\tfunction _getEditorPosition(itemId, columnName) {\n\t\t\tvar config = grid.$getConfig();\n\t\t\tvar top = grid.getItemTop(itemId);\n\t\t\tvar height = grid.getItemHeight(itemId);\n\t\t\tvar cols = grid.getGridColumns();\n\t\t\tvar left = 0,\n\t\t\t\tright = 0,\n\t\t\t\twidth = 0;\n\n\t\t\tfor (var i = 0; i < cols.length; i++) {\n\t\t\t\tif (cols[i].name == columnName) {\n\t\t\t\t\twidth = cols[i].width;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (config.rtl) {\n\t\t\t\t\tright += cols[i].width;\n\t\t\t\t}\telse {\n\t\t\t\t\tleft += cols[i].width;\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tif (config.rtl) {\n\t\t\t\treturn {\n\t\t\t\t\ttop: top,\n\t\t\t\t\tright: right,\n\t\t\t\t\theight: height,\n\t\t\t\t\twidth: width\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn {\n\t\t\t\t\ttop: top,\n\t\t\t\t\tleft: left,\n\t\t\t\t\theight: height,\n\t\t\t\t\twidth: width\n\t\t\t\t};\n\t\t\t}\n\n\t\t}\n\n\t\tfunction findVisibleIndex(grid, columnName) {\n\t\t\tvar columns = grid.getGridColumns();\n\t\t\tfor (var i = 0; i < columns.length; i++){\n\t\t\t\tif(columns[i].name == columnName){\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn 0;\n\t\t}\n\n\t\tfunction _createPlaceholder(itemId, columnName) {\n\t\t\tvar config = grid.$getConfig();\n\t\t\tvar pos = _getEditorPosition(itemId, columnName);\n\t\t\tvar el = document.createElement(\"div\");\n\t\t\tel.className = \"gantt_grid_editor_placeholder\";\n\t\t\tel.setAttribute(grid.$config.item_attribute, itemId);\n\t\t\tel.setAttribute(grid.$config.bind + \"_id\", itemId);// for backward compatibility\n\n\t\t\tel.setAttribute(\"data-column-name\", columnName);\n\n\t\t\tvar visibleIndex = findVisibleIndex(grid, columnName);\n\t\t\tel.setAttribute(\"data-column-index\", visibleIndex);\n\n\t\t\tgantt._waiAria.inlineEditorAttr(el);\n\n\t\t\tif (config.rtl) {\n\t\t\t\tel.style.cssText = [\n\t\t\t\t\t\"top:\" + pos.top + \"px\",\n\t\t\t\t\t\"right:\" + pos.right + \"px\",\n\t\t\t\t\t\"width:\" + pos.width + \"px\",\n\t\t\t\t\t\"height:\" + pos.height + \"px\"\n\t\t\t\t].join(\";\");\n\t\t\t} else {\n\t\t\t\tel.style.cssText = [\n\t\t\t\t\t\"top:\" + pos.top + \"px\",\n\t\t\t\t\t\"left:\" + pos.left + \"px\",\n\t\t\t\t\t\"width:\" + pos.width + \"px\",\n\t\t\t\t\t\"height:\" + pos.height + \"px\"\n\t\t\t\t].join(\";\");\n\t\t\t}\n\n\t\t\treturn el;\n\t\t}\n\n\t\tvar updateTaskDateProperties = linkedPropertiesProcessor(gantt);\n\n\t\tvar handlers = [];\n\t\tvar ganttHandlers = [];\n\t\tvar store = null;\n\t\tvar controller = {\n\t\t\t_itemId: null,\n\t\t\t_columnName: null,\n\t\t\t_editor: null,\n\t\t\t_editorType: null,\n\t\t\t_placeholder: null,\n\n\t\t\tlocateCell: _getGridCellFromNode,\n\t\t\tgetEditorConfig: function (columnName) {\n\t\t\t\tvar column = grid.getColumn(columnName);\n\t\t\t\tif(column){\n\t\t\t\t\treturn column.editor;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tinit: function () {\n\t\t\t\tvar mapping = keyboardMapping.getMapping();\n\t\t\t\tif(mapping.init){\n\t\t\t\t\tmapping.init(this, grid);\n\t\t\t\t}\n\n\t\t\t\tstore = grid.$gantt.getDatastore(grid.$config.bind);\n\t\t\t\tif (!store && gantt.$data.tempAssignmentsStore){\n\t\t\t\t\tstore = gantt.$data.tempAssignmentsStore;\n\t\t\t\t}\n\n\t\t\t\tvar self = this;\n\n\t\t\t\thandlers.push(store.attachEvent(\"onIdChange\", function(oldId, newId){\n\t\t\t\t\tif(self._itemId == oldId){\n\t\t\t\t\t\tself._itemId = newId;\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t\thandlers.push(store.attachEvent(\"onStoreUpdated\", function(){\n\t\t\t\t\tif(grid.$gantt.getState(\"batchUpdate\").batch_update){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(self.isVisible() && !store.isVisible(self._itemId)){\n\t\t\t\t\t\tself.hide();\n\t\t\t\t\t}\n\t\t\t\t}));\n\n\t\t\t\tganttHandlers.push(gantt.attachEvent(\"onDataRender\", function(){\n\t\t\t\t\tif(self._editor && self._placeholder && !domHelpers.isChildOf(self._placeholder, gantt.$root)){\n\t\t\t\t\t\tgrid.$grid_data.appendChild(self._placeholder);\n\t\t\t\t\t}\n\t\t\t\t}));\n\n\t\t\t\tthis.init = function(){};\n\t\t\t},\n\n\t\t\tgetState: function(){\n\t\t\t\treturn {\n\t\t\t\t\teditor: this._editor,\n\t\t\t\t\teditorType: this._editorType,\n\t\t\t\t\tplaceholder: this._placeholder,\n\t\t\t\t\tid: this._itemId,\n\t\t\t\t\tcolumnName: this._columnName\n\t\t\t\t};\n\t\t\t},\n\n\t\t\tstartEdit: function(itemId, columnName) {\n\t\t\t\tif (this.isVisible()) {\n\t\t\t\t\tthis.save();\n\t\t\t\t}\n\n\t\t\t\tif(!store.exists(itemId)){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar editorState = {id: itemId, columnName: columnName};\n\t\t\t\tif (gantt.isReadonly(store.getItem(itemId))) {\n\t\t\t\t\tthis.callEvent(\"onEditPrevent\", [editorState]);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (this.callEvent(\"onBeforeEditStart\", [editorState]) === false) {\n\t\t\t\t\tthis.callEvent(\"onEditPrevent\", [editorState]);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst asyncShow = this.show(editorState.id, editorState.columnName);\n\t\t\t\tif(asyncShow && asyncShow.then){\n\t\t\t\t\tasyncShow.then(function(){\n\t\t\t\t\t\tthis.setValue();\n\n\t\t\t\t\t\tthis.callEvent(\"onEditStart\", [editorState]);\n\t\t\t\t\t}.bind(this));\n\t\t\t\t}else{\n\t\t\t\t\tthis.setValue();\n\t\t\t\t\tthis.callEvent(\"onEditStart\", [editorState]);\n\t\t\t\t}\n\t\t\t},\n\t\t\tisVisible: function(){\n\t\t\t\tif(gantt._lightbox_id){\n\t\t\t\t\treturn !!(this._editor && domHelpers.isChildOf(this._placeholder, gantt._lightbox));\n\t\t\t\t}\n\t\t\t\treturn !!(this._editor && domHelpers.isChildOf(this._placeholder, gantt.$root));\n\t\t\t},\n\t\t\tshow: function (itemId, columnName) {\n\t\t\t\tif (this.isVisible()) {\n\t\t\t\t\tthis.save();\n\t\t\t\t}\n\t\t\t\tvar editorState = {id: itemId, columnName: columnName};\n\n\t\t\t\tvar column = grid.getColumn(editorState.columnName);\n\t\t\t\tvar editorConfig = this.getEditorConfig(column.name);\n\t\t\t\tif(!editorConfig)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar editor = grid.$getConfig().editor_types[editorConfig.type];\n\n\t\t\t\tvar placeholder = _createPlaceholder(editorState.id, editorState.columnName);\n\t\t\t\tgrid.$grid_data.appendChild(placeholder);\n\n\t\t\t\tconst onAfterShow = (function(){\n\t\t\t\t\tthis._editor = editor;\n\t\t\t\t\tthis._placeholder = placeholder;\n\t\t\t\t\tthis._itemId = editorState.id;\n\t\t\t\t\tthis._columnName = editorState.columnName;\n\t\t\t\t\tthis._editorType = editorConfig.type;\n\n\t\t\t\t\tvar mapping = keyboardMapping.getMapping();\n\t\t\t\t\tif(mapping.onShow){\n\t\t\t\t\t\tmapping.onShow(this, placeholder, grid);\n\t\t\t\t\t}\n\t\t\t\t\tplaceholder._onReMount = (function(){\n\t\t\t\t\t\tthis.setValue();\n\t\t\t\t\t}).bind(this);\n\t\t\t\t}).bind(this);\n\n\t\t\t\tconst editorResult = editor.show(editorState.id, column, editorConfig, placeholder);\n\t\t\t\tif(editorResult && editorResult.then){\n\t\t\t\t\treturn editorResult.then(() => {\n\t\t\t\t\t\tonAfterShow();\n\t\t\t\t\t});\n\t\t\t\t}else{\n\t\t\t\t\tonAfterShow();\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tsetValue: function () {\n\t\t\t\tvar state = this.getState();\n\t\t\t\tvar itemId = state.id,\n\t\t\t\t\tcolumnName = state.columnName;\n\n\t\t\t\tvar column = grid.getColumn(columnName);\n\t\t\t\tvar item = store.getItem(itemId);\n\t\t\t\tvar editorConfig = this.getEditorConfig(columnName);\n\t\t\t\tvar value;\n\t\t\t\tif(!editorConfig)\n\t\t\t\t\treturn;\n\t\t\t\t// GS-2598: case for the editors in the lightbox\n\t\t\t\tif (gantt._lightbox_id) {\n\t\t\t\t\tlet assignment = store.getItem(this._itemId);\n\n\t\t\t\t\tif (editorConfig.map_to === \"text\") {\n\t\t\t\t\t\tlet resource = gantt.getDatastore(gantt.config.resource_store).getItem(assignment.resource_id);\n\t\t\t\t\t\tvalue = resource.text;\n\t\t\t\t\t} else if (editorConfig.map_to === \"start_date\") {\n\t\t\t\t\t\tvalue = (item.start_date === \"\" || item.start_date === null)\n\t\t\t\t\t\t\t? gantt.getTask(gantt._lightbox_id).start_date\n\t\t\t\t\t\t\t: item.start_date;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalue = item[editorConfig.map_to];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvalue = item[editorConfig.map_to];\n\t\t\t\t}\n\n\t\t\t\tif (editorConfig.map_to === \"auto\") {\n\t\t\t\t\tvalue = store.getItem(itemId);\n\t\t\t\t}\n\n\t\t\t\tthis._editor.set_value(value, itemId, column, this._placeholder);\n\t\t\t\tthis.focus();\n\t\t\t},\n\n\t\t\tfocus: function(){\n\t\t\t\tthis._editor.focus(this._placeholder);\n\t\t\t},\n\n\t\t\tgetValue: function () {\n\t\t\t\tvar column = grid.getColumn(this._columnName);\n\t\t\t\treturn this._editor.get_value(this._itemId, column, this._placeholder);\n\t\t\t},\n\n\t\t\t_getItemValue: function() {\n\t\t\t\tvar editorConfig = this.getEditorConfig(this._columnName);\n\n\t\t\t\tif(!editorConfig)\n\t\t\t\t\treturn;\n\t\t\t\tvar value;\n\t\t\t\t// GS-2598: case for the editors in the lightbox\n\t\t\t\tif(gantt._lightbox_id){\n\t\t\t\t\tlet assignment = store.getItem(this._itemId);\n\t\t\t\t\tif (editorConfig.type === \"select\" && editorConfig.map_to !== \"mode\") {\n\t\t\t\t\t\tlet resource = gantt.getDatastore(gantt.config.resource_store).getItem(assignment.resource_id);\n\t\t\t\t\t\tvalue = resource.id;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalue = assignment[editorConfig.map_to];\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\t\t\t\t\tvar item = gantt.getTask(this._itemId);\n\t\t\t\t\tvalue = item[editorConfig.map_to];\n\t\t\t\t}\n\n\t\t\t\tif(editorConfig.map_to == \"auto\"){\n\t\t\t\t\tvalue = store.getItem(this._itemId);\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t},\n\n\t\t\tisChanged: function(){\n\n\t\t\t\tvar column = grid.getColumn(this._columnName);\n\n\t\t\t\tvar value = this._getItemValue();\n\n\t\t\t\treturn this._editor.is_changed(value, this._itemId, column, this._placeholder);\n\t\t\t},\n\n\t\t\thide: function () {\n\t\t\t\tif(!this._itemId)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar itemId = this._itemId,\n\t\t\t\t\tcolumnName = this._columnName;\n\n\t\t\t\tvar mapping = keyboardMapping.getMapping();\n\t\t\t\tif(mapping.onHide){\n\t\t\t\t\tmapping.onHide(this, this._placeholder, grid);\n\t\t\t\t}\n\n\t\t\t\tthis._itemId = null;\n\t\t\t\tthis._columnName = null;\n\t\t\t\tthis._editorType = null;\n\t\t\t\tif (!this._placeholder) return;\n\n\t\t\t\tif (this._editor && this._editor.hide) {\n\t\t\t\t\tthis._editor.hide(this._placeholder);\n\t\t\t\t}\n\t\t\t\tthis._editor = null;\n\t\t\t\tif (this._placeholder.parentNode) {\n\t\t\t\t\tthis._placeholder.parentNode.removeChild(this._placeholder);\n\t\t\t\t}\n\t\t\t\tthis._placeholder = null;\n\n\t\t\t\tthis.callEvent(\"onEditEnd\", [{id: itemId, columnName: columnName}]);\n\t\t\t},\n\t\t\tsave: function () {\n\t\t\t\tif(!(this.isVisible() && store.exists(this._itemId) && this.isChanged())) {\n\t\t\t\t\tthis.hide();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar itemId = this._itemId,\n\t\t\t\t\tcolumnName = this._columnName;\n\n\t\t\t\tif(!store.exists(itemId)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar item = store.getItem(itemId);\n\t\t\t\tvar editorConfig = this.getEditorConfig(columnName);\n\t\t\t\tvar editorState = {\n\t\t\t\t\tid: itemId,\n\t\t\t\t\tcolumnName: columnName,\n\t\t\t\t\tnewValue: this.getValue(),\n\t\t\t\t\toldValue: this._getItemValue()\n\t\t\t\t};\n\t\t\t\tif (this.callEvent(\"onBeforeSave\", [editorState]) !== false) {\n\t\t\t\t\tif (!this._editor.is_valid || this._editor.is_valid(editorState.newValue, editorState.id, grid.getColumn(columnName), this._placeholder)) {\n\t\t\t\t\t\t// GS-2598: set the initial value to the editor\n\t\t\t\t\t\tif(gantt._lightbox_id){\n\t\t\t\t\t\t\tif (editorState.newValue == \"\"){\n\t\t\t\t\t\t\t\teditorState.newValue = editorState.oldValue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar mapTo = editorConfig.map_to;\n\t\t\t\t\t\tvar value = editorState.newValue;\n\t\t\t\t\t\tif (mapTo != \"auto\") {\n\t\t\t\t\t\t\titem[mapTo] = value;\n\t\t\t\t\t\t\tupdateTaskDateProperties(item, mapTo, gantt.config.inline_editors_date_processing);\n\n\t\t\t\t\t\t\tstore.updateItem(itemId);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._editor.save(itemId, grid.getColumn(columnName), this._placeholder);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.callEvent(\"onSave\", [editorState]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// GS-2598: don't close editor when we working in the lightbox\n\t\t\t\tif(!gantt._lightbox_id){\n\t\t\t\t\tthis.hide();\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t_findEditableCell: function findEditableCell(start, direction){\n\t\t\t\tvar nextIndex = start;\n\t\t\t\tvar columns = grid.getGridColumns();\n\t\t\t\tvar nextColumn = columns[nextIndex];\n\n\t\t\t\tvar columnName = nextColumn ? nextColumn.name : null;\n\t\t\t\tif(columnName){\n\t\t\t\t\twhile(columnName && !this.getEditorConfig(columnName)){\n\t\t\t\t\t\tcolumnName = this._findEditableCell(start + direction, direction);\n\t\t\t\t\t}\n\t\t\t\t\treturn columnName;\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t},\n\n\t\t\tgetNextCell: function moveCell(dir){\n\t\t\t\t// GS-1257. true means to exclude hidden columns\n\t\t\t\treturn this._findEditableCell(grid.getColumnIndex(this._columnName, true) + dir, dir);\n\t\t\t},\n\n\t\t\tgetFirstCell: function getFirstCell(){\n\t\t\t\treturn this._findEditableCell(0, 1);\n\t\t\t},\n\n\t\t\tgetLastCell: function getLastCell(){\n\t\t\t\treturn this._findEditableCell(grid.getGridColumns().length - 1, -1);\n\t\t\t},\n\n\t\t\teditNextCell: function nextCell(canChangeRow){\n\t\t\t\tvar cell = this.getNextCell(1);\n\t\t\t\tif(cell){\n\t\t\t\t\tvar nextColumn = this.getNextCell(1);\n\t\t\t\t\tif(nextColumn && this.getEditorConfig(nextColumn)){\n\t\t\t\t\t\tthis.startEdit(this._itemId, nextColumn);\n\t\t\t\t\t}\n\t\t\t\t}else if(canChangeRow && this.moveRow(1)){\n\t\t\t\t\tvar task = this.moveRow(1);\n\t\t\t\t\tcell = this.getFirstCell();\n\t\t\t\t\tif(cell && this.getEditorConfig(cell)){\n\t\t\t\t\t\tthis.startEdit(task, cell);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\teditPrevCell: function prevCell(canChangeRow){\n\t\t\t\tvar cell = this.getNextCell(-1);\n\t\t\t\tif(cell){\n\t\t\t\t\tvar nextColumn = this.getNextCell(-1);\n\t\t\t\t\tif(nextColumn && this.getEditorConfig(nextColumn)){\n\t\t\t\t\t\tthis.startEdit(this._itemId, nextColumn);\n\t\t\t\t\t}\n\t\t\t\t}else if(canChangeRow && this.moveRow(-1)){\n\t\t\t\t\tvar task = this.moveRow(-1);\n\t\t\t\t\tcell = this.getLastCell();\n\t\t\t\t\tif(cell && this.getEditorConfig(cell)){\n\t\t\t\t\t\tthis.startEdit(task, cell);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tmoveRow: function moveRow(dir) {\n\t\t\t\tvar moveTask = dir > 0 ? gantt.getNext : gantt.getPrev;\n\t\t\t\tmoveTask = gantt.bind(moveTask, gantt);\n\n\t\t\t\tvar nextItem = moveTask(this._itemId);\n\t\t\t\t// skip readonly rows\n\t\t\t\twhile (gantt.isTaskExists(nextItem) && gantt.isReadonly(gantt.getTask(nextItem))) {\n\t\t\t\t\tnextItem = moveTask(nextItem);\n\t\t\t\t}\n\t\t\t\treturn nextItem;\n\t\t\t},\n\n\t\t\teditNextRow: function nextRow(skipReadonly){\n\t\t\t\tvar id = this.getState().id;\n\t\t\t\tif (!gantt.isTaskExists(id)) return;\n\n\t\t\t\tvar next = null;\n\t\t\t\tif (skipReadonly){\n\t\t\t\t\tnext = this.moveRow(1);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tnext = gantt.getNext(id);\n\t\t\t\t}\n\n\t\t\t\tif (gantt.isTaskExists(next)){\n\t\t\t\t\tthis.startEdit(next, this._columnName);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\teditPrevRow: function prevRow(skipReadonly){\n\t\t\t\tvar id = this.getState().id;\n\t\t\t\tif (!gantt.isTaskExists(id)) return;\n\n\t\t\t\tvar prev = null;\n\t\t\t\tif (skipReadonly){\n\t\t\t\t\tprev = this.moveRow(-1);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tprev = gantt.getPrev(id);\n\t\t\t\t}\n\n\t\t\t\tif (gantt.isTaskExists(prev)){\n\t\t\t\t\tthis.startEdit(prev, this._columnName);\n\t\t\t\t}\n\t\t\t},\n\t\t\tdetachStore: function(){\n\t\t\t\thandlers.forEach(function(handlerId){\n\t\t\t\t\tstore.detachEvent(handlerId);\n\t\t\t\t});\n\n\t\t\t\tganttHandlers.forEach(function(handlerId){\n\t\t\t\t\tgantt.detachEvent(handlerId);\n\t\t\t\t});\n\t\t\t\thandlers = [];\n\t\t\t\tganttHandlers = [];\n\n\t\t\t\tstore = null;\n\t\t\t\tthis.hide();\n\t\t\t},\n\t\t\tdestructor: function(){\n\t\t\t\tthis.detachStore();\n\t\t\t\tthis.detachAllEvents();\n\t\t\t}\n\t\t};\n\n\t\tutils.mixin(controller, keyboardMapping);\n\t\tutils.mixin(controller, eventBus);\n\n\t\treturn controller;\n\t}\n\n\n\tvar inlineEditController = {\n\t\tinit: initConfigs,\n\t\tcreateEditors: createGridEditors\n\t};\n\n\tutils.mixin(inlineEditController, keyboardMapping);\n\tutils.mixin(inlineEditController, eventBus);\n\n\treturn inlineEditController;\n}\n\n\n\n\nexport default create;","import defaultMapping from \"./keyboard_mappings/default\";\nimport keyNavMappings from \"./keyboard_mappings/keyboard_navigation\";\n\nexport default function(gantt){\n\n\tvar mapping = null;\n\n\treturn {\n\t\tsetMapping: function(map){\n\t\t\tmapping = map;\n\t\t},\n\t\tgetMapping: function(){\n\n\t\t\tif(mapping){\n\t\t\t\treturn mapping;\n\t\t\t}else if(gantt.config.keyboard_navigation_cells && gantt.ext.keyboardNavigation){\n\t\t\t\treturn keyNavMappings;\n\t\t\t}else{\n\t\t\t\treturn defaultMapping;\n\t\t\t}\n\t\t}\n\t};\n};\n","// optimized checker for task bars smart rendering\n\n// first check the vertical position since it's easier to calculate\nexport default function isBarInViewport(item, viewport, view, config, gantt){\n\tif(!item.start_date || !item.end_date){\n\t\treturn null;\n\t}\n\n\tvar top = view.getItemTop(item.id);\n\tvar height = view.getItemHeight(item.id);\n\n\tif(top > viewport.y_end || top + height < viewport.y){\n\t\treturn false;\n\t}\n\n\tvar padding = 200;\n\tvar startCoord = view.posFromDate(item.start_date, view._getPositioningContext ? view._getPositioningContext(item) : null);\n\tvar endCoord = view.posFromDate(item.end_date, view._getPositioningContext ? view._getPositioningContext(item) : null);\n\tvar left = Math.min(startCoord, endCoord) - padding;\n\tvar right = Math.max(startCoord, endCoord) + padding;\n\n\tif(left > viewport.x_end || right < viewport.x){\n\t\treturn false;\n\t}\n\n\treturn true;\n};","function createTaskRenderer(gantt) {\n\n\tfunction _render_task_element(task, view, config) {\n\t\tvar config = view.$getConfig();\n\t\tvar painters = config.type_renderers;\n\t\tvar renderer = painters[gantt.getTaskType(task.type)],\n\t\t\tdefaultRenderer = _task_default_render;\n\n\t\tif (!renderer) {\n\t\t\treturn defaultRenderer.call(gantt, task, view, config);\n\t\t}else{\n\t\t\treturn renderer.call(gantt, task, function(task){ return defaultRenderer.call(gantt, task, view, config);}, view);\n\t\t}\n\t}\n\n\tfunction _task_default_render(task, view, config) {\n\t\tif (gantt._isAllowedUnscheduledTask(task))\n\t\t\treturn;\n\n\t\tif (!gantt._isTaskInTimelineLimits(task)) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar pos = view.getItemPosition(task);\n\n\t\tvar cfg = config,\n\t\t\ttemplates = view.$getTemplates();\n\n\t\tvar taskType = gantt.getTaskType(task.type);\n\t\tvar height = view.getBarHeight(task.id, taskType == cfg.types.milestone);\n\n\t\tvar controlsMargin = 0;\n\t\tif (taskType == cfg.types.milestone) {\n\t\t\tcontrolsMargin = (height - pos.height)/2;\n\t\t}\n\n\t\tvar padd = Math.floor((view.getItemHeight(task.id) - height) / 2);\n\t\tconst hasBaselines = gantt.config.baselines && task.baselines && task.baselines.length;\n\t\tconst baselinesOnDifferentRow = gantt.config.baselines && (gantt.config.baselines.render_mode == \"separateRow\" || gantt.config.baselines.render_mode == \"individualRow\");\n\t\tif (hasBaselines && baselinesOnDifferentRow){\n\t\t\tif (task.bar_height !== \"full\" && task.bar_height < task.row_height){\n\t\t\t\tif (taskType === cfg.types.milestone){\n\t\t\t\t\tlet milestoneHeight = view.getBarHeight(task.id, true);\n\t\t\t\t\tlet milestoneWidth = Math.sqrt(2 * milestoneHeight * milestoneHeight);\n\t\t\t\t\tpadd = Math.floor((milestoneWidth - height) / 2) + 2;\n\t\t\t\t} else {\n\t\t\t\t\tpadd = 2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t//\tif(task.type == cfg.types.milestone){\n\t//\t\tpadd -= 1;\n\t//\t}\n\t//\tif (taskType == cfg.types.milestone && cfg.link_line_width > 1) {\n\t//\t\t//little adjust milestone position, so horisontal corners would match link arrow when thickness of link line is more than 1px\n\t//\t\tpadd += 1;\n\t//\t}\n\n\t\tif (taskType == cfg.types.milestone) {\n\t\t\tpos.left -= Math.round(height / 2);\n\t\t\tpos.width = height;\n\t\t}\n\n\t\tvar div = document.createElement(\"div\");\n\n\t\tvar width = Math.round(pos.width);\n\n\t\tif(view.$config.item_attribute) {\n\t\t\tdiv.setAttribute(view.$config.item_attribute, task.id);\n\t\t\tdiv.setAttribute(view.$config.bind + \"_id\", task.id); // 'task_id'/'resource_id' for backward compatibility\n\t\t}\n\n\t\tif (cfg.show_progress && taskType != cfg.types.milestone) {\n\t\t\t_render_task_progress(task, div, width, cfg, templates);\n\t\t}\n\n\t\t//use separate div to display content above progress bar\n\t\tvar content = _render_task_content(task, width, templates);\n\n\t\tdiv.appendChild(content);\n\n\t\tvar css = _combine_item_class(\"gantt_task_line\",\n\t\t\ttemplates.task_class(task.start_date, task.end_date, task),\n\t\t\ttask.id,\n\t\t\tview);\n\t\tif (task.color || task.progressColor || task.textColor) {\n\t\t\tcss += \" gantt_task_inline_color\";\n\t\t}\n\t\tif (pos.width < 20){\n\t\t\tcss += \" gantt_thin_task\";\n\t\t}\n\t\tdiv.className = css;\n\n\t\tvar styles = [\n\t\t\t\"left:\" + pos.left + \"px\",\n\t\t\t\"top:\" + (padd + pos.top) + 'px',\n\t\t\t\"height:\" + (height) + 'px',\n\t\t\t\"line-height:\" + (Math.max(height < 30 ? height - 2 : height, 0)) + 'px',\n\t\t\t\"width:\" + width + 'px'\n\t\t];\n\n\t\tdiv.style.cssText = styles.join(\";\");\n\t\tif (task.color) {\n\t\t\tdiv.style.setProperty(\"--dhx-gantt-task-background\", task.color);\n\t\t}\n\t\tif (task.textColor) {\n\t\t\tdiv.style.setProperty(\"--dhx-gantt-task-color\", task.textColor);\n\t\t}\n\n\t\tif (task.progressColor) {\n\t\t\tdiv.style.setProperty(\"--dhx-gantt-task-progress-color\", task.progressColor);\n\t\t}\n\n\t\t\n\t\tvar side = _render_leftside_content(task, cfg, templates, controlsMargin);\n\t\tif (side) div.appendChild(side);\n\n\t\tside = _render_rightside_content(task, cfg, templates, controlsMargin);\n\t\tif (side) div.appendChild(side);\n\n\t\tgantt._waiAria.setTaskBarAttr(task, div);\n\n\t\tvar state = gantt.getState();\n\t\tconst taskEditable = !gantt.isReadonly(task);\n\t\tconst timelineDrag = gantt.ext.dragTimeline && gantt.ext.dragTimeline._isDragInProgress();\n\n\t\tif (taskEditable || timelineDrag) {\n\t\t\tif (cfg.drag_resize && !gantt.isSummaryTask(task) && taskType != cfg.types.milestone) {\n\t\t\t\t_render_pair(div, \"gantt_task_drag\", task, function (css) {\n\t\t\t\t\tvar el = document.createElement(\"div\");\n\t\t\t\t\tel.className = css;\n\t\t\t\t\treturn el;\n\t\t\t\t}, cfg);\n\t\t\t}\n\t\t\tif (cfg.drag_links && cfg.show_links) {\n\t\t\t\t_render_pair(div, \"gantt_link_control\", task, function (css) {\n\t\t\t\t\tvar outer = document.createElement(\"div\");\n\t\t\t\t\touter.className = css;\n\t\t\t\t\touter.style.cssText = [\n\t\t\t\t\t\t\"height:\" + height + 'px',\n\t\t\t\t\t\t\"line-height:\" + height + 'px'\n\t\t\t\t\t].join(\";\");\n\t\t\t\t\tvar inner = document.createElement(\"div\");\n\t\t\t\t\tinner.className = \"gantt_link_point\";\n\n\t\t\t\t\tvar showLinkPoints = false;\n\t\t\t\t\tif(state.link_source_id && cfg.touch){\n\t\t\t\t\t\tshowLinkPoints = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tinner.style.display = showLinkPoints ? \"block\" : \"\";\n\t\t\t\t\touter.appendChild(inner);\n\t\t\t\t\treturn outer;\n\t\t\t\t}, cfg, controlsMargin);\n\t\t\t}\n\t\t}\n\t\treturn div;\n\t}\n\n\tfunction _render_side_content(task, template, cssClass, marginStyle) {\n\t\tif (!template) return null;\n\n\t\tvar text = template(task.start_date, task.end_date, task);\n\t\tif (!text) return null;\n\t\tvar content = document.createElement(\"div\");\n\t\tcontent.className = \"gantt_side_content \" + cssClass;\n\t\tcontent.innerHTML = text;\n\t\tif(marginStyle){\n\t\t\tcontent.style[marginStyle.type] = Math.abs(marginStyle.value) + \"px\";\n\t\t}\n\t\treturn content;\n\t}\n\n\tfunction _render_leftside_content(task, cfg, templates, margin) {\n\t\tvar css = \"gantt_left \" + _get_link_crossing_css(!cfg.rtl ? true : false, task, cfg);\n\t\tvar marginStyle = null;\n\t\tif(margin){\n\t\t\tmarginStyle = { type: \"marginRight\", value: margin };\n\t\t}\n\t\treturn _render_side_content(task, templates.leftside_text, css, marginStyle);\n\t}\n\n\tfunction _render_rightside_content(task, cfg, templates, margin) {\n\t\tvar css = \"gantt_right \" + _get_link_crossing_css(!cfg.rtl ? false : true, task, cfg);\n\t\tvar marginStyle = null;\n\t\tif(margin){\n\t\t\tmarginStyle = { type: \"marginLeft\", value: margin };\n\t\t}\n\t\treturn _render_side_content(task, templates.rightside_text, css, marginStyle);\n\t}\n\n\tfunction _get_link_crossing_css(left, task) {\n\t\tvar cond = _get_conditions(left);\n\n\t\tfor (var i in cond) {\n\t\t\tvar links = task[i];\n\t\t\tfor (var ln = 0; ln < links.length; ln++) {\n\t\t\t\tvar link = gantt.getLink(links[ln]);\n\n\t\t\t\tfor (var tp = 0; tp < cond[i].length; tp++) {\n\t\t\t\t\tif (link.type == cond[i][tp]) {\n\t\t\t\t\t\treturn \"gantt_link_crossing\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn \"\";\n\t}\n\n\n\tfunction _render_task_content(task, width, templates) {\n\t\tvar content = document.createElement(\"div\");\n\t\tif (gantt.getTaskType(task.type) != gantt.config.types.milestone){\n\t\t\tcontent.innerHTML = templates.task_text(task.start_date, task.end_date, task);\n\t\t} else if(gantt.getTaskType(task.type) == gantt.config.types.milestone && width) {\n\t\t\tcontent.style.height = content.style.width = width + \"px\";\n\t\t}\n\t\tcontent.className = \"gantt_task_content\";\n\t\t//content.style.width = width + 'px';\n\t\treturn content;\n\t}\n\n\tfunction _render_task_progress(task, element, maxWidth, cfg, templates) {\n\t\tvar done = task.progress * 1 || 0;\n\t\t//GS-2776: borders were removed in v9.0\n\t\tmaxWidth = Math.max(maxWidth, 0);\n\t\tvar pr = document.createElement(\"div\");\n\t\tvar width = Math.round(maxWidth * done);\n\n\t\twidth = Math.min(maxWidth, width);\n\n\t\tpr.style.width = width + 'px';\n\t\tpr.className = \"gantt_task_progress\";\n\t\tpr.innerHTML = templates.progress_text(task.start_date, task.end_date, task);\n\n\t\tif(cfg.rtl){\n\t\t\tpr.style.position = \"absolute\";\n\t\t\tpr.style.right = \"0px\";\n\t\t}\n\n\t\tvar wrapper = document.createElement(\"div\");\n\t\twrapper.className = \"gantt_task_progress_wrapper\";\n\t\twrapper.appendChild(pr);\n\t\telement.appendChild(wrapper);\n\n\t\tconst taskEditable = !gantt.isReadonly(task);\n\t\tconst timelineDrag = gantt.ext.dragTimeline && gantt.ext.dragTimeline._isDragInProgress();\n\n\t\tif (gantt.config.drag_progress && (taskEditable || timelineDrag)) {\n\t\t\tvar drag = document.createElement(\"div\");\n\n\t\t\tvar markerPos = width;\n\t\t\tif(cfg.rtl){\n\t\t\t\tmarkerPos = maxWidth - width;\n\t\t\t}\n\n\t\t\tdrag.style.left = markerPos + 'px';\n\t\t\tdrag.className = \"gantt_task_progress_drag\";\n\t\t\tdrag.innerHTML = `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"9\" viewBox=\"0 0 12 9\" fill=\"none\">\n<path d=\"M5.58397 1.52543C5.78189 1.22856 6.21811 1.22856 6.41602 1.52543L10.5475 7.72265C10.769 8.05493 10.5308 8.5 10.1315 8.5L1.86852 8.5C1.46917 8.5 1.23097 8.05493 1.45249 7.72265L5.58397 1.52543Z\" fill=\"var(--dhx-gantt-progress-handle-background)\" stroke=\"var(--dhx-gantt-progress-handle-border)\"/>\n</svg>`;\n\t\t\tpr.appendChild(drag);\n\t\t\telement.appendChild(drag);\n\t\t}\n\t}\n\n\tfunction _get_conditions(leftside) {\n\t\tif (leftside) {\n\t\t\treturn {\n\t\t\t\t$source: [\n\t\t\t\t\tgantt.config.links.start_to_start\n\t\t\t\t],\n\t\t\t\t$target: [\n\t\t\t\t\tgantt.config.links.start_to_start,\n\t\t\t\t\tgantt.config.links.finish_to_start\n\t\t\t\t]\n\t\t\t};\n\t\t} else {\n\t\t\treturn {\n\t\t\t\t$source: [\n\t\t\t\t\tgantt.config.links.finish_to_start,\n\t\t\t\t\tgantt.config.links.finish_to_finish\n\t\t\t\t],\n\t\t\t\t$target: [\n\t\t\t\t\tgantt.config.links.finish_to_finish\n\t\t\t\t]\n\t\t\t};\n\t\t}\n\t}\n\n\tfunction _combine_item_class(basic, template, itemId, view) {\n\t\tvar cfg = view.$getConfig();\n\t\tvar css = [basic];\n\t\tif (template)\n\t\t\tcss.push(template);\n\n\t\tvar state = gantt.getState();\n\n\t\tvar task = gantt.getTask(itemId);\n\n\t\tif (gantt.getTaskType(task.type) == cfg.types.milestone) {\n\t\t\tcss.push(\"gantt_milestone\");\n\t\t}else if (gantt.getTaskType(task.type) == cfg.types.project) {\n\t\t\tcss.push(\"gantt_project\");\n\t\t}\n\n\t\tcss.push(\"gantt_bar_\" + gantt.getTaskType(task.type));\n\n\n\t\tif (gantt.isSummaryTask(task))\n\t\t\tcss.push(\"gantt_dependent_task\");\n\n\t\tif (gantt.isSplitTask(task) && ((task.$inlineSplit && task.$inlineSplit.length) || ((cfg.open_split_tasks && !task.$open && (task.$inlineSplit && task.$inlineSplit.length)) || !cfg.open_split_tasks))) {\n\t\t\tcss.push(\"gantt_split_parent\");\n\t\t}\n\n\t\tif (cfg.select_task && gantt.isSelectedTask(itemId)) {\n\t\t\tcss.push(\"gantt_selected\");\n\t\t}\n\n\t\tif (itemId == state.drag_id) {\n\t\t\tcss.push(\"gantt_drag_\" + state.drag_mode);\n\t\t\tif (state.touch_drag) {\n\t\t\t\tcss.push(\"gantt_touch_\" + state.drag_mode);\n\t\t\t}\n\t\t}\n\n\t\tif (state.link_source_id == itemId){\n\t\t\tcss.push(\"gantt_link_source\");\n\t\t\tif(state.link_from_start) {\n\t\t\t\tcss.push(\"gantt_link_from_start\");\n\t\t\t}else{\n\t\t\t\tcss.push(\"gantt_link_from_end\");\n\t\t\t}\n\t\t}\n\n\t\tif (state.link_target_id == itemId)\n\t\t\tcss.push(\"gantt_link_target\");\n\n\n\t\tif (cfg.highlight_critical_path && gantt.isCriticalTask) {\n\t\t\tif (gantt.isCriticalTask(task))\n\t\t\t\tcss.push(\"gantt_critical_task\");\n\t\t}\n\n\t\tif (state.link_landing_area &&\n\t\t\t(state.link_target_id && state.link_source_id) &&\n\t\t\t(state.link_target_id != state.link_source_id) &&\n\t\t\t(state.link_target_id == itemId || state.link_source_id == itemId)) {\n\n\t\t\tvar from_id = state.link_source_id;\n\t\t\tvar from_start = state.link_from_start;\n\t\t\tvar to_start = state.link_to_start;\n\n\t\t\tvar allowDrag = gantt.isLinkAllowed(from_id, itemId, from_start, to_start);\n\n\t\t\tvar dragClass = \"\";\n\t\t\tif (allowDrag) {\n\t\t\t\tif (to_start)\n\t\t\t\t\tdragClass = \"link_start_allow\";\n\t\t\t\telse\n\t\t\t\t\tdragClass = \"link_finish_allow\";\n\t\t\t} else {\n\t\t\t\tif (to_start)\n\t\t\t\t\tdragClass = \"link_start_deny\";\n\t\t\t\telse\n\t\t\t\t\tdragClass = \"link_finish_deny\";\n\t\t\t}\n\t\t\tcss.push(dragClass);\n\t\t}\n\t\treturn css.join(\" \");\n\t}\n\n\tfunction _render_pair(parent, css, task, content, config, margin) {\n\t\tvar state = gantt.getState();\n\t\tvar className, element;\n\t\tif (+task.start_date >= +state.min_date) {\n\t\t\tclassName = [css, config.rtl ? \"task_right\" : \"task_left\", \"task_start_date\"];\n\t\t\telement = content(className.join(\" \"));\n\t\t\telement.setAttribute(\"data-bind-property\", \"start_date\");\n\t\t\tif(margin){\n\t\t\t\telement.style.marginLeft = margin + \"px\";\n\t\t\t}\n\t\t\tparent.appendChild(element);\n\t\t}\n\n\t\tif (+task.end_date <= +state.max_date){\n\t\t\tclassName = [css, config.rtl ? \"task_left\" : \"task_right\", \"task_end_date\"];\n\t\t\telement = content(className.join(\" \"));\n\t\t\telement.setAttribute(\"data-bind-property\", \"end_date\");\n\t\t\tif(margin){\n\t\t\t\telement.style.marginRight = margin + \"px\";\n\t\t\t}\n\t\t\tparent.appendChild(element);\n\t\t}\n\n\t}\n\n\treturn _render_task_element;\n}\n\nexport default createTaskRenderer;","// optimized checker for task bars smart rendering\n\n// first check the vertical position since it's easier to calculate\nexport default function isBarInViewport(item, viewport, view, config, gantt){\n\tif(!((item.start_date && item.end_date) || (item.$auto_start_date && item.$auto_end_date))){\n\t\treturn null;\n\t}\n\n\tvar top = view.getItemTop(item.id);\n\tvar height = view.getItemHeight(item.id);\n\n\tif(top > viewport.y_end || top + height < viewport.y){\n\t\treturn false;\n\t}\n\n\tvar padding = 200;\n\n\tconst coords = [];\n\tif(item.start_date){\n\t\tcoords.push(view.posFromDate(item.start_date, view._getPositioningContext ? view._getPositioningContext(item) : null));\n\t}\n\tif(item.end_date){\n\t\tcoords.push(view.posFromDate(item.end_date, view._getPositioningContext ? view._getPositioningContext(item) : null));\n\t}\n\tif(item.$auto_start_date){\n\t\tcoords.push(view.posFromDate(item.$auto_start_date, view._getPositioningContext ? view._getPositioningContext(item) : null));\n\t}\n\tif(item.$auto_end_date){\n\t\tcoords.push(view.posFromDate(item.$auto_end_date, view._getPositioningContext ? view._getPositioningContext(item) : null));\n\t}\n\t\n\tvar left = Math.min(...coords) - padding;\n\tvar right = Math.max(...coords) + padding;\n\n\tif(left > viewport.x_end || right < viewport.x){\n\t\treturn false;\n\t}\n\n\treturn true;\n};","function createTaskRenderer(gantt) {\n\n\tfunction _render_task_element(task, view, config) {\n\t\n\t\tvar config = view.$getConfig();\n\t\tvar painters = config.type_renderers;\n\t\tvar renderer = painters[gantt.getTaskType(task.type)],\n\t\t\tdefaultRenderer = _task_default_render;\n\n\t\tif (!renderer) {\n\t\t\treturn defaultRenderer.call(gantt, task, view, config);\n\t\t}else{\n\t\t\treturn renderer.call(gantt, task, function(task){ return defaultRenderer.call(gantt, task, view, config);}, view);\n\t\t}\n\t}\n\n\tfunction _task_default_render(task, view, config) {\n\t\tif (gantt._isAllowedUnscheduledTask(task))\n\t\t\treturn;\n\n\t\tif (!gantt._isTaskInTimelineLimits(task)) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar pos = view.getItemPosition(task);\n\n\t\tvar cfg = config,\n\t\t\ttemplates = view.$getTemplates();\n\n\t\tvar taskType = gantt.getTaskType(task.type);\n\t\tvar height = view.getBarHeight(task.id, taskType == cfg.types.milestone);\n\n\t\tvar controlsMargin = 0;\n\t\tif (taskType == cfg.types.milestone) {\n\t\t\tcontrolsMargin = (height - pos.height)/2;\n\t\t}\n\n\t\tvar padd = Math.floor((view.getItemHeight(task.id) - height) / 2);\n\n\t\tconst hasBaselines = gantt.config.baselines && task.baselines && task.baselines.length;\n\t\tconst baselinesOnDifferentRow = gantt.config.baselines && (gantt.config.baselines.render_mode == \"separateRow\" || gantt.config.baselines.render_mode == \"individualRow\");\n\t\tif (hasBaselines && baselinesOnDifferentRow){\n\t\t\tif (task.bar_height !== \"full\" && task.bar_height < task.row_height){\n\t\t\t\tif (taskType === cfg.types.milestone){\n\t\t\t\t\tlet milestoneHeight = view.getBarHeight(task.id, true);\n\t\t\t\t\tlet milestoneWidth = Math.sqrt(2 * milestoneHeight * milestoneHeight);\n\t\t\t\t\tpadd = Math.floor((milestoneWidth - height) / 2) + 2;\n\t\t\t\t} else {\n\t\t\t\t\tpadd = 2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tvar div = document.createElement(\"div\");\n\n\t\tvar width = Math.round(pos.width);\n\n\t\tif(view.$config.item_attribute) {\n\t\t\tdiv.setAttribute(view.$config.item_attribute, task.id);\n\t\t\tdiv.setAttribute(view.$config.bind + \"_id\", task.id); // 'task_id'/'resource_id' for backward compatibility\n\t\t}\n\n\t\t// generate outline bracket with planned dates\n\n\t\tconst planned = document.createElement(\"div\");\n\t\t\n\t\tplanned.classList.add(\"gantt_task_line_planned\", \"gantt_task_line\" , \"gantt_project\");\n\t\tconst plannedCoords = view.getItemPosition(task, task.start_date, task.end_date);\n\t\tconst barHeight = 5;\n\t\tplanned.style.cssText = [\n\t\t\t\"position:absolute\",\n\t\t\t\"left:\" + plannedCoords.left + \"px\",\n\t\t\t\"top:\" + (padd/2 + 1) + 'px',\n\t\t\t\"height:\" + barHeight + 'px',\n\t\t\t\"width:\" + plannedCoords.width + 'px'\n\t\t].join(\";\");\n\t\tplanned.style.setProperty('--dhx-gantt-scheduled-summary-bracket-size', \"10px\");\n\n\t\tdiv.appendChild(planned);\n\t\t// generate element with actual dates & progress\n\n\t\tconst actual = document.createElement(\"div\");\n\t\tconst actualCoords = view.getItemPosition(task, task.$auto_start_date || task.start_date, task.$auto_end_date || task.end_date);\n\t\tactual.classList.add(\"gantt_task_line_actual\", \"gantt_task_line\" , \"gantt_project\");\n\t\tactual.style.cssText = [\n\t\t\t\"position:absolute\",\n\t\t\t\"left:\" + actualCoords.left + \"px\",\n\t\t\t\"top:\" + (barHeight*2 + 6) + 'px',\n\t\t\t\"height:\" + (barHeight + 3) + 'px',\n\t\t\t\"width:\" + actualCoords.width + 'px'\n\t\t].join(\";\");\n\n\t\tdiv.appendChild(actual);\n\n\t\tif (cfg.show_progress && taskType != cfg.types.milestone) {\n\t\t\t_render_task_progress(task, actual, width, cfg, templates);\n\t\t}\n\n\t\t//use separate div to display content above progress bar\n\t\t// var content = _render_task_content(task, width, templates);\n\n\t\t// actual.appendChild(content);\n\n\t\tvar css = _combine_item_class(\"gantt_task_line\",\n\t\t\ttemplates.task_class(task.$auto_start_date || task.start_date, task.$auto_end_date || task.end_date, task),\n\t\t\ttask.id,\n\t\t\tview);\n\t\tif (task.color || task.progressColor || task.textColor) {\n\t\t\tcss += \" gantt_task_inline_color\";\n\t\t}\n\t\tif (pos.width < 20){\n\t\t\tcss += \" gantt_thin_task\";\n\t\t}\n\n\n\t\tif(task.start_date > task.$auto_start_date || task.end_date < task.$auto_end_date){\n\t\t\tcss += \" gantt_project_scheduling_conflict\";\n\t\t}\n\n\t\tdiv.className = css;\n\n\t\tdiv.style.top = (padd + pos.top) + 'px';\n\t\tdiv.style.height = (taskType == cfg.types.milestone ? pos.height : height) + 'px';\n\t\tif (task.color) {\n\t\t\tdiv.style.setProperty(\"--dhx-gantt-task-background\", task.color);\n\t\t}\n\t\tif (task.textColor) {\n\t\t\tdiv.style.setProperty(\"--dhx-gantt-task-color\", task.textColor);\n\t\t}\n\n\t\tif (task.progressColor) {\n\t\t\tdiv.style.setProperty(\"--dhx-gantt-task-progress-color\", task.progressColor);\n\t\t}\n\n\n\t\tvar side = _render_leftside_content(task, cfg, templates, controlsMargin);\n\t\tif (side) planned.appendChild(side);\n\n\t\tside = _render_rightside_content(task, cfg, templates, controlsMargin);\n\t\tif (side) planned.appendChild(side);\n\n\t\tgantt._waiAria.setTaskBarAttr(task, div);\n\n\t\tvar state = gantt.getState();\n\n\t\tif (!gantt.isReadonly(task)) {\n\t\t\tif (cfg.drag_resize) {\n\t\t\t\t_render_pair(planned, \"gantt_task_drag\", task, function (css) {\n\t\t\t\t\tvar el = document.createElement(\"div\");\n\t\t\t\t\tel.className = css;\n\t\t\t\t\treturn el;\n\t\t\t\t}, cfg);\n\t\t\t}\n\t\t\tif (cfg.drag_links && cfg.show_links) {\n\t\t\t\t_render_pair(planned, \"gantt_link_control\", task, function (css) {\n\t\t\t\t\tvar outer = document.createElement(\"div\");\n\t\t\t\t\touter.className = css;\n\t\t\t\t\touter.style.cssText = [\n\t\t\t\t\t\t\"height:\" + height + 'px',\n\t\t\t\t\t\t\"line-height:\" + height + 'px'\n\t\t\t\t\t].join(\";\");\n\t\t\t\t\tvar inner = document.createElement(\"div\");\n\t\t\t\t\tinner.className = \"gantt_link_point\";\n\n\t\t\t\t\tvar showLinkPoints = false;\n\t\t\t\t\tif(state.link_source_id && cfg.touch){\n\t\t\t\t\t\tshowLinkPoints = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tinner.style.display = showLinkPoints ? \"block\" : \"\";\n\t\t\t\t\touter.appendChild(inner);\n\t\t\t\t\treturn outer;\n\t\t\t\t}, cfg, controlsMargin);\n\t\t\t}\n\t\t}\n\t\treturn div;\n\t}\n\n\tfunction _render_side_content(task, template, cssClass, marginStyle) {\n\t\tif (!template) return null;\n\n\t\tvar text = template(task.start_date, task.end_date, task);\n\t\tif (!text) return null;\n\t\tvar content = document.createElement(\"div\");\n\t\tcontent.className = \"gantt_side_content \" + cssClass;\n\t\tcontent.innerHTML = text;\n\t\tif(marginStyle){\n\t\t\tcontent.style[marginStyle.type] = Math.abs(marginStyle.value) + \"px\";\n\t\t}\n\t\treturn content;\n\t}\n\n\tfunction _render_leftside_content(task, cfg, templates, margin) {\n\t\tvar css = \"gantt_left \" + _get_link_crossing_css(!cfg.rtl ? true : false, task, cfg);\n\t\tvar marginStyle = null;\n\t\tif(margin){\n\t\t\tmarginStyle = { type: \"marginRight\", value: margin };\n\t\t}\n\t\treturn _render_side_content(task, templates.leftside_text, css, marginStyle);\n\t}\n\n\tfunction _render_rightside_content(task, cfg, templates, margin) {\n\t\tvar css = \"gantt_right \" + _get_link_crossing_css(!cfg.rtl ? false : true, task, cfg);\n\t\tvar marginStyle = null;\n\t\tif(margin){\n\t\t\tmarginStyle = { type: \"marginLeft\", value: margin };\n\t\t}\n\t\treturn _render_side_content(task, templates.rightside_text, css, marginStyle);\n\t}\n\n\tfunction _get_link_crossing_css(left, task) {\n\t\tvar cond = _get_conditions(left);\n\n\t\tfor (var i in cond) {\n\t\t\tvar links = task[i];\n\t\t\tfor (var ln = 0; ln < links.length; ln++) {\n\t\t\t\tvar link = gantt.getLink(links[ln]);\n\n\t\t\t\tfor (var tp = 0; tp < cond[i].length; tp++) {\n\t\t\t\t\tif (link.type == cond[i][tp]) {\n\t\t\t\t\t\treturn \"gantt_link_crossing\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn \"\";\n\t}\n\n\n\t// function _render_task_content(task, width, templates) {\n\t// \tvar content = document.createElement(\"div\");\n\t// \tif (gantt.getTaskType(task.type) != gantt.config.types.milestone){\n\t// \t\tcontent.innerHTML = templates.task_text(task.start_date, task.end_date, task);\n\t// \t} else if(gantt.getTaskType(task.type) == gantt.config.types.milestone && width) {\n\t// \t\tcontent.style.height = content.style.width = width + \"px\";\n\t// \t}\n\t// \tcontent.className = \"gantt_task_content\";\n\t// \t//content.style.width = width + 'px';\n\t// \treturn content;\n\t// }\n\n\tfunction _render_task_progress(task, element, maxWidth, cfg, templates) {\n\t\tvar done = task.progress * 1 || 0;\n\n\t\tmaxWidth = Math.max(maxWidth - 2, 0);//2px for borders\n\t\tvar pr = document.createElement(\"div\");\n\t\tvar width = Math.round(maxWidth * done);\n\n\t\twidth = Math.min(maxWidth, width);\n\t\tif (task.progressColor) {\n\t\t\tpr.style.backgroundColor = task.progressColor;\n\t\t\tpr.style.opacity = 1;\n\t\t}\n\t\tpr.style.width = width + 'px';\n\t\tpr.className = \"gantt_task_progress\";\n\t\tpr.innerHTML = templates.progress_text(task.start_date, task.end_date, task);\n\n\t\tif(cfg.rtl){\n\t\t\tpr.style.position = \"absolute\";\n\t\t\tpr.style.right = \"0px\";\n\t\t}\n\n\t\tvar wrapper = document.createElement(\"div\");\n\t\twrapper.className = \"gantt_task_progress_wrapper\";\n\t\twrapper.appendChild(pr);\n\t\telement.appendChild(wrapper);\n\n\t\tif (gantt.config.drag_progress && !gantt.isReadonly(task)) {\n\t\t\tvar drag = document.createElement(\"div\");\n\n\t\t\tvar markerPos = width;\n\t\t\tif(cfg.rtl){\n\t\t\t\tmarkerPos = maxWidth - width;\n\t\t\t}\n\n\t\t\tdrag.style.left = markerPos + 'px';\n\t\t\tdrag.className = \"gantt_task_progress_drag\";\n\t\t\tpr.appendChild(drag);\n\t\t\telement.appendChild(drag);\n\t\t}\n\t}\n\n\tfunction _get_conditions(leftside) {\n\t\tif (leftside) {\n\t\t\treturn {\n\t\t\t\t$source: [\n\t\t\t\t\tgantt.config.links.start_to_start\n\t\t\t\t],\n\t\t\t\t$target: [\n\t\t\t\t\tgantt.config.links.start_to_start,\n\t\t\t\t\tgantt.config.links.finish_to_start\n\t\t\t\t]\n\t\t\t};\n\t\t} else {\n\t\t\treturn {\n\t\t\t\t$source: [\n\t\t\t\t\tgantt.config.links.finish_to_start,\n\t\t\t\t\tgantt.config.links.finish_to_finish\n\t\t\t\t],\n\t\t\t\t$target: [\n\t\t\t\t\tgantt.config.links.finish_to_finish\n\t\t\t\t]\n\t\t\t};\n\t\t}\n\t}\n\n\tfunction _combine_item_class(basic, template, itemId, view) {\n\t\tvar cfg = view.$getConfig();\n\t\tvar css = [basic];\n\t\tif (template)\n\t\t\tcss.push(template);\n\n\t\tvar state = gantt.getState();\n\n\t\tvar task = gantt.getTask(itemId);\n\n\t\tif (gantt.getTaskType(task.type) == cfg.types.milestone) {\n\t\t\tcss.push(\"gantt_milestone\");\n\t\t}else if (gantt.getTaskType(task.type) == cfg.types.project) {\n\t\t\tcss.push(\"gantt_project\");\n\t\t}\n\n\t\tcss.push(\"gantt_bar_\" + gantt.getTaskType(task.type));\n\n\n\t\tif (gantt.isSummaryTask(task))\n\t\t\tcss.push(\"gantt_dependent_task\");\n\n\t\tif (gantt.isSplitTask(task) && ((task.$inlineSplit && task.$inlineSplit.length) || ((cfg.open_split_tasks && !task.$open) || !cfg.open_split_tasks))) {\n\t\t\tcss.push(\"gantt_split_parent\");\n\t\t}\n\n\t\tif (cfg.select_task && gantt.isSelectedTask(itemId)) {\n\t\t\tcss.push(\"gantt_selected\");\n\t\t}\n\n\t\tif (itemId == state.drag_id) {\n\t\t\tcss.push(\"gantt_drag_\" + state.drag_mode);\n\t\t\tif (state.touch_drag) {\n\t\t\t\tcss.push(\"gantt_touch_\" + state.drag_mode);\n\t\t\t}\n\t\t}\n\n\t\tif (state.link_source_id == itemId)\n\t\t\tcss.push(\"gantt_link_source\");\n\n\t\tif (state.link_target_id == itemId)\n\t\t\tcss.push(\"gantt_link_target\");\n\n\n\t\tif (cfg.highlight_critical_path && gantt.isCriticalTask) {\n\t\t\tif (gantt.isCriticalTask(task))\n\t\t\t\tcss.push(\"gantt_critical_task\");\n\t\t}\n\n\t\tif (state.link_landing_area &&\n\t\t\t(state.link_target_id && state.link_source_id) &&\n\t\t\t(state.link_target_id != state.link_source_id) &&\n\t\t\t(state.link_target_id == itemId || state.link_source_id == itemId)) {\n\n\t\t\tvar from_id = state.link_source_id;\n\t\t\tvar from_start = state.link_from_start;\n\t\t\tvar to_start = state.link_to_start;\n\n\t\t\tvar allowDrag = gantt.isLinkAllowed(from_id, itemId, from_start, to_start);\n\n\t\t\tvar dragClass = \"\";\n\t\t\tif (allowDrag) {\n\t\t\t\tif (to_start)\n\t\t\t\t\tdragClass = \"link_start_allow\";\n\t\t\t\telse\n\t\t\t\t\tdragClass = \"link_finish_allow\";\n\t\t\t} else {\n\t\t\t\tif (to_start)\n\t\t\t\t\tdragClass = \"link_start_deny\";\n\t\t\t\telse\n\t\t\t\t\tdragClass = \"link_finish_deny\";\n\t\t\t}\n\t\t\tcss.push(dragClass);\n\t\t}\n\t\treturn css.join(\" \");\n\t}\n\n\tfunction _render_pair(parent, css, task, content, config, margin) {\n\t\tvar state = gantt.getState();\n\t\tvar className, element;\n\t\tif (+task.start_date >= +state.min_date) {\n\t\t\tclassName = [css, config.rtl ? \"task_right\" : \"task_left\", \"task_start_date\"];\n\t\t\telement = content(className.join(\" \"));\n\t\t\telement.setAttribute(\"data-bind-property\", \"start_date\");\n\t\t\tif(margin){\n\t\t\t\telement.style.marginLeft = margin + \"px\";\n\t\t\t}\n\t\t\tparent.appendChild(element);\n\t\t}\n\n\t\tif (+task.end_date <= +state.max_date){\n\t\t\tclassName = [css, config.rtl ? \"task_left\" : \"task_right\", \"task_end_date\"];\n\t\t\telement = content(className.join(\" \"));\n\t\t\telement.setAttribute(\"data-bind-property\", \"end_date\");\n\t\t\tif(margin){\n\t\t\t\telement.style.marginRight = margin + \"px\";\n\t\t\t}\n\t\t\tparent.appendChild(element);\n\t\t}\n\n\t}\n\n\treturn _render_task_element;\n}\n\nexport default createTaskRenderer;","import isBarInViewport from \"./is_bar_in_viewport\";\nexport default function isSplitTaskInViewport(item, viewport, view, config, gantt){\n\tif (!gantt.isSplitTask(item)) {\n\t\treturn false;\n\t}\n\n\tvar range = gantt.getSubtaskDates(item.id);\n\n\treturn isBarInViewport({\n\t\tid: item.id,\n\t\tstart_date: range.start_date,\n\t\tend_date: range.end_date,\n\t\tparent: item.parent\n\t}, viewport, view, gantt);\n};","export default function(item, view, config){\n\treturn {\n\t\ttop: view.getItemTop(item.id),\n\t\theight: view.getItemHeight(item.id),\n\t\tleft: 0,\n\t\tright: Infinity\n\t};\n};","export default function getVisibleCellsRange(scale, viewport){\n\tvar firstCellIndex = 0;\n\tvar lastCellIndex = scale.left.length - 1;\n\tif(viewport){\n\t\tfor(var i = 0; i < scale.left.length; i++){\n\t\t\tvar left = scale.left[i];\n\t\t\tif(left < viewport.x){\n\t\t\t\tfirstCellIndex = i;\n\t\t\t}\n\t\t\tif(left > viewport.x_end){\n\t\t\t\tlastCellIndex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn {\n\t\tstart: firstCellIndex,\n\t\tend: lastCellIndex\n\t};\n};","import isLegacyRender from \"../is_legacy_smart_render\";\n\nexport default function isColumnVisible(columnIndex, scale, viewPort, gantt){\n\tvar width = scale.width[columnIndex];\n\tif(width <= 0){\n\t\treturn false;\n\t}\n\tif(!gantt.config.smart_rendering || isLegacyRender(gantt)){\n\t\treturn true;\n\t}\n\tvar cellLeftCoord = scale.left[columnIndex] - width;\n\tvar cellRightCoord = scale.left[columnIndex] + width;\n\treturn (cellLeftCoord <= viewPort.x_end && cellRightCoord >= viewPort.x);//do not render skipped columns\n};","export default function (items, gantt){\n\tvar placeholderConfig = gantt.config.timeline_placeholder;\n\titems = items || [];\n\tif (placeholderConfig && items.filter(e => e.id === 'timeline_placeholder_task').length === 0){\n\t\tvar state = gantt.getState();\n\t\tvar lastTaskId = null;\n\t\tvar start_date = state.min_date;\n\t\tvar end_date = state.max_date;\n\t\tif (items.length){\n\t\t\tlastTaskId = items[items.length -1].id;\n\t\t}\n\t\tvar placeholderTask = {\n\t\t\tstart_date: start_date, \n\t\t\tend_date: end_date, \n\t\t\trow_height: placeholderConfig.height || 0,\n\t\t\tid: \"timeline_placeholder_task\", \n\t\t\tunscheduled: true,\n\t\t\tlastTaskId: lastTaskId, \n\t\t\tcalendar_id: placeholderConfig.calendar || \"global\",\n\t\t\t$source:[], \n\t\t\t$target: []\n\t\t};\n\t\titems.push(placeholderTask);\n\t}\n};","import isInViewPort from \"./viewport/is_link_in_viewport\";\nimport getVisibleRange from \"./viewport/factory/get_visible_link_range\";\nimport { childrenHaveBaselines, getMaxParentHeight } from \"./baseline_helper\";\n\n\nfunction createLinkRender(gantt){\n\nfunction _render_link_element(link, view, config) {\n\tvar source = gantt.getTask(link.source);\n\tif(source.hide_bar){\n\t\treturn;\n\t}\n\n\tvar target = gantt.getTask(link.target);\n\tif(target.hide_bar){\n\t\treturn;\n\t}\n\n\tvar pt = path_builder.get_endpoint(link, view, source, target);\n\tvar dy = pt.e_y - pt.y;\n\tvar dx = pt.e_x - pt.x;\n\tif(!dx && !dy){\n\t\treturn null;\n\t}\n\n\n\tvar dots = path_builder.get_points(link, view, source, target);\n\tconst lines = drawer.get_lines(dots, view);\n\n\tconst shapes = transform_lines_to_shapes(lines.filter(l => l.size > 0), config);\n  \n\tconst div = render_shapes(shapes, view, link, config);\n\n\n\tvar css = \"gantt_task_link\";\n\n\tif (link.color) {\n\t\tcss += \" gantt_link_inline_color\";\n\t}\n\tvar cssTemplate = gantt.templates.link_class ? gantt.templates.link_class(link) : \"\";\n\tif (cssTemplate) {\n\t\tcss += \" \" + cssTemplate;\n\t}\n\n\tif (config.highlight_critical_path && gantt.isCriticalLink) {\n\t\tif (gantt.isCriticalLink(link))\n\t\t\tcss += \" gantt_critical_link\";\n\t}\n\n\tdiv.className = css;\n\n\tif(view.$config.link_attribute){\n\t\tdiv.setAttribute(view.$config.link_attribute, link.id);\n\t\tdiv.setAttribute(\"link_id\", link.id);\n\t}\n\tif (link.color) {\n\t\tdiv.style.setProperty(\"--dhx-gantt-link-background\", link.color);\n\t}\n\n\tgantt._waiAria.linkAttr(link, div);\n\n\treturn div;\n}\n\n\tfunction render_shapes(shapes, view, link, config) {\n\t\tconst container = document.createElement(\"div\");\n\n\t\tshapes.forEach(shape => {\n\t\t\tlet element;\n\t\t\tif (shape.type === 'line') {\n\t\t\t\telement = drawer.render_line(shape.data, null, view, link.source);\n\t\t\t} else if (shape.type === 'corner') {\n\t\t\t\telement = drawer.render_corner(shape.data, view);\n\t\t\t}else if (shape.type === 'arrow') {\n\t\t\t\telement = drawer.render_arrow(shape.data, config);\n\t\t\t}\n\n\t\t\tcontainer.appendChild(element);\n\t\t});\n\n\t\treturn container;\n\t}\n\n\tfunction transform_lines_to_shapes(lines, config) {\n\t\tconst radius = config.link_radius || 4;\n\t\tconst arrowSize = config.link_arrow_size || 6; // Arrow size from config\n\t\tconst shapes = [];\n\t\n\t\tfor (let i = 0; i < lines.length; i++) {\n\t\t\tconst line = lines[i];\n\t\t\tconst nextLine = lines[i + 1];\n\t\n\t\t\tif (!nextLine || config.link_radius <= 1) {\n\t\t\t\tshapes.push({ type: 'line', data: line });\n\t\t\t\tcontinue;\n\t\t\t}\n\t\n\t\t\tif (line.direction !== nextLine.direction) {\n\t\t\t\tif(line.size < radius || nextLine.size < radius){\n\t\t\t\t\tshapes.push({ type: 'line', data: line });\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tline.size -= radius;\n\t\t\t\tshapes.push({ type: 'line', data: line });\n\t\n\t\t\t\tlet cornerX = line.x;\n\t\t\t\tlet cornerY = line.y - config.link_line_width / 2;\n\t\n\t\t\t\tswitch (line.direction) {\n\t\t\t\t\tcase 'right':\n\t\t\t\t\t\tcornerX += line.size;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'left':\n\t\t\t\t\t\tcornerX -= line.size;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'down':\n\t\t\t\t\t\tcornerY += line.size;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'up':\n\t\t\t\t\t\tcornerY -= line.size;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\n\t\t\t\tconst corner = {\n\t\t\t\t\tx: cornerX,\n\t\t\t\t\ty: cornerY,\n\t\t\t\t\tdirection: { from: line.direction, to: nextLine.direction },\n\t\t\t\t\tradius\n\t\t\t\t};\n\t\t\t\tshapes.push({ type: 'corner', data: corner });\n\t\n\t\t\t\tswitch (nextLine.direction) {\n\t\t\t\t\tcase 'right':\n\t\t\t\t\t\tnextLine.x += radius;\n\t\t\t\t\t\tnextLine.size -= radius;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'left':\n\t\t\t\t\t\tnextLine.x -= radius;\n\t\t\t\t\t\tnextLine.size -= radius;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'down':\n\t\t\t\t\t\tnextLine.y += radius;\n\t\t\t\t\t\tnextLine.size -= radius;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'up':\n\t\t\t\t\t\tnextLine.y -= radius;\n\t\t\t\t\t\tnextLine.size -= radius;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tshapes.push({ type: 'line', data: line });\n\t\t\t}\n\t\t}\n\t\n\t\tconst lastLine = lines[lines.length - 1];\n\t\n\t\tif (lastLine.direction === 'right' || lastLine.direction === 'left') {\n\t\t\tlastLine.size -= arrowSize*3/4; \n\t\n\t\t\tlet arrowX = lastLine.direction === 'right' ? (lastLine.x + lastLine.size) : lastLine.x - lastLine.size - arrowSize/2;\n\t\t\tlet arrowY = lastLine.y - (config.link_line_width / 2) - (arrowSize / 2) + 1;\n\t\n\t\t\tif(lastLine.direction === 'left'){\n\t\t\t\tarrowY -= 1;// left pointing arrows for some reason need adjustments\n\t\t\t\tarrowX -= 2;\n\t\t\t}else{\n\t\t\t\tarrowX -= 1;\n\t\t\t}\n\t\t\tconst arrow = {\n\t\t\t\tx: arrowX,\n\t\t\t\ty: arrowY,\n\t\t\t\tsize: arrowSize,\n\t\t\t\tdirection: lastLine.direction\n\t\t\t};\n\t\n\t\t\tshapes.push({ type: 'line', data: lastLine });\n\t\t\tshapes.push({ type: 'arrow', data: arrow });\n\t\t} else {\n\t\t\tshapes.push({ type: 'line', data: lastLine });\n\t\t}\n\t\n\t\treturn shapes;\n\t}\n\t\n\n\nvar drawer = {\n\tcurrent_pos: null,\n\tdirs: {\"left\": 'left', \"right\": 'right', \"up\": 'up', \"down\": 'down'},\n\tpath: [],\n\tclear: function () {\n\t\tthis.current_pos = null;\n\t\tthis.path = [];\n\t},\n\tpoint: function (pos) {\n\t\tthis.current_pos = gantt.copy(pos);\n\t},\n\tget_lines: function (dots) {\n\t\tthis.clear();\n\t\tthis.point(dots[0]);\n\t\tfor (var i = 1; i < dots.length; i++) {\n\t\t\tthis.line_to(dots[i]);\n\t\t}\n\t\treturn this.get_path();\n\t},\n\tline_to: function (pos) {\n\t\tvar next = gantt.copy(pos);\n\t\tvar prev = this.current_pos;\n\n\t\tvar line = this._get_line(prev, next);\n\t\tthis.path.push(line);\n\t\tthis.current_pos = next;\n\t},\n\tget_path: function () {\n\t\treturn this.path;\n\t},\n\tget_wrapper_sizes: function (v, view, itemId) {\n\t\tvar config = view.$getConfig();\n\t\tvar res,\n\t\t\twrapper_size = config.link_wrapper_width,\n\t\t\ty = v.y - (wrapper_size) / 2;\n\t\tswitch (v.direction) {\n\t\t\tcase this.dirs.left:\n\t\t\t\tres = {\n\t\t\t\t\ttop: y,\n\t\t\t\t\theight: wrapper_size,\n\t\t\t\t\tlineHeight: wrapper_size,\n\t\t\t\t\tleft: v.x - v.size - wrapper_size / 2,\n\t\t\t\t\twidth: v.size + wrapper_size\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase this.dirs.right:\n\t\t\t\tres = {\n\t\t\t\t\ttop: y,\n\t\t\t\t\tlineHeight: wrapper_size,\n\t\t\t\t\theight: wrapper_size,\n\t\t\t\t\tleft: v.x - wrapper_size / 2,\n\t\t\t\t\twidth: v.size + wrapper_size\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase this.dirs.up:\n\t\t\t\tres = {\n\t\t\t\t\ttop: y - v.size,\n\t\t\t\t\tlineHeight: v.size + wrapper_size,\n\t\t\t\t\theight: v.size + wrapper_size,\n\t\t\t\t\tleft: v.x - wrapper_size / 2,\n\t\t\t\t\twidth: wrapper_size\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase this.dirs.down:\n\t\t\t\tres = {\n\t\t\t\t\ttop: y /*- wrapper_size/2*/,\n\t\t\t\t\tlineHeight: v.size + wrapper_size,\n\t\t\t\t\theight: v.size + wrapper_size,\n\t\t\t\t\tleft: v.x - wrapper_size / 2,\n\t\t\t\t\twidth: wrapper_size\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn res;\n\t},\n\tget_line_sizes: function (v, view) {\n\t\tvar config = view.$getConfig();\n\t\tvar res,\n\t\t\tline_size = config.link_line_width,\n\t\t\twrapper_size = config.link_wrapper_width,\n\t\t\tsize = v.size + line_size;\n\t\tswitch (v.direction) {\n\t\t\tcase this.dirs.left:\n\t\t\tcase this.dirs.right:\n\t\t\t\tres = {\n\t\t\t\t\theight: line_size,\n\t\t\t\t\twidth: size,\n\t\t\t\t\tmarginTop: (wrapper_size - line_size) / 2,\n\t\t\t\t\tmarginLeft: (wrapper_size - line_size) / 2\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase this.dirs.up:\n\t\t\tcase this.dirs.down:\n\t\t\t\tres = {\n\t\t\t\t\theight: size,\n\t\t\t\t\twidth: line_size,\n\t\t\t\t\tmarginTop: (wrapper_size - line_size) / 2,\n\t\t\t\t\tmarginLeft: (wrapper_size - line_size) / 2\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\n\n\t\treturn res;\n\t},\n\trender_line: function (v, end, view, itemId) {\n\t\tvar pos = this.get_wrapper_sizes(v, view, itemId);\n\t\tvar wrapper = document.createElement(\"div\");\n\t\twrapper.style.cssText = [\n\t\t\t\"top:\" + pos.top + \"px\",\n\t\t\t\"left:\" + pos.left + \"px\",\n\t\t\t\"height:\" + pos.height + \"px\",\n\t\t\t\"width:\" + pos.width + \"px\"\n\t\t].join(';');\n\t\twrapper.className = \"gantt_line_wrapper\";\n\n\t\tvar innerPos = this.get_line_sizes(v, view);\n\t\tvar inner = document.createElement(\"div\");\n\t\tinner.style.cssText = [\n\t\t\t\"height:\" + innerPos.height + \"px\",\n\t\t\t\"width:\" + innerPos.width + \"px\",\n\t\t\t\"margin-top:\" + innerPos.marginTop + \"px\",\n\t\t\t\"margin-left:\" + innerPos.marginLeft + \"px\"\n\t\t].join(\";\");\n\n\t\tinner.className = \"gantt_link_line_\" + v.direction;\n\t\twrapper.appendChild(inner);\n\n\t\treturn wrapper;\n\t},\n\n\trender_corner: function (corner, view) {\n\t\tconst radius = corner.radius;\n\t\tconst config = view.$getConfig();\n\t\tconst lineWidth = config.link_line_width || 2;\n\t\tconst cornerDiv = document.createElement(\"div\");\n\t\n\t\tcornerDiv.classList.add(\"gantt_link_corner\");\n\t\tcornerDiv.classList.add(`gantt_link_corner_${corner.direction.from}_${corner.direction.to}`);\n\t\n\t\tcornerDiv.style.width = `${radius}px`;\n\t\tcornerDiv.style.height = `${radius}px`;\n\t\n\t\tlet borderVertical;\n\t\tlet borderHorizontal;\n\n\t\tif (corner.direction.from === 'right' && corner.direction.to === 'down') {\n\t\t\tborderVertical = \"Right\";\n\t\t\tborderHorizontal = \"Top\";\n\t\t\tcornerDiv.style.left = `${corner.x - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y}px`;\n\t\t} else if (corner.direction.from === 'down' && corner.direction.to === 'right') {\n\t\t\tborderVertical = \"Left\";\n\t\t\tborderHorizontal = \"Bottom\";\n\t\t\tcornerDiv.style.left = `${corner.x - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y}px`;\n\t\t} else if (corner.direction.from === 'right' && corner.direction.to === 'up') {\n\t\t\tborderVertical = \"Right\";\n\t\t\tborderHorizontal = \"Bottom\";\n\t\t\tcornerDiv.style.left = `${corner.x - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y - radius}px`;\n\t\t} else if (corner.direction.from === 'up' && corner.direction.to === 'right') {\n\t\t\tborderVertical = \"Left\";\n\t\t\tborderHorizontal = \"Top\";\n\t\t\tcornerDiv.style.left = `${corner.x - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y - radius}px`;\n\t\t} else if (corner.direction.from === 'left' && corner.direction.to === 'down') {\n\t\t\tborderVertical = \"Left\";\n\t\t\tborderHorizontal = \"Top\";\n\t\t\tcornerDiv.style.left = `${corner.x - radius - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y}px`;\n\t\t} else if (corner.direction.from === 'down' && corner.direction.to === 'left') {\n\t\t\tborderVertical = \"Right\";\n\t\t\tborderHorizontal = \"Bottom\";\n\t\t\tcornerDiv.style.left = `${corner.x - radius - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y}px`;\n\t\t} else if (corner.direction.from === 'left' && corner.direction.to === 'up') {\n\t\t\tborderVertical = \"Left\";\n\t\t\tborderHorizontal = \"Bottom\";\n\t\t\tcornerDiv.style.left = `${corner.x - radius - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y - radius}px`;\n\t\t} else if (corner.direction.from === 'up' && corner.direction.to === 'left') {\n\t\t\tborderVertical = \"Right\";\n\t\t\tborderHorizontal = \"Top\";\n\t\t\tcornerDiv.style.left = `${corner.x - radius - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y - radius}px`;\n\t\t}\n\n\t\tcornerDiv.style[`border${borderHorizontal}Width`] = `${lineWidth}px`;\n\t\tcornerDiv.style[`border${borderVertical}Width`] = `${lineWidth}px`;\n\t\tcornerDiv.style[`border${borderVertical}Style`] = `solid`;\n\t\tcornerDiv.style[`border${borderHorizontal}Style`] = `solid`;\n\t\tcornerDiv.style[`border${borderHorizontal}${borderVertical}Radius`] = `${radius}px`;\n\n\t\n\t\treturn cornerDiv;\n\t},\n\n\trender_arrow(arrow, config) {\n\t\tvar div = document.createElement(\"div\");\n\t\tvar top = arrow.y;\n\t\tvar left = arrow.x;\n\t\n\t\tvar size = config.link_arrow_size;\n\t\tdiv.style.setProperty(\"--dhx-gantt-icon-size\", `${size}px`);\n\t\n\t\tvar className = \"gantt_link_arrow gantt_link_arrow_\" + arrow.direction;\n\n\t\tdiv.style.top = top + \"px\";\n\t\tdiv.style.left = left + 'px';\n\t\tdiv.className = className;\n\t\n\t\treturn div;\n\t},\n\t\n\t_get_line: function (from, to) {\n\t\tvar direction = this.get_direction(from, to);\n\t\tvar vect = {\n\t\t\tx: from.x,\n\t\t\ty: from.y,\n\t\t\tdirection: this.get_direction(from, to)\n\t\t};\n\t\tif (direction == this.dirs.left || direction == this.dirs.right) {\n\t\t\tvect.size = Math.abs(from.x - to.x);\n\t\t} else {\n\t\t\tvect.size = Math.abs(from.y - to.y);\n\t\t}\n\t\treturn vect;\n\t},\n\tget_direction: function (from, to) {\n\t\tvar direction = 0;\n\t\tif (to.x < from.x) {\n\t\t\tdirection = this.dirs.left;\n\t\t} else if (to.x > from.x) {\n\t\t\tdirection = this.dirs.right;\n\t\t} else if (to.y > from.y) {\n\t\t\tdirection = this.dirs.down;\n\t\t} else {\n\t\t\tdirection = this.dirs.up;\n\t\t}\n\t\treturn direction;\n\t}\n\n};\n\nvar path_builder = {\n\n\tpath: [],\n\tclear: function () {\n\t\tthis.path = [];\n\t},\n\tcurrent: function () {\n\t\treturn this.path[this.path.length - 1];\n\t},\n\tpoint: function (next) {\n\t\tif (!next)\n\t\t\treturn this.current();\n\n\t\tthis.path.push(gantt.copy(next));\n\t\treturn next;\n\t},\n\tpoint_to: function (direction, diff, point) {\n\t\tif (!point)\n\t\t\tpoint = gantt.copy(this.point());\n\t\telse\n\t\t\tpoint = {x: point.x, y: point.y};\n\t\tvar dir = drawer.dirs;\n\t\tswitch (direction) {\n\t\t\tcase (dir.left):\n\t\t\t\tpoint.x -= diff;\n\t\t\t\tbreak;\n\t\t\tcase (dir.right):\n\t\t\t\tpoint.x += diff;\n\t\t\t\tbreak;\n\t\t\tcase (dir.up):\n\t\t\t\tpoint.y -= diff;\n\t\t\t\tbreak;\n\t\t\tcase (dir.down):\n\t\t\t\tpoint.y += diff;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t\treturn this.point(point);\n\t},\n\tget_points: function (link, view, source, target) {\n\t\tvar pt = this.get_endpoint(link, view, source, target);\n\t\tvar xy = gantt.config;\n\n\t\tvar dy = pt.e_y - pt.y;\n\t\tvar dx = pt.e_x - pt.x;\n\n\t\tvar dir = drawer.dirs;\n\n\t\tvar rowHeight = view.getItemHeight(link.source);\n\n\t\tthis.clear();\n\t\tthis.point({x: pt.x, y: pt.y});\n\n\t\tvar shiftX = 2 * xy.link_arrow_size;//just random size for first line\n\t\tvar lineType = this.get_line_type(link, view.$getConfig());\n\n\t\tvar forward = (pt.e_x > pt.x);\n\t\tif (lineType.from_start && lineType.to_start) {\n\t\t\tthis.point_to(dir.left, shiftX);\n\t\t\tif (forward) {\n\t\t\t\tthis.point_to(dir.down, dy);\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t} else {\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t\tthis.point_to(dir.down, dy);\n\t\t\t}\n\t\t\tthis.point_to(dir.right, shiftX);\n\n\t\t} else if (!lineType.from_start && lineType.to_start) {\n\t\t\t// GS-2619. No need to add loops for the split tasks (zero dy means the tasks are on the same line)\n\t\t\tif (dy !== 0){\n\t\t\t\tforward = (pt.e_x > (pt.x + 2 * shiftX));\n\t\t\t}\n\t\t\tthis.point_to(dir.right, shiftX);\n\t\t\tif (forward) {\n\t\t\t\tdx -= shiftX;\n\t\t\t\tthis.point_to(dir.down, dy);\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t} else {\n\t\t\t\tdx -= 2 * shiftX;\n\t\t\t\tvar sign = dy > 0 ? 1 : -1;\n\n\t\t\t\tthis.point_to(dir.down, sign * (rowHeight / 2));\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t\tthis.point_to(dir.down, sign * ( Math.abs(dy) - (rowHeight / 2)));\n\t\t\t\tthis.point_to(dir.right, shiftX);\n\t\t\t}\n\n\t\t} else if (!lineType.from_start && !lineType.to_start) {\n\t\t\tthis.point_to(dir.right, shiftX);\n\t\t\tif (forward) {\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t\tthis.point_to(dir.down, dy);\n\t\t\t} else {\n\t\t\t\tthis.point_to(dir.down, dy);\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t}\n\t\t\tthis.point_to(dir.left, shiftX);\n\t\t} else if (lineType.from_start && !lineType.to_start) {\n\t\t\t// GS-2619. No need to add loops for the split tasks (zero dy means the tasks are on the same line)\n\t\t\tif (dy !== 0){\n\t\t\t\tforward = (pt.e_x > (pt.x - 2 * shiftX));\n\t\t\t}\n\t\t\tthis.point_to(dir.left, shiftX);\n\n\t\t\tif (!forward) {\n\t\t\t\tdx += shiftX;\n\t\t\t\tthis.point_to(dir.down, dy);\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t} else {\n\t\t\t\tdx += 2 * shiftX;\n\t\t\t\tvar sign = dy > 0 ? 1 : -1;\n\t\t\t\tthis.point_to(dir.down, sign * (rowHeight / 2));\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t\tthis.point_to(dir.down, sign * ( Math.abs(dy) - (rowHeight / 2)));\n\t\t\t\tthis.point_to(dir.left, shiftX);\n\t\t\t}\n\n\t\t}\n\n\t\treturn this.path;\n\t},\n\tget_line_type: function(link, config){\n\t\tvar types = config.links;\n\t\tvar from_start = false, to_start = false;\n\t\tif (link.type == types.start_to_start) {\n\t\t\tfrom_start = to_start = true;\n\t\t} else if (link.type == types.finish_to_finish) {\n\t\t\tfrom_start = to_start = false;\n\t\t} else if (link.type == types.finish_to_start) {\n\t\t\tfrom_start = false;\n\t\t\tto_start = true;\n\t\t} else if (link.type == types.start_to_finish) {\n\t\t\tfrom_start = true;\n\t\t\tto_start = false;\n\t\t} else {\n\t\t\tgantt.assert(false, \"Invalid link type\");\n\t\t}\n\n\t\tif(config.rtl){\n\t\t\tfrom_start = !from_start;\n\t\t\tto_start = !to_start;\n\t\t}\n\n\t\treturn {from_start: from_start, to_start: to_start};\n\t},\n\n\tget_endpoint: function (link, view, source, target) {\n\t\tvar config = view.$getConfig();\n\n\t\tvar lineType = this.get_line_type(link, config);\n\t\tvar from_start = lineType.from_start,\n\t\t\tto_start = lineType.to_start;\n\n\t\tvar from = getMilestonePosition(source, view, config),\n\t\t\tto = getMilestonePosition(target, view, config);\n\n\t\treturn {\n\t\t\tx: from_start ? from.left : (from.left + from.width),\n\t\t\te_x: to_start ? to.left : (to.left + to.width),\n\t\t\ty: from.top + (from.rowHeight/2) - 1,\n\t\t\te_y: to.top + (to.rowHeight/2) - 1\n\t\t};\n\t}\n};\n\nfunction getMilestonePosition(task, view, config){\n\tvar pos = view.getItemPosition(task);\n\n\t// GS-2270: Link to the split children shouldn't exceed the parent row height\n\tlet splitParams = getMaxParentHeight(gantt, view, task);\n\tlet maxHeight = splitParams.maxHeight;\n\n\tlet splitChild = splitParams.splitChild;\n\tconst baselinesOnDifferentRow = gantt.config.baselines && (gantt.config.baselines.render_mode == \"separateRow\" || gantt.config.baselines.render_mode == \"individualRow\");\n\tconst baselines = baselinesOnDifferentRow && task.baselines && task.baselines.length;\n\n\tif (splitParams.shrinkHeight){\n\t\tpos.rowHeight = maxHeight;\n\t}\n\n\tlet milestoneWidth;\n\tlet milestoneTask = gantt.getTaskType(task.type) == config.types.milestone;\n\tif(milestoneTask){\n\t\tlet milestoneHeight = view.getBarHeight(task.id, true);\n\t\tmilestoneWidth = Math.sqrt(2*milestoneHeight*milestoneHeight);\n\t\tif (splitParams.shrinkHeight && maxHeight < milestoneHeight){\n\t\t\tmilestoneHeight = maxHeight;\n\t\t\tmilestoneWidth = maxHeight;\n\t\t}\n\t\tpos.left -= milestoneWidth / 2;\n\t\tpos.width = milestoneWidth;\n\t} \n\tif (splitChild){\n\t\tif (maxHeight >= pos.height) {\n\t\t\tconst siblingBaselines = childrenHaveBaselines(gantt, task.parent);\n\t\t\tif (baselines || siblingBaselines){\n\t\t\t\tif (milestoneTask){\n\t\t\t\t\tpos.rowHeight = pos.height + 4;\n\t\t\t\t\tpos.left += (pos.width - pos.rowHeight + 4) / 2;\n\t\t\t\t\tpos.width = pos.rowHeight - 3;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tpos.rowHeight = pos.height + 6;\n\t\t\t\t}\n\t\t\t} else if (milestoneTask) {\n\t\t\t\tpos.left += (milestoneWidth - pos.height) / 2;\n\t\t\t}\n\t\t} else {\n\t\t\tpos.rowHeight = maxHeight + 2;\n\t\t\tif (milestoneTask){\n\t\t\t\tpos.left += (pos.width - pos.rowHeight + 4) / 2;\n\t\t\t\tpos.width = pos.rowHeight - 3;\n\t\t\t}\n\t\t}\n\t} else if (baselines){\n\t\tpos.rowHeight = pos.height + 4;\n\t}\n\n\treturn pos;\n}\n\n\nreturn {\n\trender: _render_link_element,\n\tupdate: null,\n\t//getRectangle: getLinkRectangle\n\tisInViewPort: isInViewPort,\n\tgetVisibleRange: getVisibleRange()\n};\n}\n\nexport default createLinkRender;","export default function(item, viewport, view, config, gantt){\n    // GS-2481 and GS-1715, don't remove selected task when using keyboard shortcuts and when the inline editor is opened\n    if(gantt.$ui.getView(\"grid\") && ((gantt.config.keyboard_navigation && gantt.getSelectedId()) || (gantt.ext.inlineEditors && gantt.ext.inlineEditors.getState().id))) {\n\t\t//GS-2661: selected task might be collapsed\n\t\tif(!item.$expanded_branch) return false;\n\t\treturn true;\n\t}\n    var top = view.getItemTop(item.id);\n\tvar height = view.getItemHeight(item.id);\n\n\tif(top > viewport.y_end || top + height < viewport.y){\n\t\treturn false;\n\t}\n\n\treturn true;\n};","import * as helpers from \"../utils/helpers\";\n\nexport default function createResourceTimelineBuilder(gantt){\n\n\tlet resourceTaskCache = {};\n\n\tgantt.$data.tasksStore.attachEvent(\"onStoreUpdated\", function(){\n\t\tresourceTaskCache = {};\n\t});\n\n\tfunction getResourceLoad(resource, resourceProperty, scale, timeline){\n\t\tconst cacheKey = resource.id + \"_\" + resourceProperty  + \"_\" + scale.unit + \"_\" + scale.step;\n\t\tlet res;\n\t\tif (!resourceTaskCache[cacheKey]) {\n\t\t\tres = resourceTaskCache[cacheKey] = calculateResourceLoad(resource, resourceProperty, scale, timeline);\n\n\t\t} else {\n\t\t\tres = resourceTaskCache[cacheKey];\n\t\t}\n\t\treturn res;\n\t}\n\n\tfunction calculateResourceLoadFromAssignments(items, scale, assignmentsPassed){\n\t\tconst scaleUnit = scale.unit;\n\t\tconst scaleStep = scale.step;\n\t\tconst timegrid = {};\n\n\t\tconst precalculatedTimes = {};\n\t\tfor (let i = 0; i < items.length; i++) {\n\t\t\tconst item = items[i];\n\t\t\tlet task = item;\n\t\t\tif(assignmentsPassed){\n\t\t\t\ttask = gantt.getTask(item.task_id);\n\t\t\t}\n\t\t\tif (task.unscheduled){\n\t\t\t\tcontinue; // do not process assignments for unscheduled tasks\n\t\t\t}\n\t\t\tlet minDate = (item.start_date || task.start_date);\n\t\t\tlet maxDate = (item.end_date || task.end_date);\n\t\t\tif(assignmentsPassed){\n\t\t\t\tif(item.start_date){\n\t\t\t\t\tminDate = new Date(Math.max(item.start_date.valueOf(), task.start_date.valueOf()));\n\t\t\t\t}\n\t\t\t\tif(item.end_date){\n\t\t\t\t\tmaxDate = new Date(Math.min(item.end_date.valueOf(), task.end_date.valueOf()));\n\t\t\t\t}\n\t\t\t\t// GS-2063: handle case with fixedDates mode\n\t\t\t\tif(item.mode && item.mode == \"fixedDates\"){\n\t\t\t\t\tminDate = item.start_date;\n\t\t\t\t\tmaxDate = item.end_date;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet firstColumn = helpers.findBinary(scale.trace_x, minDate.valueOf());\n\t\t\tlet minScaleDate = new Date(scale.trace_x[firstColumn] || gantt.date[scaleUnit + \"_start\"](new Date(minDate)));\n\t\t\t// GS-2307: need to take into account that task could start before the min scale date\n\t\t\t// so the task would be added to timegrid\n\t\t\tlet currDate = new Date(Math.min(minDate.valueOf(), minScaleDate.valueOf())); \n\n\t\t\tlet calendar = gantt.config.work_time ? gantt.getTaskCalendar(task) : gantt;\n\t\t\tprecalculatedTimes[calendar.id] = {};\n\t\t\twhile (currDate < maxDate) {\n\t\t\t\tconst cachedTimes = precalculatedTimes[calendar.id];\n\n\t\t\t\tlet date = currDate;\n\t\t\t\tconst timestamp = date.valueOf();\n\n\t\t\t\tcurrDate = gantt.date.add(currDate, scaleStep, scaleUnit);\n\n\t\t\t\tif(cachedTimes[timestamp] === false){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (!timegrid[timestamp]){\n\t\t\t\t\ttimegrid[timestamp] = {tasks: [], assignments: []};\n\t\t\t\t}\n\n\t\t\t\ttimegrid[timestamp].tasks.push(task);\n\t\t\t\tif(assignmentsPassed){\n\t\t\t\t\ttimegrid[timestamp].assignments.push(item);\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t\treturn timegrid;\n\t}\n\n\tfunction calculateResourceLoad(resource, resourceProperty, scale, timeline) {\n\n\t\tlet items;\n\t\tlet assignmentsPassed = false;\n\t\tlet timegrid = {};\n\n\t\tif(gantt.config.process_resource_assignments && resourceProperty === gantt.config.resource_property){\n\t\t\tif(resource.$role == \"task\"){\n\t\t\t\titems = gantt.getResourceAssignments(resource.$resource_id, resource.$task_id);\n\t\t\t}else{\n\t\t\t\titems = gantt.getResourceAssignments(resource.id);\n\t\t\t}\n\n\t\t\tassignmentsPassed = true;\n\t\t}else if(resource.$role == \"task\"){\n\t\t\titems = [];\n\t\t}else{\n\t\t\titems = gantt.getTaskBy(resourceProperty, resource.id);\n\t\t}\n\n\t\ttimegrid = calculateResourceLoadFromAssignments(items, scale, assignmentsPassed);\n\t\tconst scaleUnit = scale.unit;\n\t\tconst scaleStep = scale.step;\n\n\t\tconst timetable = [];\n\t\tlet start, end, tasks, assignments, cell;\n\t\tconst config = timeline.$getConfig();\n\n\t\tfor(let i = 0; i < scale.trace_x.length; i++){\n\t\t\tstart = new Date(scale.trace_x[i]);\n\t\t\tend = gantt.date.add(start, scaleStep, scaleUnit);\n\t\t\tcell = timegrid[start.valueOf()] || {};\n\t\t\ttasks = cell.tasks || [];\n\t\t\tassignments = cell.assignments || [];\n\t\t\tif(tasks.length || config.resource_render_empty_cells){\n\t\t\t\ttimetable.push({\n\t\t\t\t\tstart_date: start,\n\t\t\t\t\tend_date: end,\n\t\t\t\t\ttasks: tasks,\n\t\t\t\t\tassignments: assignments\n\t\t\t\t});\n\t\t\t}else{\n\t\t\t\ttimetable.push(null);\n\t\t\t}\n\t\t}\n\n\t\treturn timetable;\n\t}\n\n\n\n\treturn getResourceLoad;\n};","import getRectangle from \"./viewport/get_bg_row_rectangle\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport getVisibleCellsRange from \"./viewport/get_visible_cells_range\";\nimport isColumnVisible from \"./viewport/is_column_visible\";\nimport resourceTimetable from \"../../resource_timetable_builder\";\n\nfunction renderBar(level, start, end, timeline){\n\tvar top = (1 - (level*1||0))*100;\n\tvar left = timeline.posFromDate(start);\n\tvar right = timeline.posFromDate(end);\n\tvar element = document.createElement(\"div\");\n\telement.className = \"gantt_histogram_hor_bar\";\n\telement.style.top = top + '%';\n\telement.style.left = left + \"px\";\n\telement.style.width = (right - left + 1) + \"px\";\n\treturn element;\n}\nfunction renderConnection(prevLevel, nextLevel, left){\n\tif(prevLevel === nextLevel){\n\t\treturn null;\n\t}\n\n\tvar top = 1 - Math.max(prevLevel, nextLevel);\n\tvar height = Math.abs(prevLevel - nextLevel);\n\tvar element = document.createElement(\"div\");\n\telement.className = \"gantt_histogram_vert_bar\";\n\telement.style.top = top*100 + \"%\";\n\telement.style.height = height*100 + \"%\";\n\telement.style.left = left + \"px\";\n\n\treturn element;\n}\n\nfunction generateRenderResourceHistogram(gantt){\n\tvar getResourceLoad = resourceTimetable(gantt);\n\tvar renderedHistogramCells = {};\n\tvar renderedHistogramRows = {};\n\tvar renderedHistogramCapacity = {};\n\n\tfunction detachRenderedHistogramCell(id, index){\n\n\t\tvar renderedRow = renderedHistogramCells[id];\n\t\tif(renderedRow && renderedRow[index] &&\n\t\t\trenderedRow[index].parentNode\n\t\t\t){\n\t\t\t\trenderedRow[index].parentNode.removeChild(renderedRow[index]);\n\t\t\t}\n\t}\n\n\tfunction renderHistogramLine(capacity, timeline, maxCapacity, viewport){\n\t\tvar scale = timeline.getScale();\n\n\t\tvar el = document.createElement(\"div\");\n\n\t\tvar range = getVisibleCellsRange(scale, viewport);\n\t\tfor (var i = range.start; i <= range.end; i++) {\n\t\t\tvar colStart = scale.trace_x[i];\n\t\t\tvar colEnd = scale.trace_x[i + 1] || gantt.date.add(colStart, scale.step, scale.unit);\n\t\t\tvar col = scale.trace_x[i].valueOf();\n\t\t\tvar level = Math.min(capacity[col]/maxCapacity, 1) || 0;\n\t\t\t// do not render histogram for lines with below zero capacity, as it's reserved for folders\n\t\t\tif(level < 0){\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tvar nextLevel = Math.min(capacity[colEnd.valueOf()]/maxCapacity, 1) || 0;\n\t\t\tvar bar = renderBar(level, colStart, colEnd, timeline);\n\t\t\tif(bar){\n\t\t\t\tel.appendChild(bar);\n\t\t\t}\n\t\t\tvar connection = renderConnection(level, nextLevel, timeline.posFromDate(colEnd));\n\t\t\tif(connection){\n\t\t\t\tel.appendChild(connection);\n\t\t\t}\n\n\t\t}\n\t\treturn el;\n\t}\n\n\tfunction renderCapacityElement(resource, sizes, capacityMatrix, config, timeline, maxCapacity, viewport){\n\n\t\tvar renderedElement = renderedHistogramCapacity[resource.id];\n\t\tif(renderedElement && renderedElement.parentNode){\n\t\t\trenderedElement.parentNode.removeChild(renderedElement);\n\t\t}\n\n\t\tvar capacityElement = renderHistogramLine(capacityMatrix, timeline, maxCapacity, viewport);\n\t\tif (capacityElement && sizes) {\n\t\t\tcapacityElement.setAttribute(\"data-resource-id\", resource.id);\n\t\t\tcapacityElement.setAttribute(timeline.$config.item_attribute, resource.id);\n\t\t\tcapacityElement.style.position = \"absolute\";\n\t\t\tcapacityElement.style.top = (sizes.top + 1) + \"px\";\n\t\t\tcapacityElement.style.height = (timeline.getItemHeight(resource.id) - 1) + \"px\";\n\t\t\tcapacityElement.style.left = 0;\n\t\t}\n\t\treturn capacityElement;\n\t}\n\n\tfunction renderHistogramCell(resource, sizes, maxCapacity, config, templates, day, timeline){\n\t\tvar css = templates.histogram_cell_class(day.start_date, day.end_date, resource, day.tasks, day.assignments);\n\t\tvar content = templates.histogram_cell_label(day.start_date, day.end_date, resource, day.tasks, day.assignments);\n\t\tvar fill = templates.histogram_cell_allocated(day.start_date, day.end_date, resource, day.tasks, day.assignments);\n\t\tvar height = timeline.getItemHeight(resource.id) - 1;\n\t\tif(css || content){\n\t\t\tvar el = document.createElement('div');\n\t\t\tel.className = [\"gantt_histogram_cell\", css].join(\" \");\n\t\t\tel.setAttribute(timeline.$config.item_attribute, resource.id);\n\t\t\tel.style.cssText = [\n\t\t\t\t'left:' + sizes.left + 'px',\n\t\t\t\t'width:' + sizes.width + 'px',\n\t\t\t\t'height:' + (height) + 'px',\n\t\t\t\t'line-height:' + (height) + 'px',\n\t\t\t\t'top:' + (sizes.top + 1) + 'px'\n\t\t\t].join(\";\");\n\n\n\t\t\tif (content) {\n\t\t\t\tcontent = \"<div class='gantt_histogram_label'>\" + content +\"</div>\";\n\t\t\t}\n\n\t\t\tif (fill) {\n\t\t\t\tcontent = \"<div class='gantt_histogram_fill' style='height:\"+(Math.min(fill/maxCapacity||0, 1)*100)+\"%;'></div>\" + content;\n\t\t\t}\n\n\t\t\tif (content) {\n\t\t\t\tel.innerHTML = content;\n\t\t\t}\n\n\t\t\treturn el;\n\t\t}\n\t\treturn null;\n\t}\n\n\tfunction renderResourceHistogram(resource, timeline, config, viewport) {\n\t\tvar templates = timeline.$getTemplates();\n\t\tvar scale = timeline.getScale();\n\t\tvar timetable = getResourceLoad(resource, config.resource_property, scale, timeline);\n\n\t\tvar cells = [];\n\t\tvar capacityMatrix = {};\n\t\tvar maxCapacity = resource.capacity || timeline.$config.capacity || 24;\n\t\trenderedHistogramCells[resource.id] = {};\n\t\trenderedHistogramRows[resource.id] = null;\n\t\trenderedHistogramCapacity[resource.id] = null;\n\n\t\tvar smartRendering = !!viewport;//no viewport means smart rendering is disabled\n\n\t\tvar range = getVisibleCellsRange(scale, viewport);\n\t\tfor (var columnIndex = range.start; columnIndex <= range.end; columnIndex++) {\n\n\t\t\tvar day = timetable[columnIndex];\n\t\t\tif(!day){\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(smartRendering && !isColumnVisible(columnIndex, scale, viewport, gantt)){\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar capacity = templates.histogram_cell_capacity(day.start_date, day.end_date, resource, day.tasks, day.assignments);\n\t\t\tcapacityMatrix[day.start_date.valueOf()] = capacity || 0;\n\t\t\tvar sizes = timeline.getItemPosition(resource, day.start_date, day.end_date);\n\n\t\t\tvar el = renderHistogramCell(resource, sizes, maxCapacity, config, templates, day, timeline);\n\t\t\tif(el){\n\t\t\t\tcells.push(el);\n\t\t\t\trenderedHistogramCells[resource.id][columnIndex] = el;\n\t\t\t}\n\t\t}\n\n\t\tvar row = null;\n\t\tif (cells.length) {\n\t\t\trow = document.createElement(\"div\");\n\t\t\tfor (var i = 0; i < cells.length; i++) {\n\t\t\t\trow.appendChild(cells[i]);\n\t\t\t}\n\n\t\t\tvar capacityElement = renderCapacityElement(resource, sizes, capacityMatrix, config, timeline, maxCapacity, viewport);\n\t\t\tif(capacityElement){\n\t\t\t\trow.appendChild(capacityElement);\n\t\t\t\trenderedHistogramCapacity[resource.id] = capacityElement;\n\t\t\t}\n\t\t\trenderedHistogramRows[resource.id] = row;\n\t\t}\n\n\t\treturn row;\n\t}\n\n\tfunction updateResourceHistogram(resource, node, timeline, config, viewport) {\n\t\tvar templates = timeline.$getTemplates();\n\t\tvar scale = timeline.getScale();\n\t\tvar timetable = getResourceLoad(resource, config.resource_property, scale, timeline);\n\t\tvar maxCapacity = resource.capacity || timeline.$config.capacity || 24;\n\t\tvar capacityMatrix = {};\n\n\t\tvar smartRendering = !!viewport;//no viewport means smart rendering is disabled\n\n\t\tvar range = getVisibleCellsRange(scale, viewport);\n\n\t\tvar checkedColumns = {};\n\t\tif(renderedHistogramCells && renderedHistogramCells[resource.id]){\n\t\t\tfor(var i in renderedHistogramCells[resource.id]){\n\t\t\t\tcheckedColumns[i] = i;\n\t\t\t}\n\t\t}\n\n\t\tfor (var columnIndex = range.start; columnIndex <= range.end; columnIndex++) {\n\t\t\tvar day = timetable[columnIndex];\n\t\t\tcheckedColumns[columnIndex] = false;\n\t\t\tif(!day){\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar capacity = templates.histogram_cell_capacity(day.start_date, day.end_date, resource, day.tasks, day.assignments);\n\t\t\tcapacityMatrix[day.start_date.valueOf()] = capacity || 0;\n\t\t\tvar sizes = timeline.getItemPosition(resource, day.start_date, day.end_date);\n\n\t\t\tif(smartRendering && !isColumnVisible(columnIndex, scale, viewport, gantt)){\n\t\t\t\tdetachRenderedHistogramCell(resource.id, columnIndex);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar renderedCell = renderedHistogramCells[resource.id];\n\t\t\tif(!renderedCell || !renderedCell[columnIndex]){\n\t\t\t\tvar el = renderHistogramCell(resource, sizes, maxCapacity, config, templates, day, timeline);\n\t\t\t\tif(el){\n\t\t\t\t\tnode.appendChild(el);\n\t\t\t\t\trenderedHistogramCells[resource.id][columnIndex] = el;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(renderedCell && renderedCell[columnIndex] && !renderedCell[columnIndex].parentNode){\n\t\t\t\tnode.appendChild(renderedCell[columnIndex]);\n\t\t\t}\n\t\t}\n\n\t\tfor(var i in checkedColumns){\n\t\t\tif(checkedColumns[i] !== false){\n\t\t\t\tdetachRenderedHistogramCell(resource.id, i);\n\t\t\t}\n\t\t}\n\n\t\tvar capacityElement = renderCapacityElement(resource, sizes, capacityMatrix, config, timeline, maxCapacity, viewport);\n\t\tif(capacityElement){\n\t\t\tnode.appendChild(capacityElement);\n\t\t\trenderedHistogramCapacity[resource.id] = capacityElement;\n\t\t}\n\t}\n\n\treturn {\n\t\trender: renderResourceHistogram,\n\t\tupdate: updateResourceHistogram,\n\t\tgetRectangle: getRectangle,\n\t\tgetVisibleRange: getVisibleRange\n\t};\n}\n\nexport default generateRenderResourceHistogram;","import isBarInViewport from \"./is_bar_in_viewport\";\nexport default function areDatesInViewPort(task, viewport, view, config, gantt, dateProperties ){\n\tconst bar = {\n\t\tid: task.id,\n\t\tparent: task.id\n\t};\n\n\tfunction checkTaskProperties(task){\n\t\tconst hasAllDates = task[dateProperties.start_date] && task[dateProperties.end_date];\n\t\tif (!hasAllDates) {\n\t\t\treturn false;\n\t\t}\n\t\n\t\tfor (let i = 0; i < dateProperties.length; i++) {\n\t\t\tif (!task[dateProperties[i]]){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tconst taskProperties = checkTaskProperties(task);\n\tlet childProperties = false;\n\n\tif (taskProperties){\n\t\tbar.start_date = task[dateProperties.start_date];\n\t\tbar.end_date = task[dateProperties.end_date];\t\n\t}\n\n\tif (task.render == \"split\"){\n\t\tgantt.eachTask(function(child){\n\t\t\tif (checkTaskProperties(child)){\n\t\t\t\tchildProperties = true;\n\t\t\t\tbar.start_date = bar.start_date || child[dateProperties.start_date];\n\t\t\t\tbar.end_date = bar.end_date || child[dateProperties.end_date];\n\n\t\t\t\tif (bar.start_date < child[dateProperties.start_date]){\n\t\t\t\t\tbar.start_date = child[dateProperties.start_date];\n\t\t\t\t}\n\t\t\t\tif (bar.end_date > child[dateProperties.end_date]){\n\t\t\t\t\tbar.end_date = child[dateProperties.end_date];\t\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tif (taskProperties || childProperties){\n\t\treturn isBarInViewport(bar, viewport, view, gantt);\n\t} else {\n\t\treturn false;\n\t}\n};","import getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport areDatesInViewPort from \"./viewport/are_dates_in_viewport\";\nimport { childrenHaveBaselines, getAdjustedPosition, isSplitParent } from \"./baseline_helper\";\n\nfunction isConstraintInViewPort (item, viewport, view, config, gantt){\n  if (shouldRenderConstraints(gantt)){\n    const dateProperties = {\n      start_date: \"constraint_date\",\n      end_date: \"constraint_date\",\n      additional_properties: [\"constraint_type\"]\n    };\n    return areDatesInViewPort(item, viewport, view, config, gantt, dateProperties);\n  } else {\n    // don't process constraints when they shouldn't be displayed\n    return false;\n  }\n}\n\nfunction shouldRenderConstraints(gantt){\n  const autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\n  if(!autoSchedulingConfig.apply_constraints){\n    return false;\n  }\n  if (autoSchedulingConfig.enabled && autoSchedulingConfig.show_constraints !== false){\n    return true;\n  }\n}\n\nfunction createTaskRenderer(gantt) {\n  // we need that for the use case when the constraints have different names\n  const constraintNames = {};\n  for (let prop in gantt.config.constraint_types) {\n    constraintNames[gantt.config.constraint_types[prop]] = prop;\n  }\n\n  function getConstraintName(task) {\n    const constraintValue = gantt.getConstraintType(task);\n    const commonName = constraintNames[constraintValue].toLowerCase();\n    return commonName;\n  }\n\n  function generateConstraintNode(task, timeline, childBaselines){\n    const constraintType = getConstraintName(task);\n    if (constraintType == \"asap\" || constraintType == \"alap\"){\n      return false;\n    }\n    const el = document.createElement(\"div\");\n    const sizes = gantt.getTaskPosition(task, task.constraint_date, task.constraint_date);\n\n    const heightLimit = 30;\n    let { height, marginTop } = getAdjustedPosition(gantt, timeline, sizes, heightLimit, task, childBaselines);\n\n    let width = height;\n\n    let marginLeft = 0;\n    switch (constraintType) {\n      case \"snet\":\n      case \"fnet\":\n      case \"mso\":\n        if (gantt.config.rtl){\n          marginLeft = 1;\n        }\n        else {\n          marginLeft = -width - 1;\n        }\n\n        break;\n      case \"snlt\":\n      case \"fnlt\":\n      case \"mfo\":\n        if (gantt.config.rtl){\n          marginLeft = -width - 1;\n        }\n        else {\n          marginLeft = 1;\n        }\n        break;\n\n    }\n\n    if (task.type === gantt.config.types.milestone){\n      marginTop -= 1;\n    }\n\n    el.style.height = height + \"px\";\n    el.style.width = width + \"px\";\n\n    el.style.left = sizes.left + \"px\";\n    el.style.top = sizes.top + \"px\";\n    \n    el.style.marginLeft = marginLeft + \"px\";\n    el.style.marginTop = marginTop + \"px\";\n\n    el.className = \"gantt_constraint_marker gantt_constraint_marker_\" + constraintType;\n    \n    switch (constraintType) {\n      case \"snet\":\n      case \"snlt\":\n      case \"fnet\":\n      case \"fnlt\":\n        el.innerHTML = `<svg width=\"32\" height=\"32\" viewBox=\"0 0 32 32\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<g id=\"Start No Later Than\">\n<line id=\"Line 3\" x1=\"30.5\" y1=\"6.92097e-08\" x2=\"30.5\" y2=\"32\" stroke=\"#555D63\" stroke-width=\"3\" stroke-dasharray=\"3 3\"/>\n<path id=\"Vector\" d=\"m 18.3979,23.5 v -6 H 3.05161 L 3,14.485 H 18.3979 V 8.5 L 27,16 Z\" fill=\"#555D63\"/>\n</g>\n</svg>\n`;\n      break;\n      case \"mfo\":\n      case \"mso\":\n        el.innerHTML = `<svg width=\"32\" height=\"32\" viewBox=\"0 0 32 32\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<g id=\"Must Start On \">\n<path id=\"Vector\" d=\"m 18.3979,23.5 v -6 H 3.05161 L 3,14.485 H 18.3979 V 8.5 L 27,16 Z\" fill=\"#555D63\"/>\n<line id=\"line\" x1=\"30.5\" y1=\"-6.55671e-08\" x2=\"30.5\" y2=\"32\" stroke=\"black\" stroke-opacity=\"0.7\" stroke-width=\"3\"/>\n</g>\n</svg>\n`;\n        break;\n    }\n    \n    \n    el.setAttribute(\"data-task-id\", task.id);\n\n    return el;\n  }\n\n  function renderConstraints(task, timeline, config, viewPort) {\n    if (shouldRenderConstraints(gantt)){\n      const constraintNodes = document.createElement(\"div\");\n      constraintNodes.className = \"gantt_constraint_nodes\";\n      constraintNodes.setAttribute(\"data-task-row-id\", task.id);\n  \n      if (task.constraint_date && task.constraint_type) {\n        const taskConstraint = generateConstraintNode(task, timeline);\n        if (taskConstraint){\n          constraintNodes.appendChild(taskConstraint);  \n        }\n      }\n\n      if (isSplitParent(task)){\n        const childBaselines = childrenHaveBaselines(gantt, task.id);\n        gantt.eachTask(function(child){\n          if (child.constraint_date && child.constraint_type) {\n            const childConstraint = generateConstraintNode(child, timeline, childBaselines);\n            if (childConstraint){\n              constraintNodes.appendChild(childConstraint);\n            }\n          }\n        }, task.id);\n      }\n  \n      if (constraintNodes.childNodes.length){\n        return constraintNodes;\n      }\n  \n    }\n  }\n  return {\n    render: renderConstraints,\n    isInViewPort: isConstraintInViewPort,\n    getVisibleRange: getVisibleRange\n  };\n}\n\nexport default createTaskRenderer;\n","import getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport areDatesInViewPort from \"./viewport/are_dates_in_viewport\";\nimport { childrenHaveBaselines, getAdjustedPosition, isSplitParent } from \"./baseline_helper\";\n\nfunction isDeadlineInViewPort (item, viewport, view, config, gantt){\n\tconst dateProperties = {\n\t\tstart_date: \"deadline\",\n\t\tend_date: \"deadline\"\n\t};\n\treturn areDatesInViewPort(item, viewport, view, config, gantt, dateProperties);\n}\n\nfunction createTaskRenderer(gantt) {\n\n  function generateDeadlineNode(task, timeline, childBaselines){\n    const el = document.createElement(\"div\");\n\n    const sizes = gantt.getTaskPosition(task, task.deadline, task.deadline);\n\n    const heightLimit = 20;\n    const { height, marginTop } = getAdjustedPosition(gantt, timeline, sizes, heightLimit, task, childBaselines);\n    \n    let width = height;\n\n    if (gantt.config.rtl){\n      sizes.left += width;\n    }\n\n    el.style.left = sizes.left - width + \"px\";\n    el.style.top = sizes.top + \"px\";\n    el.style.marginTop = marginTop + \"px\";\n\n    el.style.width = width + \"px\";\n    el.style.height = height + \"px\";\n\n    el.style.fontSize = height + \"px\";\n\n    el.className = \"gantt_task_deadline\";\n    el.setAttribute(\"data-task-id\", task.id);\n\n    return el;\n  }\n\n  function renderDeadline(task, timeline, config, viewPort) {\n    const deadlineNodes = document.createElement(\"div\");\n    deadlineNodes.className = \"gantt_deadline_nodes\";\n    deadlineNodes.setAttribute(\"data-task-row-id\", task.id);\n\n    if (task.deadline) {\n      const taskDeadline = generateDeadlineNode(task, timeline);\n      deadlineNodes.appendChild(taskDeadline);\n    }\n    if (isSplitParent(task)){\n      const childBaselines = childrenHaveBaselines(gantt, task.id);\n      gantt.eachTask(function(child){\n        if (child.deadline){\n          const childDeadline = generateDeadlineNode(child, timeline, childBaselines);\n          deadlineNodes.appendChild(childDeadline);\n        }\n      }, task.id);\n    }\n\n    if (deadlineNodes.childNodes.length){\n      return deadlineNodes;\n    }\n  }\n  return {\n    render: renderDeadline,\n    isInViewPort: isDeadlineInViewPort,\n    getVisibleRange: getVisibleRange\n  };\n}\n\nexport default createTaskRenderer;\n","import getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport areDatesInViewPort from \"./viewport/are_dates_in_viewport\";\nimport { getMaxParentHeight, getMilestoneHeight, getInvertedMilestoneHeight, isSplitParent } from \"./baseline_helper\";\n\nfunction isBaselineInViewPort (task, viewport, view, config, gantt){\n  let inViewport = false;\n  const dateProperties = {\n    start_date: \"start_date\",\n    end_date: \"end_date\"\n  };\n  if (task.type == gantt.config.types.milestone){\n    dateProperties.end_date = dateProperties.start_date;\n  }\n\n  if (task.baselines){\n    inViewport = iterateBaselines(task, viewport, view, config, gantt, dateProperties);\n  }\n  if (isSplitParent(task)){\n    gantt.eachTask(function(child){\n      if (inViewport){\n        return;\n      }\n      if (child.baselines && child.baselines.length) {\n        if (child.type == gantt.config.types.milestone){\n          dateProperties.end_date = dateProperties.start_date;\n        }      \n        if (iterateBaselines(child, viewport, view, config, gantt, dateProperties)){\n          inViewport = true;\n        }\n      }\n    }, task.id);\n  }\n\n  return inViewport;\n}\n\nfunction iterateBaselines(task, viewport, view, config, gantt, dateProperties){\n  for (var i = 0; i < task.baselines.length; i++) {\n    const baseline = {\n      id: task.id,\n      parent: task.parent,\n      start_date: task.baselines[i].start_date,\n      end_date: task.baselines[i].end_date\n    };\n    if (areDatesInViewPort(baseline, viewport, view, config, gantt, dateProperties)){\n      return true;\n    }\n  }\n}\n\nfunction createBaselineRenderer(gantt) {\n\n  function generateBaselineNode(task, baseline, index, timeline, splitChild){\n    const el = document.createElement(\"div\");\n    let baselineEnd = baseline.end_date;\n    let milestoneTask = task.type === gantt.config.types.milestone;\n    if (milestoneTask){\n      baselineEnd = baseline.start_date;\n    }\n    const sizes = gantt.getTaskPosition(task, baseline.start_date, baselineEnd);\n\n    let milestoneMarginTop = 0;\n    let milestoneWidth;\n    if (milestoneTask){\n      let milestoneHeight = timeline.getBarHeight(task.id, true);\n      milestoneWidth = getMilestoneHeight(milestoneHeight);\n      milestoneMarginTop = Math.floor((milestoneWidth - milestoneHeight) / 4);\n    }\n\n    let parentHeight = getMaxParentHeight(gantt, timeline, task, sizes.rowHeight);\n    let maxHeight = parentHeight.maxHeight;\n\n\n    let top = sizes.top + 1 + milestoneMarginTop;\n    let height = timeline.getBarHeight(task.id, task.type);\n    const baselineSubrowHeight = gantt.config.baselines.row_height;\n    const baselineBarHeight = gantt.config.baselines.bar_height;\n\n    // between task and first baseline\n    let siblingBaselinesSize;\n    let marginTop;\n\n    switch (gantt.config.baselines.render_mode) {\n      case \"separateRow\":\n        top += sizes.height + (baselineSubrowHeight - baselineBarHeight) / 2;\n        height = baselineBarHeight;\n        break;\n\n      case \"individualRow\":\n       // betweenBaselines = 3 * (index + 1);\n        siblingBaselinesSize = (baselineSubrowHeight) * index;\n        top += sizes.height + siblingBaselinesSize + (baselineSubrowHeight - baselineBarHeight) / 2;\n    \n        height = baselineBarHeight;\n        break;\n    \n      case \"taskRow\":\n      default:\n        // TODO: simplify positioning\n        marginTop = 1;\n        if (splitChild){\n          maxHeight = getMaxParentHeight(gantt, timeline, task).maxHeight;\n          if (milestoneMarginTop){\n            if (maxHeight >= milestoneWidth){\n              marginTop = (maxHeight - height) / 2 - 1 - milestoneMarginTop;\n            } else {\n              height = getInvertedMilestoneHeight(maxHeight);\n              top = sizes.top;\n              marginTop = Math.abs(height - maxHeight) / 2;\n              milestoneMarginTop = 0; // for maxBottom\n            }\n          } else {\n            if (maxHeight > height){\n              marginTop = (maxHeight - height) / 2 - 1;\n            } \n            marginTop -= milestoneMarginTop;  \n          }\n          if(!task.bar_height){\n            marginTop -= 1;\n          }else{\n           // marginTop += 1;\n          }\n        } else {\n          if (task.bar_height && sizes.rowHeight >= task.bar_height){\n            marginTop = (sizes.rowHeight - task.bar_height) / 2 - 1;\n          }\n          marginTop += milestoneMarginTop;\n\n          if(!task.bar_height){\n            marginTop += 2;\n          }\n          if (milestoneTask){\n            marginTop += 1;\n          }\n \n        }\n        break;\n    }\n\n    let maxBottom = sizes.top + maxHeight + 1 - milestoneMarginTop;\n\n\n    // don't exceed maximal task row height\n    if (top + height > maxBottom){\n      height -= top + height - maxBottom;\n      if (height <= 0) {\n        return false;\n      }\n    }\n\n\n    el.style.left = sizes.left + \"px\";\n    el.style.width = sizes.width + \"px\";\n    el.style.top = top + \"px\";\n    el.style.height = Math.floor(height) + \"px\";\n    if(marginTop){\n      el.style.marginTop = marginTop + \"px\";\n    }\n    el.className = `gantt_task_baseline gantt_task_baseline_${index} ${baseline.className || \"\"}`;\n\n    if (milestoneTask){\n      el.className += \" gantt_milestone_baseline\";\n      el.style.width = el.style.height = height + \"px\";\n      el.style.marginLeft = Math.floor(-height / 2) + \"px\";\n    } else {\n      el.innerHTML = gantt.templates.baseline_text(task, baseline, index);\n    }\n\n\n    el.setAttribute(\"data-task-id\", task.id);\n    el.setAttribute(\"data-baseline-id\", baseline.id);\n\n    return el;\n  }\n\n  function renderBaseline(task, timeline, config, viewPort) {\n    if (!gantt.config.baselines.render_mode){\n      return;\n    }\n\n    const baselineNodes = document.createElement(\"div\");\n    baselineNodes.className = \"gantt_baseline_nodes\";\n    baselineNodes.setAttribute(\"data-task-row-id\", task.id);\n\n    if (task.baselines && task.baselines.length) {\n      task.baselines.forEach(function(baseline, index){\n        const taskBaseline = generateBaselineNode(task, baseline, index, timeline);\n        if (taskBaseline){\n          baselineNodes.appendChild(taskBaseline);  \n        }\n      });\n    }\n    if (isSplitParent(task)){\n      gantt.eachTask(function(child){\n        if (child.baselines && child.baselines.length) {\n          child.baselines.forEach(function(baseline, index){\n            const childBaseline = generateBaselineNode(child, baseline, index, timeline, true);\n            if (childBaseline){\n              baselineNodes.appendChild(childBaseline);  \n            }\n          });\n        }\n      }, task.id);\n    }\n\n    if (baselineNodes.childNodes.length){\n      return baselineNodes;\n    }\n  }\n  return {\n    render: renderBaseline,\n    isInViewPort: isBaselineInViewPort,\n    getVisibleRange: getVisibleRange\n  };\n}\n\nexport default createBaselineRenderer;\n","import * as domHelpers from \"../utils/dom_helpers\";\nimport isPlaceholderTask from \"../../../utils/placeholder_task\";\n\nfunction _init_dnd(gantt, grid) {\n\tvar DnD = gantt.$services.getService(\"dnd\");\n\n\tif(!grid.$config.bind || !gantt.getDatastore(grid.$config.bind)){\n\t\treturn;\n\t}\n\n\tfunction locate(e){\n\t\treturn domHelpers.locateAttribute(e, grid.$config.item_attribute);\n\t}\n\n\tfunction getStore(){\n\t\treturn gantt.getDatastore(grid.$config.bind);\n\t}\n\n\tfunction checkPlaceholderTask(id){\n\t\treturn isPlaceholderTask(id, gantt, getStore());\n\t}\n\n\tvar dnd = new DnD(grid.$grid_data, {updates_per_second: 60});\n\tif (gantt.defined(grid.$getConfig().dnd_sensitivity))\n\t\tdnd.config.sensitivity = grid.$getConfig().dnd_sensitivity;\n\n\tdnd.attachEvent(\"onBeforeDragStart\", gantt.bind(function (obj, e) {\n\t\tvar el = locate(e);\n\t\tif (!el) return false;\n\t\tif (gantt.hideQuickInfo) gantt.hideQuickInfo();\n\n\t\tif (domHelpers.closest(e.target, \".gantt_grid_editor_placeholder\")){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar id = el.getAttribute(grid.$config.item_attribute);\n\t\tif (checkPlaceholderTask(id)) return false;\n\n\t\tvar datastore = getStore();\n\n\t\tvar task = datastore.getItem(id);\n\n\t\tif (gantt.isReadonly(task))\n\t\t\treturn false;\n\n\t\tdnd.config.initial_open_state = task.$open;\n\t\tif (!gantt.callEvent(\"onRowDragStart\", [id, e.target || e.srcElement, e])) {\n\t\t\treturn false;\n\t\t}\n\n\t}, gantt));\n\n\tdnd.attachEvent(\"onAfterDragStart\", gantt.bind(function (obj, e) {\n\t\tvar el = locate(e);\n\t\tdnd.config.marker.innerHTML = el.outerHTML;\n\t\tvar element = dnd.config.marker.firstChild;\n\t\tif(element){\n\t\t\telement.style.position = \"static\";\n\t\t}\n\n\t\tdnd.config.id = el.getAttribute(grid.$config.item_attribute);\n\n\t\tvar store = getStore();\n\n\t\tvar task = store.getItem(dnd.config.id);\n\t\tdnd.config.index = store.getBranchIndex(dnd.config.id);\n\t\tdnd.config.parent = task.parent;\n\t\ttask.$open = false;\n\t\ttask.$transparent = true;\n\t\tthis.refreshData();\n\t}, gantt));\n\n\tdnd.lastTaskOfLevel = function (level) {\n\t\tvar last_item = null;\n\t\tvar store = getStore();\n\t\tvar tasks = store.getItems();\n\t\tfor (var i = 0, len = tasks.length; i < len; i++) {\n\t\t\tif (tasks[i].$level == level) {\n\t\t\t\tlast_item = tasks[i];\n\t\t\t}\n\t\t}\n\t\treturn last_item ? last_item.id : null;\n\t};\n\tdnd._getGridPos = gantt.bind(function (e) {\n\t\tvar pos = domHelpers.getNodePosition(grid.$grid_data);\n\t\t// row offset\n\t\tvar x = pos.x + grid.$grid.scrollLeft;\n\t\tvar y = e.pos.y - 10;\n\n\t\tvar rowHeight = grid.getItemHeight(dnd.config.id);\n\t\t// prevent moving row out of grid_data container\n\t\tif (y < pos.y) y = pos.y;\n\t\tvar gridHeight = grid.getTotalHeight();\n\t\tif (y > pos.y + gridHeight - rowHeight) y = pos.y + gridHeight - rowHeight;\n\t\tconst maxBottom = pos.y + pos.height;\n\t\tif (y > maxBottom - rowHeight) {\n\t\t\ty = maxBottom - rowHeight;\n\t\t}\n\n\t\tpos.x = x;\n\t\tpos.y = y;\n\t\treturn pos;\n\t}, gantt);\n\tdnd._getTargetY = gantt.bind(function (e) {\n\t\tvar pos = domHelpers.getNodePosition(grid.$grid_data);\n\t\tvar scrollPos = grid.$state.scrollTop || 0;\n\t\tvar maxBottom = gantt.$grid_data.getBoundingClientRect().height + scrollPos;\n\n\t\tvar y = e.pageY - pos.y + scrollPos;\n\t\tif (y > maxBottom) {\n\t\t\ty = maxBottom;\n\t\t} else if (y < scrollPos) {\n\t\t\ty = scrollPos;\n\t\t}\n\t\treturn y;\n\t}, gantt);\n\tdnd._getTaskByY = gantt.bind(function (y, dropIndex) {\n\n\t\tvar store = getStore();\n\n\t\ty = y || 0;\n\n\t\tvar index = grid.getItemIndexByTopPosition(y);\n\t\tindex = dropIndex < index ? index - 1 : index;\n\n\t\tif (index > store.countVisible() - 1)\n\t\t\treturn null;\n\n\t\treturn store.getIdByIndex(index);\n\t}, gantt);\n\tdnd.attachEvent(\"onDragMove\", gantt.bind(function (obj, e) {\n\t\tvar gridDataSizes = gantt.$grid_data.getBoundingClientRect();\n\t\tvar maxBottom = gridDataSizes.height + gridDataSizes.y + (grid.$state.scrollTop || 0) + window.scrollY;\n\t\tvar dd = dnd.config;\n\t\tvar pos = dnd._getGridPos(e);\n\n\t\tgantt._waiAria.reorderMarkerAttr(dd.marker);\n\n\t\tvar config = grid.$getConfig(),\n\t\t\tstore = getStore();\n\n\t\t// setting position of row\n\t\tif (pos.y < maxBottom) {\n\t\t\tdd.marker.style.top = pos.y + \"px\";\n\t\t} else {\n\t\t\tdd.marker.style.top = maxBottom + \"px\";\n\t\t}\n\t\tdd.marker.style.left = pos.x + 10 + \"px\";\n\t\tconst containerSize = domHelpers.getNodePosition(gantt.$root);\n\t\tif (pos.width > containerSize.width){\n\t\t\tdd.marker.style.width = containerSize.width - 10 - 2 + \"px\";\n\t\t\tdd.marker.style.overflow = \"hidden\";\t\n\t\t}\n\n\t\t// highlight row when mouseover\n\t\tvar item = store.getItem(dnd.config.id);\n\t\tvar targetY = dnd._getTargetY(e);\n\t\tvar el = dnd._getTaskByY(targetY, store.getIndexById(item.id));\n\n\t\tif (!store.exists(el)) {\n\t\t\tel = dnd.lastTaskOfLevel(config.order_branch_free ? item.$level : 0);\n\t\t\tif (el == dnd.config.id) {\n\t\t\t\tel = null;\n\t\t\t}\n\t\t}\n\n\t\tfunction allowedLevel(next, item) {\n\t\t\treturn (!(store.isChildOf(over.id, item.id)) && (next.$level == item.$level || config.order_branch_free));\n\t\t}\n\n\t\tif (store.exists(el)) {\n\t\t\tvar over = store.getItem(el);\n\n\t\t\tvar itemTop = grid.getItemTop(over.id);\n\t\t\tvar itemHeight = grid.getItemHeight(over.id);\n\t\t\tif (itemTop + itemHeight / 2 < targetY) {\n\t\t\t\t//hovering over bottom part of item, check can be drop to bottom\n\t\t\t\tvar index = store.getIndexById(over.id);\n\t\t\t\tvar nextId = store.getNext(over.id);//adds +1 when hovering over placeholder\n\t\t\t\tvar next = store.getItem(nextId);\n\t\t\t\tif (checkPlaceholderTask(nextId)){\n\t\t\t\t\tvar prevId = store.getPrev(next.id);\n\t\t\t\t\tnext = store.getItem(prevId);\n\t\t\t\t}\n\t\t\t\tif (next) {\n\t\t\t\t\tif (next.id != item.id) {\n\t\t\t\t\t\tover = next; //there is a valid target\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (config.order_branch_free) {\n\t\t\t\t\t\t\tif (!(store.isChildOf(item.id, over.id) && store.getChildren(over.id).length == 1))\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tstore.move(item.id, store.getBranchIndex(over.id) + 1, store.getParent(over.id));\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t//we at end of the list, check and drop at the end of list\n\t\t\t\t\tnextId = store.getIdByIndex(index);\n\t\t\t\t\tnext = store.getItem(nextId);\n\n\t\t\t\t\tif (checkPlaceholderTask(nextId)){\n\t\t\t\t\t\tvar prevId = store.getPrev(next.id);\n\t\t\t\t\t\tnext = store.getItem(prevId);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (allowedLevel(next, item) && next.id != item.id) {\n\t\t\t\t\t\tstore.move(item.id, -1, store.getParent(next.id));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (config.order_branch_free) {\n\t\t\t\tif (over.id != item.id && allowedLevel(over, item) && !checkPlaceholderTask(over.id)) {\n\t\t\t\t\tif (!store.hasChild(over.id)) {\n\t\t\t\t\t\tover.$open = true;\n\t\t\t\t\t\tstore.move(item.id, -1, over.id);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (store.getIndexById(over.id) || itemHeight / 3 < targetY) return;\n\t\t\t\t}\n\t\t\t}\n\t\t\t//if item is on different level, check the one before it\n\t\t\tvar index = store.getIndexById(over.id),\n\t\t\t\tprevId = store.getIdByIndex(index - 1);\n\n\t\t\tvar prev = store.getItem(prevId);\n\n\t\t\tvar shift = 1;\n\t\t\twhile ((!prev || prev.id == over.id) && index - shift >= 0) {\n\n\t\t\t\tprevId = store.getIdByIndex(index - shift);\n\t\t\t\tprev = store.getItem(prevId);\n\t\t\t\tshift++;\n\t\t\t}\n\n\t\t\tif (item.id == over.id || checkPlaceholderTask(over.id)) return;\n\t\t\t//replacing item under cursor\n\t\t\tif (allowedLevel(over, item) && item.id != over.id) {\n\t\t\t\tstore.move(item.id, 0, 0, over.id);\n\n\t\t\t} else if (over.$level == item.$level - 1 && !store.getChildren(over.id).length) {\n\t\t\t\tstore.move(item.id, 0, over.id);\n\n\t\t\t} else if (prev && (allowedLevel(prev, item)) && (item.id != prev.id)) {\n\t\t\t\tstore.move(item.id, -1, store.getParent(prev.id));\n\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}, gantt));\n\n\tdnd.attachEvent(\"onDragEnd\", gantt.bind(function () {\n\t\tvar store = getStore();\n\t\tvar task = store.getItem(dnd.config.id);\n\t\ttask.$transparent = false;\n\t\ttask.$open = dnd.config.initial_open_state;\n\n\t\tif (this.callEvent(\"onBeforeRowDragEnd\", [dnd.config.id, dnd.config.parent, dnd.config.index]) === false) {\n\t\t\tstore.move(dnd.config.id, dnd.config.index, dnd.config.parent);\n\t\t\ttask.$drop_target = null;\n\t\t} else {\n\t\t\tthis.callEvent(\"onRowDragEnd\", [dnd.config.id, task.$drop_target]);\n\t\t}\n\t\tgantt.render();\n\t\tthis.refreshData();\n\t}, gantt));\n}\n\nexport default {\n\tinit: _init_dnd\n};","/**\n * The state object for order branch drag and drop\n */\n\nimport * as utils from \"../../../../utils/utils\";\n\nexport default {\n\tcreateDropTargetObject: function createDropTargetObject(parent) {\n\t\tvar res = {\n\t\t\ttargetParent: null,\n\t\t\ttargetIndex: 0,\n\t\t\ttargetId: null,\n\t\t\tchild: false,\n\t\t\tnextSibling: false,\n\t\t\tprevSibling: false\n\t\t};\n\n\t\tif (parent) {\n\t\t\tutils.mixin(res, parent, true);\n\t\t}\n\t\treturn res;\n\t},\n\tnextSiblingTarget: function nextSiblingTarget(dndTaskId, targetTaskId, store) {\n\t\tvar result = this.createDropTargetObject();\n\t\tresult.targetId = targetTaskId;\n\t\tresult.nextSibling = true;\n\t\tresult.targetParent = store.getParent(result.targetId);\n\t\tresult.targetIndex = store.getBranchIndex(result.targetId);\n\t\tif(store.getParent(dndTaskId) != result.targetParent || result.targetIndex < store.getBranchIndex(dndTaskId)){\n\t\t\tresult.targetIndex += 1;\n\t\t}\n\t\treturn result;\n\t},\n\tprevSiblingTarget: function prevSiblingTarget(dndTaskId, targetTaskId, store) {\n\t\tvar result = this.createDropTargetObject();\n\t\tresult.targetId = targetTaskId;\n\t\tresult.prevSibling = true;\n\t\tresult.targetParent = store.getParent(result.targetId);\n\t\tresult.targetIndex = store.getBranchIndex(result.targetId);\n\t\tif(store.getParent(dndTaskId) == result.targetParent && result.targetIndex > store.getBranchIndex(dndTaskId)){\n\t\t\tresult.targetIndex -= 1;\n\t\t}\n\t\treturn result;\n\t},\n\tfirstChildTarget: function firstChildTarget(dndTaskId, targetTaskId, store) {\n\t\tvar result = this.createDropTargetObject();\n\t\tresult.targetId = targetTaskId;\n\t\tresult.targetParent = result.targetId;\n\t\tresult.targetIndex = 0;\n\t\tresult.child = true;\n\t\treturn result;\n\t},\n\tlastChildTarget: function lastChildTarget(dndTaskId, targetTaskId, store) {\n\t\tvar children = store.getChildren(targetTaskId);\n\t\tvar result = this.createDropTargetObject();\n\t\tresult.targetId = children[children.length - 1];\n\t\tresult.targetParent = targetTaskId;\n\t\tresult.targetIndex = children.length;\n\t\tresult.nextSibling = true;\n\t\treturn result;\n\t}\n};","/**\n * resolve dnd position of the task when gantt.config.order_branch_free = false\n */\n\nimport dropTarget from \"./drop_target\";\n\nfunction getLast(store){\n\tvar current = store.getNext();\n\twhile(store.exists(current)){\n\n\t\tvar next = store.getNext(current);\n\t\tif(!store.exists(next)){\n\t\t\treturn current;\n\t\t}else{\n\t\t\tcurrent = next;\n\t\t}\n\t}\n\treturn null;\n}\n\nfunction findClosesTarget(dndTaskId, taskId, allowedLevel, store, up){\n\tvar prev = taskId;\n\twhile(store.exists(prev)){\n\t\tvar targetLevel = store.calculateItemLevel(store.getItem(prev));\n\t\tif((targetLevel === allowedLevel || targetLevel === (allowedLevel - 1)) && store.getBranchIndex(prev) > -1){\n\t\t\tbreak;\n\t\t}else {\n\t\t\tprev = up ? store.getPrev(prev) : store.getNext(prev);\n\t\t}\n\t}\n\n\tif(store.exists(prev)){\n\t\tif(store.calculateItemLevel(store.getItem(prev)) === allowedLevel){\n\t\t\treturn up ? dropTarget.nextSiblingTarget(dndTaskId, prev, store) : dropTarget.prevSiblingTarget(dndTaskId, prev, store);\n\t\t}else{\n\t\t\treturn dropTarget.firstChildTarget(dndTaskId, prev, store);\n\t\t}\n\t}\n\treturn null;\n}\n\nfunction findTargetAbove(dndTaskId, taskId, allowedLevel, store){\n\treturn findClosesTarget(dndTaskId, taskId, allowedLevel, store, true);\n}\nfunction findTargetBelow(dndTaskId, taskId, allowedLevel, store){\n\treturn findClosesTarget(dndTaskId, taskId, allowedLevel, store, false);\n}\n\nexport default function getSameLevelDropPosition(dndTaskId, targetTaskId, relTargetPos, eventTop, store, level){\n\tvar result;\n\tif(targetTaskId !== store.$getRootId()){\n\t\tvar targetTask = store.getItem(targetTaskId);\n\t\tvar targetLevel = store.calculateItemLevel(targetTask);\n\t\tif(targetLevel === level){\n\t\t\tvar prevSibling = store.getPrevSibling(targetTaskId);\n\t\t\tif(relTargetPos < 0.5 && !prevSibling){\n\t\t\t\tresult = dropTarget.prevSiblingTarget(dndTaskId, targetTaskId, store);\n\t\t\t}else{\n\t\t\t\tif(relTargetPos < 0.5){\n\t\t\t\t\ttargetTaskId = prevSibling;\n\t\t\t\t}\n\t\t\t\tresult = dropTarget.nextSiblingTarget(dndTaskId, targetTaskId, store);\n\t\t\t}\n\t\t}else if(targetLevel > level){\n\t\t\tstore.eachParent(function(parent){\n\t\t\t\tif(store.calculateItemLevel(parent) === level){\n\t\t\t\t\ttargetTaskId = parent.id;\n\t\t\t\t}\n\t\t\t}, targetTask); \n\t\t\tresult = findTargetAbove(dndTaskId, targetTaskId, level, store);\n\t\t}else{\n\t\t\tvar targetAbove = findTargetAbove(dndTaskId, targetTaskId, level, store);\n\t\t\tvar targetBelow = findTargetBelow(dndTaskId, targetTaskId, level, store);\n\t\t\tresult = (relTargetPos < 0.5) ? targetAbove : targetBelow;\n\t\t}\n\t}else{\n\t\tvar rootId = store.$getRootId();\n\t\tvar rootLevel = store.getChildren(rootId);\n\t\tresult = dropTarget.createDropTargetObject();\n\t\tif(rootLevel.length && eventTop >= 0){\n\t\t\tresult = findTargetAbove(dndTaskId, getLast(store), level, store);\n\t\t}else{\n\t\t\tresult = findTargetBelow(dndTaskId, rootId, level, store);\n\t\t}\n\t}\n\n\treturn result;\n};\n","import * as domHelpers from \"../../utils/dom_helpers\";\n\n/**\n * methods for highlighting current drag and drop position\n */\n\nfunction highlightPosition(target, root, grid){\n\tvar markerPos = getTaskMarkerPosition(target, grid);\n\t// setting position of row\n\troot.marker.style.left = markerPos.x + 9 + \"px\";\n\troot.marker.style.width = markerPos.width + \"px\";\n\troot.marker.style.overflow = \"hidden\";\n\tvar markerLine = root.markerLine;\n\tif(!markerLine){\n\t\tmarkerLine = document.createElement(\"div\");\n\t\tmarkerLine.className = \"gantt_drag_marker gantt_grid_dnd_marker\";\n\t\tmarkerLine.innerHTML = \"<div class='gantt_grid_dnd_marker_line'></div>\";\n\t\tmarkerLine.style.pointerEvents = \"none\";\n\t}\n\n\tif(target.child){\n\t\thighlightFolder(target, markerLine, grid);\n\t}else{\n\t\thighlightRow(target, markerLine, grid);\n\t}\n\n\tif(!root.markerLine){\n\t\tdocument.body.appendChild(markerLine);\n\t\troot.markerLine = markerLine;\n\t}\n}\n\nfunction removeLineHighlight(root){\n\tif(root.markerLine && root.markerLine.parentNode){\n\t\troot.markerLine.parentNode.removeChild(root.markerLine);\n\t}\n\troot.markerLine = null;\n}\n\nfunction highlightRow(target, markerLine, grid){\n\tvar linePos = getLineMarkerPosition(target, grid);\n\tvar maxBottom = grid.$grid_data.getBoundingClientRect().bottom + window.scrollY;\n\n\tmarkerLine.innerHTML = \"<div class='gantt_grid_dnd_marker_line'></div>\";\n\tmarkerLine.style.left = linePos.x + \"px\";\n\tmarkerLine.style.height = \"4px\";\n\n\tvar markerLineTop = linePos.y - 2;\n\tmarkerLine.style.top = markerLineTop + \"px\";\n\tmarkerLine.style.width = linePos.width + \"px\";\n\n\tif (markerLineTop > maxBottom) {\n\t\tmarkerLine.style.top = maxBottom + 'px';\n\t}\n\n\treturn markerLine;\n}\nfunction highlightFolder(target, markerFolder, grid){\n\tvar id = target.targetParent;\n\tvar pos = gridToPageCoordinates({x: 0, y: grid.getItemTop(id)}, grid);\n\tvar maxBottom = grid.$grid_data.getBoundingClientRect().bottom + window.scrollY;\n\n\tlet folderHighlightWidth = setWidthWithinContainer(grid.$gantt, grid.$grid_data.offsetWidth);\t\n\n\tmarkerFolder.innerHTML = \"<div class='gantt_grid_dnd_marker_folder'></div>\";\n\tmarkerFolder.style.width = folderHighlightWidth + \"px\";\n\tmarkerFolder.style.top = pos.y + \"px\";\n\tmarkerFolder.style.left = pos.x  + \"px\";\n\tmarkerFolder.style.height = grid.getItemHeight(id) + \"px\";\n\tif (pos.y > maxBottom) {\n\t\tmarkerFolder.style.top = maxBottom + 'px';\n\t}\n\n\treturn markerFolder;\n}\n\nfunction getLineMarkerPosition(target, grid){\n\tvar store = grid.$config.rowStore;\n\tvar pos = {x:0, y:0};\n\tvar indentNode = grid.$grid_data.querySelector(\".gantt_tree_indent\");\n\tvar indent = 15;\n\tvar level = 0;\n\tif(indentNode){\n\t\tindent = indentNode.offsetWidth;\n\t}\n\tvar iconWidth = 40;\n\tif(target.targetId !== store.$getRootId()){\n\t\tvar itemTop = grid.getItemTop(target.targetId);\n\t\tvar itemHeight = grid.getItemHeight(target.targetId);\n\t\tlevel = store.exists(target.targetId) ? store.calculateItemLevel(store.getItem(target.targetId)) : 0;\n\n\t\tif(target.prevSibling){\n\t\t\tpos.y = itemTop;\n\t\t}else if(target.nextSibling){\n\t\t\tvar childCount = 0;\n\t\t\tstore.eachItem(function(child){\n\t\t\t\tif(store.getIndexById(child.id) !== -1)\n\t\t\t\t\tchildCount++;\n\t\t\t}, target.targetId);\n\n\t\t\tpos.y = itemTop + itemHeight + childCount*itemHeight;\n\t\t}else {\n\t\t\tpos.y = itemTop + itemHeight;\n\t\t\tlevel += 1;\n\t\t}\n\t}\n\tpos.x = iconWidth + level * indent;\n\tpos.width = setWidthWithinContainer(grid.$gantt, Math.max(grid.$grid_data.offsetWidth - pos.x, 0), pos.x);\n\treturn gridToPageCoordinates(pos, grid);\n}\n\nfunction gridToPageCoordinates(pos, grid){\n\tvar gridPos = domHelpers.getNodePosition(grid.$grid_data);\n\tpos.x += gridPos.x + grid.$grid.scrollLeft;\n\tpos.y += gridPos.y - grid.$grid_data.scrollTop;\n\treturn pos;\n}\n\nfunction getTaskMarkerPosition(e, grid) {\n\tvar pos = domHelpers.getNodePosition(grid.$grid_data);\n\tvar ePos = domHelpers.getRelativeEventPosition(e, grid.$grid_data);\n\t// row offset\n\tvar x = pos.x + grid.$grid.scrollLeft;\n\tvar y = ePos.y - 10;\n\n\tvar rowHeight = grid.getItemHeight(e.targetId);\n\t// prevent moving row out of grid_data container\n\tif (y < pos.y) y = pos.y;\n\tvar gridHeight = grid.getTotalHeight();\n\tif (y > pos.y + gridHeight - rowHeight) y = pos.y + gridHeight - rowHeight;\n\n\tpos.x = x;\n\tpos.y = y;\n\tpos.width = setWidthWithinContainer(grid.$gantt, pos.width, 9);\n\treturn pos;\n}\n\nfunction setWidthWithinContainer(gantt, width, offset = 0){\n\tconst containerSize = domHelpers.getNodePosition(gantt.$root);\n\tif (width > containerSize.width){\n\t\twidth = containerSize.width - offset - 2;\n\t}\n\treturn width;\n}\n\nexport default {\n\tremoveLineHighlight: removeLineHighlight,\n\thighlightPosition: highlightPosition\n};\n","import * as domHelpers from \"../utils/dom_helpers\";\nimport dropTarget from \"./tasks_grid_dnd_marker_helpers/drop_target\";\nimport getLockedLevelTarget from \"./tasks_grid_dnd_marker_helpers/locked_level\";\nimport getMultiLevelTarget from \"./tasks_grid_dnd_marker_helpers/multi_level\";\nimport higlighter from \"./tasks_grid_dnd_marker_helpers/highlight\";\nimport isPlaceholderTask from \"../../../utils/placeholder_task\";\n\nfunction _init_dnd(gantt, grid) {\n\tvar DnD = gantt.$services.getService(\"dnd\");\n\n\tif(!grid.$config.bind || !gantt.getDatastore(grid.$config.bind)){\n\t\treturn;\n\t}\n\n\tfunction locate(e){\n\t\treturn domHelpers.locateAttribute(e, grid.$config.item_attribute);\n\t}\n\n\tfunction getStore(){\n\t\treturn gantt.getDatastore(grid.$config.bind);\n\t}\n\n\tfunction checkPlaceholderTask(id){\n\t\treturn isPlaceholderTask(id, gantt, getStore());\n\t}\n\n\tvar dnd = new DnD(grid.$grid_data, {updates_per_second: 60});\n\tif (gantt.defined(grid.$getConfig().dnd_sensitivity))\n\t\tdnd.config.sensitivity = grid.$getConfig().dnd_sensitivity;\n\n\tdnd.attachEvent(\"onBeforeDragStart\", gantt.bind(function (obj, e) {\n\t\tvar el = locate(e);\n\t\tif (!el) return false;\n\t\tif (gantt.hideQuickInfo) gantt.hideQuickInfo();\n\t\tif (domHelpers.closest(e.target, \".gantt_grid_editor_placeholder\")){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar id = el.getAttribute(grid.$config.item_attribute);\n\t\tvar datastore = grid.$config.rowStore;\n\t\tvar task = datastore.getItem(id);\n\n\t\tif (gantt.isReadonly(task) || checkPlaceholderTask(id))\n\t\t\treturn false;\n\n\t\tdnd.config.initial_open_state = task.$open;\n\t\tif (!gantt.callEvent(\"onRowDragStart\", [id, e.target || e.srcElement, e])) {\n\t\t\treturn false;\n\t\t}\n\n\t}, gantt));\n\n\tdnd.attachEvent(\"onAfterDragStart\", gantt.bind(function (obj, e) {\n\t\tvar el = locate(e);\n\n\t\tdnd.config.marker.innerHTML = el.outerHTML;\n\t\tvar element = dnd.config.marker.firstChild;\n\t\tif(element){\n\t\t\tdnd.config.marker.style.opacity = 0.4;\n\t\t\telement.style.position = \"static\";\n\t\t\telement.style.pointerEvents = \"none\";\n\t\t}\n\n\t\tdnd.config.id = el.getAttribute(grid.$config.item_attribute);\n\n\t\tvar store = grid.$config.rowStore;\n\n\t\tvar task = store.getItem(dnd.config.id);\n\t\tdnd.config.level = store.calculateItemLevel(task);\n\t\tdnd.config.drop_target = dropTarget.createDropTargetObject({\n\t\t\ttargetParent: store.getParent(task.id),\n\t\t\ttargetIndex: store.getBranchIndex(task.id),\n\t\t\ttargetId: task.id,\n\t\t\tnextSibling: true\n\t\t});\n\n\t\ttask.$open = false;\n\t\ttask.$transparent = true;\n\t\tthis.refreshData();\n\t}, gantt));\n\n\tfunction getTargetTaskId(e){\n\t\tvar y = domHelpers.getRelativeEventPosition(e, grid.$grid_data).y;\n\t\tvar store = grid.$config.rowStore;\n\n\t\tif (!document.doctype){\n\t\t\ty += window.scrollY;\n\t\t}\n\t\ty = y || 0;\n\n\t\t// limits for the marker according to the layout layer\n\t\tvar scrollPos = grid.$state.scrollTop || 0;\n\t\tvar maxBottom = gantt.$grid_data.getBoundingClientRect().height + scrollPos + window.scrollY;\n\t\tvar minTop = scrollPos;\n\n\t\tvar firstVisibleTaskIndex = grid.getItemIndexByTopPosition(grid.$state.scrollTop);\n\t\tif (!store.exists(firstVisibleTaskIndex)){\n\t\t\tfirstVisibleTaskIndex = store.countVisible() - 1;\n\t\t}\n\t\tif (firstVisibleTaskIndex < 0) {\n\t\t\treturn store.$getRootId();\n\t\t}\n\n\t\tvar firstVisibleTaskId = store.getIdByIndex(firstVisibleTaskIndex);\n\n\t\tvar firstVisibleTaskPos = grid.$state.scrollTop / grid.getItemHeight(firstVisibleTaskId);\n\t\tvar hiddenTaskPart = firstVisibleTaskPos - Math.floor(firstVisibleTaskPos);\n\t\tif (hiddenTaskPart > 0.1 && hiddenTaskPart < 0.9) {\n\t\t\tmaxBottom = maxBottom - grid.getItemHeight(firstVisibleTaskId) * hiddenTaskPart;\n\t\t\tminTop = minTop + grid.getItemHeight(firstVisibleTaskId) * (1 - hiddenTaskPart);\n\t\t}\n\n\t\t// GS-715. The placeholder task row shouldn't be draggable below the Gantt container\n\t\tconst gridPosition = domHelpers.getNodePosition(grid.$grid_data);\n\t\tconst gridBottom = gridPosition.y + gridPosition.height;\n\t\tconst placeholderRowHeight = dnd.config.marker.offsetHeight;\n\t\tif (y + placeholderRowHeight + window.scrollY >= maxBottom){\n\t\t\tdnd.config.marker.style.top = gridBottom - placeholderRowHeight\t+ \"px\";\n\t\t}\n\n\t\tif (y >= maxBottom) {\n\t\t\ty = maxBottom;\n\t\t} else if (y <= minTop) {\n\t\t\ty = minTop;\n\t\t\tdnd.config.marker.style.top = gridPosition.y + \"px\";\n\t\t}\n\n\t\tvar index = grid.getItemIndexByTopPosition(y);\n\n\t\tif (index > store.countVisible() - 1 || index < 0) {\n\t\t\treturn store.$getRootId();\n\t\t}\n\n\t\tvar targetId = store.getIdByIndex(index);\n\t\tif (checkPlaceholderTask(targetId)) {\n\t\t\treturn store.getPrevSibling(targetId);\n\t\t}\n\n\t\treturn store.getIdByIndex(index);\n\t}\n\n\tfunction getDropPosition(e){\n\t\tvar targetTaskId = getTargetTaskId(e);\n\t\tvar relTargetPos = null;\n\t\tvar store = grid.$config.rowStore;\n\t\tvar config = grid.$getConfig();\n\t\tvar lockLevel = !config.order_branch_free;\n\n\t\tvar eventTop = domHelpers.getRelativeEventPosition(e, grid.$grid_data).y;\n\t\tif (!document.doctype){\n\t\t\teventTop += window.scrollY;\n\t\t}\n\n\t\tif(targetTaskId !== store.$getRootId()) {\n\t\t\tvar rowTop = grid.getItemTop(targetTaskId);\n\t\t\tvar rowHeight = grid.getItemHeight(targetTaskId);\n\t\t\trelTargetPos = (eventTop - rowTop) / rowHeight;\n\t\t}\n\n\t\tvar result;\n\t\tif(!lockLevel){\n\t\t\tresult = getMultiLevelTarget(dnd.config.id, targetTaskId, relTargetPos, eventTop, store);\n\t\t}else{\n\t\t\tresult = getLockedLevelTarget(dnd.config.id, targetTaskId, relTargetPos, eventTop, store, dnd.config.level);\n\t\t\tif(result && result.targetParent && checkPlaceholderTask(result.targetParent)){\n\t\t\t\ttargetTaskId = store.getPrevSibling(result.targetParent);\n\t\t\t\tresult = getLockedLevelTarget(dnd.config.id, targetTaskId, relTargetPos, eventTop, store, dnd.config.level);\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tdnd.attachEvent(\"onDragMove\", gantt.bind(function (obj, e) {\n\t\tvar target = getDropPosition(e);\n\n\t\tif(!target ||\n\t\t\tgantt.callEvent(\"onBeforeRowDragMove\", [dnd.config.id, target.targetParent, target.targetIndex]) === false){\n\t\t\t\ttarget = dropTarget.createDropTargetObject(dnd.config.drop_target);\n\t\t\t}\n\n\t\thiglighter.highlightPosition(target, dnd.config, grid);\n\t\tdnd.config.drop_target = target;\n\t\tgantt._waiAria.reorderMarkerAttr(dnd.config.marker);\n\n\t\tthis.callEvent(\"onRowDragMove\", [dnd.config.id, target.targetParent, target.targetIndex]);\n\t\treturn true;\n\t}, gantt));\n\n\tdnd.attachEvent(\"onDragEnd\", gantt.bind(function () {\n\t\tvar store = grid.$config.rowStore;\n\t\tvar task = store.getItem(dnd.config.id);\n\n\t\thiglighter.removeLineHighlight(dnd.config);\n\n\t\ttask.$transparent = false;\n\t\ttask.$open = dnd.config.initial_open_state;\n\t\tvar target = dnd.config.drop_target;\n\n\t\tif (this.callEvent(\"onBeforeRowDragEnd\", [dnd.config.id, target.targetParent, target.targetIndex]) === false) {\n\t\t\ttask.$drop_target = null;\n\t\t} else {\n\t\t\tstore.move(dnd.config.id, target.targetIndex, target.targetParent);\n\t\t\tgantt.render();\n\t\t\tthis.callEvent(\"onRowDragEnd\", [dnd.config.id, target.targetParent, target.targetIndex]);\n\t\t}\n\t\tstore.refresh(task.id);\n\t}, gantt));\n}\n\nexport default {\n\tinit: _init_dnd\n};","/**\n * resolve dnd position of the task when gantt.config.order_branch_free = true\n */\n\nimport dropTarget from \"./drop_target\";\n\nexport default function getMultiLevelDropPosition(dndTaskId, targetTaskId, relTargetPos, eventTop, store){\n\tvar result;\n\n\tif(targetTaskId !== store.$getRootId()){\n\t\tif(relTargetPos < 0.25){\n\t\t\tresult = dropTarget.prevSiblingTarget(dndTaskId, targetTaskId, store);\n\t\t}else if(relTargetPos > 0.60 && !(store.hasChild(targetTaskId) && store.getItem(targetTaskId).$open)){\n\t\t\tresult = dropTarget.nextSiblingTarget(dndTaskId, targetTaskId, store);\n\t\t}else {\n\t\t\tresult = dropTarget.firstChildTarget(dndTaskId, targetTaskId, store);\n\t\t}\n\t}else{\n\t\tvar rootId = store.$getRootId();\n\t\tif(store.hasChild(rootId) && eventTop >= 0){\n\t\t\tresult = dropTarget.lastChildTarget(dndTaskId, rootId, store);\n\t\t}else{\n\t\t\tresult = dropTarget.firstChildTarget(dndTaskId, rootId, store);\n\t\t}\n\t}\n\n\treturn result;\n};","import * as utils from \"../../../utils/utils\";\nimport rowDnd from \"./tasks_grid_dnd\";\nimport rowDndMarker from \"./tasks_grid_dnd_marker\";\nimport mouseEventContainer from \"../mouse_event_container\";\n\nvar initializer = (function(){\n\treturn function(gantt){\n\t\treturn {\n\t\t\tonCreated: function (grid) {\n\t\t\t\tgrid.$config = utils.mixin(grid.$config, {\n\t\t\t\t\tbind: \"task\"\n\t\t\t\t});\n\t\t\t\tif(grid.$config.id == \"grid\") {\n\t\t\t\t\tthis.extendGantt(grid);\n\t\t\t\t\tgantt.ext.inlineEditors = gantt.ext._inlineEditors.createEditors(grid);\n\t\t\t\t\tgantt.ext.inlineEditors.init();\n\t\t\t\t}\n\n\t\t\t\tthis._mouseDelegates = mouseEventContainer(gantt);\n\t\t\t},\n\t\t\tonInitialized: function (grid) {\n\t\t\t\tvar config = grid.$getConfig();\n\t\t\t\tif (config.order_branch) {\n\t\t\t\t\tif(config.order_branch == \"marker\"){\n\t\t\t\t\t\trowDndMarker.init(grid.$gantt, grid);\n\t\t\t\t\t}else{\n\t\t\t\t\t\trowDnd.init(grid.$gantt, grid);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.initEvents(grid, gantt);\n\t\t\t\tif(grid.$config.id == \"grid\") {\n\t\t\t\t\tthis.extendDom(grid);\n\t\t\t\t}\n\t\t\t},\n\t\t\tonDestroyed: function (grid) {\n\t\t\t\tif(grid.$config.id == \"grid\") {\n\t\t\t\t\t// GS-1288. We need to only detach the store and its events without detaching the\n\t\t\t\t\t// inline editor's events. Otherwise, we won't be able to access them\n\t\t\t\t\tgantt.ext.inlineEditors.detachStore();\n\t\t\t\t}\n\t\t\t\tthis.clearEvents(grid, gantt);\n\t\t\t},\n\n\t\t\tinitEvents: function (grid, gantt) {\n\t\t\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_row\", gantt.bind(function (e, id, trg) {\n\t\t\t\t\tconst config = grid.$getConfig();\n\t\t\t\t\tif (id !== null) {\n\t\t\t\t\t\tconst task = this.getTask(id);\n\t\t\t\t\t\tif (config.scroll_on_click) {\n\t\t\t\t\t\t\tconst notOpenIcon = !gantt._is_icon_open_click(e);\n\t\t\t\t\t\t\tconst visibleTimeline = gantt.$ui.getView(\"timeline\");\n\t\t\t\t\t\t\t// don't need to scroll to the date when the timeline is not visible\n\t\t\t\t\t\t\t// or when we click on the open/close icon\n\t\t\t\t\t\t\tif (notOpenIcon && visibleTimeline){\n\t\t\t\t\t\t\t\tthis.showDate(task.start_date);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tgantt.callEvent(\"onTaskRowClick\", [id, trg]);\n\t\t\t\t\t}\n\t\t\t\t}, gantt), grid.$grid);\n\n\t\t\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_grid_head_cell\", gantt.bind(function (e, id, trg) {\n\t\t\t\t\tvar column = trg.getAttribute(\"data-column-id\");\n\n\t\t\t\t\tif (!gantt.callEvent(\"onGridHeaderClick\", [column, e]))\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\tvar config = grid.$getConfig();\n\n\t\t\t\t\tif (column == \"add\") {\n\t\t\t\t\t\tvar mouseEvents = gantt.$services.getService(\"mouseEvents\");\n\t\t\t\t\t\tmouseEvents.callHandler(\"click\", \"gantt_add\", grid.$grid, [e, config.root_id]);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (config.sort && column) { // GS-929: if there is no column name, we cannot sort the column\n\t\t\t\t\t\tvar sorting_method = column,\n\t\t\t\t\t\t\tconf;\n\n\t\t\t\t\t\tfor (var i = 0; i < config.columns.length; i++) {\n\t\t\t\t\t\t\tif (config.columns[i].name == column) {\n\t\t\t\t\t\t\t\tconf = config.columns[i];\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (conf && conf.sort !== undefined && conf.sort !== true) {\n\t\t\t\t\t\t\tsorting_method = conf.sort;\n\n\t\t\t\t\t\t\tif (!sorting_method) { // column sort property 'false', no sorting\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar sort = (this._sort && this._sort.direction && this._sort.name == column) ? this._sort.direction : \"desc\";\n\t\t\t\t\t\t// invert sort direction\n\t\t\t\t\t\tsort = (sort == \"desc\") ? \"asc\" : \"desc\";\n\t\t\t\t\t\tthis._sort = {\n\t\t\t\t\t\t\tname: column,\n\t\t\t\t\t\t\tdirection: sort\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis.sort(sorting_method, sort == \"desc\");\n\t\t\t\t\t}\n\t\t\t\t}, gantt), grid.$grid);\n\n\t\t\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_add\", gantt.bind(function (e, id, trg) {\n\t\t\t\t\tvar config = grid.$getConfig();\n\t\t\t\t\tif (config.readonly) return;\n\n\t\t\t\t\tvar item = {};\n\t\t\t\t\tthis.createTask(item, id ? id : gantt.config.root_id);\n\n\t\t\t\t\treturn false;\n\t\t\t\t}, gantt), grid.$grid);\n\n\t\t\t},\n\n\t\t\tclearEvents: function(grid, gantt){\n\t\t\t\tthis._mouseDelegates.destructor();\n\t\t\t\tthis._mouseDelegates = null;\n\t\t\t},\n\n\t\t\textendDom: function(grid){\n\t\t\t\tgantt.$grid = grid.$grid;\n\t\t\t\tgantt.$grid_scale = grid.$grid_scale;\n\t\t\t\tgantt.$grid_data = grid.$grid_data;\n\t\t\t},\n\t\t\textendGantt: function(grid){\n\t\t\t\tgantt.getGridColumns = gantt.bind(grid.getGridColumns, grid);\n\n\t\t\t\tgrid.attachEvent(\"onColumnResizeStart\", function(){\n\t\t\t\t\treturn gantt.callEvent(\"onColumnResizeStart\", arguments);\n\t\t\t\t});\n\t\t\t\tgrid.attachEvent(\"onColumnResize\", function(){\n\t\t\t\t\treturn gantt.callEvent(\"onColumnResize\", arguments);\n\t\t\t\t});\n\t\t\t\tgrid.attachEvent(\"onColumnResizeEnd\", function(){\n\t\t\t\t\treturn gantt.callEvent(\"onColumnResizeEnd\", arguments);\n\t\t\t\t});\n\n\t\t\t\tgrid.attachEvent(\"onColumnResizeComplete\", function(columns, totalWidth){\n\t\t\t\t\tgantt.config.grid_width = totalWidth;\n\t\t\t\t});\n\n\t\t\t\tgrid.attachEvent(\"onBeforeRowResize\", function(){\n\t\t\t\t\treturn gantt.callEvent(\"onBeforeRowResize\", arguments);\n\t\t\t\t});\n\t\t\t\tgrid.attachEvent(\"onRowResize\", function(){\n\t\t\t\t\treturn gantt.callEvent(\"onRowResize\", arguments);\n\t\t\t\t});\n\t\t\t\tgrid.attachEvent(\"onBeforeRowResizeEnd\", function(){\n\t\t\t\t\treturn gantt.callEvent(\"onBeforeRowResizeEnd\", arguments);\n\t\t\t\t});\n\t\t\t\tgrid.attachEvent(\"onAfterRowResize\", function(){\n\t\t\t\t\treturn gantt.callEvent(\"onAfterRowResize\", arguments);\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t};\n})();\n\nexport default initializer;","import * as domHelpers from \"../utils/dom_helpers\";\nimport * as utils from \"../../../utils/utils\";\nimport timeout from \"../../../utils/timeout\";\nimport * as helpers from \"../../../utils/helpers\";\n\nfunction createTaskDND(timeline, gantt) {\n\tvar services = gantt.$services;\n\treturn {\n\t\tdrag: null,\n\t\tdragMultiple: {},\n\t\t_events: {\n\t\t\tbefore_start: {},\n\t\t\tbefore_finish: {},\n\t\t\tafter_finish: {}\n\t\t},\n\t\t_handlers: {},\n\t\tinit: function() {\n\t\t\tthis._domEvents = gantt._createDomEventScope();\n\t\t\tthis.clear_drag_state();\n\t\t\tvar drag = gantt.config.drag_mode;\n\t\t\tthis.set_actions();\n\n\t\t\tvar stateService = services.getService(\"state\");\n\t\t\tstateService.registerProvider(\"tasksDnd\", utils.bind(function() {\n\t\t\t\treturn {\n\t\t\t\t\tdrag_id : this.drag ? this.drag.id : undefined,\n\t\t\t\t\tdrag_mode : this.drag ? this.drag.mode : undefined,\n\t\t\t\t\tdrag_from_start : this.drag ? this.drag.left : undefined\n\t\t\t\t};\n\t\t\t}, this));\n\n\t\t\tvar evs = {\n\t\t\t\t\"before_start\": \"onBeforeTaskDrag\",\n\t\t\t\t\"before_finish\": \"onBeforeTaskChanged\",\n\t\t\t\t\"after_finish\": \"onAfterTaskDrag\"\n\t\t\t};\n\t\t\t//for now, all drag operations will trigger the same events\n\t\t\tfor (var stage in this._events) {\n\t\t\t\tfor (var mode in drag) {\n\t\t\t\t\tthis._events[stage][mode] = evs[stage];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._handlers[drag.move] = this._move;\n\t\t\tthis._handlers[drag.resize] = this._resize;\n\t\t\tthis._handlers[drag.progress] = this._resize_progress;\n\t\t},\n\t\tset_actions: function() {\n\t\t\tvar data = timeline.$task_data;\n\t\t\tthis._domEvents.attach(data, \"mousemove\", gantt.bind(function(e) {\n\t\t\t\tthis.on_mouse_move(e);\n\t\t\t}, this));\n\t\t\tthis._domEvents.attach(data, \"mousedown\", gantt.bind(function(e) {\n\t\t\t\tthis.on_mouse_down(e);\n\t\t\t}, this));\n\t\t\tthis._domEvents.attach(document.body, \"mouseup\", gantt.bind(function(e) {\n\t\t\t\tthis.on_mouse_up(e);\n\t\t\t}, this));\n\t\t},\n\n\t\t_getPositioningContext: function(task) {\n\t\t\tif(timeline._getPositioningContext) {\n\t\t\t\treturn timeline._getPositioningContext(task);\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\n\t\tclear_drag_state: function() {\n\t\t\tthis.drag = {\n\t\t\t\tid: null,\n\t\t\t\tmode: null,\n\t\t\t\tpos: null,\n\t\t\t\tstart_x: null,\n\t\t\t\tstart_y: null,\n\t\t\t\tobj: null,\n\t\t\t\tleft: null\n\t\t\t};\n\t\t\tthis.dragMultiple = {};\n\t\t},\n\t\t_resize: function(task, shift, drag) {\n\t\t\tvar cfg = timeline.$getConfig();\n\t\t\tvar coords_x = this._drag_task_coords(task, drag);\n\t\t\tif (drag.left) {\n\t\t\t\ttask.start_date = gantt.dateFromPos(coords_x.start + shift, this._getPositioningContext(task));\n\t\t\t\tif (!task.start_date) {\n\t\t\t\t\ttask.start_date = new Date(gantt.getState().min_date);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\ttask.end_date = gantt.dateFromPos(coords_x.end + shift, this._getPositioningContext(task));\n\t\t\t\tif (!task.end_date) {\n\t\t\t\t\ttask.end_date = new Date(gantt.getState().max_date);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar minDurationInUnits = this._calculateMinDuration(cfg.min_duration, cfg.duration_unit);\n\t\t\tif (task.end_date - task.start_date < cfg.min_duration) {\n\t\t\t\tif (drag.left)\n\t\t\t\t\ttask.start_date = gantt.calculateEndDate(task.end_date, -minDurationInUnits, cfg.duration_unit, task);\n\t\t\t\telse\n\t\t\t\t\ttask.end_date = gantt.calculateEndDate(task.start_date, minDurationInUnits, cfg.duration_unit, task);\n\t\t\t}\n\t\t\tgantt._init_task_timing(task);\n\t\t},\n\t\t_calculateMinDuration: function(duration, unit) {\n\t\t\tvar inMs = {\n\t\t\t\t\"minute\": 60000,\n\t\t\t\t\"hour\": 3600000,\n\t\t\t\t\"day\": 86400000,\n\t\t\t\t\"week\": 604800000,\n\t\t\t\t\"month\": 2419200000,\n\t\t\t\t\"year\": 31356000000\n\t\t\t};\n\t\t\treturn Math.ceil(duration / inMs[unit]);\n\t\t},\n\t\t_resize_progress: function(task, shift, drag) {\n\t\t\tvar coords_x = this._drag_task_coords(task, drag);\n\n\t\t\tvar config = timeline.$getConfig();\n\t\t\tvar diffValue = !config.rtl ? (drag.pos.x - coords_x.start) : (coords_x.start - drag.pos.x);\n\n\t\t\tvar diff = Math.max(0, diffValue);\n\t\t\ttask.progress = Math.min(1, diff / Math.abs(coords_x.end - coords_x.start));\n\t\t},\n\t\t_find_max_shift: function(dragItems, shift) {\n\t\t\tvar correctShift;\n\t\t\tfor (var i in dragItems) {\n\t\t\t\tvar drag = dragItems[i];\n\t\t\t\tvar task = gantt.getTask(drag.id);\n\t\t\t\tif (task.unscheduled){\n\t\t\t\t\t// GS-1674. There is no need to check the tasks that are ignored by projects\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tvar coords_x = this._drag_task_coords(task, drag);\n\t\t\t\tvar minX = gantt.posFromDate(new Date(gantt.getState().min_date), this._getPositioningContext(task));\n\t\t\t\tvar maxX = gantt.posFromDate(new Date(gantt.getState().max_date), this._getPositioningContext(task));\n\n\t\t\t\tif (coords_x.end + shift > maxX) {\n\t\t\t\t\tvar maxShift = maxX - coords_x.end;\n\t\t\t\t\tif (maxShift < correctShift || correctShift === undefined) {\n\t\t\t\t\t\tcorrectShift = maxShift;\n\t\t\t\t\t}\n\t\t\t\t} else if (coords_x.start + shift < minX) {\n\t\t\t\t\tvar minShift = minX - coords_x.start;\n\t\t\t\t\tif (minShift > correctShift || correctShift === undefined) {\n\t\t\t\t\t\tcorrectShift = minShift;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn correctShift;\n\t\t},\n\t\t_move: function(task, shift, drag, multipleDragShift) {\n\t\t\tvar coords_x = this._drag_task_coords(task, drag);\n\t\t\tvar new_start = null,\n\t\t\tnew_end = null;\n\t\t\t// GS-454: If we drag multiple tasks, rely on the dates instead of timeline coordinates\n\t\t\tif (multipleDragShift){\n\t\t\t\tnew_start = new Date(+drag.obj.start_date + multipleDragShift),\n\t\t\t\tnew_end = new Date(+drag.obj.end_date + multipleDragShift);\n\t\t\t} else {\n\t\t\t\tnew_start = gantt.dateFromPos(coords_x.start + shift, this._getPositioningContext(task)),\n\t\t\t\tnew_end = gantt.dateFromPos(coords_x.end + shift, this._getPositioningContext(task));\n\t\t\t}\n\t\t\tif (!new_start) {\n\t\t\t\ttask.start_date = new Date(gantt.getState().min_date);\n\t\t\t\ttask.end_date = gantt.dateFromPos(gantt.posFromDate(task.start_date) + (coords_x.end - coords_x.start), this._getPositioningContext(task));\n\t\t\t} else if (!new_end) {\n\t\t\t\ttask.end_date = new Date(gantt.getState().max_date);\n\t\t\t\ttask.start_date = gantt.dateFromPos(gantt.posFromDate(task.end_date) - (coords_x.end - coords_x.start), this._getPositioningContext(task));\n\t\t\t} else {\n\t\t\t\ttask.start_date = new_start;\n\t\t\t\ttask.end_date = new_end;\n\t\t\t}\n\t\t},\n\t\t_drag_task_coords: function(t, drag) {\n\t\t\tvar start = drag.obj_s_x = drag.obj_s_x || gantt.posFromDate(t.start_date, this._getPositioningContext(t));\n\t\t\tvar end = drag.obj_e_x = drag.obj_e_x || gantt.posFromDate(t.end_date, this._getPositioningContext(t));\n\t\t\treturn {\n\t\t\t\tstart: start,\n\t\t\t\tend: end\n\t\t\t};\n\t\t},\n\t\t_mouse_position_change: function(oldPos, newPos) {\n\t\t\tvar dx = oldPos.x - newPos.x,\n\t\t\t\tdy = oldPos.y - newPos.y;\n\t\t\treturn Math.sqrt(dx * dx + dy * dy);\n\t\t},\n\t\t_is_number: function(n) {\n\t\t\treturn !isNaN(parseFloat(n)) && isFinite(n);\n\t\t},\n\n\t\ton_mouse_move: function(e) {\n\t\t\tif (this.drag.start_drag) {\n\t\t\t\tvar pos = domHelpers.getRelativeEventPosition(e, gantt.$task_data);\n\n\t\t\t\tvar sX = this.drag.start_drag.start_x,\n\t\t\t\t\tsY = this.drag.start_drag.start_y;\n\n\t\t\t\tif ((Date.now() - this.drag.timestamp > 50) ||\n\t\t\t\t\t(this._is_number(sX) && this._is_number(sY) && this._mouse_position_change({\n\t\t\t\t\t\tx: sX,\n\t\t\t\t\t\ty: sY\n\t\t\t\t\t}, pos) > 20)) {\n\t\t\t\t\tthis._start_dnd(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar drag = this.drag;\n\n\t\t\tif (drag.mode) {\n\t\t\t\tif (!timeout(this, 40))//limit update frequency\n\t\t\t\t\treturn;\n\n\t\t\t\tthis._update_on_move(e);\n\n\t\t\t}\n\t\t},\n\n\t\t_update_item_on_move: function(shift, id, mode, drag, e, multipleDragShift) {\n\t\t\tvar task = gantt.getTask(id);\n\t\t\tvar original = gantt.mixin({}, task);\n\t\t\tvar copy = gantt.mixin({}, task);\n\t\t\tthis._handlers[mode].apply(this, [copy, shift, drag, multipleDragShift]);\n\t\t\tgantt.mixin(task, copy, true);\n\t\t\t//gantt._update_parents(drag.id, true);\n\t\t\tgantt.callEvent(\"onTaskDrag\", [task.id, mode, copy, original, e]);\n\t\t\tgantt.mixin(task, copy, true);\n\t\t\tgantt.refreshTask(id);\n\t\t},\n\n\t\t_update_on_move: function(e) {\n\t\t\tvar drag = this.drag;\n\t\t\tvar config = timeline.$getConfig();\n\t\t\tif (drag.mode) {\n\t\t\t\tvar pos = domHelpers.getRelativeEventPosition(e, timeline.$task_data);\n\t\t\t\tif (drag.pos && drag.pos.x == pos.x)\n\t\t\t\t\treturn;\n\n\t\t\t\tdrag.pos = pos;\n\n\t\t\t\tconst task = gantt.getTask(drag.id);\n\n\t\t\t\tvar curr_date = gantt.dateFromPos(pos.x, this._getPositioningContext(task));\n\t\t\t\tif (!curr_date || isNaN(curr_date.getTime()))\n\t\t\t\t\treturn;\n\n\n\t\t\t\tvar shift = pos.x - drag.start_x;\n\t\t\t\t\n\t\t\t\tif (this._handlers[drag.mode]) {\n\t\t\t\t\tif (drag.mode === config.drag_mode.move) {\n\t\t\t\t\t\tvar dragHash = {};\n\n\t\t\t\t\t\tif (this._isMultiselect()) {\n\t\t\t\t\t\t\tvar selectedTasksIds = gantt.getSelectedTasks();\n\t\t\t\t\t\t\tif (selectedTasksIds.indexOf(drag.id) >= 0) {\n\t\t\t\t\t\t\t\tdragHash = this.dragMultiple;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar dragProject = false;\n\t\t\t\t\t\tif (gantt.isSummaryTask(task) && gantt.config.drag_project) {\n\t\t\t\t\t\t\tvar initialDrag = {};\n\t\t\t\t\t\t\tinitialDrag[drag.id] = utils.copy(drag);\n\t\t\t\t\t\t\tdragProject = true;\n\t\t\t\t\t\t\tdragHash = utils.mixin(initialDrag, this.dragMultiple);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar maxShift = this._find_max_shift(dragHash, shift);\n\t\t\t\t\t\tif (maxShift !== undefined) {\n\t\t\t\t\t\t\tshift = maxShift;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._update_item_on_move(shift, drag.id, drag.mode, drag, e);\n\n\t\t\t\t\t\tlet multipleDragShift;\n\t\t\t\t\t\tif (maxShift === undefined) {\n\t\t\t\t\t\t\t// GS-2593. If the timeline is repainted during the drag (infinite scale scenario)\n\t\t\t\t\t\t\t// we need to update the initial drag position to correctly update\n\t\t\t\t\t\t\t// the position of other dragged tasks\n\t\t\t\t\t\t\tconst newStartPos = gantt.posFromDate(drag.obj.start_date, this._getPositioningContext(drag.obj));\n\t\t\t\t\t\t\tconst newEndPos = gantt.posFromDate(drag.obj.end_date, this._getPositioningContext(drag.obj));\n\t\t\t\t\t\t\t// calculate the offset only when the drag started\n\t\t\t\t\t\t\tif (drag.handle_offset === undefined){\n\t\t\t\t\t\t\t\tconst width = newEndPos - newStartPos;\n\t\t\t\t\t\t\t\tconst dragPos = drag.start_x - newStartPos;\n\t\t\t\t\t\t\t\tdrag.handle_offset = dragPos / width;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst newWidth = Math.abs(newEndPos - newStartPos);\n\t\t\t\t\t\t\tlet dragX = newStartPos + newWidth * drag.handle_offset;\n\n\t\t\t\t\t\t\t// GS-454: Calculate the date shift in milliseconds instead of pixels\n\t\t\t\t\t\t\tconst shiftDate = gantt.dateFromPos(dragX, this._getPositioningContext(drag.obj));\n\t\t\t\t\t\t\tmultipleDragShift = curr_date - shiftDate;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tfor (var i in dragHash) {\n\t\t\t\t\t\t\tvar childDrag = dragHash[i];\n\t\t\t\t\t\t\tif(dragProject && childDrag.id != drag.id){\n\t\t\t\t\t\t\t\tgantt._bulk_dnd = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis._update_item_on_move(shift, childDrag.id, childDrag.mode, childDrag, e, multipleDragShift);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tgantt._bulk_dnd = false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// for resize and progress\n\t\t\t\t\t\tthis._update_item_on_move(shift, drag.id, drag.mode, drag, e);\n\t\t\t\t\t}\n\t\t\t\t\tgantt._update_parents(drag.id);\n\t\t\t\t}\n\n\t\t\t}\n\t\t},\n\n\t\ton_mouse_down: function(e, src) {\n\t\t\t// on Mac we do not get onmouseup event when clicking right mouse button leaving us in dnd state\n\t\t\t// let's ignore right mouse button then\n\t\t\tif (e.button == 2 && e.button !== undefined)\n\t\t\t\treturn;\n\n\t\t\tvar config = timeline.$getConfig();\n\t\t\tvar id = gantt.locate(e);\n\t\t\tvar task = null;\n\t\t\tif (gantt.isTaskExists(id)) {\n\t\t\t\ttask = gantt.getTask(id);\n\t\t\t}\n\n\t\t\tif (gantt.isReadonly(task) || this.drag.mode) return;\n\n\t\t\tthis.clear_drag_state();\n\n\t\t\tsrc = src || (e.target || e.srcElement);\n\n\t\t\tvar className = domHelpers.getClassName(src);\n\t\t\tvar drag = this._get_drag_mode(className, src);\n\n\t\t\tif (!className || !drag) {\n\t\t\t\tif (src.parentNode)\n\t\t\t\t\treturn this.on_mouse_down(e, src.parentNode);\n\t\t\t\telse\n\t\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!drag) {\n\t\t\t\tif (gantt.checkEvent(\"onMouseDown\") && gantt.callEvent(\"onMouseDown\", [className.split(\" \")[0]])) {\n\t\t\t\t\tif (src.parentNode)\n\t\t\t\t\t\treturn this.on_mouse_down(e, src.parentNode);\n\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (drag.mode && drag.mode != config.drag_mode.ignore && config[\"drag_\" + drag.mode]) {\n\t\t\t\t\tid = gantt.locate(src);\n\t\t\t\t\ttask = gantt.copy(gantt.getTask(id) || {});\n\n\t\t\t\t\tif (gantt.isReadonly(task)) {\n\t\t\t\t\t\tthis.clear_drag_state();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ((gantt.isSummaryTask(task) && !(task.auto_scheduling === false) && !config.drag_project) && drag.mode != config.drag_mode.progress) {//only progress drag is allowed for tasks with flexible duration\n\t\t\t\t\t\tthis.clear_drag_state();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tdrag.id = id;\n\t\t\t\t\tvar pos = domHelpers.getRelativeEventPosition(e, gantt.$task_data);\n\n\t\t\t\t\tdrag.start_x = pos.x;\n\t\t\t\t\tdrag.start_y = pos.y;\n\t\t\t\t\tdrag.obj = task;\n\t\t\t\t\tthis.drag.start_drag = drag;\n\t\t\t\t\tthis.drag.timestamp = Date.now();\n\n\t\t\t\t} else\n\t\t\t\t\tthis.clear_drag_state();\n\t\t\t}\n\t\t},\n\t\t_fix_dnd_scale_time: function(task, drag) {\n\t\t\tvar config = timeline.$getConfig();\n\t\t\tvar unit = gantt.getScale().unit,\n\t\t\t\tstep = gantt.getScale().step;\n\t\t\tif (!config.round_dnd_dates) {\n\t\t\t\tunit = 'minute';\n\t\t\t\tstep = config.time_step;\n\t\t\t}\n\n\t\t\tfunction fixStart(task) {\n\t\t\t\tif (!gantt.config.correct_work_time)\n\t\t\t\t\treturn;\n\t\t\t\tvar config = timeline.$getConfig();\n\t\t\t\tif (!gantt.isWorkTime(task.start_date, undefined, task))\n\t\t\t\t\ttask.start_date = gantt.calculateEndDate({\n\t\t\t\t\t\tstart_date: task.start_date,\n\t\t\t\t\t\tduration: -1,\n\t\t\t\t\t\tunit: config.duration_unit,\n\t\t\t\t\t\ttask: task\n\t\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction fixEnd(task) {\n\t\t\t\tif (!gantt.config.correct_work_time)\n\t\t\t\t\treturn;\n\t\t\t\tvar config = timeline.$getConfig();\n\t\t\t\tif (!gantt.isWorkTime(new Date(task.end_date - 1), undefined, task))\n\t\t\t\t\ttask.end_date = gantt.calculateEndDate({\n\t\t\t\t\t\tstart_date: task.end_date,\n\t\t\t\t\t\tduration: 1,\n\t\t\t\t\t\tunit: config.duration_unit,\n\t\t\t\t\t\ttask: task\n\t\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst dndContext = timeline._getPositioningContext(task);\n\n\t\t\tif (drag.mode == config.drag_mode.resize) {\n\t\t\t\tif (drag.left) {\n\t\t\t\t\ttask.start_date = gantt.roundDate({date: task.start_date, unit: unit, step: step});\n\t\n\t\t\t\t\tif(dndContext && dndContext.calendar){\n\t\t\t\t\t\ttask.start_date = dndContext.calendar.getClosestWorkTime({date: task.start_date, dir:\"future\"});\n\t\t\t\t\t}\n\t\t\t\t\tfixStart(task);\n\t\t\t\t} else {\n\t\t\t\t\ttask.end_date = gantt.roundDate({date: task.end_date, unit: unit, step: step});\n\t\t\t\t\tif(dndContext && dndContext.calendar){\n\t\t\t\t\t\ttask.end_date = dndContext.calendar.getClosestWorkTime({date: task.end_date});\n\t\t\t\t\t}\n\t\t\t\t\tfixEnd(task);\n\t\t\t\t}\n\t\t\t} else if (drag.mode == config.drag_mode.move) {\n\t\t\t\ttask.start_date = gantt.roundDate({date: task.start_date, unit: unit, step: step});\n\t\t\t\t\n\t\t\t\tif(dndContext && dndContext.calendar){\n\t\t\t\t\ttask.start_date = dndContext.calendar.getClosestWorkTime({date: task.start_date, dir:\"future\"});\n\t\t\t\t}\n\n\t\t\t\tfixStart(task);\n\t\t\t\ttask.end_date = gantt.calculateEndDate(task);\n\t\t\t}\n\t\t},\n\t\t_fix_working_times: function(task, drag) {\n\t\t\tvar config = timeline.$getConfig();\n\t\t\tvar drag = drag || {mode: config.drag_mode.move};\n\n\t\t\tif (drag.mode == config.drag_mode.resize) {\n\t\t\t\tif (drag.left) {\n\t\t\t\t\ttask.start_date = gantt.getClosestWorkTime({date: task.start_date, dir: 'future', task: task});\n\t\t\t\t} else {\n\t\t\t\t\ttask.end_date = gantt.getClosestWorkTime({date: task.end_date, dir: 'past', task: task});\n\t\t\t\t}\n\t\t\t} else if (drag.mode == config.drag_mode.move) {\n\t\t\t\tgantt.correctTaskWorkTime(task);\n\t\t\t}\n\t\t},\n\n\t\t_finalize_mouse_up: function(taskId, config, drag, e) {\n\t\t\tvar task = gantt.getTask(taskId);\n\n\t\t\tif (config.work_time && config.correct_work_time) {\n\t\t\t\tthis._fix_working_times(task, drag);\n\t\t\t}\n\n\t\t\tthis._fix_dnd_scale_time(task, drag);\n\n\t\t\tif (!this._fireEvent(\"before_finish\", drag.mode, [taskId, drag.mode, gantt.copy(drag.obj), e])) {\n\t\t\t\t//drag.obj._dhx_changed = false;\n\t\t\t\tthis.clear_drag_state();\n\t\t\t\tif (taskId == drag.id) {\n\t\t\t\t\tdrag.obj._dhx_changed = false;\n\t\t\t\t\tgantt.mixin(task, drag.obj, true);\n\t\t\t\t}\n\n\n\t\t\t\tgantt.refreshTask(task.id);\n\t\t\t\t// GS-2013. Repaint parent projects when the drag is cancelled\n\t\t\t\tif (task.$level > 100){\n\t\t\t\t\t// When there are too many tasks to repaint, it is better to repaint Gantt\n\t\t\t\t\tlet shouldRepaint = false;\n\t\t\t\t\tgantt.eachParent(function(parent){\n\t\t\t\t\t\tif (!shouldRepaint && parent.type === gantt.config.types.project) {\n\t\t\t\t\t\t\tconst initialDates = {start_date: parent.start_date, end_date: parent.end_date};\n\t\t\t\t\t\t\tgantt.resetProjectDates(parent);\n\t\t\t\t\t\t\tif (+initialDates.start_date !== +parent.start_date || +initialDates.end_date !== +parent.end_date){\n\t\t\t\t\t\t\t\tshouldRepaint = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},task.id);\n\t\t\t\t\tif (shouldRepaint){\n\t\t\t\t\t\tgantt.refreshData();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// If there are not so many parents especially if there are split tasks,\n\t\t\t\t\t// it is better to repaint individual tasks\n\t\t\t\t\tgantt.eachParent(function(parent){\n\t\t\t\t\t\tif (parent.type === gantt.config.types.project) {\n\t\t\t\t\t\t\tconst initialDates = {start_date: parent.start_date, end_date: parent.end_date};\n\t\t\t\t\t\t\tgantt.resetProjectDates(parent);\n\t\t\t\t\t\t\tif (+initialDates.start_date !== +parent.start_date || +initialDates.end_date !== +parent.end_date){\n\t\t\t\t\t\t\t\tgantt.refreshTask(parent.id);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},task.id);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar drag_id = taskId;\n\n\t\t\t\tgantt._init_task_timing(task);\n\n\t\t\t\tthis.clear_drag_state();\n\t\t\t\tgantt.updateTask(task.id);\n\t\t\t\tthis._fireEvent(\"after_finish\", drag.mode, [drag_id, drag.mode, e]);\n\t\t\t}\n\n\t\t},\n\n\t\ton_mouse_up: function(e) {\n\n\t\t\tvar drag = this.drag;\n\t\t\tif (drag.mode && drag.id) {\n\t\t\t\tvar config = timeline.$getConfig();\n\t\t\t\t//drop\n\t\t\t\tvar task = gantt.getTask(drag.id);\n\t\t\t\tvar dragMultiple = this.dragMultiple;\n\n\t\t\t\tvar finalizingBulkMove = false;\n\t\t\t\tvar moveCount = 0;\n\t\t\t\tif (drag.mode === config.drag_mode.move) {\n\t\t\t\t\tif ((gantt.isSummaryTask(task) && config.drag_project) || (this._isMultiselect())) {\n\t\t\t\t\t\tfinalizingBulkMove = true;\n\t\t\t\t\t\tmoveCount = Object.keys(dragMultiple).length;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar doFinalize = function doFinalize(){\n\t\t\t\t\tif(finalizingBulkMove){\n\t\t\t\t\t\tfor (var i in dragMultiple) {\n\t\t\t\t\t\t\t// GS-1057: Don't call drag events for the dragged task as they will be called later\n\t\t\t\t\t\t\tif (dragMultiple[i].id != drag.id){\n\t\t\t\t\t\t\t\tthis._finalize_mouse_up(dragMultiple[i].id, config, dragMultiple[i], e);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis._finalize_mouse_up(drag.id, config, drag, e);\n\n\t\t\t\t};\n\n\t\t\t\tif(finalizingBulkMove && moveCount > 10){// 10 - arbitrary threshold for bulk dnd at which we start doing complete repaint to refresh\n\t\t\t\t\tgantt.batchUpdate(function(){\n\t\t\t\t\t\tdoFinalize.call(this);\n\t\t\t\t\t}.bind(this));\n\t\t\t\t}else{\n\t\t\t\t\tdoFinalize.call(this);\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tthis.clear_drag_state();\n\t\t},\n\t\t_get_drag_mode: function(className, el) {\n\t\t\tvar config = timeline.$getConfig();\n\t\t\tvar modes = config.drag_mode;\n\t\t\tvar classes = (className || \"\").split(\" \");\n\t\t\tvar classname = classes[0];\n\t\t\tvar drag = {mode: null, left: null};\n\t\t\tswitch (classname) {\n\t\t\t\tcase \"gantt_task_line\":\n\t\t\t\tcase \"gantt_task_content\":\n\t\t\t\t\tdrag.mode = modes.move;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"gantt_task_drag\":\n\t\t\t\t\tdrag.mode = modes.resize;\n\n\t\t\t\t\tvar dragProperty = el.getAttribute(\"data-bind-property\");\n\n\t\t\t\t\tif (dragProperty == \"start_date\") {\n\t\t\t\t\t\tdrag.left = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdrag.left = false;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"gantt_task_progress_drag\":\n\t\t\t\t\tdrag.mode = modes.progress;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"gantt_link_control\":\n\t\t\t\tcase \"gantt_link_point\":\n\t\t\t\t\tdrag.mode = modes.ignore;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tdrag = null;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\treturn drag;\n\n\t\t},\n\n\t\t_start_dnd: function(e) {\n\t\t\tvar drag = this.drag = this.drag.start_drag;\n\t\t\tdelete drag.start_drag;\n\n\t\t\tvar cfg = timeline.$getConfig();\n\t\t\tvar id = drag.id;\n\n\t\t\tif (!cfg[\"drag_\" + drag.mode] || !gantt.callEvent(\"onBeforeDrag\", [id, drag.mode, e]) || !this._fireEvent(\"before_start\", drag.mode, [id, drag.mode, e])) {\n\t\t\t\tthis.clear_drag_state();\n\t\t\t} else {\n\t\t\t\tdelete drag.start_drag;\n\t\t\t\tvar task = gantt.getTask(id);\n\t\t\t\tif (gantt.isReadonly(task)){\n\t\t\t\t\tthis.clear_drag_state();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (this._isMultiselect()) {\n\t\t\t\t\t// for don't move selected tasks when drag unselected task\n\t\t\t\t\tvar selectedTasksIds = gantt.getSelectedTasks();\n\t\t\t\t\tif (selectedTasksIds.indexOf(drag.id) >= 0) {\n\t\t\t\t\t\thelpers.forEach(selectedTasksIds, gantt.bind(function(taskId) {\n\t\t\t\t\t\t\tvar selectedTask = gantt.getTask(taskId);\n\t\t\t\t\t\t\tif (gantt.isSummaryTask(selectedTask) && gantt.config.drag_project && drag.mode == cfg.drag_mode.move) {\n\t\t\t\t\t\t\t\tthis._addSubtasksToDragMultiple(selectedTask.id);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.dragMultiple[taskId] = gantt.mixin({\n\t\t\t\t\t\t\t\tid: selectedTask.id,\n\t\t\t\t\t\t\t\tobj: gantt.copy(selectedTask)\n\t\t\t\t\t\t\t}, this.drag);\n\t\t\t\t\t\t}, this));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// for move unselected summary\n\t\t\t\tif (gantt.isSummaryTask(task) && gantt.config.drag_project && drag.mode == cfg.drag_mode.move) {\n\t\t\t\t\tthis._addSubtasksToDragMultiple(task.id);\n\t\t\t\t}\n\t\t\t\tgantt.callEvent(\"onTaskDragStart\", []);\n\t\t\t}\n\n\t\t},\n\t\t_fireEvent: function(stage, mode, params) {\n\t\t\tgantt.assert(this._events[stage], \"Invalid stage:{\" + stage + \"}\");\n\n\t\t\tvar trigger = this._events[stage][mode];\n\n\t\t\tgantt.assert(trigger, \"Unknown after drop mode:{\" + mode + \"}\");\n\t\t\tgantt.assert(params, \"Invalid event arguments\");\n\n\n\t\t\tif (!gantt.checkEvent(trigger))\n\t\t\t\treturn true;\n\n\t\t\treturn gantt.callEvent(trigger, params);\n\t\t},\n\n\t\tround_task_dates: function(task) {\n\t\t\tvar drag_state = this.drag;\n\t\t\tvar config = timeline.$getConfig();\n\t\t\tif (!drag_state) {\n\t\t\t\tdrag_state = {mode: config.drag_mode.move};\n\t\t\t}\n\t\t\tthis._fix_dnd_scale_time(task, drag_state);\n\t\t},\n\t\tdestructor: function() {\n\t\t\tthis._domEvents.detachAll();\n\t\t},\n\t\t_isMultiselect: function() {\n\t\t\treturn gantt.config.drag_multiple && !!(gantt.getSelectedTasks && gantt.getSelectedTasks().length > 0);\n\t\t},\n\t\t_addSubtasksToDragMultiple: function(summaryId) {\n\t\t\tgantt.eachTask(function(child) {\n\t\t\t\tthis.dragMultiple[child.id] = gantt.mixin({\n\t\t\t\t\tid: child.id,\n\t\t\t\t\tobj: gantt.copy(child)\n\t\t\t\t}, this.drag);\n\t\t\t}, summaryId, this);\n\t\t}\n\t};\n}\n\nfunction initTaskDND() {\n\tvar _tasks_dnd;\n\treturn {\n\t\textend: function(timeline) {\n\t\t\ttimeline.roundTaskDates = function(task) {\n\t\t\t\t_tasks_dnd.round_task_dates(task);\n\t\t\t};\n\n\t\t},\n\t\tinit: function(timeline, gantt) {\n\t\t\t_tasks_dnd = createTaskDND(timeline, gantt);\n\t\t\t// TODO: entry point for touch handlers, move touch to timeline\n\t\t\ttimeline._tasks_dnd = _tasks_dnd;\n\t\t\treturn _tasks_dnd.init(gantt);\n\t\t},\n\t\tdestructor: function() {\n\t\t\tif (_tasks_dnd) {\n\t\t\t\t_tasks_dnd.destructor();\n\t\t\t\t_tasks_dnd = null;\n\t\t\t}\n\t\t}\n\t};\n}\n\nexport default {\n\tcreateTaskDND: initTaskDND\n};","import * as domHelpers from \"../utils/dom_helpers\";\n\nvar initLinksDND = function(timeline, gantt) {\n\tvar _link_landing,\n\t\t_link_target_task,\n\t\t_link_target_task_start,\n\t\t_link_source_task,\n\t\t_link_source_task_start,\n\t\tmarkerDefaultOffset = 10,\n\t\tscrollDefaultSize = 18;\n\n\tfunction getDndState(){\n\t\treturn {\n\t\t\tlink_source_id : _link_source_task,\n\t\t\tlink_target_id : _link_target_task,\n\t\t\tlink_from_start : _link_source_task_start,\n\t\t\tlink_to_start : _link_target_task_start,\n\t\t\tlink_landing_area : _link_landing\n\t\t};\n\t}\n\n\tvar services = gantt.$services;\n\n\tvar state = services.getService(\"state\");\n\tvar DnD = services.getService(\"dnd\");\n\n\tstate.registerProvider(\"linksDnD\", getDndState);\n\n\tvar start_marker = \"task_start_date\",\n\t\tend_marker = \"task_end_date\",\n\t\tlink_edge_marker = \"gantt_link_point\",\n\t\tlink_landing_hover_area = \"gantt_link_control\";\n\n\tvar dnd = new DnD(timeline.$task_bars, {\n\t\tsensitivity : 0,\n\t\tupdates_per_second : 60,\n\t\tmousemoveContainer: gantt.$root,\n\t\tselector: \".\" + link_edge_marker,\n\t\tpreventDefault: true\n\t});\n\n\tdnd.attachEvent(\"onBeforeDragStart\", gantt.bind(function(obj,e) {\n\t\tvar target = (e.target||e.srcElement);\n\t\tresetDndState();\n\t\tif(gantt.getState(\"tasksDnd\").drag_id)\n\t\t\treturn false;\n\n\t\tif(domHelpers.locateClassName(target, link_edge_marker)){\n\t\t\tif(domHelpers.locateClassName(target, start_marker))\n\t\t\t\t_link_source_task_start = true;\n\n\t\t\tvar sid = gantt.locate(e);\n\t\t\t_link_source_task = sid;\n\n\t\t\tvar t = gantt.getTask(sid);\n\t\t\tif(gantt.isReadonly(t)){\n\t\t\t\tresetDndState();\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis._dir_start = {\n\t\t\t\tx: dnd.config.original_element_sizes.x + dnd.config.original_element_sizes.width/2,\n\t\t\t\ty: dnd.config.original_element_sizes.y + dnd.config.original_element_sizes.height/2\n\t\t\t};\n\n\t\t\treturn true;\n\t\t}else{\n\t\t\treturn false;\n\t\t}\n\n\t}, this));\n\n\tdnd.attachEvent(\"onAfterDragStart\", gantt.bind(function(obj,e) {\n\t\tif(gantt.config.touch) {\n\t\t\tgantt.refreshData();\n\t\t}\n\t\tupdateMarkedHtml(dnd.config.marker);\n\t}, this));\n\n\tfunction getVieportSize(){\n\t\tvar root = gantt.$root;\n\t\treturn { right: root.offsetWidth, bottom: root.offsetHeight };\n\t}\n\tfunction getMarkerSize (marker){\n\t\tvar width = 0, height = 0;\n\t\tif(marker){\n\t\t\twidth = marker.offsetWidth || 0;\n\t\t\theight = marker.offsetHeight || 0;\n\t\t}\n\t\treturn { width: width, height: height };\n\t}\n\n\tfunction getPosition(e, marker){\n\t\tvar oldPos = dnd.getPosition(e);\n\n\t\tvar markerSize = getMarkerSize(marker);\n\t\tvar viewportSize = getVieportSize();\n\n\t\tvar offsetX = gantt.config.tooltip_offset_x || markerDefaultOffset;\n\t\tvar offsetY = gantt.config.tooltip_offset_y || markerDefaultOffset;\n\n\t\tvar scrollSize = gantt.config.scroll_size || scrollDefaultSize;\n\n\t\t// GS-1315: Add offset if there are elements above Gantt\n\t\tvar ganttOffsetY = gantt.$container.getBoundingClientRect().y + window.scrollY;\n\n\t\tvar position = {\n\t\t\ty: oldPos.y + offsetY,\n\t\t\tx: oldPos.x + offsetX,\n\t\t\tbottom: oldPos.y + markerSize.height + offsetY + scrollSize,\n\t\t\tright: oldPos.x + markerSize.width + offsetX + scrollSize\n\t\t};\n\n\t\tif(position.bottom > viewportSize.bottom + ganttOffsetY){\n\t\t\tposition.y = viewportSize.bottom + ganttOffsetY - markerSize.height - offsetY;\n\t\t}\n\n\t\tif(position.right > viewportSize.right){\n\t\t\tposition.x = viewportSize.right - markerSize.width - offsetX;\n\t\t}\n\t\treturn position;\n\t}\n\n\tdnd.attachEvent(\"onDragMove\", gantt.bind(function(obj,e) {\n\t\tvar dd = dnd.config;\n\t\tvar pos = getPosition(e, dd.marker);\n\t\tadvanceMarker(dd.marker, pos);\n\t\tvar landing = !!domHelpers.locateClassName(e, link_landing_hover_area);\n\n\t\tvar prevTarget = _link_target_task;\n\t\tvar prevLanding = _link_landing;\n\t\tvar prevToStart = _link_target_task_start;\n\n\t\tvar targ = gantt.locate(e),\n\t\t\tto_start = true;\n\n\t\t// can drag and drop link to another gantt on the page, such links are not supported\n\t\tvar eventTarget = domHelpers.getTargetNode(e);\n\n\t\tvar sameGantt = domHelpers.isChildOf(eventTarget, gantt.$root);\n\t\tif(!sameGantt){\n\t\t\tlanding = false;\n\t\t\ttarg = null;\n\t\t}\n\n\t\tif(landing){\n\t\t\t//refreshTask\n\t\t\tto_start = !domHelpers.locateClassName(e, end_marker);\n\t\t\tlanding = !!targ;\n\t\t}\n\n\t\t_link_target_task = targ;\n\t\t_link_landing = landing;\n\t\t_link_target_task_start = to_start;\n\n\t\tif(landing){\n\n\t\t\tvar node = domHelpers.locateClassName(e, link_landing_hover_area);\n\t\t\n\t\t\tconst point = node.querySelector(`.${link_edge_marker}`);\n\t\t\tif(point){\n\t\t\t\tconst absCoords = domHelpers.getRelativeNodePosition(point, timeline.$task_bg);\n\t\t\t\tthis._dir_end = {\n\t\t\t\t\tx: absCoords.x + point.offsetWidth/2,\n\t\t\t\t\ty: absCoords.y + point.offsetHeight/2\n\t\t\t\t};\n\t\t\t}\n\n\t\t}else{\n\t\t\tthis._dir_end = domHelpers.getRelativeEventPosition(e, timeline.$task_data);\n\t\t\tif(gantt.env.isEdge){ // to fix margin collapsing\n\t\t\t\tthis._dir_end.y += window.scrollY;\n\t\t\t}\n\t\t}\n\n\t\tvar targetChanged = !(prevLanding == landing && prevTarget == targ && prevToStart == to_start);\n\t\tif(targetChanged){\n\t\t\tif(prevTarget)\n\t\t\t\tgantt.refreshTask(prevTarget, false);\n\t\t\tif(targ)\n\t\t\t\tgantt.refreshTask(targ, false);\n\t\t}\n\n\t\tif(targetChanged){\n\t\t\tupdateMarkedHtml(dd.marker);\n\t\t}\n\n\t\tshowDirectingLine(this._dir_start.x, this._dir_start.y, this._dir_end.x, this._dir_end.y);\n\n\t\treturn true;\n\t}, this));\n\n\n\tdnd.attachEvent(\"onDragEnd\", gantt.bind(function() {\n\t\tvar drag = getDndState();\n\n\t\tif(drag.link_source_id && drag.link_target_id && drag.link_source_id != drag.link_target_id){\n\t\t\tvar type = gantt._get_link_type(drag.link_from_start, drag.link_to_start);\n\n\t\t\tvar link = {source : drag.link_source_id, target: drag.link_target_id, type:type};\n\t\t\tif(link.type && gantt.isLinkAllowed(link)) {\n\t\t\t\tif(gantt.callEvent(\"onLinkCreated\", [link])){\n\t\t\t\t\tgantt.addLink(link);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tresetDndState();\n\n\t\tif(gantt.config.touch) {\n\t\t\tgantt.refreshData();\n\t\t}\n\t\telse {\n\t\t\tif (drag.link_source_id)\n\t\t\t\tgantt.refreshTask(drag.link_source_id, false);\n\t\t\tif (drag.link_target_id)\n\t\t\t\tgantt.refreshTask(drag.link_target_id, false);\n\t\t}\n\t\tremoveDirectionLine();\n\t}, this));\n\n\tfunction updateMarkedHtml(marker){\n\t\tvar link = getDndState();\n\n\t\tvar css = [\"gantt_link_tooltip\"];\n\t\tif(link.link_source_id && link.link_target_id){\n\t\t\tif(gantt.isLinkAllowed(link.link_source_id, link.link_target_id, link.link_from_start, link.link_to_start)){\n\t\t\t\tcss.push(\"gantt_allowed_link\");\n\t\t\t}else{\n\t\t\t\tcss.push(\"gantt_invalid_link\");\n\t\t\t}\n\t\t}\n\n\t\tvar className = gantt.templates.drag_link_class(link.link_source_id, link.link_from_start, link.link_target_id, link.link_to_start);\n\t\tif(className)\n\t\t\tcss.push(className);\n\n\t\tvar html = \"<div class='\"+className+ \"'>\" +\n\t\t\tgantt.templates.drag_link(link.link_source_id, link.link_from_start, link.link_target_id, link.link_to_start) +\n\t\t\t\"</div>\";\n\t\tmarker.innerHTML = html;\n\t}\n\n\tfunction advanceMarker(marker, pos){\n\t\tmarker.style.left = pos.x + \"px\";\n\t\tmarker.style.top = pos.y + \"px\";\n\t}\n\n\tfunction resetDndState(){\n\t\t_link_source_task =\n\t\t\t_link_source_task_start =\n\t\t\t\t_link_target_task = null;\n\t\t_link_target_task_start = true;\n\t}\n\tfunction showDirectingLine(s_x, s_y, e_x, e_y){\n\t\tvar div = getDirectionLine();\n\n\t\tvar link = getDndState();\n\n\t\tvar css = [\"gantt_link_direction\"];\n\t\tif(gantt.templates.link_direction_class){\n\t\t\tcss.push(gantt.templates.link_direction_class(link.link_source_id, link.link_from_start, link.link_target_id, link.link_to_start));\n\t\t}\n\n\t\tvar dist =Math.sqrt( (Math.pow(e_x - s_x, 2)) + (Math.pow(e_y - s_y, 2)) );\n\t\tdist = Math.max(0, dist - 3);\n\t\tif(!dist)\n\t\t\treturn;\n\n\t\tdiv.className = css.join(\" \");\n\t\tvar tan = (e_y - s_y)/(e_x - s_x),\n\t\t\tangle = Math.atan(tan);\n\n\t\tif(coordinateCircleQuarter(s_x, e_x, s_y, e_y) == 2){\n\t\t\tangle += Math.PI;\n\t\t}else if(coordinateCircleQuarter(s_x, e_x, s_y, e_y) == 3){\n\t\t\tangle -= Math.PI;\n\t\t}\n\n\n\n\t\tvar sin = Math.sin(angle),\n\t\t\tcos = Math.cos(angle),\n\t\t\ttop = Math.round(s_y),\n\t\t\tleft = Math.round(s_x);\n\n\n\t\tvar style = [\n\t\t\t\"-webkit-transform: rotate(\"+angle+\"rad)\",\n\t\t\t\"-moz-transform: rotate(\"+angle+\"rad)\",\n\t\t\t\"-ms-transform: rotate(\"+angle+\"rad)\",\n\t\t\t\"-o-transform: rotate(\"+angle+\"rad)\",\n\t\t\t\"transform: rotate(\"+angle+\"rad)\",\n\t\t\t\"width:\" + Math.round(dist) + \"px\"\n\t\t];\n\n\t\tif(window.navigator.userAgent.indexOf(\"MSIE 8.0\") != -1){\n\t\t\t//ms-filter breaks styles in ie9, so add it only for 8th\n\t\t\tstyle.push(\"-ms-filter: \\\"\" + ieTransform(sin, cos) + \"\\\"\");\n\n\t\t\tvar shiftLeft = Math.abs(Math.round(s_x - e_x)),\n\t\t\t\tshiftTop = Math.abs(Math.round(e_y - s_y));\n\t\t\t//fix rotation axis\n\t\t\tswitch(coordinateCircleQuarter(s_x, e_x, s_y, e_y)){\n\t\t\t\tcase 1:\n\t\t\t\t\ttop -= shiftTop;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\t\tleft -= shiftLeft;\n\t\t\t\t\ttop -= shiftTop;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3:\n\t\t\t\t\tleft -= shiftLeft;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t}\n\n\t\tstyle.push(\"top:\" +  top + \"px\");\n\t\tstyle.push(\"left:\" +  left + \"px\");\n\n\t\tdiv.style.cssText = style.join(\";\");\n\t}\n\n\tfunction ieTransform(sin, cos){\n\t\treturn \"progid:DXImageTransform.Microsoft.Matrix(\"+\n\t\t\t\"M11 = \"+cos+\",\"+\n\t\t\t\"M12 = -\"+sin+\",\"+\n\t\t\t\"M21 = \"+sin+\",\"+\n\t\t\t\"M22 = \"+cos+\",\"+\n\t\t\t\"SizingMethod = 'auto expand'\"+\n\t\t\")\";\n\t}\n\tfunction coordinateCircleQuarter(sX, eX, sY, eY){\n\t\tif(eX >= sX){\n\t\t\tif(eY <= sY){\n\t\t\t\treturn 1;\n\t\t\t}else{\n\t\t\t\treturn 4;\n\t\t\t}\n\t\t}else{\n\t\t\tif(eY <= sY){\n\t\t\t\treturn 2;\n\t\t\t}else{\n\t\t\t\treturn 3;\n\t\t\t}\n\t\t}\n\n\t}\n\tfunction getDirectionLine(){\n\t\tif(!dnd._direction || !dnd._direction.parentNode){\n\t\t\tdnd._direction = document.createElement(\"div\");\n\t\t\ttimeline.$task_links.appendChild(dnd._direction);\n\t\t}\n\t\treturn dnd._direction;\n\t}\n\tfunction removeDirectionLine(){\n\t\tif(dnd._direction){\n\t\t\tif (dnd._direction.parentNode)\t//the event line can be detached because of data refresh\n\t\t\t\tdnd._direction.parentNode.removeChild(dnd._direction);\n\n\t\t\tdnd._direction = null;\n\t\t}\n\t}\n\tgantt.attachEvent(\"onGanttRender\", gantt.bind(function() {\n\t\tif(dnd._direction){\n\t\t\tshowDirectingLine(this._dir_start.x, this._dir_start.y, this._dir_end.x, this._dir_end.y);\n\t\t}\n\t}, this));\n};\n\nexport default {\n\tcreateLinkDND: function(){\n\t\treturn {\n\t\t\tinit: initLinksDND\n\t\t};\n\t}\n};","import * as utils from \"../../../utils/utils\";\nimport taskDnD from \"./tasks_dnd\";\nimport linkDnD from \"./links_dnd\";\nimport * as domHelpers from \"../utils/dom_helpers\";\nimport MouseDelegates from \"../mouse_event_container\";\n\nvar initializer = (function(){\n\treturn function(gantt){\n\t\tvar services = gantt.$services;\n\t\treturn {\n\t\t\tonCreated: function (timeline) {\n\t\t\t\tvar config = timeline.$config;\n\t\t\t\tconfig.bind = utils.defined(config.bind) ? config.bind : \"task\";\n\t\t\t\tconfig.bindLinks = utils.defined(config.bindLinks) ? config.bindLinks : \"link\";\n\n\t\t\t\ttimeline._linksDnD = linkDnD.createLinkDND();\n\t\t\t\ttimeline._tasksDnD = taskDnD.createTaskDND();\n\t\t\t\ttimeline._tasksDnD.extend(timeline);\n\n\t\t\t\tthis._mouseDelegates = MouseDelegates(gantt);\n\t\t\t},\n\t\t\tonInitialized: function (timeline) {\n\t\t\t\tthis._attachDomEvents(gantt);\n\n\t\t\t\tthis._attachStateProvider(gantt, timeline);\n\n\t\t\t\ttimeline._tasksDnD.init(timeline, gantt);\n\t\t\t\ttimeline._linksDnD.init(timeline, gantt);\n\n\t\t\t\tif(timeline.$config.id == \"timeline\"){\n\t\t\t\t\tthis.extendDom(timeline);\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tonDestroyed: function (timeline) {\n\t\t\t\tthis._clearDomEvents(gantt);\n\t\t\t\tthis._clearStateProvider(gantt);\n\t\t\t\tif (timeline._tasksDnD) {\n\t\t\t\t\ttimeline._tasksDnD.destructor();\n\t\t\t\t}\n\t\t\t},\n\t\t\textendDom: function(timeline){\n\t\t\t\tgantt.$task = timeline.$task;\n\t\t\t\tgantt.$task_scale = timeline.$task_scale;\n\t\t\t\tgantt.$task_data = timeline.$task_data;\n\t\t\t\tgantt.$task_bg = timeline.$task_bg;\n\t\t\t\tgantt.$task_links = timeline.$task_links;\n\t\t\t\tgantt.$task_bars = timeline.$task_bars;\n\t\t\t},\n\n\t\t\t_clearDomEvents: function(){\n\t\t\t\tthis._mouseDelegates.destructor();\n\t\t\t\tthis._mouseDelegates = null;\n\t\t\t},\n\n\t\t\t_attachDomEvents: function(gantt){\n\t\t\t\tfunction _delete_link_handler(id, e) {\n\t\t\t\t\tif (id && this.callEvent(\"onLinkDblClick\", [id, e])) {\n\n\t\t\t\t\t\tvar link = this.getLink(id);\n\t\t\t\t\t\tif (this.isReadonly(link)) return;\n\n\t\t\t\t\t\tvar title = \"\";\n\t\t\t\t\t\tvar question = this.locale.labels.link + \" \" + this.templates.link_description(this.getLink(id)) + \" \" + this.locale.labels.confirm_link_deleting;\n\n\t\t\t\t\t\twindow.setTimeout(function () {\n\t\t\t\t\t\t\tgantt._delete_link_confirm({\n\t\t\t\t\t\t\t\tlink: link,\n\t\t\t\t\t\t\t\tmessage: question,\n\t\t\t\t\t\t\t\ttitle: title,\n\t\t\t\t\t\t\t\tcallback: function () {\n\t\t\t\t\t\t\t\t\tgantt.deleteLink(id);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}, (this.config.touch ? 300 : 1));\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_task_link\", gantt.bind(function (e, trg) {\n\t\t\t\t\tvar id = this.locate(e, this.config.link_attribute);\n\t\t\t\t\tif (id) {\n\t\t\t\t\t\tthis.callEvent(\"onLinkClick\", [id, e]);\n\t\t\t\t\t}\n\t\t\t\t}, gantt), this.$task);\n\n\t\t\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_scale_cell\", gantt.bind(function (e, trg) {\n\t\t\t\t\tvar pos = domHelpers.getRelativeEventPosition(e, gantt.$task_data);\n\t\t\t\t\tvar date = gantt.dateFromPos(pos.x);\n\t\t\t\t\tvar coll = Math.floor(gantt.columnIndexByDate(date));\n\n\t\t\t\t\tvar coll_date = gantt.getScale().trace_x[coll];\n\n\t\t\t\t\tgantt.callEvent(\"onScaleClick\", [e, coll_date]);\n\t\t\t\t}, gantt), this.$task);\n\n\t\t\t\tthis._mouseDelegates.delegate(\"doubleclick\", \"gantt_task_link\", gantt.bind(function (e, id, trg) {\n\t\t\t\t\tvar id = this.locate(e, gantt.config.link_attribute);\n\t\t\t\t\t_delete_link_handler.call(this, id, e);\n\t\t\t\t}, gantt), this.$task);\n\n\t\t\t\tthis._mouseDelegates.delegate(\"doubleclick\", \"gantt_link_point\", gantt.bind(function (e, id, trg) {\n\t\t\t\t\tvar id = this.locate(e),\n\t\t\t\t\t\ttask = this.getTask(id);\n\n\t\t\t\t\tvar link = null;\n\t\t\t\t\tif (trg.parentNode && domHelpers.getClassName(trg.parentNode)) {\n\t\t\t\t\t\tif (domHelpers.getClassName(trg.parentNode).indexOf(\"_left\") > -1) {\n\t\t\t\t\t\t\tlink = task.$target[0];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tlink = task.$source[0];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (link)\n\t\t\t\t\t\t_delete_link_handler.call(this, link, e);\n\t\t\t\t\treturn false;\n\t\t\t\t}, gantt), this.$task);\n\t\t\t},\n\n\t\t\t_attachStateProvider: function(gantt, timeline){\n\t\t\t\tvar self = timeline;\n\t\t\t\tvar state = services.getService(\"state\");\n\t\t\t\tstate.registerProvider(\"tasksTimeline\", function(){\n\t\t\t\t\treturn {\n\t\t\t\t\t\tscale_unit: self._tasks ? self._tasks.unit : undefined,\n\t\t\t\t\t\tscale_step:  self._tasks ? self._tasks.step  : undefined\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t},\n\n\t\t\t_clearStateProvider: function(){\n\t\t\t\tvar state = services.getService(\"state\");\n\t\t\t\tstate.unregisterProvider(\"tasksTimeline\");\n\t\t\t}\n\t\t};\n\t};\n\n})();\n\nexport default initializer;","import * as domHelpers from \"./utils/dom_helpers\";\n\nvar initializer = (function() {\n\treturn function (gantt) {\n\t\treturn {\n\n\t\t\tgetVerticalScrollbar: function(){\n\t\t\t\treturn gantt.$ui.getView(\"scrollVer\");\n\t\t\t},\n\t\t\tgetHorizontalScrollbar: function(){\n\t\t\t\treturn gantt.$ui.getView(\"scrollHor\");\n\t\t\t},\n\n\t\t\t_legacyGridResizerClass: function(layout){\n\t\t\t\tvar resizers = layout.getCellsByType(\"resizer\");\n\t\t\t\tfor(var i = 0; i < resizers.length; i++){\n\t\t\t\t\tvar r = resizers[i];\n\t\t\t\t\tvar gridResizer = false;\n\n\t\t\t\t\tvar prev = r.$parent.getPrevSibling(r.$id);\n\t\t\t\t\tif(prev && prev.$config && prev.$config.id === \"grid\"){\n\t\t\t\t\t\tgridResizer= true;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tvar next = r.$parent.getNextSibling(r.$id);\n\t\t\t\t\t\tif(next && next.$config && next.$config.id === \"grid\"){\n\t\t\t\t\t\t\tgridResizer= true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif(gridResizer){\n\t\t\t\t\t\tr.$config.css = (r.$config.css ? r.$config.css + \" \" : \"\") + \"gantt_grid_resize_wrap\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tonCreated: function(layout) {\n\t\t\t\tvar first = true;\n\n\t\t\t\tthis._legacyGridResizerClass(layout);\n\n\t\t\t\tlayout.attachEvent(\"onBeforeResize\", function() {\n\t\t\t\t\tvar mainTimeline = gantt.$ui.getView(\"timeline\");\n\t\t\t\t\tif (mainTimeline)\n\t\t\t\t\t\tmainTimeline.$config.hidden = mainTimeline.$parent.$config.hidden = !gantt.config.show_chart;\n\n\t\t\t\t\tvar mainGrid = gantt.$ui.getView(\"grid\");\n\n\t\t\t\t\tif(!mainGrid)\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\tvar colsWidth = mainGrid._getColsTotalWidth();\n\t\t\t\t\tvar hideGrid = !gantt.config.show_grid || !gantt.config.grid_width || colsWidth === 0;\n\t\t\t\t\tif (first && !hideGrid && colsWidth !== false){\n\t\t\t\t\t\t\tgantt.config.grid_width = colsWidth;\n\t\t\t\t\t}\n\t\t\t\t\tmainGrid.$config.hidden = mainGrid.$parent.$config.hidden = hideGrid;\n\n\t\t\t\t\tif (!mainGrid.$config.hidden) {\n\t\t\t\t\t\t/* restrict grid width due to min_width, max_width, min_grid_column_width */\n\t\t\t\t\t\tvar grid_limits = mainGrid._getGridWidthLimits();\n\t\t\t\t\t\tif (grid_limits[0] && gantt.config.grid_width < grid_limits[0])\n\t\t\t\t\t\t\tgantt.config.grid_width = grid_limits[0];\n\t\t\t\t\t\tif (grid_limits[1] && gantt.config.grid_width > grid_limits[1])\n\t\t\t\t\t\t\tgantt.config.grid_width = grid_limits[1];\n\t\t\t\t\t\tif (mainTimeline && gantt.config.show_chart){\n\n\t\t\t\t\t\t\tmainGrid.$config.width = gantt.config.grid_width - 1;\n\n\t\t\t\t\t\t\t// GS-1314: Don't let the non-scrollable grid to be larger than the container with the correct width\n\t\t\t\t\t\t\tif (!mainGrid.$config.scrollable && mainGrid.$config.scrollY && gantt.$root.offsetWidth){\n\t\t\t\t\t\t\t\tvar ganttContainerWidth = mainGrid.$gantt.$layout.$container.offsetWidth;\n\t\t\t\t\t\t\t\tvar verticalScrollbar = gantt.$ui.getView(mainGrid.$config.scrollY);\n\t\t\t\t\t\t\t\tvar verticalScrollbarWidth = verticalScrollbar.$config.width;\n\n\t\t\t\t\t\t\t\t// GS-2488: to prevent grid from occupying the whole gantt container(timeline will be disabled) \n\t\t\t\t\t\t\t\t// need to leave min width for timeline\n\t\t\t\t\t\t\t\tvar gridOverflow = ganttContainerWidth - (mainGrid.$config.width + verticalScrollbarWidth) - 4;\n\t\t\t\t\t\t\t\tif (gridOverflow < 0){\n\t\t\t\t\t\t\t\t\tmainGrid.$config.width += gridOverflow;\n\t\t\t\t\t\t\t\t\tgantt.config.grid_width += gridOverflow;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (!first) {\n\t\t\t\t\t\t\t\tif (mainTimeline && !domHelpers.isChildOf(mainTimeline.$task, layout.$view)) {\n\t\t\t\t\t\t\t\t\t// timeline is being displayed after being not visible, reset grid with from full screen\n\t\t\t\t\t\t\t\t\tif (!mainGrid.$config.original_grid_width) {\n\t\t\t\t\t\t\t\t\t\tvar skinSettings = gantt.skins[gantt.skin];\n\t\t\t\t\t\t\t\t\t\tif(skinSettings && skinSettings.config && skinSettings.config.grid_width){\n\t\t\t\t\t\t\t\t\t\t\tmainGrid.$config.original_grid_width =  skinSettings.config.grid_width;\n\t\t\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\t\tmainGrid.$config.original_grid_width = 0;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tgantt.config.grid_width = mainGrid.$config.original_grid_width;\n\t\t\t\t\t\t\t\t\tmainGrid.$parent.$config.width = gantt.config.grid_width;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tmainGrid.$parent._setContentSize(mainGrid.$config.width, null);\n\t\t\t\t\t\t\t\t\tgantt.$layout._syncCellSizes(mainGrid.$parent.$config.group, {value: gantt.config.grid_width, isGravity: false});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tmainGrid.$parent.$config.width = gantt.config.grid_width;\n\t\t\t\t\t\t\t\tif (mainGrid.$parent.$config.group) {\n\t\t\t\t\t\t\t\t\tgantt.$layout._syncCellSizes(mainGrid.$parent.$config.group, {value: mainGrid.$parent.$config.width, isGravity: false});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (mainTimeline && domHelpers.isChildOf(mainTimeline.$task, layout.$view)) {\n\t\t\t\t\t\t\t\t// hiding timeline, remember grid with to restore it when timeline is displayed again\n\t\t\t\t\t\t\t\tmainGrid.$config.original_grid_width = gantt.config.grid_width;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!first) {\n\t\t\t\t\t\t\t\tmainGrid.$parent.$config.width = 0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tfirst = false;\n\t\t\t\t});\n\t\t\t\tthis._initScrollStateEvents(layout);\n\t\t\t},\n\n\t\t\t_initScrollStateEvents: function(layout) {\n\t\t\t\tgantt._getVerticalScrollbar = this.getVerticalScrollbar;\n\t\t\t\tgantt._getHorizontalScrollbar = this.getHorizontalScrollbar;\n\n\t\t\t\tvar vertical = this.getVerticalScrollbar();\n\t\t\t\tvar horizontal = this.getHorizontalScrollbar();\n\t\t\t\tif (vertical) {\n\t\t\t\t\tvertical.attachEvent(\"onScroll\", function(oldPos, newPos, dir){\n\t\t\t\t\t\tvar scrollState = gantt.getScrollState();\n\t\t\t\t\t\tgantt.callEvent(\"onGanttScroll\", [scrollState.x, oldPos, scrollState.x, newPos]);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (horizontal) {\n\t\t\t\t\thorizontal.attachEvent(\"onScroll\", function(oldPos, newPos, dir){\n\t\t\t\t\t\tvar scrollState = gantt.getScrollState();\n\t\t\t\t\t\tgantt.callEvent(\"onGanttScroll\", [oldPos, scrollState.y, newPos, scrollState.y]);\n\n\t\t\t\t\t\t// if the grid doesn't fit the width, scroll the row container\n\t\t\t\t\t\tvar grid = gantt.$ui.getView(\"grid\");\n\t\t\t\t\t\tif (grid && grid.$grid_data && !grid.$config.scrollable){\n\t\t\t\t\t\t\tgrid.$grid_data.style.left = grid.$grid.scrollLeft + \"px\";\n\t\t\t\t\t\t\tgrid.$grid_data.scrollLeft = grid.$grid.scrollLeft;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tlayout.attachEvent(\"onResize\", function(){\n\t\t\t\t\tif (vertical && !gantt.$scroll_ver){\n\t\t\t\t\t\tgantt.$scroll_ver = vertical.$scroll_ver;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (horizontal && !gantt.$scroll_hor){\n\t\t\t\t\t\tgantt.$scroll_hor = horizontal.$scroll_hor;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\t_findGridResizer: function(layout, grid){\n\t\t\t\tvar resizers = layout.getCellsByType(\"resizer\");\n\n\t\t\t\tvar gridFirst = true;\n\t\t\t\tvar gridResizer;\n\t\t\t\tfor(var i = 0; i < resizers.length; i++){\n\t\t\t\t\tvar res = resizers[i];\n\t\t\t\t\tres._getSiblings();\n\t\t\t\t\tvar prev = res._behind;\n\t\t\t\t\tvar next = res._front;\n\t\t\t\t\tif(prev && prev.$content === grid || (prev.isChild && prev.isChild(grid))){\n\t\t\t\t\t\tgridResizer = res;\n\t\t\t\t\t\tgridFirst = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}else if(next && next.$content === grid || (next.isChild && next.isChild(grid))){\n\t\t\t\t\t\tgridResizer = res;\n\t\t\t\t\t\tgridFirst = false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tresizer: gridResizer,\n\t\t\t\t\tgridFirst: gridFirst\n\t\t\t\t};\n\t\t\t},\n\n\t\t\tonInitialized: function (layout) {\n\t\t\t\tvar grid = gantt.$ui.getView(\"grid\");\n\n\t\t\t\tvar resizeInfo = this._findGridResizer(layout, grid);\n\n\t\t\t\t// expose grid resize events\n\t\t\t\tif(resizeInfo.resizer){\n\t\t\t\t\tvar gridFirst = resizeInfo.gridFirst,\n\t\t\t\t\t\tnext = resizeInfo.resizer;\n\t\t\t\t\t\t\n\t\t\t\t\tif(next.$config.mode !== \"x\"){\n\t\t\t\t\t\treturn;// track only horizontal resize\n\t\t\t\t\t}\n\n\t\t\t\t\tvar initialWidth;\n\t\t\t\t\tnext.attachEvent(\"onResizeStart\", function(prevCellWidth, nextCellWidth){\n\n\t\t\t\t\t\tvar grid = gantt.$ui.getView(\"grid\");\n\t\t\t\t\t\tvar viewCell = grid ? grid.$parent : null;\n\t\t\t\t\t\tif(viewCell){\n\t\t\t\t\t\t\tvar limits = grid._getGridWidthLimits();\n\n\t\t\t\t\t\t\t// min grid width is defined by min widths of its columns, unless grid has horizontal scroll\n\t\t\t\t\t\t\tif(!grid.$config.scrollable)\n\t\t\t\t\t\t\t\tviewCell.$config.minWidth = limits[0];\n\n\t\t\t\t\t\t\tviewCell.$config.maxWidth = limits[1];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tinitialWidth = gridFirst ? prevCellWidth : nextCellWidth;\n\t\t\t\t\t\treturn gantt.callEvent(\"onGridResizeStart\", [initialWidth]);\n\t\t\t\t\t});\n\t\t\t\t\tnext.attachEvent(\"onResize\", function(newBehindSize, newFrontSize){\n\t\t\t\t\t\tvar newSize = gridFirst ? newBehindSize : newFrontSize;\n\t\t\t\t\t\treturn gantt.callEvent(\"onGridResize\", [initialWidth, newSize]);\n\t\t\t\t\t});\n\t\t\t\t\tnext.attachEvent(\"onResizeEnd\", function(oldBackSize, oldFrontSize, newBackSize, newFrontSize){\n\n\t\t\t\t\t\tvar oldSize = gridFirst ? oldBackSize : oldFrontSize;\n\t\t\t\t\t\tvar newSize = gridFirst ? newBackSize : newFrontSize;\n\t\t\t\t\t\tvar grid = gantt.$ui.getView(\"grid\");\n\t\t\t\t\t\tvar viewCell = grid ? grid.$parent : null;\n\t\t\t\t\t\tif(viewCell){\n\t\t\t\t\t\t\tviewCell.$config.minWidth = undefined;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar res = gantt.callEvent(\"onGridResizeEnd\", [oldSize, newSize]);\n\t\t\t\t\t\tif(res && newSize !== 0){// new size may be numeric zero when cell size is defined by 'gravity', actual size will be calculated by layout later\n\t\t\t\t\t\t\tgantt.config.grid_width = newSize;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn res;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tonDestroyed: function (timeline) {\n\n\t\t\t}\n\t\t};\n\n\t};\n})();\n\nexport default initializer;","import uiFactory from \"./ui_factory\";\nimport mouseEvents from \"./mouse\";\nimport createLayers from \"./gantt_layers\";\nimport Cell from \"./layout/cell\";\nimport Layout from \"./layout/layout\";\nimport ViewLayout from \"./layout/view_layout\";\nimport ViewCell from \"./layout/view_cell\";\nimport Resizer from \"./layout/resizer_cell\";\nimport Scrollbar from \"./layout/scrollbar_cell\";\nimport Timeline from \"./timeline/timeline\";\nimport Grid from \"./grid/grid\";\nimport ResourceGrid from \"./grid/resource_grid\";\nimport ResourceGridLightbox from \"./grid/resource_grid_lightbox\";\nimport ResourceTimeline from \"./timeline/resource_timeline\";\nimport ResourceHistogram from \"./timeline/resource_histogram\";\n\n\nimport gridEditorsFactory from \"./grid/editors/controller\";\n\nimport renderTaskBar from \"./render/task_bar_smart_render\";\nimport renderTimedProjectBar from \"./render/task_project_smart_render\";\nimport renderSplitTaskBar from \"./render/task_split_render\";\nimport renderRollupTaskBar from \"./render/task_rollup_render\";\nimport renderTaskBg from \"./render/task_bg_render\";\nimport renderLink from \"./render/link_render\";\nimport gridRenderer from \"./render/task_grid_line_render\";\nimport resourceMatrixRenderer from \"./render/resource_matrix_render\";\nimport resourceHistogramRenderer from \"./render/resource_histogram_render\";\nimport gridTaskRowResizerRenderer from \"./render/task_grid_row_resize_render\";\nimport renderConstraints from \"./render/task_constraints_render\";\nimport renderDeadline from \"./render/task_deadline_render\";\nimport renderBaselines from \"./render/task_baselines_render\";\nimport mainGridInitializer from \"./grid/main_grid_initializer\";\nimport mainTimelineInitializer from \"./timeline/main_timeline_initializer\";\nimport mainLayoutInitializer from \"./main_layout_initializer\";\n\nfunction initUI(gantt){\n\tfunction attachInitializer(view, initializer){\n\t\tvar ext = initializer(gantt);\n\t\tif(ext.onCreated)\n\t\t\text.onCreated(view);\n\t\tview.attachEvent(\"onReady\", function(){\n\t\t\tif(ext.onInitialized)\n\t\t\t\text.onInitialized(view);\n\t\t});\n\t\tview.attachEvent(\"onDestroy\", function(){\n\t\t\tif(ext.onDestroyed)\n\t\t\t\text.onDestroyed(view);\n\t\t});\n\t}\n\n\tvar factory = uiFactory.createFactory(gantt);\n\tfactory.registerView(\"cell\", Cell);\n\tfactory.registerView(\"resizer\", Resizer);\n\tfactory.registerView(\"scrollbar\", Scrollbar);\n\tfactory.registerView(\"layout\", Layout, function(view){\n\t\tvar id = view.$config ? view.$config.id : null;\n\t\tif(id === \"main\"){\n\t\t\tattachInitializer(view, mainLayoutInitializer);\n\t\t}\n\t});\n\tfactory.registerView(\"viewcell\", ViewCell);\n\tfactory.registerView(\"multiview\", ViewLayout);\n\tfactory.registerView(\"timeline\", Timeline, function(view){\n\t\tvar id = view.$config ? view.$config.id : null;\n\t\tif(id === \"timeline\" || view.$config.bind == \"task\"){\n\t\t\tattachInitializer(view, mainTimelineInitializer);\n\t\t}\n\t});\n\tfactory.registerView(\"grid\", Grid, function(view){\n\t\tvar id = view.$config ? view.$config.id : null;\n\t\tif(id === \"grid\" || view.$config.bind == \"task\"){\n\t\t\tattachInitializer(view, mainGridInitializer);\n\t\t}\n\t});\n\n\tfactory.registerView(\"resourceGrid\", ResourceGrid);\n\tfactory.registerView(\"GridRL\", ResourceGridLightbox);\n\tfactory.registerView(\"resourceTimeline\", ResourceTimeline);\n\tfactory.registerView(\"resourceHistogram\", ResourceHistogram);\n\n\tvar layersEngine = createLayers(gantt);\n\n\tvar inlineEditors = gridEditorsFactory(gantt);\n\n\tgantt.ext.inlineEditors = inlineEditors;\n\tgantt.ext._inlineEditors = inlineEditors;\n\tinlineEditors.init(gantt);\n\n\treturn {\n\t\tfactory:factory,\n\t\tmouseEvents: mouseEvents.init(gantt),\n\t\tlayersApi: layersEngine.init(),\n\t\trender:{\n\t\t\tgridLine: function(){\n\t\t\t\treturn gridRenderer(gantt);\n\t\t\t},\n\t\t\ttaskBg: function(){\n\t\t\t\treturn renderTaskBg(gantt);\n\t\t\t},\n\t\t\ttaskBar: function(){\n\t\t\t\treturn renderTaskBar(gantt);\n\t\t\t},\n\t\t\ttimedProjectBar: function(){\n\t\t\t\treturn renderTimedProjectBar(gantt);\n\t\t\t},\n\t\t\ttaskRollupBar: function() {\n\t\t\t\treturn renderRollupTaskBar(gantt);\n\t\t\t},\n\t\t\ttaskSplitBar: function(){\n\t\t\t\treturn renderSplitTaskBar(gantt);\n\t\t\t},\n\t\t\ttaskConstraints: function(){\n\t\t\t\treturn renderConstraints(gantt);\n\t\t\t},\n\t\t\ttaskDeadline: function(){\n\t\t\t\treturn renderDeadline(gantt);\n\t\t\t},\n\t\t\ttaskBaselines: function(){\n\t\t\t\treturn renderBaselines(gantt);\n\t\t\t},\n\t\t\tlink: function(){\n\t\t\t\treturn renderLink(gantt);\n\t\t\t},\n\t\t\tresourceRow: function(){\n\t\t\t\treturn resourceMatrixRenderer(gantt);\n\t\t\t},\n\t\t\tresourceHistogram: function(){\n\t\t\t\treturn resourceHistogramRenderer(gantt);\n\t\t\t},\n\t\t\tgridTaskRowResizer: function(){\n\t\t\t\treturn gridTaskRowResizerRenderer(gantt);\n\t\t\t}\n\t\t},\n\t\tlayersService: {\n\t\t\tgetDataRender: function(name){\n\t\t\t\treturn layersEngine.getDataRender(name, gantt);\n\t\t\t},\n\t\t\tcreateDataRender: function(config){\n\t\t\t\treturn layersEngine.createDataRender(config, gantt);\n\t\t\t}\n\t\t}\n\t};\n}\n\nexport default {\n\tinit: initUI\n};","import * as helpers from \"../../../utils/helpers\";\nimport getRowRectangle from \"./viewport/get_grid_row_rectangle\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport isInViewPort from \"./viewport/is_grid_row_in_viewport\";\n\nfunction createGridLineRender(gantt){\n\n\tfunction _render_grid_item(item, view, config, viewport) {\n\t\tvar columns = view.getGridColumns();\n\t\tvar templates = view.$getTemplates();\n\n\t\tvar store = view.$config.rowStore;\n\n\t\tvar cells = [];\n\t\tvar has_child;\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tvar last = i == columns.length - 1;\n\t\t\tvar col = columns[i];\n\t\t\tvar cell;\n\n\t\t\tvar value;\n\t\t\tvar textValue;\n\t\t\tif (col.name == \"add\") {\n\t\t\t\tvar aria = gantt._waiAria.gridAddButtonAttrString(col);\n\n\t\t\t\tvalue = \"<div \" + aria + \" class='gantt_add'></div>\";\n\t\t\t\ttextValue = \"\";\n\t\t\t} else {\n\t\t\t\tif (col.template)\n\t\t\t\t\tvalue = col.template(item);\n\t\t\t\telse\n\t\t\t\t\tvalue = item[col.name];\n\n\t\t\t\tif (helpers.isDate(value)){\n\t\t\t\t\tvalue = templates.date_grid(value, item, col.name);\n\t\t\t\t}\n\n\t\t\t\tif (value === null || value === undefined) {\n\t\t\t\t\tvalue = \"\";\n\t\t\t\t}\n\n\t\t\t\ttextValue = value;\n\t\t\t\tvalue = \"<div class='gantt_tree_content'>\" + value + \"</div>\";\n\t\t\t}\n\t\t\tvar css = \"gantt_cell\" + (last ? \" gantt_last_cell\" : \"\");\n\n\t\t\tvar tree = [];\n\t\t\tif (col.tree) {\n\t\t\t\tcss += \" gantt_cell_tree\";\n\t\t\t\tfor (var j = 0; j < item.$level; j++)\n\t\t\t\t\ttree.push(templates.grid_indent(item));\n\n\t\t\t\thas_child = store.hasChild(item.id) && !(gantt.isSplitTask(item) && !gantt.config.open_split_tasks);\n\t\t\t\tif (has_child) {\n\t\t\t\t\ttree.push(templates.grid_open(item));\n\t\t\t\t\ttree.push(templates.grid_folder(item));\n\t\t\t\t} else {\n\t\t\t\t\ttree.push(templates.grid_blank(item));\n\t\t\t\t\ttree.push(templates.grid_file(item));\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar style = \"width:\" + (col.width - (last ? 1 : 0)) + \"px;\";\n\t\t\tif (this.defined(col.align)){\n\t\t\t\tvar flexAlign = {\n\t\t\t\t\tright: \"flex-end\",\n\t\t\t\t\tleft: \"flex-start\",\n\t\t\t\t\tcenter: \"center\"\n\t\t\t\t};\n\t\t\t\tvar justifyContent = flexAlign[col.align];\n\n\t\t\t\tstyle += \"text-align:\" + col.align + \";justify-content:\"  + justifyContent + \";\";\n\t\t\t}\n\n\t\t\tvar aria = gantt._waiAria.gridCellAttrString(col, textValue, item);\n\n\t\t\ttree.push(value);\n\t\t\tcell = \"<div class='\" + css + \"' data-column-index='\"+i+\"' data-column-name='\"+col.name+\"' style='\" + style + \"' \" + aria + \">\" + tree.join(\"\") + \"</div>\";\n\t\t\tcells.push(cell);\n\t\t}\n\t\t// GS-291. The odd class should be assigned correctly\n\t\tcss = \"\";\n\t\tconst storeName = store.$config.name;\n\t\tswitch (storeName) {\n\t\t\tcase \"task\":\n\t\t\t\tcss = gantt.getGlobalTaskIndex(item.id) % 2 === 0 ? \"\" : \" odd\";\n\t\t\t\tbreak;\n\t\t\tcase \"resource\":\n\t\t\t\tcss = store.visibleOrder.indexOf(item.id) % 2 === 0 ? \"\" : \" odd\";\n\t\t\t\tbreak;\n\t\t}\n\n\t\tcss += (item.$transparent) ? \" gantt_transparent\" : \"\";\n\n\t\tcss += (item.$dataprocessor_class ? \" \" + item.$dataprocessor_class : \"\");\n\n\t\tif (templates.grid_row_class) {\n\t\t\tvar css_template = templates.grid_row_class.call(gantt, item.start_date, item.end_date, item);\n\t\t\tif (css_template)\n\t\t\t\tcss += \" \" + css_template;\n\t\t}\n\n\t\tif(store.isSelected(item.id)) {\n\t\t\tcss += \" gantt_selected\";\n\t\t}\n\n\t\tvar el = document.createElement(\"div\");\n\t\tel.className = \"gantt_row\" + css + \" gantt_row_\" + gantt.getTaskType(item.type);\n\t\tvar height = view.getItemHeight(item.id);\n\t\tel.style.height = height + \"px\";\n\t\tel.style.lineHeight = height + \"px\";\n\n\t\tif(config.smart_rendering){\n\t\t\tel.style.position = \"absolute\";\n\t\t\tel.style.left = \"0px\";\n\t\t\tel.style.top = view.getItemTop(item.id) + \"px\";\n\t\t}\n\n\t\tif(view.$config.item_attribute){\n\t\t\tel.setAttribute(view.$config.item_attribute, item.id);\n\t\t\tel.setAttribute(view.$config.bind + \"_id\", item.id); // 'task_id'/'resource_id' for backward compatibility\n\t\t}\n\n\t\tgantt._waiAria.taskRowAttr(item, el);\n\n\t\tel.innerHTML = cells.join(\"\");\n\t\treturn el;\n\t}\n\n\tfunction onrender(item, rowNode, view){\n\t\tvar columns = view.getGridColumns();\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tvar column = columns[i];\n\t\t\tif (column.onrender){\n\n\t\t\t\t// find cell node for current column\n\t\t\t\tvar cellNode = rowNode.querySelector(`[data-column-name=\"${column.name}\"]`);\n\t\t\t\tif (cellNode) {\n\t\t\t\t\tvar content = column.onrender(item, cellNode);\n\t\t\t\t\tif (content && typeof content === \"string\") {\n\t\t\t\t\t\tcellNode.innerHTML = content;\n\t\t\t\t\t} else if (content && typeof content === \"object\") {\n\t\t\t\t\t\t// render object to node using additional functionality\n\t\t\t\t\t\tif (gantt.config.external_render){\n\t\t\t\t\t\t\tvar adapter = gantt.config.external_render;\n\t\t\t\t\t\t\tif (adapter.isElement(content)){\n\t\t\t\t\t\t\t\tadapter.renderElement(content, cellNode);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn {\n\t\trender: _render_grid_item,\n\t\tupdate: null,\n\t\tgetRectangle: getRowRectangle,\n\t\tisInViewPort: isInViewPort,\n\t\tgetVisibleRange: getVisibleRange,\n\t\tonrender: onrender\n\t};\n}\n\nexport default createGridLineRender;","import getRowRectangle from \"./viewport/get_bg_row_rectangle\";\nimport isLegacyRender from \"./is_legacy_smart_render\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport getVisibleCellsRange from \"./viewport/get_visible_cells_range\";\nimport isColumnVisible from \"./viewport/is_column_visible\";\nimport bgPlaceholder from \"./prerender/task_bg_placeholder\";\n\nfunction createTaskBgRender(gantt){\n\tvar renderedCells = {};\n\tvar visibleCells = {};\n\n\tfunction isRendered(item, columnIndex){\n\t\tif(renderedCells[item.id][columnIndex] && renderedCells[item.id][columnIndex].parentNode){\n\t\t\treturn true;\n\t\t}else{\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tfunction detachRenderedCell(itemId, columnIndex){\n\t\tif(renderedCells[itemId] && renderedCells[itemId][columnIndex] &&\n\t\t\trenderedCells[itemId][columnIndex].parentNode\n\t\t\t){\n\t\t\t\trenderedCells[itemId][columnIndex].parentNode.removeChild(renderedCells[itemId][columnIndex]);\n\t\t\t}\n\t}\n\n\tfunction getCellClassTemplate(view){\n\t\tvar templates = view.$getTemplates();\n\t\tvar cssTemplate;\n\t\tif (typeof templates.task_cell_class !== \"undefined\") {\n\t\t\tcssTemplate = templates.task_cell_class;\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tvar log = console.warn || console.log;\n\t\t\tlog('gantt.templates.task_cell_class template is deprecated and will be removed soon. Please use gantt.templates.timeline_cell_class instead.');\n\t\t} else {\n\t\t\tcssTemplate = templates.timeline_cell_class;\n\t\t}\n\t\treturn cssTemplate;\n\t}\n\tfunction getCellContentTemplate(view){\n\t\tvar templates = view.$getTemplates();\n\t\tvar contentTemplate = templates.timeline_cell_content;\n\t\treturn contentTemplate;\n\t}\n\n\tfunction renderCells(item, node, view, config, viewPort){\n\t\tvar cfg = view.getScale();\n\t\tvar count = cfg.count;\n\t\tvar cssTemplate = getCellClassTemplate(view);\n\t\tvar contentTemplate = getCellContentTemplate(view);\n\n\t\tif (config.show_task_cells) {\n\t\t\tif(!renderedCells[item.id]){\n\t\t\t\trenderedCells[item.id] = {};\n\t\t\t}\n\t\t\tif(!visibleCells[item.id]){\n\t\t\t\tvisibleCells[item.id] = {};\n\t\t\t}\n\n\t\t\tvar range = getVisibleCellsRange(cfg, viewPort);\n\n\t\t\tfor(var i in visibleCells[item.id]){\n\t\t\t\tvar index = visibleCells[item.id][i];\n\n\t\t\t\tif(Number(index) < range.start || Number(index) > range.end){\n\t\t\t\t\tdetachRenderedCell(item.id, index);\n\t\t\t\t}\n\t\t\t}\n\t\t\tvisibleCells[item.id] = {};\n\t\t\t// TODO: do not iterate all cell, only ones in the viewport and once that are already rendered\n\t\t\tfor (var columnIndex = range.start; columnIndex <= range.end; columnIndex++) {\n\t\t\t\tvar cell = renderOneCell(cfg, columnIndex, item, viewPort, count, cssTemplate, contentTemplate, config);\n\t\t\t\tif(!cell && isRendered(item, columnIndex)){\n\t\t\t\t\tdetachRenderedCell(item.id, columnIndex);\n\t\t\t\t}else if (cell && !cell.parentNode){\n\t\t\t\t\tnode.appendChild(cell);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction renderOneCell(scale, columnIndex, item, viewPort, count, cssTemplate, contentTemplate, config){\n\t\tvar width = scale.width[columnIndex],\n\t\t\tcssclass = \"\";\n\n\t\tif (isColumnVisible(columnIndex, scale, viewPort, gantt)) {//do not render skipped columns\n\n\t\t\tvar cssTemplateContent = cssTemplate(item, scale.trace_x[columnIndex]);\n\t\t\tvar htmlTemplateContent = \"\";\n\t\t\tif (contentTemplate) {// for backward compatibility, contentTemplate was added in 7.2.0+, will be undefined if someone used copy of old config/template object\n\t\t\t\thtmlTemplateContent = contentTemplate(item, scale.trace_x[columnIndex]);\n\t\t\t}\n\n\t\t\tif(config.static_background){\n\t\t\t\t// if cell render in static background is not allowed, or if it's a blank cell\n\t\t\t\tvar customCell = !!(cssTemplateContent || htmlTemplateContent);\n\t\t\t\tif(!(config.static_background_cells && customCell)){\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(renderedCells[item.id][columnIndex]){\n\t\t\t\tvisibleCells[item.id][columnIndex] = columnIndex;\n\t\t\t\treturn renderedCells[item.id][columnIndex];\n\t\t\t}\n\t\t\tvar cell = document.createElement(\"div\");\n\t\t\tcell.style.width = (width) + \"px\";\n\n\t\t\tcssclass = \"gantt_task_cell\" + (columnIndex == count - 1 ? \" gantt_last_cell\" : \"\");\n\t\t\tif (cssTemplateContent) {\n\t\t\t\tcssclass += \" \" + cssTemplateContent;\n\t\t\t}\n\t\t\tcell.className = cssclass;\n\n\t\t\tif (htmlTemplateContent) {\n\t\t\t\tcell.innerHTML = htmlTemplateContent;\n\t\t\t}\n\n\t\t\tcell.style.position = \"absolute\";\n\t\t\tcell.style.left = scale.left[columnIndex] + \"px\";\n\t\t\trenderedCells[item.id][columnIndex] = cell;\n\t\t\tvisibleCells[item.id][columnIndex] = columnIndex;\n\n\t\t\treturn cell;\n\t\t}\n\t\treturn null;\n\t}\n\n\tfunction _render_bg_line(item, view, config, viewPort) {\n\t\tvar templates = view.$getTemplates();\n\t\tvar cfg = view.getScale();\n\t\tvar count = cfg.count;\n\n\t\tif(config.static_background && !config.static_background_cells){\n\t\t\treturn null;\n\t\t}\n\n\t\tvar row = document.createElement(\"div\");\n\n\t\tvar cellCssTemplate = getCellClassTemplate(view);\n\t\tvar cellHtmlTemplate = getCellContentTemplate(view);\n\n\t\tvar range;\n\n\t\tif(!viewPort || !config.smart_rendering || isLegacyRender(gantt)){\n\t\t\trange = {\n\t\t\t\tstart: 0,\n\t\t\t\tend: count - 1\n\t\t\t};\n\t\t} else {\n\t\t\trange = getVisibleCellsRange(cfg, viewPort.x);\n\t\t}\n\t\tif (config.show_task_cells) {\n\t\t\trenderedCells[item.id] = {};\n\t\t\tvisibleCells[item.id] = {};\n\t\t\tfor (var columnIndex = range.start; columnIndex <= range.end; columnIndex++) {\n\t\t\t\tvar cell = renderOneCell(cfg, columnIndex, item, viewPort, count, cellCssTemplate, cellHtmlTemplate, config);\n\t\t\t\tif(cell){\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// GS-291. The odd class should be assigned correctly\n\t\tconst store = view.$config.rowStore;\n\t\tconst odd = store.getIndexById(item.id) % 2 !== 0;\n\n\t\tvar cssTemplate = templates.task_row_class(item.start_date, item.end_date, item);\n\t\tvar css = \"gantt_task_row\" + (odd ? \" odd\" : \"\") + (cssTemplate ? ' ' + cssTemplate : '');\n\n\t\tif(store.isSelected(item.id)) {\n\t\t\tcss += \" gantt_selected\";\n\t\t}\n\n\t\trow.className = css;\n\n\t\tif (config.smart_rendering) {\n\t\t\trow.style.position = \"absolute\";\n\t\t\trow.style.top = view.getItemTop(item.id) + \"px\";\n\t\t\trow.style.width = \"100%\";\n\t\t}else{\n\t\t\trow.style.position = \"relative\";\n\t\t}\n\t\trow.style.height = (view.getItemHeight(item.id)) + \"px\";\n\n\t\tif (item.id == \"timeline_placeholder_task\"){\n\t\t\tvar placeholderTop = 0;\n\t\t\tif (item.lastTaskId){\n\t\t\t\tvar lastTaskTop = view.getItemTop(item.lastTaskId);\n\t\t\t\tvar lastTaskHeight = view.getItemHeight(item.lastTaskId);\n\t\t\t\tplaceholderTop = lastTaskTop + lastTaskHeight;\t\n\t\t\t}\n\n\t\t\tvar maxHeight = item.row_height || view.$task_data.offsetHeight;\n\n\t\t\tvar placeholderHeight = maxHeight - placeholderTop;\n\t\t\t// So that it won't exceed the placeholder timeline height\n\t\t\tif (placeholderHeight < 0){\n\t\t\t\tplaceholderHeight = 0;\n\t\t\t}\n\n\t\t\tif (config.smart_rendering) {\n\t\t\t\trow.style.top = placeholderTop + \"px\";\t\n\t\t\t}\n\t\t\trow.style.height = placeholderHeight + \"px\";\n\t\t}\n\n\n\t\tif(view.$config.item_attribute){\n\t\t\trow.setAttribute(view.$config.item_attribute, item.id);\n\t\t\trow.setAttribute(view.$config.bind + \"_id\", item.id); // 'task_id'/'resource_id' for backward compatibility\n\t\t}\n\n\t\treturn row;\n\t}\n\n\treturn {\n\t\trender: _render_bg_line,\n\t\tupdate: renderCells,\n\t\tgetRectangle: getRowRectangle,\n\t\tgetVisibleRange: getVisibleRange,\n\t\tprepareData: bgPlaceholder\n\t};\n}\n\nexport default createTaskBgRender;\n","import isInViewPort from \"./viewport/is_bar_in_viewport\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport createBaseBarRender from \"./task_bar_render\";\n\nexport default function createTaskRenderer(gantt){\n\tvar defaultRender = createBaseBarRender(gantt);\n\treturn {\n\t\trender: defaultRender,\n\t\tupdate: null,\n\t\t//getRectangle: getBarRectangle\n\t\tisInViewPort: isInViewPort,\n\t\tgetVisibleRange: getVisibleRange\n\t};\n};","import isInViewPort from \"./viewport/is_project_bar_in_viewport\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport createBaseBarRender from \"./task_project_render\";\n\nexport default function createTaskRenderer(gantt){\n\tvar defaultRender = createBaseBarRender(gantt);\n\treturn {\n\t\trender: defaultRender,\n\t\tupdate: null,\n\t\t//getRectangle: getBarRectangle\n\t\tisInViewPort: isInViewPort,\n\t\tgetVisibleRange: getVisibleRange\n\t};\n};","import createBaseBarRender from \"./task_bar_render\";\nimport isInViewPort from \"./viewport/is_bar_in_viewport\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\n\nfunction createTaskRenderer(gantt){\n\tconst defaultRender = createBaseBarRender(gantt);\n\n\tconst renderedNodes = {};\n\n\tfunction checkVisibility(child, viewPort, timeline, config, gantt){\n\t\tlet isVisible = true;\n\t\t// GS-2123. Don't render rollup tasks that are outside the viewport\n\t\tif (config.smart_rendering){\n\t\t\tisVisible = isInViewPort(child, viewPort, timeline, config, gantt);\n\t\t}\n\t\treturn isVisible;\n\t}\n\n\tfunction generateChildElement(task, child, timeline, sizes){\n\t\tconst childCopy = gantt.copy(gantt.getTask(child.id));\n\t\tchildCopy.$rendered_at = task.id;\n\t\t// a way to filter rollup tasks:\n\t\tconst displayRollup = gantt.callEvent(\"onBeforeRollupTaskDisplay\", [childCopy.id, childCopy, task.id]);\n\t\tif (displayRollup === false){\n\t\t\treturn;\n\t\t}\n\n\t\tconst element = defaultRender(childCopy, timeline);\n\t\tif(!element){\n\t\t\treturn;\n\t\t}\n\n\t\tconst height = timeline.getBarHeight(task.id, child.type == gantt.config.types.milestone);\n\t\tconst padding = Math.floor((timeline.getItemHeight(task.id) - height) / 2);\n\n\t\telement.style.top = (sizes.top + padding) + \"px\";\n\t\telement.classList.add(\"gantt_rollup_child\");\n\t\telement.setAttribute(\"data-rollup-parent-id\", task.id);\n\n\t\treturn element;\n\t}\n\n\tfunction getKey(childId, renderParentId){\n\t\treturn childId + \"_\" + renderParentId;\n\t}\n\n\n\tfunction renderRollupTask(task, timeline, config, viewPort) {\n\t\tif (task.rollup !== false && task.$rollup && task.$rollup.length) {\n\t\t\tconst el = document.createElement('div'),\n\t\t\t\tsizes = gantt.getTaskPosition(task);\n\n\t\t\t// vertical position is not important for the rollup tasks as long as the parent is rendered\n\t\t\tif (viewPort){\n\t\t\t\tviewPort.y = 0;\n\t\t\t\tviewPort.y_end = gantt.$task_bg.scrollHeight;\n\t\t\t}\n\n\t\t\ttask.$rollup.forEach(function(itemId){\n\t\t\t\tif (!gantt.isTaskExists(itemId)){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst child = gantt.getTask(itemId);\n\t\t\t\tlet isVisible = checkVisibility(child, viewPort, timeline, config, gantt);\n\t\t\t\tif (!isVisible){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst element = generateChildElement(task, child, timeline, sizes);\n\t\t\t\tif (element) {\n\t\t\t\t\trenderedNodes[getKey(child.id, task.id)] = element;\n\t\t\t\t\tel.appendChild(element);\n\t\t\t\t} else{\n\t\t\t\t\trenderedNodes[getKey(child.id, task.id)] = false;\n\t\t\t\t}\n\n\t\t\t});\n\n\t\t\treturn el;\n\t\t}\n\t\treturn false;\n\t}\n\n\tfunction repaintRollupTask(task, itemNode, timeline, config, viewPort) {\n\t\tconst el = document.createElement(\"div\"),\n\t\tsizes = gantt.getTaskPosition(task);\n\n\t\t// vertical position is not important for the rollup tasks as long as the parent is rendered\n\t\tviewPort.y = 0;\n\t\tviewPort.y_end = gantt.$task_bg.scrollHeight;\n\n\t\ttask.$rollup.forEach(function(itemId){\n\t\t\tconst child = gantt.getTask(itemId);\n\t\t\tconst rollupKey = getKey(child.id, task.id);\n\t\t\tlet isVisible = checkVisibility(child, viewPort, timeline, config, gantt);\n\t\t\tif (isVisible !== !!renderedNodes[rollupKey]) {\n\n\t\t\t\tif (isVisible) {\n\t\t\t\t\tconst element = generateChildElement(task, child, timeline, sizes);\n\t\t\t\t\trenderedNodes[rollupKey] = element || false;\n\t\t\t\t} else {\n\t\t\t\t\trenderedNodes[rollupKey] = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!!renderedNodes[rollupKey]) {\n\t\t\t\tel.appendChild(renderedNodes[rollupKey]);\n\t\t\t}\n\t\t\titemNode.innerHTML = \"\";\n\t\t\titemNode.appendChild(el);\n\t\t});\n\t}\n\n\n\n\treturn {\n\t\trender: renderRollupTask,\n\t\tupdate: repaintRollupTask,\n\t\t//getRectangle: getBarRectangle\n\t\tisInViewPort: isInViewPort,\n\t\tgetVisibleRange: getVisibleRange\n\t};\n}\n\nexport default createTaskRenderer;","\nimport createBaseBarRender from \"./task_bar_render\";\n//import isInViewPort from \"./viewport/is_split_task_in_viewport\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\n\nimport isInViewPortParent from \"./viewport/is_split_task_in_viewport\";\nimport isInViewPortChild from \"./viewport/is_bar_in_viewport\";\nimport { childrenHaveBaselines, getMilestoneHeight, getInvertedMilestoneHeight } from \"./baseline_helper\";\nimport SplitTasksHelper from \"../../common/split_task_helpers\";\n\n\nfunction createTaskRenderer(gantt){\n\tconst defaultRender = createBaseBarRender(gantt);\n\tconst splitTasksHelper = new SplitTasksHelper(gantt.$data.tasksStore);\n\n\tconst renderedNodes = {};\n\n\tfunction checkVisibility(child, viewPort, timeline, config, gantt){\n\t\tlet isVisible = !child.hide_bar;\n\t\t// GS-1195. Don't render split tasks that are outside the viewport\n\t\tif (config.smart_rendering && isVisible){\n\t\t\tisVisible = isInViewPortChild(child, viewPort, timeline, config, gantt);\n\t\t}\n\t\treturn isVisible;\n\t}\n\n\tfunction generateChildElement(task, child, timeline, sizes, childBaselines){\n\t\tif(child.hide_bar){\n\t\t\treturn;\n\t\t}\n\n\t\tconst isProject = gantt.isSummaryTask(child);\n\t\tif(isProject){\n\t\t\tgantt.resetProjectDates(child);\n\t\t}\n\n\t\tconst childCopy = gantt.copy(gantt.getTask(child.id));\n\t\tchildCopy.$rendered_at = task.id;\n\t\t// a way to filter split tasks:\n\t\tconst showSplitTask = gantt.callEvent(\"onBeforeSplitTaskDisplay\", [childCopy.id, childCopy, task.id]);\n\t\tif (showSplitTask === false){\n\t\t\treturn;\n\t\t}\n\n\t\tconst element = defaultRender(childCopy, timeline);\n\t\tif(!element)\n\t\t\treturn;\n\n\t\tconst milestoneChild = child.type === gantt.config.types.milestone;\n\t\tlet milestoneWidth;\n\n\t\tconst parentHeight = sizes.rowHeight;\n\t\tconst childHeight = timeline.getBarHeight(childCopy.id, milestoneChild);\n\t\tlet padding = Math.floor((timeline.getItemHeight(task.id) - childHeight) / 2);\n\n\t\tif (milestoneChild){\n\t\t\tmilestoneWidth = getMilestoneHeight(childHeight);\n\t\t}\n\n\t\tif (childBaselines/*|| (child.bar_height !== \"full\" && child.bar_height < child.row_height)*/){\n\t\t\tif (milestoneChild){\n\t\t\t\tpadding = Math.floor((milestoneWidth - childHeight) / 2) + 2;\n\t\t\t} else {\n\t\t\t\tpadding = 2;\n\t\t\t}\t\n\t\t}\n\t\t// GS-2270: Split children shouldn't exceed the parent row height\n\t\tconst linkDragLeft = element.querySelector(\".gantt_link_control.task_start_date\");\n\t\tconst linkDragRight = element.querySelector(\".gantt_link_control.task_end_date\");\n\t\tif (milestoneChild){\n\t\t\tif (milestoneWidth > parentHeight){\n\t\t\t\tpadding = 2;\n\t\t\t\telement.style.height = parentHeight - padding + \"px\";\n\t\t\t\tconst offsetHeight = getInvertedMilestoneHeight(parentHeight);\n\t\t\t\tconst offsetMargin = (offsetHeight - parentHeight) / 2;\n\t\t\t\tconst taskContent = element.querySelector(\".gantt_task_content\");\n\t\t\t\tpadding = Math.abs(offsetMargin);\n\n\t\t\t\tlinkDragLeft.style.marginLeft = offsetMargin + \"px\";\n\t\t\t\tlinkDragRight.style.marginRight = offsetMargin + \"px\";\n\t\t\t\tlinkDragLeft.style.height = linkDragRight.style.height = offsetHeight + \"px\";\n\n\t\t\t\telement.style.width = \n\t\t\t\ttaskContent.style.height = \n\t\t\t\ttaskContent.style.width = offsetHeight + \"px\";\n\t\t\t\telement.style.left = timeline.getItemPosition(childCopy).left - offsetHeight / 2 + \"px\";\n\t\t\t}\n\t\t} else if (childHeight + padding > parentHeight){\n\t\t\tpadding = 0;\n\t\t\telement.style.height = \n\t\t\telement.style.lineHeight = \n\t\t\tlinkDragLeft.style.height = \n\t\t\tlinkDragRight.style.height = parentHeight + \"px\";\n\t\t}\n\n\t\telement.style.top = (sizes.top + padding) + \"px\";\n\t\telement.classList.add(\"gantt_split_child\");\n\t\tif(isProject){\n\t\t\telement.classList.add(\"gantt_split_subproject\");\n\t\t}\n\n\t\treturn element;\n\t}\n\n\tfunction getKey(childId, renderParentId){\n\t\treturn childId + \"_\" + renderParentId;\n\t}\n\n\tfunction shouldUseSplitRendering(task, config){\n\t\treturn (gantt.isSplitTask(task) && ((config.open_split_tasks && !task.$open) || !config.open_split_tasks) && gantt.hasChild(task.id));\n\t}\n\n\tfunction renderSplitTask(task, timeline, config, viewPort) {\n\t\tif (shouldUseSplitRendering(task, config)) {\n\t\t\tconst el = document.createElement('div'),\n\t\t\t\tsizes = gantt.getTaskPosition(task);\n\n\t\t\tconst childBaselines = childrenHaveBaselines(gantt, task.id);\n\n\t\t\tif(gantt.hasChild(task.id)){\n\n\t\t\t\tgantt.eachTask(function(child){\n\t\t\t\t\tlet isVisible = checkVisibility(child, viewPort, timeline, config, gantt);\n\t\t\t\t\tif (!isVisible){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t// GS-902: render only split-child tasks and inline-child tasks in parent\n\t\t\t\t\tif(splitTasksHelper.isDefaultSplitItem(child) || splitTasksHelper.isInlineSplitItem(child)){\n\t\t\t\t\t\tconst element = generateChildElement(task, child, timeline, sizes, childBaselines);\n\t\t\t\t\t\tif (element) {\n\t\t\t\t\t\t\trenderedNodes[getKey(child.id, task.id)] = element;\n\t\t\t\t\t\t\tel.appendChild(element);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\trenderedNodes[getKey(child.id, task.id)] = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, task.id);\n\n\t\t\t}\n\t\t\treturn el;\n\t\t\t\n\t\t}\n\t\t// GS-902: custom logic for inline-child tasks\n\t\tif(gantt.isSplitTask(task) && gantt.hasChild(task.id)){\n\t\t\tconst el = document.createElement('div'),\n\t\t\tsizes = gantt.getTaskPosition(task);\n\t\t\tconst childBaselines = childrenHaveBaselines(gantt, task.id);\n\t\t\tgantt.eachTask(function(child){\n\t\t\t\tlet isVisible = checkVisibility(child, viewPort, timeline, config, gantt);\n\t\t\t\tif (!isVisible){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif(splitTasksHelper.isInlineSplitItem(child)){\n\t\t\t\t\tconst element = generateChildElement(task, child, timeline, sizes, childBaselines);\n\t\t\t\t\tif (element) {\n\t\t\t\t\t\trenderedNodes[getKey(child.id, task.id)] = element;\n\t\t\t\t\t\tel.appendChild(element);\n\t\t\t\t\t}else{\n\t\t\t\t\t\trenderedNodes[getKey(child.id, task.id)] = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}, task.id);\n\t\t\treturn el;\n\t\t}\n\t\treturn false;\n\t}\n\tfunction repaintSplitTask(task, itemNode, timeline, config, viewPort) {\n\t\tif (shouldUseSplitRendering(task, config)) {\n\t\t\tconst el = document.createElement(\"div\"),\n\t\t\tsizes = gantt.getTaskPosition(task);\n\n\t\t\tconst childBaselines = childrenHaveBaselines(gantt, task.id);\n\t\t\tgantt.eachTask(function (child) {\n\t\t\t\tconst splitKey = getKey(child.id, task.id);\n\t\t\t\tlet isVisible = checkVisibility(child, viewPort, timeline, config, gantt);\n\t\t\t\t// GS-902: repaint split-child tasks and inline-child tasks in parent\n\t\t\t\tif(splitTasksHelper.isDefaultSplitItem(child) || splitTasksHelper.isInlineSplitItem(child)){\n\t\t\t\t\tif (isVisible !== !!renderedNodes[splitKey]) {\n\n\t\t\t\t\t\tif (isVisible) {\n\t\t\t\t\t\t\tconst element = generateChildElement(task, child, timeline, sizes, childBaselines);\n\t\t\t\t\t\t\trenderedNodes[splitKey] = element || false;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trenderedNodes[splitKey] = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!!renderedNodes[splitKey]) {\n\t\t\t\t\tel.appendChild(renderedNodes[splitKey]);\n\t\t\t\t}\n\t\t\t\titemNode.innerHTML = \"\";\n\t\t\t\titemNode.appendChild(el);\n\t\t\t}, task.id);\n\t\t}\n\t\t// GS-902: custom logic for inline-child tasks\n\t\tif(gantt.isSplitTask(task) && gantt.hasChild(task.id)){\n\t\t\tconst el = document.createElement('div'),\n\t\t\tsizes = gantt.getTaskPosition(task);\n\t\t\tconst childBaselines = childrenHaveBaselines(gantt, task.id);\n\t\t\tgantt.eachTask(function(child){\n\t\t\t\tlet isVisible = checkVisibility(child, viewPort, timeline, config, gantt);\n\t\t\t\tif (!isVisible){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif(splitTasksHelper.isInlineSplitItem(child)){\n\t\t\t\t\tconst element = generateChildElement(task, child, timeline, sizes, childBaselines);\n\t\t\t\t\tif (element) {\n\t\t\t\t\t\trenderedNodes[getKey(child.id, task.id)] = element;\n\t\t\t\t\t\tel.appendChild(element);\n\t\t\t\t\t}else{\n\t\t\t\t\t\trenderedNodes[getKey(child.id, task.id)] = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}, task.id);\n\n\t\t}\n\t}\n\treturn {\n\t\trender: renderSplitTask,\n\t\tupdate: repaintSplitTask,\n\t\tisInViewPort: isInViewPortParent,\n\t\tgetVisibleRange: getVisibleRange\n\t};\n}\n\nexport default createTaskRenderer;","import getRectangle from \"./viewport/get_bg_row_rectangle\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport getVisibleCellsRange from \"./viewport/get_visible_cells_range\";\nimport isColumnVisible from \"./viewport/is_column_visible\";\nimport resourceTimetable from \"../../resource_timetable_builder\";\n\nfunction generateRenderResourceLine(gantt){\n\tvar getResourceLoad = resourceTimetable(gantt);\n\tvar renderedResourceLines = {};\n\n\tfunction renderResourceLineCell(resource, day, templates, config, timeline){\n\t\tvar css = templates.resource_cell_class(day.start_date, day.end_date, resource, day.tasks, day.assignments);\n\t\tvar content = templates.resource_cell_value(day.start_date, day.end_date, resource, day.tasks, day.assignments);\n\t\tvar height = timeline.getItemHeight(resource.id) - 1;\n\n\t\tif (css || content){\n\t\t\tvar sizes = timeline.getItemPosition(resource, day.start_date, day.end_date);\n\t\t\tvar el = document.createElement('div');\n\t\t\tel.setAttribute(timeline.$config.item_attribute, resource.id);\n\t\t\tel.className = [\"gantt_resource_marker\", css].join(\" \");\n\n\t\t\tel.style.cssText = [\n\t\t\t\t'left:' + sizes.left + 'px',\n\t\t\t\t'width:' + sizes.width + 'px',\n\t\t\t\t'height:' + (height) + 'px',\n\t\t\t\t'line-height:' + (height) + 'px',\n\t\t\t\t'top:' + sizes.top + 'px'\n\t\t\t].join(\";\");\n\n\t\t\tif(content)\n\t\t\t\tel.innerHTML = content;\n\n\t\t\treturn el;\n\t\t}\n\t\treturn null;\n\t}\n\n\tfunction detachRenderedResourceLine(id, index){\n\t\tif(renderedResourceLines[id] && renderedResourceLines[id][index] &&\n\t\t\trenderedResourceLines[id][index].parentNode\n\t\t\t){\n\t\t\t\trenderedResourceLines[id][index].parentNode.removeChild(renderedResourceLines[id][index]);\n\t\t\t}\n\t}\n\n\tfunction renderResourceLine(resource, timeline, config, viewport) {\n\t\tvar templates = timeline.$getTemplates();\n\t\tvar scale = timeline.getScale();\n\t\tvar timetable = getResourceLoad(resource, config.resource_property, timeline.getScale(), timeline);\n\t\tvar smartRendering = !!viewport;//no viewport means smart rendering is disabled\n\t\tvar cells = [];\n\t\trenderedResourceLines[resource.id] = {};\n\n\t\tvar range = getVisibleCellsRange(scale, viewport);\n\t\tfor (var columnIndex = range.start; columnIndex <= range.end; columnIndex++) {\n\n\t\t\tvar day = timetable[columnIndex];\n\t\t\tif(!day){\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(smartRendering && !isColumnVisible(columnIndex, scale, viewport, gantt)){\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar cell = renderResourceLineCell(resource, day, templates, config, timeline);\n\t\t\tif(cell){\n\t\t\t\tcells.push(cell);\n\t\t\t\trenderedResourceLines[resource.id][columnIndex] = cell;\n\t\t\t}\n\t\t}\n\n\t\tvar row = null;\n\t\tif(cells.length){\n\t\t\trow = document.createElement(\"div\");\n\t\t\tfor(var i = 0; i < cells.length; i++){\n\t\t\t\trow.appendChild(cells[i]);\n\t\t\t}\n\t\t}\n\t\treturn row;\n\t}\n\n\tfunction updateResourceLine(resource, node, timeline, config, viewport) {\n\t\tvar templates = timeline.$getTemplates();\n\t\tvar scale = timeline.getScale();\n\t\tvar timetable = getResourceLoad(resource, config.resource_property, timeline.getScale(), timeline);\n\n\t\tvar range = getVisibleCellsRange(scale, viewport);\n\n\t\tvar checkedColumns = {};\n\t\tif(renderedResourceLines && renderedResourceLines[resource.id]){\n\t\t\tfor(var i in renderedResourceLines[resource.id]){\n\t\t\t\tcheckedColumns[i] = i;\n\t\t\t}\n\t\t}\n\n\t\tfor (var columnIndex = range.start; columnIndex <= range.end; columnIndex++) {\n\t\t\tvar day = timetable[columnIndex];\n\t\t\tcheckedColumns[columnIndex] = false;\n\t\t\tif(!day){\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(!isColumnVisible(columnIndex, scale, viewport, gantt)){\n\t\t\t\tdetachRenderedResourceLine(resource.id, columnIndex);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(!renderedResourceLines[resource.id] || !renderedResourceLines[resource.id][columnIndex]){\n\t\t\t\tvar cell = renderResourceLineCell(resource, day, templates, config, timeline);\n\t\t\t\tif(cell){\n\t\t\t\t\tnode.appendChild(cell);\n\t\t\t\t\trenderedResourceLines[resource.id][columnIndex] = cell;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(renderedResourceLines[resource.id] && renderedResourceLines[resource.id][columnIndex] && !renderedResourceLines[resource.id][columnIndex].parentNode){\n\t\t\t\tnode.appendChild(renderedResourceLines[resource.id][columnIndex]);\n\t\t\t}\n\t\t}\n\n\t\tfor(var i in checkedColumns){\n\t\t\tif(checkedColumns[i] !== false){\n\t\t\t\tdetachRenderedResourceLine(resource.id, i);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn {\n\t\trender: renderResourceLine,\n\t\tupdate: updateResourceLine,\n\t\tgetRectangle: getRectangle,\n\t\tgetVisibleRange: getVisibleRange\n\t};\n}\n\nexport default generateRenderResourceLine;","import getRowRectangle from \"./viewport/get_grid_row_rectangle\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\n\nfunction createGridTaskRowResizerRender(gantt){\n\n\tfunction _render_grid_item(item, view, viewport) {\n\n\t\tvar config = view.$getConfig();\n\t\tvar resize_el = document.createElement(\"div\");\n\t\tresize_el.className = \"gantt_task_grid_row_resize_wrap\";\n\n\t\tresize_el.style.top = (view.getItemTop(item.id) + view.getItemHeight(item.id)) + \"px\";\n\n\t\tresize_el.innerHTML = \"<div class='gantt_task_grid_row_resize' role='cell'></div>\";\n\t\tresize_el.setAttribute(config.task_grid_row_resizer_attribute, item.id);\n\n\t\tgantt._waiAria.rowResizerAttr(resize_el);\n\t\treturn resize_el;\n\t}\n\n\treturn {\n\t\trender: _render_grid_item,\n\t\tupdate: null,\n\t\tgetRectangle: getRowRectangle,\n\t\tgetVisibleRange: getVisibleRange\n\t};\n}\n\nexport default createGridTaskRowResizerRender;","function _configure(col, data, force) {\n\tfor (var key in data)\n\t\tif (typeof col[key] == \"undefined\" || force)\n\t\t\tcol[key] = data[key];\n}\n\nfunction _get_skin(force, gantt) {\n\n\tconst styles = getComputedStyle(gantt.$root);\n\tconst themeVar = styles.getPropertyValue(\"--dhx-gantt-theme\");\n\tlet isCssVarTheme = !!themeVar;\n\tlet themeName;\n\n\t\n\tif(isCssVarTheme){\n\t\tthemeName = themeVar;\n\t}else{\n\t\tvar skin = gantt.skin;\n\t\tthemeName = skin;\n\t\tif (!skin || force) {\n\t\t\tvar links = document.getElementsByTagName(\"link\");\n\t\t\tfor (var i = 0; i < links.length; i++) {\n\t\t\t\tvar res = links[i].href.match(\"dhtmlxgantt_([a-z_]+).css\");\n\t\t\t\tif (res) {\n\t\t\t\t\tif (gantt.skins[res[1]] || !skin) {\n\t\t\t\t\t\tthemeName = res[1];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tgantt._theme_info = {\n\t\ttheme: themeName,\n\t\tcssVarTheme: isCssVarTheme\n\t};\n\n\n\n\tgantt.skin = themeName || \"terrace\";\n\tvar skinset = gantt.skins[gantt.skin] || gantt.skins[\"terrace\"];\n\n\t//apply skin related settings\n\t_configure(gantt.config, skinset.config, force);\n\n\tif(!isCssVarTheme){\n\t\tgantt.config.link_radius = 1;\n\t}\n\n\tvar config = gantt.getGridColumns();\n\tif (config[1] && !gantt.defined(config[1].width))\n\t\tconfig[1].width = skinset._second_column_width;\n\tif (config[2] && !gantt.defined(config[2].width))\n\t\tconfig[2].width = skinset._third_column_width;\n\t\n\tfor (var i=0; i<config.length; i++) {\n\t\tvar column = config[i];\n\t\tif (column.name == \"add\") {\n\t\t\tif(!column.width){\n\t\t\t\tcolumn.width = 44;\n\t\t\t}\n\t\t\tif (!(gantt.defined(column.min_width) && gantt.defined(column.max_width))) {\n\t\t\t\tcolumn.min_width = column.min_width || column.width;\n\t\t\t\tcolumn.max_width = column.max_width || column.width;\n\t\t\t}\n\t\t\tif (column.min_width)\n\t\t\t\tcolumn.min_width = +column.min_width;\n\t\t\tif (column.max_width)\n\t\t\t\tcolumn.max_width = +column.max_width;\n\t\t\tif (column.width) {\n\t\t\t\tcolumn.width = +column.width;\n\t\t\t\tcolumn.width = (column.min_width && column.min_width > column.width) ? column.min_width : column.width;\n\t\t\t\tcolumn.width = (column.max_width && column.max_width < column.width) ? column.max_width : column.width;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (skinset.config.task_height){\n\t\tgantt.config.task_height = skinset.config.task_height || \"full\";\n\t}\n\tif (skinset.config.bar_height){\n\t\tgantt.config.bar_height = skinset.config.bar_height || \"full\";\n\t}\n\n\tif (skinset._lightbox_template)\n\t\tgantt._lightbox_template = skinset._lightbox_template;\n\n\tif (skinset._redefine_lightbox_buttons) {\n\t\tgantt.config.buttons_right = skinset._redefine_lightbox_buttons[\"buttons_right\"];\n\t\tgantt.config.buttons_left = skinset._redefine_lightbox_buttons[\"buttons_left\"];\n\t}\n\n\n\tgantt.resetLightbox();\n}\n\n\n\nexport default function(gantt) {\n\t\n\tif(!gantt.resetSkin){\n\t\tgantt.resetSkin = function () {\n\t\t\tthis.skin = \"\";\n\t\t\t_get_skin(true, this);\n\t\t};\n\t\tgantt.skins = {};\n\n\t\tgantt.attachEvent(\"onGanttLayoutReady\", function(){\n\t\t\t_get_skin(false, this);\n\t\t\tmonitorThemeChange();\n\t\t});\n\t}\n\n\tgantt._addThemeClass = function(){\n\t\tdocument.documentElement.setAttribute(\"data-gantt-theme\", gantt.skin);\n\t};\n\n\tgantt.setSkin = function(value){\n\t\tconst skinChanged = this.skin !== value;\n\t\tthis.skin = value;\n\t\tgantt._addThemeClass();\n\t\tmonitorThemeChange();\n\t\tif(gantt.$root){\n\t\t\t_get_skin(skinChanged ? false : true, gantt);\n\t\t\tthis.render();\n\t\t}\n\t\t\n\t\t//\n\t};\n\n\n\tlet monitorIntervalId = null;\n\tfunction monitorThemeChange(){\n\t\tconst container = gantt.$root;\n\t\t\n\t\tif(monitorIntervalId){\n\t\t\tclearInterval(monitorIntervalId);\n\t\t}\n\t\t\n\t\tif(container){\n\t\t\tmonitorIntervalId = setInterval(() => {\n\t\t\t\tconst csstheme = getComputedStyle(container).getPropertyValue('--dhx-gantt-theme');\n\t\t\t\tif(csstheme && csstheme !== gantt.skin){\n\t\t\t\t\tgantt.setSkin(csstheme);\n\t\t\t\t}\n\n\t\t\t}, 100);\n\t\t}\n\t}\n\tgantt.attachEvent(\"onDestroy\", function(){\n\t\tclearInterval(monitorIntervalId);\n\t});\n};","import * as domHelpers from \"../utils/dom_helpers\";\nimport isHeadless from \"../../../utils/is_headless\";\n\nexport default function(gantt){\n\n\tvar scrollRange = 50,\n\t\tscrollStep = 30,\n\t\tscrollDelay = 10,\n\t\tscrollSpeed = 50;\n\n\tvar interval = null,\n\t\tisMove = false,\n\t\tdelayTimeout = null,\n\t\tstartPos = {\n\t\t\tstarted: false\n\t\t},\n\t\teventPos = {};\n\n\n\tfunction isDisplayed(element){\n\t\treturn element &&\n\t\t\tdomHelpers.isChildOf(element, gantt.$root) &&\n\t\t\telement.offsetHeight;\n\t}\n\n\tfunction getAutoscrollContainer(){\n\t\tvar element;\n\t\tif(isDisplayed(gantt.$task)){\n\t\t\telement = gantt.$task;\n\t\t}else if(isDisplayed(gantt.$grid)){\n\t\t\telement = gantt.$grid;\n\t\t}else{\n\t\t\telement = gantt.$root;\n\t\t}\n\n\t\treturn element;\n\t}\n\n\tfunction isScrollState() {\n\t\tvar dragMarker = !!document.querySelector(\".gantt_drag_marker\");\n\t\tvar isResize = !!document.querySelector(\".gantt_drag_marker.gantt_grid_resize_area\")\n\t\t\t|| !!document.querySelector(\".gantt_drag_marker.gantt_row_grid_resize_area\") ;\n\t\tvar isLink = !!document.querySelector(\".gantt_link_direction\");\n\t\tvar state = gantt.getState();\n\t\tvar isClickDrag = state.autoscroll;\n\t\tisMove = dragMarker && !isResize && !isLink;\n\n\t\treturn !((!state.drag_mode && !dragMarker) || isResize) || isClickDrag;\n\t}\n\n\tfunction defineDelayTimeout(state) {\n\t\tif (delayTimeout) {\n\t\t\tclearTimeout(delayTimeout);\n\t\t\tdelayTimeout = null;\n\t\t}\n\t\tif (state) {\n\t\t\tvar speed = gantt.config.autoscroll_speed;\n\t\t\tif (speed && speed < 10) // limit speed value to 10\n\t\t\t\tspeed = 10;\n\n\t\t\tdelayTimeout = setTimeout(function() {\n\t\t\t\tinterval = setInterval(tick, speed || scrollSpeed);\n\t\t\t}, gantt.config.autoscroll_delay || scrollDelay);\n\t\t}\n\t}\n\n\tfunction defineScrollInterval(state) {\n\t\tif (state) {\n\t\t\tdefineDelayTimeout(true);\n\t\t\tif (!startPos.started) {\n\t\t\t\tstartPos.x = eventPos.x;\n\t\t\t\tstartPos.y = eventPos.y;\n\t\t\t\tstartPos.started = true;\n\t\t\t}\n\t\t} else {\n\t\t\tif (interval) {\n\t\t\t\tclearInterval(interval);\n\t\t\t\tinterval = null;\n\t\t\t}\n\t\t\tdefineDelayTimeout(false);\n\t\t\tstartPos.started = false;\n\t\t}\n\t}\n\n\tfunction autoscrollInterval(event) {\n\t\tvar isScroll = isScrollState();\n\n\t\tif ((interval || delayTimeout) && !isScroll) {\n\t\t\tdefineScrollInterval(false);\n\t\t}\n\n\t\tif (!gantt.config.autoscroll || !isScroll) {\n\t\t\treturn false;\n\t\t}\n\n\t\teventPos = {\n\t\t\tx: event.clientX,\n\t\t\ty: event.clientY\n\t\t};\n\n\t\t// if it is a mobile device, we need to detect the touch event coords\n\t\tif (event.type == \"touchmove\"){\n\t\t\teventPos.x = event.targetTouches[0].clientX;\n\t\t\teventPos.y = event.targetTouches[0].clientY;\n\t\t}\n\n\t\tif (!interval && isScroll) {\n\t\t\tdefineScrollInterval(true);\n\t\t}\n\t}\n\n\tfunction tick() {\n\n\t\tif (!isScrollState()) {\n\t\t\tdefineScrollInterval(false);\n\t\t\treturn false;\n\t\t}\n\n\t\tvar container = getAutoscrollContainer();\n\t\tif(!container){\n\t\t\treturn;\n\t\t}\n\t\t// GS-1150: if we reorder or resize something in the grid, we should obtain the grid container\n\t\tvar gridDrag = false;\n\t\tvar gridMarkers = [\n\t\t\t\".gantt_drag_marker.gantt_grid_resize_area\",\n\t\t\t\".gantt_drag_marker .gantt_row.gantt_row_task\",\n\t\t\t\".gantt_drag_marker.gantt_grid_dnd_marker\"\n\t\t];\n\t\tgridMarkers.forEach(function (selector) {\n\t\t\tgridDrag = gridDrag || !!document.querySelector(selector);\n\t\t});\n\t\tif (gridDrag){\n\t\t\tcontainer = gantt.$grid;\n\t\t}\n\n\t\tvar box = domHelpers.getNodePosition(container);\n\n\t\tvar posX = eventPos.x - box.x;\n\t\tvar posY = eventPos.y - box.y + window.scrollY; // GS-1315: window.scrollY here and below for the elements above Gantt\n\n\t\tvar scrollLeft = isMove ? 0 : need_scroll(posX, box.width, startPos.x - box.x);\n\t\tvar scrollTop = need_scroll(posY, box.height, startPos.y - box.y + window.scrollY);\n\n\t\tvar scrollState = gantt.getScrollState();\n\n\t\tvar currentScrollTop = scrollState.y,\n\t\t\tscrollOuterHeight = scrollState.inner_height,\n\t\t\tscrollInnerHeight = scrollState.height,\n\t\t\tcurrentScrollLeft = scrollState.x,\n\t\t\tscrollOuterWidth = scrollState.inner_width,\n\t\t\tscrollInnerWidth = scrollState.width;\n\n\t\t// do scrolling only if we have scrollable area to do so\n\t\tif (scrollTop && !scrollOuterHeight) {\n\t\t\tscrollTop = 0;\n\t\t} else if (scrollTop < 0 && !currentScrollTop) {\n\t\t\tscrollTop = 0;\n\t\t} else if (scrollTop > 0 && currentScrollTop + scrollOuterHeight >= scrollInnerHeight + 2) {\n\t\t\tscrollTop = 0;\n\t\t}\n\n\t\tif (scrollLeft && !scrollOuterWidth) {\n\t\t\tscrollLeft = 0;\n\t\t} else if (scrollLeft < 0 && !currentScrollLeft) {\n\t\t\tscrollLeft = 0;\n\t\t} else if (scrollLeft > 0 && currentScrollLeft + scrollOuterWidth >= scrollInnerWidth) {\n\t\t\tscrollLeft = 0;\n\t\t}\n\n\t\tvar step = gantt.config.autoscroll_step;\n\n\t\tif (step && step < 2) // limit step value to 2\n\t\t\tstep = 2;\n\n\t\tscrollLeft = scrollLeft * (step || scrollStep);\n\t\tscrollTop = scrollTop * (step || scrollStep);\n\n\t\tif (scrollLeft || scrollTop) {\n\t\t\tscroll(scrollLeft, scrollTop);\n\t\t}\n\t}\n\n\tfunction need_scroll(pos, boxSize, startCoord) {\n\t\tif ((pos - scrollRange < 0) && (pos < startCoord))\n\t\t\treturn -1;\n\t\telse if ((pos > boxSize - scrollRange) && (pos > startCoord))\n\t\t\treturn 1;\n\t\treturn 0;\n\t}\n\n\tfunction scroll(left, top) {\n\t\tvar scrollState = gantt.getScrollState();\n\n\t\tvar scrollLeft = null,\n\t\t\tscrollTop = null;\n\n\t\tif (left) {\n\t\t\tscrollLeft = scrollState.x + left;\n\t\t\tscrollLeft = Math.min(scrollState.width, scrollLeft);\n\t\t\tscrollLeft = Math.max(0, scrollLeft);\n\t\t}\n\n\t\tif (top) {\n\t\t\tscrollTop = scrollState.y + top;\n\t\t\tscrollTop = Math.min(scrollState.height, scrollTop);\n\t\t\tscrollTop = Math.max(0, scrollTop);\n\t\t}\n\n\t\tgantt.scrollTo(scrollLeft, scrollTop);\n\t}\n\n\tgantt.attachEvent(\"onGanttReady\", function() {\n\t\tif(!isHeadless(gantt)){\n\t\t\tvar eventElement = domHelpers.getRootNode(gantt.$root) || document.body;\n\t\t\tgantt.eventRemove(eventElement, \"mousemove\", autoscrollInterval);\n\t\t\tgantt.event(eventElement, \"mousemove\", autoscrollInterval);\n\n\t\t\tgantt.eventRemove(eventElement, \"touchmove\", autoscrollInterval);\n\t\t\tgantt.event(eventElement, \"touchmove\", autoscrollInterval);\n\n\t\t\tgantt.eventRemove(eventElement, \"pointermove\", autoscrollInterval);\n\t\t\tgantt.event(eventElement, \"pointermove\", autoscrollInterval);\n\t\t}\n\t});\n\n\tgantt.attachEvent(\"onDestroy\", function(){\n\t\tdefineScrollInterval(false);\n\t});\n\n};","if (typeof window !== \"undefined\" && window.jQuery){\n\n\t(function( $ ){\n\n\t\tvar methods = [];\n\t\t$.fn.dhx_gantt = function(config){\n\t\t\tconfig = config || {};\n\t\t\tif (typeof(config) === 'string') {\n\t\t\t\tif (methods[config] ) {\n\t\t\t\t\treturn methods[config].apply(this, []);\n\t\t\t\t}else {\n\t\t\t\t\t$.error('Method ' +  config + ' does not exist on jQuery.dhx_gantt');\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar views = [];\n\t\t\t\tthis.each(function() {\n\t\t\t\t\tif (this && this.getAttribute){\n\t\t\t\t\t\tif (!this.gantt && !(window.gantt.$root == this)){\n\n\t\t\t\t\t\t\tvar newgantt = (window.gantt.$container && window.Gantt) ? window.Gantt.getGanttInstance():window.gantt;\n\t\t\t\t\t\t\tfor (var key in config)\n\t\t\t\t\t\t\t\tif (key!=\"data\")\n\t\t\t\t\t\t\t\t\tnewgantt.config[key] = config[key];\n\n\t\t\t\t\t\t\tnewgantt.init(this);\n\t\t\t\t\t\t\tif (config.data)\n\t\t\t\t\t\t\t\tnewgantt.parse(config.data);\n\n\t\t\t\t\t\t\tviews.push(newgantt);\n\t\t\t\t\t\t} else\n\t\t\t\t\t\t\tviews.push(typeof this.gantt == \"object\" ? this.gantt : window.gantt);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\n\t\t\t\tif (views.length === 1) return views[0];\n\t\t\t\treturn views;\n\t\t\t}\n\t\t};\n\n\t})(window.jQuery);\n\n}\n\n\nexport default null;","if (typeof window !== \"undefined\" && window.dhtmlx){\n\n\tif (!window.dhtmlx.attaches)\n\twindow.dhtmlx.attaches = {};\n\n\twindow.dhtmlx.attaches.attachGantt=function(start, end, gantt){\n\t\tvar obj = document.createElement(\"DIV\");\n\n\t\tgantt = gantt || window.gantt;\n\n\t\tobj.id = \"gantt_\"+ gantt.uid();\n\t\tobj.style.width = \"100%\";\n\t\tobj.style.height = \"100%\";\n\t\tobj.cmp = \"grid\";\n\n\t\tdocument.body.appendChild(obj);\n\t\tthis.attachObject(obj.id);\n\t\tthis.dataType = \"gantt\";\n\t\tthis.dataObj = gantt;\n\n\t\tvar that = this.vs[this.av];\n\t\tthat.grid = gantt;\n\n\t\tgantt.init(obj.id, start, end);\n\t\tobj.firstChild.style.border = \"none\";\n\n\t\tthat.gridId = obj.id;\n\t\tthat.gridObj = obj;\n\n\t\tvar method_name=\"_viewRestore\";\n\t\treturn this.vs[this[method_name]()].grid;\n\t};\n\n}\nif (typeof window !== \"undefined\" && typeof(window.dhtmlXCellObject) != \"undefined\") {\n\n\twindow.dhtmlXCellObject.prototype.attachGantt=function(start, end, gantt){\n\t\tgantt = gantt || window.gantt;\n\n\t\tvar obj = document.createElement(\"DIV\");\n\t\tobj.id = \"gantt_\"+gantt.uid();\n\t\tobj.style.width = \"100%\";\n\t\tobj.style.height = \"100%\";\n\t\tobj.cmp = \"grid\";\n\n\t\tdocument.body.appendChild(obj);\n\t\tthis.attachObject(obj.id);\n\n\t\tthis.dataType = \"gantt\";\n\t\tthis.dataObj = gantt;\n\n\t\tgantt.init(obj.id, start, end);\n\t\tobj.firstChild.style.border = \"none\";\n\n\t\tobj = null;\n\t\tthis.callEvent(\"_onContentAttach\",[]);\n\n\t\treturn this.dataObj;\n\t};\n}\n\nexport default null;","import env from \"../../../utils/env\";\nimport eventable from \"../../../utils/eventable\";\nimport { IScale, TModifierKeys } from \"../../common/config\";\n\ninterface ITimelineZoomConfig {\n\thandler?: (e: Event) => {};\n\tstartDate?: Date;\n\tendDate?: Date;\n\tlevels: IZoomLevel[];\n\tactiveLevelIndex?: number;\n\twidthStep?: number;\n\tminColumnWidth?: number;\n\tmaxColumnWidth?: number;\n\tuseKey?: \"ctrlKey\" | \"altKey\" | \"shiftKey\";\n\ttrigger?: \"wheel\" | null | undefined;\n\telement?: Element | (() => Element);\n}\n\nconst USE_KEY = [\"ctrlKey\", \"altKey\", \"shiftKey\", \"metaKey\"];\n\ninterface IZoomLevel {\n\tname?: string;\n\tscale_height?: number;\n\tmin_column_width: number;\n\tscales: IScale[];\n}\n\nconst _defaultScales = [\n\t[\n\t\t{\n\t\t\tunit: \"month\",\n\t\t\tdate: \"%M\",\n\t\t\tstep: 1\n\t\t},\n\t\t{\n\t\t\tunit: \"day\",\n\t\t\tdate: \"%d\",\n\t\t\tstep: 1\n\t\t}\n\t],\n\t[\n\t\t{\n\t\t\tunit: \"day\",\n\t\t\tdate: \"%d %M\",\n\t\t\tstep: 1\n\t\t}\n\t],\n\t[\n\t\t{\n\t\t\tunit: \"day\",\n\t\t\tdate: \"%d %M\",\n\t\t\tstep: 1\n\t\t},\n\t\t{\n\t\t\tunit: \"hour\",\n\t\t\tdate: \"%H:00\",\n\t\t\tstep: 8\n\t\t}\n\t],\n\t[\n\t\t{\n\t\t\tunit: \"day\",\n\t\t\tdate: \"%d %M\",\n\t\t\tstep: 1\n\t\t},\n\t\t{\n\t\t\tunit: \"hour\",\n\t\t\tdate: \"%H:00\",\n\t\t\tstep: 1\n\t\t}\n\t]\n];\n\nexport default class TimelineZoom {\n\tpublic attachEvent: (eventName: string, handler: () => void) => string;\n\tpublic callEvent: (eventName: string, args: any[]) => any;\n\tpublic detachEvent: (eventName: string) => any;\n\tprotected _initialStartDate: Date;\n\tprotected _initialEndDate: Date;\n\tprotected _activeLevelIndex: number;\n\tprotected _levels: IZoomLevel[];\n\tprotected _handler: (e: any) => void;\n\tprotected $gantt;\n\tprotected _widthStep: number;\n\tprotected _minColumnWidth: number;\n\tprotected _maxColumnWidth: number;\n\tprotected _useKey: TModifierKeys;\n\tprotected _visibleDate: Date;\n\tprotected _initialized: boolean;\n\tprotected _domEvents: any;\n\n\tconstructor(gantt) {\n\t\tthis.$gantt = gantt;\n\t\tthis._domEvents = this.$gantt._createDomEventScope();\n\t}\n\n\tpublic init(config: ITimelineZoomConfig) {\n\t\t// GS-1354 and GS-1318. If we check the headless mode using the function,\n\t\t// it will return false when Gantt is not initialized, but we may want to do it later\n\t\tif(this.$gantt.env.isNode){\n\t\t\treturn;\n\t\t}\n\t\tthis._initialStartDate = config.startDate;\n\t\tthis._initialEndDate = config.endDate;\n\t\tthis._activeLevelIndex = config.activeLevelIndex ? config.activeLevelIndex : 0;\n\t\tthis._levels = this._mapScales(config.levels || _defaultScales);\n\t\tthis._handler = config.handler || this._defaultHandler;\n\t\tthis._minColumnWidth = config.minColumnWidth || 60;\n\t\tthis._maxColumnWidth = config.maxColumnWidth || 240;\n\t\tthis._widthStep = config.widthStep || 3/8 * config.minColumnWidth;\n\t\tthis._useKey = config.useKey;\n\n\t\tif(!this._initialized){\n\t\t\teventable(this);\n\t\t\tthis.$gantt.attachEvent(\"onGanttScroll\", () => {\n\t\t\t\tthis._getVisibleDate();\n\t\t\t});\n\t\t}\n\n\t\tthis._domEvents.detachAll();\n\n\t\tif(config.trigger === \"wheel\"){\n\t\t\tif(this.$gantt.$root){\n\t\t\t\tthis._attachWheelEvent(config);\n\t\t\t}else{\n\t\t\t\t// GS-1322. This way the handler works for the init and resetLayout methods\n\t\t\t\tthis.$gantt.attachEvent(\"onGanttLayoutReady\", () => {\n\t\t\t\t\tthis.$gantt.attachEvent(\"onGanttRender\", () => {\n\t\t\t\t\t\tthis._attachWheelEvent(config);\n\t\t\t\t\t}, {once: true});\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tthis._initialized = true;\n\t\tthis.setLevel(this._activeLevelIndex);\n\t}\n\n\tpublic zoomIn = () => {\n\t\tconst index = this.getCurrentLevel() - 1;\n\t\tif(index < 0){\n\t\t\treturn;\n\t\t}\n\t\tthis.setLevel(index);\n\t};\n\n\tpublic zoomOut = () => {\n\t\tconst index = this.getCurrentLevel() + 1;\n\t\tif(index > this._levels.length - 1){\n\t\t\treturn;\n\t\t}\n\t\tthis.setLevel(index);\n\t};\n\n\tpublic getCurrentLevel = () => {\n\t\treturn this._activeLevelIndex;\n\t};\n\n\tpublic getLevels = () => {\n\t\treturn this._levels;\n\t};\n\n\tpublic setLevel = (level: number|string) => {\n\t\tconst zoomLevel = this._getZoomIndexByName(level);\n\n\t\tif(zoomLevel === -1){\n\t\t\tthis.$gantt.assert(zoomLevel !== -1, \"Invalid zoom level for gantt.ext.zoom.setLevel. \" + level + \" is not an expected value.\");\n\t\t}\n\t\tthis._setLevel(zoomLevel, 0);\n\t};\n\n\tprotected _getZoomIndexByName = (levelName: number|string) => {\n\t\tlet zoomLevel:number = -1;\n\t\tif(typeof levelName === \"string\"){\n\t\t\tif(!isNaN(Number(levelName)) &&  this._levels[Number(levelName)]){\n\t\t\t\tzoomLevel = Number(levelName);\n\t\t\t}else{\n\t\t\t\tfor(let i = 0; i < this._levels.length; i++){\n\t\t\t\t\tif(this._levels[i].name === levelName){\n\t\t\t\t\t\tzoomLevel = i;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}else{\n\t\t\tzoomLevel = levelName;\n\t\t}\n\t\treturn zoomLevel;\n\t};\n\n\tprotected _mapScales(levels: IScale[][] | any): IZoomLevel[]{\n\t\treturn levels.map((l) => {\n\t\t\tif(Array.isArray(l)){\n\t\t\t\treturn {\n\t\t\t\t\tscales: l\n\t\t\t\t};\n\t\t\t}else{\n\t\t\t\treturn l;\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected _getVisibleDate = () => {\n\t\t// GS-1450. Don't try to get the visible date if there is no timeline\n\t\tif (!this.$gantt.$task){\n\t\t\treturn null;\n\t\t}\n\t\tconst scrollPos = this.$gantt.getScrollState().x;\n\t\tconst viewPort = this.$gantt.$task.offsetWidth;\n\t\tthis._visibleDate = this.$gantt.dateFromPos(scrollPos + viewPort/2);\n\t};\n\n\tprotected _setLevel = (level: number, cursorOffset: number) => {\n\t\tthis._activeLevelIndex = level;\n\n\t\tconst gantt = this.$gantt;\n\t\tconst nextConfig = gantt.copy(this._levels[this._activeLevelIndex]);\n\t\tconst chartConfig = gantt.copy(nextConfig);\n\t\tdelete chartConfig.name;\n\n\t\tgantt.mixin(gantt.config, chartConfig, true);\n\n\t\t// GS-1148: Change scales for the resource views\n\t\tconst resourceViews = [\n\t\t\t\"resourceTimeline\",\n\t\t\t\"resourceHistogram\"\n\t\t];\n\n\t\tresourceViews.forEach(function(name){\n\t\t\tconst resourceView = gantt.$ui.getView(name);\n\t\t\tif (resourceView){\n\t\t\t\tconst resourceConfig = resourceView.$getConfig();\n\t\t\t\tif (!resourceConfig.fixed_scales){\n\t\t\t\t\tgantt.mixin(resourceConfig, chartConfig, true);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tconst isRendered = !!gantt.$root && !!gantt.$task;\n\n\t\tif(isRendered){\n\t\t\tif(cursorOffset){\n\t\t\t\tconst cursorDate = this.$gantt.dateFromPos(cursorOffset + this.$gantt.getScrollState().x);\n\t\t\t\tthis.$gantt.render();\n\t\t\t\tconst newPosition = this.$gantt.posFromDate(cursorDate);\n\t\t\t\tthis.$gantt.scrollTo(newPosition - cursorOffset);\n\t\t\t}else{\n\t\t\t\tconst viewPort = this.$gantt.$task.offsetWidth;\n\t\t\t\tif(!this._visibleDate){\n\t\t\t\t\tthis._getVisibleDate();\n\t\t\t\t}\n\t\t\t\tconst middleDate = this._visibleDate;\n\t\t\t\tthis.$gantt.render();\n\t\t\t\tconst newPosition = this.$gantt.posFromDate(middleDate);\n\t\t\t\tthis.$gantt.scrollTo(newPosition - viewPort/2);\n\t\t\t}\n\n\t\t\tthis.callEvent(\"onAfterZoom\", [this._activeLevelIndex, nextConfig]);\n\t\t}\n\t};\n\n\tprivate _attachWheelEvent = (config) => {\n\t\tconst event = env.isFF ? \"wheel\" : \"mousewheel\";\n\t\tlet el: Element;\n\t\tif(typeof config.element === \"function\"){\n\t\t\tel = config.element();\n\t\t}else{\n\t\t\tel = config.element as Element;\n\t\t}\n\t\tif (!el){\n\t\t\treturn;\n\t\t}\n\n\t\tthis._domEvents.attach(el, event, this.$gantt.bind(function(e) {\n\t\t\tif (this._useKey) {\n\t\t\t\tif (USE_KEY.indexOf(this._useKey) < 0) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (!e[this._useKey]) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (typeof this._handler === \"function\") {\n\t\t\t\tthis._handler.apply(this, [e]);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}, this), {passive: false});\n\t};\n\n\tprivate _defaultHandler = (e: any):void => {\n\t\tconst timelineOffset = this.$gantt.$task.getBoundingClientRect().x;\n\t\tconst cursorOffset = e.clientX - timelineOffset;\n\t\tconst wheelY = this.$gantt.env.isFF ? (e.deltaY*-40) : e.wheelDelta;\n\t\tlet wheelUp = false;\n\t\tif (wheelY > 0) {\n\t\t\twheelUp = true;\n\t\t}\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tthis._setScaleSettings(wheelUp, cursorOffset);\n\t};\n\n\tprivate _setScaleSettings(wheelUp: boolean, cursorOffset: number) {\n\t\tif (wheelUp) {\n\t\t\tthis._stepUp(cursorOffset);\n\t\t} else {\n\t\t\tthis._stepDown(cursorOffset);\n\t\t}\n\t}\n\n\tprivate _setScaleDates = () => {\n\t\tif(this._initialStartDate && this._initialEndDate){\n\t\t\tthis.$gantt.config.start_date = this._initialStartDate;\n\t\t\tthis.$gantt.config.end_date = this._initialEndDate;\n\t\t}\n\t};\n\n\tprivate _stepUp(cursorOffset) {\n\t\tif (this._activeLevelIndex >= this._levels.length - 1) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet nextLevel = this._activeLevelIndex;\n\t\tthis._setScaleDates();\n\n\t\tif(this._widthStep){\n\t\t\tlet newColumnWidth = this.$gantt.config.min_column_width + this._widthStep;\n\t\t\tif (newColumnWidth > this._maxColumnWidth) {\n\t\t\t\tnewColumnWidth = this._minColumnWidth;\n\t\t\t\tnextLevel++;\n\t\t\t}\n\n\t\t\tthis.$gantt.config.min_column_width = newColumnWidth;\n\t\t}else{\n\t\t\tnextLevel++;\n\t\t}\n\t\tthis._setLevel(nextLevel, cursorOffset);\n\t}\n\tprivate _stepDown(cursorOffset) {\n\t\tif (this._activeLevelIndex < 1) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet nextLevel = this._activeLevelIndex;\n\t\tthis._setScaleDates();\n\n\t\tif(this._widthStep){\n\t\t\tlet newColumnWidth = this.$gantt.config.min_column_width - this._widthStep;\n\t\t\tif (newColumnWidth < this._minColumnWidth) {\n\t\t\t\tnewColumnWidth = this._maxColumnWidth;\n\t\t\t\tnextLevel--;\n\t\t\t}\n\t\t\tthis.$gantt.config.min_column_width = newColumnWidth;\n\t\t}else{\n\t\t\tnextLevel--;\n\t\t}\n\t\tthis._setLevel(nextLevel, cursorOffset);\n\t}\n}","export default function(gantt) {\n\n\tgantt.config.touch_drag = 75; //nearly immediate dnd\n\tgantt.config.touch = true;\n\tgantt.config.touch_feedback = true;\n\tgantt.config.touch_feedback_duration = 1;\n\tgantt._prevent_touch_scroll = false;\n\n\n\tgantt._touch_feedback = function () {\n\t\tif (gantt.config.touch_feedback) {\n\t\t\tif (navigator.vibrate)\n\t\t\t\tnavigator.vibrate(gantt.config.touch_feedback_duration);\n\t\t}\n\t};\n\n\tgantt.attachEvent(\"onGanttReady\", function(){\n\t\tif (gantt.$container)\t{\n\t\t\taddTouchEvents();\n\t\t}\n\t});\n\tgantt.attachEvent(\"onGanttLayoutReady\", function(){\n\t\tif (gantt.$container)\t{\n\t\t\t\tgantt.attachEvent(\"onGanttRender\", addTouchEvents, {once: true});\n\t\t}\n\t});\n\n\tfunction addTouchEvents(){\n\t\tif (gantt.config.touch != \"force\")\n\t\t\tgantt.config.touch = gantt.config.touch &&\n\t\t\t\t((navigator.userAgent.indexOf(\"Mobile\") != -1) ||\n\t\t\t\t\t(navigator.userAgent.indexOf(\"iPad\") != -1) ||\n\t\t\t\t\t(navigator.userAgent.indexOf(\"Android\") != -1) ||\n\t\t\t\t\t(navigator.userAgent.indexOf(\"Touch\") != -1)) ||\n\t\t\t\t\t((navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1));\n\n\t\tif (gantt.config.touch) {\n\t\t\t// IE doesn't support touch events. In other cases, a user may connect\n\t\t\t// a touch device at any time, so it should work in the forced touch mode\n\t\t\tconst touchEventsSupported = !gantt.env.isIE || !!window.navigator.maxTouchPoints;\n\n\t\t\tif (touchEventsSupported) {\n\t\t\t\tgantt._touch_events([\"touchmove\", \"touchstart\", \"touchend\"], function (ev) {\n\t\t\t\t\tif (ev.touches && ev.touches.length > 1) return null;\n\t\t\t\t\tif (ev.touches[0])\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\ttarget: ev.target,\n\t\t\t\t\t\t\tpageX: ev.touches[0].pageX,\n\t\t\t\t\t\t\tpageY: ev.touches[0].pageY,\n\t\t\t\t\t\t\tclientX: ev.touches[0].clientX,\n\t\t\t\t\t\t\tclientY: ev.touches[0].clientY\n\t\t\t\t\t\t};\n\t\t\t\t\telse\n\t\t\t\t\t\treturn ev;\n\t\t\t\t}, function (ev) {\n\t\t\t\t\treturn ev.defaultPrevented;\n\t\t\t\t});\n\t\t\t} else if (window.PointerEvent) {\n\t\t\t\tgantt._touch_events([\"pointermove\", \"pointerdown\", \"pointerup\"], function (ev) {\n\t\t\t\t\tif (ev.pointerType == \"mouse\") return null;\n\t\t\t\t\treturn ev;\n\t\t\t\t}, function (ev) {\n\t\t\t\t\treturn (!ev || (ev.pointerType == \"mouse\" ));\n\t\t\t\t});\n\t\t\t}\n\n\t\t}\n\t}\n\n\n\tfunction findTargetView(event){\n\t\tvar allViews = gantt.$layout.getCellsByType(\"viewCell\");\n\n\t\tfor(var i = 0; i < allViews.length; i++){\n\t\t\tvar box = allViews[i].$view.getBoundingClientRect();\n\t\t\tif(event.clientX >= box.left && event.clientX <= box.right &&\n\t\t\t\tevent.clientY <= box.bottom && event.clientY >= box.top){\n\t\t\t\t\treturn allViews[i];\n\t\t\t\t}\n\t\t}\n\t}\n\n\tfunction getScrollState(view){\n\t\tvar scrollX = view.$config.scrollX ? gantt.$ui.getView(view.$config.scrollX) : null;\n\t\tvar scrollY = view.$config.scrollY ? gantt.$ui.getView(view.$config.scrollY) : null;\n\n\t\tvar scrollState = {x: null, y: null};\n\t\tif(scrollX){\n\t\t\tvar state = scrollX.getScrollState();\n\t\t\tif(state.visible){\n\t\t\t\tscrollState.x = scrollX.$view.scrollLeft;\n\t\t\t}\n\t\t}\n\t\tif(scrollY){\n\t\t\tvar state = scrollY.getScrollState();\n\t\t\tif(state.visible){\n\t\t\t\tscrollState.y = scrollY.$view.scrollTop;\n\t\t\t}\n\t\t}\n\t\treturn scrollState;\n\t}\n\n\tfunction scrollView(view, left, top){\n\t\tvar scrollX = view.$config.scrollX ? gantt.$ui.getView(view.$config.scrollX) : null;\n\t\tvar scrollY = view.$config.scrollY ? gantt.$ui.getView(view.$config.scrollY) : null;\n\n\t\tif(scrollX){\n\t\t\tscrollX.scrollTo(left, null);\n\t\t}\n\t\tif(scrollY){\n\t\t\tscrollY.scrollTo(null, top);\n\t\t}\n\t}\n\n\tfunction getTaskDND(){\n\t\tvar tasksDnD;\n\t\tif(gantt.$ui.getView(\"timeline\")){\n\t\t\ttasksDnD = gantt.$ui.getView(\"timeline\")._tasks_dnd;\n\t\t}\n\t\treturn tasksDnD;\n\t}\n\n\tvar touchHandlers = [];\n\n//we can't use native scrolling, as we need to sync momentum between different parts\n//so we will block native scroll and use the custom one\n//in future we can add custom momentum\n\tgantt._touch_events = function (names, accessor, ignore) {\n\t\t//webkit on android need to be handled separately\n\t\tvar dblclicktime = 0;\n\t\tvar actionMode = false;\n\t\tvar scrollMode = false;\n\t\tvar actionStart = null;\n\t\tvar previousActionStart = null;\n\t\tvar scrollState;\n\t\tvar longTapTimer = null;\n\t\tvar currentDndId = null;\n\t\tvar dndNodes = [];\n\t\tvar targetView = null;\n\t\tlet multiTouchEvents = {};\n\n\t\tfor(var i = 0; i < touchHandlers.length; i++){\n\t\t\tgantt.eventRemove(touchHandlers[i][0], touchHandlers[i][1], touchHandlers[i][2]);\n\t\t}\n\t\ttouchHandlers = [];\n\n\t\t//touch move\n\t\ttouchHandlers.push([gantt.$container, names[0], function (e) {\n\t\t\tvar tasksDnD = getTaskDND();\n\n\t\t\t\tif (ignore(e)) return;\n\n\t\t\t\t//ignore common and scrolling moves\n\t\t\t\tif (!actionMode) return;\n\n\t\t\t\tif (longTapTimer) clearTimeout(longTapTimer);\n\n\t\t\t\tvar source = accessor(e);\n\t\t\t\tif (tasksDnD && (tasksDnD.drag.id || tasksDnD.drag.start_drag)) {\n\t\t\t\t\ttasksDnD.on_mouse_move(source);\n\t\t\t\t\tif (e.preventDefault)\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.cancelBubble = true;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (!gantt._prevent_touch_scroll) {\n\t\t\t\t\tif (source && actionStart) {\n\t\t\t\t\t\tvar dx = actionStart.pageX - source.pageX;\n\t\t\t\t\t\tvar dy = actionStart.pageY - source.pageY;\n\t\t\t\t\t\tif (!scrollMode && (Math.abs(dx) > 5 || Math.abs(dy) > 5)) {\n\t\t\t\t\t\t\tscrollMode = true;\n\t\t\t\t\t\t\t//gantt._touch_scroll_active = scroll_mode = true;\n\t\t\t\t\t\t\tdblclicktime = 0;\n\n\t\t\t\t\t\t\tif(targetView){\n\t\t\t\t\t\t\t\tscrollState = getScrollState(targetView);\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tscrollState = gantt.getScrollState();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (scrollMode) {\n\n\t\t\t\t\t\t\tvar newScrollState;\n\t\t\t\t\t\t\tvar scrollX = scrollState.x + dx;\n\t\t\t\t\t\t\tvar scrollY = scrollState.y + dy;\n\t\t\t\t\t\t\tif(targetView){\n\t\t\t\t\t\t\t\tscrollView(targetView, scrollX, scrollY);\n\t\t\t\t\t\t\t\tnewScrollState = getScrollState(targetView);\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tgantt.scrollTo(scrollX, scrollY);\n\t\t\t\t\t\t\t\tnewScrollState = gantt.getScrollState();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ((scrollState.x != newScrollState.x && dy > 2 * dx) ||\n\t\t\t\t\t\t\t\t(scrollState.y != newScrollState.y && dx > 2 * dy )) {\n\t\t\t\t\t\t\t\treturn block_action(e);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn block_action(e);\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}]);\n\n\t\t// prevent page drag on touch move\n\t\ttry{\n\t\t\tdocument.addEventListener('touchmove', function(e) {\n\t\t\t\tif (gantt._touch_drag) {\n\t\t\t\t\tblock_action(e);\n\t\t\t\t}\n\t\t\t}, { passive: false });\n\t\t}\n\t\tcatch(e){\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.warn(\"Cannot prevent touch event for the page drag\");\n\t\t}\n\n\t\t//block touch context menu in IE10\n\t\ttouchHandlers.push([this.$container, \"contextmenu\", function (e) {\n\t\t\tif (actionMode)\n\t\t\t\treturn block_action(e);\n\t\t}]);\n\n\t\t//touch start\n\t\ttouchHandlers.push([this.$container, names[1], function (e) {\n\t\t\tmultiTouchEvents = e.touches.length;\n\t\t\t// block pull-to-refresh\n\t\t\tif(document && document.body){\n\t\t\t\tdocument.body.classList.add(\"gantt_touch_active\");\n\t\t\t}\n\n\t\t\tif (ignore(e)) return;\n\t\t\tif (e.touches && e.touches.length > 1) {\n\t\t\t\tactionMode = false;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tactionStart = accessor(e);\n\t\t\ttargetView = findTargetView(actionStart);\n\t\t\tif (!gantt._locate_css(actionStart, \"gantt_hor_scroll\") && !gantt._locate_css(actionStart, \"gantt_ver_scroll\")) {\n\t\t\t\tactionMode = true;\n\t\t\t}\n\t\t\tvar tasksDnD = getTaskDND();\n\n\t\t\t//long tap\n\t\t\tlongTapTimer = setTimeout(function () {\n\t\t\t\tvar taskId = gantt.locate(actionStart);\n\t\t\t\tif (tasksDnD && (taskId && !gantt._locate_css(actionStart, \"gantt_link_control\") && !gantt._locate_css(actionStart, \"gantt_grid_data\"))) {\n\t\t\t\t\ttasksDnD.on_mouse_down(actionStart);\n\n\t\t\t\t\tif (tasksDnD.drag && tasksDnD.drag.start_drag) {\n\t\t\t\t\t\t// we need that as touch events break if the target node is removed from the DOM\n\t\t\t\t\t\tcloneTaskRendered(taskId);\n\t\t\t\t\t\ttasksDnD._start_dnd(actionStart);\n\t\t\t\t\t\tgantt._touch_drag = true;\n\n\t\t\t\t\t\tgantt.refreshTask(taskId);\n\n\t\t\t\t\t\tgantt._touch_feedback();\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tlongTapTimer = null;\n\t\t\t}, gantt.config.touch_drag);\n\t\t}]);\n\n\t\t//touch end\n\t\ttouchHandlers.push([this.$container, names[2], function (e) {\n\t\t\tif(document && document.body){\n\t\t\t\tdocument.body.classList.remove(\"gantt_touch_active\");\n\t\t\t}\n\t\t\tif (ignore(e)) return;\n\t\t\tif (longTapTimer) clearTimeout(longTapTimer);\n\t\t\tgantt._touch_drag = false;\n\t\t\tactionMode = false;\n\t\t\tvar source = accessor(e);\n\n\t\t\tvar tasksDnD = getTaskDND();\n\n\t\t\tif(tasksDnD)\n\t\t\t\ttasksDnD.on_mouse_up(source);\n\n\t\t\tif (currentDndId && gantt.isTaskExists(currentDndId)) {\n\t\t\t\tgantt.refreshTask(currentDndId);\n\t\t\t\tif(dndNodes.length){\n\t\t\t\t\tdndNodes.forEach(function(node){\n\t\t\t\t\t\tif(node.parentNode){\n\t\t\t\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tgantt._touch_feedback();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//gantt._touch_scroll_active = action_mode = scroll_mode = false;\n\t\t\tactionMode = scrollMode = false;\n\t\t\tdndNodes = [];\n\t\t\tcurrentDndId = null;\n\n\t\t\t//dbl-tap handling\n\t\t\tif (actionStart && dblclicktime) {\n\t\t\t\tvar now = new Date();\n\t\t\t\t// doubletap shouldn't happen with multitouch\n\t\t\t\tconst noMultitouch = multiTouchEvents <= 1;\n\t\t\t\t// double click events shouldn't fire when we quickly tap on different nodes\n\t\t\t\tconst sameTarget = previousActionStart && previousActionStart.target.innerHTML == actionStart.target.innerHTML;\n\t\t\t\tif ((now - dblclicktime) < 500 && noMultitouch && sameTarget) {\n\n\t\t\t\t\tvar mouseEvents = gantt.$services.getService(\"mouseEvents\");\n\t\t\t\t\tmouseEvents.onDoubleClick(actionStart);\n\t\t\t\t\tblock_action(e);\n\t\t\t\t} else {\n\t\t\t\t\tdblclicktime = now;\n\t\t\t\t\tpreviousActionStart = actionStart;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdblclicktime = new Date();\n\t\t\t}\n\t\t}]);\n\n\t\tfor(var i = 0; i < touchHandlers.length; i++){\n\t\t\tgantt.event(touchHandlers[i][0], touchHandlers[i][1], touchHandlers[i][2]);\n\t\t}\n\n\t\t//common helper, prevents event\n\t\tfunction block_action(e) {\n\t\t\tif (e && e.preventDefault && e.cancelable){\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\te.cancelBubble = true;\n\t\t\treturn false;\n\t\t}\n\n\t\tfunction cloneTaskRendered(taskId) {\n\t\t\tconst renders = gantt._getTaskLayers();\n\t\t\tlet task = gantt.getTask(taskId);\n\t\t\tif (task) {\n\t\t\t\tlet visible = gantt.isTaskVisible(taskId);\n\t\t\t\tif (visible){\n\t\t\t\t\tcurrentDndId = taskId;\n\t\t\t\t\tfor (let i = 0; i < renders.length; i++) {\n\t\t\t\t\t\ttask = renders[i].rendered[taskId];\n\t\t\t\t\t\tif (task && task.getAttribute(gantt.config.task_attribute) && task.getAttribute(gantt.config.task_attribute) == taskId) {\n\t\t\t\t\t\t\tconst copy = task.cloneNode(true);\n\t\t\t\t\t\t\tdndNodes.push(task);\n\t\t\t\t\t\t\trenders[i].rendered[taskId] = copy;\n\t\t\t\t\t\t\ttask.style.display = \"none\";\n\t\t\t\t\t\t\tcopy.className += \" gantt_drag_move \";\n\t\t\t\t\t\t\ttask.parentNode.appendChild(copy);\n\t\t\t\t\t\t\t//return copy;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (task.$split_subtask){\n\t\t\t\t\tlet renderedParent = task.$rendered_parent;\n\t\t\t\t\tvisible = gantt.isTaskVisible(renderedParent);\n\t\t\t\t\tif (!visible){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tcurrentDndId = taskId;\n\t\t\t\t\tfor (let i = 0; i < renders.length; i++) {\n\t\t\t\t\t\tconst parent = renders[i].rendered[renderedParent];\n\t\t\t\t\t\tlet taskNode;\n\t\t\t\t\t\tif (parent && parent.childNodes){\n\t\t\t\t\t\t\ttaskNode = parent.querySelector(`[${gantt.config.task_attribute}=\"${task.id}\"]`);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (taskNode) {\n\t\t\t\t\t\t\t// move the child node to a different parent as the task bar will be repainted\n\t\t\t\t\t\t\t// and the initial node will be lost\n\t\t\t\t\t\t\tconst copy = taskNode.cloneNode(true);\n\t\t\t\t\t\t\ttaskNode.parentNode.appendChild(copy);\n\n\t\t\t\t\t\t\tgantt.$task_bars.appendChild(taskNode);\n\t\t\t\t\t\t\ttaskNode.style.display = \"none\";\n\n\t\t\t\t\t\t\t// don't add the node as rendered otherwise it will be lost:\n\t\t\t\t\t\t\t// renders[i].rendered[taskId] = taskNode;\n\t\t\t\t\t\t\t// instead, add it to dndNodes as its elements will be removed after drag\n\t\t\t\t\t\t\tdndNodes.push(taskNode);\n\n\t\t\t\t\t\t\ttaskNode = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n};","function dummy() {\n\t// eslint-disable-next-line\n\tconsole.log(\"Method is not implemented.\"); \n}\nfunction BaseControl() {\n}\n\n// base methods will be runned in gantt context\nBaseControl.prototype.render = dummy; // arguments: sns\nBaseControl.prototype.set_value = dummy; // arguments: node, value, ev, sns(config)\nBaseControl.prototype.get_value = dummy; // arguments node, ev, sns(config)\nBaseControl.prototype.focus = dummy; // arguments: node\n\nexport default function(gantt) { // we could send current instance of gantt to module\n\treturn BaseControl;\n};","import * as helpers from \"../../../utils/helpers\";\n\nvar htmlHelpers = {\n\tgetHtmlSelect: function(options, attributes, value) {\n\t\tvar innerHTML = \"\";\n\t\tvar _this = this;\n\n\t\toptions = options || [];\n\t\t\n\t\thelpers.forEach(options, function(entry) {\n\t\t\tvar _attributes = [{ key: \"value\", value: entry.key }];\n\n\t\t\tif (value == entry.key) {\n\t\t\t\t_attributes[_attributes.length] = { key: \"selected\", value: \"selected\" };\n\t\t\t}\n\t\t\tif (entry.attributes) {\n\t\t\t\t_attributes = _attributes.concat(entry.attributes);\n\t\t\t}\n\t\t\tinnerHTML += _this.getHtmlOption({ innerHTML: entry.label }, _attributes);\n\t\t});\n\n\t\treturn _getHtmlContainer(\"select\", { innerHTML: innerHTML }, attributes);\n\t},\n\tgetHtmlOption: function(options, attributes) { return _getHtmlContainer(\"option\", options, attributes); },\n\tgetHtmlButton: function(options, attributes) { return _getHtmlContainer(\"button\", options, attributes); },\n\tgetHtmlDiv: function(options, attributes) { return _getHtmlContainer(\"div\", options, attributes); },\n\tgetHtmlLabel: function(options, attributes) { return _getHtmlContainer(\"label\", options, attributes); },\n\tgetHtmlInput: function(attributes) {\n\t\treturn \"<input\" + _getHtmlAttributes(attributes || []) + \">\";\n\t}\n};\n\nfunction _getHtmlContainer(tag, options, attributes) {\n\tvar html;\n\n\toptions = options || [];\n\t\n\thtml = \"<\" + tag + _getHtmlAttributes(attributes || []) + \">\" + (options.innerHTML || \"\") + \"</\" + tag +\">\";\n\treturn html;\n\n}\n\nfunction _getHtmlAttributes(attributes) {\n\tvar html = \"\";\n\n\thelpers.forEach(attributes, function(entry) {\n\t\thtml += \" \" + entry.key + \"='\" + entry.value + \"'\";\n\t});\n\treturn html;\n}\n\nexport default htmlHelpers;","import __extends from \"../../../../utils/extends\";\nimport htmlHelpers from \"../../utils/html_helpers\";\n\nimport Super from \"./base_control\";\n\nexport default function(gantt) {\n\tconst _super = Super(gantt);\n\n\tfunction SelectControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\t\n\t\treturn self; \n\t}\n\t\n\t__extends(SelectControl, _super);\n\t\n\tSelectControl.prototype.render = function(sns) {\n\t\tconst height = sns.height ? `height:${sns.height}px;` : '';\n\t\tlet html = `<div class='gantt_cal_ltext gantt_section_${sns.name}' ${height ? `style='${height}'` : ''}>`;\n\n\t\thtml += htmlHelpers.getHtmlSelect(sns.options, [{ key: \"style\", value: \"width:100%;\" }, { key: \"title\", value: sns.name }]);\n\t\thtml += \"</div>\";\n\t\treturn html;\n\t};\n\n\tSelectControl.prototype.set_value = function(node, value, ev, sns) {\n\t\tvar select = node.firstChild;\n\t\tif (!select._dhx_onchange && sns.onchange) {\n\t\t\tselect.onchange = sns.onchange;\n\t\t\tselect._dhx_onchange = true;\n\t\t}\n\t\tif (typeof value === \"undefined\")\n\t\t\tvalue = (select.options[0] || {}).value;\n\t\tselect.value = value || \"\";\n\t};\n\t\n\tSelectControl.prototype.get_value = function(node) {\n\t\treturn node.firstChild.value;\n\t};\n\t\n\tSelectControl.prototype.focus = function(node) {\n\t\tvar a = node.firstChild;\n\t\tgantt._focus(a, true);\n\t};\n\t\n\treturn SelectControl;\n};","export default class DurationFormatterNumeric implements IDurationFormatter {\n\tstatic create = (settings: IDurationFormatterConfig = null): IDurationFormatter => {\n\t\treturn new DurationFormatterNumeric();\n\t};\n\tcanParse = (value: string) : boolean => {\n\t\treturn !isNaN(this.parse(value));\n\t};\n\tformat = (value: number) : string => {\n\t\treturn String(value);\n\t};\n\tparse = (value: string) : number => {\n\t\treturn parseInt(value, 10);\n\t};\n}","import __extends from \"../../../../utils/extends\";\nimport SelectControl from \"./select_control\";\nexport default function(gantt) {\n\tvar _super = SelectControl(gantt);\n\n\tfunction ParentControl() {\n\t\tvar self = _super.apply(this, arguments) || this; \n\n\t\treturn self; \n\t}\n\n\t__extends(ParentControl, _super);\n\n\n\tParentControl.prototype.render = function(sns) {\n\t\treturn _display(sns, false);\n\t};\n\n\tParentControl.prototype.set_value = function(node, value, ev, config) {\n\t\t// GS-1051. If the value is `0`, the set_value function in the select control won't select \n\t\t// the first child because (0 || '') = '';\n\t\tif (value === 0) value = \"0\";\n\n\t\t// GS-1374. Usually, the ID is not specified,\n\t\t// we need to add it to keep the options and exclude the current task\n\t\tif (!ev.id && gantt.getState().lightbox) {\n\t\t\tev.id = gantt.getLightboxValues().id;\n\t\t}\n\n\t\tvar tmpDom = document.createElement(\"div\");\n\t\ttmpDom.innerHTML = _display(config, ev.id);\n\t\tvar newOptions = tmpDom.removeChild(tmpDom.firstChild);\n\t\tnode.onselect = null;\n\t\tnode.parentNode.replaceChild(newOptions, node);\n\n\t\treturn gantt.form_blocks.select.set_value.apply(gantt, [newOptions, value, ev, config]);\n\t};\n\n\tfunction _display(config, item_id) {\n\t\tvar tasks = [],\n\t\t\toptions = [];\n\t\tif (item_id) {\n\t\t\ttasks = gantt.getTaskByTime();\n\t\t\tif (config.allow_root) {\n\t\t\t\ttasks.unshift({id: gantt.config.root_id, text: config.root_label || \"\"});\n\t\t\t}\n\t\t\ttasks = _filter(tasks, config, item_id);\n\t\t\tif (config.sort) {\n\t\t\t\ttasks.sort(config.sort);\n\t\t\t}\n\t\t}\n\t\tvar text = config.template || gantt.templates.task_text;\n\t\tfor (var i = 0; i < tasks.length; i++) {\n\t\t\tvar label = text.apply(gantt, [tasks[i].start_date, tasks[i].end_date, tasks[i]]);\n\t\t\tif (label === undefined) {\n\t\t\t\tlabel = \"\";\n\t\t\t}\n\t\t\toptions.push({\n\t\t\t\tkey: tasks[i].id,\n\t\t\t\tlabel: label\n\t\t\t});\n\t\t}\n\t\tconfig.options = options;\n\t\tconfig.map_to = config.map_to || \"parent\";\n\t\treturn gantt.form_blocks.select.render.apply(this, arguments);\n\t}\n\n\tfunction _filter(options, config, item_id) {\n\t\tvar filter = config.filter || function() {\n\t\t\treturn true;\n\t\t};\n\n\t\toptions = options.slice(0);\n\n\t\tfor (var i = 0; i < options.length; i++) {\n\t\t\tvar task = options[i];\n\t\t\tif (task.id == item_id || gantt.isChildOf(task.id, item_id) || filter(task.id, task) === false) {\n\t\t\t\toptions.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t\treturn options;\n\t}\n\treturn ParentControl;\n};","import * as helpers from \"../../../../utils/helpers\";\nimport * as domHelpers from \"../../utils/dom_helpers\";\nimport htmlHelpers from \"../../utils/html_helpers\";\nimport __extends from \"../../../../utils/extends\";\n\nimport Super from \"./base_control\";\n\nexport default function(gantt) {\n\tconst _super = Super(gantt);\n\tvar localCache = {\n\t\tresources: {},\n\t\tresourcesValues: {},\n\t\tfilter: {},\n\t\teventsInitialized: {}\n\t};\n\n\tgantt.attachEvent(\"onAfterLightbox\", _clearCached);\n\n\tfunction ResourcesControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\n\t\treturn self;\n\t}\n\n\t__extends(ResourcesControl, _super);\n\n\tResourcesControl.prototype.render = function(sns) {\n\t\tif(!sns.options){\n\t\t\tsns.options = gantt.serverList(\"resourceOptions\");\n\t\t}\n\t\t\n\t\tif(!sns.map_to || sns.map_to == \"auto\"){\n\t\t\tsns.map_to = gantt.config.resource_property;\n\t\t}\n\t\tvar html;\n\t\tvar resourceFilterPlaceholder = gantt.locale.labels.resources_filter_placeholder || sns.filter_placeholder || \"type to filter\";\n\t\tvar resourceFilterLabel = gantt.locale.labels.resources_filter_label || \"hide empty\";\n\t\t// if set fixed height for this element, then resize of lightbox will be calculated improperly\n\t\thtml = \"<div\" + (!isNaN(sns.height) ? \" style='height: \" + sns.height + \"px;'\" : \"\") + \" class='gantt_section_\" + sns.name + \"'>\";\n\t\thtml += \"<div class='gantt_cal_ltext gantt_resources_filter'><input type='text' class='gantt_resources_filter_input' placeholder='\" + resourceFilterPlaceholder + \"'> <label><input class='switch_unsetted' type='checkbox'><span class='matherial_checkbox_icon'></span>\" + resourceFilterLabel + \"</label></div>\";\n\t\thtml += \"<div class='gantt_cal_ltext gantt_resources' data-name='\" + sns.name + \"'></div>\";\n\t\thtml += \"</div>\";\n\t\treturn html;\n\t};\n\n\tResourcesControl.prototype.set_value = function(node, value, ev, sns) {\n\t\tvar resourcesElement = _setResourcesElement(node, sns);\n\t\tvar htmlResourceRow = \"\";\n\t\tvar data;\n\n\t\t_setFilterCache(node, sns);\n\t\t_initEvents(node, ev, sns, this);\n\t\thelpers.forEach(sns.options, function(entry, index) {\n\t\t\tif (sns.unassigned_value == entry.key) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdata = _getDisplayValues(sns, value, entry);\n\n\t\t\thtmlResourceRow += [\n\t\t\t\t\"<label class='gantt_resource_row' data-item-id='\" + entry.key + \"' data-checked=\"+(data.value ? 'true' : 'false')+\">\",\n\t\t\t\t\"<input class='gantt_resource_toggle' type='checkbox'\", data.value ? \" checked='checked'\" : \"\", \"><div class='gantt_resource_cell gantt_resource_cell_checkbox'><span class='matherial_checkbox_icon'></span></div>\",\n\t\t\t\t\"<div class='gantt_resource_cell gantt_resource_cell_label'>\", entry.label, \"</div>\",\n\t\t\t\t\"<div class='gantt_resource_cell gantt_resource_cell_value'>\", _getAmountInput(entry, data.value, !data.value, data.id),\"</div>\",\n\t\t\t\t\"<div class='gantt_resource_cell gantt_resource_cell_unit'>\", entry.unit,\"</div>\",\n\t\t\t\t\"</label>\"\n\t\t\t].join(\"\");\n\t\t});\n\t\tresourcesElement.innerHTML = htmlResourceRow;\n\t\t// weird element sizes in ie11 when display empty resource list, use zoom to force repaint\n\t\tresourcesElement.style.zoom = \"1\";\n\t\tresourcesElement._offsetSizes = resourcesElement.offsetHeight;\n\t\tresourcesElement.style.zoom = \"\";\n\n\t\tgantt._center_lightbox(gantt.getLightbox());\n\t};\n\n\tResourcesControl.prototype.get_value = function(node, ev, sns) {\n\n\t\tvar amountElement = _getResourcesElement(sns);\n\t\tvar result = [];\n\t\tvar selectorAdd = _getInputElementSelector(true);\n\t\tvar selectorSub = _getInputElementSelector(false);\n\t\tvar filterCache = _getFilterCache(sns);\n\t\tvar settedValuesHash = gantt.copy(localCache.resourcesValues[sns.id]) || {};\n\n\t\tvar itemsAdd = amountElement.querySelectorAll(selectorAdd);\n\t\tvar itemsSub = amountElement.querySelectorAll(selectorSub);\n\n\t\tfor (var i = 0; i < itemsSub.length; i++) {\n\t\t\tdelete settedValuesHash[itemsSub[i].getAttribute(\"data-item-id\")];\n\t\t}\n\n\t\tfor (var i = 0; i < itemsAdd.length; i++) {\n\t\t\tvar originalId = itemsAdd[i].getAttribute(\"data-assignment-id\");\n\t\t\tvar resourceId = itemsAdd[i].getAttribute(\"data-item-id\");\n\t\t\tvar amount = itemsAdd[i].value.trim();\n\n\t\t\tif (amount !== \"\" && amount !== \"0\") {\n\t\t\t\tdelete settedValuesHash[resourceId];\n\t\t\t\tresult[result.length] = { resource_id: resourceId, value: amount };\n\t\t\t\tif (originalId){\n\t\t\t\t\tresult[result.length - 1] = { ...result[result.length - 1], id: originalId };\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (filterCache.filterApplied) {\n\t\t\tfor (var item in settedValuesHash) {\n\t\t\t\tresult[result.length] = { resource_id: item, value: settedValuesHash[item].value, id: settedValuesHash[item].id };\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t};\n\n\tResourcesControl.prototype.focus = function(node) {\n\t\tgantt._focus(node.querySelector(\".gantt_resources\"));\n\t};\n\n\tfunction _getAmountInput(item, value, disabled, assignmentId) {\n\t\tvar _attributes;\n\t\tvar innerHTML = \"\";\n\n\t\tif (!item) return;\n\n\t\t_attributes = [{ key: \"data-item-id\", value: item.key }, { key: \"data-assignment-id\", value: assignmentId || \"\"}, { key: \"class\", value: \"gantt_resource_amount_input\"}];\n\t\tif (disabled) {\n\t\t\t_attributes.push({ key: \"disabled\", value: \"disabled\" });\n\t\t}\n\n\t\tif (item.options) {\n\t\t\tinnerHTML += htmlHelpers.getHtmlSelect(item.options, _attributes, value);\n\t\t} else {\n\t\t\t_attributes[_attributes.length] = { key: \"value\", value: value || \"\" };\n\t\t\tinnerHTML += htmlHelpers.getHtmlInput(_attributes);\n\t\t}\n\t\treturn innerHTML;\n\t}\n\n\tfunction _getValue(el) {\n\t\treturn el.value.trim();\n\t}\n\n\tfunction _initEvents(node, ev, sns, context) {\n\t\tif (localCache.eventsInitialized[sns.id]) return;\n\n\t\tvar _applyFilter = function(e) {\n\t\t\t_saveValues(sns, node);\n\t\t\tvar resultSns;\n\t\t\tvar query;\n\t\t\tvar hideUnsetted;\n\t\t\tvar input;\n\t\t\tvar checkbox;\n\t\t\tvar filterCache = _getFilterCache(sns);\n\n\t\t\tcheckbox = filterCache.checkbox;\n\t\t\tinput = filterCache.input;\n\n\t\t\thideUnsetted = checkbox.checked;\n\t\t\tquery = _getValue(input);\n\t\t\tfilterCache.filterApplied = !!query;\n\t\t\tif (gantt.getState().lightbox) {\n\t\t\t\tev = gantt.getLightboxValues();\n\t\t\t}\n\t\t\tresultSns = _getSnsToHideUnsetted(sns, ev, query, hideUnsetted);\n\t\t\tvar value = ev[sns.map_to];\n\t\t\tcontext.form_blocks.resources.set_value(node, value, ev, resultSns);\n\t\t};\n\n\t\tfunction _resourceChangeListener(e) {\n\t\t\tvar target = e.target;\n\t\t\tvar parent;\n\t\t\tvar input;\n\n\t\t\tif (e.target.type === \"checkbox\") {\n\t\t\t\tparent = target.parentNode;\n\t\t\t\tinput = parent.querySelector(_getInputElementSelector());\n\t\t\t\tinput.disabled = !target.checked;\n\t\t\t\tvar itemId = input.getAttribute(\"data-item-id\");\n\t\t\t\tvar row = domHelpers.locateClassName(e, \"gantt_resource_row\");\n\t\t\t\tvar valueInput = row.querySelector(\".gantt_resource_amount_input\");\n\t\t\t\trow.setAttribute(\"data-checked\", target.checked);\n\t\t\t\tif (target.checked) {\n\t\t\t\t\tif (input.nodeName.toLowerCase() === \"select\") {\n\t\t\t\t\t\tgantt.callEvent(\"onResourcesSelectActivated\", [{ target: input }]);\n\t\t\t\t\t}\n\n\t\t\t\t\tvar resId = itemId;\n\t\t\t\t\tvar defaultValue = sns.default_value;\n\t\t\t\t\tsns.options.forEach(function(option){\n\t\t\t\t\t\tif(option.key == resId && option.default_value){\n\t\t\t\t\t\t\tdefaultValue = option.default_value;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tif(valueInput && !valueInput.value && defaultValue !== undefined){\n\t\t\t\t\t\tvalueInput.value = defaultValue;\n\t\t\t\t\t\t_saveValues(sns, this);\n\t\t\t\t\t}\n\n\t\t\t\t\tif(valueInput.select) {\n\t\t\t\t\t\tvalueInput.select();\n\t\t\t\t\t}else if(valueInput.focus){\n\t\t\t\t\t\tvalueInput.focus();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\n\t\t\t\t\tif (localCache.resourcesValues[sns.id]) {\n\t\t\t\t\t\tdelete localCache.resourcesValues[sns.id][itemId];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (e.target.type === \"text\" || e.target.nodeName.toLowerCase() === \"select\") {\n\t\t\t\tparent = target.parentNode.parentNode;\n\n\t\t\t\tinput = e.target;\n\t\t\t\t_saveValues(sns, this);\n\t\t\t}\n\t\t}\n\t\t\n\n\t\tfunction _saveValues(sns, domElement) {\n\t\t\tvar selector = _getInputElementSelector();\n\t\t\tvar inputs = domElement.querySelectorAll(selector);\n\n\t\t\tlocalCache.resourcesValues[sns.id] = localCache.resourcesValues[sns.id] || {};\n\n\t\t\tfor (var i = 0; i < inputs.length; i++) {\n\t\t\t\tvar key = inputs[i].getAttribute(\"data-item-id\");\n\t\t\t\tvar originalAssignmentId = inputs[i].getAttribute(\"data-assignment-id\");\n\t\t\t\tif (!inputs[i].disabled) {\n\t\t\t\t\tlocalCache.resourcesValues[sns.id][key] = {value: inputs[i].value, id: originalAssignmentId};\n\t\t\t\t} else {\n\t\t\t\t\tdelete localCache.resourcesValues[sns.id][key];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t_applyFilter = helpers.throttle(_applyFilter, 100);\n\n\t\t_getFilterCache(sns).container.addEventListener(\"keyup\", _applyFilter);\n\t\t_getFilterCache(sns).container.addEventListener(\"input\", _applyFilter, true);\n\t\t_getFilterCache(sns).container.addEventListener(\"change\", _applyFilter, true);\n\t\t_getResourcesElement(sns).addEventListener(\"input\", _resourceChangeListener);\n\t\t_getResourcesElement(sns).addEventListener(\"change\", _resourceChangeListener);\n\t\tgantt.attachEvent(\"onResourcesSelectActivated\", gantt.bind(_resourceChangeListener, _getResourcesElement(sns)));\n\t\tlocalCache.eventsInitialized[sns.id] = true;\n\t}\n\n\tfunction _getSnsToHideUnsetted(controlConfig, task, query, hideUnsetted) {\n\t\tvar comparison;\n\t\tvar resultConfig;\n\n\t\tif (!hideUnsetted) {\n\t\t\tif (query === \"\") {// show all\n\t\t\t\treturn controlConfig;\n\t\t\t}\n\n\t\t\tcomparison = function(entry) {// show matching labels only\n\t\t\t\tif (entry.label.toLowerCase().indexOf(query.toLowerCase()) >= 0) {\n\t\t\t\t\treturn entry;\n\t\t\t\t}\n\t\t\t};\n\t\t} else {\n\t\t\tvar collection = task[controlConfig.map_to] || [];\n\n\t\t\tif (!helpers.isArray(collection)) {\n\t\t\t\tcollection = [collection];\n\t\t\t}\n\n\t\t\t// copy section array in order not to modify ev[sns.map_to]\n\t\t\tcollection = collection.slice();\n\n\t\t\tif (collection.length === 0) {//nothing setted\n\t\t\t\tcollection = [];\n\t\t\t\tresultConfig = gantt.copy(controlConfig);\n\t\t\t\tresultConfig.options = [];\n\t\t\t\tfor (var key in localCache.resourcesValues[controlConfig.id]) {\n\t\t\t\t\tvar cachedValue = localCache.resourcesValues[controlConfig.id][key];\n\t\t\t\t\tif (cachedValue.value !== \"\") {\n\t\t\t\t\t\tcollection.push({resource_id: key, value: cachedValue.value, id: cachedValue.id});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (collection.length === 0) {\n\t\t\t\t\treturn resultConfig;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor (var key in localCache.resourcesValues[controlConfig.id]) {\n\t\t\t\t\tvar cachedValue = localCache.resourcesValues[controlConfig.id][key];\n\t\t\t\t\tif (cachedValue.value !== \"\") {\n\t\t\t\t\t\tvar searchResult = helpers.arrayFind(collection, function(entry) {\n\t\t\t\t\t\t\treturn entry.id == key;\n\t\t\t\t\t\t});\n\t\n\t\t\t\t\t\tif (!searchResult) {\n\t\t\t\t\t\t\tcollection.push({resource_id: key, value: cachedValue.value, id: cachedValue.id});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar itemIds = {};\n\n\t\t\tfor (var i=0; i < collection.length; i++) {\n\t\t\t\titemIds[collection[i].resource_id] = true;\n\t\t\t}\n\t\t\tcomparison = function(entry) {//show setted and filtered if field is filled\n\t\t\t\tif (itemIds[String(entry.key)] && (query === \"\" || entry.label.toLowerCase().indexOf(query.toLowerCase()) >= 0)) {\n\t\t\t\t\treturn entry;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\tresultConfig = gantt.copy(controlConfig);\n\t\tresultConfig.options = helpers.arrayFilter(resultConfig.options, comparison);\n\t\treturn resultConfig;\n\t}\n\n\tfunction _getInputElementSelector(isChecked) {\n\t\tif(isChecked === undefined){\n\t\t\treturn \".gantt_resource_amount_input\";\n\t\t}else{\n\t\t\treturn \"[data-checked='\"+(isChecked ? \"true\" : \"false\") + \"'] .gantt_resource_amount_input\";\n\t\t}\n\t}\n\n\tfunction _setResourcesElement(node, sns) {\n\t\tif (!localCache.resources[sns.id]) {\n\t\t\tlocalCache.resources[sns.id] = node.querySelector(\".gantt_resources\");\n\t\t}\n\t\treturn localCache.resources[sns.id];\n\t}\n\n\tfunction _getResourcesElement(sns) {\n\t\treturn localCache.resources[sns.id];\n\t}\n\n\tfunction _setFilterCache(node, sns) {\n\t\tif (!localCache.filter[sns.id]) {\n\t\t\tvar container = node.querySelector(\".gantt_resources_filter\");\n\t\t\tvar input = container.querySelector(\".gantt_resources_filter_input\");\n\t\t\tvar checkbox = container.querySelector(\".switch_unsetted\");\n\n\t\t\tlocalCache.filter[sns.id] = {\n\t\t\t\tcontainer: container,\n\t\t\t\tinput: input,\n\t\t\t\tcheckbox: checkbox,\n\t\t\t\tfilterApplied: false\n\t\t\t};\n\t\t}\n\t\treturn localCache.filter[sns.id];\n\t}\n\n\tfunction _getFilterCache(sns) {\n\t\treturn localCache.filter[sns.id];\n\t}\n\n\tfunction _clearCached() {\n\t\tfor (var key in localCache.filter) {\n\t\t\tlocalCache.filter[key].checkbox.checked = false;\n\t\t\tlocalCache.filter[key].input.value = \"\";\n\t\t\tlocalCache.filter[key].filterApplied = false;\n\t\t}\n\t\tlocalCache.resourcesValues = {};\n\t}\n\n\tfunction _getDisplayValues(sns, value, option) {\n\t\tvar data = {};\n\n\t\tif (value) {\n\t\t\tvar searchResult;\n\n\t\t\tif (helpers.isArray(value)) {\n\t\t\t\tsearchResult = helpers.arrayFind(value, function(val) {\n\t\t\t\t\treturn (val.resource_id == option.key);\n\t\t\t\t});\n\t\t\t} else if (value.resource_id == option.key) {\n\t\t\t\tsearchResult = value;\n\t\t\t}\n\n\t\t\tif (searchResult) {\n\t\t\t\tdata.value = searchResult.value;\n\t\t\t\tdata.id = searchResult.id;\n\t\t\t}\n\t\t}\n\t\tif (localCache.resourcesValues[sns.id] && localCache.resourcesValues[sns.id][option.key]) {\n\t\t\tdata.value = localCache.resourcesValues[sns.id][option.key].value;\n\t\t\tdata.id = localCache.resourcesValues[sns.id][option.key].id;\n\t\t}\n\t\treturn data;\n\t}\n\n\treturn ResourcesControl;\n};","\nimport * as helpers from \"../../../../utils/helpers\";\nimport __extends from \"../../../../utils/extends\";\nimport Super from \"./base_control\";\n\nexport default function(gantt) {\n\tconst _super = Super(gantt);\n\n\tconst localCache = {\n\t\tresources: {},\n\t\tresourcesValues: {},\n\t\tfilter: {},\n\t\teventsInitialized: {},\n\t\tgridID: null,\n\t\tresource_filter_value: null,\n\t\tinitialValues: [],\n\t\tnewValues: []\n\t};\n\n\tconst selectResEditor = { type: \"select\", map_to: \"resource_id\" , options: gantt.serverList(\"resourceOptions\")};\n\tconst numberEditor = { type: \"number\", map_to: \"value\", min: 0, max: 100 };\n\n\tconst dateToStr = gantt.date.date_to_str(\"%d-%m-%Y\");\n\n\tgantt.resource_table = {\n\t\tscale_height: 35,\n\t\trow_height: 35,\n\t\tcolumns: [\n\t\t\t{\n\t\t\t\tname: \"resource\", label: \"Resource\", align: \"center\", width: 80, editor: selectResEditor, template: function (assignment) {\n\t\t\t\t\tlet defaultValue = \"Unassigned\";\n\t\t\t\t\tconst resource = gantt.getDatastore(gantt.config.resource_store).getItem(assignment.resource_id);\n\t\t\t\t\treturn resource ? resource.text : defaultValue;\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"hours/Day\", label: \"Hours/Day\", align: \"center\", width: 70, editor: numberEditor, template: function (assignment) {\n\t\t\t\t\treturn assignment.value ? +assignment.value : ``;\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"start\", label: \"Start\", align: \"center\", width: 100, template: function (assignment) {\n\t\t\t\t\treturn assignment.start_date ? dateToStr(assignment.start_date) : ``;\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"end\", label: \"End\", align: \"center\", width: 100, template: function (assignment) {\n\t\t\t\t\treturn assignment.end_date ? dateToStr(assignment.end_date) : ``;\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"duration\", label: \"Duration\", align: \"center\", width: 80, template: function (assignment) {\n\t\t\t\t\tif (assignment.duration) {\n\t\t\t\t\t\treturn `${assignment.duration} day${assignment.duration == 1 ? '' : 's'}`;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn ``;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"delete\", label: \"Delete\", align: \"center\", width: 80, template: function (assignment) {\n\t\t\t\t\treturn `<div data-assignment-id='${assignment.id}' data-assignment-delete='${assignment.id}' class='dhx_gantt_icon dhx_gantt_icon_delete'></div>`;\n\t\t\t\t}\n\t\t\t}\n\t\t],\n\t\tresource_default_assignment: {\n\t\t\tduration: null,\n\t\t\tvalue: 8,\n\t\t\tstart_date: null,\n\t\t\tend_date: null,\n\t\t\tmode: \"default\"\n\t\t}\n\t};\n\n\tgantt.attachEvent(\"onAfterLightbox\", _clearCached);\n\n\tfunction newResourcesControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\n\t\treturn self;\n\t}\n\n\t__extends(newResourcesControl, _super);\n\n\tfunction _generateResourceInputSection(index, name) {\n\t\tconst resourceFilterPlaceholder = gantt.locale.labels.resources_filter_placeholder || \"Search...\";\n\t\tconst html = `<div class='gantt_resource_selector_filter_wrapper gantt_cal_lsection' data-section-name='${name}'>\n\t\t\t\t\t\t<div class='gantt_cal_ltext gantt_resources_filter'>\n\t\t\t\t\t\t\t<label class=\"dhx_gantt_icon dhx_gantt_icon_search\">\n\t\t\t\t\t\t\t\t<input type='text' class='gantt_resources_filter_input' placeholder='${resourceFilterPlaceholder}' tab-index=\"-1\"> \n\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div role='button' aria-label='Add Assignment' class='gantt_custom_button gantt_add_resources' data-index='${index}'><div class='gantt_custom_button_add_resources gantt_add'></div><div class='gantt_custom_button_label'>${gantt.locale.labels.resources_add_button}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>`;\n\t\treturn html;\n\t}\n\n\n\tfunction _generateResourceTable(node, assignments, task, sns) {\n\t\t// destroy grid if it exists\n\t\tif(gantt.$ui.getView(\"GridRL\") && !localCache.gridID){\n\t\t\tgantt.$ui.getView(\"GridRL\").destructor();\n\t\t}\n\n\t\tif (!localCache.gridID) {\n\t\t\t// temp store for assignments in the lightbox\n\t\t\tconst resourceTable = document.createElement(\"div\");\n\t\t\tresourceTable.classList.add(\"gantt_resource_selector_grid\");\n\t\t\tconst tempAssignmentStore = gantt.createDatastore({\n\t\t\t\tname: \"temp_resource_assignment_store\",\n\t\t\t\tinitItem: function (item) {\n\t\t\t\t\tif (!item.id) {\n\t\t\t\t\t\titem.id = gantt.uid();\n\t\t\t\t\t}\n\t\t\t\t\treturn item;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tgantt.$data.tempAssignmentsStore = tempAssignmentStore; // link to gantt\n\t\t\tconst gridConfig = {...gantt.config.layout, id: \"GridRL\", sectionName: sns.name };\n\t\t\tconst grid = gantt.$ui.createView(\"GridRL\", gantt.$root, gridConfig);  // creating grid\n\t\t\tgrid.init(resourceTable); // init grid\n\t\t\tconst width = gantt._lightbox.offsetWidth - (gantt.config.wide_form ? 150 : 0); \n\t\t\tgrid.setSize(width, \"auto\"); // set width and height of the grid\n\t\t\tgantt.ext.inlineEditorsLightbox = gantt.ext._inlineEditors.createEditors(grid); //attach inline editors\n\t\t\tgantt.ext.inlineEditorsLightbox.init();\n\t\t\tlocalCache.gridID = grid.$id;\n\t\t\tnode.appendChild(resourceTable);\n\t\t\tconst resourceAssignmentsStore = gantt.getDatastore(gantt.config.resource_assignment_store);  // main store\n\t\t\tconst searchItems = [];\n\t\t\tresourceAssignmentsStore.eachItem(function(item){\n\t\t\t\tif(item.task_id && item.task_id == task.id){\n\t\t\t\t\tsearchItems.push(item);\n\t\t\t\t}\n\t\t\t});\n\t\t\tconst clonedAssignments = structuredClone(searchItems); // clone\n\t\t\ttempAssignmentStore.parse(clonedAssignments); // add all assignments from main to temp\n\t\t}\n\n\t\tgantt.$data.tempAssignmentsStore.attachEvent(\"onFilterItem\", function(id, assignment) {\n\t\t\tif (assignment.task_id == task.id){\n\t\t\t\tif (!localCache.resource_filter_value) {\n\t\t\t\t\treturn true;\n\t\t\t\t} else {\n\t\t\t\t\tlet resource = gantt.getDatastore(gantt.config.resource_store).getItem(assignment.resource_id);\n\t\t\t\t\tif (resource.text.toLowerCase().indexOf(localCache.resource_filter_value) > -1) return true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\t\tgantt.refreshData();\n\t}\n\n\tfunction _generateAssignmentDefaultRow(sectionName) {\n\t\tlet resource_id;\n\t\tconst task = gantt.getTask(gantt._lightbox_id);\n\t\tconst assignments = gantt.getTaskAssignments(task.id);\n\t\tif(assignments.length){\n\t\t\tresource_id = assignments[0].resource_id;\n\t\t} else {\n\t\t\tconst resources = gantt.serverList(\"resourceOptions\");\n\t\t\tif(resources.length){\n\t\t\t\tresource_id = resources[0].id;\n\t\t\t} else {\n\t\t\t\tthrow new Error(`There is no any resources in resource store, please check your data:\n\t\t\t\t\thttps://docs.dhtmlx.com/gantt/desktop__resource_management.html#assigningresources`);\n\t\t\t}\n\t\t}\n\n\t\tconst tempAssignmentStore = gantt.getDatastore(\"temp_resource_assignment_store\");\n\t\tconst lightboxSection = gantt.getLightboxSection(sectionName).section;\n\t\tconst resourceConfig = lightboxSection.config ?? gantt.resource_table;\n\t\tconst config = resourceConfig.resource_default_assignment ?? gantt.resource_table.resource_default_assignment;\n\n\t\ttempAssignmentStore.addItem({\n\t\t\tresource_id,\n\t\t\ttask_id: task.id,\n\t\t\tduration: config.duration ?? gantt.calculateDuration(task),\n\t\t\tvalue: config.value,\n\t\t\tstart_date: config.start_date ?? task.start_date,\n\t\t\tend_date: config.end_date ?? task.end_date,\n\t\t\tmode: config.mode\n\t\t});\n\t\tgantt.refreshData();\n\t}\n\n\tfunction _setFocus(container){\n\t\tconst resourceRows = container.querySelectorAll(\".gantt_row.gantt_row_task\");\n\t\tif(resourceRows){\n\t\t\tconst lastRow = resourceRows[resourceRows.length -1];\n\t\t\tconst resourceCell = lastRow.querySelector(\".gantt_cell\");\n\t\t\tif(resourceCell){\n\t\t\t\tconst {id, columnName} = gantt.ext.inlineEditorsLightbox.locateCell(resourceCell);\n\t\t\t\tif(id && columnName){\n\t\t\t\t\tgantt.ext.inlineEditorsLightbox.startEdit(id, columnName);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tnewResourcesControl.prototype.render = function(sns) {\n\t\tif(!sns.options){\n\t\t\tsns.options = gantt.serverList(\"resourceOptions\");\n\t\t}\n\n\t\tif(!sns.map_to || sns.map_to == \"resource_selector\" || sns.map_to == \"auto\"){\n\t\t\tsns.map_to = gantt.config.resource_property;\n\t\t}\n\n\t\tlet html;\n\t\t// if set fixed height for this element, then resize of lightbox will be calculated improperly\n\t\thtml = `<div${!isNaN(sns.height) ? \" style='height:auto;'\" : \"\"} class='gantt_section_${sns.name}' data-section-name='${sns.name}'>`;\n\t\thtml += _generateResourceInputSection(sns.index, sns.name);\n\t\thtml += `</div>`;\n\t\thtml += `<div class=\"resources_section_placeholder\" style='display:none;'>${gantt.locale.labels.resources_section_placeholder}</div>`;\n\t\treturn html;\n\t};\n\n\tnewResourcesControl.prototype.button_click = function (index, el, section, container) {\n\t\tconst sectionName = section.getAttribute(\"data-section-name\") || container.getAttribute(\"data-section-name\");\n\t\tconst firstAddBtn = document.querySelector(\"[data-resource-selector-section]\");\n\t\tconst placeholder = document.querySelector(\".resources_section_placeholder\");\n\t\tconst resourceSection = document.querySelector(`.gantt_section_${sectionName} .gantt_resource_selector_filter_wrapper`);\n\t\tconst resourceGrid = document.querySelector(`.gantt_section_${sectionName} .gantt_grid`);\n\t\tfirstAddBtn.style.display = \"none\";\n\n\t\tif (gantt.callEvent(\"onSectionButton\", [gantt._lightbox_id, section]) === false) {\n\t\t\treturn;\n\t\t}\n\t\tif (el.closest(\".gantt_custom_button.gantt_add_resources\")){\n\t\t\tplaceholder.style.display = \"none\";\n\t\t\tconst tempAssignmentStore = gantt.getDatastore(\"temp_resource_assignment_store\");\n\n\t\t\tif(tempAssignmentStore && tempAssignmentStore.getItems().length == 0){\n\t\t\t\tresourceSection.style.display = \"flex\";\n\t\t\t\tresourceGrid.style.display = \"block\";\n\t\t\t}\n\n\t\t\t_generateAssignmentDefaultRow(sectionName);\n\t\t\t_setFocus(container);\n\t\t}\n\t};\n\n\tfunction setInitialValues(task){\n\t\tlocalCache.initialValues = [];\n\t\tlocalCache.newValues = [];\n\t\tconst assignmentStore = gantt.$data.assignmentsStore;\n\t\tconst storeAssignments = assignmentStore.find(function (a) {\n\t\t\treturn a.task_id == task.id;\n\t\t});\n\t\tfor (let i = 0; i < storeAssignments.length; i++) {\n\t\t\tlocalCache.initialValues[i] = { resource_id: storeAssignments[i].resource_id, value: storeAssignments[i].value, id: storeAssignments[i].id };\n\t\t}\n\t}\n\n\tnewResourcesControl.prototype.set_value = function(node, assignments, task, sns, initialized) {\n\t\tlet firstAddBtn = document.querySelector(\"[data-resource-selector-section]\");\n\t\tlet placeholder = document.querySelector(\".resources_section_placeholder\");\n\t\tsetInitialValues(task);\n\t\tif(!initialized){\n\t\t\t\t_generateResourceTable(node, assignments, task, sns);\n\t\t\t\t_setFilterCache(node, sns);\n\t\t\t\t_initEvents(node, assignments, sns, this);\n\t\t\t\tfirstAddBtn.style.display = \"none\";\n\t\t\t\tlet resourceGrid = document.querySelector(`.gantt_section_${sns.name} .gantt_grid`);\n\t\t\t\tlet resourceSection = document.querySelector(`.gantt_section_${sns.name} .gantt_resource_selector_filter_wrapper`);\n\t\t\t\tresourceGrid.style.display = \"none\";\n\t\t\t\tresourceSection.style.display = \"none\";\n\t\t}\n\t\tconst tempAssignmentStore = gantt.getDatastore(\"temp_resource_assignment_store\");\n\t\tif(tempAssignmentStore) {\n\t\t\tlet resourceSection = document.querySelector(`.gantt_section_${sns.name} .gantt_resource_selector_filter_wrapper`);\n\t\t\tlet resourceGrid = document.querySelector(`.gantt_section_${sns.name} .gantt_grid`);\n\n\t\t\tif(tempAssignmentStore.getItems().length == 0){\n\t\t\t\tif(firstAddBtn.style.display == \"none\"){\n\t\t\t\t\tfirstAddBtn.style.display = \"flex\";\n\t\t\t\t}\n\n\t\t\t\tresourceSection.style.display = \"none\";\n\t\t\t\tresourceGrid.style.display = \"none\";\n\t\t\t\tplaceholder.style.display = \"block\";\n\t\t\t} else {\n\t\t\t\tresourceSection.style.display = \"flex\";\n\t\t\t\tresourceGrid.style.display = \"block\";\n\t\t\t\tplaceholder.style.display = \"none\";\n\t\t\t}\n\t\t}\n\n\t\tgantt._center_lightbox(gantt.getLightbox());\n\t};\n\n\tnewResourcesControl.prototype.get_value = function(node, task, sns, type) {\n\t\tconst tempAssignmentStore = gantt.getDatastore(\"temp_resource_assignment_store\");\n\t\tconst storeAssignments = tempAssignmentStore.find(function (a) {\n\t\t\treturn a.task_id == task.id;\n\t\t});\n\t\tfor (let i = 0; i < storeAssignments.length; i++) {\n\t\t\tlocalCache.newValues[i] = { \n\t\t\t\tresource_id: storeAssignments[i].resource_id.toString(), \n\t\t\t\tvalue: storeAssignments[i].value, \n\t\t\t\tid: storeAssignments[i].id, \n\t\t\t\tstart_date: storeAssignments[i].start_date,\n\t\t\t\tend_date: storeAssignments[i].end_date,\n\t\t\t\tduration: storeAssignments[i].duration,\n\t\t\t\tmode: storeAssignments[i].mode,\n\t\t\t\tdelay: storeAssignments[i].delay\n\t\t\t};\n\t\t}\n\n\t\tif (type == \"save\"){\n\t\t\treturn localCache.newValues;\n\t\t} else {\n\t\t\treturn localCache.initialValues;\n\t\t}\n\t};\n\n\tfunction getVisibleResources(task, options){\n\t\tlet visibleResources = [];\n\t\tconst tempAssignmentStore = gantt.getDatastore(\"temp_resource_assignment_store\");\n\t\tconst currentAssignments = tempAssignmentStore.find(function (a) {\n\t\t\treturn a.task_id == task.id;\n\t\t});\n\t\tfor (let i = 0; i < currentAssignments.length; i++) {\n\t\t\tlet resource = gantt.getDatastore(gantt.config.resource_store).getItem(currentAssignments[i].resource_id);\n\t\t\tif(resource){\n\t\t\t\tvisibleResources.push(resource);\n\t\t\t}\n\t\t}\n\t\treturn visibleResources;\n\t}\n\n\tfunction _getValue(el) {\n\t\treturn el.value.trim();\n\t}\n\n\tfunction _initEvents(node, ev, sns, context) {\n\t\tif (localCache.eventsInitialized[sns.id]) return;\n\n\t\tvar _applyFilter = function(e) {\n\t\t\t_saveValues(sns, node);\n\t\t\tvar resultSns;\n\t\t\tvar query;\n\t\t\tvar input;\n\t\t\tvar filterCache = _getFilterCache(sns);\n\t\t\tinput = filterCache.input;\n\n\t\t\tquery = _getValue(input);\n\t\t\tlocalCache.resource_filter_value = query.toLowerCase();\n\t\t\tfilterCache.filterApplied = !!query;\n\t\t\tif (gantt.getState().lightbox) {\n\t\t\t\tev = gantt.getLightboxValues();\n\t\t\t}\n\t\t\tresultSns = _getSnsToHideUnsetted(sns, ev, query);\n\t\t\tvar value = ev[sns.map_to];\n\t\t\tcontext.form_blocks.resource_selector.set_value(node, value, ev, resultSns);\n\t\t};\n\n\t\tfunction _saveValues(sns, domElement) {\n\t\t\tvar selector = _getInputElementSelector();\n\t\t\tvar inputs = domElement.querySelectorAll(selector);\n\n\t\t\tlocalCache.resourcesValues[sns.id] = localCache.resourcesValues[sns.id] || {};\n\n\t\t\tfor (var i = 0; i < inputs.length; i++) {\n\t\t\t\tvar key = inputs[i].getAttribute(\"data-item-id\");\n\t\t\t\tvar originalAssignmentId = inputs[i].getAttribute(\"data-assignment-id\");\n\t\t\t\tif (!inputs[i].disabled) {\n\t\t\t\t\tlocalCache.resourcesValues[sns.id][key] = {value: inputs[i].value, id: originalAssignmentId};\n\t\t\t\t} else {\n\t\t\t\t\tdelete localCache.resourcesValues[sns.id][key];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t_applyFilter = helpers.throttle(_applyFilter, 100);\n\n\t\t_getFilterCache(sns).container.addEventListener(\"keyup\", _applyFilter);\n\t\t_getFilterCache(sns).container.addEventListener(\"input\", _applyFilter, true);\n\t\t_getFilterCache(sns).container.addEventListener(\"change\", _applyFilter, true);\n\t\tlocalCache.eventsInitialized[sns.id] = true;\n\t}\n\n\tfunction _getSnsToHideUnsetted(controlConfig, task, query, hideUnsetted) {\n\t\tvar comparison;\n\t\tvar resultConfig = gantt.copy(controlConfig);\n\n\t\tif (query === \"\") {// show all\n\t\t\tresultConfig.resources = [];\n\t\t\tlet resourceIds = localCache.newValues.map(obj => {\n\t\t\t\treturn obj.resource_id;\n\t\t\t});\n\t\t\tif(resourceIds && resourceIds.length > 0){\n\t\t\t\tfor (let i = 0; i < resourceIds.length; i++) {\n\t\t\t\t\tlet resource = gantt.getDatastore(gantt.config.resource_store).getItem(resourceIds[i]);\n\t\t\t\t\tif(resource){\n\t\t\t\t\t\tresultConfig.resources.push(resource);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn resultConfig;\n\t\t}\n\n\t\tcomparison = function(entry) {// show matching labels only\n\t\t\tif (entry.text.toLowerCase().indexOf(query.toLowerCase()) >= 0) {\n\t\t\t\treturn entry;\n\t\t\t}\n\t\t};\n\n\t\tresultConfig.resources = getVisibleResources(task, controlConfig.options);\n\t\tresultConfig.resources = helpers.arrayFilter(resultConfig.resources, comparison);\n\t\treturn resultConfig;\n\t}\n\n\tfunction _getInputElementSelector(isChecked) {\n\t\tif(isChecked === undefined){\n\t\t\treturn \".gantt_resource_amount_input\";\n\t\t}else{\n\t\t\treturn \"[data-checked='\"+(isChecked ? \"true\" : \"false\") + \"'] .gantt_resource_amount_input\";\n\t\t}\n\t}\n\n\tfunction _setFilterCache(node, sns) {\n\t\tif (!localCache.filter[sns.id]) {\n\t\t\tvar container = node.querySelector(\".gantt_resources_filter\");\n\t\t\tvar input = container.querySelector(\".gantt_resources_filter_input\");\n\n\t\t\tlocalCache.filter[sns.id] = {\n\t\t\t\tcontainer: container,\n\t\t\t\tinput: input,\n\t\t\t\tfilterApplied: false\n\t\t\t};\n\t\t}\n\t\treturn localCache.filter[sns.id];\n\t}\n\n\tfunction _getFilterCache(sns) {\n\t\treturn localCache.filter[sns.id];\n\t}\n\n\tfunction _clearCached() {\n\t\tfor (var key in localCache.filter) {\n\t\t\tlocalCache.filter[key].input.value = \"\";\n\t\t\tlocalCache.filter[key].filterApplied = false;\n\t\t}\n\t\tlocalCache.resourcesValues = {};\n\t\tlocalCache.eventsInitialized = {};\n\t\tlocalCache.resource_filter_value = null;\n\t\tlocalCache.gridID = null;\n\t\tlocalCache.initialValues = [];\n\t\tlocalCache.newValues = [];\n\t}\n\n\treturn newResourcesControl;\n};","import TemplateControlConstructor from \"./controls/template_control\";\nimport TextareaControlConstructor from \"./controls/textarea_control\";\nimport TimeControlConstructor from \"./controls/time_control\";\nimport SelectControlConstructor from \"./controls/select_control\";\nimport CheckboxControlConstructor from \"./controls/checkbox_control\";\nimport RadioControlConstructor from \"./controls/radio_control\";\nimport DurationControlConstructor from \"./controls/duration_control\";\nimport ParentControlConstructor from \"./controls/parent_control\";\nimport ResourcesControlConstructor from \"./controls/resources_control\";\nimport ConstraintControlConstructor from \"./controls/constraint_control\";\nimport TypeselectControlConstructor from \"./controls/typeselect_control\";\nimport BaselineControlConstructor from \"./controls/baseline_control\";\nimport NewResourcesControlConstructor from \"./controls/resource_selector_control\";\n\nimport * as domHelpers from \"../utils/dom_helpers\";\nimport * as helpers from \"../../../utils/helpers\";\n\t\n\nexport default function (gantt) {\n\n\n\tvar TemplateControl = TemplateControlConstructor(gantt);\n\tvar TextareaControl = TextareaControlConstructor(gantt);\n\tvar TimeControl = TimeControlConstructor(gantt);\n\tvar SelectControl = SelectControlConstructor(gantt);\n\tvar CheckboxControl = CheckboxControlConstructor(gantt);\n\tvar RadioControl = RadioControlConstructor(gantt);\n\tvar DurationControl = DurationControlConstructor(gantt);\n\tvar ParentControl = ParentControlConstructor(gantt);\n\tvar ResourcesControl = ResourcesControlConstructor(gantt);\n\tvar ConstraintControl = ConstraintControlConstructor(gantt);\n\tvar TypeselectControl = TypeselectControlConstructor(gantt);\n\tvar BaselineControl = BaselineControlConstructor(gantt);\n\tvar NewResourcesControl = NewResourcesControlConstructor(gantt);\n\n\tgantt._lightbox_methods = {};\n\tgantt._lightbox_template = \"<div class='gantt_cal_ltitle'><span class='gantt_mark'>&nbsp;</span><span class='gantt_time'></span><span class='gantt_title'></span></div><div class='gantt_cal_larea'></div>\";\n\tgantt._lightbox_template = `<div class='gantt_cal_ltitle'><div class=\"dhx_cal_ltitle_descr\"><span class='gantt_mark'>&nbsp;</span><span class='gantt_time'></span><span class='dhx_title'></span>\n</div>\n<div class=\"gantt_cal_ltitle_controls\">\n\t<a class=\"gantt_cal_ltitle_close_btn dhx_gantt_icon dhx_gantt_icon_close\"></a>\n\n</div></div><div class='gantt_cal_larea'></div>`;\n\n\t// GS-1952. Attaching the lightbox to the BODY element is not considered secure.\n\t// Attach it to Gantt container for Salesforce and other secure environments\n\tgantt._lightbox_root = gantt.$root;\n\tfunction setParentNode() {\n\t\tconst cspEnvironment = gantt.config.csp === true;\n\t\tif (cspEnvironment || gantt.env.isSalesforce) {\n\t\t\tgantt._lightbox_root = gantt.$root;\n\t\t} else {\n\t\t\tgantt._lightbox_root = document.body;\n\t\t}\n\t}\n\n\t//TODO: gantt._lightbox_id is changed from data.js and accessed from autoscheduling, check if it can be removed from gantt object\n\tvar state = gantt.$services.getService(\"state\");\n\tstate.registerProvider(\"lightbox\", function () {\n\t\treturn {\n\t\t\tlightbox: gantt._lightbox_id\n\t\t};\n\t});\n\n\tgantt.showLightbox = function (id) {\n\t\tvar task = this.getTask(id);\n\t\tif (!this.callEvent(\"onBeforeLightbox\", [id])) {\n\t\t\tif(gantt.isTaskExists(id) && gantt.getTask(id).$new){\n\t\t\t\t//GS-2340 if 'onBeforeLightbox' returns 'false' need update the order in datastore\n\t\t\t\tthis.$data.tasksStore._updateOrder();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tvar box = this.getLightbox(this.getTaskType(task.type));\n\n\t\tthis.showCover(box);\n\t\tthis._fill_lightbox(id, box);\n\t\tthis._setLbPosition(box);\n\t\tthis._waiAria.lightboxVisibleAttr(box);\n\n\t\tthis.callEvent(\"onLightbox\", [id]);\n\t};\n\n\tfunction _is_chart_visible(gantt) {\n\t\tvar timeline = gantt.$ui.getView(\"timeline\");\n\t\tif (timeline && timeline.isVisible()) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tgantt._get_timepicker_step = function () {\n\t\tif (this.config.round_dnd_dates) {\n\t\t\tvar step;\n\t\t\tif (_is_chart_visible(this)) {\n\t\t\t\tvar scale = gantt.getScale();\n\t\t\t\tstep = (helpers.getSecondsInUnit(scale.unit) * scale.step) / 60;//timepicker step is measured in minutes\n\t\t\t}\n\n\t\t\tif (!step || step >= 60 * 24) {\n\t\t\t\tstep = this.config.time_step;\n\t\t\t}\n\t\t\treturn step;\n\t\t}\n\t\treturn this.config.time_step;\n\t};\n\tgantt.getLabel = function (property, key) {\n\t\tvar sections = this._get_typed_lightbox_config();\n\t\tfor (var i = 0; i < sections.length; i++) {\n\t\t\tif (sections[i].map_to == property) {\n\t\t\t\tvar options = sections[i].options;\n\t\t\t\tfor (var j = 0; j < options.length; j++) {\n\t\t\t\t\tif (options[j].key == key) {\n\t\t\t\t\t\treturn options[j].label;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn \"\";\n\t};\n\n\tgantt.updateCollection = function (list_name, collection) {\n\t\tcollection = collection.slice(0);\n\t\tvar list = gantt.serverList(list_name);\n\t\tif (!list) return false;\n\t\tlist.splice(0, list.length);\n\t\tlist.push.apply(list, collection || []);\n\t\tgantt.resetLightbox();\n\t};\n\tgantt.getLightboxType = function () {\n\t\treturn this.getTaskType(this._lightbox_type);\n\t};\n\tgantt.getLightbox = function (type) {\n\t\tvar lightboxDiv;\n\t\tvar fullWidth;\n\t\tvar html;\n\t\tvar sns;\n\t\tvar ds;\n\t\tvar classNames = \"\";\n\t\tsetParentNode();\n\n\t\tif (type === undefined)\n\t\t\ttype = this.getLightboxType();\n\n\t\tif (!this._lightbox || this.getLightboxType() != this.getTaskType(type)) {\n\t\t\tthis._lightbox_type = this.getTaskType(type);\n\t\t\tlightboxDiv = document.createElement(\"div\");\n\t\t\tclassNames = \"gantt_cal_light\";\n\t\t\tfullWidth = this._is_lightbox_timepicker();\n\n\t\t\tif (gantt.config.wide_form)\n\t\t\t\tclassNames += \" gantt_cal_light_wide\";\n\n\t\t\tif (fullWidth) {\n\t\t\t\tclassNames += \" gantt_cal_light_full\";\n\t\t\t}\n\n\t\t\tlightboxDiv.className = classNames;\n\n\t\t\tlightboxDiv.style.visibility = \"hidden\";\n\t\t\thtml = this._lightbox_template;\n\t\t\thtml += \"<div class='gantt_cal_lcontrols'>\";\n\t\t\thtml += getHtmlButtons(this.config.buttons_left);\n\t\t\thtml += \"<div class='gantt_cal_lcontrols_push_right'></div>\";\n\t\t\thtml += getHtmlButtons(this.config.buttons_right, true);\n\t\t\thtml += \"</div>\";\n\n\t\t\tlightboxDiv.innerHTML = html;\n\n\t\t\tgantt._waiAria.lightboxAttr(lightboxDiv);\n\n\t\t\tif (gantt.config.drag_lightbox) {\n\t\t\t\tlightboxDiv.firstChild.onmousedown = gantt._ready_to_dnd;\n\t\t\t\tlightboxDiv.firstChild.addEventListener('touchstart', function(e){\n\t\t\t\t\tgantt._ready_to_dnd(e.touches[0]);\n\t\t\t\t});\n\t\t\t\tlightboxDiv.firstChild.onselectstart = function () {\n\t\t\t\t\treturn false;\n\t\t\t\t};\n\t\t\t\tlightboxDiv.firstChild.style.cursor = \"pointer\";\n\t\t\t\tgantt._init_dnd_events();\n\t\t\t}\n\n\t\t\t// GS-1428: If there is lightbox node, we need to remove it from the DOM\n\t\t\tif (this._lightbox){\n\t\t\t\tthis.resetLightbox();\n\t\t\t}\n\t\t\tshow_cover();\n\t\t\tthis._cover.insertBefore(lightboxDiv, this._cover.firstChild);\n\t\t\tthis._lightbox = lightboxDiv;\n\n\t\t\tsns = this._get_typed_lightbox_config(type);\n\t\t\thtml = this._render_sections(sns);\n\n\t\t\tds = lightboxDiv.querySelector(\"div.gantt_cal_larea\");\n\t\t\t\n\t\t\t//GS-1131. If gantt_cal_larea is displayed, Firefox renders buttons incorrectly;\n\t\t\tvar backup_overflow = ds.style.overflow;\n\t\t\tds.style.overflow = 'hidden';\n\n\t\t\tds.innerHTML = html;\n\n\t\t\t\n\n\t\t\tbindLabelsToInputs(sns);\n\n\t\t\tds.style.overflow = backup_overflow;\n\n\t\t\tthis._init_lightbox_events(this);\n\t\t\tlightboxDiv.style.display = \"none\";\n\t\t\tlightboxDiv.style.visibility = \"visible\";\n\t\t}\n\t\treturn this._lightbox;\n\t};\n\n\tgantt._render_sections = function (sns) {\n\t\tvar html = \"\";\n\t\tfor (var i = 0; i < sns.length; i++) {\n\t\t\tvar block = this.form_blocks[sns[i].type];\n\t\t\tif (!block) continue; //ignore incorrect blocks\n\t\t\tsns[i].id = \"area_\" + this.uid();\n\n\t\t\tvar display = sns[i].hidden ? \" style='display:none'\" : \"\";\n\t\t\tvar button = \"\";\n\t\t\tif (sns[i].button) {\n\t\t\t\tbutton = \"<div class='gantt_custom_button' data-index='\" + i + \"'><div class='gantt_custom_button_\" + sns[i].button + \"'></div><div class='gantt_custom_button_label'>\" + this.locale.labels[\"button_\" + sns[i].button] + \"</div></div>\";\n\t\t\t}\n\t\t\tif (sns[i].type == \"baselines\") {\n\t\t\t\tbutton = \"<div class='gantt_custom_button gantt_remove_baselines' data-index='\" + i + \"'><div class='gantt_custom_button_delete_baselines'></div><div class='gantt_custom_button_label'>\" + this.locale.labels.baselines_remove_all_button + \"</div></div>\" +\n\t\t\t\t\"<div class='gantt_custom_button gantt_add_baselines' data-index='\" + i + \"'><div class='gantt_custom_button_add_baseline'></div><div class='gantt_custom_button_label'>\" + this.locale.labels.baselines_add_button + \"</div></div>\";\n\t\t\t}\n\t\t\tif (sns[i].type == \"resource_selector\") {\n\t\t\t\tsns[i].index = i;\n\t\t\t\tbutton = `<div class='gantt_custom_button gantt_add_resources' data-index='${i}' data-resource-selector-section='${i}' data-section-name='${sns.name}'><div class='gantt_custom_button_add_resources gantt_add'></div><div class='gantt_custom_button_label'>${this.locale.labels.resources_add_button}</div></div>`;\n\t\t\t}\n\t\t\tif (this.config.wide_form) {\n\t\t\t\thtml += \"<div class='gantt_wrap_section' \" + display + \">\";\n\t\t\t}\n\t\t\thtml += \"<div id='\" + sns[i].id + \"' class='gantt_cal_lsection'><label>\" + button + (sns[i].label || this.locale.labels[\"section_\" + sns[i].name]||sns[i].name) + \"</label></div>\" + block.render.call(this, sns[i]);\n\t\t\thtml += \"</div>\";\n\t\t}\n\t\treturn html;\n\t};\n\n\tgantt._center_lightbox = function(box){\n\t\tgantt._setLbPosition(box);\n\t};\n\tgantt._setLbPosition = function(box) {\n\t\tif(!box){\n\t\t\treturn;\n\t\t}\n\t\tconst rootElement = gantt._lightbox_root || gantt.$root;\n\t\tbox.style.top = Math.max(rootElement.offsetHeight / 2 - box.offsetHeight/2, 0) + \"px\";\n\t\tbox.style.left = Math.max(rootElement.offsetWidth / 2 - box.offsetWidth/2, 0) + \"px\";\n\t};\n\n\tgantt.showCover = function (box) {\n\t\tif (box){\n\t\t\tbox.style.display=\"block\";\n\t\n\t\t\tthis._setLbPosition(box);\n\t\t}\n\t\tshow_cover();\n\t\tthis._cover.style.display = \"\";\n\t};\n\tconst show_cover=function(){\n\t\tif(gantt._cover) {\n\t\t\treturn;\n\t\t}\n\t\n\t\tgantt._cover=document.createElement(\"div\");\n\t\tgantt._cover.className=\"gantt_cal_cover\";\n\t\tgantt._cover.style.display = \"none\";\n\t\n\t\tgantt.event(gantt._cover, \"mousemove\", gantt._move_while_dnd);\n\t\tgantt.event(gantt._cover, \"mouseup\", gantt._finish_dnd);\n\t\n\t\tconst rootElement = gantt._lightbox_root || gantt.$root;\n\t\trootElement.appendChild(gantt._cover);\n\t};\n\n\tgantt._init_lightbox_events = function () {\n\t\tgantt.lightbox_events = {};\n\n\n\t\tgantt.lightbox_events.gantt_save_btn = function () {\n\t\t\tgantt._save_lightbox();\n\t\t};\n\n\n\t\tgantt.lightbox_events.gantt_delete_btn = function () {\n\t\t\tgantt._lightbox_current_type = null;\n\t\t\tif (!gantt.callEvent(\"onLightboxDelete\", [gantt._lightbox_id]))\n\t\t\t\treturn;\n\n\t\t\tif (gantt.isTaskExists(gantt._lightbox_id)) {\n\t\t\t\tgantt.$click.buttons[\"delete\"](gantt._lightbox_id);\n\t\t\t} else {\n\t\t\t\tgantt.hideLightbox();\n\t\t\t}\n\n\t\t};\n\n\n\t\tgantt.lightbox_events.gantt_cancel_btn = function () {\n\t\t\tgantt._cancel_lightbox();\n\t\t};\n\n\n\t\tgantt.lightbox_events[\"default\"] = function (e, src) {\n\t\t\tif (src.getAttribute(\"data-dhx-button\")) {\n\t\t\t\tgantt.callEvent(\"onLightboxButton\", [src.className, src, e]);\n\t\t\t} else {\n\t\t\t\tvar index, block, sec;\n\n\t\t\t\tvar className = domHelpers.getClassName(src);\n\t\t\t\tif (className.indexOf(\"gantt_custom_button\") != -1) {\n\t\t\t\t\tif (className.indexOf(\"gantt_custom_button_\") != -1) {\n\t\t\t\t\t\tindex = src.parentNode.getAttribute(\"data-index\");\n\t\t\t\t\t\tsec = src;\n\t\t\t\t\t\twhile (sec && domHelpers.getClassName(sec).indexOf(\"gantt_cal_lsection\") == -1) {\n\t\t\t\t\t\t\tsec = sec.parentNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tindex = src.getAttribute(\"data-index\");\n\t\t\t\t\t\tsec = src.closest(\".gantt_cal_lsection\");\n\t\t\t\t\t\tsrc = src.firstChild;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar sections = gantt._get_typed_lightbox_config();\n\n\t\t\t\tif (index) {\n\t\t\t\t\tindex = index * 1;\n\t\t\t\t\tblock = gantt.form_blocks[sections[index * 1].type];\n\t\t\t\t\tblock.button_click(index, src, sec, sec.nextSibling);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tthis.event(gantt.getLightbox(), \"click\", function (e) {\n\t\t\tif(e.target.closest(\".gantt_cal_ltitle_close_btn\")){\n\t\t\t\tgantt._cancel_lightbox();\n\t\t\t}\n\t\t\tvar src = domHelpers.getTargetNode(e);\n\n\t\t\tvar className = domHelpers.getClassName(src);\n\t\t\tif (!className) {\n\t\t\t\tsrc = src.previousSibling;\n\t\t\t\tclassName = domHelpers.getClassName(src);\n\t\t\t}\n\t\t\tif (src && className && className.indexOf(\"gantt_btn_set\") === 0) {\n\t\t\t\tsrc = src.firstChild;\n\t\t\t\tclassName = domHelpers.getClassName(src);\n\t\t\t}\n\t\t\tif (src && className) {\n\t\t\t\tvar func = gantt.defined(gantt.lightbox_events[src.className]) ? gantt.lightbox_events[src.className] : gantt.lightbox_events[\"default\"];\n\t\t\t\treturn func(e, src);\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\n\t\tgantt.getLightbox().onkeydown = function (e) {\n\t\t\tvar event = e || window.event;\n\t\t\tvar target = e.target || e.srcElement;\n\t\t\tvar buttonTarget = domHelpers.getClassName(target).indexOf(\"gantt_btn_set\") > -1;\n\n\t\t\tswitch ((e || event).keyCode) {\n\t\t\t\tcase gantt.constants.KEY_CODES.SPACE: {\n\t\t\t\t\tif ((e || event).shiftKey) return;\n\t\t\t\t\tif (buttonTarget && target.click) {\n\t\t\t\t\t\ttarget.click();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase gantt.keys.edit_save:\n\t\t\t\t\tif ((e || event).shiftKey) return;\n\t\t\t\t\tif (buttonTarget && target.click) {\n\t\t\t\t\t\ttarget.click();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tgantt._save_lightbox();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase gantt.keys.edit_cancel:\n\t\t\t\t\tgantt._cancel_lightbox();\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t};\n\t};\n\n\tgantt._cancel_lightbox = function () {\n\t\tvar task = this.getLightboxValues(\"cancel\");\n\t\tgantt._lightbox_current_type = null;\n\t\tthis.callEvent(\"onLightboxCancel\", [this._lightbox_id, task.$new]);\n\t\tif (gantt.isTaskExists(task.id) && task.$new) {\n\t\t\tthis.silent(function () {\n\t\t\t\tgantt.$data.tasksStore.removeItem(task.id);\n\t\t\t\tgantt._update_flags(task.id, null);\n\t\t\t});\n\t\t\tthis.refreshData();\n\t\t}\n\n\t\tthis.hideLightbox();\n\t};\n\n\tgantt._save_lightbox = function () {\n\t\tvar task = this.getLightboxValues(\"save\");\n\t\tgantt._lightbox_current_type = null;\n\t\tif (!this.callEvent(\"onLightboxSave\", [this._lightbox_id, task, !!task.$new]))\n\t\t\treturn;\n\n\t\t// GS-2170. Do not recalculate the indexes and dates of other tasks\n\t\t// as they will be recalculated in the `refreshData`\n\t\tgantt.$data.tasksStore._skipTaskRecalculation = \"lightbox\";\n\t\tif (task.$new) {\n\t\t\tdelete task.$new;\n\t\t\tthis.addTask(task, task.parent, this.getTaskIndex(task.id));\n\t\t} else if (this.isTaskExists(task.id)) {\n\t\t\tthis.mixin(this.getTask(task.id), task, true);\n\t\t\tthis.refreshTask(task.id);\n\t\t\tthis.updateTask(task.id);\n\t\t}\n\t\tgantt.$data.tasksStore._skipTaskRecalculation = false;\n\t\tthis.refreshData();\n\n\t\t// TODO: do we need any blockable events here to prevent closing lightbox?\n\t\tthis.hideLightbox();\n\t};\n\n\tgantt._resolve_default_mapping = function (section) {\n\t\tvar mapping = section.map_to;\n\t\tvar time_controls = { \"time\": true, \"time_optional\": true, \"duration\": true, \"duration_optional\": true };\n\t\tif (time_controls[section.type]) {\n\t\t\tif (section.map_to == \"auto\") {\n\t\t\t\tmapping = { start_date: \"start_date\", end_date: \"end_date\", duration: \"duration\" };\n\t\t\t} else if (typeof (section.map_to) === \"string\") {\n\t\t\t\tmapping = { start_date: section.map_to };\n\t\t\t}\n\t\t} else if (section.type === \"constraint\") {\n\t\t\tif (!section.map_to || typeof (section.map_to) === \"string\") {\n\t\t\t\tmapping = { constraint_type: \"constraint_type\", constraint_date: \"constraint_date\" };\n\t\t\t}\n\t\t}\n\n\t\treturn mapping;\n\t};\n\n\tgantt.getLightboxValues = function (type) {\n\t\tlet task = {};\n\n\t\tif (gantt.isTaskExists(this._lightbox_id)) {\n\t\t\ttask = this.mixin({}, this.getTask(this._lightbox_id));\n\t\t}\n\n\t\tconst sns = this._get_typed_lightbox_config();\n\t\t// GS-2370: if there is a resource with its calendar\n\t\t// need to place time section at the end\n\t\tconst sortedSns = [...sns].sort((a, b) => {\n\t\t\tif (a.name === \"time\") return 1;\n\t\t\tif (b.name === \"time\") return -1;\n\t\t\treturn 0;\n\t\t});\n\t\tfor (let i = 0; i < sortedSns.length; i++) {\n\t\t\tlet node = gantt._lightbox_root.querySelector(\"#\" + sortedSns[i].id);\n\t\t\tnode = (node ? node.nextSibling : node);\n\t\t\tlet block = this.form_blocks[sortedSns[i].type];\n\t\t\tif (!block) continue;\n\t\t\tlet res = block.get_value.call(this, node, task, sortedSns[i], type);\n\t\t\tlet map_to = gantt._resolve_default_mapping(sortedSns[i]);\n\t\t\tif (typeof map_to == \"string\" && map_to != \"auto\") {\n\t\t\t\ttask[map_to] = res;\n\t\t\t} else if (typeof map_to == \"object\") {\n\t\t\t\tfor (let property in map_to) {\n\t\t\t\t\tif (map_to[property])\n\t\t\t\t\t\ttask[map_to[property]] = res[property];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// GS-1282 We need to preserve the task type even if the lightbox doesn't have the typeselect section\n\t\t// GS-2460 set the current type from selector\n\t\tif (gantt._lightbox_current_type) {\n\t\t\ttask.type = gantt._lightbox_current_type;\n\t\t}\n\n\t\treturn task;\n\t};\n\n\n\tgantt.hideLightbox = function () {\n\t\tvar box = this.getLightbox();\n\t\tif (box) box.style.display = \"none\";\n\n\t\tthis._waiAria.lightboxHiddenAttr(box);\n\t\tthis._lightbox_id = null;\n\n\t\tthis.hideCover(box);\n\t\tthis.resetLightbox();\n\t\tthis.callEvent(\"onAfterLightbox\", []);\n\t};\n\tgantt.hideCover = function (box) {\n\t\tif(box){\n\t\t\tbox.style.display = \"none\";\n\t\t}\n\t\tif (this._cover)\n\t\t\tthis._cover.parentNode.removeChild(this._cover);\n\t\tthis._cover = null;\n\t};\n\n\tgantt.resetLightbox = function () {\n\t\tif (gantt._lightbox && !gantt._custom_lightbox)\n\t\t\tgantt._lightbox.remove();\n\t\tgantt._lightbox = null;\n\t};\n\tgantt._set_lightbox_values = function (data, box) {\n\t\tvar task = data;\n\t\tvar s = box.getElementsByTagName(\"span\");\n\t\tvar lightboxHeader = [];\n\t\tif (gantt.templates.lightbox_header) {\n\t\t\tlightboxHeader.push(\"\");\n\t\t\tlightboxHeader.push(gantt.templates.lightbox_header(task.start_date, task.end_date, task));\n\t\t\ts[1].innerHTML = \"\";\n\t\t\ts[2].innerHTML = gantt.templates.lightbox_header(task.start_date, task.end_date, task);\n\t\t} else {\n\t\t\tlightboxHeader.push(this.templates.task_time(task.start_date, task.end_date, task));\n\t\t\tlightboxHeader.push(String(this.templates.task_text(task.start_date, task.end_date, task) || \"\").substr(0, 70)); //IE6 fix\n\t\t\ts[1].innerHTML = this.templates.task_time(task.start_date, task.end_date, task);\n\t\t\ts[2].innerHTML = String(this.templates.task_text(task.start_date, task.end_date, task) || \"\").substr(0, 70); //IE6 fix\n\t\t}\n\t\ts[1].innerHTML = lightboxHeader[0];\n\t\ts[2].innerHTML = lightboxHeader[1];\n\n\t\tgantt._waiAria.lightboxHeader(box, lightboxHeader.join(\" \"));\n\n\t\tvar sns = this._get_typed_lightbox_config(this.getLightboxType());\n\t\tfor (var i = 0; i < sns.length; i++) {\n\t\t\tvar section = sns[i];\n\n\t\t\tif (!this.form_blocks[section.type]) {\n\t\t\t\tcontinue;//skip incorrect sections, same check is done during rendering\n\t\t\t}\n\n\n\t\t\tvar node = gantt._lightbox_root.querySelector(\"#\" + section.id).nextSibling;\n\t\t\tvar block = this.form_blocks[section.type];\n\t\t\tvar map_to = gantt._resolve_default_mapping(sns[i]);\n\t\t\tvar value = this.defined(task[map_to]) ? task[map_to] : section.default_value;\n\t\t\tblock.set_value.call(gantt, node, value, task, section);\n\n\t\t\tif (section.focus)\n\t\t\t\tblock.focus.call(gantt, node);\n\t\t}\n\t\tif (gantt.isTaskExists(data.id)){\n\t\t\tgantt._lightbox_id = data.id;\n\t\t}\n\t};\n\tgantt._fill_lightbox = function (id, box) {\n\t\tvar task = this.getTask(id);\n\t\tthis._set_lightbox_values(task, box);\n\t};\n\n\n\tgantt.getLightboxSection = function (name) {\n\t\tvar config = this._get_typed_lightbox_config();\n\t\tvar i = 0;\n\t\tfor (i; i < config.length; i++)\n\t\t\tif (config[i].name == name)\n\t\t\t\tbreak;\n\t\tvar section = config[i];\n\t\tif (!section)\n\t\t\treturn null;\n\n\t\tif (!this._lightbox)\n\t\t\tthis.getLightbox();\n\t\tvar header = gantt._lightbox_root.querySelector(\"#\" + section.id);\n\t\tvar node = header.nextSibling;\n\n\t\tvar result = {\n\t\t\tsection: section,\n\t\t\theader: header,\n\t\t\tnode: node,\n\t\t\tgetValue: function (ev) {\n\t\t\t\treturn gantt.form_blocks[section.type].get_value.call(gantt, node, (ev || {}), section);\n\t\t\t},\n\t\t\tsetValue: function (value, ev) {\n\t\t\t\treturn gantt.form_blocks[section.type].set_value.call(gantt, node, value, (ev || {}), section);\n\t\t\t}\n\t\t};\n\n\t\tvar handler = this._lightbox_methods[\"get_\" + section.type + \"_control\"];\n\t\treturn handler ? handler(result) : result;\n\t};\n\n\tgantt._lightbox_methods.get_template_control = function (result) {\n\t\tresult.control = result.node;\n\t\treturn result;\n\t};\n\tgantt._lightbox_methods.get_select_control = function (result) {\n\t\tresult.control = result.node.getElementsByTagName(\"select\")[0];\n\t\treturn result;\n\t};\n\tgantt._lightbox_methods.get_textarea_control = function (result) {\n\t\tresult.control = result.node.getElementsByTagName(\"textarea\")[0];\n\t\treturn result;\n\t};\n\tgantt._lightbox_methods.get_time_control = function (result) {\n\t\tresult.control = result.node.getElementsByTagName(\"select\"); // array\n\t\treturn result;\n\t};\n\n\n\tgantt._init_dnd_events = function () {\n\t\tvar eventElement = gantt._lightbox_root;\n\t\tthis.event(eventElement, \"mousemove\", gantt._move_while_dnd);\n\t\tthis.event(eventElement, \"mouseup\", gantt._finish_dnd);\n\t\tthis.event(eventElement, \"touchmove\", function (e){\n\t\t\tgantt._move_while_dnd(e.touches[0]);\n\t\t});\n\t\tthis.event(eventElement, \"touchend\", function (e){\n\t\t\tgantt._finish_dnd(e.touches[0]);\n\t\t});\n\t\t// GS-1952: In Salesforce environment, the lightbox is attached to the Gantt container. \n\t\t// So when Gantt is reinitialized, the events are no longer attached to the Gantt container.\n\t\t// gantt._init_dnd_events = function () {\n\t\t// };\n\t};\n\tgantt._move_while_dnd = function (event) {\n\t\tif (gantt._dnd_start_lb) {\n\t\t\tif (!document.gantt_unselectable) {\n\t\t\t\tgantt._lightbox_root.className += \" gantt_unselectable\";\n\t\t\t\tdocument.gantt_unselectable = true;\n\t\t\t}\n\t\t\tvar lb = gantt.getLightbox();\n\t\t\tvar now = [event.pageX, event.pageY];\n\t\t\tlb.style.top = gantt._lb_start[1] + now[1] - gantt._dnd_start_lb[1] + \"px\";\n\t\t\tlb.style.left = gantt._lb_start[0] + now[0] - gantt._dnd_start_lb[0] + \"px\";\n\t\t}\n\t};\n\tgantt._ready_to_dnd = function (event) {\n\t\tvar lb = gantt.getLightbox();\n\t\tgantt._lb_start = [lb.offsetLeft, lb.offsetTop];\n\t\tgantt._dnd_start_lb = [event.pageX, event.pageY];\n\t};\n\tgantt._finish_dnd = function () {\n\t\tif (gantt._lb_start) {\n\t\t\tgantt._lb_start = gantt._dnd_start_lb = false;\n\t\t\tgantt._lightbox_root.className = gantt._lightbox_root.className.replace(\" gantt_unselectable\", \"\");\n\t\t\tdocument.gantt_unselectable = false;\n\t\t}\n\t};\n\n\n\tgantt._focus = function (node, select) {\n\t\tif (node && node.focus) {\n\t\t\tif (gantt.config.touch) {\n\t\t\t\t//do not focus editor, to prevent auto-zoom\n\t\t\t} else {\n\t\t\t\ttry {\n\t\t\t\t\tif (select && node.select) node.select();\n\t\t\t\t\tnode.focus();\n\t\t\t\t} catch (e) {\n\t\t\t\t\t// silent errors\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\n\tgantt.form_blocks = {\n\t\tgetTimePicker: function (sns, hidden) {\n\t\t\tvar html = \"\";\n\t\t\tvar cfg = this.config;\n\t\t\tvar i;\n\t\t\tvar options;\n\t\t\tvar ariaAttrs;\n\t\t\tvar readonly;\n\t\t\tvar display;\n\t\t\tvar settings = {\n\t\t\t\tfirst: 0,\n\t\t\t\tlast: 24 * 60,\n\t\t\t\tdate: this.date.date_part(new Date(gantt._min_date.valueOf())),\n\t\t\t\ttimeFormat: getTimeFormat(sns)\n\t\t\t};\n\n\t\t\t// map: default order => real one\n\t\t\tsns._time_format_order = { size: 0 };\n\n\t\t\tif (gantt.config.limit_time_select) {\n\t\t\t\tsettings.first = 60 * cfg.first_hour;\n\t\t\t\tsettings.last = 60 * cfg.last_hour + 1;\n\t\t\t\tsettings.date.setHours(cfg.first_hour);\n\t\t\t}\n\n\t\t\tfor (i = 0; i < settings.timeFormat.length; i++) {\n\t\t\t\t// adding spaces between selects\n\t\t\t\tif (i > 0) {\n\t\t\t\t\thtml += \" \";\n\t\t\t\t}\n\n\t\t\t\toptions = getHtmlTimePickerOptions(sns, i, settings);\n\n\t\t\t\tif (options) {\n\t\t\t\t\tariaAttrs = gantt._waiAria.lightboxSelectAttrString(settings.timeFormat[i]);\n\t\t\t\t\treadonly = sns.readonly ? \"disabled='disabled'\" : \"\";\n\t\t\t\t\tdisplay = hidden ? \" style='display:none' \" : \"\";\n\t\t\t\t\thtml += \"<select \" + readonly + display + ariaAttrs + \">\" + options + \"</select>\";\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn html;\n\t\t},\n\t\tgetTimePickerValue: function (selects, config, offset) {\n\t\t\tvar map = config._time_format_order;\n\t\t\tvar needSetTime = gantt.defined(map[3]);\n\n\t\t\tvar time;\n\t\t\tvar hours = 0;\n\t\t\tvar minutes = 0;\n\n\t\t\tvar mapOffset = offset || 0;\n\n\t\t\tif (needSetTime) {\n\t\t\t\ttime = parseInt(selects[map[3] + mapOffset].value, 10);\n\t\t\t\thours = Math.floor(time / 60);\n\t\t\t\tminutes = time % 60;\n\t\t\t}\n\t\t\treturn new Date(selects[map[2] + mapOffset].value, selects[map[1] + mapOffset].value, selects[map[0] + mapOffset].value, hours, minutes);\n\t\t},\n\n\t\t_fill_lightbox_select: function (s, i, d, map) {\n\t\t\ts[i + map[0]].value = d.getDate();\n\t\t\ts[i + map[1]].value = d.getMonth();\n\t\t\ts[i + map[2]].value = d.getFullYear();\n\t\t\tif (gantt.defined(map[3])) {\n\t\t\t\tvar v = d.getHours() * 60 + d.getMinutes();\n\t\t\t\tv = Math.round(v / gantt._get_timepicker_step()) * gantt._get_timepicker_step();\n\t\t\t\tvar input = s[i + map[3]];\n\t\t\t\tinput.value = v;\n\t\t\t\t//in case option not shown\n\t\t\t\tinput.setAttribute(\"data-value\", v);\n\t\t\t}\n\t\t},\n\t\ttemplate: new TemplateControl(),\n\t\ttextarea: new TextareaControl(),\n\t\tselect: new SelectControl(),\n\t\ttime: new TimeControl(),\n\t\tduration: new DurationControl(),\n\t\tparent: new ParentControl(),\n\t\tradio: new RadioControl(),\n\t\tcheckbox: new CheckboxControl(),\n\t\tresources: new ResourcesControl(),\n\t\tconstraint: new ConstraintControl(),\n\t\tbaselines: new BaselineControl(),\n\t\ttypeselect: new TypeselectControl(),\n\t\tresource_selector: new NewResourcesControl()\n\t};\n\n\tgantt._is_lightbox_timepicker = function () {\n\t\tvar s = this._get_typed_lightbox_config();\n\t\tfor (var i = 0; i < s.length; i++)\n\t\t\tif (s[i].name == \"time\" && s[i].type == \"time\")\n\t\t\t\treturn true;\n\t\treturn false;\n\t};\n\n\tgantt._delete_task_confirm = function ({task, message, title, callback, ok}){\n\t\tgantt._simple_confirm(message, title, callback, ok);\n\t};\n\tgantt._delete_link_confirm = function({link, message, title, callback, ok}){\n\t\tgantt._simple_confirm(message, title, callback, ok);\n\t};\n\n\tgantt._simple_confirm = function (message, title, callback, ok) {\n\t\tif (!message)\n\t\t\treturn callback();\n\t\tvar opts = { text: message };\n\t\tif (title)\n\t\t\topts.title = title;\n\t\tif (ok) {\n\t\t\topts.ok = ok;\n\t\t}\n\t\tif (callback) {\n\t\t\topts.callback = function (result) {\n\t\t\t\tif (result)\n\t\t\t\t\tcallback();\n\t\t\t};\n\t\t}\n\t\tgantt.confirm(opts);\n\t};\n\n\tfunction _get_type_name(type_value) {\n\t\tfor (var i in this.config.types) {\n\t\t\tif (this.config.types[i] == type_value) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn \"task\";\n\t}\n\n\tgantt._get_typed_lightbox_config = function (type) {\n\t\tif (type === undefined) {\n\t\t\ttype = this.getLightboxType();\n\t\t}\n\n\t\tvar field = _get_type_name.call(this, type);\n\n\t\tif (gantt.config.lightbox[field + \"_sections\"]) {\n\t\t\treturn gantt.config.lightbox[field + \"_sections\"];\n\t\t} else {\n\t\t\treturn gantt.config.lightbox.sections;\n\t\t}\n\t};\n\n\tgantt._silent_redraw_lightbox = function (type) {\n\t\tvar oldType = this.getLightboxType();\n\n\t\tif (this.getState().lightbox) {\n\t\t\tvar taskId = this.getState().lightbox;\n\t\t\tvar formData = this.getLightboxValues(),\n\t\t\t\ttask = this.copy(this.getTask(taskId));\n\n\t\t\tthis.resetLightbox();\n\n\t\t\tvar updTask = this.mixin(task, formData, true);\n\t\t\tvar box = this.getLightbox(type ? type : undefined);\n\t\t\tthis._set_lightbox_values(updTask, box);\n\t\t\tthis.showCover(box);\n\t\t} else {\n\t\t\tthis.resetLightbox();\n\t\t\tthis.getLightbox(type ? type : undefined);\n\t\t}\n\t\tthis.callEvent(\"onLightboxChange\", [oldType, this.getLightboxType()]);\n\t};\n\n\tfunction bindLabelsToInputs(sns) {\n\t\tvar section;\n\t\tvar label;\n\t\tvar labelBlock;\n\t\tvar inputBlock;\n\t\tvar input;\n\t\tvar i;\n\n\t\tfor (i = 0; i < sns.length; i++) {\n\t\t\tsection = sns[i];\n\t\t\tlabelBlock = gantt._lightbox_root.querySelector(\"#\" + section.id);\n\n\t\t\tif (!section.id || !labelBlock) continue;\n\n\t\t\tlabel = labelBlock.querySelector(\"label\");\n\t\t\tinputBlock = labelBlock.nextSibling;\n\n\t\t\tif (!inputBlock) continue;\n\n\t\t\tinput = inputBlock.querySelector(\"input, select, textarea\");\n\t\t\tif (input) {\n\t\t\t\tinput.id = input.id || \"input_\" + gantt.uid();\n\t\t\t\tsection.inputId = input.id;\n\t\t\t\tlabel.setAttribute(\"for\", section.inputId);\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction getHtmlButtons(buttons, floatRight) {\n\t\tvar button;\n\t\tvar ariaAttr;\n\t\tvar html = \"\";\n\t\tvar i;\n\n\t\tfor (i = 0; i < buttons.length; i++) {\n\t\t\t// needed to migrate from 'dhx_something' to 'gantt_something' naming in a lightbox\n\t\t\tbutton = gantt.config._migrate_buttons[buttons[i]] ? gantt.config._migrate_buttons[buttons[i]] : buttons[i];\n\n\t\t\tariaAttr = gantt._waiAria.lightboxButtonAttrString(button);\n\t\t\thtml += \"<div \" + ariaAttr + \" class='gantt_btn_set gantt_left_btn_set \" + button + \"_set'\" + \"><div dhx_button='1' data-dhx-button='1' class='\" + button + \"'></div><div>\" + gantt.locale.labels[button] + \"</div></div>\";\n\t\t}\n\t\treturn html;\n\t}\n\n\tfunction getTimeFormat(sns) {\n\t\tvar scale;\n\t\tvar unit;\n\t\tvar result;\n\n\t\tif (sns.time_format) return sns.time_format;\n\n\t\t// default order\n\t\tresult = [\"%d\", \"%m\", \"%Y\"];\n\t\tscale = gantt.getScale();\n\t\tunit = scale ? scale.unit : gantt.config.duration_unit;\n\t\tif (helpers.getSecondsInUnit(unit) < helpers.getSecondsInUnit(\"day\")) {\n\t\t\tresult.push(\"%H:%i\");\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction getHtmlTimePickerOptions(sns, index, settings) {\n\t\tvar range;\n\t\tvar offset;\n\t\tvar start_year;\n\t\tvar end_year;\n\t\tvar i;\n\t\tvar time;\n\t\tvar diff;\n\t\tvar tdate;\n\t\tvar html = \"\";\n\n\t\tswitch (settings.timeFormat[index]) {\n\t\t\tcase \"%Y\":\n\t\t\t\tsns._time_format_order[2] = index;\n\t\t\t\tsns._time_format_order.size++;\n\t\t\t\t//year\n\n\t\t\t\tif (sns.year_range) {\n\t\t\t\t\tif (!isNaN(sns.year_range)) {\n\t\t\t\t\t\trange = sns.year_range;\n\t\t\t\t\t} else if (sns.year_range.push) {\n\t\t\t\t\t\t// if\n\t\t\t\t\t\tstart_year = sns.year_range[0];\n\t\t\t\t\t\tend_year = sns.year_range[1];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\trange = range || 10;\n\t\t\t\toffset = offset || Math.floor(range / 2);\n\t\t\t\tstart_year = start_year || settings.date.getFullYear() - offset;\n\t\t\t\tend_year = end_year || gantt.getState().max_date.getFullYear() + offset;\n\n\t\t\t\tfor (i = start_year; i <= end_year; i++)\n\t\t\t\t\thtml += \"<option value='\" + (i) + \"'>\" + (i) + \"</option>\";\n\t\t\t\tbreak;\n\t\t\tcase \"%m\":\n\t\t\t\tsns._time_format_order[1] = index;\n\t\t\t\tsns._time_format_order.size++;\n\t\t\t\t//month\n\t\t\t\tfor (i = 0; i < 12; i++)\n\t\t\t\t\thtml += \"<option value='\" + i + \"'>\" + gantt.locale.date.month_full[i] + \"</option>\";\n\t\t\t\tbreak;\n\t\t\tcase \"%d\":\n\t\t\t\tsns._time_format_order[0] = index;\n\t\t\t\tsns._time_format_order.size++;\n\t\t\t\t//days\n\t\t\t\tfor (i = 1; i < 32; i++)\n\t\t\t\t\thtml += \"<option value='\" + i + \"'>\" + i + \"</option>\";\n\t\t\t\tbreak;\n\t\t\tcase \"%H:%i\":\n\t\t\t\t//  var last = 24*60, first = 0;\n\t\t\t\tsns._time_format_order[3] = index;\n\t\t\t\tsns._time_format_order.size++;\n\t\t\t\t//hours\n\t\t\t\ti = settings.first;\n\t\t\t\ttdate = settings.date.getDate();\n\t\t\t\tsns._time_values = [];\n\n\t\t\t\twhile (i < settings.last) {\n\t\t\t\t\ttime = gantt.templates.time_picker(settings.date);\n\t\t\t\t\thtml += \"<option value='\" + i + \"'>\" + time + \"</option>\";\n\t\t\t\t\tsns._time_values.push(i);\n\t\t\t\t\tsettings.date.setTime(settings.date.valueOf() + gantt._get_timepicker_step() * 60 * 1000);\n\t\t\t\t\tdiff = (settings.date.getDate() != tdate) ? 1 : 0; // moved or not to the next day\n\t\t\t\t\ti = diff * 24 * 60 + settings.date.getHours() * 60 + settings.date.getMinutes();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t\treturn html;\n\t}\n};","import __extends from \"../../../../utils/extends\";\n\nimport Super from \"./base_control\";\n\nexport default function(gantt) {\n\tconst _super = Super(gantt);\n\n\tfunction TemplateControl() {\n\t\tvar self = _super.apply(this, arguments) || this; \n\t\treturn self; \n\t}\n\n\t__extends(TemplateControl, _super);\n\n\n\tTemplateControl.prototype.render = function(sns) {\n\t\tlet height = sns.height ? `${sns.height}px` : '';\n\t\treturn `<div class='gantt_cal_ltext gantt_cal_template gantt_section_${sns.name}' ${height ? `style='height:${height};'` : ''}></div>`;\n\t};\n\n\tTemplateControl.prototype.set_value = function(node, value) {\n\t\tnode.innerHTML = value || \"\";\n\t};\n\n\tTemplateControl.prototype.get_value = function(node) {\n\t\treturn node.innerHTML || \"\";\n\t};\n\n\tTemplateControl.prototype.focus = function() {};\n\n\treturn TemplateControl;\n};","import __extends from \"../../../../utils/extends\";\n\nimport Super from \"./base_control\";\n\nexport default function(gantt) {\n\tconst _super = Super(gantt);\n\n\tfunction TextareaControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\n\t\treturn self; \n\t}\n\n\t__extends(TextareaControl, _super);\n\n\tTextareaControl.prototype.render = function(sns) {\n\t\tconst height = (sns.height || \"130\") + \"px\";\n\t\tconst placeholder = sns.placeholder ? `placeholder='${sns.placeholder}'` : \"\";\n\t\treturn `<div class='gantt_cal_ltext gantt_section_${sns.name}' style='height:${height};' ${placeholder}><textarea></textarea></div>`;\n\t};\n\n\tTextareaControl.prototype.set_value = function(node, value) {\n\t\tgantt.form_blocks.textarea._get_input(node).value = value || \"\";\n\t};\n\n\tTextareaControl.prototype.get_value = function(node) {\n\t\treturn gantt.form_blocks.textarea._get_input(node).value;\n\t};\n\n\tTextareaControl.prototype.focus = function(node) {\n\t\tvar a = gantt.form_blocks.textarea._get_input(node);\n\t\tgantt._focus(a, true);\n\t};\n\n\tTextareaControl.prototype._get_input = function(node) {\n\t\treturn node.querySelector(\"textarea\");\n\t};\n\n\treturn TextareaControl;\n};","import __extends from \"../../../../utils/extends\";\n\nimport Super from \"./base_control\";\n\nexport default function(gantt) {\n\tconst _super = Super(gantt);\n\n\tfunction TimeControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\n\t\treturn self;\n\t}\n\n\t__extends(TimeControl, _super);\n\n\tTimeControl.prototype.render = function (sns) {\n\t\tvar time = gantt.form_blocks.getTimePicker.call(this, sns);\n\t\tlet sectionClassName = \"gantt_section_time\";\n\t\tif (sns.name !== \"time\"){\n\t\t\tsectionClassName += \" gantt_section_\" + sns.name;\n\t\t}\n\t\tvar html = \"<div style='padding-top:0px;font-size:inherit;text-align:center;' class='\" + sectionClassName + \"'>\";\n\t\thtml += time;\n\n\t\tif (sns.single_date) {\n\t\t\ttime = gantt.form_blocks.getTimePicker.call(this, sns, true);\n\t\t\thtml += \"<span></span>\";\n\t\t} else {\n\t\t\thtml += \"<span class='gantt_section_time_spacer'> &nbsp;&ndash;&nbsp; </span>\";\n\t\t}\n\n\t\thtml += time;\n\t\thtml += \"</div>\";\n\t\treturn html;\n\t};\n\n\tTimeControl.prototype.set_value = function (node, value, ev, config) {\n\t\tvar cfg = config;\n\t\tvar s = node.getElementsByTagName(\"select\");\n\t\tvar map = config._time_format_order;\n\n\t\tif (cfg.auto_end_date) {\n\t\t\tvar _update_lightbox_select = function () {\n\t\t\t\tstart_date = new Date(s[map[2]].value, s[map[1]].value, s[map[0]].value, 0, 0);\n\t\t\t\tend_date = gantt.calculateEndDate({ start_date: start_date, duration: 1, task: ev });\n\t\t\t\tgantt.form_blocks._fill_lightbox_select(s, map.size, end_date, map, cfg);\n\t\t\t};\n\t\t\tfor (var i = 0; i < 4; i++) {\n\t\t\t\ts[i].onchange = _update_lightbox_select;\n\t\t\t}\n\t\t}\n\n\t\tvar mapping = gantt._resolve_default_mapping(config);\n\n\t\tif (typeof (mapping) === \"string\") mapping = { start_date: mapping };\n\n\t\tvar start_date = ev[mapping.start_date] || new Date();\n\t\tvar end_date = ev[mapping.end_date] || gantt.calculateEndDate({\n\t\t\tstart_date: start_date,\n\t\t\tduration: 1,\n\t\t\ttask: ev\n\t\t});\n\n\t\tgantt.form_blocks._fill_lightbox_select(s, 0, start_date, map, cfg);\n\t\tgantt.form_blocks._fill_lightbox_select(s, map.size, end_date, map, cfg);\n\t};\n\n\tTimeControl.prototype.get_value = function (node, ev, config) {\n\t\tvar selects = node.getElementsByTagName(\"select\");\n\t\tvar startDate;\n\t\tvar map = config._time_format_order;\n\t\tfunction _getEndDate(selects, map, startDate) {\n\t\t\tvar endDate = gantt.form_blocks.getTimePickerValue(selects, config, map.size);\n\t\t\t// GS-1010: We need to add a way to obtain exact end_date for validation\n\t\t\tif (endDate <= startDate) {  // when end date seems wrong\n\t\t\t\tif (config.autofix_end !== false || config.single_date) { // auto correct it in two cases - when the auto correction is not disabled, or when we have 'single date' control and the user don't have the UI to specify the end date\n\t\t\t\t\treturn gantt.date.add(startDate, gantt._get_timepicker_step(), \"minute\");\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn endDate;\n\t\t}\n\n\t\tstartDate = gantt.form_blocks.getTimePickerValue(selects, config);\n\n\t\tif (typeof gantt._resolve_default_mapping(config) === \"string\") {\n\t\t\treturn startDate;\n\t\t}\n\n\t\treturn {\n\t\t\tstart_date: startDate,\n\t\t\tend_date: _getEndDate(selects, map, startDate)\n\t\t};\n\t};\n\n\tTimeControl.prototype.focus = function (node) {\n\t\tgantt._focus(node.getElementsByTagName(\"select\")[0]);\n\t};\n\n\treturn TimeControl;\n};","import * as helpers from \"../../../../utils/helpers\";\nimport __extends from \"../../../../utils/extends\";\nimport BaseConstrutor from \"./base_control\";\n\nexport default function(gantt) {\n\tvar _super = BaseConstrutor(gantt);\n\n\tfunction CheckboxControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\n\t\treturn self; \n\t}\n\n\t__extends(CheckboxControl, _super);\n\n\tCheckboxControl.prototype.render = function(sns) {\n\t\tconst height = sns.height ? `height:${sns.height}px;` : '';\n\t\tlet html = `<div class='gantt_cal_ltext gantt_cal_lcheckbox gantt_section_${sns.name}' ${height ? `style='${height}'` : ''}>`;\n\n\t\tif (sns.options && sns.options.length) {\n\t\t\tfor (var i = 0; i < sns.options.length; i++) {\n\t\t\t\thtml += \"<label><input type='checkbox' value='\" + sns.options[i].key + \"' name='\" + sns.name + \"'>\" + sns.options[i].label + \"</label>\";\n\t\t\t}\n\t\t}else{\n\t\t\tsns.single_value = true;\n\t\t\thtml += \"<label><input type='checkbox' name='\" + sns.name + \"'></label>\";\n\t\t}\n\t\thtml += \"</div>\";\n\t\treturn html;\n\t};\n\n\tCheckboxControl.prototype.set_value = function(node, value, ev, sns) {\n\t\tvar checkboxes = Array.prototype.slice.call(node.querySelectorAll(\"input[type=checkbox]\"));\n\n\t\tif (!node._dhx_onchange && sns.onchange) {\n\t\t\tnode.onchange = sns.onchange;\n\t\t\tnode._dhx_onchange = true;\n\t\t}\n\n\t\tif(sns.single_value){\n\t\t\tvar box = checkboxes[0];\n\t\t\tbox.checked = !!value;\n\t\t}else{\n\t\t\thelpers.forEach(checkboxes, function(entry) {\n\t\t\t\tentry.checked = value ? value.indexOf(entry.value) >= 0 : false;\n\t\t\t});\n\t\t}\n\t};\n\n\tCheckboxControl.prototype.get_value = function(node, task, sns) {\n\t\tif(sns.single_value){\n\t\t\tvar box = node.querySelector(\"input[type=checkbox]\");\n\t\t\treturn box.checked;\n\t\t}else{\n\t\t\treturn helpers.arrayMap(Array.prototype.slice.call(node.querySelectorAll(\"input[type=checkbox]:checked\")), function(entry) {\n\t\t\t\treturn entry.value;\n\t\t\t});\n\t\t}\n\t};\n\n\tCheckboxControl.prototype.focus = function(node) {\n\t\tgantt._focus(node.querySelector(\"input[type=checkbox]\"));\n\t};\n\n\treturn CheckboxControl;\n};","import __extends from \"../../../../utils/extends\";\nimport Super from \"./base_control\";\n\nexport default function(gantt) {\n\tconst _super = Super(gantt);\n\n\tfunction RadioControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\n\t\treturn self; \n\t}\n\n\t__extends(RadioControl, _super);\n\n\tRadioControl.prototype.render = function(sns) {\n\t\tconst height = sns.height ? `${sns.height}px` : '';\n\t\tlet html = `<div class='gantt_cal_ltext gantt_cal_lradio gantt_section_${sns.name}' ${height ? `style='height:${height};'` : ''}>`;\n\n\t\tif (sns.options && sns.options.length) {\n\t\t\tfor (var i = 0; i < sns.options.length; i++) {\n\t\t\t\thtml += \"<label><input type='radio' value='\" + sns.options[i].key + \"' name='\" + sns.name + \"'>\" + sns.options[i].label + \"</label>\";\n\t\t\t}\n\t\t}\n\n\t\thtml += \"</div>\";\n\t\treturn html;\n\t};\n\n\tRadioControl.prototype.set_value = function(node, value, ev, sns) {\n\t\tvar radio;\n\n\t\tif (!sns.options || !sns.options.length) return;\n\n\t\tradio = node.querySelector(\"input[type=radio][value='\" + value + \"']\") ||\n\t\t\t\tnode.querySelector(\"input[type=radio][value='\" + sns.default_value + \"']\");\n\n\t\tif (!radio) return;\n\n\t\tif (!node._dhx_onchange && sns.onchange) {\n\t\t\tnode.onchange = sns.onchange;\n\t\t\tnode._dhx_onchange = true;\n\t\t}\n\n\t\tradio.checked = true;\n\t};\n\n\tRadioControl.prototype.get_value = function(node, ev) {\n\t\tvar result = node.querySelector(\"input[type=radio]:checked\");\n\n\t\treturn result ? result.value : \"\";\n\t};\n\n\tRadioControl.prototype.focus = function(node) {\n\t\tgantt._focus(node.querySelector(\"input[type=radio]\"));\n\t};\n\n\treturn RadioControl;\n};","import __extends from \"../../../../utils/extends\";\n\nimport DurationFormatterNumeric from  \"../../../common/duration_formatter_numeric\";\nimport BaseConstrutor from \"./base_control\";\n\nexport default function(gantt) {\n\tvar _super = BaseConstrutor(gantt);\n\n\tfunction DurationControl() {\n\t\tvar self = _super.apply(this, arguments) || this; \n\n\t\treturn self; \n\t}\n\n\tfunction getFormatter(config) {\n\t\treturn config.formatter || new DurationFormatterNumeric();\n\t}\n\n\t__extends(DurationControl, _super);\n\n\tDurationControl.prototype.render = function(sns) {\n\t\tvar time = \"<div class='gantt_time_selects'>\" + gantt.form_blocks.getTimePicker.call(this, sns) + \"</div>\";\n\t\tvar label = \" \"+ gantt.locale.labels[gantt.config.duration_unit + \"s\"] +\" \";\n\t\tvar singleDate = sns.single_date ? \" style='display:none'\" : \"\";\n\t\tvar readonly = sns.readonly ? \" disabled='disabled'\" : \"\";\n\t\tvar ariaAttr = gantt._waiAria.lightboxDurationInputAttrString(sns);\n\n\t\tvar durationInputClass = \"gantt_duration_value\";\n\t\tif(sns.formatter) {\n\t\t\tlabel = \"\";\n\t\t\tdurationInputClass += \" gantt_duration_value_formatted\" ;\n\t\t}\n\n\t\tvar duration = \"<div class='gantt_duration' \" + singleDate + \">\" +\n\t\t\"<div class='gantt_duration_inputs'>\" +\n\t\t\t\"<input type='button' class='gantt_duration_dec' value=''\" + readonly + \">\" +\n\t\t\t\"<input type='text' value='5days' class='\"+durationInputClass+\"'\" + readonly + \" \" + ariaAttr + \">\" +\n\t\t\t\"<input type='button' class='gantt_duration_inc' value='+'\" + readonly + \">\"+\n\t\t\t\"</div>\" +\n\t\t\t\"<div class='gantt_duration_end_date'>\"+label+\"<span></span></div>\" +\n\t\t\t\"</div>\" +\n\t\t\t\"</div>\";\n\t\tlet sectionClassName = \"gantt_section_time gantt_section_duration\";\n\t\tif (sns.name !== \"time\"){\n\t\t\tsectionClassName += \" gantt_section_\" + sns.name;\n\t\t}\t\n\t\tvar html = \"<div style='padding-top:0px;font-size:inherit;' class='\" + sectionClassName + \"'>\" + time + \" \" + duration + \"</div>\";\n\t\treturn html;\n\t};\n\n\tDurationControl.prototype.set_value = function(node, value, ev, config) {\n\t\tvar s = node.getElementsByTagName(\"select\");\n\t\tvar inps = node.getElementsByTagName(\"input\");\n\t\tvar duration = inps[1];\n\t\tvar btns = [inps[0], inps[2]];\n\t\tvar endspan = node.getElementsByTagName(\"span\")[0];\n\t\tvar map = config._time_format_order;\n\t\tvar mapping;\n\t\tvar start_date;\n\t\tvar end_date;\n\t\tvar duration_val;\n\n\t\tfunction _calc_date() {\n\t\t\tvar start_date = _getStartDate.call(gantt, node, config);\n\t\t\tvar duration = _getDuration.call(gantt, node, config);\n\t\t\tvar end_date = gantt.calculateEndDate({start_date: start_date, duration: duration, task: ev});\n\n\t\t\tvar template = gantt.templates.task_end_date || gantt.templates.task_date;\n\t\t\tendspan.innerHTML = template(end_date);\n\t\t}\n\n\t\tfunction _change_duration(step) {\n\t\t\tvar value = duration.value;\n\n\t\t\tvalue = getFormatter(config).parse(value);\n\t\t\tif (window.isNaN(value))\n\t\t\t\tvalue = 0;\n\t\t\tvalue += step;\n\t\t\tif (value < 1) value = 1;\n\t\t\tduration.value = getFormatter(config).format(value);\n\t\t\t_calc_date();\n\t\t}\n\n\t\tbtns[0].onclick = gantt.bind(function() {\n\t\t\t_change_duration(-1 * gantt.config.duration_step);\n\t\t}, this);\n\t\tbtns[1].onclick = gantt.bind(function() {\n\t\t\t_change_duration(1 * gantt.config.duration_step);\n\t\t}, this);\n\t\ts[0].onchange = _calc_date;\n\t\ts[1].onchange = _calc_date;\n\t\ts[2].onchange = _calc_date;\n\t\tif (s[3]) s[3].onchange = _calc_date;\n\n\t\tduration.onkeydown = gantt.bind(function(e) {\n\t\t\tvar code; \n\n\t\t\te = e || window.event;\n\t\t\tcode = (e.charCode || e.keyCode || e.which);\n\t\t\t\n\t\t\tif (code == gantt.constants.KEY_CODES.DOWN) {\n\t\t\t\t_change_duration(-1 * gantt.config.duration_step);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (code == gantt.constants.KEY_CODES.UP) {\n\t\t\t\t_change_duration(1 * gantt.config.duration_step);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\twindow.setTimeout(_calc_date, 1);\n\t\t}, this);\n\n\t\tduration.onchange = gantt.bind(_calc_date, this);\n\n\t\tmapping = gantt._resolve_default_mapping(config);\n\t\tif (typeof(mapping) === \"string\") mapping = {start_date: mapping};\n\n\t\tstart_date = ev[mapping.start_date] || new Date();\n\t\tend_date = ev[mapping.end_date] || gantt.calculateEndDate({\n\t\t\tstart_date: start_date,\n\t\t\tduration: 1,\n\t\t\ttask: ev\n\t\t});\n\t\tduration_val = Math.round(ev[mapping.duration]) || gantt.calculateDuration({\n\t\t\tstart_date: start_date,\n\t\t\tend_date: end_date,\n\t\t\ttask: ev\n\t\t});\n\t\tduration_val = getFormatter(config).format(duration_val);\n\n\t\tgantt.form_blocks._fill_lightbox_select(s, 0, start_date, map, config);\n\t\tduration.value = duration_val;\n\t\t_calc_date();\n\t};\n\n\tDurationControl.prototype.get_value = function(node, ev, config) {\n\t\tvar startDate = _getStartDate(node, config);\n\t\tvar duration = _getDuration(node, config);\n\t\tvar endDate = gantt.calculateEndDate({start_date: startDate, duration: duration, task: ev});\n\n\t\tif (typeof gantt._resolve_default_mapping(config) == \"string\") {\n\t\t\treturn startDate;\n\t\t}\n\n\t\treturn {\n\t\t\tstart_date: startDate,\n\t\t\tend_date: endDate,\n\t\t\tduration: duration\n\t\t};\n\t};\n\n\tDurationControl.prototype.focus = function(node) {\n\t\tgantt._focus(node.getElementsByTagName(\"select\")[0]);\n\t};\n\n\n\tfunction _getStartDate(node, config) {\n\t\tvar s = node.getElementsByTagName(\"select\");\n\t\tvar map = config._time_format_order;\n\t\tvar hours = 0;\n\t\tvar minutes = 0;\n\n\t\tif (gantt.defined(map[3])) {\n\t\t\tvar input = s[map[3]];\n\t\t\tvar time = parseInt(input.value, 10);\n\t\t\tif (isNaN(time) && input.hasAttribute(\"data-value\")) {\n\t\t\t\ttime = parseInt(input.getAttribute(\"data-value\"), 10);\n\t\t\t}\n\n\t\t\thours = Math.floor(time / 60);\n\t\t\tminutes = time % 60;\n\t\t}\n\t\treturn new Date(s[map[2]].value, s[map[1]].value, s[map[0]].value, hours, minutes);\n\t}\n\n\tfunction _getDuration(node, config) {\n\t\tvar duration = node.getElementsByTagName(\"input\")[1];\n\n\t\tduration = getFormatter(config).parse(duration.value);\n\t\tif (!duration || window.isNaN(duration)) duration = 1;\n\t\tif (duration < 0) duration *= -1;\n\t\treturn duration;\n\t}\n\n\treturn DurationControl; \n};","import __extends from \"../../../../utils/extends\";\nimport htmlHelpers from \"../../utils/html_helpers\";\nimport BaseConstrutor from \"./base_control\";\n\nexport default function(gantt) {\n\tvar _super = BaseConstrutor(gantt);\n\n\tfunction ConstraintControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\t\treturn self;\n\t}\n\n\t__extends(ConstraintControl, _super);\n\n\tfunction isNonTimedConstraint(value) {\n\t\tif (!value || value === gantt.config.constraint_types.ASAP || value === gantt.config.constraint_types.ALAP) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tfunction toggleTimeSelect(timeSelects, typeValue) {\n\t\tvar isNonTimed = isNonTimedConstraint(typeValue);\n\t\tfor (var i = 0; i < timeSelects.length; i++) {\n\t\t\ttimeSelects[i].disabled = isNonTimed;\n\t\t}\n\t}\n\n\tConstraintControl.prototype.render = function (sns) {\n\t\tconst height = sns.height ? `height:${sns.height}px;` : '';\n\t\tlet html = `<div class='gantt_cal_ltext gantt_section_${sns.name}' ${height ? `style='${height}'` : ''}>`;\n\n\t\tvar options = [];\n\t\tfor (var i in gantt.config.constraint_types) {\n\t\t\toptions.push({ key: gantt.config.constraint_types[i], label: gantt.locale.labels[gantt.config.constraint_types[i]] });\n\t\t}\n\n\t\tsns.options = sns.options || options;\n\n\t\thtml += \"<span data-constraint-type-select>\" + htmlHelpers.getHtmlSelect(sns.options, [{ key: \"data-type\", value: \"constraint-type\" }]) + \"</span>\";\n\n\t\tvar timeLabel = gantt.locale.labels[\"constraint_date\"] || \"Constraint date\";\n\t\thtml += \"<label data-constraint-time-select>\" + timeLabel + \": \" + gantt.form_blocks.getTimePicker.call(this, sns) + \"</label>\";\n\n\t\thtml += \"</div>\";\n\t\treturn html;\n\t};\n\n\tConstraintControl.prototype.set_value = function (node, value, task, config) {\n\t\tvar typeSelect = node.querySelector(\"[data-constraint-type-select] select\");\n\t\tvar timeSelects = node.querySelectorAll(\"[data-constraint-time-select] select\");\n\t\tvar map = config._time_format_order;\n\n\t\tvar mapping = gantt._resolve_default_mapping(config);\n\n\t\tif (!typeSelect._eventsInitialized) {\n\t\t\ttypeSelect.addEventListener(\"change\", function (e) {\n\t\t\t\ttoggleTimeSelect(timeSelects, e.target.value);\n\t\t\t});\n\t\t\ttypeSelect._eventsInitialized = true;\n\t\t}\n\n\t\tvar constraintDate = task[mapping.constraint_date] || new Date();\n\t\tgantt.form_blocks._fill_lightbox_select(timeSelects, 0, constraintDate, map, config);\n\n\t\tvar constraintType = task[mapping.constraint_type] || gantt.getConstraintType(task);\n\t\ttypeSelect.value = constraintType;\n\t\ttoggleTimeSelect(timeSelects, constraintType);\n\t};\n\n\tConstraintControl.prototype.get_value = function (node, task, config) {\n\t\tvar typeSelect = node.querySelector(\"[data-constraint-type-select] select\");\n\t\tvar timeSelects = node.querySelectorAll(\"[data-constraint-time-select] select\");\n\n\t\tvar constraintType = typeSelect.value;\n\t\tvar constraintDate = null;\n\t\tif (!isNonTimedConstraint(constraintType)) {\n\t\t\tconstraintDate = gantt.form_blocks.getTimePickerValue(timeSelects, config);\n\t\t}\n\n\t\treturn {\n\t\t\tconstraint_type: constraintType,\n\t\t\tconstraint_date: constraintDate\n\t\t};\n\t};\n\n\tConstraintControl.prototype.focus = function (node) {\n\t\tgantt._focus(node.querySelector(\"select\"));\n\t};\n\n\treturn ConstraintControl;\n};","import __extends from \"../../../../utils/extends\";\n\nimport Super from \"./select_control\";\n\nexport default function(gantt) {\n\tconst _super = Super(gantt);\n\n\tfunction TypeselectControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\n\t\treturn self;\n\t}\n\n\t__extends(TypeselectControl, _super);\n\n\tTypeselectControl.prototype.render = function(sns) {\n\t\tvar types = gantt.config.types,\n\t\t\tlocale = gantt.locale.labels,\n\t\t\toptions = [];\n\n\t\tvar filter = sns.filter || function (typeKey, typeValue) {\n\t\t\tif (!types.placeholder || typeValue !== types.placeholder) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t\tfor (var i in types) {\n\t\t\tif (!filter(i, types[i]) === false) {\n\t\t\t\toptions.push({ key: types[i], label: locale[\"type_\" + i] });\n\t\t\t}\n\t\t}\n\t\tsns.options = options;\n\n\t\tvar oldOnChange = sns.onchange;\n\t\tsns.onchange = function () {\n\t\t\tgantt._lightbox_current_type = this.value;\n\t\t\tgantt.changeLightboxType(this.value);\n\t\t\tif (typeof oldOnChange == 'function') {\n\t\t\t\toldOnChange.apply(this, arguments);\n\t\t\t}\n\t\t};\n\n\t\treturn _super.prototype.render.apply(this, arguments);\n\t};\n\n\treturn TypeselectControl;\n};\n","\nimport __extends from \"../../../../utils/extends\";\nimport DurationFormatterNumeric from \"../../../common/duration_formatter_numeric\";\nimport BaseConstrutor from \"./base_control\";\n\nexport default function(gantt) {\n\tvar _super = BaseConstrutor(gantt);\n\n\tfunction DurationControl() {\n\t\tvar self = _super.apply(this, arguments) || this; \n\n\t\treturn self; \n\t}\n\n\tfunction getFormatter(config) {\n\t\treturn config.formatter || new DurationFormatterNumeric();\n\t}\n\n\tfunction _generateBaselineRow (node, baseline, task, config){\n\t\tconst time = \"<div class='gantt_time_selects'>\" + gantt.form_blocks.getTimePicker.call(gantt, config) + \"</div>\";\n\t\tlet durationLabel = \" \"+ gantt.locale.labels[gantt.config.duration_unit + \"s\"] +\" \";\n\t\tconst singleDate = config.single_date ? \" style='display:none'\" : \"\";\n\t\tconst readonly = config.readonly ? \" disabled='disabled'\" : \"\";\n\t\tconst ariaAttr = gantt._waiAria.lightboxDurationInputAttrString(config);\n\t\tconst deleteLabel = gantt.locale.labels.baselines_remove_button;\n\n\t\tlet durationInputClass = \"gantt_duration_value\";\n\t\tif(config.formatter) {\n\t\t\tdurationLabel = \"\";\n\t\t\tdurationInputClass += \" gantt_duration_value_formatted\";\n\t\t}\n\n\t\tconst durationEl = \"<div class='gantt_duration' \" + singleDate + \">\" +\n\t\t\"<div class='gantt_duration_inputs'>\" +\n\t\t\t\"<input type='button' class='gantt_duration_dec' value='-'\" + readonly + \">\" +\n\t\t\t\"<input type='text' value='5days' class='\"+durationInputClass+\"'\" + readonly + \" \" + ariaAttr + \">\" +\n\t\t\t\"<input type='button' class='gantt_duration_inc' value='+'\" + readonly + \">\"+\n\t\t\t\"</div>\" +\n\t\t\t\"<div class='gantt_duration_end_date'>\"+durationLabel+\"<span></span></div>\" +\n\t\t\t\"</div>\" +\n\t\t\t\"</div>\";\n\n\t\tconst deleteButton = `<div><div class='baseline_delete_button gantt_custom_button dhx_gantt_icon dhx_gantt_icon_delete' aria-label='${deleteLabel}'></div></div>`;\n\n\t\tconst baselineRow = document.createElement(\"div\");\n\t\tbaselineRow.className = \"gantt_section_time gantt_section_duration\";\n\t\tbaselineRow.setAttribute(\"data-baseline-id\", baseline.id);\n\t\tbaselineRow.innerHTML = time + durationEl + deleteButton + \"<br>\";\n\t\tnode.appendChild(baselineRow);\n\n\t\tvar s = baselineRow.getElementsByTagName(\"select\");\n\t\tvar inps = baselineRow.getElementsByTagName(\"input\");\n\t\tvar duration = inps[1];\n\t\tvar btns = [inps[0], inps[2]];\n\t\tvar endspan = baselineRow.getElementsByTagName(\"span\")[0];\n\t\tvar map = config._time_format_order;\n\t\tvar mapping;\n\t\tvar start_date;\n\t\tvar end_date;\n\t\tvar duration_val;\n\n\t\tconst deleteEl = baselineRow.querySelector(\".baseline_delete_button\");\n\t\tdeleteEl.onclick = function(e){\n\t\t\tconst section = baselineRow.parentNode;\n\t\t\tbaselineRow.innerHTML = \"\";\n\t\t\tbaselineRow.remove();\n\t\t\tif (section.innerHTML === \"\"){\n\t\t\t\tsection.innerHTML = gantt.locale.labels.baselines_section_placeholder;\n\t\t\t}\n\t\t};\n\t\t\n\n\t\tfunction _calc_date() {\n\t\t\tvar start_date = _getStartDate.call(gantt, baselineRow, config);\n\t\t\tvar duration = _getDuration.call(gantt, baselineRow, config);\n\t\t\tvar end_date = gantt.calculateEndDate({start_date: start_date, duration: duration, task: task});\n\n\t\t\tvar template = gantt.templates.task_end_date || gantt.templates.task_date;\n\t\t\tendspan.innerHTML = template(end_date);\n\t\t}\n\n\t\tfunction _change_duration(step) {\n\t\t\tvar value = duration.value;\n\n\t\t\tvalue = getFormatter(config).parse(value);\n\t\t\tif (window.isNaN(value))\n\t\t\t\tvalue = 0;\n\t\t\tvalue += step;\n\t\t\tif (value < 1) value = 1;\n\t\t\tduration.value = getFormatter(config).format(value);\n\t\t\t_calc_date();\n\t\t}\n\n\t\tbtns[0].onclick = gantt.bind(function() {\n\t\t\t_change_duration(-1 * gantt.config.duration_step);\n\t\t}, gantt);\n\t\tbtns[1].onclick = gantt.bind(function() {\n\t\t\t_change_duration(1 * gantt.config.duration_step);\n\t\t}, gantt);\n\t\ts[0].onchange = _calc_date;\n\t\ts[1].onchange = _calc_date;\n\t\ts[2].onchange = _calc_date;\n\t\tif (s[3]) s[3].onchange = _calc_date;\n\n\t\tduration.onkeydown = gantt.bind(function(e) {\n\t\t\tvar code; \n\n\t\t\te = e || window.event;\n\t\t\tcode = (e.charCode || e.keyCode || e.which);\n\t\t\t\n\t\t\tif (code == gantt.constants.KEY_CODES.DOWN) {\n\t\t\t\t_change_duration(-1 * gantt.config.duration_step);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (code == gantt.constants.KEY_CODES.UP) {\n\t\t\t\t_change_duration(1 * gantt.config.duration_step);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\twindow.setTimeout(_calc_date, 1);\n\t\t}, gantt);\n\n\t\tduration.onchange = gantt.bind(_calc_date, gantt);\n\n\t\tmapping = gantt._resolve_default_mapping(config);\n\t\tif (typeof(mapping) === \"string\") mapping = {start_date: mapping};\n\n\t\tstart_date = baseline.start_date || new Date();\n\t\tend_date = baseline.end_date || gantt.calculateEndDate({\n\t\t\tstart_date: start_date,\n\t\t\tduration: 1,\n\t\t\ttask\n\t\t});\n\t\tduration_val = gantt.calculateDuration({\n\t\t\tstart_date: start_date,\n\t\t\tend_date: end_date,\n\t\t\ttask\n\t\t});\n\t\tduration_val = getFormatter(config).format(duration_val);\n\n\t\tgantt.form_blocks._fill_lightbox_select(s, 0, start_date, map, config);\n\t\tduration.value = duration_val;\n\t\t_calc_date();\n\t}\n\n\t__extends(DurationControl, _super);\n\n\tDurationControl.prototype.render = function(sns) {\n\t\tconst baselineSection = `<div style='height: ${sns.height || 110}px; font-size:inherit;' class='gantt_section_baselines'></div>`;\n\t\treturn baselineSection;\n\t};\n\n\tDurationControl.prototype.set_value = function(node, value, task, config) {\n\t\tif (task.baselines){\n\t\t\tnode.innerHTML = \"\";\n\n\t\t\ttask.baselines.forEach((baseline)=>{\n\t\t\t\t_generateBaselineRow(node, baseline, task, config);\n\t\t\t});\n\t\t} else {\n\t\t\tnode.innerHTML = gantt.locale.labels.baselines_section_placeholder;\n\t\t}\t\t\n\n\t};\n\n\tDurationControl.prototype.get_value = function(node, task, config) {\n\t\tconst baselines = [];\n\t\tconst baselineRows = node.querySelectorAll(`[data-baseline-id]`);\n\t\tbaselineRows.forEach((baselineNode)=>{\n\t\t\tconst baselineId = baselineNode.dataset.baselineId;\n\t\t\tconst baselineStore = gantt.getDatastore(\"baselines\");\n\t\t\tlet baseline = baselineStore.getItem(baselineId);\n\t\t\tlet updatedBaseline;\n\t\t\tif (baseline){\n\t\t\t\tupdatedBaseline = gantt.copy(baseline);\n\t\t\t} else {\n\t\t\t\tupdatedBaseline = {\n\t\t\t\t\tid: gantt.uid(),\n\t\t\t\t\ttask_id: task.id,\n\t\t\t\t\ttext: \"Baseline 1\"\n\t\t\t\t};\n\t\t\t}\n\t\t\tupdatedBaseline.start_date = _getStartDate(baselineNode, config);\n\t\t\tupdatedBaseline.duration = _getDuration(baselineNode, config);\n\t\t\tupdatedBaseline.end_date = gantt.calculateEndDate({start_date: updatedBaseline.start_date, duration: updatedBaseline.duration, task});\n\n\t\t\tbaselines.push(updatedBaseline);\n\t\t});\n\n\t\treturn baselines;\n\t};\n\n\tDurationControl.prototype.button_click = function (index, el, section, container) {\n\t\tif (gantt.callEvent(\"onSectionButton\", [gantt._lightbox_id, section]) === false) {\n\t\t\treturn;\n\t\t}\n\t\tif (el.closest(\".gantt_custom_button.gantt_remove_baselines\")){\n\t\t\tcontainer.innerHTML = gantt.locale.labels.baselines_section_placeholder;\n\t\t}\n\t\tif (el.closest(\".gantt_custom_button.gantt_add_baselines\")){\n\t\t\tif (container.innerHTML == gantt.locale.labels.baselines_section_placeholder){\n\t\t\t\tcontainer.innerHTML = \"\";\n\t\t\t}\n\t\t\tconst task = gantt.getTask(gantt._lightbox_id);\n\t\t\tconst baseline = {\n\t\t\t\tid: gantt.uid(),\n\t\t\t\ttask_id: task.id,\n\t\t\t\ttext: \"Baseline 1\",\n\t\t\t\tstart_date: task.start_date,\n\t\t\t\tend_date: task.end_date\n\t\t\t};\n\t\t\tconst config = gantt._get_typed_lightbox_config()[index];\n\t\t\t_generateBaselineRow(container, baseline, task, config);\n\t\t}\n\t};\n\n\tDurationControl.prototype.focus = function(node) {\n\t\tgantt._focus(node.getElementsByTagName(\"select\")[0]);\n\t};\n\n\n\tfunction _getStartDate(node, config) {\n\t\tvar s = node.getElementsByTagName(\"select\");\n\t\tvar map = config._time_format_order;\n\t\tvar hours = 0;\n\t\tvar minutes = 0;\n\n\t\tif (gantt.defined(map[3])) {\n\t\t\tvar input = s[map[3]];\n\t\t\tvar time = parseInt(input.value, 10);\n\t\t\tif (isNaN(time) && input.hasAttribute(\"data-value\")) {\n\t\t\t\ttime = parseInt(input.getAttribute(\"data-value\"), 10);\n\t\t\t}\n\n\t\t\thours = Math.floor(time / 60);\n\t\t\tminutes = time % 60;\n\t\t}\n\t\treturn new Date(s[map[2]].value, s[map[1]].value, s[map[0]].value, hours, minutes);\n\t}\n\n\tfunction _getDuration(node, config) {\n\t\tvar duration = node.getElementsByTagName(\"input\")[1];\n\n\t\tduration = getFormatter(config).parse(duration.value);\n\t\tif (!duration || window.isNaN(duration)) duration = 1;\n\t\tif (duration < 0) duration *= -1;\n\t\treturn duration;\n\t}\n\n\treturn DurationControl; \n};","import * as utils from \"../utils/utils\";\nimport env from \"../utils/env\";\nimport isHeadless from \"../utils/is_headless\";\nimport * as domHelpers from \"./ui/utils/dom_helpers\";\nimport * as codeHelpers from \"../utils/helpers\";\nimport domEventScope from \"./ui/utils/dom_event_scope\";\nimport messages from \"./ui/message\";\nimport ui from \"./ui/index\";\nimport createLayoutFacade from \"./facades/layout\";\nimport taskLayers from \"./data_task_layers\";\n\nimport skin from \"./ui/skin\";\nimport skyblue from \"../css/skins/skyblue\";\nimport meadow from \"../css/skins/meadow\";\nimport terrace from \"../css/skins/terrace\";\nimport broadway from \"../css/skins/broadway\";\nimport material from \"../css/skins/material\";\nimport dark from \"../css/skins/dark\";\nimport contrast_black from \"../css/skins/contrast_black\";\nimport contrast_white from \"../css/skins/contrast_white\";\nimport plugins from \"./ui/plugins\";\nimport touch from \"./ui/touch\";\nimport lightbox from \"./ui/lightbox\";\nimport lightbox_optional_time from \"./ui/lightbox/lightbox_optional_time\";\nimport wai_aria from \"./ui/wai_aria\";\n\n\nexport default function(gantt) {\n\n\tif(!env.isNode){\n\n\t\tgantt.utils = {\n\t\t\tarrayFind: codeHelpers.arrayFind,\n\t\t\tdom: domHelpers\n\t\t};\n\n\t\tvar domEvents = domEventScope();\n\t\tgantt.event = domEvents.attach;\n\t\tgantt.eventRemove = domEvents.detach;\n\t\tgantt._eventRemoveAll = domEvents.detachAll;\n\t\tgantt._createDomEventScope = domEvents.extend;\n\n\t\tutils.mixin(gantt, messages(gantt));\n\t\tvar uiApi = ui.init(gantt);\n\t\tgantt.$ui = uiApi.factory;\n\t\tgantt.$ui.layers = uiApi.render;\n\t\tgantt.$mouseEvents = uiApi.mouseEvents;\n\t\tgantt.$services.setService(\"mouseEvents\", function () {\n\t\t\treturn gantt.$mouseEvents;\n\t\t});\n\t\tgantt.mixin(gantt, uiApi.layersApi);\n\n\t\ttaskLayers(gantt);\n\n\t\tgantt.$services.setService(\"layers\", function () {\n\t\t\treturn uiApi.layersService;\n\t\t});\n\n\t\tgantt.mixin(gantt, createLayoutFacade());\n\t\tskin(gantt);\n\t\tskyblue(gantt);\n\t\tdark(gantt);\n\t\tmeadow(gantt);\n\t\tterrace(gantt);\n\t\tbroadway(gantt);\n\t\tmaterial(gantt);\n\t\tcontrast_black(gantt);\n\t\tcontrast_white(gantt);\n\t\tplugins(gantt);\n\t\ttouch(gantt);\n\t\tlightbox(gantt);\n\t\tlightbox_optional_time(gantt);\n\t\twai_aria(gantt);\n\n\t\tgantt.locate = function(e) {\n\t\t\tvar trg = domHelpers.getTargetNode(e);\n\n\t\t\t// ignore empty rows/cells of the timeline\n\t\t\tif(domHelpers.closest(trg, \".gantt_task_row\")){\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tvar targetAttribute = arguments[1] || this.config.task_attribute;\n\n\t\t\tvar node = domHelpers.locateAttribute(trg, targetAttribute);\n\t\t\tif(node){\n\t\t\t\treturn node.getAttribute(targetAttribute);\n\t\t\t}else{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t};\n\n\t\tgantt._locate_css = function(e, classname, strict){\n\t\t\treturn domHelpers.locateClassName(e, classname, strict);\n\t\t};\n\n\t\tgantt._locateHTML = function(e, attribute) {\n\t\t\treturn domHelpers.locateAttribute(e, attribute || this.config.task_attribute);\n\t\t};\n\t}\n\n\tgantt.attachEvent(\"onParse\", function(){\n\t\tif(!isHeadless(gantt)){\n\t\t\tgantt.attachEvent(\"onGanttRender\", function(){\n\t\t\t\tif(gantt.config.initial_scroll){\n\t\t\t\t\tvar firstTask = gantt.getTaskByIndex(0);\n\t\t\t\t\tvar id = firstTask ? firstTask.id : gantt.config.root_id;\n\t\t\t\t\t// GS-1450. Don't scroll to the task if there is no timeline\n\t\t\t\t\tif(gantt.isTaskExists(id) && gantt.$task && gantt.utils.dom.isChildOf(gantt.$task, gantt.$container)){\n\t\t\t\t\t\tgantt.showTask(id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, {once: true});\n\t\t}\n\n\t});\n\n\tgantt.attachEvent(\"onBeforeGanttReady\", function(){\n\t\tif (!this.config.scroll_size)\n\t\t\tthis.config.scroll_size = domHelpers.getScrollSize() || 15;\n\n\t\tif(!isHeadless(gantt)){\n\t\t\t// detach listeners before clearing old DOM, possible IE errors when accessing detached nodes\n\t\t\tthis._eventRemoveAll();\n\t\t\tthis.$mouseEvents.reset();\n\n\t\t\tthis.resetLightbox();\n\t\t}\n\n\t});\n\n\t// GS-1261: scroll the views to the right side when RTL is enabled\n\tgantt.attachEvent(\"onGanttReady\", function(){\n\t\tif(!isHeadless(gantt) && gantt.config.rtl){\n\t\t\tgantt.$layout.getCellsByType(\"viewCell\").forEach(function(cell){ \n\t\t\t\tvar attachedScrollbar = cell.$config.scrollX;\n\t\t\t\tif (!attachedScrollbar) return;\n\n\t\t\t\tvar scrollbar = gantt.$ui.getView(attachedScrollbar);\n\t\t\t\tif (scrollbar) scrollbar.scrollTo(scrollbar.$config.scrollSize,0);\n\n\t\t\t});\n\t\t}\n\t});\n\n\t// GS-1649: check if extensions are connected via files\n\tgantt.attachEvent(\"onGanttReady\", function(){\n\t\tif(!isHeadless(gantt)){\n\n\t\t\tvar activePlugins = gantt.plugins();\n\n\t\t\tvar availablePlugins = {\n\t\t\t\tauto_scheduling: gantt.autoSchedule,\n\t\t\t\tclick_drag: gantt.ext.clickDrag,\n\t\t\t\tcritical_path: gantt.isCriticalTask,\n\t\t\t\tdrag_timeline: gantt.ext.dragTimeline,\n\t\t\t\texport_api: gantt.exportToPDF,\n\t\t\t\tfullscreen: gantt.ext.fullscreen,\n\t\t\t\tgrouping: gantt.groupBy,\n\t\t\t\tkeyboard_navigation: gantt.ext.keyboardNavigation,\n\t\t\t\tmarker: gantt.addMarker,\n\t\t\t\tmultiselect: gantt.eachSelectedTask,\n\t\t\t\toverlay: gantt.ext.overlay,\n\t\t\t\tquick_info: gantt.templates.quick_info_content,\n\t\t\t\ttooltip: gantt.ext.tooltips,\n\t\t\t\tundo: gantt.undo\n\t\t\t};\n\n\t\t\tfor (let plugin in availablePlugins){\n\t\t\t\tif (availablePlugins[plugin] && !activePlugins[plugin]){\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.warn(`You connected the '${plugin}' extension via an obsolete file. \nTo fix it, you need to remove the obsolete file and connect the extension via the plugins method: https://docs.dhtmlx.com/gantt/api__gantt_plugins.html`);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n};","function createLayoutFacade(){\n\n\tfunction getTimeline(gantt){\n\t\treturn gantt.$ui.getView(\"timeline\");\n\t}\n\n\tfunction getGrid(gantt){\n\t\treturn gantt.$ui.getView(\"grid\");\n\t}\n\n\tfunction getBaseCell(gantt){\n\t\tvar timeline = getTimeline(gantt);\n\t\tif (timeline && !timeline.$config.hidden){\n\t\t\treturn timeline;\n\t\t} else{\n\t\t\tvar grid = getGrid(gantt);\n\t\t\tif (grid && !grid.$config.hidden){\n\t\t\t\treturn grid;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction getVerticalScrollbar(gantt){\n\t\tvar baseCell = null;\n\t\t// GS-1150: if we reorder or resize something in the grid, we should obtain the grid container\n\t\tvar gridDrag = false;\n\t\tvar gridMarkers = [\n\t\t\t\".gantt_drag_marker.gantt_grid_resize_area\",\n\t\t\t\".gantt_drag_marker .gantt_row.gantt_row_task\",\n\t\t\t\".gantt_drag_marker.gantt_grid_dnd_marker\"\n\t\t];\n\t\tgridMarkers.forEach(function (selector) {\n\t\t\tgridDrag = gridDrag || !!document.querySelector(selector);\n\t\t});\n\t\tif (gridDrag){\n\t\t\tbaseCell = getGrid(gantt);\n\t\t} else{\n\t\t\tbaseCell = getBaseCell(gantt);\n\t\t}\n\n\t\t// GS-1827. If there is no grid and timeline, there is no scrollbar for them\n\t\tif (!baseCell){\n\t\t\treturn null;\n\t\t}\n\n\t\tvar verticalScrollbar = getAttachedScrollbar(gantt, baseCell, \"scrollY\");\n\t\treturn verticalScrollbar;\n\t}\n\n\tfunction getHorizontalScrollbar(gantt){\n\t\tvar baseCell = getBaseCell(gantt);\n\t\tif (!baseCell || baseCell.id == \"grid\"){\n\t\t\treturn null; // if the timeline is not displayed, do not return the scrollbar\n\t\t}\n\t\tvar horizontalScrollbar = getAttachedScrollbar(gantt, baseCell, \"scrollX\");\n\t\treturn horizontalScrollbar;\n\t}\n\n\tfunction getAttachedScrollbar(gantt, cell, type){\n\t\tvar attachedScrollbar = cell.$config[type];\n\t\tvar scrollbarView = gantt.$ui.getView(attachedScrollbar);\n\t\treturn scrollbarView;\n\t}\n\n\tvar DEFAULT_VALUE = \"DEFAULT_VALUE\";\n\n\tfunction tryCall(getView, method, args, fallback){\n\t\tvar view = getView(this);\n\t\tif (!(view && view.isVisible())) {\n\t\t\tif(fallback){\n\t\t\t\treturn fallback();\n\t\t\t}else{\n\t\t\t\treturn DEFAULT_VALUE;\n\t\t\t}\n\t\t} else {\n\t\t\treturn view[method].apply(view, args);\n\t\t}\n\t}\n\n\treturn {\n\n\t\tgetColumnIndex: function(name) {\n\t\t\tvar res = tryCall.call(this, getGrid, \"getColumnIndex\", [name]);\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\tdateFromPos: function(x) {\n\t\t\tvar res = tryCall.call(this, getTimeline, \"dateFromPos\", Array.prototype.slice.call(arguments));\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn this.getState().min_date;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\tposFromDate: function(date) {\n\t\t\tvar res = tryCall.call(this, getTimeline, \"posFromDate\", Array.prototype.slice.call(arguments));\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\tgetRowTop: function(index) {\n\t\t\tvar self = this;\n\t\t\tvar res = tryCall.call(self, getTimeline, \"getRowTop\", [index],\n\t\t\t\tfunction(){ return tryCall.call(self, getGrid, \"getRowTop\", [index]);}\n\t\t\t\t);\n\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\tgetTaskTop: function(id) {\n\t\t\tvar self = this;\n\t\t\tvar res = tryCall.call(self, getTimeline, \"getItemTop\", [id],\n\t\t\t\tfunction(){ return tryCall.call(self, getGrid, \"getItemTop\", [id]);}\n\t\t\t);\n\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\n\t\tgetTaskPosition: function(task, start_date, end_date) {\n\t\t\tvar res = tryCall.call(this, getTimeline, \"getItemPosition\", [task, start_date, end_date]);\n\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\tvar top = this.getTaskTop(task.id);\n\t\t\t\tvar height = this.getTaskBarHeight(task.id);\n\n\t\t\t\treturn {\n\t\t\t\t\tleft: 0,\n\t\t\t\t\ttop: top,\n\t\t\t\t\theight: height,\n\t\t\t\t\twidth: 0\n\t\t\t\t};\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\tgetTaskBarHeight: function(taskId, isMilestoneRender) {\n\t\t\tvar self = this;\n\t\t\tvar res = tryCall.call(self, getTimeline, \"getBarHeight\", [taskId, isMilestoneRender],\n\t\t\t\tfunction(){ return tryCall.call(self, getGrid, \"getItemHeight\", [taskId]);}\n\t\t\t);\n\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\tgetTaskHeight: function(taskId) {\n\t\t\tvar self = this;\n\t\t\tvar res = tryCall.call(self, getTimeline, \"getItemHeight\", [taskId],\n\t\t\t\tfunction(){ return tryCall.call(self, getGrid, \"getItemHeight\", [taskId]);}\n\t\t\t);\n\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\n\t\tcolumnIndexByDate: function(date) {\n\t\t\tvar res = tryCall.call(this, getTimeline, \"columnIndexByDate\", [date]);\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\troundTaskDates: function() {\n\t\t\ttryCall.call(this, getTimeline, \"roundTaskDates\", []);\n\t\t},\n\n\t\tgetScale: function() {\n\t\t\tvar res = tryCall.call(this, getTimeline, \"getScale\", []);\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn null;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\tgetTaskNode: function(id) {\n\t\t\tvar timeline = getTimeline(this);\n\t\t\tif (!timeline || !timeline.isVisible()) {\n\t\t\t\treturn null;\n\t\t\t} else {\n\t\t\t\tvar node = timeline._taskRenderer.rendered[id];\n\t\t\t\tif(!node){\n\t\t\t\t\tvar domAttr = timeline.$config.item_attribute;\n\t\t\t\t\tnode = timeline.$task_bars.querySelector(\"[\" +domAttr+ \"='\"+id+\"']\");\n\t\t\t\t}\n\n\t\t\t\treturn node || null;\n\t\t\t}\n\t\t},\n\n\n\t\tgetLinkNode: function(id) {\n\t\t\tvar timeline = getTimeline(this);\n\t\t\tif (!timeline.isVisible()) {\n\t\t\t\treturn null;\n\t\t\t} else {\n\t\t\t\treturn timeline._linkRenderer.rendered[id];\n\t\t\t}\n\t\t},\n\n\t\tscrollTo: function(left, top){\n\t\t\tvar vertical = getVerticalScrollbar(this);\n\t\t\tvar horizontal = getHorizontalScrollbar(this);\n\n\t\t\tvar oldH = {position: 0},\n\t\t\t\toldV = {position: 0};\n\n\t\t\tif(vertical){\n\t\t\t\toldV = vertical.getScrollState();\n\t\t\t}\n\t\t\tif(horizontal){\n\t\t\t\toldH = horizontal.getScrollState();\n\t\t\t}\n\n\t\t\tvar scrollHorizontal = (horizontal && left*1 == left);\n\t\t\tvar scrollVertical = (vertical && top*1 == top);\n\t\t\tvar scrollBoth = scrollHorizontal && scrollVertical;\n\n\t\t\tif(scrollBoth){\n\t\t\t\t// some views will be scrolled both horizontally and vertically and smart rendering can be called twice\n\t\t\t\t// set flag in order not to invoke smart rendering at the horizontal scroll stage\n\t\t\t\t// so it will repaint only once when the scroll is completed\n\t\t\t\tvar verticalViews = vertical._getLinkedViews();\n\t\t\t\tvar horizontalViews = horizontal._getLinkedViews();\n\n\t\t\t\tvar commonViews = [];\n\t\t\t\tfor(var i = 0; i < verticalViews.length; i++){\n\t\t\t\t\tfor(var j = 0; j < horizontalViews.length; j++){\n\n\t\t\t\t\t\tif(verticalViews[i].$config.id && horizontalViews[j].$config.id && verticalViews[i].$config.id === horizontalViews[j].$config.id){\n\t\t\t\t\t\t\tcommonViews.push(verticalViews[i].$config.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (scrollHorizontal){\n\t\t\t\tif(commonViews){\n\t\t\t\t\tcommonViews.forEach((function(viewId){\n\t\t\t\t\t\tthis.$ui.getView(viewId).$config.$skipSmartRenderOnScroll = true;\n\t\t\t\t\t}).bind(this));\n\t\t\t\t}\n\n\t\t\t\thorizontal.scroll(left);\n\t\t\t\tif(commonViews){\n\t\t\t\t\tcommonViews.forEach((function(viewId){\n\t\t\t\t\t\tthis.$ui.getView(viewId).$config.$skipSmartRenderOnScroll = false;\n\t\t\t\t\t}).bind(this));\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(scrollVertical){\n\t\t\t\tvertical.scroll(top);\n\t\t\t}\n\n\t\t\tvar newV = {position: 0},\n\t\t\t\tnewH = {position: 0};\n\t\t\tif(vertical){\n\t\t\t\tnewV = vertical.getScrollState();\n\t\t\t}\n\t\t\tif(horizontal){\n\t\t\t\tnewH = horizontal.getScrollState();\n\t\t\t}\n\n\t\t\tthis.callEvent(\"onGanttScroll\", [oldH.position, oldV.position, newH.position, newV.position]);\n\t\t},\n\n\t\tshowDate: function(date){\n\t\t\tvar date_x = this.posFromDate(date);\n\t\t\tvar scroll_to = Math.max(date_x - this.config.task_scroll_offset, 0);\n\t\t\tthis.scrollTo(scroll_to);\n\t\t},\n\t\tshowTask: function(id) {\n\t\t\tvar pos = this.getTaskPosition(this.getTask(id));\n\n\t\t\t// GS-1261: we need to show the start_date even in the RTL mode\n\t\t\tvar leftPos = pos.left;\n\t\t\tif (this.config.rtl) leftPos = pos.left + pos.width;\n\n\t\t\tvar left = Math.max(leftPos - this.config.task_scroll_offset, 0);\n\n\t\t\tvar dataHeight = this._scroll_state().y;\n\t\t\tvar top;\n\t\t\tif(!dataHeight){\n\t\t\t\ttop = pos.top;\n\t\t\t}else{\n\t\t\t\ttop = pos.top - (dataHeight - this.getTaskBarHeight(id))/2;\n\t\t\t}\n\n\t\t\tthis.scrollTo(left, top);\n\t\t\t// GS-1150: if the grid and timeline have different scrollbars, we need to scroll thegrid to show the task\n\t\t\tvar gridCell = getGrid(this);\n\t\t\tvar timelineCell = getTimeline(this);\n\t\t\tif (gridCell && timelineCell && gridCell.$config.scrollY != timelineCell.$config.scrollY){\n\t\t\t\tvar gridScrollbar = getAttachedScrollbar(this, gridCell, \"scrollY\");\n\t\t\t\tgridScrollbar.scrollTo(null, top);\n\t\t\t}\n\t\t},\n\t\t_scroll_state: function(){\n\t\t\tvar result = {\n\t\t\t\tx: false,\n\t\t\t\ty: false,\n\t\t\t\tx_pos: 0,\n\t\t\t\ty_pos: 0,\n\t\t\t\tscroll_size: this.config.scroll_size + 1,//1px for inner content\n\t\t\t\tx_inner: 0,\n\t\t\t\ty_inner: 0\n\t\t\t};\n\n\t\t\tvar scrollVer = getVerticalScrollbar(this),\n\t\t\t\tscrollHor = getHorizontalScrollbar(this);\n\t\t\tif(scrollHor){\n\t\t\t\tvar horState = scrollHor.getScrollState();\n\t\t\t\tif(horState.visible){\n\t\t\t\t\tresult.x = horState.size;\n\t\t\t\t\tresult.x_inner = horState.scrollSize;\n\t\t\t\t}\n\t\t\t\tresult.x_pos = horState.position || 0;\n\t\t\t}\n\n\t\t\tif(scrollVer){\n\t\t\t\tvar verState = scrollVer.getScrollState();\n\t\t\t\tif(verState.visible){\n\t\t\t\t\tresult.y = verState.size;\n\n\t\t\t\t\tresult.y_inner = verState.scrollSize;\n\t\t\t\t}\n\t\t\t\tresult.y_pos = verState.position || 0;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\tgetScrollState: function(){\n\t\t\tvar state = this._scroll_state();\n\t\t\treturn { x:state.x_pos, y:state.y_pos, inner_width:state.x, inner_height:state.y, width: state.x_inner, height: state.y_inner };\n\t\t},\n\n\t\tgetLayoutView: function(cellName){\n\t\t\treturn this.$ui.getView(cellName);\n\t\t},\n\n\t\tscrollLayoutCell: function(cellName, left, top){\n\t\t\tconst cell = this.$ui.getView(cellName);\n\t\t\tif (!cell){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (left !== null){\n\t\t\t\tconst horizontalScroll = this.$ui.getView(cell.$config.scrollX);\n\t\t\t\tif (horizontalScroll){\n\t\t\t\t\thorizontalScroll.scrollTo(left, null);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (top !== null){\n\t\t\t\tconst verticalScroll = this.$ui.getView(cell.$config.scrollY);\n\t\t\t\tif (verticalScroll){\n\t\t\t\t\tverticalScroll.scrollTo(null, top);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t};\n\n}\n\nexport default createLayoutFacade;","export default function(gantt) {\ngantt.skins.skyblue = {\n\tconfig:{\n\t\tgrid_width:370,\n\t\trow_height: 27,\n\t\tbar_height_padding:4,\n\t\tscale_height: 27,\n\t\tlink_line_width:1,\n\t\tlink_arrow_size:8,\n\t\tlink_radius:2,\n\t\tlightbox_additional_height:75\n\t},\n\t_second_column_width:95,\n\t_third_column_width:80\n};\n\n};","export default function(gantt) {\ngantt.skins.dark = {\n\tconfig:{\n\t\tgrid_width:390,\n\t\trow_height: 36,\n\t\tscale_height: 36,\n\t\tlink_line_width:2,\n\t\tlink_arrow_size:12,\n\t\tbar_height_padding:9,\n\t\tlightbox_additional_height:75\n\t},\n\t_second_column_width:100,\n\t_third_column_width:70\t\t\n};\n\n};","export default function(gantt) {\ngantt.skins.meadow = {\n\tconfig:{\n\t\tgrid_width:380,\n\t\trow_height: 27,\n\t\tscale_height: 30,\n\t\tlink_line_width:2,\n\t\tlink_arrow_size:10,\n\t\tbar_height_padding:4,\n\t\tlightbox_additional_height:72\n\t},\n\t_second_column_width:95,\n\t_third_column_width:80\n};\n\n};","export default function(gantt) {\ngantt.skins.terrace = {\n\tconfig:{\n\t\tgrid_width:390,\n\t\trow_height: 36,\n\t\tscale_height: 36,\n\t\tlink_line_width:2,\n\t\tlink_arrow_size:12,\n\t\tbar_height_padding:9,\n\t\tlightbox_additional_height:75\n\t},\n\t_second_column_width:100,\n\t_third_column_width:70\t\t\n};\n\n};","export default function(gantt) {\n\tgantt.skins.broadway = {\n\t\tconfig: {\n\t\t\tgrid_width: 390,\n\t\t\trow_height: 35,\n\t\t\tscale_height: 35,\n\t\t\tlink_line_width: 1,\n\t\t\tlink_arrow_size: 9,\n\t\t\tbar_height_padding:4,\n\t\t\tlightbox_additional_height: 86\n\t\t},\n\t\t_second_column_width: 100,\n\t\t_third_column_width: 80,\n\n\t\t_lightbox_template: \"<div class='gantt_cal_ltitle'><span class='gantt_mark'>&nbsp;</span><span class='gantt_time'></span><span class='gantt_title'></span><div class='gantt_cancel_btn'></div></div><div class='gantt_cal_larea'></div>\",\n\t\t_config_buttons_left: {},\n\t\t_config_buttons_right: {\n\t\t\t\"gantt_delete_btn\": \"icon_delete\",\n\t\t\t\"gantt_save_btn\": \"icon_save\"\n\t\t}\n\t};\n};","export default function(gantt) {\n\tgantt.skins.material = {\n\t\tconfig: {\n\t\t\tgrid_width: 411,\n\t\t\trow_height: 34,\n\t\t\tscale_height: 36,\n\t\t\tlink_line_width: 2,\n\t\t\tlink_arrow_size: 12,\n\t\t\tbar_height_padding:9,\n\t\t\tlightbox_additional_height: 80\n\t\t},\n\t\t_second_column_width: 110,\n\t\t_third_column_width: 75,\n\t\t_redefine_lightbox_buttons: {\n\t\t\t\"buttons_left\": [\"dhx_delete_btn\"],\n\t\t\t\"buttons_right\": [\"dhx_cancel_btn\", \"dhx_save_btn\"]\n\t\t}\n\t};\n\n\tgantt.attachEvent(\"onAfterTaskDrag\", function (id) {\n\t\tvar t = gantt.getTaskNode(id);\n\t\tif (t) {\n\t\t\tt.className += \" gantt_drag_animation\";\n\t\t\tsetTimeout(function () {\n\t\t\t\tvar indx = t.className.indexOf(\" gantt_drag_animation\");\n\t\t\t\tif (indx > -1) {\n\t\t\t\t\tt.className = t.className.slice(0, indx);\n\t\t\t\t}\n\t\t\t}, 200);\n\t\t}\n\t});\n\n};","export default function(gantt) {\ngantt.skins[\"contrast_black\"] = {\n\tconfig:{\n\t\tgrid_width:390,\n\t\trow_height: 35,\n\t\tscale_height: 35,\n\t\tlink_line_width:2,\n\t\tlink_arrow_size:12,\n\t\tlightbox_additional_height:75\n\t},\n\t_second_column_width:100,\n\t_third_column_width:80\n};\n\n};","export default function(gantt) {\ngantt.skins[\"contrast_white\"] = {\n\tconfig:{\n\t\tgrid_width:390,\n\t\trow_height: 35,\n\t\tscale_height: 35,\n\t\tlink_line_width:2,\n\t\tlink_arrow_size:12,\n\t\tlightbox_additional_height:75\n\t},\n\t_second_column_width:100,\n\t_third_column_width:80\n};\n\n};","import autoscroll from \"./autoscroll\";\nimport jquery_hooks from \"./jquery_hooks\";\nimport dhtmlx_hooks from \"./dhtmlx_hooks\";\nimport TimelineZoom from \"./timeline_zoom\";\n\n\nexport default function(gantt){\n\tif(!gantt.ext){\n\t\tgantt.ext = {};\n\t}\n\n\tvar modules = [\n\t\tautoscroll,\n\t\tjquery_hooks,\n\t\tdhtmlx_hooks\n\t];\n\n\tfor(var i = 0; i < modules.length; i++){\n\t\tif(modules[i])\n\t\t\tmodules[i](gantt);\n\t}\n\n\tgantt.ext.zoom = new TimelineZoom(gantt);\n};","export default function(gantt) {\n\n\tgantt._extend_to_optional = function (lightbox_block) {\n\n\t\tvar duration = lightbox_block;\n\t\tvar optional_time = {\n\t\t\trender: duration.render,\n\t\t\tfocus: duration.focus,\n\t\t\tset_value: function (node, value, task, section) {\n\t\t\t\tvar mapping = gantt._resolve_default_mapping(section);\n\t\t\t\tif (!task[mapping.start_date] || (mapping.start_date == \"start_date\" && this._isAllowedUnscheduledTask(task))) {\n\t\t\t\t\toptional_time.disable(node, section);\n\t\t\t\t\tvar val = {};\n\n\t\t\t\t\tfor (var i in mapping) {\n\t\t\t\t\t\t//take default values from the time control from task start/end dates\n\t\t\t\t\t\tval[mapping[i]] = task[i];\n\t\t\t\t\t}\n\n\t\t\t\t\treturn duration.set_value.call(gantt, node, value, val, section);//set default value\n\t\t\t\t} else {\n\t\t\t\t\toptional_time.enable(node, section);\n\t\t\t\t\treturn duration.set_value.call(gantt, node, value, task, section);\n\t\t\t\t}\n\t\t\t},\n\t\t\tget_value: function (node, task, section) {\n\t\t\t\tif (section.disabled) {\n\t\t\t\t\treturn {start_date: null};\n\t\t\t\t} else {\n\t\t\t\t\treturn duration.get_value.call(gantt, node, task, section);\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdate_block: function (node, section) {\n\t\t\t\tgantt.callEvent(\"onSectionToggle\", [gantt._lightbox_id, section]);\n\t\t\t\tnode.style.display = section.disabled ? \"none\" : \"\";\n\n\t\t\t\tif (section.button) {\n\t\t\t\t\tvar button = node.previousSibling.querySelector(\".gantt_custom_button_label\"),\n\t\t\t\t\t\tlabels = gantt.locale.labels;\n\n\t\t\t\t\tvar button_text = section.disabled ? labels[section.name + \"_enable_button\"] : labels[section.name + \"_disable_button\"];\n\n\t\t\t\t\tbutton.innerHTML = button_text;\n\t\t\t\t}\n\t\t\t},\n\t\t\tdisable: function (node, section) {\n\t\t\t\tsection.disabled = true;\n\t\t\t\toptional_time.update_block(node, section);\n\n\t\t\t},\n\t\t\tenable: function (node, section) {\n\t\t\t\tsection.disabled = false;\n\t\t\t\toptional_time.update_block(node, section);\n\t\t\t},\n\t\t\tbutton_click: function (index, el, section, container) {\n\t\t\t\tif (gantt.callEvent(\"onSectionButton\", [gantt._lightbox_id, section]) === false) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar config = gantt._get_typed_lightbox_config()[index];\n\t\t\t\tif (config.disabled) {\n\t\t\t\t\toptional_time.enable(container, config);\n\t\t\t\t} else {\n\t\t\t\t\toptional_time.disable(container, config);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\treturn optional_time;\n\t};\n\n\tgantt.form_blocks.duration_optional = gantt._extend_to_optional(gantt.form_blocks.duration);\n\tgantt.form_blocks.time_optional = gantt._extend_to_optional(gantt.form_blocks.time);\n\n};","export default function(gantt){\n\tvar htmlTags = new RegExp(\"<(?:.|\\n)*?>\", \"gm\");\n\tvar extraSpaces = new RegExp(\" +\", \"gm\");\n\n\tfunction stripHTMLLite(htmlText){\n\t\treturn (htmlText + \"\")\n\t\t\t.replace(htmlTags, \" \").\n\t\t\treplace(extraSpaces, \" \");\n\t}\n\n\tvar singleQuotes = new RegExp(\"'\", \"gm\");\n\tfunction escapeQuotes(text){\n\t\treturn (text + \"\").replace(singleQuotes, \"&#39;\");\n\t}\n\n\tgantt._waiAria = {\n\t\tgetAttributeString: function(attr){\n\t\t\tvar attributes = [\" \"];\n\t\t\tfor(var i in attr){\n\t\t\t\tvar text = escapeQuotes(stripHTMLLite(attr[i]));\n\t\t\t\tattributes.push(i + \"='\" + text + \"'\");\n\t\t\t}\n\t\t\tattributes.push(\" \");\n\t\t\treturn attributes.join(\" \");\n\n\t\t},\n\n\t\tgetTimelineCellAttr:function(dateString){\n\n\t\t\treturn gantt._waiAria.getAttributeString({\"aria-label\": dateString});\n\t\t},\n\n\t\t_taskCommonAttr: function(task, div){\n\n\t\t\tif(!(task.start_date && task.end_date))\n\t\t\t\treturn;\n\n\t\t\tdiv.setAttribute(\"aria-label\", stripHTMLLite(gantt.templates.tooltip_text(task.start_date, task.end_date, task)));\n\n\t\t\tif(task.$dataprocessor_class){\n\t\t\t\tdiv.setAttribute(\"aria-busy\", true);\n\t\t\t}\n\n\t\t},\n\n\t\tsetTaskBarAttr: function(task, div){\n\t\t\tthis._taskCommonAttr(task, div);\n\n\t\t\t// task bars are complex elements that should be treated as a single element\n\t\t\tdiv.setAttribute(\"role\", \"img\");\n\n\t\t\tif(!gantt.isReadonly(task) && gantt.config.drag_move){\n\t\t\t\tif(task.id != gantt.getState(\"tasksDnd\").drag_id){\n\t\t\t\t\tdiv.setAttribute(\"aria-grabbed\", false);\n\t\t\t\t}else{\n\t\t\t\t\tdiv.setAttribute(\"aria-grabbed\", true);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\ttaskRowAttr: function(task, div){\n\n\t\t\tthis._taskCommonAttr(task, div);\n\n\t\t\tif(!gantt.isReadonly(task) && gantt.config.order_branch){\n\t\t\t\tdiv.setAttribute(\"aria-grabbed\", false);\n\t\t\t}\n\n\t\t\tdiv.setAttribute(\"role\", \"row\");\n\t\t\t// selected attribute should be added only to the grid  because\n\t\t\t// other parts don't have the keyboard navigation\n\t\t\tdiv.setAttribute(\"aria-selected\", gantt.isSelectedTask(task.id) ? \"true\" : \"false\");\n\n\t\t\t// allowed values start from 1, set 1 for non-tree datastores\n\t\t\tdiv.setAttribute(\"aria-level\", task.$level + 1 || 1);\n\n\t\t\tif(gantt.hasChild(task.id)){\n\t\t\t\tdiv.setAttribute(\"aria-expanded\", task.$open ? \"true\" : \"false\");\n\t\t\t}\n\t\t},\n\n\t\tlinkAttr: function(link, div){\n\n\t\t\tvar linkTypes = gantt.config.links;\n\n\t\t\tvar toStart = link.type == linkTypes.finish_to_start || link.type == linkTypes.start_to_start;\n\t\t\tvar fromStart = link.type == linkTypes.start_to_start || link.type == linkTypes.start_to_finish;\n\n\t\t\tvar content = gantt.locale.labels.link + \" \" +  gantt.templates.drag_link(link.source, fromStart, link.target, toStart);\n\n\t\t\t// links are complex elements that should be treated as a single element\n\t\t\tdiv.setAttribute(\"role\", \"img\");\n\n\t\t\tdiv.setAttribute(\"aria-label\", stripHTMLLite(content));\n\t\t},\n\n\t\tgridSeparatorAttr: function(div){\n\t\t\t// the only valid role for the grid header\n\t\t\tdiv.setAttribute(\"role\", \"columnheader\");\n\t\t},\n\t\trowResizerAttr: function(div){\n\t\t\t// the only valid role for the grid header\n\t\t\tdiv.setAttribute(\"role\", \"row\");\n\t\t},\n\n\t\tlightboxHiddenAttr: function(div){\n\t\t\tdiv.setAttribute(\"aria-hidden\", \"true\");\n\t\t},\n\n\t\tlightboxVisibleAttr: function(div){\n\t\t\tdiv.setAttribute(\"aria-hidden\", \"false\");\n\t\t},\n\n\t\tlightboxAttr: function(div){\n\t\t\tdiv.setAttribute(\"role\", \"dialog\");\n\t\t\tdiv.setAttribute(\"aria-hidden\", \"true\");\n\t\t\tdiv.firstChild.setAttribute(\"role\", \"heading\");\n\t\t\tdiv.firstChild.setAttribute(\"aria-level\", \"1\");\n\t\t},\n\n\t\tlightboxButtonAttrString:function(buttonName){\n\t\t\treturn this.getAttributeString({\"role\":\"button\", \"aria-label\":gantt.locale.labels[buttonName], \"tabindex\":\"0\"});\n\t\t},\n\n\t\tlightboxHeader: function(div, headerText){\n\t\t\tdiv.setAttribute(\"aria-label\", headerText);\n\t\t},\n\n\t\tlightboxSelectAttrString: function(time_option){\n\t\t\tvar label = \"\";\n\n\t\t\tswitch (time_option) {\n\t\t\t\tcase \"%Y\":\n\t\t\t\t\tlabel = gantt.locale.labels.years;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%m\":\n\t\t\t\t\tlabel = gantt.locale.labels.months;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%d\":\n\t\t\t\t\tlabel = gantt.locale.labels.days;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%H:%i\":\n\t\t\t\t\tlabel = gantt.locale.labels.hours + gantt.locale.labels.minutes;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\treturn gantt._waiAria.getAttributeString({\"aria-label\": label});\n\t\t},\n\n\t\tlightboxDurationInputAttrString: function(section){\n\t\t\treturn this.getAttributeString({\n\t\t\t\t\"aria-label\": gantt.locale.labels.column_duration,\n\t\t\t\t\"aria-valuemin\": \"0\",\n\t\t\t\t\"role\": \"spinbutton\"\n\t\t\t});\n\t\t},\n\n\t\tinlineEditorAttr: function(div){\n\t\t\tdiv.setAttribute(\"role\", \"row\");\n\t\t},\n\n\t\tgridAttrString: function(){\n\t\t\treturn [\" role='treegrid'\", gantt.config.multiselect ? \"aria-multiselectable='true'\" : \"aria-multiselectable='false'\", \" \"].join(\" \");\n\t\t},\n\n\n\t\tgridScaleRowAttrString: function(){\n\t\t\treturn \"role='row'\";\n\t\t},\n\n\t\tgridScaleCellAttrString: function(column, label){\n\t\t\tvar attrs = \"\";\n\t\t\tif(column.name == \"add\"){\n\t\t\t\t// a more precise role is button, but it is not valid for the grid header\n\t\t\t\tattrs = this.getAttributeString({\"role\":\"columnheader\", \"aria-label\": gantt.locale.labels.new_task});\n\t\t\t}else{\n\n\t\t\t\tvar attributes = {\n\t\t\t\t\t\"role\":\"columnheader\",\n\t\t\t\t\t\"aria-label\": gantt.config.external_render && gantt.config.external_render.isElement(label) ? \"\" : label\n\t\t\t\t};\n\n\t\t\t\tif(gantt._sort && gantt._sort.name == column.name){\n\t\t\t\t\tif(gantt._sort.direction == \"asc\"){\n\t\t\t\t\t\tattributes[\"aria-sort\"] = \"ascending\";\n\t\t\t\t\t}else{\n\t\t\t\t\t\tattributes[\"aria-sort\"] = \"descending\";\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tattrs = this.getAttributeString(attributes);\n\t\t\t}\n\t\t\treturn attrs;\n\t\t},\n\n\t\tgridDataAttrString: function(){\n\t\t\treturn \"role='rowgroup'\";\n\t\t},\n\n\t\treorderMarkerAttr: function(div){\n\t\t\tdiv.setAttribute(\"role\", \"grid\");\n\t\t\tdiv.firstChild.removeAttribute(\"aria-level\");\n\t\t\tdiv.firstChild.setAttribute(\"aria-grabbed\", \"true\");\n\t\t},\n\n\t\tgridCellAttrString: function(column, textValue, task){\n\t\t\tvar attributes = {\"role\":\"gridcell\", \"aria-label\": textValue};\n\t\t\tif(!column.editor || gantt.isReadonly(task)){\n\t\t\t\tattributes[\"aria-readonly\"] = true;\n\t\t\t}\n\n\t\t\treturn this.getAttributeString(attributes);\n\t\t},\n\n\t\tgridAddButtonAttrString: function(column){\n\t\t\treturn this.getAttributeString({\"role\":\"button\", \"aria-label\": gantt.locale.labels.new_task});\n\t\t},\n\n\t\tmessageButtonAttrString: function(buttonLabel){\n\t\t\treturn \"tabindex='0' role='button' aria-label='\"+buttonLabel+\"'\";\n\t\t},\n\n\t\tmessageInfoAttr: function(div){\n\t\t\tdiv.setAttribute(\"role\", \"alert\");\n\t\t\t//div.setAttribute(\"tabindex\", \"-1\");\n\t\t},\n\n\t\tmessageModalAttr: function(div, uid){\n\t\t\tdiv.setAttribute(\"role\", \"dialog\");\n\t\t\tif(uid){\n\t\t\t\tdiv.setAttribute(\"aria-labelledby\", uid);\n\t\t\t}\n\n\t\t//\tdiv.setAttribute(\"tabindex\", \"-1\");\n\t\t},\n\n\t\tquickInfoAttr: function(div){\n\t\t\tdiv.setAttribute(\"role\", \"dialog\");\n\t\t},\n\n\t\tquickInfoHeaderAttrString: function(){\n\t\t\treturn \" role='heading' aria-level='1' \";\n\t\t},\n\n\t\tquickInfoHeader: function(div, header){\n\t\t\tdiv.setAttribute(\"aria-label\", header);\n\t\t},\n\n\t\tquickInfoButtonAttrString: function(label){\n\t\t\treturn gantt._waiAria.getAttributeString({\"role\":\"button\", \"aria-label\":label, \"tabindex\":\"0\"});\n\t\t},\n\n\t\ttooltipAttr: function(div){\n\t\t\tdiv.setAttribute(\"role\", \"tooltip\");\n\t\t},\n\n\t\ttooltipVisibleAttr: function(div){\n\t\t\tdiv.setAttribute(\"aria-hidden\", \"false\");\n\t\t},\n\n\t\ttooltipHiddenAttr: function(div){\n\t\t\tdiv.setAttribute(\"aria-hidden\", \"true\");\n\t\t}\n\t};\n\n\tfunction isDisabled(){\n\t\treturn !gantt.config.wai_aria_attributes;\n\t}\n\n\tfor(var i in gantt._waiAria){\n\t\tgantt._waiAria[i] = (function(payload){\n\t\t\treturn function(){\n\t\t\t\tif(isDisabled()){\n\t\t\t\t\treturn \"\";\n\t\t\t\t}\n\t\t\t\treturn payload.apply(this, arguments);\n\t\t\t};\n\t\t})(gantt._waiAria[i]);\n\t}\n\n\n};","import TreeDataStore from \"../datastore/treedatastore\";\n\nexport default function(gantt) {\n\n\tvar loadedBranches = {};\n\tgantt.$data.tasksStore.attachEvent(\"onClearAll\", function(){\n\t\tloadedBranches = {};\n\t});\n\n\tvar oldHasChildren = TreeDataStore.prototype.hasChild;\n\tgantt.$data.tasksStore.hasChild = function (id) {\n\t\tif(!gantt.config.branch_loading){\n\t\t\treturn oldHasChildren.call(this, id);\n\t\t}else{\n\t\t\tif (oldHasChildren.call(this, id))\n\t\t\t\treturn true;\n\t\t\tif (this.exists(id)) {\n\t\t\t\treturn this.getItem(id)[gantt.config.branch_loading_property];\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t};\n\n\tfunction needLoading(id) {\n\t\tif (gantt.config.branch_loading && gantt._load_url) {\n\t\t\tvar alreadyLoaded = !!loadedBranches[id];\n\t\t\t// call ajax only if branch has children\n\t\t\tif (!alreadyLoaded && (!gantt.getChildren(id).length && gantt.hasChild(id))) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tgantt.attachEvent(\"onTaskOpened\", function (id) {\n\t\tif (gantt.config.branch_loading && gantt._load_url) {\n\t\t\t// call ajax only if branch has children\n\t\t\tif (needLoading(id)) {\n\t\t\t\tvar url = gantt._load_url;\n\t\t\t\turl = url.replace(/(\\?|&)?parent_id=.+&?/, \"\");\n\t\t\t\tvar param = url.indexOf(\"?\") >= 0 ? \"&\" : \"?\";\n\t\t\t\tvar y = gantt.getScrollState().y || 0;\n\n\t\t\t\tvar requestData = {\n\t\t\t\t\ttaskId: id,\n\t\t\t\t\turl: url + param + \"parent_id=\" + encodeURIComponent(id)\n\t\t\t\t};\n\n\t\t\t\tif(gantt.callEvent(\"onBeforeBranchLoading\", [requestData]) === false){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tgantt.load(requestData.url, this._load_type, function () {\n\t\t\t\t\tif (y) {\n\t\t\t\t\t\tgantt.scrollTo(null, y);\n\t\t\t\t\t}\n\t\t\t\t\tgantt.callEvent(\"onAfterBranchLoading\", [requestData]);\n\t\t\t\t});\n\t\t\t\tloadedBranches[id] = true;\n\t\t\t}\n\t\t}\n\t});\n\n};","import extensions from \"./ext/extensions_all\";\nimport GanttFactory from \"./factory/gantt_factory\";\nimport factoryMethod from \"./factory/make_instance_web\";\n// tslint:disable-next-line variable-name\nconst Gantt = new GanttFactory(factoryMethod, extensions);\nconst gantt = Gantt.getGanttInstance();\n\nexport { Gantt, gantt };\n","\nimport ExtensionsManager from \"../ext/extension_manager\";\nimport scope from \"../utils/global\";\n\nclass GanttFactory implements IGanttFactory{\n\tprotected _seed: number;\n\tprotected _ganttPlugin: GanttPlugin[];\n\tprotected _factoryMethod: (bundledExtensions: {[key:string]: GanttPlugin}) => any;\n\tprotected _bundledExtensions: {[key:string]: GanttPlugin};\n\tprotected _extensionsManager: ExtensionsManager;\n\n\tconstructor(factoryMethod: ()=>any, _bundledExtensions:{[key:string]: GanttPlugin}) {\n\t\tthis._seed = 0;\n\t\tthis._ganttPlugin = [];\n\t\tthis._factoryMethod = factoryMethod;\n\t\tthis._bundledExtensions = _bundledExtensions;\n\t\tthis._extensionsManager = new ExtensionsManager(_bundledExtensions);\n\t}\n\n\tplugin = (code: GanttPlugin):void => {\n\t\tthis._ganttPlugin.push(code);\n\n\t\tif(scope.gantt !== undefined && scope.gantt.getTask){\n\t\t\tcode(scope.gantt);\n\t\t}\n\t};\n\n\tgetGanttInstance = (initConfig?: IGanttInitializationConfig):any => {\n\t\tconst gantt = this._factoryMethod(this._bundledExtensions);\n\t\tfor (let i=0; i<this._ganttPlugin.length; i++) {\n\t\t\tthis._ganttPlugin[i](gantt);\n\t\t}\n\t\tgantt._internal_id = (this._seed++);\n\n\t\tif(initConfig){\n\t\t\tthis._initFromConfig(gantt, initConfig);\n\t\t}\n\n\t\treturn gantt;\n\t};\n\n\tprotected _initFromConfig = (gantt: any, initConfig: IGanttInitializationConfig):any => {\n\t\tif(initConfig.plugins){\n\t\t\tfor(const i in initConfig.plugins){\n\t\t\t\tconst ext = this._extensionsManager.getExtension(i);\n\t\t\t\tif(ext){\n\t\t\t\t\tgantt.plugins({[i]: true});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif(initConfig.config){\n\t\t\tgantt.mixin(gantt.config, initConfig.config, true);\n\t\t}\n\n\t\tif(initConfig.templates){\n\t\t\tgantt.attachEvent(\"onTemplatesReady\", function(){\n\t\t\t\tgantt.mixin(gantt.templates, initConfig.templates, true);\n\t\t\t}, {once: true});\n\t\t}\n\n\t\tif(initConfig.events){\n\t\t\tfor(const event in initConfig.events){\n\t\t\t\tgantt.attachEvent(event, initConfig.events[event]);\n\t\t\t}\n\t\t}\n\n\t\tif(initConfig.locale){\n\t\t\tgantt.i18n.setLocale(initConfig.locale);\n\t\t}\n\n\t\tif(Array.isArray(initConfig.calendars)){\n\t\t\tinitConfig.calendars.forEach(function(calendar){\n\t\t\t\tgantt.addCalendar(calendar);\n\t\t\t});\n\t\t}\n\n\t\tif(initConfig.container){\n\t\t\tgantt.init(initConfig.container);\n\t\t} else {\n\t\t\tgantt.init();\n\t\t}\n\n\t\tif(initConfig.data){\n\t\t\tif(typeof initConfig.data === \"string\"){\n\t\t\t\tgantt.load(initConfig.data);\n\t\t\t}else{\n\t\t\t\tgantt.parse(initConfig.data);\n\t\t\t}\n\t\t}\n\n\n\t};\n}\n\nexport default GanttFactory;","import \"../css/dhtmlxgantt.less\";\n\nimport factory from \"./make_instance_common\";\nimport ui from \"../core/ui_core\";\nimport ajaxLoading from \"../core/loading/ajax_loading\";\nimport dynamicLoading from \"../core/loading/dynamic_loading\";\n\nexport default function(supportedExtensions) {\n\tvar gantt = factory(supportedExtensions);\n\n\tif(!gantt.env.isNode){\n\t\tui(gantt);\n\t\tajaxLoading(gantt);\n\t\tdynamicLoading(gantt);\n\t}\n\n\treturn gantt;\n};","export default function(gantt) {\n\tgantt.load = function (url, type, callback) {\n\t\tthis._load_url = url;\n\t\tthis.assert(arguments.length, \"Invalid load arguments\");\n\n\t\tvar tp = 'json', cl = null;\n\t\tif (arguments.length >= 3) {\n\t\t\ttp = type;\n\t\t\tcl = callback;\n\t\t} else {\n\t\t\tif (typeof arguments[1] == \"string\")\n\t\t\t\ttp = arguments[1];\n\t\t\telse if (typeof arguments[1] == \"function\")\n\t\t\t\tcl = arguments[1];\n\t\t}\n\n\t\tthis._load_type = tp;\n\n\t\tthis.callEvent(\"onLoadStart\", [url, tp]);\n\n\t\treturn this.ajax.get(url, gantt.bind(function (l) {\n\t\t\tthis.on_load(l, tp);\n\t\t\tthis.callEvent(\"onLoadEnd\", [url, tp]);\n\t\t\tif (typeof cl == \"function\")\n\t\t\t\tcl.call(this);\n\t\t}, this));\n\t};\n};","import { gantt, Gantt } from \"./dhtmlxgantt.web\";\nimport scope from \"./utils/global\";\n\n(scope as any).gantt = gantt;\n(scope as any).Gantt = Gantt;\n\nexport default gantt;\n\nexport { gantt, Gantt };"],"names":["links_common","gantt","_get_linked_task","link","getTarget","task","taskId","target","source","isTaskExists","getTask","_get_link_target","_get_link_source","caching","formattedLinksStash","inheritedSuccessorsStash","inheritedPredecessorsStash","getPredecessorsCache","isManuallyScheduledSummary","isSummaryTask","auto_scheduling","_isLinksCacheEnabled","_startLinksCache","_endLinksCache","_formatLink","sourceDates","targetDates","id","relations","this","isChildOf","autoSchedulingConfig","_getAutoSchedulingConfig","backwardsScheduling","schedule_from_end","config","project_end","respectTargetOffset","move_projects","apply_constraints","gap_behavior","getSubtaskDates","start_date","end_date","from","_getImplicitLinks","c","$source","length","getState","drag_id","calculateDuration","eachTask","child","type","types","project","$target","to","actualTarget","i","fromLength","fromTask","j","toLength","toTask","lag","subtaskLink","_linkedTasks","push","_convertToFinishToStartLink","taskParent","_isAutoSchedulable","unscheduled","unscheduledChildren","parent","selectOffset","selectSourceLinks","skipChild","children","linksCollection","l","links","start_to_start","start_to_finish","siblingLink","getLink","siblingId","siblingTask","linkLag","Math","abs","finish_to_start","additionalLag","insignificantTargetLag","duration","insignificantSourceLag","calculateLag","predecessorId","offsetLag","_getDirectDependencies","selectSuccessors","successors","linksIds","use_progress","progress","concat","_getInheritedDependencies","cacheCollection","stop","inheritedRelations","eachParent","parentDependencies","_getDirectSuccessors","_getInheritedSuccessors","_getDirectPredecessors","_getInheritedPredecessors","_getSuccessors","skipInherited","_getPredecessors","result","key","String","predecessors","sourceTask","targetTask","sourceParent","targetParent","res","sourceLag","targetLag","trueLag","preferredStart","hashSum","finish_to_finish","units","second","minute","hour","day","week","month","quarter","year","getSecondsInUnit","unit","forEach","arr","callback","workArray","slice","arrayFind","find","arrayIncludes","item","includes","isArray","obj","Array","pop","isDate","getFullYear","getMonth","getDate","isValidDate","isNaN","getTime","arrayFilter","filter","throttle","timeout","wait","apply","arguments","setTimeout","delay","timer","$cancelTimeout","$pending","args","prototype","call","clearTimeout","$execute","replaceValidZeroId","rootId","checkZeroId","findBinary","array","prev","low","high","floor","GraphHelper","getVertices","rel","ids","len","vertices","topologicalSort","edges","hash","$incoming","successor","S","v","L","n","node","m","groupAdjacentEdges","edge","tarjanStronglyConnectedComponents","verticesHash","stack","edgesFromTasks","recurse","connectedComponents","root","getVertex","visited","workStack","index","lowLink","onStack","e","w","min","com","tasks","linkKeys","findLoops","cycles","helpers.forEach","component","LinksBuilder","getVirtualRoot","mixin","root_id","$virtual","getLinkedTasks","includePredecessors","startIds","clearCache","_getLinkedTasks","_collectRelations","rootObj","isChild","visitedLinks","linkKey","rootTask","visitedTasks","output","tasksStack","current","includeRelation","isSameParent","hasChild","getChildren","_slave","ConstraintTypes","TaskPlan","Create","plan","constructor","latestStart","earliestStart","earliestEnd","latestEnd","latestSchedulingStart","earliestSchedulingStart","latestSchedulingEnd","earliestSchedulingEnd","kind","conflict","ConstraintsHelper","isAsapTask","constraintType","getConstraintType","_gantt","ASAP","ALAP","isAlapTask","constraint","_getTaskConstraint","constraint_type","_getOwnConstraint","project_constraint","group_mode","defaultConstraintType","_getParentConstraint","constraint_date","hasConstraint","processConstraint","helpers.isValidDate","constraintDate","newPlan","SNET","Date","calculateEndDate","SNLT","FNET","FNLT","MSO","MFO","getConstraints","store","placeholder","DateComparator","dateA","dateB","_hasDuration","small","big","valueOf","isEqual","smallDate","bigDate","isFirstSmaller","AlapStrategy","instance","_comparator","adjacentLinks","plansHash","maxEnd","linkId","maxStart","defaultStart","maxRelationDate","masterPlan","relation","getLatestEndDate","constraintStartDate","isGreaterOrDefault","callEvent","getClosestWorkTime","date","dir","currentPlan","successorStart","getSuccessorStartDate","predecessor","predecessorEnd","AsapStrategy","minStart","autoScheduledDates","minRelationDate","getEarliestStartDate","isSmallerOrDefault","project_start","milestoneWorktimeDirection","linkProps","onlyFFLink","noRelevantLinks","linkType","getPredecessorEndDate","taskCalendar","ffLink","AutoSchedulingPlanner","graphHelper","constraintsHelper","_secondIteration","_constraintsHelper","_graphHelper","_asapStrategy","_alapStrategy","_secondIterationRequired","constraints","alapStrategy","asapStrategy","orderedIds","reversedIds","relationsMap","buildWorkCollections","processConstraints","iterateTasks","projectPlan","reason","updateTasks","newDate","mainSequence","secondarySequence","isMainSequence","mainSequenceStrategy","secondarySequenceStrategy","currentId","resolveRelationDate","limitPlanDates","processResolvedDate","summaryLagChanged","projectUpdates","linksToUpdate","getProjectUpdates","shouldReschedule","projectId","updatedProject","max","initialDuration","newDuration","updatedSource","updatedTarget","updatedRelation","idMatch","targetMatch","sourceMatch","relationProp","projectForUpdate","childTask","isLinkExists","effectiveStart","reverse","unshift","r","breadthFirstSearch","queue","groupTasks","groupLinksInternal","groupLinksPublic","currentVertex","shift","splice","linksArray","linksObjects","processedLinks","ConnectedGroupsHelper","linksBuilder","getConnectedGroupRelations","_linksBuilder","getConnectedGroup","group","groups","map","LoopsFinder","isCircularLink","getLoopContainingLink","allRelations","findCycles","auto_scheduling_config","getDefaultAutoSchedulingConfig","enabled","descendant_links","schedule_on_parse","show_constraints","getAutoSchedulingConfig","schedulingConfig","mode","strict","move_asap_tasks","undefined","auto_scheduling_compatibility","auto_scheduling_strict","auto_scheduling_descendant_links","auto_scheduling_initial","auto_scheduling_move_projects","auto_scheduling_use_progress","auto_scheduling_project_constraint","attachUIHandlers","loopsFinder","connectedGroupsHelper","_attachAutoSchedulingHandlers","movedTask","_scheduleAfterBatchUpdate","_autoScheduleAfterLinkChange","_autoscheduling_in_progress","batch_update","autoSchedule","_preventCircularLink","slackConfigValue","deprecatedConfig","_preventDescendantLink","_datesNotEqual","taskA","taskB","_notEqualTaskDates","task1","task2","milestone","getRelations","resetToStartLinksLags","relationsArray","skipped","originalLink","presentLinks","updatedLinks","shouldKeepConstraints","oldTask","updateTaskConstraints","constraintTypes","constraint_types","backwardConstraints","forwardConstraints","indexOf","finalizeTaskConstraints","attachEvent","drag_mode","_processConstraints","newTask","changedConstraint","modifiedTaskId","ext","inlineEditors","autoscheduleColumns","state","columnName","durationColumn","startDateColumn","endDateColumn","linkedColumnEdit","inline_editors_date_processing","constraintDateColumn","$keep_constraints","draggedTask","progressScheduling","shouldResetSSandSFLinkLags","_autoSchedule","editorConfig","getEditorConfig","map_to","once","getNodePosition","elem","top","left","right","bottom","getBoundingClientRect","box","body","document","docElem","documentElement","parentNode","scrollTop","window","pageYOffset","scrollLeft","pageXOffset","clientTop","clientLeft","offsetWidth","offsetHeight","parseInt","offsetTop","offsetLeft","offsetParent","y","round","x","width","height","isVisible","display","visibility","getComputedStyle","style","currentStyle","hasNonNegativeTabIndex","getAttribute","hasHref","a","area","nodeName","loLowerCase","isEnabled","input","select","textarea","button","object","toLowerCase","hasAttribute","getFocusableNodes","nodes","querySelectorAll","join","nodesArray","$position","sort","b","tabIndex","getScrollSize","div","createElement","cssText","appendChild","clientWidth","removeChild","getClassName","className","baseVal","_trimString","addClassName","removeClassName","name","split","regEx","RegExp","replace","toNode","getElementById","querySelector","insertNode","newone","innerHTML","firstChild","removeNode","getChildNodes","css","ch","childNodes","out","getTargetNode","trg","tagName","event","srcElement","shadowRoot","composedPath","locateAttribute","attribute","host","str","trim","locateClassName","classname","ind","charAt","getRelativeEventPosition","ev","d","clientX","clientY","touches","getRelativeNodePosition","childPos","parentPos","closest","element","selector","matches","msMatchesSelector","webkitMatchesSelector","el","contains","parentElement","nodeType","console","error","getClosestSizedElement","isShadowDomSupported","head","createShadowRoot","attachShadow","getActiveElement","activeElement","getSelection","focusNode","getRootNode","ShadowRoot","classList","test","scope","global","EventsManager$1","_mouseDown","_touchStarts","_touchActive","_longTapTimer","_domEvents","_createDomEventScope","selectedRegion","useKey","ignore","_target","getViewPort","_originPosition","_restoreOriginPosition","position","$services","getService","registerProvider","autoscroll","scheduledDndCoordinates","startDragAndDrop","setStart","copy","setPosition","setEnd","attach","startDrag","eventElement","domHelpers.getRootNode","$root","getTouchEvent","changedTouches","stopDrag","dragMove","touch_drag","filterTargets","getFilterTargets","utils","dom","preventDefault","_getCoordinates","coordinates","dragEnd","dragTimeline","clickDrag","dragTimelineUseKey","drag_timeline","relative","render","detachAll","unregisterProvider","destructor","detach","viewPort","viewPortBounds","absolute","EventHost","_silent_mode","listeners","_silentStart","_silentEnd","makeEventable","eventHost","eventName","handler","settings","handlers","eventStorage","combinedResult","handlerResult","addEvent","t","handlerId","originalHandler","removeEvent","clear","thisObject","bind","attachAll","eventArguments","handlerName","checkEvent","detachEvent","list","eventId","detachAllEvents","SelectedRegion","view","_el","defaultRender","start","end","_singleRow","pos","_getTaskPositionByTop","_startPoint","_view","_viewPort","add","_callback","_endPoint","draw","eventable","singleRow","_useRequestAnimationFrame","useRequestAnimationFrame","requestAnimationFrame","getElement","startPoint","_startDate","dateFromPos","endPoint","_endDate","_positionPoint","positionPoint","max_date","tasksByTime","getTaskByTime","tasksByIndex","_getTasksByTop","getInBounds","startValue","endValue","startIndex","endIndex","getTaskByIndex","getItemIndexByTopPosition","getItemHeight","getItemTop","dataHeight","getTotalHeight","row_height","getTaskCount","_dragInProgress","EventsManager","_calculateDirectionVector","_trace","dots","vectors","resultVector","vector","magnitude","sqrt","angleDegrees","atan2","PI","_applyDndReadyStyles","_timeline","$task","_clearDndReadyStyles","remove","_getScrollPosition","timeline","$ui","getView","$config","scrollX","getScrollState","scrollY","_countNewScrollPosition","coords","shiftX","shiftY","_scrollState","_setScrollPosition","scrollLayoutCell","$id","_stopDrag","_originalReadonly","readonly","_originAutoscroll","_startDrag","clickDragUseKey","click_drag","scrollPosition","seed","plainObjectConstructor","toString","helpers.isDate","helpers.isArray","Object","create","$$typeof","hasOwnProperty","force","f","defined","uid","functor","capture","addEventListener","eventRemove","removeEventListener","ScaleHelper","dateHelper","getSum","sizes","summ","setSumWidth","sum_width","scale","parts","diff","adjustSize","full_width","splitSize","count","full","share","sortScales","scales","cellSize","step","_prepareScaleObject","format","template","date_to_str","projection","column_width","primaryScale","templates","scale_cell_class","getAdditionalScales","prepareConfigs","min_coll_width","container_width","scale_height","minDate","maxDate","rtl","heights","configs","main_scale","cfg","initScaleConfig","processIgnores","display_count","initColSizes","limitVisibleRange","alineScaleColumns","reverseScale","setPosSettings","trace_x","indexes","trace_indexes","trace_index_transition","_ignore_time_config","skip_off_time","skip","probe","isWorkTime","ignore_x","min_col_width","line_height","cont_width","column_count","fixedMode","baseCellWidth","col_width","ignores","min_date","utils.mixin","eachColumn","trace_x_ascending","iterateScales","lower_scale","upper_scale","upper_dates","lower_dates","prevUpper","up","target_index","upper_start","upper_end","lower_start","lower_end","targetWidth","curr","tzOffset","getTimezoneOffset","_correct_dst_change","dates","last","lastDate","outDate","shared","ScaleIgnoreHelper","helper","ignore_time","ignored_colls","modals","modalsStack","isModal","afterPopup","$destroyed","focus","startModal","trapFocus","endModal","currentTarget","$keyboardNavigation","traceLightbox","getLightbox","focusElement","QuickInfo","show","_showForTask","_showAtCoordinates","hide","forced","qi","_quickInfoBox","_quickInfoBoxId","_quickInfoTask","quick_info_detached","getNode","setContainer","container","_container","setContent","content","defaultContent","header","title","buttons","quickinfo_buttons","_createQuickInfoElement","titleBox","titleContent","titleDate","main","controls","_waiAria","quickInfoHeader","html","ariaAttr","quickInfoButtonAttrString","locale","labels","_qiButtonClickHandler","_qiKeyPressHandler","_qi_button_click","code","which","_appendAtCoordinates","show_quick_info","_getContainer","_get_event_counter_part","xViewport","yViewport","_init_quick_info","_prepare_quick_info_classname","_fill_quick_data","_show_quick_info","offset","domEv","getTaskNode","getTaskRowNode","scroll","dx","dy","quickInfoAttr","quickInfoHeaderAttrString","_quickInfoReadonly","isReadonly","getTaskType","quick_info_class","allowedButtons","isEditor","icon_delete","icon_edit","quick_info_title","quick_info_date","quick_info_content","popupHeight","scrolls","screenWidth","relativePopupBottom","mask","$click","$task_data","$grid_data","$grid","$layout","createScope","utils.event","utils.eventRemove","eventScope","staticArray","extend","Tooltip","_tooltipNode","tooltipAttr","_root","domHelpers.isChildOf","_isLikeMouseEvent","_calculateTooltipPosition","tooltipVisibleAttr","tooltipHiddenAttr","_getViewPort","viewport","_getViewPortSize","tooltipNode","tooltip","offsetX","tooltip_offset_x","offsetY","tooltip_offset_y","mouse","domHelpers.getRelativeEventPosition","containerPos","domHelpers.getNodePosition","TooltipManager","_listeners","domEventsScope","_initDelayedFunctions","delayHide","watchableTarget","eventTarget","domHelpers.getTargetNode","targetNode","domHelpers.closest","doOnMouseEnter","onmouseenter","onmousemove","onmouseleave","listener","cloneDomEvent","clone","createEvent","delayShow","helpers.delay","tooltip_timeout","tooltip_hide_timeout","noTrack","onBeforeUndo","onBeforeRedo","batchActions","Monitor","undo","_batchAction","_batchMode","_ignore","_ignoreMoveEvents","_initialTasks","_initialLinks","_nestedTasks","_nestedLinks","_undo","_attachEvents","overwrite","undo_types","_storeTask","_storeLink","newValue","startIgnore","startBatchAction","_timeout","stopBatchAction","action","logAction","_storeTaskCommand","command","update","$local_index","getTaskIndex","_storeEntityCommand","getInitialTask","move","entity","childrenLinks","_storeLinkCommand","taskIds","linkIds","_getLinks","setInitialTask","uniqueLinks","setInitialLink","$index","getGlobalTaskIndex","setInitialTaskObject","clearInitialTasks","deleteCacheCooldown","saveInitialAll","clearInitialLinks","getLinks","getMoveObjectByTaskId","stopIgnore","clearUndoStack","clearRedoStack","onTaskAdded","onTaskUpdated","onTaskDeleted","onLinkAdded","onLinkUpdated","onLinkDeleted","onTaskMoved","toggleIgnoreMoveEvents","nested","setNestedTasks","datastore","getDatastore","tindex","isMoveEventsIgnored","dragId","projectDrag","drag_project","plugins","multiselect","selectedIds","getSelectedTasks","onBeforeEditStartId","onEditStart","$data","tempAssignmentsStore","_lightbox_id","updateConfigs","undoEnabled","commands","old","actionType","entityType","_storeCommand","getInitialLink","Undo","maxSteps","redoEnabled","invert","revert","value","oldValue","inverseCommands","assert","_undoStack","_redoStack","undo_steps","undo_actions","redo","_pop","_reorderCommands","_applyAction","_push","weights","any","actionWeights","weightA","entities","actions","methods","get","isExists","batchUpdate","method","getMethod","check","prop","copyProperty","startsWith","extensions","ConfigBuilder","graph_helper","planner","connectedGroups","getConstraintLimitations","afterRenderBeforeFirstRepaint","updatedTasks","startTask","generatePlan","updateTask","applyProjectPlan","inclusive","parseDate","defaultConfig","setClickDrag","$container","critical_path","_private","_freeSlack","_totalSlack","_slackNeedCalculate","_linkedTasksById","_successorsByTaskId","_projectEnd","_calculateSlacks","linkedTasks","loops","loopLinks","loop","reversedOrder","successorsByTaskId","entry","linked","distCalculator","_cache","getDist","dist","_calculateFreeSlack","_calculateTotalSlack","_isCompletedTask","orderedFromEnd","successorsMap","freeSlack","tasksToDo","processedTasks","ownSlack","totalSlackByTaskId","successorLinks","totalSlack","successorLink","successorSlack","getFreeSlack","_resetTotalSlackCache","_shouldCalculateTotalSlack","getTotalSlack","minSlack","childSlack","dropCachedFreeSlack","init","slackHandler","tasksStore","linksStore","criticalPath","_isProjectEnd","_getProjectEnd","_slackHelper","reset","_calculateCriticalPath","isCriticalTask","hasCritical","slackHelper","resetCache","handleTaskIdChange","oldId","newId","criticalPathHandler","highlight_critical_path","refreshTask","isCriticalLink","getSlack","common","newSlack","_getSlack","next_task","_isDragInProgress","fullscreen","isExpanded","fullscreenElement","mozFullScreenElement","webkitFullscreenElement","msFullscreenElement","isFullscreenAvailable","fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled","backupBodyPadding","overflow","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","backupElementSizes","zIndex","modified","backupPositioning","updateSizes","expandGantt","onFullScreenChange","getFullscreenElement","positions","originalPositioning","setFullScreenSizes","record","restoreSizes","cantFullscreen","warning","log","expand","requestArguments","webkitRequestFullscreen","Element","ALLOW_KEYBOARD_INPUT","requestFullscreen","msRequestFullscreen","mozRequestFullScreen","requestExitFullscreen","msExitFullscreen","mozCancelFullScreen","webkitExitFullscreen","exitFullscreen","collapse","keyboard_navigation","keyboard_navigation_cells","_compose","p","shortcuts","createCommand","modifiers","alt","ctrl","meta","keyCode","parse","shortcut","expr","getExpressions","words","getWords","commandKeys","specialKeys","charCodeAt","getCommandFromEvent","domEvent","shiftKey","altKey","ctrlKey","metaKey","printableKey","fromCharCode","getHashFromEvent","getHash","junctionChar","term","combinationChar","backspace","tab","enter","esc","space","down","home","pageup","pagedown","delete","insert","plus","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","f12","EventHandler","_handlers","findHandler","doAction","facade","returnValue","unbind","bindAll","initKeys","keys","domHelpers.getFocusableNodes","focusable","currentFocus","domHelpers.getActiveElement","currentIndex","lastItem","firstItem","GanttNode","blur","scrollHorizontal","getScale","scrollTo","posFromDate","scrollVertical","KeyNavNode","isValid","fallback","moveTo","dispatcher","setActiveNode","compareTo","canStringifyThis","canStringifyThat","eventFacade","setAttribute","$eventAttached","HeaderCell","show_grid","getVisibleTaskCount","getGridColumns","TaskRow","visibleColumns","fromDomElement","cellElement","domHelpers.locateClassName","previousSibling","$grid_scale","columns","taskRow","rootLevel","TaskCell","click","createTask","globalIndex","splitItem","$split_subtask","parentId","getParent","nextIndex","locate","isTaskVisible","task_attribute","replaceAll","keptFocus","getTaskPosition","getTaskHeight","viewWidth","viewHeight","inner_width","inner_height","visibleTimeline","show_chart","scroll_on_click","task_scroll_offset","grid","scrollPositionX","scrollPositionY","attachedScrollbarHorizontal","scrollable","scrollbarHorizontal","attachedScrollbarVertical","scrollbarVertical","scrollGrid","nextElement","prevTask","getPrev","nextTask","getNext","$open","open","close","prevId","getPrevSibling","moveTask","isSelectedTask","unselectTask","selectTask","showLightbox","columnIndex","domHelpers.locateAttribute","show_tasks_outside_timescale","row","isActive","activeNode","globalNode","enable","getActiveNode","disable","getDefaultNode","setDefaultNode","inputs","focusGlobalNode","blurNode","focusChanged","keyDownHandler","defaultPrevented","ganttNode","awaitsFocus","clearDelay","isTaskFocused","isInlineEditorCell","isNoKeyboardNavigationElement","focusHandler","$preventDefault","reFocusActiveNode","outsideGantt","localName","domElement","mousedownHandler","locateTask","taskBar","gridLeft","gridRight","nodePosition","rightPosition","positionX","column","removeAttribute","onReady","currentNode","gridDataTopScroll","gridDataBottomScroll","_smart_render","updateRender","_redrawTasks","renderers","items","focusedItemVisible","createdTaskId","keepFocusOnNewTask","nodeConstructor","placeholder_task","focusOnCreate","interval","setInterval","getScope","scopes","headerCell","taskCell","findVisibleColumnIndex","clearInterval","keyNavFacade","addShortcut","scopeObject","getShortcutHandler","getCommandHandler","removeShortcut","keyboardNavigation","quick_info","quickInfo","text","substr","details","task_time","addButton","collapseButton","expandButton","events","hidingFunction","clearQuickInfo","hideQuickInfo","showQuickInfo","tooltipManager","tooltips","tooltipFor","touch","touch_tooltip","targetTaskId","tooltip_text","hideTooltip","link_source_id","monitor","isEqualIds","first","updTask","changeTaskCommandId","updLink","oldTaskId","newTaskId","changeLinkCommandId","updateTasksIds","updateLinksIds","getUndoStack","setUndoStack","getRedoStack","setRedoStack","saveState","getInitialState","grouping","setRelationValueForAssignmentsArray","newGroupValues","oldRelationProperty","resources","resource_id","newRelationProperty","Set","new_value","reduce","resourceAssignmentIndexes","resourceId","assignmentIndex","setRelationValueForPrimitivesArray","inspectRelationProperty","relationProperty","resourceAssignments","arrays","haveArrays","haveResourceAssignments","_getResourcesIds","_getEntryId","_getGroupId","_initBeforeDataRender","_this","_listenerToDrop","delayedFunction","_groups","dynamicGroups","regroup","scrollState","is_active","relation_property","relation_id_property","group_id","group_text","loading","loaded","set_relation_value","_searchCache","self","originalGetParent","invalidParent","noRelationValueFunction","Function","save_tree_structure","oldParentTask","newParentTask","cyclicTree","parentTask","order_branch","$initial_parent","renderedParent","$rendered_parent","initialParent","restoreParent","get_parent","originalSetParent","setParent","new_pid","groupIds","groupId","_buildCache","virtualParentId","_setParentInner","_clearCache","getItems","parent_group_id","_groups_pull","parent_id","generate_sections","groups_type","clear_temp_tasks","generate_data","$calculate_duration","categories","data","update_settings","group_tasks","groups_array","selectedTasks","_clear_data","schedulingOnParse","groupBy","relationInfo","default_group_label","default_group","groupOpenCloseState","restoreOpenCloseState","resultObj","itemsByKey","property","delimiter","hasDefaultGroup","defaultGroupId","default","label","taskGroupValue","marker","render_marker","show_markers","marker_class","markerHeight","getRowTop","timeline_placeholder","scrollHeight","external_render","isElement","renderElement","initMarkerArea","$marker_area","markerArea","_markers","createDatastore","initItem","renderMarkers","createDataRender","defaultContainer","addLayer","getMarker","getItem","addMarker","addItem","deleteMarker","exists","removeItem","updateMarker","refresh","_getMarkers","multiselect_one_level","_multiselect","_selected","_one_level","_active","_first_selected_when_shift","getDefaultSelected","selected","getSelected","setFirstSelected","getFirstSelected","updateState","active","select_task","setLastSelected","silent","unselect","getLastSelected","getSelectedId","afterSelect","toggle","isSelected","forSelected","isSameLevel","calculateTaskLevel","_quickRefresh","doSelection","_is_icon_open_click","target_ev","defaultLast","isLast","multiSelect","singleSelection","controller","cell","locateCell","inline_editors_multiselect_open","startEdit","blockSelection","first_indx","target_indx","last_indx","tmp","old_selectTask","old_unselectTask","toggleTaskSelection","eachSelectedTask","getLastSelectedTask","old_isSelected","new_id","task_id","oldSelectedId","oldSelectedTask","newSelectedTask","differentTreeLevel","$level","overlay","overlays","initOverlayArea","$overlay_area","overlayArea","attachUnnattached","isAttached","attachOverlay","showOverlayArea","hideIfNoVisibleLayers","isConnected","addOverlay","deleteOverlay","getOverlaysIds","refreshOverlay","showOverlay","hideOverlay","isOverlayVisible","export_api","_apiUrl","previousDateRage","str_to_date","date_format","_serializeHtml","_prepareConfigPDF","_serializeAll","_fixColumns","raw","_preparePDFConfigRaw","version","_sendToExport","_pdfExportRouter","_serializePlain","smartRendering","smart_rendering","visual","convert","_eachTaskTimed","_serializeTimeline","_serializeGrid","rawDates","_serializeScales","worktime","_getWorktimeSettings","formData","File","FormData","append","_sendImportAjaxExcel","_sendImportAjaxMSP","importFromPrimaveraP6","importFromMSProject","skip_circular_links","oldXmlFormat","xml_format","oldFormatDate","format_date","oldXmlDate","xml_date","oldDateFormat","exportServiceDateFormat","_customProjectProperties","_customTaskProperties","_clearRecLinks","_exportConfig","$custom_data","custom","exportToPrimaveraP6","exportToMSProject","url","pack","cb","ajax","post","base","$template","server","JSON","stringify","sheet","xhr","XMLHttpRequest","onreadystatechange","readyState","status","onload","info","responseText","setRequestHeader","send","encodeURIComponent","_xdr","loader","xdoc","xmlDoc","col","editor","editor_types","skin","_serializableGanttConfig","_markColumns","_ajaxToExport","form","_createHiddenForm","submit","_hidden_export_form","deadline","formatDate","_color_box","_color_hash","color","_getColor","backgroundColor","parsedRanges","minutes","range","startMinute","endMinute","defaultWorkTimes","hours","time","work_time","wTime","_working_time_helper","get_calendar","worktimes","parsed","_getMinutesWorktimeSettings","master","branch","_pull","_originalCopyObject","json","_copyObject","task_text","_copyObjectBase","serializeTask","rgb","match","toISOstring","_copyObjectColumns","_copyObjectPlainExcel","original_start_date","original_end_date","_generatedScales","_generateScales","scaleHelper","getSubScales","scalesConfig","min_column_width","days","helpers.findBinary","_copyObjectTable","startDate","endDate","getDayIndex","columnIndexByDate","allScales","$start","_getDayIndex","$end","hiddenCells","scaleCellsWidth","$type","$rendered_type","tmps","$text","$left","leftside_text","$right","rightside_text","$color","cellCss","task_class","styles","_getStyles","ct","val","date_grid","smartScales","smart_scales","_copyObjectAll","_exportSerialize","_copyObjectPlainICal","_getRaw","availWidth","autosize","autosize_min_width","_getScales","minWidth","$scaleHelper","custom_dataset","serialize","childBar","_copyObjectColors","split_bars","skippedTasks","sibling","overlap","cover","filteredIds","visibleOrder","filteredDataset","cellColors","timeline_cell_class","task_cell_class","steps","Infinity","scaleCell","scaleCell_class","scaleCss","exportMode","cols","ccount","tree","xmlFormat","_lvl","_setLevel","_makeLinksSameLevel","skippedLinks","_clearCircDependencies","_clearLinksSameLevel","_clearLevel","usedTasks","prevLink","sources","$_source","_onCircDependencyFind","targets","curLink","_source","targetLvl","linkT","$_target","projectName","projectDates","start_end","manual","durationUnit","projectProperties","taskProperties","exportToPDF","exportToPNG","exportToICal","exportToExcel","exportToJSON","importFromExcel","ExtensionsManager","addExtension","_extensions","getExtension","constants","KEY_CODES","UP","DOWN","LEFT","RIGHT","SPACE","ENTER","DELETE","ESC","TAB","isWindowAwailable","nav","navigator","userAgent","env","isIE","isOpera","isChrome","isSafari","isFF","isIPad","search","isEdge","isNode","isSalesforce","serialized","createConfig","Error","async","headers","fastVersion","utc","dateToStrFn","to_fixed","getISOWeek","getWeek","splt","strToDateFn","dateString","cspVersion","getUTCDate","getUTCMonth","getUTCFullYear","day_short","getUTCDay","getDay","day_full","month_short","month_full","getUTCHours","getHours","getUTCMinutes","getMinutes","getUTCSeconds","getSeconds","getUTCISOWeek","set","temp","month_short_hash","month_full_hash","UTC","canUseCsp","useCsp","csp","s","date_part","setHours","hour_start","setTime","time_part","week_start","start_on_monday","month_start","setDate","quarter_start","res_month","setMonth","year_start","day_start","setMinutes","minute_start","setSeconds","getMilliseconds","setMilliseconds","_add_days","modifiedDate","inc","originalDate","incCondition","getHoursCondition","getDateCondition","ndate","setYear","add_quarter","num","cspCompliantVersion","_getWeekNumber","isoWeek","nday","first_thursday","year_number","ordinal_date","convert_to_utc","parse_date","token","_url","_token","_mode","_seed","_queue","api","_events","Accept","credentials","fetch","then","websocket","_wrapper","connect","_socket","onclose","location","protocol","o","WebSocket","onmessage","fire","onError","_send","_resubscribe","Promise","_uid","resolve","reject","onCall","catch","onResponse","remoteEvents","remote","remote_client.Client","req","_ready","load","back","_remote","ready","on","checkTimeout","updPerSecond","_on_timeout","ceil","StateService","stateProviders","internal","provider","Promise$1","$powerArray","$create","$removeAt","$remove","$find","$insertAt","$each","$map","$filter","isPlaceholderTask","DataStore","pull","$initItem","powerArray","fullOrder","_skip_refresh","_filterRule","_searchVisibleOrder","_indexRangeCache","_getItemsCache","_attachDataChange","_parseInner","copyOnParse","utils.copy","isSilent","_updateOrder","updateItem","utils.defined","_removeItemInner","_addItemInner","order","data_size","getVisibleItems","getIndexRange","utils.uid","sync_link","_changeIdInner","changeId","_moveInner","sindex","getIdByIndex","clearAll","alreadySilent","arraysEqual","arr1","arr2","quick","skipFilter","_quick_refresh","_mark_recompute","oldOrder","countVisible","eachItem","rule","filteredOrder","placeholderIds","_ganttConfig","cacheKey","ret","getIndexById","_getNullIfUndefined","getFirst","getLast","SplitTasksHelper","_datastore","isSplitItem","isSubrowSplitItem","split_placement","isDefaultSplitItem","isInlineSplitItem","TreeDataStore","_branches","_splitTaskHelper","loadedItem","existingItem","$parentProperty","parentProperty","$getRootId","$openInitially","openInitially","_eachItemMainRangeCache","getConfig","splitParents","splitItems","taskOpenState","taskVisibility","haveSplitItems","_isSplitItem","_isDefaultItem","_isInlineChildItem","canOpenSplitTasks","open_split_tasks","_isSplitChildItem","$expanded_branch","isHeadless","_buildTree","_add_branch","calculateItemLevel","getBranchIndex","targetIndex","_move_branch","_replace_branch_child","_traverseBranches","itemId","sid","source_pid","tbranch","tid","childId","pid","getSiblings","getNextSibling","siblings","nextSibling","level","_eachItemCached","cache","_eachItemIterate","startId","itemsStack","useCache","buildCache","startItem","parentsHash","old_parent","new_parent","old_id","newbranch","field","desc","criteria","original_criteria","els","actualParent","_skipTaskRecalculation","datastoreRender","itemRepainter","renderer","renders","getLayers","render_item","allData","loadedRanges","layer","layerData","get_visible_range","prepare_data","render_items","update_items","extraDataArr","skipRepaint","getDataRender","onUpdateRequest","change_id","getDatastores","storeNames","facadeFactory","$StoreType","open_tree_initially","deepcopy_on_parse","selectedId","deleteItem","subItem","storeAccessName","dropService","storeList","setService","_getDatastores","refreshData","stores","preserve_scroll","getScrollbarsInfo","scroll_info","scrollbarNodeVisible","$view","boundViews","viewName","refresh_links","refreshLinks","refreshLink","_bulk_dnd","hasSplitParent","isSplitTask","_update_flags","userdata","oldSelectId","_skipResourceRepaint","addTask","lightbox","parentObj","deleteTask","utils.bind","changeTaskId","oldid","newid","getLinkCount","addLink","updateLink","deleteLink","changeLinkId","_init_tasks_range","PrimaryScaleHelper","scale_offset_minimal","start_interval","onlyProjectTasks","duration_unit","deadlines","extendRangeForDates","baselines","baseline","_min_date","_max_date","updateTasksRange","fit_tasks","old_min","old_max","copyLinkIdsArray","targetHash","copyLinkIds","treeHelper","getSubtreeLinks","getSubtreeTasks","DataProcessorEvents","dp","$gantt","$dp","_dataProcessorHandlers","cascadeDelete","clientSideDelete","setGanttMode","setUpdated","_sendTaskOrder","cascade_delete","deleteAfterConfirmation","needDbDelete","needCascadeDelete","dpMode","updateMode","setUpdateMode","cascade","storeItem","sendAllData","_tSend","_waitMode","itemLinks","_links","_dp","_tMode","_serverProcessor","_ganttMode","substring","serverProcessor","pluralizedMode","urlSeparator","upd","xml","_xmlNodeToJSON","isExist","objData","assignmentsStore","handleResourceCRUD","handleResourceAssignmentCRUD","handleBaselineCRUD","updated","updatedRows","clientOnly","getUserData","_in_progress","dataprocessor_assignments","resource_assignment_store","insertedTasks","pendingAssignments","insertResourceAssignment","assignment","dataprocessor_resources","resourcesStore","resource_store","resource","dataprocessor_baselines","baselineStore","SimpleStorage","_storage","getStoredItem","_ue","DataProcessor$1","serverProcessorURL","action_param","autoUpdate","_headers","_payload","_postDelim","_routerParametersFormat","_invalid","messages","inserted","deleted","invalid","invalid_cell","enableUTFencoding","total","payload","_serializeAsJson","_router","router","_utf","escape","dnd","rowId","findRow","existing","set_invalid","setUserData","is_invalid","markRow","sendData","_methods","editStop","pendingUpdateModes","modes","checkBeforeUpdate","_beforeSendData","_getRowData","_serializeAsJSON","serialize_one","security_key","pref","valid","_forEachUpdatedRow","_sendData","_getAllData","pattern","_uActions","btag","ganttMode","correct","originalSid","that","_xml","getGanttMode","reqUrl","filePath","tag","processCallback","afterUpdateCallback","finalizeUpdate","xmltop","cleanUpdate","atag","xpath","_initialized","_dp_init","_setDefaultTransactionMode","delete_confirmation","_change_id","_row_style","$dataprocessor_class","_delete_task","$drop_target","setDp","dataProcessorEvents","user","_user","_needUpdate","_updateBusy","afterAutoUpdate","fullSync","loadUpdate","xml_node","getUpdates","vers","_getXmlNodeValue","updates","newState","dataToSend","processedData","_cleanupArgumentsBeforeSend","_cleanupItemBeforeSend","updatedItem","taskState","taskAction","getActionByState","_onResolvedCreateUpdate","actionPromise","errorMsgStart","errorMsgEnd","queryParams","afterUpdate","dhxVersion","urlParams","_applyPayload","preprocessedData","query","setTransactionMode","nodeValue","hasOne","traversedObjects","_prepareDate","helpers.arrayIncludes","_prepareArray","_prepareObject","rawItem","processedItem","dataItem","_prepareDataItem","DataProcessor","he","tMode","createMethod","disableMethod","methodName","dummyMethod","restoreMethod","disableMethods","methodsHash","restoreMethods","batchUpdatePayload","noRedraw","dp_mode","call_dp","resetProjects","resetProjectDates","wbs","_needRecalc","_isRecalcNeeded","_isGroupSort","_getWBSCode","_calcWBS","$wbs","_setWBSCode","getWBSCode","getByWBSCode","_isFirst","_prevSibling","_getPrevNonPlaceholderSibling","_increaseWBS","_parent","siblingiId","_wbs","prevSibling","getTaskByWBSCode","createResourceMethods","resourceTaskCache","singleResourceCacheBuilt","falsyValuePrefix","random","resourceHashFunction","getCacheKey","resourceIds","typeFilter","getResourceTasks","matchingResources","resourceValue","selectAssignments","resource_property","owners","getTaskBy","propertyName","propertyValue","getResourceAssignments","assignments","createHelper","resourcePlugin","renderEditableLabel","editable","$task_id","$resource_id","renderSummaryLabel","sum","Number","editableResourceCellTemplate","$role","editableResourceCellClass","capacity","getSummaryResourceAssignments","childResource","initEditableDiagram","resource_render_empty_cells","timeoutId","makeEditable","cancelAnimationFrame","contentEditable","getCellsByType","$content","currentFocusIndex","handleAssignmentEdit","strValue","innerText","assignmentId","assignmentStore","nextChunk","updateTaskAssignments","editedElem","dom_helpers.getFocusableNodes","focusableElementsAfterRender","focusableElements","focusableElementsAfterUpdate","targetAfterUpdate","editable_resource_diagram","fetchTasks","lightbox_resources","lightboxOptions","resourceStoreConfig","initItems","storeType","$resourcesStore","options","lightboxOptionsFnc","updateCollection","histogram_cell_class","histogram_cell_label","histogram_cell_allocated","histogram_cell_capacity","defaultResourceCellClass","defaultResourceCellTemplate","resource_cell_value","resource_cell_class","resource_assignments","resourceAssignmentsProperty","process_resource_assignments","resourceAssignmentFormats","resourceAssignmentFormat","assignmentModes","initAssignmentFields","initDelay","timing","_assignmentTimeFromTask","resourceAssignmentsStore","_makeAssignmentsFromTask","detectFormat","usedIds","defaultMode","_updateTaskBack","_assignAssignments","getTaskAssignments","_loadAssignmentsFromTask","_syncAssignments","storeAssignments","taskValues","assignmentsStoreValues","inBoth","inTaskNotInStore","inStoreNotInTask","taskOwner","ownerId","foundOwnerAssignment","taskSearch","storeSearch","processedIds","inTask","inStore","ignoreFields","_syncOnTaskUpdate","totalAssignments","needUpdate","needUpdateFor","undoBatchCancel","assignmentsHash","taskAssignmentsCache","idsSearch","deleteIds","resourceAssignmentsCache","resourceTaskAssignmentsCache","searchTaskId","resourceTaskCacheKey","getTaskResources","uniqueResources","addPlaceholder","callIfEnabled","insertPlaceholder","placeholders","new_task","afterEdit","dataProcessor","_silencedPlaceholder","isPlaceholderLink","auto_task_types","auto_types","checkTaskType","changedTypes","targetType","getTaskTypeToUpdate","$needsUpdate","updateParentTypes","delTaskParent","allTypes","hasChildren","taskType","originalRowDndParent","originalMoveTaskParent","isParsingDone","updateAfterRemoveChild","DurationFormatter","canParse","_config","labelName","plural","short","formatUnits","useShortLabels","totalMinutes","transferUnits","toMinutes","_selectFormatForValue","countedValue","_getValueFromMinutes","_getValueInMinutes","_getLabelForConvert","part","isPartReady","needToParse","isNumber","symbol","_getNumericValue","fromMinutes","parseFloat","toFixed","_isUnitName","_getUnitName","isUnit","_defaultSettings","minutesPerHour","hoursPerDay","hoursPerWeek","daysPerMonth","daysPerYear","preparedSettings","values","numericValue","lettersValue","unitName","_we","LinkFormatterSimple","_linkReg","linkPart","exec","_findSource","pred","reqTemplate","_Se","LinkFormatter","super","formattedType","_getFormattedLinkType","_getLinkTypeName","_getLagString","lagPart","typeFormat","_findTypeFormat","typeNumber","_getLinkTypeNumber","_parseLag","linkName","formatted","durationFormatter","formatters","_Te","linkFormatter","empty_state_screen","show_empty_state","emptyStateElement","isGanttEmpty","placeholderContainer","empty_state_text_link","empty_state_text_description","clickEvents","domHelpers","getContainer","wrapper","marginTop","oldNodes","detachAddTaskEvents","attachAddTaskEvent","renderContent","emptyStateElementNode","hasBaselinesBelow","baselinesOnDifferentRow","render_mode","childrenHaveBaselines","hasBaselines","isSplitParent","getMaxParentHeight","heightLimit","maxHeight","shrinkHeight","splitChild","parentHeight","getItemPosition","rowHeight","getMilestoneHeight","getInvertedMilestoneHeight","getAdjustedPosition","childBaselines","splitParams","largerHeight","noNeedToShrink","heightDiff","additionalMargin","exceedBarHeight","bar_height","exceedParentHeight","_adjustSplitParentHeight","maxParentHeight","adjustTaskHeightForBaselines","childHeight","_increaseSplitParentHeight","getLayoutView","getBarHeight","subtaskId","subtask","subtaskHeight","baselineSize","baselineAmount","subrowHeight","timelineView","newBaseline","existingBaseline","shouldRepaint","iteratedBaselines","taskBaselines","exisingBaselines","getTaskBaselines","exisingBaseline","repaint","RemoteEvents","Client","createHandlers","updateQueue","updateTimeout","remoteUpdates","message","processUpdate","processQueue","taskData","warn","initTask","existingTask","remoteTask","lightbox_id","linkData","existingLink","assign","liveUpdates","createMixin","getItemTopCache","getRowTopCache","getItemHeightCache","totalHeightCache","getItemHeightCacheState","quickPosition","cachedRowHeight","canUseSimpleCalc","_getRowHeight","$getConfig","_refreshState","rowStore","globalRowHeight","canUseSimpleCalculation","_resetTopPositionHeight","_resetHeight","getCacheStateTotalHeight","shouldClearHeightCache","all","itemIndex","_fillHeightCache","defaultHeight","globalHeight","itemHeightCache","sumHeight","oldState","getHeight","visibleItems","totalHeight","next","ScrollableGrid","params","_scrollOrder","getCurrentX","_dnd","_scrollView","attachEvents","isScrollable","gridBoundingRect","maxLeft","minLeft","currentX","autoscrollRight","autoscrollStart","autoscrollLeft","autoscrollStop","scrollStep","COLUMN_ID_ATTR_NAME","ColumnsGridDnd","_targetMarker","calculateCurrentPosition","eventX","DND","updates_per_second","_scrollableGrid","_draggedCell","draggedColumn","draggedIndex","_gridConfig","outerHTML","lineHeight","_dragX","columnIndexes","findColumnsIndexes","setMarkerPosition","drawTargetMarker","targetColumn","cleanTargetMarker","reorderColumns","draggedId","xBefore","xAfter","currentColumn","startX","endX","columnRelativePos","compare","relativeX","getCorrection","gridOffset","_obj","nextPosition","domHelpers.addClassName","delegate","mouseEvents","h","Grid","factory","$parent","$state","topPositionMixin","parsing","jsonParseError","on_load","resp","responseURL","_process_loading","collections","_load_collections","assignmentsByTasks","collections_loaded","collection","serverList","option","option_key","$ignore","dhx_security","serializeLink","_copyLink","rawLinks","baselineCopy","attrs_only","attributes","_getCollections","opts","itms","attrs","k","attr","_getXML","toptag","getXMLTopNode","skey","evs","oldxml","startdate","est","enddate","predecessortasks","IsWorkTimeArgument","calendar","ClosestWorkTimeArgument","CalculateEndDateArgument","GetDurationArgument","gridAriaAttr","gridAttrString","gridDataAriaAttr","gridDataAttrString","reorder_grid_columns","gridScaleRowAttrString","item_attribute","layers","_createLayerConfig","resizer","_grid_resize","column_before_start","grid_resizer_column_attribute","column_index","column_after_start","drag_index","column_drag_move","dd","target_column","pointerPosition","minPointerPosition","min_width","min_grid_column_width","maxPointerPosition","markerStartPosition","marker_width","keep_grid_width","limit_max","max_width","maxWidth","rightColumnsWidth","parentLayout","parentWidth","$lastSize","$cells","column_drag_end","columns_width","final_width","grid_width","_setColumnsWidth","_syncCellSizes","isGravity","DnD","dnd_sensitivity","sensitivity","doOnRender","totalWidth","lineHeigth","resize","resize_el","gridSeparatorAttr","_renderHeaderResizers","_mouseDelegates","mouseEventContainer","resizerrow","_task_grid_row_resize","row_before_start","task_grid_row_resizer_attribute","row_id","row_after_start","row_drag_move","itemHeight","itemTop","marker_height","min_task_grid_row_height","row_drag_end","oldItemHeight","finalHeight","_addLayers","_initEvents","_columnDND","ColumnDnd","_validateColumnWidth","numericWidth","setSize","outerWidth","innerWidth","elasticColumns","grid_elastic_columns","columnProperty","newColumnWidth","columnsWidth","getSize","contentHeight","contentWidth","_getGridWidth","contentX","contentY","scrollWidth","_bindStore","_gridCacheAttached","_unbindStore","_initSmartRenderingPlaceholder","_calculateGridWidth","_renderGridHeader","y_end","x_end","scrolled","getColumnIndex","excludeHidden","hiddenIndexShift","getColumn","hidden","gridLine","gridTaskRowResizer","resize_rows","_taskLayers","taskRenderer","taskLayers","bar_layer","_refreshPlaceholderOnStoreUpdate","scrollSize","$rowsPlaceholder","_staticBgHandler","_clearLayers","removeLayer","_getColumnWidth","new_width","_checkGridColumnMinWidthLimits","_getGridWidthLimits","min_limit","max_limit","newWidth","start_index","extra_width","start_width","iterator","curExtra","_getColsTotalWidth","cols_width","unknown","gridWidth","autofit","delta","changed","_setContentSize","cells","renderableComponents","colWidth","_sort","direction","cssClass","grid_header_class","componentLabel","gridScaleCellAttrString","calendarArgumentsHelper","getWorkHoursArguments","setWorkTimeArguments","unsetWorkTimeArguments","isWorkTimeArguments","processedConfig","getClosestWorkTimeArguments","arg","_getStartEndConfig","param","argumentType","duration_step","getDurationArguments","hasDurationArguments","calculateEndDateArguments","WorkTimeCalendarMerger","_getIntervals","hoursArray","_toHoursArray","intervalsArray","formatHHMM","secondsValue","minutePart","_intersectHourRanges","baseArray","overridesArray","_mergeAdjacentIntervals","_mergeHoursConfig","firstHours","secondHours","merge","firstCalendar","secondCalendar","firstConfig","secondConfig","customWeeks","mergedSettings","processCalendar","config1","config2","date1","date2","hours2","WorkUnitsMapCache","timestamp","has","subCache","rawValue","unitCache","yearCache","Map","WorkUnitsObjectCache","LargerUnitsCache","getMinutesPerWeek","weekStart","_weekCache","_calendar","minutesPerWeek","getHoursPerDay","getMinutesPerMonth","monthStart","_monthCache","minutesPerMonth","nextMonth","DateDurationCache","stepCache","durations","endDates","compute","_getCacheObject","startDateTimestamp","_endDateCacheKey","resultTimestamp","_durationCacheKey","endDateTimestamp","CalendarWorkTimeStrategy","argumentsHelper","_workingUnitsCache","_largeUnitsCache","_dateDurationCache","_worktime","_cached_timestamps","_cached_timestamps_count","_clearCaches","_getUnitOrder","_resetTimestampCache","_timestamp","_checkIfWorkingUnit","hasDuration","_is_work_day","_getWorkHours","_is_work_hour","startHour","endHour","_getTimeOfDayStamp","dayEnd","_is_work_minute","checkTime","_nextDate","_getWorkUnitsBetweenGeneric","stepStart","stepEnd","checkFirst","checkLast","isLastStep","_isWorkTime","unitOrder","biggerTimeUnit","_getClosestWorkTimeFuture","_getMinutesPerHour","hourStart","hourEnd","_getMinutesPerDay","durationMinutes","durationHours","_getWorkUnitsForRange","getUnitsPerDay","_getMinutesBetweenSingleDay","_getIntervalTimestamp","minuteFrom","minuteTo","_getMinutesBetween","firstDayStart","firstDayEnd","lastDayStart","lastDayEnd","startPart","endPart","_getHoursBetween","_setConfig","_parseSettings","haveCustomWeeks","customWeeksRangeStart","customWeeksRangeEnd","customWeeksBoundaries","_parseHours","minCustomRangeStart","maxCustomRangeEnd","customTime","rangeStart","rangeEnd","fromReadable","toReadable","currentWeek","_tryChangeCalendarSettings","backup","hasWorkTime","_arraysEqual","_compareSettings","mySettings","thatSettings","myDays","otherDates","myHours","otherHours","equals","myWeek","thatWeek","getWorkHours","dayStartDate","dateValue","endHours","timestampRanges","timerangeConfig","durationSeconds","setWorkTime","calendarConfig","unsetWorkTime","reset_calendar","dateKey","isWorkUnit","setItem","getDuration","_calculateDuration","sign","mult","getEndDate","_calculateEndDate","_calculateMinuteEndDate","_subtractMinuteDate","_calculateHourEndDate","_addInterval","stopAction","added","dstShift","_addHoursUntilDayEnd","rangeHours","addHours","intervalEnd","durationLeft","_addMinutesUntilHourEnd","rangeMinutes","addMinutes","_subtractMinutesUntilHourStart","hourStartTimestamp","initialDateTimestamp","minutePrecision","_isMinutePrecision","addedInterval","calculatedDay","daySchedule","minutesInDay","dayStart","iterateFromDayEnd","isWorkHour","workInterval","prevInterval","minutesInHour","_getClosestWorkTimePast","times","lastInterval","_getClosestWorkTime","inputDate","closestFuture","closestPast","_getClosestWorkTimeGeneric","_findClosestTimeInDay","resultDate","fromDayEnd","_getClosestWorkMinute","increment","hasRegularHours","_checkWorkHours","dayConfig","legacyResourceCalendarConfig","isLegacyResourceCalendarFormat","resourceCalendarsProperty","getResourceProperty","resourceCalendarsConfig","resource_calendars","getCalendarIdFromLegacyConfig","calendarId","dynamicResourceCalendars","dynamicCalendars","getCalendarIdFromMultipleResources","manager","getResourceCalendar","tempCalendar","mergeCalendars","addCalendar","CalendarManager","_calendars","_legacyConfig","_isLegacyConfig","createDefaultCalendars","CalendarDisabledTimeStrategy","TimeCalculator","calendarManager","createArgumentsHelper","$disabledCalendar","NoWorkTimeCalendar","_convertWorkTimeSettings","datesConfig","weekdays","entries","setting","calendars","mergeHelper","CalendarMergeHelper","_createCalendarFromConfig","createCalendar","apiCore","preparedConfig","parentCalendar","defaults","fulltime","getCalendar","getCalendars","_getOwnCalendar","calendar_property","resourceProperty","dynamic_resource_calendars","calendarsConfig","getTaskCalendar","taskObject","groupMode","inherit_calendar","currentTask","$effective_calendar","isCalendar","deleteCalendar","restoreConfigCalendars","possibleCalendar","every","fixedUnits","_getCalendar","worktimeFacadeFactory","timeCalculator","isUnscheduledTask","_isAllowedUnscheduledTask","show_unscheduled","_isTaskInTimelineLimits","taskStart","taskEnd","_getProjectStart","getDefaultTaskDate","_set_default_task_timing","details_on_create","$new","showTask","_tasks_dnd","drag","getTaskTimingMode","task_type","$no_start","$no_end","scheduled_summary","updateTaskTiming","assignProjectDates","taskTiming","summaryDateFields","manuallyScheduledSummaryDateFields","dateFields","_init_task_timing","getSubtaskInfo","rollup","inlineSplit","isScheduledSummary","task_mode","dirty","min_duration","effectiveCalendar","taskMode","$rollup","$inlineSplit","getSubtaskDuration","_update_parents","updateAll","has_changed","startDateField","$auto_start_date","endDateField","$auto_end_date","oldStart","oldEnd","roundDate","upper","lower","colIndex","correctTaskWorkTime","correct_work_time","listenWindowResize","resizeDelay","resizeTimeout","container_resize_timeout","previousSize","getContainerSize","container_resize_method","lowlevelResizeWatcher","$scrollbarRepaint","currentSize","repaintGantt","previousHeight","previousWidth","gantt_core","show_errors","expire","invalidContainerMessage","validateNode","cloneNode","_reinit","dropLayout","_clearTaskLayers","_clearLinkLayers","rebuildLayout","calculateScaleRange","layout","createView","getPropertyValue","resizeWatcher","wai_aria_attributes","contentWindow","resetLayout","initTemplates","domHelpers.toNode","$mouseEvents","edit","question","confirm_deleting","confirm_deleting_title","_delete_task_confirm","hideLightbox","visibleDate","posX","_getHorizontalScrollbar","codeScrollLeft","preserveScroll","zoom","new_pos","posY","x_pos","setSizes","changeLightboxType","getLightboxType","_silent_redraw_lightbox","_get_link_type","from_start","to_start","isLinkAllowed","prevOffset","time_unit","helpers.getSecondsInUnit","offsetChanged","domHelpers.getClassName","icon_save","icon_cancel","icon_details","confirm_closing","section_description","section_time","section_type","section_deadline","section_baselines","section_new_resources","column_wbs","column_text","column_start_date","column_duration","column_add","confirm_link_deleting","link_start","link_end","type_task","type_project","type_milestone","weeks","months","years","message_ok","message_cancel","section_constraint","asap","alap","snet","snlt","fnet","fnlt","mso","mfo","resources_add_button","resources_filter_placeholder","resources_filter_label","resources_section_placeholder","baselines_section_placeholder","baselines_add_button","baselines_remove_button","baselines_remove_all_button","deadline_enable_button","deadline_disable_button","LocaleManager","addLocale","_locales","getLocale","DHXGantt","license","edit_save","edit_cancel","supportedExtensions","extensionManager","ExtensionManager","activePlugins","plugin","services","getter","service","rows","autoscroll_speed","show_links","show_task_cells","static_background","static_background_cells","branch_loading","branch_loading_property","show_loading","server_utc","show_progress","drag_links","drag_progress","drag_resize","drag_move","round_dnd_dates","link_wrapper_width","link_arrow_size","align","inherit_scale_class","time_step","task_date","time_picker","link_attribute","layer_attribute","buttons_left","_migrate_buttons","dhx_save_btn","dhx_cancel_btn","dhx_delete_btn","buttons_right","sections","project_sections","milestone_sections","single_date","drag_lightbox","details_on_dblclick","initial_scroll","order_branch_free","task_height","bar_height_padding","grid_resize","readonly_property","editable_property","type_renderers","optimize_render","prevent_default_scroll","horizontal_scroll_key","drag_multiple","DOMParser","ActiveXObject","loadXML","parseFromString","tagname","responseXML","getElementsByTagName","xpathExp","docObj","selectNodes","ownerDocument","evaluate","XPathResult","ANY_TYPE","iterateNext","_call","onLoad","getSync","put","postData","del","postSync","isQt","noCache","toUpperCase","copyDomEvent","pageX","pageY","_settings","inputMethods","getInputMethods","_drag_start_timer","clearDragTimer","eventParams","passive","accessor","timeStamp","original_target","original_element_sizes","domHelpers.getClosestSizedElement","dragStart","traceDragEvents","inputMethod","mousemove","dragScroll","limited_mousemove","started","dndActive","cancelable","mousemoveContainer","mouseup","checkPositionChange","diff_x","diff_y","pow","initDnDMarker","backupEventTarget","getEvent","backup_element","maxTouchPoints","elementFromPoint","PointerEvent","pointerType","getPosition","_prevent_touch_scroll","_touch_drag","_touch_feedback","targetTouches","templatesLoader","regTemplates","initTemplate","initial","template_name","progress_text","task_end_date","grid_row_class","task_row_class","timeline_cell_content","scale_row_class","grid_indent","grid_folder","grid_file","grid_open","grid_blank","task_unscheduled_time","grid_date_format","link_class","link_description","drag_link","drag_link_class","tooltip_date_format","baseline_text","stateService","selected_task","deletedLinks","originalTask","checkLinkedTaskVisibility","noDuplicateIds","sync_link_delete","sync_links","mapEvents","conf","mapFrom","mapTo","sourceEvent","targetEvent","taskLinks","typeMatch","changedTask","sourceVisible","targetVisible","onItemLoading","onBeforeAdd","onAfterAdd","onBeforeUpdate","onAfterUpdate","onBeforeDelete","onAfterDelete","onIdChange","onBeforeItemMove","onAfterItemMove","onFilterItem","onItemOpen","onItemClose","onBeforeSelect","onAfterSelect","onAfterUnselect","createDataProcessor","modules","new_task_placeholder","remote_events","getGridColumn","checkType","activate","_cached_functions","update_if_changed","critical_path_mode","wrap_methods","_prefetch_originals","prefetch","methodname","original","optimizer","argumentsArray","get_arguments_hash","cached_values","has_cached_value","get_cached_value","cache_value","arguments_hash","is_date","stringify_argument","deactivate","setup","override_gantt","gantt_methods","deactivTimeout","_eventRemoveAll","resetLightbox","i18n","en","ar","be","ca","cn","cs","da","de","es","fa","fi","fr","hr","hu","it","jp","kr","nb","nl","no","pl","pt","ro","ru","si","sk","sv","tr","ua","setLocale","localeObject","gantt_save_btn","gantt_cancel_btn","gantt_delete_btn","boxAttribute","_dhx_msg_cfg","usercall","modalBox","modal_key","messageBox","keyboard","cancelBubble","modality","onkeydown","messageButtonAttrString","getFirstDefined","_createBox","ok","cancel","contentId","messageModalAttr","inner","btn","onclick","innerHeight","alertPopup","confirmPopup","boxPopup","box_params","messageInfoAttr","insertBefore","timers","hideAll","popups","alert","confirm","modalbox","extendSettings","parentSettings","own","$extendedConfig","setPrototypeOf","configurable$1","parentView","parentConfig","parentTemplates","$getTemplates","uiFactory$1","views","createdViews","creator","configure","configurable","initUI","registerView","viewConstructor","createMouseHandler","eventHandlers","doubleclick","contextMenu","addEventTarget","onClick","findEventHandlers","callEventHandlers","onContextMenu","src","delegateHandlers","onDoubleClick","onMouseMove","_last_move_event","domEvents","elementHandlers","callHandler","genericViewPortChecker","isLegacyRender","getRowRectangle","getVisibleTasksRange","indexStart","indexEnd","extraTasksIds","inlineEditorId","layerFactory","renderFactory","task_area_pulls","task_area_renderers","getRenderer","renderMethod","updateMethod","getRectangle","renderCallbackMethod","specializedViewPortChecker","basicGetRectangle","onrender","isInViewPort","layerView","viewConfig","rendererViewPort","useBuffer","remove_item","rendered","clear_container","basicGetRange","getVisibleRange","prepareData","buffer","createDocumentFragment","vis","itemsSearch","renderedItems","newElements","nodesToRemove","renderCalledFor","itemNode","restore","replace_item","item_id","newNode","replaceChild","clearRenderers","createGroup","relativeRoot","defaultFilters","initLayer","renderGroup","tempCollection","filters","_add","getLayer","pending","topmost","mergeFilters","requestUpdate","eachLayer","filter_methods","filter_method","barRectangle","startCoord","_getPositioningContext","endCoord","calculated","rec","sourceBox","targetBox","initialized","visibleBoxes","isLinkInViewPort","sourceTop","sourceHeight","targetTop","targetHeight","sourceLeft","sourceRight","targetLeft","targetRight","$skipSmartRenderOnScroll","Cell","headerHeight","$domEvents","$name","$factory","$externalComponent","_headerClickHandler","final","$preResize","topCont","topSize","minHeight","_hide","cellIndex","moveView","$toHTML","renderedElement","canCollapse","$fill","collapsed","size","gravity","getContentSize","_getBorderSizes","borders","horizontal","vertical","_currentBorders","_borders","_sizeHeader","_sizeContent","_setBorders","domHelpers.removeClassName","cssHash","xLayout","transform","__extends","__","Layout","_super","_parseConfig","domHelpers.removeNode","_resizeScrollbars","scrollbars","scrollChanged","visibleScrollbars","hiddenScrollbars","scrollbarsToHide","showScrollbar","scrollbar","hideScrollbar","shouldHide","shouldShow","visibleGroups","scrollbarsInfo","visible","_getLinkedViews","x_inner","y_inner","y_pos","groupName","newSize","_eachChild","_syncGroupSize","_xLayout","newSizeValue","ownSize","resizeSibling","siblingSize","totalGravity","totalSize","mainGrid","startStage","mainCall","_resizeInProgress","contentViews","setContentSize","_getAutosizeMode","$originalWidthStored","$originalWidth","$originalHeightStored","$originalHeight","cellId","sub","getCells","domHelpers.insertNode","domHelpers.getChildNodes","_cleanElSize","_getBoxStyles","computed","properties","boxSizing","clientHeight","MozBoxSizing","horPaddings","borderLeftWidth","borderRightWidth","vertPaddings","borderTopWidth","borderBottomWidth","borderBox","outerHeight","boxSizes","contentSizes","_sizes","margin","_calcFreeSpace","side","_free","_gravity","_calcSize","_configureBorders","borderClass","lastVisibleIndex","lastCell","borderColorClass","_updateCellVisibility","oldVisibleCells","_visibleCells","firstCall","visibleCells","parentVisibility","hide_empty","hideCell","cellView","marginSide","ViewLayout","$cell","byMaxSize","otherCell","ViewCell","childConfig","$initialized","unload","outerX","outerY","childSize","ResizerCell","startBackSize","startFrontSize","getPageCoordinates","_moveHandler","_moveResizer","_resizer","_upHandler","newSizes","_getNewSizes","front","_setSizes","_setBackground","_clearResizer","_clearListeneres","_startOnMove","_cancelDND","_downHandler","_callStartDNDEvent","_xMode","_behind","_front","_startDND","_eachGroupItem","_getSiblings","_isPosChanged","_setResizer","_positions","now","classes","_getDirection","_getResizePosition","behindSide","behindMin","frontSide","frontMin","newBehindSide","newFrontSide","_getGroupName","resizers","_getGroupResizePosition","minMax","av","nextX","nextY","_setGravity","frontSize","behindSize","newFrontG","newBehindG","_assignNewSizes","resizeValue","ScrollbarCell","SCROLL_MODIFIER_KEYS","_scrollHorizontalHandler","_scrollVerticalHandler","_outerScrollVerticalHandler","_outerScrollHorizontalHandler","_mouseWheelHandler","scroll_size","_isHorizontal","eachCell","_isVertical","_initVertical","_initHorizontal","_initMouseWheel","_initLinkedViews","_getRootParent","_eachView","$scroll_hor","$scroll_ver","_updateLinkedViews","scrollHorizontally","_scrolling","oldSize","scrollVertically","_wheel_time","_oldLeft","_getScrollSize","outerSize","isHorizontal","scrollProperty","innerSizeProperty","outerProperty","_getScrollOffset","cellScrollSize","nonScrollableSize","outerScroll","innerScroll","scrollSizes","_setScrollSize","toggleVisibility","_getScaleOffset","_oldTop","_checkWheelTarget","connectedViews","wheelSpeed","wheelSpeedConfig","wheel_scroll_sensitivity","ff","deltaX","wheelDeltaX","deltaY","wheelDelta","multiplier","deltaMode","wx","wy","horizontalScrollModifier","oldLeft","detail","oldTop","createStaticBgHelper","canvasBgCache","staticBgStyleId","parseRgb","rgbCss","g","getUrlFromCache","getHashKey","cellStyles","bottomBorderColor","rightBorderColor","cacheUrl","generateBgUrl","canvas","context","getContext","image","createImageData","imageSmoothingEnabled","verticalLineWidth","rightBorderWidth","verticalLineColor","drawDot","horizontalLineWidth","bottomBorderWidth","horizontalLineColor","putImageData","toDataURL","matrix","getCssClass","createProbeElement","styleParams","firstRow","secondRow","firstRowCell","rowStyles","png","widths","differentWidths","styleHTML","bgImage","bgDivs","bgTiles","tile","prevCell","divs","prevWidth","leftPos","maxTileSize","appVersion","currentTop","tileWidth","currentHeight","pointerEvents","whiteSpace","fragment","destroy","canvasRender","Timeline","_posFromDateCache","_posFromWorkTimeCache","_timelineDragScroll","clearTaskStoreHandler","_delayRender","ownStore","handlerIdProperty","$attachedResourceViewHandler","$attachedTaskStoreHandler","initGrid","destroyGrid","_linkToTaskStore","previousDragId","relevantResources","delayRender","linkedStore","repaintStack","_getRelevantResources","_updateNestedTasks","_getIdsFromAssignments","resourceStore","toAddArray","toAdd","toDelete","addedTasks","resourceData","resource1","resource2","$task_scale","taskBg","$task_bg","$task_baselines","$task_links","$task_bars","$task_constraints","$task_deadlines","_tasks","linksAttr","bindLinks","linkLayers","_attachLayers","backgroundImage","data_els","_refreshScales","_scales","_getScaleChunkHtml","taskFilter","isTimedProject","expose","hide_bar","timedProjectBar","taskSplitBar","taskRollupBar","taskConstraints","taskDeadline","_linkLayers","_taskRenderer","_initStaticBackgroundRender","linkStore","linkRenderer","linkLayer","_linkRenderer","staticRender","staticBgContainer","$task_bg_static","staticBackgroundHeight","_render_tasks_scales","scales_html","outer_width","helpers","cfgs","fromPos","toPos","tplClass","_prepareScaleHtml","globalConfig","globalTemplates","cssclass","floatConfig","sticky","labelPosition","approxLabelWidth","labelPos","translateValue","getTimelineCellAttr","_getColumnDuration","cellStartDate","absolutePositionDate","trimStartSec","cellEnd","cellDuration","intervals","_getWorkTrimForCell","secondsInsideTrim","mappedTimestampMs","posFromWorkTime","wholeCells","partCell","roundPos","cellDurationMs","cellEndDate","earliestWorkSecondInCell","latestWorkSecondInCell","intervalsSinceCellStart","dayDate","dayIndex","dayIntervals","dayStartOffsetSeconds","absoluteStartSeconds","absoluteEndSeconds","workintervalStart","workintervalEnd","dateOffset","fraction","posLeft","cellWidth","_getNextVisibleColumn","visibleDateIndex","_getPrevVisibleColumn","_getClosestVisibleColumn","dateIndex","visibleIndex","transition","xLeft","xRight","displayStart","displayEnd","isMilestoneRender","_timelineCacheAttached","ResourceGrid","resourceStoreMixin","GridRL","_getResourceConfig","resource_table","domEventScope","_getResourceColumns","_getResourceSection","getLightboxSection","sectionName","section","inlineEditorsLightbox","ResourceTimeline","resourceRow","ResourceHistogram","resourceHistogram","defaultMapping","isChanged","save","tempAssignmentStore","resourceSection","block","form_blocks","_lightbox_root","set_value","lightbox_events","_save_lightbox","onShow","preventKeyNav","shouldPrevent","editPrevCell","editNextCell","onkeyup","onwheel","onHide","keyNavMappings","onBlurDelay","keyNav","activeCell","editorState","hasEditor","editorType","anyModifier","BaseFactory","BaseEditor","get_input","get_value","is_changed","currentValue","is_valid","textEditorFactory","TextEditor","numberEditorFactory","NumberEditor","oninput","selectEditorFactory","SelectEditor","optionsHtml","dateEditorFactory","html5DateFormat","dateToStr","strToDate","DateEditor","minValue","maxValue","predecessorEditorFactory","PredecessorEditor","getFormatter","formatter","parseInputString","formatPredecessors","formatLinkKey","getLinksDiff","predecessorCodes","selectedLinks","existingLinksSearch","linksToAdd","linksToDelete","linksDiff","inputPredecessors","taskPredecessors","durationEditorFactory","linkedPropertiesProcessor","decreaseStartDate","initConfigs","number","keyboardMapping","mapping","setMapping","getMapping","eventBus","inlineEditController","createEditors","_createPlaceholder","inlineEditorAttr","updateTaskDateProperties","ganttHandlers","_itemId","_columnName","_editor","_editorType","_placeholder","asyncShow","setValue","_lightbox","onAfterShow","_onReMount","editorResult","getValue","_getItemValue","_findEditableCell","nextColumn","getNextCell","getFirstCell","getLastCell","canChangeRow","moveRow","nextItem","editNextRow","skipReadonly","editPrevRow","detachStore","isBarInViewport","createTaskRenderer","_task_default_render","controlsMargin","padd","milestoneHeight","milestoneWidth","done","pr","taskEditable","timelineDrag","markerPos","basic","link_from_start","link_target_id","link_landing_area","from_id","link_to_start","dragClass","progressColor","textColor","u","setProperty","_get_link_crossing_css","marginStyle","_render_side_content","setTaskBarAttr","_render_pair","outer","showLinkPoints","cond","ln","tp","marginLeft","marginRight","defaultRenderer","planned","plannedCoords","actual","actualCoords","opacity","isSplitTaskInViewport","getVisibleCellsRange","firstCellIndex","lastCellIndex","isColumnVisible","cellLeftCoord","cellRightCoord","bgPlaceholder","placeholderConfig","lastTaskId","placeholderTask","calendar_id","createLinkRender","drawer","current_pos","dirs","path","point","get_lines","line_to","get_path","line","_get_line","get_wrapper_sizes","wrapper_size","get_line_sizes","line_size","link_line_width","render_line","innerPos","render_corner","corner","radius","lineWidth","cornerDiv","borderVertical","borderHorizontal","arrow","get_direction","vect","path_builder","point_to","get_points","get_endpoint","xy","e_y","e_x","lineType","get_line_type","forward","getMilestonePosition","milestoneTask","siblingBaselines","shapes","lines","link_radius","arrowSize","nextLine","cornerX","cornerY","lastLine","arrowX","arrowY","shape","render_arrow","cssTemplate","linkAttr","createResourceTimelineBuilder","assignmentsPassed","timegrid","scaleUnit","scaleStep","precalculatedTimes","firstColumn","minScaleDate","currDate","cachedTimes","timetable","renderBar","renderConnection","prevLevel","nextLevel","generateRenderResourceHistogram","getResourceLoad","resourceTimetable","renderedHistogramCells","renderedHistogramRows","renderedHistogramCapacity","detachRenderedHistogramCell","renderedRow","renderCapacityElement","capacityMatrix","maxCapacity","capacityElement","colStart","colEnd","bar","connection","renderHistogramCell","fill","checkedColumns","renderedCell","areDatesInViewPort","dateProperties","checkTaskProperties","childProperties","isConstraintInViewPort","shouldRenderConstraints","additional_properties","constraintNames","generateConstraintNode","constraintValue","constraintNodes","taskConstraint","childConstraint","isDeadlineInViewPort","isBaselineInViewPort","inViewport","iterateBaselines","rowDnd","checkPlaceholderTask","getStore","initial_open_state","$transparent","lastTaskOfLevel","last_item","_getGridPos","gridHeight","maxBottom","_getTargetY","scrollPos","_getTaskByY","dropIndex","gridDataSizes","reorderMarkerAttr","containerSize","targetY","allowedLevel","over","nextId","dropTarget","createDropTargetObject","targetId","nextSiblingTarget","dndTaskId","prevSiblingTarget","firstChildTarget","lastChildTarget","findClosesTarget","targetLevel","findTargetAbove","findTargetBelow","getSameLevelDropPosition","relTargetPos","eventTop","targetAbove","targetBelow","gridToPageCoordinates","gridPos","setWidthWithinContainer","higlighter","removeLineHighlight","markerLine","highlightPosition","ePos","markerFolder","folderHighlightWidth","linePos","indentNode","indent","iconWidth","childCount","markerLineTop","rowDndMarker","drop_target","getDropPosition","doctype","minTop","firstVisibleTaskIndex","firstVisibleTaskId","firstVisibleTaskPos","hiddenTaskPart","gridPosition","gridBottom","placeholderRowHeight","lockLevel","getLockedLevelTarget","initializer","onCreated","extendGantt","_inlineEditors","onInitialized","initEvents","extendDom","onDestroyed","clearEvents","notOpenIcon","showDate","sorting_method","taskDnD","createTaskDND","roundTaskDates","round_task_dates","dragMultiple","before_start","before_finish","after_finish","clear_drag_state","set_actions","drag_from_start","stage","_move","_resize","_resize_progress","on_mouse_move","on_mouse_down","on_mouse_up","start_x","start_y","coords_x","_drag_task_coords","minDurationInUnits","_calculateMinDuration","diffValue","_find_max_shift","dragItems","correctShift","minX","maxX","maxShift","minShift","multipleDragShift","new_start","new_end","obj_s_x","obj_e_x","_mouse_position_change","oldPos","newPos","_is_number","isFinite","start_drag","sX","sY","_start_dnd","_update_on_move","_update_item_on_move","curr_date","dragHash","_isMultiselect","dragProject","initialDrag","newStartPos","newEndPos","handle_offset","dragPos","dragX","childDrag","_get_drag_mode","_fix_dnd_scale_time","fixStart","dndContext","_fix_working_times","_finalize_mouse_up","_fireEvent","_dhx_changed","initialDates","finalizingBulkMove","moveCount","doFinalize","dragProperty","selectedTasksIds","selectedTask","_addSubtasksToDragMultiple","trigger","drag_state","summaryId","initLinksDND","_link_landing","_link_target_task","_link_target_task_start","_link_source_task","_link_source_task_start","getDndState","link_edge_marker","link_landing_hover_area","markerSize","viewportSize","ganttOffsetY","updateMarkedHtml","resetDndState","showDirectingLine","s_x","s_y","_direction","link_direction_class","tan","angle","atan","coordinateCircleQuarter","sin","cos","shiftLeft","shiftTop","eX","eY","_dir_start","landing","prevTarget","prevLanding","prevToStart","targ","absCoords","domHelpers.getRelativeNodePosition","_dir_end","targetChanged","linkDnD","_linksDnD","_tasksDnD","MouseDelegates","_attachDomEvents","_attachStateProvider","_clearDomEvents","_clearStateProvider","_delete_link_handler","_delete_link_confirm","coll","coll_date","scale_unit","scale_step","getVerticalScrollbar","getHorizontalScrollbar","_legacyGridResizerClass","gridResizer","mainTimeline","colsWidth","hideGrid","grid_limits","ganttContainerWidth","verticalScrollbarWidth","gridOverflow","original_grid_width","skinSettings","skins","_initScrollStateEvents","_getVerticalScrollbar","_findGridResizer","gridFirst","resizeInfo","initialWidth","prevCellWidth","nextCellWidth","viewCell","limits","newBehindSize","newFrontSize","oldBackSize","oldFrontSize","newBackSize","ui$1","attachInitializer","uiFactory","Resizer","Scrollbar","mainLayoutInitializer","mainTimelineInitializer","mainGridInitializer","ResourceGridLightbox","layersEngine","createLayerFactory","previusSiblingContainer","defaultContainerSibling","addTaskLayer","rangeFunction","getVisibleTaskRange","_getTaskLayers","removeTaskLayer","addLinkLayer","getVisibleLinksRangeFactory","isLinkInViewport","_getLinkLayers","removeLinkLayer","gridEditorsFactory","layersApi","textValue","aria","gridAddButtonAttrString","justifyContent","center","gridCellAttrString","css_template","taskRowAttr","rowNode","cellNode","adapter","renderedCells","isRendered","detachRenderedCell","getCellClassTemplate","getCellContentTemplate","renderOneCell","contentTemplate","cssTemplateContent","htmlTemplateContent","customCell","cellCssTemplate","cellHtmlTemplate","odd","placeholderTop","placeholderHeight","createBaseBarRender","renderedNodes","checkVisibility","generateChildElement","childCopy","$rendered_at","getKey","renderParentId","rollupKey","splitTasksHelper","isInViewPortChild","isProject","milestoneChild","linkDragLeft","linkDragRight","offsetMargin","taskContent","shouldUseSplitRendering","splitKey","isInViewPortParent","renderConstraints","generateDeadlineNode","fontSize","deadlineNodes","childDeadline","generateBaselineNode","baselineEnd","milestoneMarginTop","baselineSubrowHeight","baselineBarHeight","siblingBaselinesSize","baselineNodes","taskBaseline","childBaseline","renderLink","renderedResourceLines","renderResourceLineCell","detachRenderedResourceLine","resourceHistogramRenderer","rowResizerAttr","layersService","_get_skin","themeVar","themeName","isCssVarTheme","href","_theme_info","theme","cssVarTheme","skinset","_second_column_width","_third_column_width","_lightbox_template","_redefine_lightbox_buttons","isMove","delayTimeout","startPos","eventPos","isDisplayed","isScrollState","dragMarker","isResize","isLink","isClickDrag","defineDelayTimeout","speed","tick","autoscroll_delay","defineScrollInterval","autoscrollInterval","isScroll","gridDrag","need_scroll","currentScrollTop","scrollOuterHeight","scrollInnerHeight","currentScrollLeft","scrollOuterWidth","scrollInnerWidth","autoscroll_step","boxSize","$","jQuery","fn","dhx_gantt","each","newgantt","Gantt","getGanttInstance","dhtmlx","attaches","attachGantt","cmp","attachObject","dataType","dataObj","vs","border","gridId","gridObj","dhtmlXCellObject","USE_KEY","_defaultScales","TimelineZoom","zoomIn","getCurrentLevel","setLevel","zoomOut","_levels","_activeLevelIndex","getLevels","zoomLevel","_getZoomIndexByName","levelName","_getVisibleDate","_visibleDate","cursorOffset","nextConfig","chartConfig","resourceView","resourceConfig","fixed_scales","cursorDate","newPosition","middleDate","_attachWheelEvent","_useKey","_handler","_defaultHandler","timelineOffset","wheelUp","stopPropagation","_setScaleSettings","_setScaleDates","_initialStartDate","_initialEndDate","activeLevelIndex","_mapScales","levels","_minColumnWidth","minColumnWidth","_maxColumnWidth","maxColumnWidth","_widthStep","widthStep","_stepUp","_stepDown","addTouchEvents","platform","_touch_events","getTaskDND","tasksDnD","touch_feedback","touch_feedback_duration","vibrate","touchHandlers","names","dblclicktime","actionMode","scrollMode","actionStart","previousActionStart","longTapTimer","currentDndId","dndNodes","targetView","multiTouchEvents","newScrollState","block_action","allViews","_locate_css","taskNode","noMultitouch","sameTarget","dummy","BaseControl","Super","htmlHelpers","getHtmlSelect","_attributes","getHtmlOption","_getHtmlContainer","getHtmlButton","getHtmlDiv","getHtmlLabel","getHtmlInput","_getHtmlAttributes","SelectControlConstructor","SelectControl","sns","_dhx_onchange","onchange","_focus","DurationFormatterNumeric","_ja","ParentControlConstructor","ParentControl","_display","allow_root","root_label","getLightboxValues","tmpDom","newOptions","onselect","ResourcesControlConstructor","localCache","resourcesValues","eventsInitialized","ResourcesControl","_getAmountInput","disabled","_getInputElementSelector","isChecked","_getResourcesElement","_getFilterCache","checkbox","checked","filterApplied","resourceFilterPlaceholder","filter_placeholder","resourceFilterLabel","resourcesElement","htmlResourceRow","_applyFilter","resultSns","hideUnsetted","_saveValues","filterCache","controlConfig","comparison","resultConfig","cachedValue","helpers.arrayFind","itemIds","helpers.arrayFilter","_resourceChangeListener","valueInput","resId","defaultValue","default_value","originalAssignmentId","helpers.throttle","unassigned_value","searchResult","_offsetSizes","_center_lightbox","amountElement","selectorAdd","selectorSub","settedValuesHash","itemsAdd","itemsSub","originalId","amount","NewResourcesControlConstructor","gridID","resource_filter_value","initialValues","newValues","selectResEditor","newResourcesControl","resource_default_assignment","button_click","firstAddBtn","resourceGrid","resourceRows","resourceCell","resourceTable","gridConfig","wide_form","searchItems","clonedAssignments","structuredClone","visibleResources","currentAssignments","resource_selector","TemplateControl","TextareaControl","_get_input","TimeControl","getTimePicker","sectionClassName","_time_format_order","auto_end_date","_update_lightbox_select","_fill_lightbox_select","_resolve_default_mapping","selects","getTimePickerValue","autofix_end","_get_timepicker_step","CheckboxControl","BaseConstrutor","single_value","checkboxes","resArray","RadioControl","radio","DurationControl","_getStartDate","_getDuration","singleDate","lightboxDurationInputAttrString","durationInputClass","duration_val","inps","btns","endspan","_calc_date","_change_duration","charCode","ConstraintControl","isNonTimedConstraint","toggleTimeSelect","timeSelects","typeValue","isNonTimed","typeSelect","_eventsInitialized","TypeselectControl","typeKey","oldOnChange","_lightbox_current_type","BaselineControl","_generateBaselineRow","durationLabel","deleteLabel","durationEl","deleteButton","baselineRow","baselineNode","baselineId","dataset","updatedBaseline","_get_typed_lightbox_config","NewResourcesControl","_lightbox_methods","showCover","_fill_lightbox","_setLbPosition","lightboxVisibleAttr","getLabel","list_name","_lightbox_type","lightboxDiv","fullWidth","ds","classNames","_is_lightbox_timepicker","getHtmlButtons","lightboxAttr","onmousedown","_ready_to_dnd","onselectstart","cursor","_init_dnd_events","show_cover","_cover","_render_sections","backup_overflow","labelBlock","inputBlock","inputId","_init_lightbox_events","rootElement","_move_while_dnd","_finish_dnd","_get_type_name","type_value","floatRight","lightboxButtonAttrString","getTimeFormat","time_format","getHtmlTimePickerOptions","start_year","end_year","tdate","timeFormat","year_range","_time_values","_cancel_lightbox","sec","buttonTarget","time_optional","duration_optional","sortedSns","lightboxHiddenAttr","hideCover","_custom_lightbox","_set_lightbox_values","lightboxHeader","lightbox_header","get_template_control","control","get_select_control","get_textarea_control","get_time_control","_dnd_start_lb","gantt_unselectable","lb","_lb_start","ariaAttrs","limit_time_select","first_hour","last_hour","lightboxSelectAttrString","mapOffset","typeselect","_simple_confirm","oldType","ui","codeHelpers.arrayFind","uiApi","getTimeline","getGrid","getBaseCell","baseCell","getAttachedScrollbar","attachedScrollbar","DEFAULT_VALUE","tryCall","getTaskTop","getTaskBarHeight","domAttr","getLinkNode","oldH","oldV","verticalViews","horizontalViews","commonViews","viewId","newV","newH","date_x","scroll_to","_scroll_state","gridCell","timelineCell","scrollVer","scrollHor","horState","verState","cellName","horizontalScroll","verticalScroll","createLayoutFacade","resetSkin","monitorThemeChange","_addThemeClass","setSkin","skinChanged","monitorIntervalId","csstheme","skyblue","lightbox_additional_height","dark","meadow","terrace","broadway","_config_buttons_left","_config_buttons_right","material","indx","_extend_to_optional","lightbox_block","optional_time","update_block","button_text","htmlTags","extraSpaces","stripHTMLLite","htmlText","singleQuotes","escapeQuotes","getAttributeString","_taskCommonAttr","linkTypes","toStart","fromStart","buttonName","role","tabindex","headerText","time_option","buttonLabel","targetAttribute","_locateHTML","firstTask","domHelpers.getScrollSize","availablePlugins","dynamicLoading","loadedBranches","oldHasChildren","_load_url","requestData","_load_type","factoryMethod","_bundledExtensions","_ganttPlugin","initConfig","_factoryMethod","_internal_id","_initFromConfig","_extensionsManager","cl"],"mappings":"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","x_google_ignoreList":[65]}